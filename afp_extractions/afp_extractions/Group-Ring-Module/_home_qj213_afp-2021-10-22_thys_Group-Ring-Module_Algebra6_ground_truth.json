{"file_name": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module/Algebra6.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module", "problem_names": ["lemma (in PolynRg) lcf_val_0:\"lcf R S X \\<zero> = \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) lcf_val:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n                    lcf R S X p = (snd (s_cf R S X p)) (fst (s_cf R S X p))\"", "lemma (in PolynRg) s_cf_pol_coeff:\"p \\<in> carrier R \\<Longrightarrow>\n                         pol_coeff S (s_cf R S X p)\"", "lemma (in PolynRg) lcf_mem:\"p \\<in> carrier R \\<Longrightarrow> (lcf R S X p) \\<in> carrier S\"", "lemma (in PolynRg) s_cf_expr0:\"p \\<in> carrier R \\<Longrightarrow>\n      pol_coeff S (s_cf R S X p) \\<and>\n      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\"", "lemma (in PolynRg) pos_deg_nonzero:\"\\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk> \\<Longrightarrow>\n                     p \\<noteq> \\<zero>\"", "lemma (in PolynRg) s_cf_expr:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n      pol_coeff S (s_cf R S X p) \\<and>\n      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<and>\n      (snd (s_cf R S X p)) (fst (s_cf R S X p)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) lcf_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n                                          lcf R S X p \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) s_cf_deg:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                  deg_n R S X p = fst (s_cf R S X p)\"", "lemma (in PolynRg) pol_expr_edeg:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> (an d)\\<rbrakk> \\<Longrightarrow> \n       \\<exists>f. (pol_coeff S f \\<and> fst f = d \\<and> p = polyn_expr R X d f)\"", "lemma (in PolynRg) cf_scf:\"\\<lbrakk>pol_coeff S c; k \\<le> fst c; polyn_expr R X k c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow>  \\<forall>j \\<le> fst (s_cf R S X (polyn_expr R X k c)).\n              snd (s_cf R S X (polyn_expr R X k c)) j = snd c j\"", "lemma (in PolynRg) scf_d_polTr:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk> \\<Longrightarrow> \n           scf_cond R S X p d (scf_d R S X p d)\"", "lemma (in PolynRg) scf_d_pol:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk> \\<Longrightarrow> \n      pol_coeff S (scf_d R S X p d) \\<and> fst (scf_d R S X p d) = d \\<and>\n       p = polyn_expr R X d (scf_d R S X p d)\"", "lemma (in PolynRg) pol_expr_of_X:\n       \"X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\"", "lemma (in PolynRg) deg_n_of_X:\"deg_n R S X X = Suc 0\"", "lemma (in PolynRg) pol_X:\"cf_sol R S X X c \\<Longrightarrow>\n              snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and> snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) pol_of_deg0:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n      \\<Longrightarrow>  (deg_n R S X p = 0) = (p \\<in> carrier S)\"", "lemma (in PolynRg) pols_const:\"\\<lbrakk>p \\<in> carrier R; (deg R S X p) \\<le> 0\\<rbrakk>  \\<Longrightarrow> \n                         p \\<in> carrier S\"", "lemma (in PolynRg) less_deg_add_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; \n       q \\<in> carrier R; q \\<noteq> \\<zero>; \n       (deg_n R S X p) < (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>\"", "lemma (in PolynRg) polyn_deg_add1:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n      q \\<noteq> \\<zero>; (deg_n R S X p) < (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow>  \n            deg_n R S X (p \\<plusminus> q) = (deg_n R S X q)\"", "lemma (in PolynRg) polyn_deg_add2:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n      q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>; (deg_n R S X p) = (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow> \n          deg_n R S X (p \\<plusminus> q) \\<le> (deg_n R S X q)\"", "lemma (in PolynRg) polyn_deg_add3:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n       q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>; (deg_n R S X p) \\<le> n; (deg_n R S X q) \\<le> n\\<rbrakk>  \\<Longrightarrow> \n          deg_n R S X (p \\<plusminus> q) \\<le> n\"", "lemma (in PolynRg) polyn_deg_add4:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n      (deg R S X p) \\<le> (an n); (deg R S X q) \\<le> (an n)\\<rbrakk>  \\<Longrightarrow> \n                    deg R S X (p \\<plusminus> q) \\<le> (an n)\"", "lemma (in PolynRg) polyn_deg_add5:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) \\<le> a; (deg R S X q) \\<le> a\\<rbrakk>  \\<Longrightarrow> \n                                deg R S X (p \\<plusminus> q) \\<le> a\"", "lemma (in PolynRg) lower_deg_part:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p\\<rbrakk>\n      \\<Longrightarrow>  \n deg R S X (polyn_expr R X (deg_n R S X p - Suc 0)(SOME f. cf_sol R S X p f))\n                       < deg R S X p\"", "lemma (in PolynRg) ldeg_p_mem:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d) \\<rbrakk> \\<Longrightarrow>\n                      ldeg_p R S X d p \\<in> carrier R\"", "lemma (in PolynRg) ldeg_p_zero:\"p = \\<zero>\\<^bsub>R\\<^esub> \\<Longrightarrow> ldeg_p R S X d p = \\<zero>\\<^bsub>R\\<^esub>\"", "lemma (in PolynRg) hdeg_p_mem:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n                      hdeg_p R S X (Suc d) p \\<in> carrier R\"", "lemma (in PolynRg) hdeg_p_zero:\"p = \\<zero> \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>\"", "lemma (in PolynRg) decompos_p:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n                p = (ldeg_p R S X d p) \\<plusminus> (hdeg_p R S X (Suc d) p)\"", "lemma (in PolynRg) deg_ldeg_p:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>  \\<Longrightarrow>  \n                deg R S X (ldeg_p R S X d p) \\<le> an d\"", "lemma (in PolynRg) deg_minus_eq:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>  \n                    deg_n R S X (-\\<^sub>a p) = deg_n R S X p\"", "lemma (in PolynRg) deg_minus_eq1:\"p \\<in> carrier R \\<Longrightarrow> \n                       deg R S X (-\\<^sub>a p) = deg R S X p\"", "lemma (in PolynRg) ldeg_p_pOp:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n      deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n      (ldeg_p R S X d p) \\<plusminus>\\<^bsub>R\\<^esub> (ldeg_p R S X d q) =\n                              ldeg_p R S X d (p \\<plusminus>\\<^bsub>R\\<^esub> q)\"", "lemma (in PolynRg) hdeg_p_pOp:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n      deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n      (hdeg_p R S X (Suc d) p) \\<plusminus> (hdeg_p R S X (Suc d) q) =\n                              hdeg_p R S X (Suc d) (p \\<plusminus> q)\"", "lemma (in PolynRg) ldeg_p_mOp:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (ldeg_p R S X d p) = ldeg_p R S X d (-\\<^sub>a p)\"", "lemma (in PolynRg) hdeg_p_mOp:\"\\<lbrakk>p \\<in> carrier R;deg R S X p \\<le> an (Suc d)\\<rbrakk> \n  \\<Longrightarrow> -\\<^sub>a (hdeg_p R S X (Suc d) p) = hdeg_p R S X (Suc d) (-\\<^sub>a p)\"", "lemma (in PolynRg) deg_mult_pols:\"\\<lbrakk>Idomain S;\n      p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; q \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n      p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n     deg_n R S X (p \\<cdot>\\<^sub>r q) = deg_n R S X p + deg_n R S X q\"", "lemma (in PolynRg) deg_mult_pols1:\"\\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \n          deg R S X (p \\<cdot>\\<^sub>r q) = deg R S X p + deg R S X q\"", "lemma (in PolynRg) const_times_polyn:\"\\<lbrakk>Idomain S; c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n       p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (c \\<cdot>\\<^sub>r p) \\<noteq> \\<zero>  \\<and>\n       deg_n R S X (c \\<cdot>\\<^sub>r p) = deg_n R S X p\"", "lemma (in PolynRg) p_times_monomial_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                                          (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\"", "lemma (in PolynRg) p_times_monomial_nonzero1:\"\\<lbrakk>Idomain S; p \\<in> carrier R; \n       p \\<noteq> \\<zero>; c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>(c \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\"", "lemma (in PolynRg) polyn_ring_integral:\"Idomain S = Idomain R\"", "lemma (in PolynRg) deg_to_X_d:\"Idomain S \\<Longrightarrow>  deg_n R S X (X^\\<^bsup>R d\\<^esup>) = d\"", "lemma (in PolynRg) nonzero_deg_pos:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> \n                                                 0 \\<le> deg R S X p\"", "lemma (in PolynRg) deg_minf_pol_0:\"p \\<in> carrier R \\<Longrightarrow>\n                    (deg R S X p = -\\<infinity>) = (p = \\<zero>)\"", "lemma (in PolynRg) pol_nonzero:\"p \\<in> carrier R \\<Longrightarrow>\n             (0 \\<le> deg R S X p) = (p \\<noteq> \\<zero>)\"", "lemma (in PolynRg) minus_deg_in_aug_minf:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                   - (deg R S X p) \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\"", "lemma (in PolynRg) deg_of_X:\"deg R S X X = 1\"", "lemma (in PolynRg) pol_deg_0:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n                   \\<Longrightarrow>  (deg R S X p = 0) = (p \\<in> carrier S)\"", "lemma (in PolynRg) deg_of_X2n:\"Idomain S \\<Longrightarrow> deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\"", "lemma (in PolynRg) add_pols_nonzero:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n      (deg R S X p) \\<noteq> (deg R S X q)\\<rbrakk>  \\<Longrightarrow>  p \\<plusminus> q \\<noteq> \\<zero>\"", "lemma (in PolynRg) deg_pols_add1:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n                (deg R S X p) < (deg R S X q)\\<rbrakk>  \\<Longrightarrow>  \n                              deg R S X (p \\<plusminus> q) = deg R S X q\"", "lemma (in PolynRg) deg_pols_add2:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) = (deg R S X q)\\<rbrakk>  \\<Longrightarrow> \n               deg R S X (p \\<plusminus> q) \\<le> (deg R S X q)\"", "lemma (in PolynRg) deg_pols_add3:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) \\<le> an n; (deg R S X q) \\<le> an n\\<rbrakk>  \\<Longrightarrow> \n                  deg R S X (p \\<plusminus> q) \\<le> an n\"", "lemma (in PolynRg) const_times_polyn1:\"\\<lbrakk>Idomain S; p\\<in> carrier R; c \\<in> carrier S;\n            c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> deg R S X (c \\<cdot>\\<^sub>r p) = deg R S X p\"", "lemma (in PolynRg) cf_h_len:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n                   pol_coeff S c\\<rbrakk> \\<Longrightarrow> fst (cf_h f c) = fst c\"", "lemma (in PolynRg) cf_h_coeff:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n                   pol_coeff S c\\<rbrakk> \\<Longrightarrow>  pol_coeff B (cf_h f c)\"", "lemma (in PolynRg) cf_h_cmp:\"\\<lbrakk>PolynRg A B Y; pol_coeff S (n, f); h \\<in> rHom S B;\n                    j \\<le> n\\<rbrakk> \\<Longrightarrow>\n                 (snd (cf_h h (n, f))) j = (cmp h f) j\"", "lemma (in PolynRg) cf_h_special_cf:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk> \\<Longrightarrow>\n       polyn_expr A Y (Suc 0) (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n         polyn_expr A Y (Suc 0) (ext_cf B (Suc 0) (C\\<^sub>0 B))\"", "lemma (in PolynRg) polyn_Hom_coeff_to_coeff:\n     \"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; pol_coeff S c\\<rbrakk>\n        \\<Longrightarrow>  pol_coeff B (cf_h f c)\"", "lemma (in PolynRg) cf_h_len1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n        f \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. f x = h x; pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n        fst (cf_h f c) = fst (cf_h h c)\"", "lemma (in PolynRg) cf_h_len2:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n          pol_coeff S c\\<rbrakk> \\<Longrightarrow> fst (cf_h f c) = fst c\"", "lemma (in PolynRg) cmp_pol_coeff:\"\\<lbrakk>f \\<in> rHom S B; \n       pol_coeff S (n, c)\\<rbrakk>  \\<Longrightarrow> pol_coeff B (n,(cmp f c))\"", "lemma (in PolynRg) cmp_pol_coeff_e:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n         pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> pol_coeff B (n, (cmp f c))\"", "lemma (in PolynRg) cf_h_pol_coeff:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n      pol_coeff S (n, f)\\<rbrakk> \\<Longrightarrow> cf_h h (n, f) = (n, cmp h f)\"", "lemma (in PolynRg) cf_h_polyn:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S (n, f)\\<rbrakk> \\<Longrightarrow>\n      polyn_expr A Y n (cf_h h (n, f)) = polyn_expr A Y n (n, (cmp h f))\"", "lemma (in PolynRg) pHom_rHom:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow>\n                                 f \\<in> rHom R A\"", "lemma (in PolynRg) pHom_X_Y:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow>\n                                 f X = Y\"", "lemma (in PolynRg) pHom_memTr:\"\\<lbrakk>PolynRg A B Y; \n      f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow> \n      \\<forall>c. pol_coeff S (n, c) \\<longrightarrow> \n          f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\"", "lemma (in PolynRg) pHom_mem:\"\\<lbrakk>PolynRg A B Y; \n      f \\<in> pHom R S X, A B Y; pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> \n      f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\"", "lemma (in PolynRg) pHom_memc:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n      pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n      f (polyn_expr R X (fst c) c) = polyn_expr A Y (fst c) (cf_h f c)\"", "lemma (in PolynRg) pHom_mem1:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n       p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  f p \\<in> carrier A\"", "lemma (in PolynRg) pHom_pol_mem:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n      p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> \n      f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\"", "lemma (in PolynRg) erh_rHom_coeff:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n       pol_coeff S c\\<rbrakk>  \\<Longrightarrow>  erh R S X A B Y h 0 c = (cmp h (snd c)) 0\"", "lemma (in PolynRg) erh_polyn_exprs:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n       pol_coeff S c; pol_coeff S d; \n       polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>  \\<Longrightarrow>  \n       erh R S X A B Y h (fst c) c  = erh R S X A B Y h (fst d) d\"", "lemma (in PolynRg) erH_rHom_0:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>  \\<Longrightarrow> \n                   (erH R S X A B Y h) \\<zero> = \\<zero>\\<^bsub>A\\<^esub>\"", "lemma (in PolynRg) erH_mem:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n               erH R S X A B Y h p \\<in> carrier A\"", "lemma (in PolynRg) erH_rHom_nonzero:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n      p \\<in> carrier R; (erH R S X A B Y f) p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> p \\<noteq> \\<zero>\"", "lemma (in PolynRg) erH_rHomTr2:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>  \\<Longrightarrow> \n        (erH R S X A B Y h) (1\\<^sub>r) = (1\\<^sub>r\\<^bsub>A\\<^esub>)\"", "lemma (in PolynRg) erH_multTr:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n \\<forall>f g. pol_coeff S (m, f) \\<and> pol_coeff S (((fst c) + m), g) \\<and> \n       (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X m (m, f)) = \n             (polyn_expr R X ((fst c) + m) ((fst c) + m, g))  \\<longrightarrow> \n (polyn_expr A Y (fst c) (cf_h h c)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (polyn_expr A Y m (cf_h h (m, f))) = \n                 (polyn_expr A Y ((fst c) + m) (cf_h h ((fst c)+m, g)))\"", "lemma (in PolynRg) erH_multTr1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S c; pol_coeff S d;  pol_coeff S e; fst e = fst c + fst d; \n    (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X (fst d) d) = \n     polyn_expr R X ((fst c) + (fst d)) e \\<rbrakk> \\<Longrightarrow> \n (polyn_expr A Y (fst c) (cf_h h c)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (polyn_expr A Y (fst d) (cf_h h d))\n  =  (polyn_expr A Y (fst e) (cf_h h e))\"", "lemma (in PolynRg) erHomTr0:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R\\<rbrakk>\n      \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a x) = -\\<^sub>a\\<^bsub>A\\<^esub> (erH R S X A B Y h x)\"", "lemma (in PolynRg) erHomTr1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n      deg_n R S X a = deg_n R S X b\\<rbrakk> \\<Longrightarrow> \n      erH R S X A B Y h (a \\<plusminus> b) = erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub> \n                                             (erH R S X A B Y h b)\"", "lemma (in PolynRg) erHomTr2:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n      deg_n R S X a < deg_n R S X b\\<rbrakk> \\<Longrightarrow> \n      erH R S X A B Y h (a \\<plusminus> b) = erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub> \n                                             (erH R S X A B Y h b)\"", "lemma (in PolynRg) erH_rHom:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n   \\<Longrightarrow> erH R S X A B Y h \\<in> pHom R S X, A B Y\"", "lemma (in PolynRg) erH_q_rHom:\"\\<lbrakk>Idomain S; maximal_ideal S P; \n       PolynRg R' (S /\\<^sub>r P) Y\\<rbrakk> \\<Longrightarrow>\n       erH R S X R' (S /\\<^sub>r P) Y (pj S P) \\<in> pHom R S X, R' (S /\\<^sub>r P) Y\"", "lemma (in PolynRg) erH_add:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n                   p \\<in> carrier R; q \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n          erH R S X A B Y h (p \\<plusminus> q) =\n                 (erH R S X A B Y h p) \\<plusminus>\\<^bsub>A\\<^esub> (erH R S X A B Y h q)\"", "lemma (in PolynRg) erH_minus:\"\\<lbrakk>Idomain S; PolynRg A B Y; \n       h \\<in> rHom S B; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n        erH R S X A B Y h (-\\<^sub>a p) = -\\<^sub>a\\<^bsub>A\\<^esub> (erH R S X A B Y h p)\"", "lemma (in PolynRg) erH_mult:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n      p \\<in> carrier R; q \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n      erH R S X A B Y h (p \\<cdot>\\<^sub>r q) =\n                 (erH R S X A B Y h p) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (erH R S X A B Y h q)\"", "lemma (in PolynRg) erH_rHom_cf:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n                   s \\<in> carrier S\\<rbrakk>  \\<Longrightarrow> erH R S X A B Y h s = h s\"", "lemma (in PolynRg) erH_rHom_coeff:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       pol_coeff S (n, f)\\<rbrakk>  \\<Longrightarrow> pol_coeff B (n, cmp h f)\"", "lemma (in PolynRg) erH_rHom_unique:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n     \\<Longrightarrow>  \\<exists>!g. g \\<in> pHom R S X, A B Y \\<and> (\\<forall>x\\<in>carrier S. h x = g x)\"", "lemma (in PolynRg) erH_rHom_unique1:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       f \\<in> pHom R S X, A B Y; \\<forall>x \\<in> carrier S. f x = h x\\<rbrakk> \\<Longrightarrow> \n       f = (erH R S X A B Y h)\"", "lemma (in PolynRg) pHom_dec_deg:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n       p \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                  deg A B Y (f p) \\<le> deg R S X p\"", "lemma (in PolynRg) erH_map:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> \n      (erH R S X A B Y h) (polyn_expr R X n (n, c)) = \n                           polyn_expr A Y n (n, (cmp h c))\"", "lemma (in PolynRg) divisionTr0:\"\\<lbrakk>Idomain S; p \\<in> carrier R; \n       c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> \n                     lcf R S X (c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) = c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (lcf R S X p)\"", "lemma (in PolynRg) divisionTr1:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n      0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f\\<rbrakk>\n      \\<Longrightarrow> \n      f \\<plusminus> -\\<^sub>a ((lcf R S X f) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((lcf R S X g)\\<^bsup>\\<hyphen> S\\<^esup>) \\<cdot>\\<^sub>r \n                     (X^\\<^bsup>R ((deg_n R S X f) - (deg_n R S X g))\\<^esup>) \\<cdot>\\<^sub>r g) = \\<zero> \\<or> \n      deg_n R S X (f \\<plusminus> -\\<^sub>a ((lcf R S X f) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((lcf R S X g)\\<^bsup>\\<hyphen> S\\<^esup>) \\<cdot>\\<^sub>r \n                 (X^\\<^bsup>R ((deg_n R S X f) - (deg_n R S X g))\\<^esup>) \\<cdot>\\<^sub>r g)) < deg_n R S X f\"", "lemma (in PolynRg) divisionTr2:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n                   0 < deg_n R S X g\\<rbrakk>  \\<Longrightarrow>  \\<forall>f. div_condn R S X n g f\"", "lemma (in PolynRg) divisionTr3:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n      0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n     \\<exists>q\\<in>carrier R. (f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r  g) = \\<zero>) \\<or> ( f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g) \\<noteq> \\<zero> \\<and>\n      deg_n R S X (f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g)) < (deg_n R S X g))\"", "lemma (in PolynRg) divisionTr4:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n       0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n   \\<exists>q\\<in>carrier R. (f = q \\<cdot>\\<^sub>r g) \\<or> (\\<exists>r\\<in>carrier R. r \\<noteq> \\<zero> \\<and> (f = (q \\<cdot>\\<^sub>r g) \\<plusminus> r)\n     \\<and> (deg_n R S X r) < (deg_n R S X g))\"", "lemma (in PolynRg) divisionTr:\"\\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g; \n       f \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n       \\<exists>q\\<in>carrier R. (\\<exists>r\\<in>carrier R. (f = (q \\<cdot>\\<^sub>r g) \\<plusminus> r) \\<and> \n                                  (deg R S X r) < (deg R S X g))\"", "lemma (in PolynRg) rel_prime_equation:\"\\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n      0 < deg R S X f; 0 < deg R S X g; rel_prime_pols R S X f g;\n      h \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n     \\<exists>u \\<in> carrier R. \\<exists>v \\<in> carrier R.\n     (deg R S X u \\<le> amax ((deg R S X h) - (deg R S X f)) (deg R S X g)) \\<and>\n     (deg R S X v \\<le> (deg R S X f)) \\<and> (u \\<cdot>\\<^sub>r f \\<plusminus> (v \\<cdot>\\<^sub>r g) = h)\"", "lemma (in PolynRg) P_mod_whole:\"p \\<in> carrier R \\<Longrightarrow>\n                         P_mod R S X (carrier S) p\"", "lemma (in PolynRg) zero_P_mod:\"ideal S I \\<Longrightarrow> P_mod R S X I \\<zero>\"", "lemma (in PolynRg) P_mod_mod:\"\\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n                     p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> \n                     (\\<forall>j \\<le> (fst c). (snd c) j \\<in> I) = (P_mod R S X I p)\"", "lemma (in PolynRg) monomial_P_mod_mod:\"\\<lbrakk>ideal S I; c \\<in> carrier S; \n       p = c \\<cdot>\\<^sub>r (X^\\<^bsup>R d\\<^esup>)\\<rbrakk> \\<Longrightarrow>  (c \\<in> I) = (P_mod R S X I p)\"", "lemma (in PolynRg) P_mod_add:\"\\<lbrakk>ideal S I; p \\<in> carrier R;\n      q \\<in> carrier R; P_mod R S X I p; P_mod R S X I q\\<rbrakk> \\<Longrightarrow> \n               P_mod R S X I (p \\<plusminus> q)\"", "lemma (in PolynRg) P_mod_minus:\"\\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p\\<rbrakk> \\<Longrightarrow>\n                  P_mod R S X I (-\\<^sub>a p)\"", "lemma (in PolynRg) P_mod_pre:\"\\<lbrakk>ideal S I; pol_coeff S ((Suc n), f); \n       P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X I (polyn_expr R X n (n, f))\"", "lemma (in PolynRg) P_mod_pre1:\"\\<lbrakk>ideal S I; pol_coeff S ((Suc n), f); \n       P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X I (polyn_expr R X n (Suc n, f))\"", "lemma (in PolynRg) P_mod_coeffTr:\"\\<lbrakk>ideal S I; d \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                   (P_mod R S X I d) = (d \\<in> I)\"", "lemma (in PolynRg) P_mod_mult_const:\"\\<lbrakk>ideal S I; ideal S J; \n     pol_coeff S (n, f); P_mod R S X I (polyn_expr R X n (n, f));\n     pol_coeff S (0, g); P_mod R S X J (polyn_expr R X 0 (0, g))\\<rbrakk> \\<Longrightarrow> \n       P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r \n                                        (polyn_expr R X 0 (0, g)))\"", "lemma (in PolynRg) P_mod_mult_const1:\"\\<lbrakk>ideal S I; ideal S J; \n       pol_coeff S (n, f); P_mod R S X I (polyn_expr R X n (n, f));\n       d \\<in> J\\<rbrakk> \\<Longrightarrow> \n       P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r d)\"", "lemma (in PolynRg) P_mod_mult_monomial:\"\\<lbrakk>ideal S I; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n           (P_mod R S X I p ) = (P_mod R S X I (p \\<cdot>\\<^sub>r X^\\<^bsup>R m\\<^esup>))\"", "lemma (in PolynRg) P_mod_multTr:\"\\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f); \n       P_mod R S X I (polyn_expr R X n (n, f))\\<rbrakk> \\<Longrightarrow> \\<forall>g. ((pol_coeff S (m, g)\n       \\<and> (P_mod R S X J (polyn_expr R X m (m, g))))  \\<longrightarrow>  \n          P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) \n           ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g))))\"", "lemma (in PolynRg) P_mod_mult:\"\\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, c); \n      pol_coeff S (m, d); P_mod R S X I (polyn_expr R X n (n, c)); \n      P_mod R S X J (polyn_expr R X m (m, d))\\<rbrakk>  \\<Longrightarrow> \n      P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, c)) \\<cdot>\\<^sub>r \n                                        (polyn_expr R X m (m, d)))\"", "lemma (in PolynRg) P_mod_mult1:\"\\<lbrakk>ideal S I; ideal S J;\n      p \\<in> carrier R; q \\<in> carrier R; P_mod R S X I p; P_mod R S X J q\\<rbrakk>  \\<Longrightarrow> \n      P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) (p \\<cdot>\\<^sub>r q)\"", "lemma (in PolynRg) P_mod_mult2l:\"\\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R; \n      P_mod R S X I p\\<rbrakk>  \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)\"", "lemma (in PolynRg) P_mod_mult2r:\"\\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R; \n      P_mod R S X I q\\<rbrakk>  \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)\"", "lemma (in PolynRg) csrp_fn_pol_coeff:\"\\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       pol_coeff (S /\\<^sub>r P) (n,  c')\\<rbrakk> \\<Longrightarrow>\n                          pol_coeff S (n, (cmp (csrp_fn S P) c'))\"", "lemma (in PolynRg) pj_csrp_mem_coeff:\"\\<lbrakk>ideal S P; pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk>\n      \\<Longrightarrow> \\<forall>j \\<le> n. (pj S P) ((csrp_fn S P) (c' j)) = c' j\"", "lemma (in PolynRg) pHom_pj_csrp:\"\\<lbrakk>Idomain S; ideal S P;\n             PolynRg R' (S /\\<^sub>r P) Y; pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk> \\<Longrightarrow>\n              erH R S X R' (S /\\<^sub>r P) Y (pj S P) \n                 (polyn_expr R X n (n, (cmp (csrp_fn S P) c')))\n                                     = polyn_expr R' Y n (n, c')\"", "lemma (in PolynRg) ext_csrp_fn_nonzero:\"\\<lbrakk>Idomain S; ideal S P; \n      PolynRg R' (S /\\<^sub>r P) Y; g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub> \\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X (deg_n R' (S /\\<^sub>r P) Y g') ((deg_n R' (S /\\<^sub>r P) Y g'),\n          (cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) \\<noteq> \\<zero>\"", "lemma (in PolynRg) erH_inv:\"\\<lbrakk>Idomain S; ideal S P; Ring R'; \n       PolynRg R' (S /\\<^sub>r P) Y; g' \\<in> carrier R'\\<rbrakk> \\<Longrightarrow> \n      \\<exists>g\\<in>carrier R. deg R S X g \\<le> (deg R' (S /\\<^sub>r P) Y g') \\<and>\n                (erH R S X R' (S /\\<^sub>r P) Y (pj S P)) g = g'\"", "lemma (in PolynRg) P_mod_0:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       g \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = \\<zero>\\<^bsub>R'\\<^esub>) = (P_mod R S X P g)\"", "lemma (in PolynRg) P_mod_I_J:\"\\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; \n          I \\<subseteq> J;  P_mod R S X I p\\<rbrakk> \\<Longrightarrow> P_mod R S X J p\"", "lemma (in PolynRg) P_mod_n_1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; \n       P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)) g\\<rbrakk> \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\"", "lemma (in PolynRg) P_mod_n_m:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; \n      m \\<le> n; P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)) g\\<rbrakk> \\<Longrightarrow> \n               P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) g\"", "lemma (in PolynRg) P_mod_diff:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       g \\<in> carrier R; h \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n    (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = (erH R S X R' (S /\\<^sub>r P) Y (pj S P) h))\n     = (P_mod R S X P (g \\<plusminus> -\\<^sub>a h))\"", "lemma (in PolynRg) P_mod_erH:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n        g \\<in> carrier R; v \\<in> carrier R; t \\<in> P \\<rbrakk> \\<Longrightarrow>\n        (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = \n                  (erH R S X R' (S /\\<^sub>r P) Y (pj S P) (g \\<plusminus> (t \\<cdot>\\<^sub>r v))))\"", "lemma (in PolynRg) coeff_principalTr:\"\\<lbrakk>t \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n    \\<forall>f. pol_coeff S (n, f) \\<and> (\\<forall>j \\<le> n. f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n          (\\<exists>f'. pol_coeff S (n, f') \\<and> (\\<forall>j \\<le> n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (f' j)))\"", "lemma (in PolynRg) coeff_principal:\"\\<lbrakk>t \\<in> carrier S; pol_coeff S (n, f); \n          \\<forall>j \\<le> n. f j \\<in> S \\<diamondsuit>\\<^sub>p t\\<rbrakk> \\<Longrightarrow>\n          \\<exists>f'. pol_coeff S (n, f') \\<and> (\\<forall>j \\<le> n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (f' j))\"", "lemma (in PolynRg) Pmod_0_principal:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n            P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\\<rbrakk> \\<Longrightarrow> \\<exists>h\\<in> carrier R. g = t \\<cdot>\\<^sub>r h\"", "lemma (in PolynRg) Pmod0_principal_rev:\"\\<lbrakk>Idomain S; t \\<in> carrier S; \n                     g \\<in> carrier R; \\<exists>h\\<in> carrier R. g = t \\<cdot>\\<^sub>r  h\\<rbrakk> \\<Longrightarrow> \n                                       P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\"", "lemma (in PolynRg) Pmod0_principal_rev1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; \n                     h \\<in> carrier R\\<rbrakk> \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r h)\"", "lemma (in PolynRg) Pmod0_principal_erH_vanish_t:\"\\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \\<rbrakk> \\<Longrightarrow>\n      erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) t = \\<zero>\\<^bsub>R'\\<^esub>\"", "lemma (in PolynRg) P_mod_diffxxx1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>; u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>; \n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h) = t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra; 0 < m; \n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) u)\n         \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) v)\n         \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>))\n           (f \\<plusminus> -\\<^sub>a ((g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))\"", "lemma (in PolynRg) P_mod_diffxxx2:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n   maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n   f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  deg R S X h + \n  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n                                      \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h)); 0 < m\\<rbrakk> \\<Longrightarrow> \n\\<exists>g1 h1. g1 \\<in>carrier R \\<and> h1 \\<in> carrier R \\<and> \n     (deg R S X g1 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (g \\<plusminus> -\\<^sub>a g1) \\<and>  (deg R S X h1 + \n  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n      \\<le> deg R S X f) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (h \\<plusminus> -\\<^sub>a h1) \\<and> \n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a (g1 \\<cdot>\\<^sub>r h1)))\"", "lemma  cart_prod_fst:\"x \\<in> A \\<times> B \\<Longrightarrow> fst x \\<in> A\"", "lemma  cart_prod_snd:\"x \\<in> A \\<times> B \\<Longrightarrow> snd x \\<in> B\"", "lemma cart_prod_split:\"((x,y) \\<in> A \\<times> B) = (x \\<in> A \\<and> y \\<in> B)\"", "lemma (in PolynRg) P_mod_diffxxx3:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n   maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n   f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n   deg R S X (fst gh) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));  \n   deg R S X (snd gh) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst gh) \\<cdot>\\<^sub>r (snd gh))); 0 < m\\<rbrakk> \\<Longrightarrow> \n  \\<exists>gh1. gh1 \\<in>carrier R \\<times> carrier R \\<and> \n       (deg R S X (fst gh1) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))) \\<and> \n   P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst gh) \\<plusminus> -\\<^sub>a (fst gh1)) \\<and> \n       (deg R S X (snd gh1) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<le> \n                                                              deg R S X f) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd gh) \\<plusminus> -\\<^sub>a (snd gh1)) \\<and> \n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a ((fst gh1) \\<cdot>\\<^sub>r (snd gh1))))\"", "lemma (in PolynRg) P_mod_diffxxx4:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n      gh \\<in> carrier R \\<times> carrier R;\n      deg R S X (fst gh) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));  \n   deg R S X (snd gh) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst gh) \\<cdot>\\<^sub>r (snd gh))); 0 < m\\<rbrakk> \\<Longrightarrow> \n  (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh) \\<in> carrier R \\<times> carrier R  \\<and> (deg R S X\n     (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                                   (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)))) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst gh) \\<plusminus> -\\<^sub>a (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<and> \n  (deg R S X (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n        (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<le>  deg R S X f) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd gh) \\<plusminus> -\\<^sub>a (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<and> \n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a ((fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) \\<cdot>\\<^sub>r \n             (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)))))\"", "lemma (in PolynRg) fst_xxx:\" \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; ideal S (S \\<diamondsuit>\\<^sub>p t);  \n   \\<forall>(n::nat). (F n) \\<in> carrier R \\<times> carrier R; \n   \\<forall>m. P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (fst (F m) \\<plusminus> -\\<^sub>a (fst (F (Suc m))))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (fst (F 0) \\<plusminus> -\\<^sub>a (fst (F n)))\"", "lemma (in PolynRg) snd_xxx:\"\\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n   ideal S (S \\<diamondsuit>\\<^sub>p t);  \\<forall>(n::nat). (F n) \\<in> carrier R \\<times> carrier R; \n  \\<forall>m. P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (snd (F m) \\<plusminus> -\\<^sub>a (snd (F (Suc m))))\\<rbrakk> \\<Longrightarrow>\n   P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (snd (F 0) \\<plusminus> -\\<^sub>a (snd (F n)))\"", "lemma (in PolynRg) P_mod_diffxxx5:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n      f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (g, h)) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));  \n  deg R S X (snd (g, h)) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n  (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h))) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h))) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n  (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)) \\<in> carrier R \\<times> carrier R  \\<and>\n   erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                       (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n            erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n   erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                       (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n            erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     (deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                                     (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))))) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                             (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n(deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<le>  deg R S X f) \\<and>\nP_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc m))\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<cdot>\\<^sub>r (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))))\"", "lemma (in PolynRg) P_mod_diffxxx5_1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n  f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                     (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)) \\<in> carrier R \\<times> carrier R  \\<and>\n erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n     (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) = \n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n     (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     (deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<le> deg R' \n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y  \n                    (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                                      (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n (deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) + \n   deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n     (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<le>  deg R S X f) \\<and>\n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                                      (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc m))\\<^esup>)) (f \\<plusminus> -\\<^sub>a \n  ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<cdot>\\<^sub>r (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))))\"", "lemma (in PolynRg) P_mod_diffxxx5_2:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                      (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n                (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m) \\<in> carrier R \\<times> carrier R\"", "lemma (in PolynRg) P_mod_diffxxx5_3:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus>\n                                -\\<^sub>a (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (m + n)))) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus>\n                                -\\<^sub>a (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (m + n))))\"", "lemma (in PolynRg) P_mod_diffxxx5_4:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n    0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n    0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n       deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<le> deg R S X g \\<and>\n       deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<le> deg R S X f\""], "translations": [["", "lemma (in PolynRg) lcf_val_0:\"lcf R S X \\<zero> = \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. lcf R S X \\<zero> = \\<zero>\\<^bsub>S\\<^esub>", "by (simp add:lcf_def s_cf_def)"], ["", "lemma (in PolynRg) lcf_val:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n                    lcf R S X p = (snd (s_cf R S X p)) (fst (s_cf R S X p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> lcf R S X p = snd (s_cf R S X p) (fst (s_cf R S X p))", "by (simp add:lcf_def)"], ["", "lemma (in PolynRg) s_cf_pol_coeff:\"p \\<in> carrier R \\<Longrightarrow>\n                         pol_coeff S (s_cf R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> pol_coeff S (s_cf R S X p)", "apply (simp add:s_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    (p = \\<zero> \\<longrightarrow>\n     pol_coeff S (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n    (p \\<noteq> \\<zero> \\<longrightarrow>\n     pol_coeff S\n      (SOME c.\n          pol_coeff S c \\<and>\n          p = polyn_expr R X (fst c) c \\<and>\n          snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>))", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<zero> \\<in> carrier R; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply (cut_tac subring, frule subring_Ring, \n             simp add:pol_coeff_def Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (SOME c.\n                           pol_coeff S c \\<and>\n                           p = polyn_expr R X (fst c) c \\<and>\n                           snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         pol_coeff S a \\<and>\n                         p = polyn_expr R X (fst a) a \\<and>\n                         snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (frule_tac c = c in coeff_max_bddTr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (subgoal_tac \"p = polyn_expr R X (fst (c_max S c, snd c))\n                                                  (c_max S c, snd c) \\<and>\n                     snd (c_max S c, snd c) (fst (c_max S c, snd c)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> p =\n                         polyn_expr R X (fst (c_max S c, snd c))\n                          (c_max S c, snd c) \\<and>\n                         snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (rule conjI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) (c_max S c, snd c)\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (subst polyn_expr_short[THEN sym], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) c\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (simp add:polyn_c_max)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (rule coeff_max_nonzeroTr, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst c.\n                            snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply (simp add:coeff_0_pol_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S c \\<and>\n        p = polyn_expr R X (fst c) c \\<and>\n        snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) lcf_mem:\"p \\<in> carrier R \\<Longrightarrow> (lcf R S X p) \\<in> carrier S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> lcf R S X p \\<in> carrier S", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> lcf R S X p \\<in> carrier S", "apply (simp add:lcf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X p) (fst (s_cf R S X p))\n                      \\<in> carrier S", "apply (cut_tac pol_coeff_mem[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"],\n          assumption,\n        rule s_cf_pol_coeff, assumption, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) s_cf_expr0:\"p \\<in> carrier R \\<Longrightarrow>\n      pol_coeff S (s_cf R S X p) \\<and>\n      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    pol_coeff S (s_cf R S X p) \\<and>\n    p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p) \\<and>\n                      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)", "apply (simp add:s_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       \\<zero> =\n                       polyn_expr R X 0\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       p =\n                       polyn_expr R X\n                        (fst (SOME c.\n                                 pol_coeff S c \\<and>\n                                 p = polyn_expr R X (fst c) c \\<and>\n                                 snd c (fst c) \\<noteq>\n                                 \\<zero>\\<^bsub>S\\<^esub>))\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<zero> \\<in> carrier R; Subring R S; Ring S;\n     p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      \\<zero> =\n                      polyn_expr R X 0\n                       (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       \\<zero> =\n                       polyn_expr R X 0\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       p =\n                       polyn_expr R X\n                        (fst (SOME c.\n                                 pol_coeff S c \\<and>\n                                 p = polyn_expr R X (fst c) c \\<and>\n                                 snd c (fst c) \\<noteq>\n                                 \\<zero>\\<^bsub>S\\<^esub>))\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply (rule conjI, simp add:pol_coeff_def, simp add:Ring.ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<zero> \\<in> carrier R; Subring R S; Ring S;\n     p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<zero> =\n                      polyn_expr R X 0\n                       (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       \\<zero> =\n                       polyn_expr R X 0\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       p =\n                       polyn_expr R X\n                        (fst (SOME c.\n                                 pol_coeff S c \\<and>\n                                 p = polyn_expr R X (fst c) c \\<and>\n                                 snd c (fst c) \\<noteq>\n                                 \\<zero>\\<^bsub>S\\<^esub>))\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply (simp add:polyn_expr_def,\n        simp add:Subring_zero_ring_zero, simp add:ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       \\<zero> =\n                       polyn_expr R X 0\n                        (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       pol_coeff S\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                       p =\n                       polyn_expr R X\n                        (fst (SOME c.\n                                 pol_coeff S c \\<and>\n                                 p = polyn_expr R X (fst c) c \\<and>\n                                 snd c (fst c) \\<noteq>\n                                 \\<zero>\\<^bsub>S\\<^esub>))\n                        (SOME c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c \\<and>\n                            snd c (fst c) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (SOME c.\n                           pol_coeff S c \\<and>\n                           p = polyn_expr R X (fst c) c \\<and>\n                           snd c (fst c) \\<noteq>\n                           \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      p =\n                      polyn_expr R X\n                       (fst (SOME c.\n                                pol_coeff S c \\<and>\n                                p = polyn_expr R X (fst c) c \\<and>\n                                snd c (fst c) \\<noteq>\n                                \\<zero>\\<^bsub>S\\<^esub>))\n                       (SOME c.\n                           pol_coeff S c \\<and>\n                           p = polyn_expr R X (fst c) c \\<and>\n                           snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         pol_coeff S a \\<and>\n                         p = polyn_expr R X (fst a) a \\<and>\n                         snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (frule_tac c = c in coeff_max_bddTr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        c_max S c \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (subgoal_tac \"p = polyn_expr R X (fst (c_max S c, snd c))\n                                                  (c_max S c, snd c) \\<and>\n                     snd (c_max S c, snd c) (fst (c_max S c, snd c)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> p =\n                         polyn_expr R X (fst (c_max S c, snd c))\n                          (c_max S c, snd c) \\<and>\n                         snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (rule conjI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; Subring R S;\n        Ring S; polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) (c_max S c, snd c)\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (subst polyn_expr_short[THEN sym], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; Subring R S;\n        Ring S; polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) c\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (simp add:polyn_c_max)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; Subring R S;\n        Ring S; polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (rule coeff_max_nonzeroTr, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; Subring R S;\n        Ring S; polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst c.\n                            snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply (simp add:coeff_0_pol_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and> p = polyn_expr R X (fst x) x", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pos_deg_nonzero:\"\\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk> \\<Longrightarrow>\n                     p \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>", "apply (cut_tac s_cf_expr0[of p], (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (frule pol_deg_eq_c_max[of p \"s_cf R S X p\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     deg_n R S X p = c_max S (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (simp, thin_tac \"deg_n R S X p = c_max S (s_cf R S X p)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; 0 < c_max S (s_cf R S X p);\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (simp add:c_max_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R;\n     0 < (if \\<forall>x\\<le>fst (s_cf R S X p).\n                snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub>\n          then 0\n          else n_max\n                {j. j \\<le> fst (s_cf R S X p) \\<and>\n                    snd (s_cf R S X p) j \\<noteq>\n                    \\<zero>\\<^bsub>S\\<^esub>});\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (case_tac \"\\<forall>x\\<le>fst (s_cf R S X p). snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub> \", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R;\n     0 < (if \\<forall>x\\<le>fst (s_cf R S X p).\n                snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub>\n          then 0\n          else n_max\n                {j. j \\<le> fst (s_cf R S X p) \\<and>\n                    snd (s_cf R S X p) j \\<noteq>\n                    \\<zero>\\<^bsub>S\\<^esub>});\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     \\<not> (\\<forall>x\\<le>fst (s_cf R S X p).\n                snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (thin_tac \"0 < (if \\<forall>x\\<le>fst (s_cf R S X p). snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub> \n   then 0 else n_max\n                {j. j \\<le> fst (s_cf R S X p) \\<and> snd (s_cf R S X p) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     \\<not> (\\<forall>x\\<le>fst (s_cf R S X p).\n                snd (s_cf R S X p) x = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply (simp add:coeff_0_pol_0[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; 0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) s_cf_expr:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n      pol_coeff S (s_cf R S X p) \\<and>\n      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<and>\n      (snd (s_cf R S X p)) (fst (s_cf R S X p)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p) \\<and>\n                      p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (s_cf R S X p) \\<and>\n                      snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:s_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (SOME c.\n                           pol_coeff S c \\<and>\n                           p = polyn_expr R X (fst c) c \\<and>\n                           snd c (fst c) \\<noteq>\n                           \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      p =\n                      polyn_expr R X\n                       (fst (SOME c.\n                                pol_coeff S c \\<and>\n                                p = polyn_expr R X (fst c) c \\<and>\n                                snd c (fst c) \\<noteq>\n                                \\<zero>\\<^bsub>S\\<^esub>))\n                       (SOME c.\n                           pol_coeff S c \\<and>\n                           p = polyn_expr R X (fst c) c \\<and>\n                           snd c (fst c) \\<noteq>\n                           \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      snd (SOME c.\n                              pol_coeff S c \\<and>\n                              p = polyn_expr R X (fst c) c \\<and>\n                              snd c (fst c) \\<noteq>\n                              \\<zero>\\<^bsub>S\\<^esub>)\n                       (fst (SOME c.\n                                pol_coeff S c \\<and>\n                                p = polyn_expr R X (fst c) c \\<and>\n                                snd c (fst c) \\<noteq>\n                                \\<zero>\\<^bsub>S\\<^esub>)) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         pol_coeff S a \\<and>\n                         p = polyn_expr R X (fst a) a \\<and>\n                         snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c = c in coeff_max_bddTr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            pol_coeff S a \\<and>\n                            p = polyn_expr R X (fst a) a \\<and>\n                            snd a (fst a) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (subgoal_tac \"p = polyn_expr R X (fst (c_max S c, snd c))\n                                                  (c_max S c, snd c) \\<and>\n                     snd (c_max S c, snd c) (fst (c_max S c, snd c)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> p =\n                         polyn_expr R X (fst (c_max S c, snd c))\n                          (c_max S c, snd c) \\<and>\n                         snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (rule conjI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) (c_max S c, snd c)\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (subst polyn_expr_short[THEN sym], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c =\n                         polyn_expr R X (c_max S c) c\n 2. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:polyn_c_max)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (c_max S c, snd c)\n                          (fst (c_max S c, snd c)) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (rule coeff_max_nonzeroTr, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; c_max S c \\<le> fst c;\n        pol_coeff S (c_max S c, snd c)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst c.\n                            snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:coeff_0_pol_0[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n        pol_coeff S x \\<and>\n        p = polyn_expr R X (fst x) x \\<and>\n        snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S x \\<and>\n                         p = polyn_expr R X (fst x) x \\<and>\n                         snd x (fst x) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) lcf_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n                                          lcf R S X p \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> lcf R S X p \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (frule s_cf_expr[of p], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p) \\<and>\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<and>\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> lcf R S X p \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:lcf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) s_cf_deg:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                  deg_n R S X p = fst (s_cf R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = fst (s_cf R S X p)", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = fst (s_cf R S X p)", "apply (simp add:pol_deg_n[of p \"s_cf R S X p\" \"fst (s_cf R S X p)\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_expr_edeg:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> (an d)\\<rbrakk> \\<Longrightarrow> \n       \\<exists>f. (pol_coeff S f \\<and> fst f = d \\<and> p = polyn_expr R X d f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (subgoal_tac \"pol_coeff S (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and> fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) = d \\<and> \n              p = polyn_expr R X d (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) =\n                      d \\<and>\n                      p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) =\n                      d \\<and>\n                      p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (simp add:pol_coeff_def, cut_tac Ring.ring_zero[of S], simp,\n        cut_tac subring, simp add:subring_Ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>) =\n                      d \\<and>\n                      p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (cut_tac coeff_0_pol_0[of \"(d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\" d], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (simp add:pol_coeff_def, cut_tac Ring.ring_zero[of S], simp,\n        cut_tac subring, simp add:subring_Ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         pol_coeff S f \\<and>\n                         fst f = d \\<and> p = polyn_expr R X d f", "apply (simp add:deg_def na_an, simp add:ale_natle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> d; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>b.\n                         pol_coeff S (d, b) \\<and>\n                         p = polyn_expr R X d (d, b)", "apply (simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>b.\n                         pol_coeff S (d, b) \\<and>\n                         p = polyn_expr R X d (d, b)", "apply (subgoal_tac \"pol_coeff S (d, \\<lambda>j. (if j \\<le> (fst (s_cf R S X p)) then\n         (snd (s_cf R S X p) j) else \\<zero>\\<^bsub>S\\<^esub>)) \\<and>\n         p = polyn_expr R X d (d, \\<lambda>j. (if j \\<le> (fst (s_cf R S X p)) then\n         (snd (s_cf R S X p) j) else \\<zero>\\<^bsub>S\\<^esub>))\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                      p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (simp add:pol_coeff_def, rule allI, rule impI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n        p \\<noteq> \\<zero>;\n        \\<forall>j\\<le>fst (s_cf R S X p).\n           snd (s_cf R S X p) j \\<in> carrier S;\n        p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> j \\<le> fst (s_cf R S X p); j \\<le> d\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (cut_tac subring, simp add:subring_Ring, simp add:subring_Ring[of S]\n         Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (case_tac \"fst (s_cf R S X p) = d\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> d then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (subst polyn_exprs_eq[of \"(d, \\<lambda>j. if j \\<le> d then snd (s_cf R S X p) j \n         else \\<zero>\\<^bsub>S\\<^esub>)\" \"s_cf R S X p\" d])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> d then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> min (fst (d,\n  \\<lambda>j.\n     if j \\<le> d then snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>))\n                               (fst (s_cf R S X p))\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> d then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         snd (s_cf R S X p) j\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X d (s_cf R S X p)\n 6. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (simp add:pol_coeff_def, cut_tac Ring.ring_zero[of S], simp,\n          cut_tac subring, simp add:subring_Ring, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> d then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         snd (s_cf R S X p) j\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p); p = polyn_expr R X d (s_cf R S X p);\n     snd (s_cf R S X p) d \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) = d\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X d (s_cf R S X p)\n 3. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule allI, rule impI, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; fst (s_cf R S X p) \\<le> d;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (drule noteq_le_less[of \"fst (s_cf R S X p)\" d], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)", "apply (cut_tac polyn_n_m1[of \"(d, \\<lambda>j. if j \\<le> fst (s_cf R S X p) then \n        snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>)\" \"fst (s_cf R S X p)\" d], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       (if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n        else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) Suc (fst (s_cf R S X p)) d\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (cut_tac higher_part_zero[of \"(d, \\<lambda>j. if j \\<le> fst (s_cf R S X p) then \n     snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>)\" \"fst (s_cf R S X p)\"], simp,\n     thin_tac \"polyn_expr R X d\n      (d, \\<lambda>j. if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p)) (d, \\<lambda>j. if j \\<le> fst (s_cf R S X p) \n      then snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus> \\<zero>\",\n     thin_tac \"\\<Sigma>\\<^sub>f R (\\<lambda>j. (if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n                else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) (Suc (fst (s_cf R S X p))) d = \\<zero>\")"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n                      \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (subst polyn_exprs_eq[of \"(d, \\<lambda>j. if j \\<le> fst (s_cf R S X p) then \n       snd (s_cf R S X p) j else \\<zero>\\<^bsub>S\\<^esub>)\" \"s_cf R S X p\" \"fst (s_cf R S X p)\"])"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      \\<le> min (fst (d,\n\\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>))\n                             (fst (s_cf R S X p))\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X p).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         snd (s_cf R S X p) j\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (s_cf R S X p) \\<plusminus>\n                      \\<zero>\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 8. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 9. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 10. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n      pol_coeff S (s_cf R S X p);\n      p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n      snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n      \\<zero>\\<^bsub>S\\<^esub>;\n      fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n     \\<Longrightarrow> fst (s_cf R S X p) < d\nA total of 11 subgoals...", "apply (simp add:pol_coeff_def, rule allI, rule impI, rule impI,\n         cut_tac subring, simp add:subring_Ring, simp add:subring_Ring[of S]\n         Ring.ring_zero, assumption+)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      \\<le> min (fst (d,\n\\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>))\n                             (fst (s_cf R S X p))\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X p).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         snd (s_cf R S X p) j\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (s_cf R S X p) \\<plusminus>\n                      \\<zero>\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 8. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 9. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (simp)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X p).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         snd (s_cf R S X p) j\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (s_cf R S X p) \\<plusminus>\n                      \\<zero>\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 8. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (s_cf R S X p))\n                       (s_cf R S X p) \\<plusminus>\n                      \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (frule polyn_mem[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"], simp+)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> p = p \\<plusminus> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 7. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (cut_tac ring_is_ag, simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 6. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (simp add:pol_coeff_def, rule allI, rule impI, rule impI,\n         cut_tac subring, simp add:subring_Ring, simp add:subring_Ring[of S]\n         Ring.ring_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p)\n                      < fst (d, \\<lambda>j.\n                                   if j \\<le> fst (s_cf R S X p)\n                                   then snd (s_cf R S X p) j\n                                   else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 5. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) < d;\n     polyn_expr R X d\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (d, \\<lambda>j.\n             if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n             else \\<zero>\\<^bsub>S\\<^esub>) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            (if j \\<le> fst (s_cf R S X p)\n                             then snd (s_cf R S X p) j\n                             else \\<zero>\\<^bsub>S\\<^esub>) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst (s_cf R S X p)) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst (s_cf R S X p)))\n(fst (d, \\<lambda>j.\n            if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n            else \\<zero>\\<^bsub>S\\<^esub>)).\n                         snd (d, \\<lambda>j.\n                                    if j \\<le> fst (s_cf R S X p)\n                                    then snd (s_cf R S X p) j\n                                    else \\<zero>\\<^bsub>S\\<^esub>)\n                          j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (rule ballI, simp add:nset_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, \\<lambda>j.\n                              if j \\<le> fst (s_cf R S X p)\n                              then snd (s_cf R S X p) j\n                              else \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply (simp add:pol_coeff_def, rule allI, rule impI, rule impI,\n         cut_tac subring, simp add:subring_Ring, simp add:subring_Ring[of S]\n         Ring.ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) < d\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<noteq> d; fst (s_cf R S X p) < d\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (d, \\<lambda>j.\n   if j \\<le> fst (s_cf R S X p) then snd (s_cf R S X p) j\n   else \\<zero>\\<^bsub>S\\<^esub>)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) cf_scf:\"\\<lbrakk>pol_coeff S c; k \\<le> fst c; polyn_expr R X k c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow>  \\<forall>j \\<le> fst (s_cf R S X (polyn_expr R X k c)).\n              snd (s_cf R S X (polyn_expr R X k c)) j = snd c j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X (polyn_expr R X k c)).\n                         snd (s_cf R S X (polyn_expr R X k c)) j = snd c j", "apply (frule polyn_mem[of c k], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c \\<noteq> \\<zero>;\n     polyn_expr R X k c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X (polyn_expr R X k c)).\n                         snd (s_cf R S X (polyn_expr R X k c)) j = snd c j", "apply (simp add:polyn_expr_short[of c k],\n       rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X (polyn_expr R X k (k, snd c))) j =\n                         snd c j", "apply (cut_tac pol_deg_le_n1[of \"polyn_expr R X k c\" c k],\n       frule s_cf_expr0[of \"polyn_expr R X k (k, snd c)\"], erule conjE)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)));\n        deg_n R S X (polyn_expr R X k c) \\<le> k;\n        pol_coeff S (s_cf R S X (polyn_expr R X k (k, snd c)));\n        polyn_expr R X k (k, snd c) =\n        polyn_expr R X (fst (s_cf R S X (polyn_expr R X k (k, snd c))))\n         (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X (polyn_expr R X k (k, snd c))) j =\n                         snd c j\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 4. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 5. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k c", "apply (rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)));\n        deg_n R S X (polyn_expr R X k c) \\<le> k;\n        pol_coeff S (s_cf R S X (polyn_expr R X k (k, snd c)));\n        polyn_expr R X (fst (s_cf R S X (polyn_expr R X k (k, snd c))))\n         (s_cf R S X (polyn_expr R X k (k, snd c))) =\n        polyn_expr R X k (k, snd c)\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X (polyn_expr R X k (k, snd c))) j =\n                         snd c j\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 4. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 5. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k c", "apply (case_tac \"fst (s_cf R S X (polyn_expr R X k (k, snd c))) = k\",\n       simp,\n       cut_tac c = \"s_cf R S X (polyn_expr R X k (k, snd c))\" and \n       d = \"(k, snd c)\" in pol_expr_unique2,\n       simp add:s_cf_pol_coeff, simp add:split_pol_coeff, simp,\n        simp, simp add:polyn_expr_short[THEN sym, of c k])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k c \\<noteq> \\<zero>;\n        polyn_expr R X k c \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k c));\n        deg_n R S X (polyn_expr R X k c) \\<le> k;\n        pol_coeff S (s_cf R S X (polyn_expr R X k c));\n        polyn_expr R X (fst (s_cf R S X (polyn_expr R X k c)))\n         (s_cf R S X (polyn_expr R X k c)) =\n        polyn_expr R X k c;\n        fst (s_cf R S X (polyn_expr R X k c)) \\<noteq> k\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X (polyn_expr R X k c)) j = snd c j\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 4. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 5. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k c", "apply (simp add:s_cf_deg[of \"polyn_expr R X k c\"],\n        drule noteq_le_less[of \"fst (s_cf R S X (polyn_expr R X k c))\" k],\n        assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k c \\<noteq> \\<zero>;\n        polyn_expr R X k c \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k c));\n        pol_coeff S (s_cf R S X (polyn_expr R X k c));\n        polyn_expr R X (fst (s_cf R S X (polyn_expr R X k c)))\n         (s_cf R S X (polyn_expr R X k c)) =\n        polyn_expr R X k c;\n        fst (s_cf R S X (polyn_expr R X k c)) \\<noteq> k;\n        fst (s_cf R S X (polyn_expr R X k c)) < k\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X (polyn_expr R X k c)) j = snd c j\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 4. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 5. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k c", "apply (frule pol_expr_unique3[of \"s_cf R S X (polyn_expr R X k c)\" \n         \"(k, snd c)\"], simp add:split_pol_coeff, simp,\n        simp add:polyn_expr_short[THEN sym, of c k])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 4. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        polyn_expr R X k (k, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X k (k, snd c) \\<in> carrier R;\n        j \\<le> fst (s_cf R S X (polyn_expr R X k (k, snd c)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k c", "apply (simp add:polyn_expr_short[THEN sym, of c k], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  scf_cond :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, 'a, \n                  nat, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> bool\" where\n  \"scf_cond R S X p d c \\<longleftrightarrow> pol_coeff S c \\<and> fst c = d \\<and> p = polyn_expr R X d c\""], ["", "definition\n  scf_d :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, 'a, nat]\n                \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'a)\" where\n  \"scf_d R S X p d = (SOME f. scf_cond R S X p d f)\""], ["", "(** system of coefficients, coeff_length d **)"], ["", "lemma (in PolynRg) scf_d_polTr:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk> \\<Longrightarrow> \n           scf_cond R S X p d (scf_d R S X p d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk>\n    \\<Longrightarrow> scf_cond R S X p d (scf_d R S X p d)", "apply (simp add:scf_d_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk>\n    \\<Longrightarrow> scf_cond R S X p d (SOME f. scf_cond R S X p d f)", "apply (rule_tac P = \"scf_cond R S X p d\" in someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a. scf_cond R S X p d a\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n        scf_cond R S X p d x\\<rbrakk>\n       \\<Longrightarrow> scf_cond R S X p d x", "apply (frule pol_expr_edeg[of \"p\" \"d\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     \\<exists>f.\n        pol_coeff S f \\<and>\n        fst f = d \\<and> p = polyn_expr R X d f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a. scf_cond R S X p d a\n 2. \\<And>x.\n       \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n        scf_cond R S X p d x\\<rbrakk>\n       \\<Longrightarrow> scf_cond R S X p d x", "apply (simp add:scf_cond_def, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) scf_d_pol:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk> \\<Longrightarrow> \n      pol_coeff S (scf_d R S X p d) \\<and> fst (scf_d R S X p d) = d \\<and>\n       p = polyn_expr R X d (scf_d R S X p d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X p d) \\<and>\n                      fst (scf_d R S X p d) = d \\<and>\n                      p = polyn_expr R X d (scf_d R S X p d)", "apply (frule scf_d_polTr[of \"p\" \"d\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an d;\n     scf_cond R S X p d (scf_d R S X p d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X p d) \\<and>\n                      fst (scf_d R S X p d) = d \\<and>\n                      p = polyn_expr R X d (scf_d R S X p d)", "apply (simp add:scf_cond_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_expr_of_X:\n       \"X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))", "apply (cut_tac X_mem_R, cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R; Subring R S\\<rbrakk>\n    \\<Longrightarrow> X =\n                      polyn_expr R X (Suc 0)\n                       (ext_cf S (Suc 0) (C\\<^sub>0 S))", "apply (cut_tac X_to_d[of \"Suc 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R; Subring R S;\n     X^\\<^bsup>R Suc 0\\<^esup> =\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> X =\n                      polyn_expr R X (Suc 0)\n                       (ext_cf S (Suc 0) (C\\<^sub>0 S))", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_n_of_X:\"deg_n R S X X = Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deg_n R S X X = Suc 0", "apply (cut_tac X_mem_R, cut_tac polyn_ring_S_nonzero,\n       cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (cut_tac pol_expr_of_X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (cut_tac special_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (frule ext_cf_pol_coeff[of \"C\\<^sub>0 S\" \"Suc 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (frule pol_deg_eq_c_max[of X \"ext_cf S (Suc 0) (C\\<^sub>0 S)\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> X =\n                      polyn_expr R X (fst (ext_cf S (Suc 0) (C\\<^sub>0 S)))\n                       (ext_cf S (Suc 0) (C\\<^sub>0 S))\n 2. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     deg_n R S X X = c_max S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (simp add:ext_cf_len special_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     deg_n R S X X = c_max S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X X = Suc 0", "apply (simp add:c_max_ext_special_cf)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_X:\"cf_sol R S X X c \\<Longrightarrow>\n              snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and> snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. cf_sol R S X X c \\<Longrightarrow>\n    snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n    snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (simp add:cf_sol_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac pol_expr_of_X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac special_cf_pol_coeff,\n               frule ext_cf_pol_coeff[of \"C\\<^sub>0 S\" \"Suc 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac X_mem_R, cut_tac polyn_ring_X_nonzero,\n       cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (frule pol_deg_le_n[of X c], assumption+, simp add:deg_n_of_X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (case_tac \"fst c = Suc 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c = Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (frule box_equation[of X \"polyn_expr R X (Suc 0) \n       (ext_cf S (Suc 0) (C\\<^sub>0 S))\" \"polyn_expr R X (fst c) c\"], assumption+,\n       thin_tac \"X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\",\n       thin_tac \"X = polyn_expr R X (fst c) c\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c; fst c = Suc 0;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac pol_expr_unique2[of \"ext_cf S (Suc 0) (C\\<^sub>0 S)\" c],\n       simp, simp add:ext_cf_len special_cf_len, rule conjI,\n       drule_tac a = 0 in forall_spec, simp,\n       simp add:ext_special_cf_lo_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; fst c = Suc 0;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) c;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd c j\\<rbrakk>\n    \\<Longrightarrow> snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c; fst c = Suc 0;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c; fst c = Suc 0;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c; fst c = Suc 0;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> fst (ext_cf S (Suc 0) (C\\<^sub>0 S)) = fst c\n 5. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply( drule_tac a = \"Suc 0\" in forall_spec, simp,\n       simp add:ext_special_cf_hi, assumption+,\n       simp add:ext_cf_len special_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (frule noteq_le_less[of \"Suc 0\" \"fst c\"],rule not_sym, assumption,\n       cut_tac pol_expr_unique3[of \"ext_cf S (Suc 0) (C\\<^sub>0 S)\" c],\n       simp add:ext_cf_len special_cf_len,\n       erule conjE,\n       thin_tac \"\\<forall>j\\<in>nset (Suc (Suc 0)) (fst c). snd c j = \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 < fst c;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd c j\\<rbrakk>\n    \\<Longrightarrow> snd c 0 = \\<zero>\\<^bsub>S\\<^esub> \\<and>\n                      snd c (Suc 0) = 1\\<^sub>r\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0; Suc 0 < fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\n 3. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0; Suc 0 < fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 4. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0; Suc 0 < fst c\\<rbrakk>\n    \\<Longrightarrow> fst (ext_cf S (Suc 0) (C\\<^sub>0 S)) < fst c", "apply (rule conjI,\n        drule_tac a = 0 in forall_spec, simp,\n        simp add:ext_special_cf_lo_zero,\n        drule_tac a = \"Suc 0\" in forall_spec, simp,\n        simp add:ext_special_cf_hi,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; X = polyn_expr R X (fst c) c;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Subring R S; Suc 0 \\<le> fst c;\n     fst c \\<noteq> Suc 0; Suc 0 < fst c\\<rbrakk>\n    \\<Longrightarrow> fst (ext_cf S (Suc 0) (C\\<^sub>0 S)) < fst c", "apply (simp add:ext_cf_len special_cf_len)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_of_deg0:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n      \\<Longrightarrow>  (deg_n R S X p = 0) = (p \\<in> carrier S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (deg_n R S X p = 0) = (p \\<in> carrier S)", "apply (cut_tac subring,\n       frule subring_Ring,\n       cut_tac ring_is_ag,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S\\<rbrakk>\n    \\<Longrightarrow> (deg_n R S X p = 0) = (p \\<in> carrier S)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; deg_n R S X p = 0\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = 0", "apply (frule s_cf_expr[of p], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; deg_n R S X p = 0;\n     pol_coeff S (s_cf R S X p) \\<and>\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<and>\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = 0", "apply (simp add:s_cf_deg, (erule conjE)+, simp add:polyn_expr_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; fst (s_cf R S X p) = 0; pol_coeff S (s_cf R S X p);\n     p = snd (s_cf R S X p) 0 \\<cdot>\\<^sub>r 1\\<^sub>r;\n     snd (s_cf R S X p) 0 \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = 0", "apply (frule pol_coeff_mem[of \"s_cf R S X p\" 0], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; fst (s_cf R S X p) = 0; pol_coeff S (s_cf R S X p);\n     p = snd (s_cf R S X p) 0 \\<cdot>\\<^sub>r 1\\<^sub>r;\n     snd (s_cf R S X p) 0 \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X p) 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = 0", "apply (cut_tac mem_subring_mem_ring[of S \"snd (s_cf R S X p) 0\"],\n        simp add:ring_r_one, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = 0", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+,\n       simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) = 0", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (subgoal_tac \"pol_coeff S (0, (\\<lambda>j. p)) \\<and> \n                      p = polyn_expr R X 0 (0, (\\<lambda>j. p))\", erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     p = polyn_expr R X 0 (0, \\<lambda>j. p)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (cut_tac a = \"polyn_expr R X 0 (0, \\<lambda>j. p)\" and \n               b = \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\" in \n               aGroup.ag_eq_diffzero[of R],  assumption+, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     p = polyn_expr R X 0 (0, \\<lambda>j. p);\n     (polyn_expr R X 0 (0, \\<lambda>j. p) =\n      polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)) =\n     (polyn_expr R X 0 (0, \\<lambda>j. p) \\<plusminus>\n      -\\<^sub>a polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) =\n      \\<zero>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac c = \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\" in \n         box_equation[of p \"polyn_expr R X 0 (0, \\<lambda>j. p)\"], assumption,\n        thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n        thin_tac \"p = polyn_expr R X 0 (0, \\<lambda>j. p)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<plusminus>\n     -\\<^sub>a polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) =\n     \\<zero>;\n     polyn_expr R X 0 (0, \\<lambda>j. p) =\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (simp only:polyn_minus_m_cf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<plusminus>\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p)) =\n     \\<zero>;\n     polyn_expr R X 0 (0, \\<lambda>j. p) =\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (rotate_tac -2, drule sym, simp,\n        thin_tac \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = \n                 polyn_expr R X 0 (0, \\<lambda>j. p)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>polyn_expr R X 0 (0, \\<lambda>j. p) \\<plusminus>\n             polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p)) =\n             \\<zero>;\n     p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S; aGroup R;\n     aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac c = \"s_cf R S X p\" in m_cf_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>polyn_expr R X 0 (0, \\<lambda>j. p) \\<plusminus>\n             polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p)) =\n             \\<zero>;\n     p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S; aGroup R;\n     aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S (m_cf S (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac d = \"m_cf S (s_cf R S X p)\" in polyn_add1[of \"(0, \\<lambda>j. p)\"],\n        assumption,\n        simp add:m_cf_len,\n        thin_tac \"polyn_expr R X 0 (0, \\<lambda>j. p) \\<plusminus>\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p)) =\n     polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R;\n     p \\<noteq>\n     polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p)));\n     Subring R S; Ring S; aGroup R; aGroup S; p \\<in> carrier S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S (m_cf S (s_cf R S X p));\n     \\<zero> =\n     polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p)))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (rotate_tac -1, drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p))) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac d = \"m_cf S (s_cf R S X p)\" in \n                      add_cf_pol_coeff[of \"(0, \\<lambda>j. p)\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p))) =\n     \\<zero>;\n     pol_coeff S\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p)))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac c1 = \"add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p))\" and \n        k1 = \"fst (s_cf R S X p)\" in\n         coeff_0_pol_0[THEN sym],\n       simp add:add_cf_len m_cf_len, simp,\n       thin_tac \"pol_coeff S (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p)))\",\n       thin_tac \"polyn_expr R X (fst (s_cf R S X p))\n      (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p))) = \\<zero>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S (m_cf S (s_cf R S X p));\n     \\<forall>j\\<le>fst (s_cf R S X p).\n        snd (add_cf S (0, \\<lambda>j. p) (m_cf S (s_cf R S X p))) j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (drule_tac a = \"fst (s_cf R S X p)\" in forall_spec, simp,\n        simp add:add_cf_def m_cf_len m_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p); pol_coeff S (0, \\<lambda>j. p);\n     pol_coeff S\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j);\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) (fst (s_cf R S X p)) =\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (frule_tac c = \"s_cf R S X p\" and j = \"fst (s_cf R S X p)\" in \n        pol_coeff_mem, simp,\n        frule_tac x = \"snd (s_cf R S X p) (fst (s_cf R S X p))\" in \n        aGroup.ag_inv_inv[of S],\n        assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p) \\<and>\n                      p = polyn_expr R X 0 (0, \\<lambda>j. p)", "apply (subst polyn_expr_def, simp add:ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; aGroup S; p \\<in> carrier S; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     0 < fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. p)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pols_const:\"\\<lbrakk>p \\<in> carrier R; (deg R S X p) \\<le> 0\\<rbrakk>  \\<Longrightarrow> \n                         p \\<in> carrier S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S", "apply (cut_tac subring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0; p = \\<zero>;\n     Subring R S\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S", "apply (frule Subring_zero_ring_zero[THEN sym, of S], simp,\n       cut_tac subring,\n       frule subring_Ring[of S],\n       rule Ring.ring_zero[of S], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> 0;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier S", "apply (subst pol_of_deg0[THEN sym], assumption+,\n       simp add:deg_def,\n       simp only:an_0[THEN sym],\n       simp add:an_inj)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) less_deg_add_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; \n       q \\<in> carrier R; q \\<noteq> \\<zero>; \n       (deg_n R S X p) < (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE,\n       frule ex_polyn_expr[of q], erule exE, erule conjE,\n       rename_tac c d)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n        q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d\\<rbrakk>\n       \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (frule_tac c = c in pol_deg_eq_c_max[of p], assumption+,\n       frule_tac c = d in pol_deg_eq_c_max[of q], assumption+,\n       frule_tac c = c in coeff_max_bddTr, \n       frule_tac c = d in coeff_max_bddTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n        q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; deg_n R S X p = c_max S c;\n        deg_n R S X q = c_max S d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption,\n       frule_tac c = d and n = \"c_max S d\" in pol_coeff_le, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n        q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; deg_n R S X p = c_max S c;\n        deg_n R S X q = c_max S d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d;\n        deg_n R S X (polyn_expr R X (fst c) c) = c_max S c;\n        deg_n R S X (polyn_expr R X (fst d) d) = c_max S d;\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus>\n                         polyn_expr R X (fst d) d \\<noteq>\n                         \\<zero>", "apply (subst polyn_c_max, assumption,\n       subst polyn_c_max, assumption,\n       subst polyn_expr_short, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d;\n        deg_n R S X (polyn_expr R X (fst c) c) = c_max S c;\n        deg_n R S X (polyn_expr R X (fst d) d) = c_max S d;\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S c)\n                          (c_max S c, snd c) \\<plusminus>\n                         polyn_expr R X (c_max S d) d \\<noteq>\n                         \\<zero>", "apply (frule_tac c = d and k = \"c_max S d\" in polyn_expr_short, assumption+,\n       simp,\n       thin_tac \"polyn_expr R X (c_max S d) d =\n           polyn_expr R X (c_max S d) (c_max S d, snd d)\",\n       thin_tac \"deg_n R S X (polyn_expr R X (fst c) c) = c_max S c\",\n       thin_tac \"deg_n R S X (polyn_expr R X (fst d) d) = c_max S d\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S c)\n                          (c_max S c, snd c) \\<plusminus>\n                         polyn_expr R X (c_max S d)\n                          (c_max S d, snd d) \\<noteq>\n                         \\<zero>", "apply (subst polyn_add, assumption+, simp add: max.absorb1 max.absorb2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S c, snd c)\n                            (c_max S d, snd d)) \\<noteq>\n                         \\<zero>", "apply (rule contrapos_pp, simp+,\n         frule_tac c = \"(c_max S c, snd c)\" and d = \"(c_max S d, snd d)\" in \n         add_cf_pol_coeff, assumption+,\n         frule_tac c1 = \"add_cf S (c_max S c, snd c) (c_max S d, snd d)\" and \n         k1 = \"c_max S d\" in coeff_0_pol_0[THEN sym],\n         simp add:add_cf_len, simp,\n       thin_tac \"pol_coeff S (add_cf S (c_max S c, snd c) (c_max S d, snd d))\",\n       thin_tac \"polyn_expr R X (c_max S d)\n            (add_cf S (c_max S c, snd c) (c_max S d, snd d)) = \\<zero>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d);\n        \\<forall>j\\<le>c_max S d.\n           snd (add_cf S (c_max S c, snd c) (c_max S d, snd d)) j =\n           \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule_tac a = \"c_max S d\" in forall_spec, simp,\n         simp add:add_cf_def,\n         frule_tac c = d and k = \"fst d\" in coeff_nonzero_polyn_nonzero,\n         simp, simp,\n         frule_tac c = d in coeff_max_nonzeroTr, assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_deg_add1:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n      q \\<noteq> \\<zero>; (deg_n R S X p) < (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow>  \n            deg_n R S X (p \\<plusminus> q) = (deg_n R S X q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) = deg_n R S X q", "apply (cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; Subring R S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) = deg_n R S X q", "apply (frule less_deg_add_nonzero[of p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; Subring R S;\n     p \\<plusminus> q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) = deg_n R S X q", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE,\n       frule ex_polyn_expr[of q], erule exE, erule conjE,\n       rename_tac c d)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n        q \\<noteq> \\<zero>; deg_n R S X p < deg_n R S X q; Subring R S;\n        p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) = deg_n R S X q", "apply (simp only:pol_deg_eq_c_max)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        Subring R S;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d) =\n                         c_max S d", "apply (frule_tac c = c in coeff_max_bddTr,\n       frule_tac c = d in coeff_max_bddTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        Subring R S;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d) =\n                         c_max S d", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption,\n       frule_tac c = d and n = \"c_max S d\" in pol_coeff_le, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>; c_max S c < c_max S d;\n        Subring R S;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d) =\n                         c_max S d", "apply (simp add:polyn_c_max)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) c \\<in> carrier R;\n        polyn_expr R X (c_max S c) c \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) d \\<in> carrier R;\n        polyn_expr R X (c_max S d) d \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S c) c \\<plusminus>\n        polyn_expr R X (c_max S d) d \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) c; pol_coeff S d;\n        q = polyn_expr R X (c_max S d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S c) c \\<plusminus>\n                           polyn_expr R X (c_max S d) d) =\n                         c_max S d", "apply (frule_tac c = c and k = \"c_max S c\" in polyn_expr_short, simp,\n       frule_tac c = d and k = \"c_max S d\" in polyn_expr_short, simp,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) c =\n        polyn_expr R X (c_max S c) (c_max S c, snd c);\n        polyn_expr R X (c_max S d) d =\n        polyn_expr R X (c_max S d) (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S c)\n                            (c_max S c, snd c) \\<plusminus>\n                           polyn_expr R X (c_max S d) (c_max S d, snd d)) =\n                         c_max S d", "apply (frule_tac c = \"(c_max S c, snd c)\" and d = \"(c_max S d, snd d)\" in \n         polyn_add1, assumption+, simp,\n        thin_tac \"polyn_expr R X (c_max S c) c =\n           polyn_expr R X (c_max S c) (c_max S c, snd c)\",\n        thin_tac \"polyn_expr R X (c_max S d) d =\n           polyn_expr R X (c_max S d) (c_max S d, snd d)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (max (c_max S c) (c_max S d))\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (max (c_max S c) (c_max S d))\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (max (c_max S c) (c_max S d))\n                            (add_cf S (c_max S c, snd c)\n                              (c_max S d, snd d))) =\n                         c_max S d", "apply (simp add: max.absorb1 max.absorb2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S c, snd c)\n                              (c_max S d, snd d))) =\n                         c_max S d", "apply (frule_tac c = \"(c_max S c, snd c)\" and d = \"(c_max S d, snd d)\" in \n                  add_cf_pol_coeff, assumption+,\n         rule_tac p = \"polyn_expr R X (c_max S d)\n            (add_cf S (c_max S c, snd c) (c_max S d, snd d))\" and\n          c = \"add_cf S (c_max S c, snd c) (c_max S d, snd d)\" and \n          n = \"c_max S d\" in pol_deg_n)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S c, snd c) (c_max S d, snd d))\n                         \\<in> carrier R\n 2. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S\n                          (add_cf S (c_max S c, snd c) (c_max S d, snd d))\n 3. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> c_max S d\n                         \\<le> fst (add_cf S (c_max S c, snd c)\n                                     (c_max S d, snd d))\n 4. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S c, snd c) (c_max S d, snd d)) =\n                         polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S c, snd c) (c_max S d, snd d))\n 5. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (c_max S c, snd c)\n                               (c_max S d, snd d))\n                          (c_max S d) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (rule_tac polyn_mem, simp, simp add:add_cf_len,\n         assumption,\n         simp add:add_cf_len, simp,\n         subst add_cf_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S c) (c_max S c, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c < c_max S d; Subring R S;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) (c_max S c, snd c);\n        pol_coeff S d; q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S c \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S c, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S c) (c_max S c, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d));\n        pol_coeff S\n         (add_cf S (c_max S c, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> snd d (c_max S d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c1 = \"(c_max S d, snd d)\" and k1 = \"c_max S d\" in \n         coeff_0_pol_0[THEN sym], simp, simp,\n         rule coeff_max_nonzeroTr, assumption+,\n         erule exE, erule conjE,\n         frule_tac i = j and j = \"c_max S d\" and k = \"fst d\" in\n                le_trans, assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_deg_add2:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n      q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>; (deg_n R S X p) = (deg_n R S X q)\\<rbrakk>  \\<Longrightarrow> \n          deg_n R S X (p \\<plusminus> q) \\<le> (deg_n R S X q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     deg_n R S X p = deg_n R S X q\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> deg_n R S X q", "apply (cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     deg_n R S X p = deg_n R S X q; Subring R S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> deg_n R S X q", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE,\n       frule ex_polyn_expr[of q], erule exE, erule conjE,\n       rename_tac c d)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        deg_n R S X p = deg_n R S X q; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> deg_n R S X q", "apply (simp only:pol_deg_eq_c_max)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d)\n                         \\<le> c_max S d", "apply (frule_tac c = c in coeff_max_bddTr,\n       frule_tac c = d in coeff_max_bddTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d)\n                         \\<le> c_max S d", "apply (frule_tac c = c and n = \"c_max S c\" in pol_coeff_le, assumption,\n       frule_tac c = d and n = \"c_max S d\" in pol_coeff_le, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        polyn_expr R X (fst d) d \\<in> carrier R;\n        polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n        polyn_expr R X (fst c) c \\<plusminus>\n        polyn_expr R X (fst d) d \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (fst c) c; pol_coeff S d;\n        q = polyn_expr R X (fst d) d; c_max S c \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S c, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (fst c) c \\<plusminus>\n                           polyn_expr R X (fst d) d)\n                         \\<le> c_max S d", "apply (simp add:polyn_c_max)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) c \\<in> carrier R;\n        polyn_expr R X (c_max S d) c \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) d \\<in> carrier R;\n        polyn_expr R X (c_max S d) d \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) c \\<plusminus>\n        polyn_expr R X (c_max S d) d \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) c; pol_coeff S d;\n        q = polyn_expr R X (c_max S d) d; c_max S d \\<le> fst c;\n        c_max S d \\<le> fst d; pol_coeff S (c_max S d, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d) c \\<plusminus>\n                           polyn_expr R X (c_max S d) d)\n                         \\<le> c_max S d", "apply (frule_tac c = c and k = \"c_max S c\" in polyn_expr_short, simp,\n       frule_tac c = d and k = \"c_max S d\" in polyn_expr_short, simp,\n       simp,\n       frule_tac c = \"(c_max S d, snd c)\" and d = \"(c_max S d, snd d)\" in \n         polyn_add1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S d) c =\n        polyn_expr R X (c_max S d) (c_max S d, snd c);\n        polyn_expr R X (c_max S d) d =\n        polyn_expr R X (c_max S d) (c_max S d, snd d);\n        polyn_expr R X (fst (c_max S d, snd c))\n         (c_max S d, snd c) \\<plusminus>\n        polyn_expr R X (fst (c_max S d, snd d)) (c_max S d, snd d) =\n        polyn_expr R X\n         (max (fst (c_max S d, snd c)) (fst (c_max S d, snd d)))\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (c_max S d, snd c) \\<plusminus>\n                           polyn_expr R X (c_max S d) (c_max S d, snd d))\n                         \\<le> c_max S d", "apply (thin_tac \"polyn_expr R X (c_max S d) d =\n           polyn_expr R X (c_max S d) (c_max S d, snd d)\",\n        thin_tac \"polyn_expr R X (c_max S d) c =\n           polyn_expr R X (c_max S d) (c_max S d, snd c)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<plusminus>\n        polyn_expr R X (c_max S d) (c_max S d, snd d) =\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S d, snd c)\n                              (c_max S d, snd d)))\n                         \\<le> c_max S d", "apply (thin_tac \"polyn_expr R X (c_max S d) (c_max S d, snd c) \\<plusminus>\n           polyn_expr R X (c_max S d) (c_max S d, snd d) =\n           polyn_expr R X (c_max S d)\n            (add_cf S (c_max S d, snd c) (c_max S d, snd d))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c);\n        pol_coeff S (c_max S d, snd d)\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S d, snd c)\n                              (c_max S d, snd d)))\n                         \\<le> c_max S d", "apply (frule_tac c = \"(c_max S d, snd c)\" and d = \"(c_max S d, snd d)\" in \n                  add_cf_pol_coeff, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S d, snd c)\n                              (c_max S d, snd d)))\n                         \\<le> c_max S d", "apply (cut_tac p = \"polyn_expr R X (c_max S d)\n                (add_cf S (c_max S d, snd c) (c_max S d, snd d))\"\n        and c = \"add_cf S (c_max S d, snd c) (c_max S d, snd d)\" in\n        pol_deg_eq_c_max)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n                         \\<in> carrier R\n 2. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n 3. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d)) =\n                         polyn_expr R X\n                          (fst (add_cf S (c_max S d, snd c)\n                                 (c_max S d, snd d)))\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n 4. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S (add_cf S (c_max S d, snd c) (c_max S d, snd d));\n        deg_n R S X\n         (polyn_expr R X (c_max S d)\n           (add_cf S (c_max S d, snd c) (c_max S d, snd d))) =\n        c_max S (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S d, snd c)\n                              (c_max S d, snd d)))\n                         \\<le> c_max S d", "apply (rule_tac polyn_mem, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> c_max S d\n                         \\<le> fst (add_cf S (c_max S d, snd c)\n                                     (c_max S d, snd d))\n 2. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n 3. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (c_max S d)\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d)) =\n                         polyn_expr R X\n                          (fst (add_cf S (c_max S d, snd c)\n                                 (c_max S d, snd d)))\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n 4. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S (add_cf S (c_max S d, snd c) (c_max S d, snd d));\n        deg_n R S X\n         (polyn_expr R X (c_max S d)\n           (add_cf S (c_max S d, snd c) (c_max S d, snd d))) =\n        c_max S (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X (c_max S d)\n                            (add_cf S (c_max S d, snd c)\n                              (c_max S d, snd d)))\n                         \\<le> c_max S d", "apply (simp add:add_cf_len,\n              assumption,\n             simp add:add_cf_len, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d)\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n        \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S (add_cf S (c_max S d, snd c) (c_max S d, snd d));\n        deg_n R S X\n         (polyn_expr R X (c_max S d)\n           (add_cf S (c_max S d, snd c) (c_max S d, snd d))) =\n        c_max S (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> c_max S\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n                         \\<le> c_max S d", "apply (thin_tac \"deg_n R S X\n            (polyn_expr R X (c_max S d)\n              (add_cf S (c_max S d, snd c) (c_max S d, snd d))) =\n           c_max S (add_cf S (c_max S d, snd c) (c_max S d, snd d))\",\n             thin_tac \"polyn_expr R X (c_max S d)\n            (add_cf S (c_max S d, snd c) (c_max S d, snd d)) \\<noteq>\n           \\<zero>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S\n         (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> c_max S\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n                         \\<le> c_max S d", "apply (frule_tac c = \"add_cf S (c_max S d, snd c) (c_max S d, snd d)\" in \n         coeff_max_bddTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c d.\n       \\<lbrakk>polyn_expr R X (c_max S d) (c_max S d, snd c)\n                \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd c) \\<noteq> \\<zero>;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<in> carrier R;\n        polyn_expr R X (c_max S d) (c_max S d, snd d) \\<noteq> \\<zero>;\n        c_max S c = c_max S d; Subring R S; pol_coeff S c;\n        p = polyn_expr R X (c_max S d) (c_max S d, snd c); pol_coeff S d;\n        q = polyn_expr R X (c_max S d) (c_max S d, snd d);\n        c_max S d \\<le> fst c; c_max S d \\<le> fst d;\n        pol_coeff S (c_max S d, snd c); pol_coeff S (c_max S d, snd d);\n        pol_coeff S (add_cf S (c_max S d, snd c) (c_max S d, snd d));\n        c_max S (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n        \\<le> fst (add_cf S (c_max S d, snd c) (c_max S d, snd d))\\<rbrakk>\n       \\<Longrightarrow> c_max S\n                          (add_cf S (c_max S d, snd c) (c_max S d, snd d))\n                         \\<le> c_max S d", "apply (simp add:add_cf_len)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_deg_add3:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; \n       q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>; (deg_n R S X p) \\<le> n; (deg_n R S X q) \\<le> n\\<rbrakk>  \\<Longrightarrow> \n          deg_n R S X (p \\<plusminus> q) \\<le> n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     deg_n R S X p \\<le> n; deg_n R S X q \\<le> n\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> n", "apply (case_tac \"(deg_n R S X p) = (deg_n R S X q)\",\n       frule polyn_deg_add2[of \"p\" \"q\"], assumption+,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     deg_n R S X p \\<le> n; deg_n R S X q \\<le> n;\n     deg_n R S X p \\<noteq> deg_n R S X q\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> n", "apply (cut_tac less_linear[of \"deg_n R S X p\" \"deg_n R S X q\"],\n       simp, thin_tac \"deg_n R S X p \\<noteq> deg_n R S X q\",\n       erule disjE, simp add:polyn_deg_add1,\n       cut_tac ring_is_ag, simp add:aGroup.ag_pOp_commute[of \"R\" \"p\" \"q\"],\n       simp add:polyn_deg_add1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_deg_add4:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n      (deg R S X p) \\<le> (an n); (deg R S X q) \\<le> (an n)\\<rbrakk>  \\<Longrightarrow> \n                    deg R S X (p \\<plusminus> q) \\<le> (an n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; aGroup R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; aGroup R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (case_tac \"q =  \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (case_tac \"p \\<plusminus>\\<^bsub>R\\<^esub> q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:deg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (frule aGroup.ag_pOp_closed[of R p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (simp add:deg_an)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> an n; an (deg_n R S X q) \\<le> an n; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X (p \\<plusminus> q)) \\<le> an n", "apply (simp only:ale_natle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg_n R S X p \\<le> n;\n     deg_n R S X q \\<le> n; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (p \\<plusminus> q) \\<le> n", "apply (simp add:polyn_deg_add3)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_deg_add5:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) \\<le> a; (deg R S X q) \\<le> a\\<rbrakk>  \\<Longrightarrow> \n                                deg R S X (p \\<plusminus> q) \\<le> a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> a;\n     deg R S X q \\<le> a\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a", "apply (case_tac \"a = \\<infinity>\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> a;\n     deg R S X q \\<le> a; a \\<noteq> \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a", "apply (cut_tac ring_is_ag,\n       case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_l_zero[of R],\n       case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_r_zero,\n       simp add:deg_an[of p])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a", "apply (cut_tac an_nat_pos[of \"deg_n R S X p\"],\n       frule ale_trans[of \"0\" \"an (deg_n R S X p)\" \"a\"], assumption+,\n       subgoal_tac \"an (deg_n R S X p) \\<le> an (na a)\",\n       simp only:ale_natle[of \"deg_n R S X p\" \"na a\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> an (deg_n R S X p); 0 \\<le> a;\n     deg_n R S X p \\<le> na a\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> an (deg_n R S X p); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X p) \\<le> an (na a)", "apply (simp add:deg_an[of q])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; an (deg_n R S X q) \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> a; deg_n R S X p \\<le> na a\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> an (deg_n R S X p); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X p) \\<le> an (na a)", "apply (cut_tac an_nat_pos[of \"deg_n R S X q\"],\n       frule ale_trans[of \"0\" \"an (deg_n R S X q)\" \"a\"], assumption+,\n       subgoal_tac \"an (deg_n R S X q) \\<le> an (na a)\",\n       simp only:ale_natle[of \"deg_n R S X q\" \"na a\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; an (deg_n R S X q) \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; True; deg_n R S X p \\<le> na a;\n     0 \\<le> an (deg_n R S X q); 0 \\<le> a;\n     deg_n R S X q \\<le> na a\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> a\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; an (deg_n R S X q) \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> a; deg_n R S X p \\<le> na a;\n     0 \\<le> an (deg_n R S X q); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X q) \\<le> an (na a)\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> an (deg_n R S X p); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X p) \\<le> an (na a)", "apply (frule polyn_deg_add4[of p q \"na a\"], assumption+,\n       simp add:an_na, simp add:deg_an,\n       simp add:deg_an an_na, simp add:an_na)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; an (deg_n R S X q) \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> a; deg_n R S X p \\<le> na a;\n     0 \\<le> an (deg_n R S X q); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X q) \\<le> an (na a)\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     an (deg_n R S X p) \\<le> a; deg R S X q \\<le> a;\n     a \\<noteq> \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; 0 \\<le> an (deg_n R S X p); 0 \\<le> a\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X p) \\<le> an (na a)", "apply (simp add:deg_an an_na, simp add:deg_an an_na)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) lower_deg_part:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p\\<rbrakk>\n      \\<Longrightarrow>  \n deg R S X (polyn_expr R X (deg_n R S X p - Suc 0)(SOME f. cf_sol R S X p f))\n                       < deg R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < deg_n R S X p\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p", "apply (case_tac \"polyn_expr R X (deg_n R S X p - Suc 0) \n                              (SOME f. cf_sol R S X p f) = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0) (SOME f. cf_sol R S X p f) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p", "apply (simp add:deg_def, cut_tac minf_le_any[of \"an (deg_n R S X p)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0) (SOME f. cf_sol R S X p f) =\n     \\<zero>;\n     - \\<infinity> \\<le> an (deg_n R S X p)\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> < an (deg_n R S X p)\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p", "apply (subst less_le, simp, simp add:an_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0) (SOME f. cf_sol R S X p f) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> \\<noteq> ant (int (deg_n R S X p))\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p", "apply (rule not_sym, rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (SOME f. cf_sol R S X p f))\n                      < deg R S X p", "apply (simp add:deg_def, simp add:aless_natless)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < deg_n R S X p", "apply (frule pol_SOME_2[of p], erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; 0 < deg_n R S X p;\n     polyn_expr R X (deg_n R S X p - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (deg_n R S X p - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < deg_n R S X p", "apply (simp add:pol_deg_eq_c_max[of p \"SOME c. cf_sol R S X p c\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (frule_tac c = \"SOME c. cf_sol R S X p c\" in coeff_max_bddTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (cut_tac \n  p = \"polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n          (Eps (cf_sol R S X p))\" and c = \"(c_max S (SOME c. cf_sol R S X p c) - Suc 0, snd (SOME c. cf_sol R S X p c))\" in pol_deg_eq_c_max)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                       (Eps (cf_sol R S X p))\n                      \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                       (Eps (cf_sol R S X p)) =\n                      polyn_expr R X\n                       (fst (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                             snd (SOME c. cf_sol R S X p c)))\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n 4. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c);\n     deg_n R S X\n      (polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n        (Eps (cf_sol R S X p))) =\n     c_max S\n      (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n       snd (SOME c. cf_sol R S X p c))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (rule polyn_mem, simp, arith)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                       (Eps (cf_sol R S X p)) =\n                      polyn_expr R X\n                       (fst (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                             snd (SOME c. cf_sol R S X p c)))\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n 3. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c);\n     deg_n R S X\n      (polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n        (Eps (cf_sol R S X p))) =\n     c_max S\n      (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n       snd (SOME c. cf_sol R S X p c))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (rule pol_coeff_le, assumption, arith)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                       (Eps (cf_sol R S X p)) =\n                      polyn_expr R X\n                       (fst (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                             snd (SOME c. cf_sol R S X p c)))\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c);\n     deg_n R S X\n      (polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n        (Eps (cf_sol R S X p))) =\n     c_max S\n      (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n       snd (SOME c. cf_sol R S X p c))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (subst polyn_expr_short, arith, arith, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c);\n     deg_n R S X\n      (polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n        (Eps (cf_sol R S X p))) =\n     c_max S\n      (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n       snd (SOME c. cf_sol R S X p c))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X\n                         (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n                         (Eps (cf_sol R S X p)))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>;\n     0 < c_max S (SOME c. cf_sol R S X p c);\n     polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n      (SOME f. cf_sol R S X p f) \\<noteq>\n     \\<zero>;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     c_max S (SOME c. cf_sol R S X p c)\n     \\<le> fst (SOME c. cf_sol R S X p c);\n     deg_n R S X\n      (polyn_expr R X (c_max S (SOME c. cf_sol R S X p c) - Suc 0)\n        (Eps (cf_sol R S X p))) =\n     c_max S\n      (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n       snd (SOME c. cf_sol R S X p c))\\<rbrakk>\n    \\<Longrightarrow> c_max S\n                       (c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n                        snd (SOME c. cf_sol R S X p c))\n                      < c_max S (SOME c. cf_sol R S X p c)", "apply (cut_tac c = \"(c_max S (SOME c. cf_sol R S X p c) - Suc 0,\n         snd (SOME c. cf_sol R S X p c))\" in coeff_max_bddTr,\n         rule pol_coeff_le, assumption, arith, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ldeg_p :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, nat, 'a]\n                  \\<Rightarrow> 'a\" where\n  \"ldeg_p R S X d p = polyn_expr R X d (scf_d R S X p (Suc d))\""], ["", "(** deg R S X p \\<le> (Suc d) **)"], ["", "definition\n  hdeg_p :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, nat, 'a]\n                  \\<Rightarrow> 'a\" where\n  \"hdeg_p R S X d p = (snd (scf_d R S X p d) d) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (X^\\<^bsup>R d\\<^esup>)\""], ["", "(** deg R S X p \\<le> d **)"], ["", "lemma (in PolynRg) ldeg_p_mem:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d) \\<rbrakk> \\<Longrightarrow>\n                      ldeg_p R S X d p \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d p \\<in> carrier R", "apply (frule scf_d_pol[of \"p\" \"Suc d\"], assumption+, \n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d p \\<in> carrier R", "apply (simp add:ldeg_p_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d))\n                      \\<in> carrier R", "apply (rule polyn_mem[of \"scf_d R S X p (Suc d)\" d],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (scf_d R S X p (Suc d))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ldeg_p_zero:\"p = \\<zero>\\<^bsub>R\\<^esub> \\<Longrightarrow> ldeg_p R S X d p = \\<zero>\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p = \\<zero> \\<Longrightarrow> ldeg_p R S X d p = \\<zero>", "apply (subgoal_tac \"deg R S X p \\<le> an (Suc d)\",\n       subgoal_tac \"p \\<in> carrier R\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d);\n     p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d p = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (frule scf_d_pol[of \"p\" \"Suc d\"], assumption+, \n       erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d); p \\<in> carrier R;\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d p = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X \\<zero> \\<le> an (Suc d);\n     \\<zero> \\<in> carrier R; pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d))\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d \\<zero> = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (frule coeff_0_pol_0[of \"scf_d R S X \\<zero> (Suc d)\" \"Suc d\"], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X \\<zero> \\<le> an (Suc d);\n     \\<zero> \\<in> carrier R; pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     (\\<forall>j\\<le>Suc d.\n         snd (scf_d R S X \\<zero> (Suc d)) j = \\<zero>\\<^bsub>S\\<^esub>) =\n     (polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d)) =\n      \\<zero>)\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d \\<zero> = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp add:ldeg_p_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X \\<zero> \\<le> an (Suc d);\n     \\<zero> \\<in> carrier R; pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X \\<zero> (Suc d)) j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X \\<zero> (Suc d)) =\n                      \\<zero>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (subst coeff_0_pol_0[THEN sym, of \"scf_d R S X \\<zero> (Suc d)\"],\n        assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X \\<zero> \\<le> an (Suc d);\n     \\<zero> \\<in> carrier R; pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X \\<zero> (Suc d)) j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         snd (scf_d R S X \\<zero> (Suc d)) j =\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p = \\<zero>; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 2. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp, simp add:ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. p = \\<zero> \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp add:deg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) hdeg_p_mem:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n                      hdeg_p R S X (Suc d) p \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<in> carrier R", "apply (frule scf_d_pol[of p \"Suc d\"], assumption+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<in> carrier R", "apply (simp only:hdeg_p_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n                      \\<in> carrier R", "apply (cut_tac Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n                      \\<in> carrier R", "apply (rule Ring.ring_tOp_closed[of \"R\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R", "apply (frule pol_coeff_mem[of \"scf_d R S X p (Suc d)\" \"Suc d\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R", "apply (cut_tac subring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     Subring R S\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R", "apply (simp add:Ring.mem_subring_mem_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R", "apply (rule Ring.npClose[of \"R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d)); Ring R\\<rbrakk>\n    \\<Longrightarrow> X \\<in> carrier R", "apply (rule X_mem_R)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*   *****************************************************************\ndefinition ldeg_p :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, 'a]\n                  \\<Rightarrow> 'a\" where\n \"ldeg_p R S X p == if p = \\<zero>\\<^bsub>R\\<^esub> then \\<zero>\\<^bsub>R\\<^esub> \n                       else if deg_n R S X p = 0 then p\n                       else polyn_expr R X (fst (s_cf R S X p)  - Suc 0) \n                                                         (s_cf R S X p)\" *)\n      (** deg R S X p \\<le> (Suc d), lower degree part **) (*\ndefinition hdeg_p :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a,'a]\n                  \\<Rightarrow> 'a\" where\n \"hdeg_p R S X p == if p = \\<zero>\\<^bsub>R\\<^esub> then \\<zero>\\<^bsub>R\\<^esub> else \n                     (if (deg_n R S X p) = 0 then \\<zero>\\<^bsub>R\\<^esub> else\n                      (snd (s_cf R S X p) (fst (s_cf R S X p))) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> \n                              X^\\<^bsup>R (fst (s_cf R S X p))\\<^esup>)\" *)\n       (** deg R S X p \\<le> d, the highest degree term  **)\n\n(*\nlemma (in PolynRg) ldeg_p_mem:\"p \\<in> carrier R  \\<Longrightarrow> ldeg_p R S X p \\<in> carrier R\"\napply (simp add:ldeg_p_def)\n apply (simp add:ring_zero)\n apply (rule impI, rule impI)\napply (frule s_cf_pol_coeff[of p])\n apply (simp add:polyn_mem)\ndone   \n    \nlemma (in PolynRg) ldeg_p_zero:\"ldeg_p R S X \\<zero> = \\<zero>\"\napply (simp add:ldeg_p_def)\ndone \n\nlemma (in PolynRg) ldeg_p_zero1:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; deg_n R S X p = 0\\<rbrakk> \\<Longrightarrow>\n                   ldeg_p R S X p = p\"\nby (simp add:ldeg_p_def)\n \nlemma (in PolynRg) hdeg_p_mem:\"p \\<in> carrier R  \\<Longrightarrow>\n                                   hdeg_p R S X p \\<in> carrier R\"\napply (cut_tac ring_is_ag)\napply (cut_tac subring)\napply (simp add:hdeg_p_def)\n apply (case_tac \"deg_n R S X p = 0\", simp add:aGroup.ag_inc_zero)\napply simp\n apply (simp add:aGroup.ag_inc_zero)\n apply (rule impI)\n apply (frule s_cf_pol_coeff[of p])\n apply (cut_tac X_mem_R,\n        rule ring_tOp_closed) \n apply (simp add:pol_coeff_mem mem_subring_mem_ring)\n apply (rule npClose, assumption)\ndone *)"], ["", "lemma (in PolynRg) hdeg_p_zero:\"p = \\<zero> \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p = \\<zero> \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>", "apply (cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>", "apply (subgoal_tac \"deg R S X p \\<le> an (Suc d)\",\n       subgoal_tac \"p \\<in> carrier R\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (frule scf_d_pol[of p \"Suc d\"], assumption+, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     p \\<in> carrier R; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X \\<zero> \\<le> an (Suc d); \\<zero> \\<in> carrier R;\n     pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) \\<zero> = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (frule coeff_0_pol_0[of \"scf_d R S X \\<zero> (Suc d)\" \"Suc d\"], \n        (erule conjE)+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X \\<zero> \\<le> an (Suc d); \\<zero> \\<in> carrier R;\n     pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     (\\<forall>j\\<le>Suc d.\n         snd (scf_d R S X \\<zero> (Suc d)) j = \\<zero>\\<^bsub>S\\<^esub>) =\n     (polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d)) =\n      \\<zero>)\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) \\<zero> = \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp only:hdeg_p_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X \\<zero> \\<le> an (Suc d); \\<zero> \\<in> carrier R;\n     pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     (\\<forall>j\\<le>Suc d.\n         snd (scf_d R S X \\<zero> (Suc d)) j = \\<zero>\\<^bsub>S\\<^esub>) =\n     (\\<zero> = \\<zero>)\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X \\<zero> (Suc d))\n                       (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (rotate_tac -1, drule sym, simp del:npow_suc)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X \\<zero> \\<le> an (Suc d); \\<zero> \\<in> carrier R;\n     pol_coeff S (scf_d R S X \\<zero> (Suc d));\n     fst (scf_d R S X \\<zero> (Suc d)) = Suc d \\<and>\n     \\<zero> = polyn_expr R X (Suc d) (scf_d R S X \\<zero> (Suc d));\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X \\<zero> (Suc d)) j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      \\<zero>\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (cut_tac subring, \n       simp del:npow_suc add:Subring_zero_ring_zero,\n       rule ring_times_0_x, rule npClose, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 2. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp add:ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p = \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X p \\<le> an (Suc d)", "apply (simp add:deg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) decompos_p:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n                p = (ldeg_p R S X d p) \\<plusminus> (hdeg_p R S X (Suc d) p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> p =\n                      ldeg_p R S X d p \\<plusminus> hdeg_p R S X (Suc d) p", "apply (frule scf_d_pol[of  p \"Suc d\"], assumption+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d \\<and>\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> p =\n                      ldeg_p R S X d p \\<plusminus> hdeg_p R S X (Suc d) p", "apply (cut_tac subring, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> p =\n                      ldeg_p R S X d p \\<plusminus> hdeg_p R S X (Suc d) p", "apply (cut_tac polyn_Suc[of d \"scf_d R S X p (Suc d)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X (Suc d) (Suc d, snd (scf_d R S X p (Suc d))) =\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n     X^\\<^bsup>R Suc d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> p =\n                      ldeg_p R S X d p \\<plusminus> hdeg_p R S X (Suc d) p\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> Suc d \\<le> fst (scf_d R S X p (Suc d))", "apply (simp only:ldeg_p_def hdeg_p_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X (Suc d) (Suc d, snd (scf_d R S X p (Suc d))) =\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n     X^\\<^bsup>R Suc d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> Suc d \\<le> fst (scf_d R S X p (Suc d))", "apply (rotate_tac -1, drule sym, simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n     X^\\<^bsup>R Suc d\\<^esup> =\n     polyn_expr R X (Suc d) (Suc d, snd (scf_d R S X p (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (Suc d)\n                       (Suc d, snd (scf_d R S X p (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> Suc d \\<le> fst (scf_d R S X p (Suc d))", "apply (thin_tac \"polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc d)\\<^esup> =\n     polyn_expr R X (Suc d) (Suc d, snd (scf_d R S X p (Suc d)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (Suc d)\n                       (Suc d, snd (scf_d R S X p (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X p (Suc d)); Subring R S;\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> Suc d \\<le> fst (scf_d R S X p (Suc d))", "apply (simp add:polyn_expr_split[of \"Suc d\" \"scf_d R S X p (Suc d)\"],\n        simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_ldeg_p:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>  \\<Longrightarrow>  \n                deg R S X (ldeg_p R S X d p) \\<le> an d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d", "apply (cut_tac subring,\n       frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d", "apply (simp add:ldeg_p_zero, simp add:deg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d", "apply (frule scf_d_pol[of p \"Suc d\"], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> deg R S X (ldeg_p R S X d p) \\<le> an d", "apply (simp only:ldeg_p_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d", "apply (case_tac \"polyn_expr R X d (scf_d R S X p (Suc d)) = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d", "apply (simp add:deg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d", "apply (simp add:deg_an)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; an (deg_n R S X p) \\<le> an (Suc d);\n     Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d", "apply (simp add:ale_natle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> Suc d; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (polyn_expr R X d (scf_d R S X p (Suc d)))\n                      \\<le> an d", "apply (cut_tac pol_deg_le_n1[of \"polyn_expr R X d (scf_d R S X p (Suc d))\" \n       \"scf_d R S X p (Suc d)\" d], simp add:deg_def ale_natle)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> Suc d; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d))\n                      \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> Suc d; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X p (Suc d))\n 3. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> Suc d; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (scf_d R S X p (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; deg_n R S X p \\<le> Suc d; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     polyn_expr R X d (scf_d R S X p (Suc d)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) =\n                      polyn_expr R X d (scf_d R S X p (Suc d))", "apply (rule polyn_mem, assumption+, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_minus_eq:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>  \n                    deg_n R S X (-\\<^sub>a p) = deg_n R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (-\\<^sub>a p) = deg_n R S X p", "apply (cut_tac subring, \n       cut_tac ring_is_ag,\n       frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; aGroup R;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (-\\<^sub>a p) = deg_n R S X p", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; aGroup R;\n     Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (-\\<^sub>a p) = deg_n R S X p", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+,\n        frule polyn_minus_m_cf[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"], simp,\n        drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (m_cf S (s_cf R S X p))) =\n                      deg_n R S X p", "apply (frule_tac x = p in aGroup.ag_mOp_closed, assumption+,\n        frule m_cf_pol_coeff [of \"s_cf R S X p\"],\n        frule pol_deg_n[of \"-\\<^sub>a p\" \"m_cf S (s_cf R S X p)\" \n              \"fst (s_cf R S X p)\"], assumption,\n        simp add:m_cf_len, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (m_cf S (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> snd (m_cf S (s_cf R S X p))\n                       (fst (s_cf R S X p)) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     -\\<^sub>a p \\<in> carrier R; pol_coeff S (m_cf S (s_cf R S X p));\n     deg_n R S X (-\\<^sub>a p) = fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (m_cf S (s_cf R S X p))) =\n                      deg_n R S X p", "apply (simp add:m_cf_def,\n        frule pol_coeff_mem[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"], simp,\n        frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p))\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j);\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     polyn_expr R X (fst (s_cf R S X p))\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j)\n     \\<in> carrier R;\n     pol_coeff S\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p)\n            (fst (s_cf R S X p)) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     -\\<^sub>a p \\<in> carrier R; pol_coeff S (m_cf S (s_cf R S X p));\n     deg_n R S X (-\\<^sub>a p) = fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (m_cf S (s_cf R S X p))) =\n                      deg_n R S X p", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p))\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j);\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     polyn_expr R X (fst (s_cf R S X p))\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j)\n     \\<in> carrier R;\n     pol_coeff S\n      (fst (s_cf R S X p),\n       \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) j);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S; aGroup S;\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X p) (fst (s_cf R S X p)) =\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     -\\<^sub>a p \\<in> carrier R; pol_coeff S (m_cf S (s_cf R S X p));\n     deg_n R S X (-\\<^sub>a p) = fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (m_cf S (s_cf R S X p))) =\n                      deg_n R S X p", "apply (frule aGroup.ag_inv_inv[THEN sym, \n          of S \"snd (s_cf R S X p) (fst (s_cf R S X p))\"], assumption,\n        simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     aGroup R; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p =\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     -\\<^sub>a p \\<in> carrier R; pol_coeff S (m_cf S (s_cf R S X p));\n     deg_n R S X (-\\<^sub>a p) = fst (s_cf R S X p)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (m_cf S (s_cf R S X p))) =\n                      deg_n R S X p", "apply (drule sym, simp, simp add:s_cf_deg)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_minus_eq1:\"p \\<in> carrier R \\<Longrightarrow> \n                       deg R S X (-\\<^sub>a p) = deg R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    deg R S X (-\\<^sub>a p) = deg R S X p", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) = deg R S X p", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; aGroup R; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) = deg R S X p\n 2. \\<lbrakk>p \\<in> carrier R; aGroup R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) = deg R S X p", "apply (simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; aGroup R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) = deg R S X p", "apply (frule deg_minus_eq[of p], assumption+,\n       frule aGroup.ag_inv_inj[of \"R\" \"p\" \"\\<zero>\"], assumption,\n       simp add:ring_zero, assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; aGroup R; p \\<noteq> \\<zero>;\n     deg_n R S X (-\\<^sub>a p) = deg_n R S X p;\n     -\\<^sub>a p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) = deg R S X p", "apply (frule aGroup.ag_mOp_closed[of R p], assumption,\n       simp add:deg_an)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ldeg_p_pOp:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n      deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n      (ldeg_p R S X d p) \\<plusminus>\\<^bsub>R\\<^esub> (ldeg_p R S X d q) =\n                              ldeg_p R S X d (p \\<plusminus>\\<^bsub>R\\<^esub> q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> ldeg_p R S X d p \\<plusminus> ldeg_p R S X d q =\n                      ldeg_p R S X d (p \\<plusminus> q)", "apply (simp add:ldeg_p_def,\n       cut_tac ring_is_ag, cut_tac subring, frule subring_Ring[of S],\n       frule scf_d_pol[of p \"Suc d\"], assumption+,\n       frule scf_d_pol[of q \"Suc d\"], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     q = polyn_expr R X (Suc d) (scf_d R S X q (Suc d))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (frule polyn_add1[of \"scf_d R S X p (Suc d)\" \"scf_d R S X q (Suc d)\"],\n       assumption+,\n       rotate_tac -2, drule sym,\n       frule aGroup.ag_pOp_closed[of \"R\" \"p\" \"q\"], assumption+,\n       frule polyn_deg_add4 [of p q \"Suc d\"], assumption+,\n       rotate_tac -5, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     polyn_expr R X (fst (scf_d R S X p (Suc d)))\n      (scf_d R S X p (Suc d)) \\<plusminus>\n     polyn_expr R X (fst (scf_d R S X q (Suc d))) (scf_d R S X q (Suc d)) =\n     polyn_expr R X\n      (max (fst (scf_d R S X p (Suc d))) (fst (scf_d R S X q (Suc d))))\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     deg R S X q \\<le> an (Suc d); aGroup R; Subring R S; Ring S;\n     pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n     \\<in> carrier R;\n     deg R S X\n      (polyn_expr R X (Suc d)\n        (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n     \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     deg R S X q \\<le> an (Suc d); aGroup R; Subring R S; Ring S;\n     pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X\n                         (polyn_expr R X (Suc d)\n                           (add_cf S (scf_d R S X p (Suc d))\n                             (scf_d R S X q (Suc d))))\n                         (Suc d))", "apply (rotate_tac 4, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     p \\<plusminus> q\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (rotate_tac -1, drule sym,\n       frule scf_d_pol[of \"p \\<plusminus> q\" \"Suc d\"], assumption+, (erule conjE)+,\n       frule box_equation[of \"p \\<plusminus> q\" \"polyn_expr R X (Suc d)\n        (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\" \n        \"polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\"], assumption+,\n       thin_tac \"p \\<plusminus> q =\n        polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d)\n      (scf_d R S X (p \\<plusminus> q) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (frule add_cf_pol_coeff[of \"scf_d R S X p (Suc d)\" \n                   \"scf_d R S X q (Suc d)\"],  assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (frule pol_expr_unique2[of \"add_cf S (scf_d R S X p (Suc d)) \n       (scf_d R S X q (Suc d))\" \"scf_d R S X (p \\<plusminus> q) (Suc d)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     (polyn_expr R X\n       (fst (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n      polyn_expr R X (fst (scf_d R S X (p \\<plusminus> q) (Suc d)))\n       (scf_d R S X (p \\<plusminus> q) (Suc d))) =\n     (\\<forall>j\\<le>fst (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))).\n         snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n         snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst add_cf_len[of \"scf_d R S X p (Suc d)\" \"scf_d R S X q (Suc d)\"], \n       assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> max (fst (scf_d R S X p (Suc d)))\n                       (fst (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     (polyn_expr R X\n       (fst (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n      polyn_expr R X (fst (scf_d R S X (p \\<plusminus> q) (Suc d)))\n       (scf_d R S X (p \\<plusminus> q) (Suc d))) =\n     (\\<forall>j\\<le>fst (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))).\n         snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n         snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (thin_tac \"polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\",\n        thin_tac \"polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q\",\n        thin_tac \"p \\<plusminus> q = polyn_expr R X (Suc d)\n          (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\",\n        thin_tac \"polyn_expr R X (Suc d)\n          (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n           polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> max (fst (scf_d R S X p (Suc d)))\n                       (fst (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     (polyn_expr R X\n       (fst (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n      polyn_expr R X (fst (scf_d R S X (p \\<plusminus> q) (Suc d)))\n       (scf_d R S X (p \\<plusminus> q) (Suc d))) =\n     (\\<forall>j\\<le>fst (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))).\n         snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n         snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     (polyn_expr R X\n       (fst (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n      polyn_expr R X (fst (scf_d R S X (p \\<plusminus> q) (Suc d)))\n       (scf_d R S X (p \\<plusminus> q) (Suc d))) =\n     (\\<forall>j\\<le>fst (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))).\n         snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n         snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (thin_tac \"polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\",\n        thin_tac \"polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q\",\n        thin_tac \"p \\<plusminus> q = polyn_expr R X (Suc d)\n          (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     (polyn_expr R X\n       (fst (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n      polyn_expr R X (fst (scf_d R S X (p \\<plusminus> q) (Suc d)))\n       (scf_d R S X (p \\<plusminus> q) (Suc d))) =\n     (\\<forall>j\\<le>fst (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))).\n         snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n         snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp add:add_cf_len,\n       thin_tac \"polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (scf_d R S X p (Suc d)) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst  polyn_expr_short[of \"scf_d R S X p (Suc d)\" d], assumption,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (scf_d R S X p (Suc d))) \\<plusminus>\n                      polyn_expr R X d (scf_d R S X q (Suc d)) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst  polyn_expr_short[of \"scf_d R S X q (Suc d)\" d], assumption,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (scf_d R S X p (Suc d))) \\<plusminus>\n                      polyn_expr R X d (d, snd (scf_d R S X q (Suc d))) =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst polyn_add_n[of d \"snd (scf_d R S X p (Suc d))\" \n               \"snd (scf_d R S X q (Suc d))\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (d, snd (scf_d R S X p (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (d, snd (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (snd (scf_d R S X p (Suc d)) j \\<plusminus>\\<^bsub>S\\<^esub>\n        snd (scf_d R S X q (Suc d)) j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) d =\n                      polyn_expr R X d\n                       (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp add:split_pol_coeff, simp add:split_pol_coeff,\n        subst polyn_expr_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (snd (scf_d R S X p (Suc d)) j \\<plusminus>\\<^bsub>S\\<^esub>\n        snd (scf_d R S X q (Suc d)) j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) d =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) d", "apply (rule aGroup.nsum_eq, assumption+,\n        rule allI, rule impI,\n        frule_tac j = j in pol_coeff_mem[of \"scf_d R S X p (Suc d)\"],\n               simp,\n        frule_tac j = j in pol_coeff_mem[of \"scf_d R S X q (Suc d)\"],\n               simp,\n        cut_tac Ring, rule Ring.ring_tOp_closed, assumption+,\n        rule Ring.mem_subring_mem_ring[of R S], assumption+,\n        frule Ring.ring_is_ag[of S], rule aGroup.ag_pOp_closed[of S],\n               assumption+,\n        rule Ring.npClose, assumption, simp add:X_mem_R)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         snd (scf_d R S X (p \\<plusminus> q) (Suc d))\n                          j \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         (snd (scf_d R S X p (Suc d))\n                           j \\<plusminus>\\<^bsub>S\\<^esub>\n                          snd (scf_d R S X q (Suc d)) j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup> =\n                         snd (scf_d R S X (p \\<plusminus> q) (Suc d))\n                          j \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (rule allI, rule impI,\n        frule_tac j = j in pol_coeff_mem[of \"scf_d R S X (p \\<plusminus> q) (Suc d)\"], \n        simp, cut_tac Ring,\n        subst Ring.ring_tOp_closed, assumption,\n        rule Ring.mem_subring_mem_ring[of R S], assumption+,\n        rule Ring.npClose, assumption, simp add:X_mem_R,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); aGroup R;\n     Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>d.\n                         (snd (scf_d R S X p (Suc d))\n                           j \\<plusminus>\\<^bsub>S\\<^esub>\n                          snd (scf_d R S X q (Suc d)) j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup> =\n                         snd (scf_d R S X (p \\<plusminus> q) (Suc d))\n                          j \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, simp,\n        thin_tac \" pol_coeff S\n          (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n        deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d);\n        aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n        pol_coeff S (scf_d R S X q (Suc d));\n        fst (scf_d R S X p (Suc d)) = Suc d;\n        fst (scf_d R S X q (Suc d)) = Suc d;\n        p \\<plusminus> q \\<in> carrier R;\n        deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n        pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n        fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d; j \\<le> d;\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n       \\<Longrightarrow> (snd (scf_d R S X p (Suc d))\n                           j \\<plusminus>\\<^bsub>S\\<^esub>\n                          snd (scf_d R S X q (Suc d)) j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup> =\n                         snd (scf_d R S X (p \\<plusminus> q) (Suc d))\n                          j \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (simp add:add_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) hdeg_p_pOp:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n      deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow>\n      (hdeg_p R S X (Suc d) p) \\<plusminus> (hdeg_p R S X (Suc d) q) =\n                              hdeg_p R S X (Suc d) (p \\<plusminus> q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (cut_tac Ring, frule Ring.ring_is_ag[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (cut_tac subring, frule subring_Ring[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (frule scf_d_pol[of p \"Suc d\"], assumption+,\n       frule scf_d_pol[of q \"Suc d\"], assumption+,\n        (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     q = polyn_expr R X (Suc d) (scf_d R S X q (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (frule polyn_add1[of \"scf_d R S X p (Suc d)\" \"scf_d R S X q (Suc d)\"],\n       assumption+,\n       rotate_tac -2, drule sym,\n       frule aGroup.ag_pOp_closed[of \"R\" \"p\" \"q\"], assumption+,\n       frule polyn_deg_add4 [of p q \"Suc d\"], assumption+,\n       rotate_tac -5, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     polyn_expr R X (fst (scf_d R S X p (Suc d)))\n      (scf_d R S X p (Suc d)) \\<plusminus>\n     polyn_expr R X (fst (scf_d R S X q (Suc d))) (scf_d R S X q (Suc d)) =\n     polyn_expr R X\n      (max (fst (scf_d R S X p (Suc d))) (fst (scf_d R S X q (Suc d))))\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     deg R S X q \\<le> an (Suc d); Ring R; aGroup R; Subring R S; Ring S;\n     pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n     \\<in> carrier R;\n     deg R S X\n      (polyn_expr R X (Suc d)\n        (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))))\n     \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an (Suc d);\n     deg R S X q \\<le> an (Suc d); Ring R; aGroup R; Subring R S; Ring S;\n     pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d)\n                       (polyn_expr R X (Suc d)\n                         (add_cf S (scf_d R S X p (Suc d))\n                           (scf_d R S X q (Suc d))))", "apply (rotate_tac -13, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     p \\<plusminus> q\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (frule scf_d_pol[of \"p \\<plusminus> q\" \"Suc d\"], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d)\n      (scf_d R S X (p \\<plusminus> q) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (drule box_equation[of \"p \\<plusminus> q\" \"polyn_expr R X (Suc d)\n       (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\" \n       \"polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     p \\<plusminus> q =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d)\n      (scf_d R S X (p \\<plusminus> q) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (\n      thin_tac \"p \\<plusminus> q = polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d)\n      (scf_d R S X (p \\<plusminus> q) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (frule add_cf_pol_coeff[of \"scf_d R S X p (Suc d)\"\n        \"scf_d R S X q (Suc d)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)", "apply (cut_tac pol_expr_unique2[of \"add_cf S (scf_d R S X p (Suc d)) \n       (scf_d R S X q (Suc d))\" \"scf_d R S X (p \\<plusminus> q) (Suc d)\"], \n       simp add:add_cf_len)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     \\<forall>j\\<le>Suc d.\n        snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) j =\n        snd (scf_d R S X (p \\<plusminus> q) (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (drule_tac a = \"Suc d\" in forall_spec, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n      (Suc d) =\n     snd (scf_d R S X (p \\<plusminus> q) (Suc d)) (Suc d)\\<rbrakk>\n    \\<Longrightarrow> hdeg_p R S X (Suc d) p \\<plusminus>\n                      hdeg_p R S X (Suc d) q =\n                      hdeg_p R S X (Suc d) (p \\<plusminus> q)\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp del:npow_suc add:hdeg_p_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n      (Suc d) =\n     snd (scf_d R S X (p \\<plusminus> q) (Suc d)) (Suc d)\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      snd (scf_d R S X (p \\<plusminus> q) (Suc d))\n                       (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (rotate_tac -1, drule sym, simp del:npow_suc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     snd (scf_d R S X (p \\<plusminus> q) (Suc d)) (Suc d) =\n     snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n      (Suc d)\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      snd (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d)))\n                       (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst add_cf_def, simp del:npow_suc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)));\n     snd (scf_d R S X (p \\<plusminus> q) (Suc d)) (Suc d) =\n     snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\n      (Suc d)\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (snd (scf_d R S X p (Suc d))\n                        (Suc d) \\<plusminus>\\<^bsub>S\\<^esub>\n                       snd (scf_d R S X q (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (thin_tac \"polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p\",\n        thin_tac \"polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q\",\n        thin_tac \"polyn_expr R X (Suc d) (add_cf S (scf_d R S X p (Suc d)) \n         (scf_d R S X q (Suc d))) =\n          polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d))\",\n        thin_tac \"pol_coeff S (add_cf S (scf_d R S X p (Suc d)) \n                  (scf_d R S X q (Suc d)))\",\n        thin_tac \"snd (scf_d R S X (p \\<plusminus> q) (Suc d)) (Suc d) =\n     snd (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) (Suc d)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (snd (scf_d R S X p (Suc d))\n                        (Suc d) \\<plusminus>\\<^bsub>S\\<^esub>\n                       snd (scf_d R S X q (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (frule pol_coeff_mem[of \"scf_d R S X p (Suc d)\" \"Suc d\"], \n        simp del:npow_suc,\n        frule pol_coeff_mem[of \"scf_d R S X q (Suc d)\" \"Suc d\"], \n        simp del:npow_suc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X q (Suc d)) (Suc d) \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (snd (scf_d R S X p (Suc d))\n                        (Suc d) \\<plusminus>\\<^bsub>S\\<^esub>\n                       snd (scf_d R S X q (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp del:npow_suc add:Subring_pOp_ring_pOp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X q (Suc d)) (Suc d) \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (snd (scf_d R S X p (Suc d)) (Suc d) \\<plusminus>\n                       snd (scf_d R S X q (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (frule mem_subring_mem_ring[of S \"snd (scf_d R S X p (Suc d)) (Suc d)\"],\n        assumption,\n        frule mem_subring_mem_ring[of S \"snd (scf_d R S X q (Suc d)) (Suc d)\"],\n        assumption,\n        cut_tac X_mem_R, frule Ring.npClose[of R X \"Suc d\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     fst (scf_d R S X q (Suc d)) = Suc d; p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X q (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R;\n     snd (scf_d R S X q (Suc d)) (Suc d) \\<in> carrier R; X \\<in> carrier R;\n     X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (scf_d R S X p (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> \\<plusminus>\n                      snd (scf_d R S X q (Suc d)) (Suc d) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (snd (scf_d R S X p (Suc d)) (Suc d) \\<plusminus>\n                       snd (scf_d R S X q (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 4. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (subst Ring.ring_distrib2[THEN sym], assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (add_cf S (scf_d R S X p (Suc d))\n                         (scf_d R S X q (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d))\n 3. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp add:add_cf_pol_coeff, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<le> an (Suc d); deg R S X q \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     pol_coeff S (scf_d R S X q (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) = p;\n     fst (scf_d R S X q (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X q (Suc d)) = q;\n     p \\<plusminus> q \\<in> carrier R;\n     deg R S X (p \\<plusminus> q) \\<le> an (Suc d);\n     pol_coeff S (scf_d R S X (p \\<plusminus> q) (Suc d));\n     fst (scf_d R S X (p \\<plusminus> q) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d)\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d))) =\n     polyn_expr R X (Suc d) (scf_d R S X (p \\<plusminus> q) (Suc d));\n     pol_coeff S\n      (add_cf S (scf_d R S X p (Suc d)) (scf_d R S X q (Suc d)))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S (scf_d R S X p (Suc d))\n                            (scf_d R S X q (Suc d))) =\n                      fst (scf_d R S X (p \\<plusminus> q) (Suc d))", "apply (simp add:add_cf_len)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ldeg_p_mOp:\"\\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (ldeg_p R S X d p) = ldeg_p R S X d (-\\<^sub>a p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (cut_tac Ring, frule Ring.ring_is_ag[of \"R\"],\n       cut_tac subring, frule subring_Ring[of S],\n       frule scf_d_pol[of p \"Suc d\"], assumption+, (erule conjE)+,\n       frule aGroup.ag_mOp_closed[of R p], assumption,\n       frule scf_d_pol[of \"-\\<^sub>a p\" \"Suc d\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) \\<le> an (Suc d)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d)) \\<and>\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d \\<and>\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (simp add:deg_minus_eq1, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (frule polyn_minus[of \"scf_d R S X p (Suc d)\"  \"Suc d\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d));\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (drule box_equation[of \"-\\<^sub>a p\" \"polyn_expr R X (Suc d)\n       (scf_d R S X (-\\<^sub>a p) (Suc d))\"\n       \"polyn_expr R X (Suc d) (fst (scf_d R S X p (Suc d)), \n                \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a p =\n                      polyn_expr R X (Suc d)\n                       (fst (scf_d R S X p (Suc d)),\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (rotate_tac 8, drule sym, simp,\n       thin_tac \"-\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n       polyn_expr R X (Suc d)\n       (fst (scf_d R S X p (Suc d)), \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (frule pol_expr_unique2[of \"scf_d R S X (-\\<^sub>a p) (Suc d)\" \n       \"(Suc d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc d,\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> fst (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n                      fst (Suc d,\n                           \\<lambda>j.\n                              -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                    (scf_d R S X p (Suc d)) j)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (subst pol_coeff_def, rule allI, rule impI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n        aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n        fst (scf_d R S X p (Suc d)) = Suc d;\n        p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n        -\\<^sub>a p \\<in> carrier R;\n        pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n        fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n        polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n        polyn_expr R X (Suc d)\n         (Suc d,\n          \\<lambda>j.\n             -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n        j \\<le> Suc d\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd\n               (scf_d R S X p (Suc d)) j\n                         \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> fst (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n                      fst (Suc d,\n                           \\<lambda>j.\n                              -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                    (scf_d R S X p (Suc d)) j)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (frule_tac j = j in pol_coeff_mem[of \"scf_d R S X p (Suc d)\"],\n        simp,\n        frule Ring.ring_is_ag[of S],\n        rule aGroup.ag_mOp_closed[of S], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a ldeg_p R S X d p =\n                      ldeg_p R S X d (-\\<^sub>a p)", "apply (simp add:ldeg_p_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a polyn_expr R X d (scf_d R S X p (Suc d)) =\n                      polyn_expr R X d (scf_d R S X (-\\<^sub>a p) (Suc d))", "apply (subst polyn_minus[of \"scf_d R S X p (Suc d)\" d], assumption, simp,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (Suc d,\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j) =\n                      polyn_expr R X d (scf_d R S X (-\\<^sub>a p) (Suc d))", "apply (subst polyn_expr_short[of \"(Suc d, \n              \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\" d])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc d,\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> d \\<le> fst (Suc d,\n                                   \\<lambda>j.\n-\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j)) =\n                      polyn_expr R X d (scf_d R S X (-\\<^sub>a p) (Suc d))", "apply (subst pol_coeff_def, rule allI, rule impI, simp,\n         frule_tac j = j in pol_coeff_mem[of \"scf_d R S X p (Suc d)\"],\n         simp,\n         frule Ring.ring_is_ag[of S],\n         rule aGroup.ag_mOp_closed[of S], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j)) =\n                      polyn_expr R X d (scf_d R S X (-\\<^sub>a p) (Suc d))", "apply (subst polyn_expr_short[of \"scf_d R S X (-\\<^sub>a p) (Suc d)\" d], \n          assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j)) =\n                      polyn_expr R X d\n                       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))", "apply (cut_tac pol_expr_unique2[of \"(d, snd (Suc d, \n                \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\" \n                \"(d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j;\n     (polyn_expr R X\n       (fst (d, snd (Suc d,\n                     \\<lambda>j.\n                        -\\<^sub>a\\<^bsub>S\\<^esub> snd\n              (scf_d R S X p (Suc d)) j)))\n       (d, snd (Suc d,\n                \\<lambda>j.\n                   -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d))\n         j)) =\n      polyn_expr R X (fst (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d))))\n       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))) =\n     (\\<forall>j\\<le>fst (d, snd (Suc d,\n                                  \\<lambda>j.\n                                     -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                           (scf_d R S X p (Suc d)) j)).\n         snd (d, snd (Suc d,\n                      \\<lambda>j.\n                         -\\<^sub>a\\<^bsub>S\\<^esub> snd\n               (scf_d R S X p (Suc d)) j))\n          j =\n         snd (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d))) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j)) =\n                      polyn_expr R X d\n                       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j))\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))\n 4. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> fst (d, snd (Suc d,\n                                   \\<lambda>j.\n-\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n                      fst (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))", "apply (thin_tac \"p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\",\n        thin_tac \"polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d) (Suc d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\",\n        simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, snd (Suc d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                         (scf_d R S X p (Suc d)) j))\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> fst (d, snd (Suc d,\n                                   \\<lambda>j.\n-\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n                      fst (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))", "apply (subst pol_coeff_def, rule allI, rule impI, simp,\n         frule Ring.ring_is_ag[of S], rule aGroup.ag_mOp_closed, assumption,\n         simp add:pol_coeff_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> fst (d, snd (Suc d,\n                                   \\<lambda>j.\n-\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n                      fst (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))", "apply (subst pol_coeff_def, rule allI, rule impI, simp,\n         frule Ring.ring_is_ag[of S], rule aGroup.ag_mOp_closed, assumption,\n         simp add:pol_coeff_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> fst (d, snd (Suc d,\n                                   \\<lambda>j.\n-\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n                      fst (d, snd (scf_d R S X (-\\<^sub>a p) (Suc d)))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) hdeg_p_mOp:\"\\<lbrakk>p \\<in> carrier R;deg R S X p \\<le> an (Suc d)\\<rbrakk> \n  \\<Longrightarrow> -\\<^sub>a (hdeg_p R S X (Suc d) p) = hdeg_p R S X (Suc d) (-\\<^sub>a p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (cut_tac Ring, frule Ring.ring_is_ag[of \"R\"],\n       cut_tac subring, frule subring_Ring[of S],\n       frule scf_d_pol[of p \"Suc d\"], assumption+, (erule conjE)+,\n       frule aGroup.ag_mOp_closed[of R p], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (\n       frule scf_d_pol[of \"-\\<^sub>a p\" \"Suc d\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (-\\<^sub>a p) \\<le> an (Suc d)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d)) \\<and>\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d \\<and>\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (simp add:deg_minus_eq1, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d))\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (frule polyn_minus[of \"scf_d R S X p (Suc d)\"  \"Suc d\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a p =\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d));\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (drule box_equation[of \"-\\<^sub>a p\" \"polyn_expr R X (Suc d)\n       (scf_d R S X (-\\<^sub>a p) (Suc d))\"\n       \"polyn_expr R X (Suc d) (fst (scf_d R S X p (Suc d)), \n                \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a p =\n                      polyn_expr R X (Suc d)\n                       (fst (scf_d R S X p (Suc d)),\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     -\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (rotate_tac 8, drule sym, simp,\n       thin_tac \"-\\<^sub>a polyn_expr R X (Suc d) (scf_d R S X p (Suc d)) =\n       polyn_expr R X (Suc d)\n       (fst (scf_d R S X p (Suc d)), \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (fst (scf_d R S X p (Suc d)),\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (frule pol_expr_unique2[of \"scf_d R S X (-\\<^sub>a p) (Suc d)\" \n       \"(Suc d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc d,\n                        \\<lambda>j.\n                           -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                 (scf_d R S X p (Suc d)) j)\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> fst (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n                      fst (Suc d,\n                           \\<lambda>j.\n                              -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                    (scf_d R S X p (Suc d)) j)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (subst pol_coeff_def, rule allI, rule impI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n        aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n        fst (scf_d R S X p (Suc d)) = Suc d;\n        p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n        -\\<^sub>a p \\<in> carrier R;\n        pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n        fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n        polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n        polyn_expr R X (Suc d)\n         (Suc d,\n          \\<lambda>j.\n             -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n        j \\<le> Suc d\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd\n               (scf_d R S X p (Suc d)) j\n                         \\<in> carrier S\n 2. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\\<rbrakk>\n    \\<Longrightarrow> fst (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n                      fst (Suc d,\n                           \\<lambda>j.\n                              -\\<^sub>a\\<^bsub>S\\<^esub> snd\n                    (scf_d R S X p (Suc d)) j)\n 3. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (frule_tac j = j in pol_coeff_mem[of \"scf_d R S X p (Suc d)\"],\n        simp,\n        frule Ring.ring_is_ag[of S],\n        rule aGroup.ag_mOp_closed[of S], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     (polyn_expr R X (fst (scf_d R S X (-\\<^sub>a p) (Suc d)))\n       (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n      polyn_expr R X\n       (fst (Suc d,\n             \\<lambda>j.\n                -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j))\n       (Suc d,\n        \\<lambda>j.\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)) =\n     (\\<forall>j\\<le>fst (scf_d R S X (-\\<^sub>a p) (Suc d)).\n         snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n         snd (Suc d,\n              \\<lambda>j.\n                 -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\n          j)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     \\<forall>j\\<le>Suc d.\n        snd (scf_d R S X (-\\<^sub>a p) (Suc d)) j =\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (drule_tac a = \"Suc d\" in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     snd (scf_d R S X (-\\<^sub>a p) (Suc d)) (Suc d) =\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) (Suc d)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a hdeg_p R S X (Suc d) p =\n                      hdeg_p R S X (Suc d) (-\\<^sub>a p)", "apply (simp del:npow_suc add:hdeg_p_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d;\n     p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d));\n     -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d)\n      (Suc d,\n       \\<lambda>j.\n          -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j);\n     snd (scf_d R S X (-\\<^sub>a p) (Suc d)) (Suc d) =\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) (Suc d)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a snd (scf_d R S X p (Suc d))\n                                 (Suc d) \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R Suc d\\<^esup> =\n                      (-\\<^sub>a\\<^bsub>S\\<^esub> snd\n             (scf_d R S X p (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>", "apply (thin_tac \"p = polyn_expr R X (Suc d) (scf_d R S X p (Suc d))\",\n        thin_tac \"polyn_expr R X (Suc d) (scf_d R S X (-\\<^sub>a p) (Suc d)) =\n     polyn_expr R X (Suc d) (Suc d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) j)\",\n        thin_tac \"snd (scf_d R S X (-\\<^sub>a p) (Suc d)) (Suc d) =\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd (scf_d R S X p (Suc d)) (Suc d)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d; -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a snd (scf_d R S X p (Suc d))\n                                 (Suc d) \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R Suc d\\<^esup> =\n                      (-\\<^sub>a\\<^bsub>S\\<^esub> snd\n             (scf_d R S X p (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>", "apply (frule pol_coeff_mem[of \"scf_d R S X p (Suc d)\" \"Suc d\"], simp,\n        frule mem_subring_mem_ring[of S \"snd (scf_d R S X p (Suc d)) (Suc d)\"],\n        assumption+,\n        frule Ring.npClose[of R X \"Suc d\"], simp add:X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d; -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R;\n     X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a snd (scf_d R S X p (Suc d))\n                                 (Suc d) \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R Suc d\\<^esup> =\n                      (-\\<^sub>a\\<^bsub>S\\<^esub> snd\n             (scf_d R S X p (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>", "apply (subst Ring.ring_inv1_1[of \"R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p \\<le> an (Suc d); Ring R;\n     aGroup R; Subring R S; Ring S; pol_coeff S (scf_d R S X p (Suc d));\n     fst (scf_d R S X p (Suc d)) = Suc d; -\\<^sub>a p \\<in> carrier R;\n     pol_coeff S (scf_d R S X (-\\<^sub>a p) (Suc d));\n     fst (scf_d R S X (-\\<^sub>a p) (Suc d)) = Suc d;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier S;\n     snd (scf_d R S X p (Suc d)) (Suc d) \\<in> carrier R;\n     X^\\<^bsup>R Suc d\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a snd (scf_d R S X p (Suc d))\n                                  (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup> =\n                      (-\\<^sub>a\\<^bsub>S\\<^esub> snd\n             (scf_d R S X p (Suc d)) (Suc d)) \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R Suc d\\<^esup>", "apply (simp del:npow_suc add:Subring_minus_ring_minus)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Multiplication of polynomials\""], ["", "lemma (in PolynRg) deg_mult_pols:\"\\<lbrakk>Idomain S;\n      p \\<in> carrier R; p \\<noteq> \\<zero>; q \\<in> carrier R; q \\<noteq> \\<zero> \\<rbrakk> \\<Longrightarrow> \n      p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n     deg_n R S X (p \\<cdot>\\<^sub>r q) = deg_n R S X p + deg_n R S X q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n     q \\<in> carrier R; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                      deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                      deg_n R S X p + deg_n R S X q", "apply (frule Idomain.idom_is_ring[of \"S\"],\n       frule_tac x = p and y = q in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n     q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n     p \\<cdot>\\<^sub>r q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                      deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                      deg_n R S X p + deg_n R S X q", "apply (frule s_cf_expr[of p], assumption,\n        frule s_cf_expr[of q], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n     q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n     p \\<cdot>\\<^sub>r q \\<in> carrier R; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                      deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                      deg_n R S X p + deg_n R S X q", "apply (frule_tac c = \"s_cf R S X p\" and d = \"s_cf R S X q\" in \n        polyn_expr_tOp_c, assumption, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        p \\<cdot>\\<^sub>r q \\<in> carrier R; pol_coeff S (s_cf R S X p);\n        pol_coeff S (s_cf R S X q);\n        p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst e) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q)\\<rbrakk>\n       \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                         deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                         deg_n R S X p + deg_n R S X q", "apply (drule sym, drule sym, simp,\n        thin_tac \"polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q) = q\",\n        thin_tac \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        p \\<cdot>\\<^sub>r q \\<in> carrier R; pol_coeff S (s_cf R S X p);\n        pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e =\n        p \\<cdot>\\<^sub>r q\\<rbrakk>\n       \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                         deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                         deg_n R S X p + deg_n R S X q", "apply (rotate_tac -1, drule sym,\n        frule ring_tOp_closed[of p q], assumption+,\n        frule pol_coeff_mem[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"], simp,\n        frule pol_coeff_mem[of \"s_cf R S X q\" \"fst (s_cf R S X q)\"], simp,\n        frule_tac x = \"snd (s_cf R S X p) (fst (s_cf R S X p))\" and \n        y = \"snd (s_cf R S X q) (fst (s_cf R S X q))\" in \n        Idomain.idom_tOp_nonzeros[of \"S\"], assumption+,\n        frule_tac c = e in  coeff_nonzero_polyn_nonzero[ of _ \n        \"deg_n R S X p + deg_n R S X q\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X p + deg_n R S X q\n                         \\<le> fst (s_cf R S X p) + fst (s_cf R S X q)\n 2. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        p \\<cdot>\\<^sub>r q \\<in> carrier R; pol_coeff S (s_cf R S X p);\n        pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        p \\<cdot>\\<^sub>r q \\<in> carrier R;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        (polyn_expr R X (deg_n R S X p + deg_n R S X q) e \\<noteq>\n         \\<zero>) =\n        (\\<exists>j\\<le>deg_n R S X p + deg_n R S X q.\n            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> p \\<cdot>\\<^sub>r q \\<noteq> \\<zero> \\<and>\n                         deg_n R S X (p \\<cdot>\\<^sub>r q) =\n                         deg_n R S X p + deg_n R S X q", "apply (simp add:s_cf_deg, simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        (polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e \\<noteq>\n         \\<zero>) =\n        (\\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q).\n            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>j\\<le>fst (s_cf R S X p) +\n   fst (s_cf R S X q).\n                             snd e j \\<noteq>\n                             \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                         deg_n R S X\n                          (polyn_expr R X\n                            (fst (s_cf R S X p) + fst (s_cf R S X q)) e) =\n                         fst (s_cf R S X p) + fst (s_cf R S X q)", "apply (cut_tac n = \"fst (s_cf R S X p) + fst (s_cf R S X q)\" in le_refl)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        (polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e \\<noteq>\n         \\<zero>) =\n        (\\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q).\n            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>);\n        fst (s_cf R S X p) + fst (s_cf R S X q)\n        \\<le> fst (s_cf R S X p) + fst (s_cf R S X q)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>j\\<le>fst (s_cf R S X p) +\n   fst (s_cf R S X q).\n                             snd e j \\<noteq>\n                             \\<zero>\\<^bsub>S\\<^esub>) \\<and>\n                         deg_n R S X\n                          (polyn_expr R X\n                            (fst (s_cf R S X p) + fst (s_cf R S X q)) e) =\n                         fst (s_cf R S X p) + fst (s_cf R S X q)", "apply (subgoal_tac \"\\<exists>j\\<le>fst (s_cf R S X p) + \n                       fst (s_cf R S X q). snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e \\<noteq>\n        \\<zero>;\n        \\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q).\n           snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (polyn_expr R X\n                            (fst (s_cf R S X p) + fst (s_cf R S X q)) e) =\n                         fst (s_cf R S X p) + fst (s_cf R S X q)\n 2. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        (polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e \\<noteq>\n         \\<zero>) =\n        (\\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q).\n            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>);\n        fst (s_cf R S X p) + fst (s_cf R S X q)\n        \\<le> fst (s_cf R S X p) + fst (s_cf R S X q)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst (s_cf R S X p) +\n  fst (s_cf R S X q).\n                            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac c = e in pol_deg_n[of \"p \\<cdot>\\<^sub>r q\" _ \n                \"fst (s_cf R S X p) + fst (s_cf R S X q)\"], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n        \\<in> carrier R;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        p \\<cdot>\\<^sub>r q =\n        polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e;\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        (polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e \\<noteq>\n         \\<zero>) =\n        (\\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q).\n            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst (s_cf R S X p) +\n  fst (s_cf R S X q).\n                            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (thin_tac \"(polyn_expr R X (fst (s_cf R S X p) + \n          fst (s_cf R S X q)) e \\<noteq> \\<zero>) =\n         (\\<exists>j\\<le>fst (s_cf R S X p) + fst (s_cf R S X q). snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\",\n        thin_tac \"p \\<cdot>\\<^sub>r q =\n         polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\",\n        thin_tac \"polyn_expr R X (fst (s_cf R S X p) + fst (s_cf R S X q)) e\n         \\<in> carrier R\",\n        thin_tac \"snd (s_cf R S X p) (fst (s_cf R S X p)) \\<in> carrier S\",\n        thin_tac \"snd (s_cf R S X q) (fst (s_cf R S X q)) \\<in> carrier S\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X p) + fst (s_cf R S X q);\n        snd e (fst (s_cf R S X p) + fst (s_cf R S X q)) =\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q));\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst (s_cf R S X p) +\n  fst (s_cf R S X q).\n                            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (drule sym, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>e.\n       \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n        q \\<in> carrier R; q \\<noteq> \\<zero>; Ring S;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; snd e (fst e) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X p) + fst (s_cf R S X q) = fst e;\n        snd (s_cf R S X p)\n         (fst (s_cf R S X p)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X q) (fst (s_cf R S X q)) =\n        snd e (fst e)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>fst e.\n                            snd e j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac n = \"fst e\" in le_refl, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_mult_pols1:\"\\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \n          deg R S X (p \\<cdot>\\<^sub>r q) = deg R S X p + deg R S X q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_0_x, simp add:deg_def,\n       rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; \\<zero> \\<in> carrier R; q \\<in> carrier R;\n     p = \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> = - \\<infinity> + an (deg_n R S X q)\n 2. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (simp add:an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_x_0, simp add:deg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; \\<zero> \\<in> carrier R;\n     p \\<noteq> \\<zero>; q = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> - \\<infinity> = an (deg_n R S X p) + - \\<infinity>\n 2. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (simp add:an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (frule deg_mult_pols[of p q], assumption+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<cdot>\\<^sub>r q \\<noteq> \\<zero>;\n     deg_n R S X (p \\<cdot>\\<^sub>r q) =\n     deg_n R S X p + deg_n R S X q\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (frule Idomain.idom_is_ring[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<cdot>\\<^sub>r q \\<noteq> \\<zero>;\n     deg_n R S X (p \\<cdot>\\<^sub>r q) = deg_n R S X p + deg_n R S X q;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (frule ring_tOp_closed[of p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; q \\<in> carrier R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<cdot>\\<^sub>r q \\<noteq> \\<zero>;\n     deg_n R S X (p \\<cdot>\\<^sub>r q) = deg_n R S X p + deg_n R S X q;\n     Ring S; p \\<cdot>\\<^sub>r q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<cdot>\\<^sub>r q) =\n                      deg R S X p + deg R S X q", "apply (simp add:deg_an an_def a_zpz)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) const_times_polyn:\"\\<lbrakk>Idomain S; c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n       p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (c \\<cdot>\\<^sub>r p) \\<noteq> \\<zero>  \\<and>\n       deg_n R S X (c \\<cdot>\\<^sub>r p) = deg_n R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; p \\<in> carrier R;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<cdot>\\<^sub>r p \\<noteq> \\<zero> \\<and>\n                      deg_n R S X (c \\<cdot>\\<^sub>r p) = deg_n R S X p", "apply (frule Idomain.idom_is_ring[of \"S\"],\n       cut_tac subring,\n       frule mem_subring_mem_ring[of S c], assumption+,\n       simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; c \\<in> carrier S; c \\<noteq> \\<zero>;\n     p \\<in> carrier R; p \\<noteq> \\<zero>; Ring S; Subring R S;\n     c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> c \\<cdot>\\<^sub>r p \\<noteq> \\<zero> \\<and>\n                      deg_n R S X (c \\<cdot>\\<^sub>r p) = deg_n R S X p", "apply (frule deg_mult_pols[of c p], assumption+,\n       erule conjE, simp,\n       simp add:pol_of_deg0[THEN sym, of \"c\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*lemma (in PolynRg) deg_minus_eq:\"\\<lbrakk>ring R; integral_domain S; polyn_ring R S X; \np \\<in> carrier R; p \\<noteq> 0\\<^sub>R\\<rbrakk> \\<Longrightarrow>   deg_n R S X (-\\<^sub>R p) = deg_n R S X p\" *)"], ["", "lemma (in PolynRg) p_times_monomial_nonzero:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                                          (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n                      \\<zero>", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n                      \\<zero>", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n                      \\<zero>", "apply (frule low_deg_terms_zero1[THEN sym, of \"s_cf R S X p\" j])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) =\n     polyn_expr R X (fst (s_cf R S X p) + j)\n      (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n                      \\<zero>", "apply (drule sym, simp,\n        thin_tac \"X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r p =\n     polyn_expr R X (fst (s_cf R S X p) + j) (ext_cf S j (s_cf R S X p))\",\n         thin_tac \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R S X p) + j)\n                       (ext_cf S j (s_cf R S X p)) \\<noteq>\n                      \\<zero>", "apply (frule ext_cf_pol_coeff[of \"s_cf R S X p\" j])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R S X p) + j)\n                       (ext_cf S j (s_cf R S X p)) \\<noteq>\n                      \\<zero>", "apply(frule coeff_nonzero_polyn_nonzero[of \"ext_cf S j (s_cf R S X p)\"\n                                      \"fst (ext_cf S j (s_cf R S X p))\"],\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p));\n     (polyn_expr R X (fst (ext_cf S j (s_cf R S X p)))\n       (ext_cf S j (s_cf R S X p)) \\<noteq>\n      \\<zero>) =\n     (\\<exists>ja\\<le>fst (ext_cf S j (s_cf R S X p)).\n         snd (ext_cf S j (s_cf R S X p)) ja \\<noteq>\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R S X p) + j)\n                       (ext_cf S j (s_cf R S X p)) \\<noteq>\n                      \\<zero>", "apply (simp add:ext_cf_len add.commute[of j],\n     thin_tac \"(polyn_expr R X (fst (s_cf R S X p) + j) \n         (ext_cf S j (s_cf R S X p)) \\<noteq> \\<zero>) =\n     (\\<exists>ja\\<le>fst (s_cf R S X p) + j. snd (ext_cf S j (s_cf R S X p)) ja \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ja\\<le>fst (s_cf R S X p) + j.\n                         snd (ext_cf S j (s_cf R S X p)) ja \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac ext_cf_hi[of \"s_cf R S X p\" j], simp,\n        thin_tac \"snd (s_cf R S X p) (fst (s_cf R S X p)) =\n        snd (ext_cf S j (s_cf R S X p)) (j + fst (s_cf R S X p))\",\n        simp add:add.commute[of _ j])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (ext_cf S j (s_cf R S X p)) (j + fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ja\\<le>j + fst (s_cf R S X p).\n                         snd (ext_cf S j (s_cf R S X p)) ja \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)", "apply (cut_tac n = \"j + fst (s_cf R S X p)\" in le_refl, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S j (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) p_times_monomial_nonzero1:\"\\<lbrakk>Idomain S; p \\<in> carrier R; \n       p \\<noteq> \\<zero>; c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>(c \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> c \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      p \\<noteq>\n                      \\<zero>", "apply (frule Idomain.idom_is_ring[of \"S\"],\n       cut_tac subring,\n       cut_tac X_mem_R ,\n       frule mem_subring_mem_ring[of S c], assumption+,\n       frule npClose[of X j])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Ring S;\n     Subring R S; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> c \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      p \\<noteq>\n                      \\<zero>", "apply (simp add:ring_tOp_commute[of c],\n       simp add:ring_tOp_assoc,\n       frule const_times_polyn[of c p], assumption+,\n       erule conjE,\n       frule ring_tOp_closed[of c p], assumption+,\n       simp add:p_times_monomial_nonzero[of \"c \\<cdot>\\<^sub>r p\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_ring_integral:\"Idomain S = Idomain R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Idomain S = Idomain R", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> Idomain S = Idomain R", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain S\\<rbrakk>\n    \\<Longrightarrow> Idomain R\n 2. \\<lbrakk>Subring R S; Ring S; Idomain R\\<rbrakk>\n    \\<Longrightarrow> Idomain S", "apply (subst Idomain_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain S\\<rbrakk>\n    \\<Longrightarrow> Ring R \\<and> Idomain_axioms R\n 2. \\<lbrakk>Subring R S; Ring S; Idomain R\\<rbrakk>\n    \\<Longrightarrow> Idomain S", "apply (cut_tac Ring, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain S; Ring R\\<rbrakk>\n    \\<Longrightarrow> Idomain_axioms R\n 2. \\<lbrakk>Subring R S; Ring S; Idomain R\\<rbrakk>\n    \\<Longrightarrow> Idomain S", "apply (rule Idomain_axioms.intro,\n        rule contrapos_pp, simp+, erule conjE,\n        frule_tac p = a and q = b in deg_mult_pols,\n       assumption+, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain R\\<rbrakk>\n    \\<Longrightarrow> Idomain S", "apply (subst Idomain_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain R\\<rbrakk>\n    \\<Longrightarrow> Ring S \\<and> Idomain_axioms S", "apply (cut_tac Ring, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R\\<rbrakk>\n    \\<Longrightarrow> Idomain_axioms S", "apply (rule Idomain_axioms.intro,\n        rule contrapos_pp, simp+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Subring_tOp_ring_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = a in mem_subring_mem_ring[of S], assumption,\n        frule_tac x = b in mem_subring_mem_ring[of S], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; a \\<in> carrier R;\n        b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = a and b = b in Idomain.idom[of R], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; a \\<in> carrier R;\n        b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r b = \\<zero>\n 2. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; a \\<in> carrier R;\n        b \\<in> carrier R; a = \\<zero> \\<or> b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; a \\<in> carrier R;\n        b \\<in> carrier R; a = \\<zero> \\<or> b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (erule disjE, simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Subring R S; Ring S; Idomain R; Ring R; a \\<in> carrier S;\n        b \\<in> carrier S; a \\<cdot>\\<^sub>r b = \\<zero>\\<^bsub>S\\<^esub>;\n        a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        b \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; a \\<in> carrier R;\n        b \\<in> carrier R; b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_to_X_d:\"Idomain S \\<Longrightarrow>  deg_n R S X (X^\\<^bsup>R d\\<^esup>) = d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Idomain S \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R d\\<^esup>) = d", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac polyn_ring_S_nonzero,\n       cut_tac X_mem_R,\n       cut_tac polyn_ring_X_nonzero,\n       cut_tac polyn_ring_integral)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; Subring R S; Ring S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S = Idomain R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R d\\<^esup>) = d", "apply (induct_tac d)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; Subring R S; Ring S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S = Idomain R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R 0\\<^esup>) = 0\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; Subring R S; Ring S;\n        1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S = Idomain R;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R Suc n\\<^esup>) = Suc n", "apply (cut_tac ring_one,\n        simp add:Subring_one_ring_one[THEN sym],\n        simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; Subring R S; Ring S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub> = 0\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; Subring R S; Ring S;\n        1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S = Idomain R;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R Suc n\\<^esup>) = Suc n", "apply (subst pol_of_deg0[of \"1\\<^sub>r\\<^bsub>S\\<^esub>\"], assumption+, simp add:Ring.ring_one[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; Subring R S; Ring S;\n        1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S = Idomain R;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R Suc n\\<^esup>) = Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Subring R S; Ring S;\n        1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (subst deg_mult_pols, assumption+,\n        simp add:npClose, \n        rule Idomain.idom_potent_nonzero, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Subring R S; Ring S;\n        1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        X \\<in> carrier R; X \\<noteq> \\<zero>; Idomain S;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X (X^\\<^bsup>R n\\<^esup>) +\n                         deg_n R S X X =\n                         Suc n", "apply (simp add:deg_n_of_X)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \\<open>Degree with value in \\<open>aug_minf\\<close>\\<close>"], ["", "lemma (in PolynRg) nonzero_deg_pos:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> \n                                                 0 \\<le> deg R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> deg R S X p", "by (simp add:deg_def)"], ["", "lemma (in PolynRg) deg_minf_pol_0:\"p \\<in> carrier R \\<Longrightarrow>\n                    (deg R S X p = -\\<infinity>) = (p = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    (deg R S X p = - \\<infinity>) = (p = \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; deg R S X p = - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> p = \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X p = - \\<infinity>", "apply (rule contrapos_pp, simp+,\n        frule nonzero_deg_pos[of p], assumption+,\n        simp add:deg_def an_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X p = - \\<infinity>", "apply (simp add:deg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_nonzero:\"p \\<in> carrier R \\<Longrightarrow>\n             (0 \\<le> deg R S X p) = (p \\<noteq> \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    (0 \\<le> deg R S X p) = (p \\<noteq> \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; 0 \\<le> deg R S X p\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> deg R S X p", "apply (rule contrapos_pp, simp+, simp add:deg_def,\n       cut_tac minf_le_any[of \"0\"], frule ale_antisym[of \"0\" \"-\\<infinity>\"], \n       assumption+,\n       simp only:an_0[THEN sym], simp only:an_def, simp del:of_nat_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> deg R S X p", "apply (simp add:deg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) minus_deg_in_aug_minf:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                   - (deg R S X p) \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> - deg R S X p \\<in> Z\\<^sub>-\\<^sub>\\<infinity>", "apply (frule deg_in_aug_minf[of p],\n      frule pol_nonzero[THEN sym, of p],\n      simp add:aug_minf_def,\n      rule contrapos_pp, simp+,\n      cut_tac a_minus_minus[of \"deg R S X p\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; 0 \\<le> deg R S X p;\n     deg R S X p \\<noteq> \\<infinity>; p \\<noteq> \\<zero>;\n     - deg R S X p = \\<infinity>; - \\<infinity> = deg R S X p\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"- deg R S X p = \\<infinity>\", frule sym, \n       thin_tac \"- \\<infinity> = deg R S X p\",\n       frule deg_minf_pol_0[of p], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_of_X:\"deg R S X X = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. deg R S X X = 1", "(* the degree of the polyn. X *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. deg R S X X = 1", "apply (cut_tac X_mem_R,\n       cut_tac polyn_ring_X_nonzero,\n       cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>X \\<in> carrier R; X \\<noteq> \\<zero>; Subring R S\\<rbrakk>\n    \\<Longrightarrow> deg R S X X = 1", "apply (simp add:deg_def, simp only:an_1[THEN sym],\n       rule nat_eq_an_eq, simp add:deg_n_of_X)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_deg_0:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n                   \\<Longrightarrow>  (deg R S X p = 0) = (p \\<in> carrier S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (deg R S X p = 0) = (p \\<in> carrier S)", "apply (simp add:deg_def, simp only:an_0[THEN sym],\n       rule iffI,\n       frule an_inj[of \"deg_n R S X p\" \"0\"], simp,\n       simp add:pol_of_deg0,\n       rule nat_eq_an_eq, simp add:pol_of_deg0[of p])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_of_X2n:\"Idomain S \\<Longrightarrow> deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Idomain S \\<Longrightarrow> deg R S X (X^\\<^bsup>R n\\<^esup>) = an n", "apply (frule Idomain.idom_is_ring[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; Ring S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (X^\\<^bsup>R n\\<^esup>) = an n", "apply (cut_tac subring,\n       cut_tac X_mem_R,\n       cut_tac polyn_ring_X_nonzero,\n       cut_tac polyn_ring_integral, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (X^\\<^bsup>R n\\<^esup>) = an n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (X^\\<^bsup>R 0\\<^esup>) = an 0\n 2. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> deg R S X 1\\<^sub>r = 0\n 2. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (simp add:Subring_one_ring_one[THEN sym, of \"S\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> deg R S X 1\\<^sub>r\\<^bsub>S\\<^esub> = 0\n 2. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (subst pol_deg_0[of \"1\\<^sub>r\\<^bsub>S\\<^esub>\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R\n 2. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\n 3. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S\n 4. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (simp add:Subring_one_ring_one, simp add:ring_one)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\n 2. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S\n 3. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (simp add:Subring_one_ring_one[of S] polyn_ring_nonzero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n     X \\<noteq> \\<zero>; Idomain S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S\n 2. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (simp add:Ring.ring_one[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (frule_tac n = n in npClose[of X])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        deg R S X (X^\\<^bsup>R n\\<^esup>) = an n;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> deg R S X (X^\\<^bsup>R Suc n\\<^esup>) = an (Suc n)", "apply (simp add:deg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        (if X^\\<^bsup>R n\\<^esup> = \\<zero> then - \\<infinity>\n         else an (deg_n R S X (X^\\<^bsup>R n\\<^esup>))) =\n        an n;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X =\n                          \\<zero> \\<longrightarrow>\n                          - \\<infinity> = an (Suc n)) \\<and>\n                         (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq>\n                          \\<zero> \\<longrightarrow>\n                          an (deg_n R S X\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X)) =\n                          an (Suc n))", "apply (simp add:Idomain.idom_potent_nonzero,\n       frule_tac n = \"Suc n\" in Idomain.idom_potent_nonzero[of R X],\n       assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        an (deg_n R S X (X^\\<^bsup>R n\\<^esup>)) = an n;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> an (deg_n R S X\n                              (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X)) =\n                         an (Suc n)", "apply (rule nat_eq_an_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        an (deg_n R S X (X^\\<^bsup>R n\\<^esup>)) = an n;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (frule_tac n = n in Idomain.idom_potent_nonzero[of R X], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        an (deg_n R S X (X^\\<^bsup>R n\\<^esup>)) = an n;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>;\n        X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (frule_tac n = \"deg_n R S X (X^\\<^bsup>R n\\<^esup>)\" and m = n in an_inj,\n       thin_tac \"an (deg_n R S X (X^\\<^bsup>R n\\<^esup>)) = an n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>;\n        X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (cut_tac deg_of_X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>;\n        X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n; deg R S X X = 1\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (simp add:deg_def, simp only:an_1[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>;\n        X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n;\n        an (deg_n R S X X) = an 1\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (frule_tac n = \"deg_n R S X X\" and m = 1 in an_inj)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain R; Ring S; Subring R S; X \\<in> carrier R;\n        X \\<noteq> \\<zero>; Idomain S;\n        X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X \\<noteq> \\<zero>;\n        X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        deg_n R S X (X^\\<^bsup>R n\\<^esup>) = n; an (deg_n R S X X) = an 1;\n        deg_n R S X X = 1\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r X) =\n                         Suc n", "apply (simp add:deg_mult_pols)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) add_pols_nonzero:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n      (deg R S X p) \\<noteq> (deg R S X q)\\<rbrakk>  \\<Longrightarrow>  p \\<plusminus> q \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<noteq> deg R S X q\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (cut_tac ring_is_ag,\n       cut_tac subring,\n       frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<noteq> deg R S X q; aGroup R; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:deg_minf_pol_0[THEN sym],\n       simp add:aGroup.ag_l_zero, rule contrapos_pp, simp+,\n       case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p \\<noteq> deg R S X q; aGroup R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> q \\<noteq> \\<zero>", "apply (simp add:deg_def, \n       simp only:aneq_natneq[of \"deg_n R S X p\" \"deg_n R S X q\"],\n       cut_tac less_linear[of \"deg_n R S X p\" \"deg_n R S X q\"], simp,\n       erule disjE,\n       rule less_deg_add_nonzero[of p q],\n         assumption+,\n       frule less_deg_add_nonzero[of q p], assumption+,\n       simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_pols_add1:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n                (deg R S X p) < (deg R S X q)\\<rbrakk>  \\<Longrightarrow>  \n                              deg R S X (p \\<plusminus> q) = deg R S X q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p < deg R S X q\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) = deg R S X q", "apply (cut_tac ring_is_ag,\n       case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:deg_def aGroup.ag_l_zero,\n       case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:deg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; \\<zero> \\<in> carrier R;\n     an (deg_n R S X p) < - \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> \\<zero> \\<noteq>\n                      \\<zero> \\<longrightarrow>\n                      an (deg_n R S X (p \\<plusminus> \\<zero>)) =\n                      - \\<infinity>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p < deg R S X q; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) = deg R S X q", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; \\<zero> \\<in> carrier R;\n     an (deg_n R S X p) < - \\<infinity>; aGroup R; p \\<noteq> \\<zero>;\n     q = \\<zero>; p \\<plusminus> \\<zero> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> an (deg_n R S X (p \\<plusminus> \\<zero>)) =\n                      - \\<infinity>\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p < deg R S X q; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) = deg R S X q", "apply (simp add:an_def z_neq_minf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; \\<zero> \\<in> carrier R;\n     ant (int (deg_n R S X p)) < - \\<infinity>; aGroup R;\n     p \\<noteq> \\<zero>; q = \\<zero>;\n     p \\<plusminus> \\<zero> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p < deg R S X q; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) = deg R S X q", "apply (fold an_def,\n        frule aless_imp_le[of \"an (deg_n R S X p)\" \" - \\<infinity>\"],\n        cut_tac minf_le_any[of \"an (deg_n R S X p)\"],\n        frule ale_antisym[of \"an (deg_n R S X p)\" \"- \\<infinity>\"], assumption+,\n        simp add:an_neq_minf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p < deg R S X q; aGroup R; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) = deg R S X q", "apply (simp add:deg_def, simp add:aless_nat_less,\n       frule less_deg_add_nonzero[of p q], assumption+,\n       simp, frule polyn_deg_add1[of p q], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_pols_add2:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) = (deg R S X q)\\<rbrakk>  \\<Longrightarrow> \n               deg R S X (p \\<plusminus> q) \\<le> (deg R S X q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p = deg R S X q\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> deg R S X q", "apply (cut_tac ring_is_ag, \n       cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p = deg R S X q; aGroup R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> deg R S X q", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p = deg R S X q; aGroup R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> deg R S X q", "apply (case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R;\n     deg R S X p = deg R S X q; aGroup R; Subring R S; Ring S;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> deg R S X q", "apply (simp add:deg_def,\n       frule an_inj[of \"deg_n R S X p\" \"deg_n R S X q\"], simp,\n       rule impI, subst ale_natle, simp add:polyn_deg_add2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_pols_add3:\"\\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; \n       (deg R S X p) \\<le> an n; (deg R S X q) \\<le> an n\\<rbrakk>  \\<Longrightarrow> \n                  deg R S X (p \\<plusminus> q) \\<le> an n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (case_tac \"(deg R S X p) = (deg R S X q)\",\n       frule deg_pols_add2[of p q], assumption+,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; q \\<in> carrier R; deg R S X p \\<le> an n;\n     deg R S X q \\<le> an n; deg R S X p \\<noteq> deg R S X q\\<rbrakk>\n    \\<Longrightarrow> deg R S X (p \\<plusminus> q) \\<le> an n", "apply (cut_tac aless_linear[of \"deg R S X p\" \"deg R S X q\"],\n       simp, thin_tac \"deg R S X p \\<noteq> deg R S X q\",\n       erule disjE, simp add:deg_pols_add1,\n       cut_tac ring_is_ag, simp add:aGroup.ag_pOp_commute[of \"R\" \"p\" \"q\"],\n       simp add:deg_pols_add1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) const_times_polyn1:\"\\<lbrakk>Idomain S; p\\<in> carrier R; c \\<in> carrier S;\n            c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> deg R S X (c \\<cdot>\\<^sub>r p) = deg R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> deg R S X (c \\<cdot>\\<^sub>r p) = deg R S X p", "apply (frule Idomain.idom_is_ring,\n       cut_tac subring,\n       frule mem_subring_mem_ring[of S c], assumption,\n       simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>; Ring S; Subring R S; c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X (c \\<cdot>\\<^sub>r p) = deg R S X p", "apply (subst deg_mult_pols1[of c p], assumption+,\n       simp add: pol_deg_0[THEN sym, of \"c\"],\n       simp add:aadd_0_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Homomorphism of polynomial rings\""], ["", "definition\n  cf_h :: \" ('a \\<Rightarrow> 'b) \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'a) \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'b)\" where\n  \"cf_h f = (\\<lambda>c. (fst c, cmp f (snd c)))\""], ["", "definition\n  polyn_Hom :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a,\n              ('b, 'n) Ring_scheme, ('b, 'n1) Ring_scheme, 'b] \\<Rightarrow>\n              ('a \\<Rightarrow> 'b) set\"\n            (\"(pHom _ _ _, _ _ _)\" [67,67,67,67,67,68]67) where\n  \"pHom R S X, A B Y = {f. f \\<in> rHom R A \\<and> f`(carrier S) \\<subseteq> carrier B \\<and> \n                          f X = Y}\""], ["", "(* Hom from a polynomial ring to\n                                        a polynomial ring *)"], ["", "definition\n  erh :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a,\n           ('b, 'n) Ring_scheme, ('b, 'n1) Ring_scheme, 'b, 'a \\<Rightarrow> 'b, \n          nat, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> 'b\" where\n  \"erh R S X A B Y f n c = polyn_expr A Y n (cf_h f c)\""], ["", "(* extension of a ring hom. *)"], ["", "lemma (in PolynRg) cf_h_len:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n                   pol_coeff S c\\<rbrakk> \\<Longrightarrow> fst (cf_h f c) = fst c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> fst (cf_h f c) = fst c", "by (simp add:cf_h_def)"], ["", "lemma (in PolynRg) cf_h_coeff:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n                   pol_coeff S c\\<rbrakk> \\<Longrightarrow>  pol_coeff B (cf_h f c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (cf_h f c)", "apply (subst pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (cf_h f c).\n                         snd (cf_h f c) j \\<in> carrier B", "apply (rule allI, rule impI, simp add:cf_h_len cf_h_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; pol_coeff S c;\n        j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> cmp f (snd c) j \\<in> carrier B", "apply (frule_tac j = j in pol_coeff_mem[of c], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; pol_coeff S c;\n        j \\<le> fst c; snd c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> cmp f (snd c) j \\<in> carrier B", "apply (simp add:cmp_def rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) cf_h_cmp:\"\\<lbrakk>PolynRg A B Y; pol_coeff S (n, f); h \\<in> rHom S B;\n                    j \\<le> n\\<rbrakk> \\<Longrightarrow>\n                 (snd (cf_h h (n, f))) j = (cmp h f) j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; pol_coeff S (n, f); h \\<in> rHom S B;\n     j \\<le> n\\<rbrakk>\n    \\<Longrightarrow> snd (cf_h h (n, f)) j = cmp h f j", "by (simp add:cf_h_def)"], ["", "lemma (in PolynRg) cf_h_special_cf:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk> \\<Longrightarrow>\n       polyn_expr A Y (Suc 0) (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n         polyn_expr A Y (Suc 0) (ext_cf B (Suc 0) (C\\<^sub>0 B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n                      polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B))", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n                      polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B))", "apply (cut_tac special_cf_pol_coeff,\n       frule ext_cf_pol_coeff[of \"C\\<^sub>0 S\" \"Suc 0\"],\n       frule cf_h_coeff[of A B Y h \"ext_cf S (Suc 0) (C\\<^sub>0 S)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n                      polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B))", "apply (frule PolynRg.special_cf_pol_coeff,\n       frule PolynRg.ext_cf_pol_coeff[of A B Y \"C\\<^sub>0 B\" \"Suc 0\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)));\n     pol_coeff B (C\\<^sub>0 B);\n     pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n                      polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B))", "apply (frule PolynRg.pol_expr_unique2[of A B Y \n             \"cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))\" \"ext_cf B (Suc 0) (C\\<^sub>0 B)\"],\n       assumption+,\n       simp add:cf_h_len PolynRg.ext_cf_len,\n       simp add:ext_cf_len special_cf_len PolynRg.special_cf_len,\n       simp add:cf_h_len PolynRg.ext_cf_len,\n       simp add:ext_cf_len special_cf_len PolynRg.special_cf_len,\n       thin_tac \"(polyn_expr A Y (Suc 0) (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n                   polyn_expr A Y (Suc 0) (ext_cf B (Suc 0) (C\\<^sub>0 B))) =\n                (\\<forall>j\\<le>Suc 0.\n                  snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                  snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j)\",\n       thin_tac \"pol_coeff S (C\\<^sub>0 S)\",\n       thin_tac \"pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\",\n       thin_tac \"pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n     pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc 0.\n                         snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n        Ring A; Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n        pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B)); j \\<le> Suc 0\\<rbrakk>\n       \\<Longrightarrow> snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j", "apply (case_tac \"j = 0\", simp add:cf_h_def cmp_def ext_cf_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n        Ring A; Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n        pol_coeff B\n         (Suc (fst (C\\<^sub>0 B)),\n          \\<lambda>i.\n             if Suc 0 \\<le> i then snd (C\\<^sub>0 B) (sliden (Suc 0) i)\n             else \\<zero>\\<^bsub>B\\<^esub>);\n        j = 0\\<rbrakk>\n       \\<Longrightarrow> h \\<zero>\\<^bsub>S\\<^esub> =\n                         \\<zero>\\<^bsub>B\\<^esub>\n 2. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n        Ring A; Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n        pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B)); j \\<le> Suc 0;\n        j \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j", "apply (simp add:rHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n        Ring A; Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n        pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B)); j \\<le> Suc 0;\n        j \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n        Ring A; Subring A B; Ring B; pol_coeff B (C\\<^sub>0 B);\n        pol_coeff B (ext_cf B (Suc 0) (C\\<^sub>0 B)); j \\<le> Suc 0;\n        0 < j\\<rbrakk>\n       \\<Longrightarrow> snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (ext_cf B (Suc 0) (C\\<^sub>0 B)) j", "apply (frule_tac n = j in Suc_leI[of 0],\n        frule_tac m = j and n = \"Suc 0\" in le_antisym, assumption+,\n        thin_tac \"j \\<le> Suc 0\", thin_tac \"Suc 0 \\<le> j\",\n        simp add:cf_h_def cmp_def ext_cf_def sliden_def special_cf_def,\n        simp add:rHom_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_Hom_coeff_to_coeff:\n     \"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; pol_coeff S c\\<rbrakk>\n        \\<Longrightarrow>  pol_coeff B (cf_h f c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (cf_h f c)", "apply (subst pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (cf_h f c).\n                         snd (cf_h f c) j \\<in> carrier B", "apply (rule allI, rule impI, simp add:cf_h_len cf_h_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; pol_coeff S c;\n        j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> cmp f (snd c) j \\<in> carrier B", "apply (frule_tac j = j in pol_coeff_mem[of c], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; pol_coeff S c;\n        j \\<le> fst c; snd c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> cmp f (snd c) j \\<in> carrier B", "apply (simp add:cmp_def polyn_Hom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S c; j \\<le> fst c;\n        snd c j \\<in> carrier S; f \\<in> rHom R A;\n        f ` carrier S \\<subseteq> carrier B; f X = Y\\<rbrakk>\n       \\<Longrightarrow> f (snd c j) \\<in> carrier B", "apply (simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S c; j \\<le> fst c;\n        snd c j \\<in> carrier S; f \\<in> rHom R A;\n        {y. \\<exists>x\\<in>carrier S. y = f x} \\<subseteq> carrier B;\n        f X = Y\\<rbrakk>\n       \\<Longrightarrow> f (snd c j) \\<in> carrier B", "apply (rule subsetD[of \"{y. \\<exists>x\\<in>carrier S. y = f x}\" \"carrier B\"], assumption,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S c; j \\<le> fst c;\n        snd c j \\<in> carrier S; f \\<in> rHom R A;\n        {y. \\<exists>x\\<in>carrier S. y = f x} \\<subseteq> carrier B;\n        f X = Y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier S. f (snd c j) = f x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* old name is cmp_pol_coeff *)"], ["", "lemma (in PolynRg) cf_h_len1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n        f \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. f x = h x; pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n        fst (cf_h f c) = fst (cf_h h c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; f \\<in> pHom R S X, A B Y;\n     \\<forall>x\\<in>carrier S. f x = h x; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> fst (cf_h f c) = fst (cf_h h c)", "by (simp add:cf_h_def)"], ["", "lemma (in PolynRg) cf_h_len2:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n          pol_coeff S c\\<rbrakk> \\<Longrightarrow> fst (cf_h f c) = fst c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> fst (cf_h f c) = fst c", "by (simp add:cf_h_def)"], ["", "lemma (in PolynRg) cmp_pol_coeff:\"\\<lbrakk>f \\<in> rHom S B; \n       pol_coeff S (n, c)\\<rbrakk>  \\<Longrightarrow> pol_coeff B (n,(cmp f c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom S B; pol_coeff S (n, c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (n, cmp f c)", "apply (simp add:pol_coeff_def,\n      rule allI, rule impI, simp add:cmp_def,\n      frule_tac a = j in forall_spec, simp,\n      thin_tac \"\\<forall>j\\<le>n. c j \\<in> carrier S\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>f \\<in> rHom S B; j \\<le> n; c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> f (c j) \\<in> carrier B", "apply (simp add:rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) cmp_pol_coeff_e:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n         pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> pol_coeff B (n, (cmp f c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S (n, c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (n, cmp f c)", "apply (subst pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S (n, c)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (n, cmp f c).\n                         snd (n, cmp f c) j \\<in> carrier B", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n        pol_coeff S (n, c); j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> cmp f c j \\<in> carrier B", "apply (frule_tac j = j in pol_coeff_mem[of \"(n, c)\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n        pol_coeff S (n, c); j \\<le> n; snd (n, c) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> cmp f c j \\<in> carrier B", "apply (simp add:polyn_Hom_def cmp_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S (n, c); j \\<le> n;\n        c j \\<in> carrier S; f \\<in> rHom R A;\n        f ` carrier S \\<subseteq> carrier B; f X = Y\\<rbrakk>\n       \\<Longrightarrow> f (c j) \\<in> carrier B", "apply (simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S (n, c); j \\<le> n;\n        c j \\<in> carrier S; f \\<in> rHom R A;\n        {y. \\<exists>x\\<in>carrier S. y = f x} \\<subseteq> carrier B;\n        f X = Y\\<rbrakk>\n       \\<Longrightarrow> f (c j) \\<in> carrier B", "apply (rule_tac c = \"f (c j)\" in subsetD[of \"{y. \\<exists>x\\<in>carrier S. y = f x}\"\n                                  \"carrier B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; pol_coeff S (n, c); j \\<le> n;\n        c j \\<in> carrier S; f \\<in> rHom R A;\n        {y. \\<exists>x\\<in>carrier S. y = f x} \\<subseteq> carrier B;\n        f X = Y\\<rbrakk>\n       \\<Longrightarrow> f (c j)\n                         \\<in> {y. \\<exists>x\\<in>carrier S. y = f x}", "apply (simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) cf_h_pol_coeff:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n      pol_coeff S (n, f)\\<rbrakk> \\<Longrightarrow> cf_h h (n, f) = (n, cmp h f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, f)\\<rbrakk>\n    \\<Longrightarrow> cf_h h (n, f) = (n, cmp h f)", "by (simp add:cf_h_def)"], ["", "lemma (in PolynRg) cf_h_polyn:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S (n, f)\\<rbrakk> \\<Longrightarrow>\n      polyn_expr A Y n (cf_h h (n, f)) = polyn_expr A Y n (n, (cmp h f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, f)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y n (cf_h h (n, f)) =\n                      polyn_expr A Y n (n, cmp h f)", "apply (frule cf_h_coeff[of A B Y h \"(n, f)\"], assumption+,\n       frule cmp_pol_coeff[of h B n f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, f);\n     pol_coeff B (cf_h h (n, f)); pol_coeff B (n, cmp h f)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y n (cf_h h (n, f)) =\n                      polyn_expr A Y n (n, cmp h f)", "apply (rule PolynRg.polyn_exprs_eq[of A B Y  \"cf_h h (n, f)\" \"(n, cmp h f)\" n],\n       assumption+,\n       simp add:cf_h_len,\n       rule allI, rule impI,\n       simp add:cf_h_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_rHom:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow>\n                                 f \\<in> rHom R A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> f \\<in> rHom R A", "by (simp add:polyn_Hom_def)"], ["", "lemma (in PolynRg) pHom_X_Y:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow>\n                                 f X = Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> f X = Y", "by (simp add:polyn_Hom_def)"], ["", "lemma (in PolynRg) pHom_memTr:\"\\<lbrakk>PolynRg A B Y; \n      f \\<in> pHom R S X, A B Y\\<rbrakk> \\<Longrightarrow> \n      \\<forall>c. pol_coeff S (n, c) \\<longrightarrow> \n          f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> \\<forall>c.\n                         pol_coeff S (n, c) \\<longrightarrow>\n                         f (polyn_expr R X n (n, c)) =\n                         polyn_expr A Y n (n, cmp f c)", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S; Ring S;\n     Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>c.\n                         pol_coeff S (n, c) \\<longrightarrow>\n                         f (polyn_expr R X n (n, c)) =\n                         polyn_expr A Y n (n, cmp f c)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S; Ring S;\n     Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>c.\n                         pol_coeff S (0, c) \\<longrightarrow>\n                         f (polyn_expr R X 0 (0, c)) =\n                         polyn_expr A Y 0 (0, cmp f c)\n 2. \\<And>n.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) =\n           polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>c.\n                            pol_coeff S (Suc n, c) \\<longrightarrow>\n                            f (polyn_expr R X (Suc n) (Suc n, c)) =\n                            polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (0, c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X 0 (0, c)) =\n                         polyn_expr A Y 0 (0, cmp f c)\n 2. \\<And>n.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) =\n           polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>c.\n                            pol_coeff S (Suc n, c) \\<longrightarrow>\n                            f (polyn_expr R X (Suc n) (Suc n, c)) =\n                            polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (simp add:polyn_expr_def cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (0, c)\\<rbrakk>\n       \\<Longrightarrow> f (c 0 \\<cdot>\\<^sub>r 1\\<^sub>r) =\n                         f (c 0) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<And>n.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) =\n           polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>c.\n                            pol_coeff S (Suc n, c) \\<longrightarrow>\n                            f (polyn_expr R X (Suc n) (Suc n, c)) =\n                            polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (frule_tac c = \"(0, c)\" and j = 0 in pol_coeff_mem,\n           simp, simp,\n       frule_tac x = \"c 0\" in mem_subring_mem_ring, assumption+,\n       simp add:polyn_Hom_def, (erule conjE)+,\n       frule rHom_func[of f R A],\n       frule_tac x = \"c 0\" in funcset_mem[of f \"carrier R\" \"carrier A\"],\n              assumption+,\n       simp add:ring_r_one, simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) =\n           polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>c.\n                            pol_coeff S (Suc n, c) \\<longrightarrow>\n                            f (polyn_expr R X (Suc n) (Suc n, c)) =\n                            polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff S (Suc n, c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X (Suc n) (Suc n, c)) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (cut_tac n = n and f = c in pol_coeff_pre, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>c.\n           pol_coeff S (n, c) \\<longrightarrow>\n           f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff S (Suc n, c); pol_coeff S (n, c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X (Suc n) (Suc n, c)) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (\n       drule_tac a = c in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X (Suc n) (Suc n, c)) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (cut_tac n = n and c = \"(Suc n, c)\" in polyn_Suc, simp,\n        simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, c) =\n           polyn_expr R X n (Suc n, c) \\<plusminus> c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (Suc n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (frule_tac c = \"(Suc n, c)\" and k = n in polyn_expr_short, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        polyn_expr R X n (Suc n, c) =\n        polyn_expr R X n (n, snd (Suc n, c))\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (Suc n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (simp del:npow_suc,\n       thin_tac \"polyn_expr R X n (Suc n, c) = polyn_expr R X n (n, c)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (frule_tac c = \"(Suc n, c)\" in polyn_Hom_coeff_to_coeff[of A B Y f],\n       assumption+, simp del:npow_suc add:cf_h_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc n) (Suc n, cmp f c)", "apply (frule_tac c = \"(Suc n, cmp f c)\" and n = n in \n                  PolynRg.polyn_Suc[of A B Y], simp, simp del:npow_suc,\n       thin_tac \"polyn_expr A Y (Suc n) (Suc n, cmp f c) =\n        polyn_expr A Y n (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>  cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y^\\<^bsup>A (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (frule_tac k = n and c = \"(n, c)\" in polyn_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, c)\" in monomial_mem,\n       drule_tac a = \"Suc n\" in forall_spec, simp, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (polyn_expr R X n (n, c) \\<plusminus>\n                            c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (frule pHom_rHom[of A B Y f], assumption+,\n                                       simp del:npow_suc add:rHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f \\<in> rHom R A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         f (c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, c)\" and j = \"Suc n\" in pol_coeff_mem_R, simp,\n         simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f \\<in> rHom R A; c (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         f (c (Suc n) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (cut_tac X_mem_R,\n       frule_tac n = \"Suc n\" in npClose[of X],\n       cut_tac Ring,\n       subst rHom_tOp[of R A _ _ f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f \\<in> rHom R A; c (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R; Ring R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         f (c (Suc n)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         f (X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (Suc n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, cmp f c)\" and k = n in \n        PolynRg.polyn_expr_short[of A B Y], assumption+, simp,\n        simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f \\<in> rHom R A; c (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R; Ring R;\n        polyn_expr A Y n (Suc n, cmp f c) =\n        polyn_expr A Y n (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         f (c (Suc n)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         f (X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (cut_tac c = \"(Suc n, cmp f c)\" and n = n in \n        PolynRg.pol_coeff_le[of A B Y], assumption+, simp,\n        simp del:npow_suc add:PolynRg.pol_coeff_le[of A B Y])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n c.\n       \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; pol_coeff S (Suc n, c);\n        pol_coeff S (n, c);\n        f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (Suc n, cmp f c);\n        polyn_expr R X n (n, c) \\<in> carrier R;\n        c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f \\<in> rHom R A; c (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R; Ring R;\n        polyn_expr A Y n (Suc n, cmp f c) = polyn_expr A Y n (n, cmp f c);\n        pol_coeff B (n, cmp f c)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         f (c (Suc n)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         f (X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr A Y n\n                          (n, cmp f c) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp f c (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup>", "apply (subst rHom_npow[of R A X f], assumption+,\n       simp del:npow_suc add:pHom_X_Y cmp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_mem:\"\\<lbrakk>PolynRg A B Y; \n      f \\<in> pHom R S X, A B Y; pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> \n      f (polyn_expr R X n (n, c)) = polyn_expr A Y n (n, cmp f c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S (n, c)\\<rbrakk>\n    \\<Longrightarrow> f (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp f c)", "apply (simp add:pHom_memTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_memc:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n      pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n      f (polyn_expr R X (fst c) c) = polyn_expr A Y (fst c) (cf_h f c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> f (polyn_expr R X (fst c) c) =\n                      polyn_expr A Y (fst c) (cf_h f c)", "by (cases c) (simp add: cf_h_def pHom_mem)"], ["", "lemma (in PolynRg) pHom_mem1:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n       p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  f p \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f p \\<in> carrier A", "apply (simp add:polyn_Hom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; p \\<in> carrier R; f \\<in> rHom R A;\n     f ` carrier S \\<subseteq> carrier B; f X = Y\\<rbrakk>\n    \\<Longrightarrow> f p \\<in> carrier A", "apply (simp add:rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_pol_mem:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n      p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> \n      f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> f p =\n                      polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f p =\n                      polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))", "apply (subst s_cf_deg[of p], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f p =\n                      polyn_expr A Y (fst (s_cf R S X p))\n                       (cf_h f (s_cf R S X p))", "apply (subst pHom_memc[THEN sym, of A B Y f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f p =\n                      f (polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p))", "apply (drule sym, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erh_rHom_coeff:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n       pol_coeff S c\\<rbrakk>  \\<Longrightarrow>  erh R S X A B Y h 0 c = (cmp h (snd c)) 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> erh R S X A B Y h 0 c = cmp h (snd c) 0", "apply (cut_tac subring,\n       frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> erh R S X A B Y h 0 c = cmp h (snd c) 0", "apply (simp add:erh_def polyn_expr_def cf_h_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> cmp h (snd c) 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      cmp h (snd c) 0", "apply (frule pol_coeff_mem [of c 0], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B; snd c 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> cmp h (snd c) 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      cmp h (snd c) 0", "apply (simp add:cmp_def, frule rHom_mem[of h S B \"snd c 0\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B; snd c 0 \\<in> carrier S;\n     h (snd c 0) \\<in> carrier B\\<rbrakk>\n    \\<Longrightarrow> h (snd c 0) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      h (snd c 0)", "apply (frule Ring.mem_subring_mem_ring[of A B \"h (snd c 0)\"], assumption+,\n        simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erh_polyn_exprs:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B;\n       pol_coeff S c; pol_coeff S d; \n       polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>  \\<Longrightarrow>  \n       erh R S X A B Y h (fst c) c  = erh R S X A B Y h (fst d) d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>\n    \\<Longrightarrow> erh R S X A B Y h (fst c) c =\n                      erh R S X A B Y h (fst d) d", "apply (cut_tac subring,\n       frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> erh R S X A B Y h (fst c) c =\n                      erh R S X A B Y h (fst d) d", "apply (simp add:erh_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (cut_tac less_linear[of \"fst c\" \"fst d\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B;\n     fst c < fst d \\<or> fst c = fst d \\<or> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (erule disjE,\n       frule pol_expr_unique3[of c d], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\",\n       frule cf_h_coeff[of A B Y h c], assumption+,\n       frule cf_h_coeff[of A B Y h d], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>);\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; fst c < fst d;\n     pol_coeff B (cf_h h c); pol_coeff B (cf_h h d)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B;\n     fst c = fst d \\<or> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (frule PolynRg.pol_expr_unique3[of A B Y \"cf_h h c\" \"cf_h h d\"],\n        assumption+, simp add:cf_h_len, simp add:cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst c) (cf_h h c) =\n       polyn_expr A Y (fst d) (cf_h h d)) =\n       ((\\<forall>j\\<le>fst c. snd (cf_h h c) j = snd (cf_h h d) j) \\<and>\n       (\\<forall>j\\<in>nset (Suc (fst c)) (fst d). snd (cf_h h d) j = \\<zero>\\<^bsub>B\\<^esub>))\",\n       simp add:cf_h_def cmp_def, simp add:rHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B;\n     fst c = fst d \\<or> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (erule disjE,\n       frule pol_expr_unique2[of c d], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst d) c = polyn_expr R X (fst d) d\",\n       frule cf_h_coeff[of A B Y h c], assumption+,\n       frule cf_h_coeff[of A B Y h d], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; fst c = fst d;\n     \\<forall>j\\<le>fst d. snd c j = snd d j; pol_coeff B (cf_h h c);\n     pol_coeff B (cf_h h d)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst d) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B; fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (frule PolynRg.pol_expr_unique2[of A B Y \"cf_h h c\" \"cf_h h d\"],\n        assumption+, simp add:cf_h_len, simp add:cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst d) (cf_h h c) =\n        polyn_expr A Y (fst d) (cf_h h d)) =\n       (\\<forall>j\\<le>fst d. snd (cf_h h c) j = snd (cf_h h d) j)\",\n        simp add:cf_h_def cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B; fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c) (cf_h h c) =\n                      polyn_expr A Y (fst d) (cf_h h d)", "apply (drule sym, rule sym,\n       frule pol_expr_unique3[of d c], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\",\n       frule cf_h_coeff[of A B Y h c], assumption+,\n       frule cf_h_coeff[of A B Y h d], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; fst d < fst c;\n     (\\<forall>j\\<le>fst d. snd d j = snd c j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst d)) (fst c).\n         snd c j = \\<zero>\\<^bsub>S\\<^esub>);\n     pol_coeff B (cf_h h c); pol_coeff B (cf_h h d)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst d) (cf_h h d) =\n                      polyn_expr A Y (fst c) (cf_h h c)", "apply (frule PolynRg.pol_expr_unique3[of A B Y \"cf_h h d\" \"cf_h h c\"],\n        assumption+, simp add:cf_h_len, simp add:cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst d) (cf_h h d) =\n       polyn_expr A Y (fst c) (cf_h h c)) =\n       ((\\<forall>j\\<le>fst d. snd (cf_h h d) j = snd (cf_h h c) j) \\<and>\n       (\\<forall>j\\<in>nset (Suc (fst d)) (fst c). snd (cf_h h c) j = \\<zero>\\<^bsub>B\\<^esub>))\",\n       simp add:cf_h_def cmp_def, simp add:rHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  erH :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a,\n         ('b, 'n) Ring_scheme, ('b, 'n1) Ring_scheme, 'b, 'a \\<Rightarrow> 'b] \\<Rightarrow> \n                  'a \\<Rightarrow> 'b\" where\n  \"erH R S X A B Y h = (\\<lambda>x\\<in>carrier R. erh R S X A B Y h \n                              (fst (s_cf R S X x)) (s_cf R S X x))\""], ["", "(*\nlemma (in PolynRg) erH_phom:\"\\<lbrakk>PolynRg A B y; h \\<in> rHom S B\\<rbrakk> \\<Longrightarrow>\n              erH R S X A B Y h \\<in> pHom R S X, A B Y\" *)"], ["", "lemma (in PolynRg) erH_rHom_0:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>  \\<Longrightarrow> \n                   (erH R S X A B Y h) \\<zero> = \\<zero>\\<^bsub>A\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<zero> = \\<zero>\\<^bsub>A\\<^esub>", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac PolynRg.is_Ring[of A B Y],\n       cut_tac PolynRg.subring[of A B Y],\n       cut_tac Ring.subring_Ring[of A B])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<zero> = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n     Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (simp add:erH_def erh_def s_cf_def polyn_expr_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> (\\<zero> \\<in> carrier R \\<longrightarrow>\n                       snd (cf_h h\n                             (0, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>))\n                        0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                       1\\<^sub>r\\<^bsub>A\\<^esub> =\n                       \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                      (\\<zero> \\<notin> carrier R \\<longrightarrow>\n                       undefined = \\<zero>\\<^bsub>A\\<^esub>)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S;\n     Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (cut_tac ring_zero,\n        simp add:cf_h_def cmp_def rHom_0_0,\n        simp add:Ring.Subring_zero_ring_zero, \n        frule Ring.ring_zero[of A], simp add:Ring.ring_r_one, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_mem:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n               erH R S X A B Y h p \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h p \\<in> carrier A", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac PolynRg.is_Ring[of A B Y],\n       cut_tac PolynRg.subring[of A B Y],\n       cut_tac Ring.subring_Ring[of A B])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h p \\<in> carrier A\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h p \\<in> carrier A\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h p \\<in> carrier A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 6. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (simp add:erH_rHom_0, simp add:Ring.ring_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h p \\<in> carrier A\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (simp add:erH_def erh_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X p))\n                       (cf_h h (s_cf R S X p))\n                      \\<in> carrier A\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X p))\n                       (cf_h h (s_cf R S X p))\n                      \\<in> carrier A\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (rule PolynRg.polyn_mem[of A B Y \"cf_h h (s_cf R S X p)\"], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (cf_h h (s_cf R S X p))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) \\<le> fst (cf_h h (s_cf R S X p))\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 6. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (simp add:cf_h_coeff)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B; Ring B; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X p) \\<le> fst (cf_h h (s_cf R S X p))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A; Subring A B\\<rbrakk>\n    \\<Longrightarrow> Subring A B\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S; Ring A\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 5. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y", "apply (simp add:cf_h_len, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom_nonzero:\"\\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \n      p \\<in> carrier R; (erH R S X A B Y f) p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> p \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> rHom S B; \\<zero> \\<in> carrier R;\n     erH R S X A B Y f \\<zero> \\<noteq> \\<zero>\\<^bsub>A\\<^esub>;\n     p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:erH_rHom_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHomTr2:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>  \\<Longrightarrow> \n        (erH R S X A B Y h) (1\\<^sub>r) = (1\\<^sub>r\\<^bsub>A\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption,\n       cut_tac polyn_ring_nonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (cut_tac Subring_one_ring_one[THEN sym, of S],\n       frule Ring.ring_one[of S],\n       cut_tac ring_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (frule s_cf_expr[of \"1\\<^sub>r\"], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S; 1\\<^sub>r \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r);\n     1\\<^sub>r =\n     polyn_expr R X (fst (s_cf R S X 1\\<^sub>r)) (s_cf R S X 1\\<^sub>r);\n     snd (s_cf R S X 1\\<^sub>r) (fst (s_cf R S X 1\\<^sub>r)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (frule s_cf_deg[THEN sym, of \"1\\<^sub>r\"], assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h 1\\<^sub>r\\<^bsub>S\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (cut_tac pol_of_deg0[THEN sym, of \"1\\<^sub>r\"], simp,\n        simp add:erH_def erh_def cf_h_def polyn_expr_def,\n        frule pol_coeff_mem[of \"s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\" 0], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) 0 \\<cdot>\\<^sub>r\n     1\\<^sub>r\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) 0 \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) = 0;\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub> = 0;\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> cmp h (snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>))\n                       0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (simp add:Subring_tOp_ring_tOp[THEN sym],\n        simp add:Ring.ring_r_one cmp_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) 0;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) = 0;\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub> = 0\\<rbrakk>\n    \\<Longrightarrow> h 1\\<^sub>r\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (simp add:rHom_one,\n        simp add:Ring.Subring_one_ring_one[of A B],\n               frule Ring.ring_one[of A], simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (simp add:ring_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>;\n     1\\<^sub>r = 1\\<^sub>r\\<^bsub>S\\<^esub>;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S;\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier R;\n     pol_coeff S (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     1\\<^sub>r\\<^bsub>S\\<^esub> =\n     polyn_expr R X (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     snd (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>)\n      (deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n     deg_n R S X 1\\<^sub>r\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; Subring R S; Ring S; Ring A;\n     Subring A B; Ring B; 1\\<^sub>r \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "declare max.absorb1 [simp] max.absorb2 [simp]"], ["", "lemma (in PolynRg) erH_multTr:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S c\\<rbrakk> \\<Longrightarrow> \n \\<forall>f g. pol_coeff S (m, f) \\<and> pol_coeff S (((fst c) + m), g) \\<and> \n       (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X m (m, f)) = \n             (polyn_expr R X ((fst c) + m) ((fst c) + m, g))  \\<longrightarrow> \n (polyn_expr A Y (fst c) (cf_h h c)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (polyn_expr A Y m (cf_h h (m, f))) = \n                 (polyn_expr A Y ((fst c) + m) (cf_h h ((fst c)+m, g)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f g.\n                         pol_coeff S (m, f) \\<and>\n                         pol_coeff S (fst c + m, g) \\<and>\n                         polyn_expr R X (fst c) c \\<cdot>\\<^sub>r\n                         polyn_expr R X m (m, f) =\n                         polyn_expr R X (fst c + m)\n                          (fst c + m, g) \\<longrightarrow>\n                         polyn_expr A Y (fst c)\n                          (cf_h h c) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y m (cf_h h (m, f)) =\n                         polyn_expr A Y (fst c + m) (cf_h h (fst c + m, g))", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n     Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f g.\n                         pol_coeff S (m, f) \\<and>\n                         pol_coeff S (fst c + m, g) \\<and>\n                         polyn_expr R X (fst c) c \\<cdot>\\<^sub>r\n                         polyn_expr R X m (m, f) =\n                         polyn_expr R X (fst c + m)\n                          (fst c + m, g) \\<longrightarrow>\n                         polyn_expr A Y (fst c)\n                          (cf_h h c) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y m (cf_h h (m, f)) =\n                         polyn_expr A Y (fst c + m) (cf_h h (fst c + m, g))", "apply (cases c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; Subring R S;\n        Ring S; Ring A; Subring A B; Ring B; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (m, f) \\<and>\n                            pol_coeff S (fst c + m, g) \\<and>\n                            polyn_expr R X (fst c) c \\<cdot>\\<^sub>r\n                            polyn_expr R X m (m, f) =\n                            polyn_expr R X (fst c + m)\n                             (fst c + m, g) \\<longrightarrow>\n                            polyn_expr A Y (fst c)\n                             (cf_h h c) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y m (cf_h h (m, f)) =\n                            polyn_expr A Y (fst c + m)\n                             (cf_h h (fst c + m, g))", "apply (simp only:)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (a, b);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (m, f) \\<and>\n                            pol_coeff S (fst (a, b) + m, g) \\<and>\n                            polyn_expr R X (fst (a, b))\n                             (a, b) \\<cdot>\\<^sub>r\n                            polyn_expr R X m (m, f) =\n                            polyn_expr R X (fst (a, b) + m)\n                             (fst (a, b) + m, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (a, b))\n                             (cf_h h\n                               (a, b)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y m (cf_h h (m, f)) =\n                            polyn_expr A Y (fst (a, b) + m)\n                             (cf_h h (fst (a, b) + m, g))", "apply (rename_tac l u)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        c = (l, u)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (m, f) \\<and>\n                            pol_coeff S (fst (l, u) + m, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X m (m, f) =\n                            polyn_expr R X (fst (l, u) + m)\n                             (fst (l, u) + m, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y m (cf_h h (m, f)) =\n                            polyn_expr A Y (fst (l, u) + m)\n                             (cf_h h (fst (l, u) + m, g))", "apply (thin_tac \"c = (l, u)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (m, f) \\<and>\n                            pol_coeff S (fst (l, u) + m, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X m (m, f) =\n                            polyn_expr R X (fst (l, u) + m)\n                             (fst (l, u) + m, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y m (cf_h h (m, f)) =\n                            polyn_expr A Y (fst (l, u) + m)\n                             (cf_h h (fst (l, u) + m, g))", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (0, f) \\<and>\n                            pol_coeff S (fst (l, u) + 0, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X 0 (0, f) =\n                            polyn_expr R X (fst (l, u) + 0)\n                             (fst (l, u) + 0, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y 0 (cf_h h (0, f)) =\n                            polyn_expr A Y (fst (l, u) + 0)\n                             (cf_h h (fst (l, u) + 0, g))\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply ((rule allI)+, rule impI, (erule conjE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X 0 (0, f) =\n        polyn_expr R X l (l, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y 0 (cf_h h (0, f)) =\n                         polyn_expr A Y l (cf_h h (l, g))\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:cf_h_polyn[of A B Y h])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X 0 (0, f) =\n        polyn_expr R X l (l, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y 0 (0, cmp h f) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:polyn_expr_def[of _ _ 0])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r) =\n        polyn_expr R X l (l, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          1\\<^sub>r\\<^bsub>A\\<^esub>) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (frule_tac c = \"(0, f)\" and j = 0 in pol_coeff_mem, simp, simp,\n        frule_tac c = \"(0, f)\" and j = 0 in pol_coeff_mem_R, simp, simp,\n        frule_tac c = \"(l, u)\" and k = l in polyn_mem, simp,\n        simp add:ring_r_one,\n        simp add:ring_tOp_commute,\n        simp add:scalar_times_pol_expr)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          1\\<^sub>r\\<^bsub>A\\<^esub>) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (frule_tac c = \"(0, f)\" in cf_h_coeff[of A B Y h], assumption+,\n        frule_tac c = \"(l, u)\" in cf_h_coeff[of A B Y h], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        pol_coeff B (cf_h h (0, f)); pol_coeff B (cf_h h (l, u))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          1\\<^sub>r\\<^bsub>A\\<^esub>) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (frule_tac c = \"cf_h h (0, f)\" in PolynRg.pol_coeff_mem[of A B Y _ 0],\n        assumption+, simp, simp add:cf_h_cmp,\n        frule_tac c = \"cf_h h (0, f)\" in PolynRg.pol_coeff_mem_R[of A B Y _ 0],\n        assumption+, simp, simp add:cf_h_cmp,\n        frule_tac c = \"cf_h h (l, u)\" and k = l in PolynRg.polyn_mem, simp,\n        simp add:cf_h_len, simp add:cf_h_polyn,\n        simp add:Ring.ring_r_one, simp add:Ring.ring_tOp_commute[of A],\n        frule_tac n = l and f = u in cf_h_pol_coeff[of A B Y h],\n              assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        pol_coeff B (cf_h h (0, f)); pol_coeff B (l, cmp h u);\n        cmp h f 0 \\<in> carrier B; cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        cf_h h (l, u) = (l, cmp h u)\\<rbrakk>\n       \\<Longrightarrow> cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l (l, cmp h u) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:PolynRg.scalar_times_pol_expr,\n         frule_tac c = \"(l, u)\" and a = \"f 0\" in sp_cf_pol_coeff, assumption+,\n         frule_tac c = \"(l, cmp h u)\" and a = \"(cmp h f) 0\" in \n           PolynRg.sp_cf_pol_coeff, assumption+,\n         frule_tac c = \"(l, g)\" in cf_h_coeff[of A B Y h], assumption+,\n         simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S (sp_cf S (f 0) (l, u));\n        pol_coeff B (sp_cf B (cmp h f 0) (l, cmp h u));\n        pol_coeff B (l, cmp h g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (sp_cf B (cmp h f 0) (l, cmp h u)) =\n                         polyn_expr A Y l (l, cmp h g)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (rule_tac c = \"sp_cf B (cmp h f 0) (l, cmp h u)\" and \n         d = \"(l, cmp h g)\" and k = l in PolynRg.polyn_exprs_eq[of A B Y],\n         assumption+, simp add:sp_cf_len, \n         simp add:PolynRg.sp_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S (sp_cf S (f 0) (l, u));\n        pol_coeff B (sp_cf B (cmp h f 0) (l, cmp h u));\n        pol_coeff B (l, cmp h g)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>l.\n                            snd (sp_cf B (cmp h f 0) (l, cmp h u)) j =\n                            snd (l, cmp h g) j\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S (sp_cf S (f 0) (l, u));\n        pol_coeff B (sp_cf B (cmp h f 0) (l, cmp h u));\n        pol_coeff B (l, cmp h g); j \\<le> l\\<rbrakk>\n       \\<Longrightarrow> snd (sp_cf B (cmp h f 0) (l, cmp h u)) j =\n                         snd (l, cmp h g) j\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (frule_tac c = \"sp_cf S (f 0) (l, u)\" and d = \"(l, g)\" in \n         pol_expr_unique2, assumption+,\n         simp add:sp_cf_len, simp add:sp_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S (sp_cf S (f 0) (l, u));\n        pol_coeff B (sp_cf B (cmp h f 0) (l, cmp h u));\n        pol_coeff B (l, cmp h g); j \\<le> l;\n        \\<forall>j\\<le>l. snd (sp_cf S (f 0) (l, u)) j = g j\\<rbrakk>\n       \\<Longrightarrow> snd (sp_cf B (cmp h f 0) (l, cmp h u)) j =\n                         cmp h g j\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (drule_tac a = j in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l (sp_cf S (f 0) (l, u)) = polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S (sp_cf S (f 0) (l, u));\n        pol_coeff B (sp_cf B (cmp h f 0) (l, cmp h u));\n        pol_coeff B (l, cmp h g); j \\<le> l;\n        snd (sp_cf S (f 0) (l, u)) j = g j\\<rbrakk>\n       \\<Longrightarrow> snd (sp_cf B (cmp h f 0) (l, cmp h u)) j =\n                         cmp h g j\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:sp_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g);\n        polyn_expr R X l\n         (l, \\<lambda>j. f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j) =\n        polyn_expr R X l (l, g);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R;\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff B (0, cmp h f);\n        pol_coeff B (l, cmp h u); cmp h f 0 \\<in> carrier B;\n        cmp h f 0 \\<in> carrier A;\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        pol_coeff S\n         (l, \\<lambda>j. f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j);\n        pol_coeff B\n         (l, \\<lambda>j.\n                cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub> cmp h u j);\n        pol_coeff B (l, cmp h g); j \\<le> l;\n        f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j = g j\\<rbrakk>\n       \\<Longrightarrow> cmp h f 0 \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub>\n                         cmp h u j =\n                         cmp h g j\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (rotate_tac -1, drule sym, simp add:cmp_def,\n        thin_tac \"pol_coeff B (l, \\<lambda>x. h (g x))\",\n        thin_tac \"pol_coeff B (l, \\<lambda>j. h (f 0) \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub> h (u j))\",\n        thin_tac \"pol_coeff S (l, \\<lambda>j. f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j)\",\n        thin_tac \"polyn_expr A Y l (l, \\<lambda>x. h (u x)) \\<in> carrier A\",\n        thin_tac \"pol_coeff B (l, \\<lambda>x. h (u x))\",\n        thin_tac \"polyn_expr R X l (l, \\<lambda>j. f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j) =\n                                          polyn_expr R X l (l, g)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g); f 0 \\<in> carrier S;\n        f 0 \\<in> carrier R; polyn_expr R X l (l, u) \\<in> carrier R;\n        pol_coeff B (0, \\<lambda>x. h (f x)); h (f 0) \\<in> carrier B;\n        h (f 0) \\<in> carrier A; j \\<le> l;\n        g j = f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j\\<rbrakk>\n       \\<Longrightarrow> h (f 0) \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub> h (u j) =\n                         h (f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (frule_tac c = \"(l, u)\" and j = j in pol_coeff_mem, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u f g j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (0, f); pol_coeff S (l, g); f 0 \\<in> carrier S;\n        f 0 \\<in> carrier R; polyn_expr R X l (l, u) \\<in> carrier R;\n        pol_coeff B (0, \\<lambda>x. h (f x)); h (f 0) \\<in> carrier B;\n        h (f 0) \\<in> carrier A; j \\<le> l;\n        g j = f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j;\n        u j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h (f 0) \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub> h (u j) =\n                         h (f 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> u j)\n 2. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n)\n            (cf_h h (fst (l, u) + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f g.\n                            pol_coeff S (Suc n, f) \\<and>\n                            pol_coeff S (fst (l, u) + Suc n, g) \\<and>\n                            polyn_expr R X (fst (l, u))\n                             (l, u) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (fst (l, u) + Suc n)\n                             (fst (l, u) + Suc n, g) \\<longrightarrow>\n                            polyn_expr A Y (fst (l, u))\n                             (cf_h h\n                               (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                            polyn_expr A Y (fst (l, u) + Suc n)\n                             (cf_h h (fst (l, u) + Suc n, g))", "apply ((rule allI)+, (rule impI), (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (fst (l, u) + n, g) \\<and>\n           polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n           polyn_expr R X n (n, f) =\n           polyn_expr R X (fst (l, u) + n)\n            (fst (l, u) + n, g) \\<longrightarrow>\n           polyn_expr A Y (fst (l, u))\n            (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (cf_h h (n, f)) =\n           polyn_expr A Y (fst (l, u) + n) (cf_h h (fst (l, u) + n, g));\n        pol_coeff S (Suc n, f); pol_coeff S (fst (l, u) + Suc n, g);\n        polyn_expr R X (fst (l, u)) (l, u) \\<cdot>\\<^sub>r\n        polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X (fst (l, u) + Suc n) (fst (l, u) + Suc n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (fst (l, u))\n                          (cf_h h (l, u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc n) (cf_h h (Suc n, f)) =\n                         polyn_expr A Y (fst (l, u) + Suc n)\n                          (cf_h h (fst (l, u) + Suc n, g))", "apply (simp add:cf_h_polyn,\n        frule_tac n = n and f = f in pol_coeff_pre, \n        frule_tac n = \"l + n\" and f = g in pol_coeff_pre,\n        frule_tac n = l and f = u and m = n and g = f in polyn_expr_tOp, \n        assumption+, erule exE, (erule conjE)+,\n        rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        \\<forall>f g.\n           pol_coeff S (n, f) \\<and>\n           pol_coeff S (l + n, g) \\<and>\n           polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n           polyn_expr R X (l + n) (l + n, g) \\<longrightarrow>\n           polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n           polyn_expr A Y n (n, cmp h f) =\n           polyn_expr A Y (l + n) (l + n, cmp h g);\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (n, f); pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc n) (Suc n, cmp h f) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (drule_tac x = f in spec,\n        drule_tac x = e in spec, simp,\n        frule_tac n = n and f = f in polyn_Suc_split,\n        simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X n (n, f) \\<plusminus> f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (polyn_expr R X n (n, f) \\<plusminus>\n         f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (n, f); pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc n) (Suc n, cmp h f) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "(* got polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e) *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (polyn_expr R X n (n, f) \\<plusminus>\n         f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (n, f); pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc n) (Suc n, cmp h f) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc n, f)\" in cf_h_coeff[of A B Y h], assumption+,\n        simp del:npow_suc add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (polyn_expr R X n (n, f) \\<plusminus>\n         f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (n, f); pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc n) (Suc n, cmp h f) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac n = n and f = \"cmp h f\" in PolynRg.polyn_Suc_split[of A B Y],\n        simp add:cf_h_pol_coeff, simp del:npow_suc,\n        thin_tac \"polyn_expr A Y (Suc n) (Suc n, cmp h f) =\n        polyn_expr A Y n (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub> cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y^\\<^bsup>A (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (polyn_expr R X n (n, f) \\<plusminus>\n         f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (n, f); pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (polyn_expr A Y n\n                           (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub>\n                          cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l, u)\" and k = l in polyn_mem, simp,\n       frule_tac n = n and f = f in pol_coeff_pre,\n       frule_tac c = \"(n, f)\" and k = n in polyn_mem, simp,\n       frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem_R, simp,\n       cut_tac X_mem_R, simp del:npow_suc,\n       cut_tac n = \"Suc n\" in npClose[of X], assumption,\n       frule_tac x = \"f (Suc n)\" and y = \" X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_closed,\n         assumption+,\n       simp del:npow_suc add:ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R; pol_coeff S (n, f);\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (polyn_expr A Y n\n                           (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub>\n                          cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l, u)\" in cf_h_coeff[of A B Y h], assumption+,\n       frule_tac c = \"(Suc n, f)\" in cf_h_coeff[of A B Y h], assumption+,\n       frule_tac n = n and f = f in pol_coeff_pre,\n       frule_tac c = \"(n, f)\" in cf_h_coeff[of A B Y h], assumption+,\n       simp del:npow_suc add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (polyn_expr A Y n\n                           (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub>\n                          cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l, cmp h u)\" and k = l in PolynRg.polyn_mem, simp, simp,      frule_tac c = \"(n, cmp h f)\" and k = n in PolynRg.polyn_mem, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (polyn_expr A Y n\n                           (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub>\n                          cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem_R, simp,\n       cut_tac X_mem_R, simp del:npow_suc,\n       cut_tac n = \"Suc n\" in npClose[of X], assumption,\n       frule_tac x = \"f (Suc n)\" and y = \" X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_closed,\n         assumption+,\n       simp del:npow_suc add:ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (polyn_expr A Y n\n                           (n, cmp h f) \\<plusminus>\\<^bsub>A\\<^esub>\n                          cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc n, cmp h f)\" and j = \"Suc n\" in \n       PolynRg.pol_coeff_mem_R[of A B Y], simp del:npow_suc, \n       simp del:npow_suc,\n       frule_tac PolynRg.X_mem_R[of A B Y], simp del:npow_suc,\n       frule_tac n = \"Suc n\" in Ring.npClose[of A Y], assumption,\n       frule_tac x = \"cmp h f (Suc n)\" and y = \" Y^\\<^bsup>A (Suc n)\\<^esup>\" in \n       Ring.ring_tOp_closed[of A], assumption+,\n       simp del:npow_suc add:Ring.ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r\n        (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e);\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac x1 = \"polyn_expr R X l (l, u)\" and y1 = \"f (Suc n)\" and \n       z1 = \" X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_assoc[THEN sym], assumption+, \n       simp del:npow_suc,\n       thin_tac \"polyn_expr R X l (l, u) \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X (l + n) (l + n, e)\",\n       thin_tac \"polyn_expr R X l (l, u) \\<cdot>\\<^sub>r (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>) =\n        polyn_expr R X l (l, u) \\<cdot>\\<^sub>r f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\",\n       simp only:ring_tOp_commute,\n       frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem, simp,\n       simp del:npow_suc,\n       simp del:npow_suc add:scalar_times_pol_expr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X l (sp_cf S (f (Suc n)) (l, u)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc n\\<^esup> =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l, u)\" and a = \"f (Suc n)\" in sp_cf_pol_coeff,\n                assumption+,\n         frule_tac c = \"sp_cf S (f (Suc n)) (l, u)\" and k = l in polyn_mem,\n         simp add:sp_cf_len, simp only:ring_tOp_commute,\n         frule_tac c1 = \"sp_cf S (f (Suc n)) (l, u)\" and j1 = \"Suc n\" in \n         low_deg_terms_zero1[THEN sym],\n         simp only:sp_cf_len, simp del: npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        polyn_expr R X (l + n) (l + n, e) \\<plusminus>\n        polyn_expr R X (Suc (l + n))\n         (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))) =\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f);\n        polyn_expr R X l (l, u) \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        pol_coeff B (l, cmp h u); pol_coeff S (n, f);\n        pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        polyn_expr R X l (sp_cf S (f (Suc n)) (l, u)) \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X l (sp_cf S (f (Suc n)) (l, u)) =\n        polyn_expr R X (Suc (l + n))\n         (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"sp_cf S (f (Suc n)) (l, u)\" and n = \"Suc n\" in \n          ext_cf_pol_coeff,\n          frule_tac c = \"(l + n, e)\" and d = \"ext_cf S (Suc n) (sp_cf S (\n           f (Suc n)) (l, u))\" in polyn_add1, assumption+,\n          simp del:npow_suc add:ext_cf_len sp_cf_len,\n          cut_tac a = l and b = n in add.commute,\n          simp del:npow_suc,\n         thin_tac \"polyn_expr R X (n + l) (n + l, e) \\<plusminus>\n         polyn_expr R X (Suc (n + l))\n         (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))) =\n         polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\",\n         thin_tac \"polyn_expr R X l (l, u) \\<in> carrier R\",\n         thin_tac \"polyn_expr R X n (n, f) \\<in> carrier R\",\n         thin_tac \"f (Suc n) \\<in> carrier R\",\n         thin_tac \"X \\<in> carrier R\",\n         thin_tac \"X^\\<^bsup>R (Suc n)\\<^esup> \\<in> carrier R\",\n         thin_tac \"f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup> \\<in> carrier R\",\n         thin_tac \"polyn_expr R X l (sp_cf S (f (Suc n)) (l, u)) \\<in> carrier R\",\n         thin_tac \"X^\\<^bsup>R (Suc n)\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X l (sp_cf S (f (Suc n)) (l, u)) =\n        polyn_expr R X (Suc (n + l))\n         (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "(* got polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))) *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         (cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                          Y^\\<^bsup>A Suc n\\<^esup>) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (subst Ring.ring_tOp_assoc[THEN sym], assumption+,\n          subst Ring.ring_tOp_commute, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc n, f)\" in cf_h_coeff[of A B Y h],\n          assumption+,\n          simp only:cf_h_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        True\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc n, cmp h f)\" and j = \"Suc n\" in \n         PolynRg.pol_coeff_mem[of A B Y], assumption+, simp, \n         simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (subst PolynRg.scalar_times_pol_expr[of A B Y], assumption+,\n          simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n))\n                            (l, cmp h u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac a = \"cmp h f (Suc n)\" and c = \"(l, cmp h u)\" in \n          PolynRg.sp_cf_pol_coeff[of A B Y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n))\n                            (l, cmp h u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"sp_cf B (cmp h f (Suc n)) (l, cmp h u)\" and k = l \n          in PolynRg.polyn_mem[of A B Y], assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> l \\<le> fst (sp_cf B (cmp h f (Suc n))\n (l, cmp h u))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n))\n                            (l, cmp h u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:PolynRg.sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n))\n                            (l, cmp h u)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc n\\<^esup> =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (subst Ring.ring_tOp_commute[of A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc\nn\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n)) (l, cmp h u)) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c1 = \"sp_cf B (cmp h f (Suc n)) (l, cmp h u)\" and \n         j1 = \"Suc n\" in PolynRg.low_deg_terms_zero1[of A B Y, THEN sym],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\n        \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y (fst (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n         (sp_cf B (cmp h f (Suc n)) (l, cmp h u)) =\n        polyn_expr A Y\n         (fst (sp_cf B (cmp h f (Suc n)) (l, cmp h u)) + Suc n)\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         Y^\\<^bsup>A Suc\nn\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y l\n                          (sp_cf B (cmp h f (Suc n)) (l, cmp h u)) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp del:npow_suc add:sp_cf_len PolynRg.sp_cf_len,\n          thin_tac \"Y^\\<^bsup>A (Suc n)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n          polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u)) =\n          polyn_expr A Y (Suc (l + n))\n          (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\",\n          thin_tac \"polyn_expr A Y l (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\n          \\<in> carrier A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"sp_cf B (cmp h f (Suc n)) (l, cmp h u)\" and \n          n = \"Suc n\" in PolynRg.ext_cf_pol_coeff[of A B Y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l + n, cmp h e)\" and \n          d = \"ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\" in\n          PolynRg.polyn_add1[of A B Y])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (fst (l + n, cmp h e))\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y\n         (fst (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y\n         (max (fst (l + n, cmp h e))\n           (fst (ext_cf B (Suc n)\n                  (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(n + l, e)\" in cf_h_coeff[of A B Y h], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B (cf_h h (n + l, e))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (fst (l + n, cmp h e))\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y\n         (fst (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y\n         (max (fst (l + n, cmp h e))\n           (fst (ext_cf B (Suc n)\n                  (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:cf_h_pol_coeff[of A B Y h] add.commute, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A Suc n\\<^esup> \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        Y^\\<^bsup>A Suc n\\<^esup>\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (fst (l + n, cmp h e))\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y\n         (fst (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y\n         (max (fst (l + n, cmp h e))\n           (fst (ext_cf B (Suc n)\n                  (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:PolynRg.ext_cf_len PolynRg.sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (n + l), g);\n        pol_coeff S (n + l, g); pol_coeff S (n + l, e);\n        e (n + l) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (n + l) (n + l, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (n + l)) (Suc (n + l), g) =\n        polyn_expr R X (Suc (n + l))\n         (add_cf S (n + l, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (n + l))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (n + l))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (l + n)\n                          (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (Suc (l + n))\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (cut_tac a = n and b = l in add.commute, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "(** Now we got \n      polyn_expr A Y (max (l + n) (Suc (l + n)))\n           (add_cf B (l + n, cmp h e)\n             (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n          polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l + n, e)\" and \n         d = \"ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))\" in \n         add_cf_pol_coeff, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l + n, cmp h e)\" and\n         d = \"ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\" in\n         PolynRg.add_cf_pol_coeff[of A B Y])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(l + n, e)\" in cf_h_coeff[of A B Y h], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B (cf_h h (l + n, e))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        polyn_expr A Y n (n, cmp h f) =\n        polyn_expr A Y (l + n) (l + n, cmp h e);\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        polyn_expr A Y l (l, cmp h u) \\<in> carrier A;\n        polyn_expr A Y n (n, cmp h f) \\<in> carrier A;\n        cmp h f (Suc n) \\<in> carrier A; Y \\<in> carrier A;\n        Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y\n        \\<in> carrier A;\n        cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n        (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y)\n        \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        polyn_expr A Y (l + n)\n         (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (thin_tac \"polyn_expr A Y l (l, cmp h u) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> polyn_expr A Y n \n         (n, cmp h f) = polyn_expr A Y (l + n) (l + n, cmp h e)\",\n        thin_tac \"polyn_expr A Y l (l, cmp h u) \\<in> carrier A\",\n        thin_tac \"polyn_expr A Y n (n, cmp h f) \\<in> carrier A\",\n        thin_tac \"Y \\<in> carrier A\",\n        thin_tac \"Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y \\<in> carrier A\",\n        thin_tac \"cmp h f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (Y^\\<^bsup>A n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> Y) \\<in> carrier A\",\n        thin_tac \"polyn_expr A Y (l + n) (l + n, cmp h e) \\<plusminus>\\<^bsub>A\\<^esub>\n        polyn_expr A Y (Suc (l + n))\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))) =\n        polyn_expr A Y (Suc (l + n))\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc (l + n), g)\" in cf_h_coeff[of A B Y h], \n          assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (cf_h h (Suc (l + n), g))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (frule_tac c = \"(Suc (l + n), g)\" and d = \"add_cf S (l + n, e)\n         (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))\" in pol_expr_unique2)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S\n                          (add_cf S (l + n, e)\n                            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g)\\<rbrakk>\n       \\<Longrightarrow> fst (Suc (l + n), g) =\n                         fst (add_cf S (l + n, e)\n                               (ext_cf S (Suc n)\n                                 (sp_cf S (f (Suc n)) (l, u))))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g);\n        (polyn_expr R X (fst (Suc (l + n), g)) (Suc (l + n), g) =\n         polyn_expr R X\n          (fst (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), g).\n            snd (Suc (l + n), g) j =\n            snd (add_cf S (l + n, e)\n                  (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g)\\<rbrakk>\n       \\<Longrightarrow> fst (Suc (l + n), g) =\n                         fst (add_cf S (l + n, e)\n                               (ext_cf S (Suc n)\n                                 (sp_cf S (f (Suc n)) (l, u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g);\n        (polyn_expr R X (fst (Suc (l + n), g)) (Suc (l + n), g) =\n         polyn_expr R X\n          (fst (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), g).\n            snd (Suc (l + n), g) j =\n            snd (add_cf S (l + n, e)\n                  (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:add_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g)\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         max (l + n)\n                          (fst (ext_cf S (Suc n)\n                                 (sp_cf S (f (Suc n)) (l, u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g);\n        (polyn_expr R X (fst (Suc (l + n), g)) (Suc (l + n), g) =\n         polyn_expr R X\n          (fst (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), g).\n            snd (Suc (l + n), g) j =\n            snd (add_cf S (l + n, e)\n                  (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:ext_cf_len sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g);\n        (polyn_expr R X (fst (Suc (l + n), g)) (Suc (l + n), g) =\n         polyn_expr R X\n          (fst (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), g).\n            snd (Suc (l + n), g) j =\n            snd (add_cf S (l + n, e)\n                  (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (simp add:add_cf_len ext_cf_len sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        cmp h f (Suc n) \\<in> carrier B;\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        pol_coeff B (Suc (l + n), cmp h g);\n        (polyn_expr R X (Suc (l + n))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))) =\n         polyn_expr R X (Suc (n + l))\n          (add_cf S (l + n, e)\n            (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            g j =\n            snd (add_cf S (l + n, e)\n                  (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (cut_tac a = n and b = l in add.commute, simp,\n     thin_tac \"pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\",\n     thin_tac \"pol_coeff B (Suc (l + n), cmp h g)\",\n     thin_tac \"pol_coeff S\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\",\n     thin_tac \"pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\",\n     thin_tac \"pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\",\n     thin_tac \"polyn_expr R X (Suc (l + n)) (Suc (l + n), g) =\n        polyn_expr R X (Suc (l + n))\n         (add_cf S (l + n, e)\n           (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) =\n                         polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g)", "apply (rule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"(Suc (l + n), g)\" in cf_h_coeff[of A B Y h],\n             assumption+,\n           frule_tac c = \"(l + n, e)\" in cf_h_coeff[of A B Y h],\n             assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"(l, cmp h u)\" and a = \"cmp h f (Suc n)\" in \n           PolynRg.sp_cf_pol_coeff[of A B Y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (cut_tac c = \"(l + n, cmp h e)\" and \n           d = \"ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\" in\n           PolynRg.add_cf_pol_coeff, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (rule PolynRg.ext_cf_pol_coeff, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"(Suc (l + n), cmp h g)\" and \n           d = \"add_cf B (l + n, cmp h e)\n             (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\" in \n           PolynRg.pol_expr_unique2[of A B Y])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (Suc (l + n), cmp h g)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> fst (Suc (l + n), cmp h g) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 4. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> fst (Suc (l + n), cmp h g) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> fst (Suc (l + n), cmp h g) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:add_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac n = \"l + n\" and f = e in  cf_h_pol_coeff[of A B Y h],\n            assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        cf_h h (l + n, e) = (l + n, cmp h e)\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"sp_cf B (cmp h f (Suc n)) (l, cmp h u)\" and \n           n = \"Suc n\" in \n           PolynRg.ext_cf_pol_coeff[of A B Y], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        cf_h h (l + n, e) = (l + n, cmp h e);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         fst (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.add_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g)); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        cf_h h (l + n, e) = (l + n, cmp h e);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         max (l + n)\n                          (fst (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.ext_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g)); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        cf_h h (l + n, e) = (l + n, cmp h e);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> Suc (l + n) =\n                         max (l + n)\n                          (Suc (n +\n                                fst (sp_cf B (cmp h f (Suc n))\n(l, cmp h u))))\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (fst (Suc (l + n), cmp h g))\n          (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>fst (Suc (l + n), cmp h g).\n            snd (Suc (l + n), cmp h g) j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.add_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"sp_cf B (cmp h f (Suc n)) (l, cmp h u)\" and \n           n = \"Suc n\" in PolynRg.ext_cf_pol_coeff[of A B Y],\n            assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (frule_tac c = \"(l + n, cmp h e)\" and\n           d = \"ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u))\" in \n           PolynRg.add_cf_pol_coeff[of A B Y])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B (l + n, cmp h e)\n 2. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\\<rbrakk>\n       \\<Longrightarrow> pol_coeff B\n                          (ext_cf B (Suc n)\n                            (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))\n 3. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:cf_h_pol_coeff, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (cf_h h (Suc (l + n), g));\n        pol_coeff B (cf_h h (l + n, e));\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (fst (add_cf B (l + n, cmp h e)\n                 (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.add_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (max (l + n)\n            (fst (ext_cf B (Suc n)\n                   (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.ext_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y\n          (max (l + n)\n            (Suc (n + fst (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (simp add:PolynRg.sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y (Suc (n + l))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (Suc (l + n))\n                          (Suc (l + n), cmp h g) =\n                         polyn_expr A Y (Suc (l + n))\n                          (add_cf B (l + n, cmp h e)\n                            (ext_cf B (Suc n)\n                              (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))", "apply (cut_tac a = n and b = l in add.commute, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y (Suc (l + n))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (l + n).\n                            cmp h g j =\n                            snd (add_cf B (l + n, cmp h e)\n                                  (ext_cf B (Suc n)\n                                    (sp_cf B (cmp h f (Suc n))\n(l, cmp h u))))\n                             j", "(* we got \n     \\<forall>j\\<le>Suc (l + n).\n             cmp h g j =\n             snd (add_cf B (l + n, cmp h e)\n                   (ext_cf B (Suc n)\n                     (sp_cf B (cmp h f (Suc n)) (l, cmp h u)))) j *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        (polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y (Suc (l + n))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j);\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (l + n).\n                            cmp h g j =\n                            snd (add_cf B (l + n, cmp h e)\n                                  (ext_cf B (Suc n)\n                                    (sp_cf B (cmp h f (Suc n))\n(l, cmp h u))))\n                             j", "apply (thin_tac \"(polyn_expr A Y (Suc (l + n)) (Suc (l + n), cmp h g) =\n         polyn_expr A Y (Suc (l + n))\n          (add_cf B (l + n, cmp h e)\n            (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))) =\n        (\\<forall>j\\<le>Suc (l + n).\n            cmp h g j =\n            snd (add_cf B (l + n, cmp h e)\n                  (ext_cf B (Suc n)\n                    (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n             j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n)\n             (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>Suc (l + n).\n                            cmp h g j =\n                            snd (add_cf B (l + n, cmp h e)\n                                  (ext_cf B (Suc n)\n                                    (sp_cf B (cmp h f (Suc n))\n(l, cmp h u))))\n                             j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j \\<le> Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> cmp h g j =\n                         snd (add_cf B (l + n, cmp h e)\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (cmp h f (Suc n)) (l, cmp h u))))\n                          j", "apply (subst cmp_def)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B;\n        \\<forall>j\\<le>Suc (l + n).\n           g j =\n           snd (add_cf S (l + n, e)\n                 (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u))))\n            j;\n        pol_coeff B (Suc (l + n), cmp h g); pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j \\<le> Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> h (g j) =\n                         snd (add_cf B (l + n, \\<lambda>x. h (e x))\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (h (f (Suc n)))\n                                   (l, \\<lambda>x. h (u x)))))\n                          j", "apply (drule_tac a = j in forall_spec, simp, simp,\n          thin_tac \"g j = snd (add_cf S (l + n, e)\n                     (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)))) j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B; pol_coeff B (Suc (l + n), cmp h g);\n        pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j \\<le> Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (l + n, e)\n                                  (ext_cf S (Suc n)\n                                    (sp_cf S (f (Suc n)) (l, u))))\n                             j) =\n                         snd (add_cf B (l + n, \\<lambda>x. h (e x))\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (h (f (Suc n)))\n                                   (l, \\<lambda>x. h (u x)))))\n                          j", "apply (case_tac \"j = Suc (l+n)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B; pol_coeff B (Suc (l + n), cmp h g);\n        pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j = Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (l + n, e)\n                                  (ext_cf S (Suc n)\n                                    (sp_cf S (f (Suc n)) (l, u))))\n                             (Suc (l + n))) =\n                         snd (add_cf B (l + n, \\<lambda>x. h (e x))\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (h (f (Suc n)))\n                                   (l, \\<lambda>x. h (u x)))))\n                          (Suc (l + n))\n 2. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B; pol_coeff B (Suc (l + n), cmp h g);\n        pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j \\<le> Suc (l + n); j \\<noteq> Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (l + n, e)\n                                  (ext_cf S (Suc n)\n                                    (sp_cf S (f (Suc n)) (l, u))))\n                             j) =\n                         snd (add_cf B (l + n, \\<lambda>x. h (e x))\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (h (f (Suc n)))\n                                   (l, \\<lambda>x. h (u x)))))\n                          j", "apply ((subst add_cf_def)+, \n            simp add:ext_cf_len, simp add:sp_cf_len,\n            simp add:cmp_def PolynRg.ext_cf_len,\n            simp add:PolynRg.sp_cf_len,\n            (subst ext_cf_def)+, simp add:sp_cf_len sliden_def,\n            (subst sp_cf_def)+, simp,\n           frule_tac c = \"(l, u)\" and j = l in pol_coeff_mem, simp, simp,\n           simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, cmp h f); pol_coeff B (l, cmp h u);\n        pol_coeff S (n, f); pol_coeff B (n, cmp h f);\n        cmp h f (Suc n) \\<in> carrier A; f (Suc n) \\<in> carrier S;\n        pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        cmp h f (Suc n) \\<in> carrier B; pol_coeff B (Suc (l + n), cmp h g);\n        pol_coeff B (l + n, cmp h e);\n        pol_coeff B (sp_cf B (cmp h f (Suc n)) (l, cmp h u));\n        pol_coeff B\n         (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u)));\n        pol_coeff B\n         (add_cf B (l + n, cmp h e)\n           (ext_cf B (Suc n) (sp_cf B (cmp h f (Suc n)) (l, cmp h u))));\n        j \\<le> Suc (l + n); j \\<noteq> Suc (l + n)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (l + n, e)\n                                  (ext_cf S (Suc n)\n                                    (sp_cf S (f (Suc n)) (l, u))))\n                             j) =\n                         snd (add_cf B (l + n, \\<lambda>x. h (e x))\n                               (ext_cf B (Suc n)\n                                 (sp_cf B (h (f (Suc n)))\n                                   (l, \\<lambda>x. h (u x)))))\n                          j", "apply (frule_tac m = j and n = \"Suc (l + n)\" in noteq_le_less, assumption,\n        thin_tac \"j \\<le> Suc (l + n)\", thin_tac \"j \\<noteq> Suc (l + n)\",\n        (subst add_cf_def)+,\n        simp add:ext_cf_len sp_cf_len, simp add:cmp_def,\n        simp add:PolynRg.ext_cf_len PolynRg.sp_cf_len,\n        (subst ext_cf_def)+, simp add:sp_cf_len,\n        (subst sp_cf_def)+, simp add:sliden_def,\n        frule_tac x = j and n = \"l + n\" in Suc_less_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, \\<lambda>x. h (f x));\n        pol_coeff B (l, \\<lambda>x. h (u x)); pol_coeff S (n, f);\n        pol_coeff B (n, \\<lambda>x. h (f x)); h (f (Suc n)) \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        h (f (Suc n)) \\<in> carrier B;\n        pol_coeff B (Suc (l + n), \\<lambda>x. h (g x));\n        pol_coeff B (l + n, \\<lambda>x. h (e x));\n        pol_coeff B (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x))));\n        pol_coeff B\n         (add_cf B (l + n, \\<lambda>x. h (e x))\n           (ext_cf B (Suc n)\n             (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)))));\n        j < Suc (l + n); j \\<le> l + n\\<rbrakk>\n       \\<Longrightarrow> (Suc n \\<le> j \\<longrightarrow>\n                          h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                             f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             u (j - Suc n)) =\n                          h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                          h (f (Suc n)) \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub>\n                          h (u (j - Suc n))) \\<and>\n                         (\\<not> Suc n \\<le> j \\<longrightarrow>\n                          h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                             \\<zero>\\<^bsub>S\\<^esub>) =\n                          h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                          \\<zero>\\<^bsub>B\\<^esub>)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, \\<lambda>x. h (f x));\n        pol_coeff B (l, \\<lambda>x. h (u x)); pol_coeff S (n, f);\n        pol_coeff B (n, \\<lambda>x. h (f x)); h (f (Suc n)) \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        h (f (Suc n)) \\<in> carrier B;\n        pol_coeff B (Suc (l + n), \\<lambda>x. h (g x));\n        pol_coeff B (l + n, \\<lambda>x. h (e x));\n        pol_coeff B (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x))));\n        pol_coeff B\n         (add_cf B (l + n, \\<lambda>x. h (e x))\n           (ext_cf B (Suc n)\n             (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)))));\n        j < Suc (l + n); j \\<le> l + n\\<rbrakk>\n       \\<Longrightarrow> Suc n \\<le> j \\<longrightarrow>\n                         h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                            f (Suc n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            u (j - Suc n)) =\n                         h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         h (f (Suc n)) \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub>\n                         h (u (j - Suc n))\n 2. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, \\<lambda>x. h (f x));\n        pol_coeff B (l, \\<lambda>x. h (u x)); pol_coeff S (n, f);\n        pol_coeff B (n, \\<lambda>x. h (f x)); h (f (Suc n)) \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        h (f (Suc n)) \\<in> carrier B;\n        pol_coeff B (Suc (l + n), \\<lambda>x. h (g x));\n        pol_coeff B (l + n, \\<lambda>x. h (e x));\n        pol_coeff B (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x))));\n        pol_coeff B\n         (add_cf B (l + n, \\<lambda>x. h (e x))\n           (ext_cf B (Suc n)\n             (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)))));\n        j < Suc (l + n); j \\<le> l + n\\<rbrakk>\n       \\<Longrightarrow> \\<not> Suc n \\<le> j \\<longrightarrow>\n                         h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                            \\<zero>\\<^bsub>S\\<^esub>) =\n                         h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (rule impI,\n         frule_tac x = j and y = \"Suc (l + n)\" in less_imp_le,\n         frule_tac m = j and n = \"Suc (l + n)\" and l = \"Suc n\" in diff_le_mono,\n         simp,\n         frule_tac c = \"(l, u)\" and j = \"j - Suc n\" in pol_coeff_mem, simp,\n         frule_tac c = \"(l + n, e)\" and j = j in pol_coeff_mem, simp, simp,\n         frule_tac x = \"f (Suc n)\" and y = \"u (j - Suc n)\" in \n          Ring.ring_tOp_closed[of S], assumption+,\n         simp add:rHom_add rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, \\<lambda>x. h (f x));\n        pol_coeff B (l, \\<lambda>x. h (u x)); pol_coeff S (n, f);\n        pol_coeff B (n, \\<lambda>x. h (f x)); h (f (Suc n)) \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        h (f (Suc n)) \\<in> carrier B;\n        pol_coeff B (Suc (l + n), \\<lambda>x. h (g x));\n        pol_coeff B (l + n, \\<lambda>x. h (e x));\n        pol_coeff B (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x))));\n        pol_coeff B\n         (add_cf B (l + n, \\<lambda>x. h (e x))\n           (ext_cf B (Suc n)\n             (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)))));\n        j < Suc (l + n); j \\<le> l + n\\<rbrakk>\n       \\<Longrightarrow> \\<not> Suc n \\<le> j \\<longrightarrow>\n                         h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                            \\<zero>\\<^bsub>S\\<^esub>) =\n                         h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l u n f g e j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (l, u);\n        Subring R S; Ring S; Ring A; Subring A B; Ring B;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc (l + n), g);\n        pol_coeff S (l + n, g); pol_coeff S (l + n, e);\n        e (l + n) = u l \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f n;\n        pol_coeff B (Suc n, \\<lambda>x. h (f x));\n        pol_coeff B (l, \\<lambda>x. h (u x)); pol_coeff S (n, f);\n        pol_coeff B (n, \\<lambda>x. h (f x)); h (f (Suc n)) \\<in> carrier A;\n        f (Suc n) \\<in> carrier S; pol_coeff S (sp_cf S (f (Suc n)) (l, u));\n        pol_coeff S (ext_cf S (Suc n) (sp_cf S (f (Suc n)) (l, u)));\n        h (f (Suc n)) \\<in> carrier B;\n        pol_coeff B (Suc (l + n), \\<lambda>x. h (g x));\n        pol_coeff B (l + n, \\<lambda>x. h (e x));\n        pol_coeff B (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)));\n        pol_coeff B\n         (ext_cf B (Suc n)\n           (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x))));\n        pol_coeff B\n         (add_cf B (l + n, \\<lambda>x. h (e x))\n           (ext_cf B (Suc n)\n             (sp_cf B (h (f (Suc n))) (l, \\<lambda>x. h (u x)))));\n        j < Suc (l + n); j \\<le> l + n; \\<not> Suc n \\<le> j\\<rbrakk>\n       \\<Longrightarrow> h (e j \\<plusminus>\\<^bsub>S\\<^esub>\n                            \\<zero>\\<^bsub>S\\<^esub>) =\n                         h (e j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (frule_tac c = \"(l + n, e)\" and j = j in pol_coeff_mem, simp, simp,\n         frule_tac Ring.ring_zero[of S],\n         simp add:rHom_add rHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_multTr1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      pol_coeff S c; pol_coeff S d;  pol_coeff S e; fst e = fst c + fst d; \n    (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X (fst d) d) = \n     polyn_expr R X ((fst c) + (fst d)) e \\<rbrakk> \\<Longrightarrow> \n (polyn_expr A Y (fst c) (cf_h h c)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (polyn_expr A Y (fst d) (cf_h h d))\n  =  (polyn_expr A Y (fst e) (cf_h h e))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; pol_coeff S c; pol_coeff S d;\n     pol_coeff S e; fst e = fst c + fst d;\n     polyn_expr R X (fst c) c \\<cdot>\\<^sub>r polyn_expr R X (fst d) d =\n     polyn_expr R X (fst c + fst d) e\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst c)\n                       (cf_h h c) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst d) (cf_h h d) =\n                      polyn_expr A Y (fst e) (cf_h h e)", "by (cases d, cases e) (simp add: erH_multTr)"], ["", "lemma (in PolynRg) erHomTr0:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R\\<rbrakk>\n      \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a x) = -\\<^sub>a\\<^bsub>A\\<^esub> (erH R S X A B Y h x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a x) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h x", "apply (cut_tac ring_is_ag,\n       cut_tac subring, frule subring_Ring,\n       frule PolynRg.is_Ring[of A B Y],\n       frule Ring.ring_is_ag[of A],\n       frule PolynRg.subring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a x) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h x", "apply (case_tac \"x = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_inv_zero,\n       simp add:erH_rHom_0[of A B Y h],\n       frule Ring.ring_is_ag[of A], simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a x) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h x", "apply (simp add:erH_def erh_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a x \\<in> carrier R \\<longrightarrow>\n                       polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                        (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                       -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n             (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))) \\<and>\n                      (-\\<^sub>a x \\<notin> carrier R \\<longrightarrow>\n                       undefined =\n                       -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n             (fst (s_cf R S X x)) (cf_h h (s_cf R S X x)))", "apply (simp add:aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (frule_tac p = x in s_cf_expr, assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (frule_tac x = x in aGroup.ag_mOp_closed, assumption+,\n       frule_tac p = \"-\\<^sub>a x\" in s_cf_expr,\n       thin_tac \"x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x)\",      \n       rule contrapos_pp, simp+,\n       frule_tac x = x in aGroup.ag_inv_inv, simp, simp add:aGroup.ag_inv_zero,\n       (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     -\\<^sub>a x =\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (frule_tac c = \"s_cf R S X (-\\<^sub>a x)\" in cf_h_coeff[of A B Y h],\n         assumption+,\n         frule_tac c = \"s_cf R S X x\" in cf_h_coeff[of A B Y h],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     -\\<^sub>a x =\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (frule polyn_minus_m_cf[of \"s_cf R S X x\" \"fst (s_cf R S X x)\"],\n          simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     -\\<^sub>a x =\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     -\\<^sub>a polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (cut_tac a = \"-\\<^sub>a x\" and \n          b = \"polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x))) (s_cf R S X (-\\<^sub>a x))\"\n     and  c = \"polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x))\" \n          in box_equation, assumption, simp,\n          thin_tac \"x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x)\",\n          thin_tac \"-\\<^sub>a x =\n         polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x))) (s_cf R S X (-\\<^sub>a x))\",\n          thin_tac \"-\\<^sub>a (polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x)) =\n         polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x))\",\n         frule m_cf_pol_coeff[of \"s_cf R S X x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> polyn_expr A Y\n            (fst (s_cf R S X x)) (cf_h h (s_cf R S X x))", "apply (subst PolynRg.polyn_minus_m_cf[of A B Y], assumption+,\n         simp add:cf_h_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      polyn_expr A Y (fst (s_cf R S X x))\n                       (m_cf B (cf_h h (s_cf R S X x)))", "apply (frule_tac c = \"cf_h h (s_cf R S X x)\" in \n                   PolynRg.m_cf_pol_coeff[of A B Y], assumption,\n         frule PolynRg.pol_expr_unique2[of A B Y \"cf_h h (s_cf R S X (-\\<^sub>a x))\" \n         \"m_cf B (cf_h h (s_cf R S X x))\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)))\\<rbrakk>\n    \\<Longrightarrow> fst (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      fst (m_cf B (cf_h h (s_cf R S X x)))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (-\\<^sub>a x))))\n       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n      polyn_expr A Y (fst (m_cf B (cf_h h (s_cf R S X x))))\n       (m_cf B (cf_h h (s_cf R S X x)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (-\\<^sub>a x))).\n         snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n         snd (m_cf B (cf_h h (s_cf R S X x))) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      polyn_expr A Y (fst (s_cf R S X x))\n                       (m_cf B (cf_h h (s_cf R S X x)))", "apply (simp add:cf_h_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)))\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X (-\\<^sub>a x)) =\n                      fst (m_cf B (cf_h h (s_cf R S X x)))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (-\\<^sub>a x))))\n       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n      polyn_expr A Y (fst (m_cf B (cf_h h (s_cf R S X x))))\n       (m_cf B (cf_h h (s_cf R S X x)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (-\\<^sub>a x))).\n         snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n         snd (m_cf B (cf_h h (s_cf R S X x))) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      polyn_expr A Y (fst (s_cf R S X x))\n                       (m_cf B (cf_h h (s_cf R S X x)))", "apply (simp add:PolynRg.m_cf_len cf_h_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)))\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X (-\\<^sub>a x)) = fst (s_cf R S X x)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (-\\<^sub>a x))))\n       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n      polyn_expr A Y (fst (m_cf B (cf_h h (s_cf R S X x))))\n       (m_cf B (cf_h h (s_cf R S X x)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (-\\<^sub>a x))).\n         snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n         snd (m_cf B (cf_h h (s_cf R S X x))) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      polyn_expr A Y (fst (s_cf R S X x))\n                       (m_cf B (cf_h h (s_cf R S X x)))", "apply (simp add:s_cf_deg[THEN sym, of x],\n         cut_tac ring_zero,         \n         frule aGroup.ag_inv_inj[of R x \\<zero>], assumption+, \n         simp only:aGroup.ag_inv_zero,\n         subst s_cf_deg[THEN sym, of \"-\\<^sub>a x\"], assumption+,\n         simp add:deg_minus_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (-\\<^sub>a x))))\n       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n      polyn_expr A Y (fst (m_cf B (cf_h h (s_cf R S X x))))\n       (m_cf B (cf_h h (s_cf R S X x)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (-\\<^sub>a x))).\n         snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n         snd (m_cf B (cf_h h (s_cf R S X x))) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n                       (cf_h h (s_cf R S X (-\\<^sub>a x))) =\n                      polyn_expr A Y (fst (s_cf R S X x))\n                       (m_cf B (cf_h h (s_cf R S X x)))", "apply (simp add:cf_h_len PolynRg.m_cf_len,\n         thin_tac \"(polyn_expr A Y (fst (s_cf R S X (-\\<^sub>a x)))\n         (cf_h h (s_cf R S X (-\\<^sub>a x))) = polyn_expr A Y (fst (s_cf R S X x))\n         (m_cf B (cf_h h (s_cf R S X x)))) =\n         (\\<forall>j\\<le>fst (s_cf R S X (-\\<^sub>a x)). snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n          snd (m_cf B (cf_h h (s_cf R S X x))) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R; aGroup R;\n     Subring R S; Ring S; Ring A; aGroup A; Subring A B; Ring B;\n     x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n     snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n     snd (s_cf R S X (-\\<^sub>a x))\n      (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n     pol_coeff B (cf_h h (s_cf R S X x));\n     polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n      (s_cf R S X (-\\<^sub>a x)) =\n     polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n     pol_coeff S (m_cf S (s_cf R S X x));\n     pol_coeff B (m_cf B (cf_h h (s_cf R S X x)))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X (-\\<^sub>a x)).\n                         snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n                         snd (m_cf B (cf_h h (s_cf R S X x))) j", "apply (rule allI, rule impI,\n          subst m_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        snd (s_cf R S X (-\\<^sub>a x))\n         (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n        pol_coeff B (cf_h h (s_cf R S X x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x))\\<rbrakk>\n       \\<Longrightarrow> snd (cf_h h (s_cf R S X (-\\<^sub>a x))) j =\n                         snd (fst (cf_h h (s_cf R S X x)),\n                              \\<lambda>j.\n                                 -\\<^sub>a\\<^bsub>B\\<^esub> snd\n                       (cf_h h (s_cf R S X x)) j)\n                          j", "apply ((subst cf_h_def)+, simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        snd (s_cf R S X (-\\<^sub>a x))\n         (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)));\n        pol_coeff B (cf_h h (s_cf R S X x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        pol_coeff B (m_cf B (cf_h h (s_cf R S X x)));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x))\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X (-\\<^sub>a x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (thin_tac \"snd (s_cf R S X (-\\<^sub>a x)) (fst (s_cf R S X (-\\<^sub>a x))) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n          thin_tac \"pol_coeff B (cf_h h (s_cf R S X (-\\<^sub>a x)))\",\n          thin_tac \"pol_coeff B (cf_h h (s_cf R S X x))\",\n          thin_tac \"pol_coeff B (m_cf B (cf_h h (s_cf R S X x)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x))\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X (-\\<^sub>a x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (frule m_cf_pol_coeff[of \"s_cf R S X x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x));\n        pol_coeff S (m_cf S (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X (-\\<^sub>a x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (frule pol_expr_unique2[of \"s_cf R S X (-\\<^sub>a x)\" \n                    \"m_cf S (s_cf R S X x)\"], assumption+,\n          simp add:m_cf_len cf_h_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x));\n        pol_coeff S (m_cf S (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> fst (s_cf R S X (-\\<^sub>a x)) = fst (s_cf R S X x)\n 2. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        (polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n          (s_cf R S X (-\\<^sub>a x)) =\n         polyn_expr R X (fst (m_cf S (s_cf R S X x)))\n          (m_cf S (s_cf R S X x))) =\n        (\\<forall>j\\<le>fst (s_cf R S X (-\\<^sub>a x)).\n            snd (s_cf R S X (-\\<^sub>a x)) j =\n            snd (m_cf S (s_cf R S X x)) j)\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X (-\\<^sub>a x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (simp add:s_cf_deg[THEN sym, of x],\n         cut_tac ring_zero,         \n         frule aGroup.ag_inv_inj[of R x \\<zero>], assumption+, \n         simp only:aGroup.ag_inv_zero,\n         subst s_cf_deg[THEN sym, of \"-\\<^sub>a x\"], assumption+,\n         simp add:deg_minus_eq, simp add:m_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x)))\n         (s_cf R S X (-\\<^sub>a x)) =\n        polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x));\n        pol_coeff S (m_cf S (s_cf R S X x));\n        \\<forall>j\\<le>fst (s_cf R S X (-\\<^sub>a x)).\n           snd (s_cf R S X (-\\<^sub>a x)) j =\n           snd (m_cf S (s_cf R S X x)) j\\<rbrakk>\n       \\<Longrightarrow> h (snd (m_cf S (s_cf R S X x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (drule_tac a = j in forall_spec, assumption,\n         thin_tac \"snd (s_cf R S X (-\\<^sub>a x)) j = snd (m_cf S (s_cf R S X x)) j\",\n         thin_tac \"polyn_expr R X (fst (s_cf R S X (-\\<^sub>a x))) \n         (s_cf R S X (-\\<^sub>a x)) =\n         polyn_expr R X (fst (s_cf R S X x)) (m_cf S (s_cf R S X x))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        j \\<le> fst (s_cf R S X (-\\<^sub>a x));\n        pol_coeff S (m_cf S (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> h (snd (m_cf S (s_cf R S X x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (cut_tac ring_zero,         \n         frule aGroup.ag_inv_inj[of R x \\<zero>], assumption+, \n         simp only:aGroup.ag_inv_zero,\n           (simp add:s_cf_deg[THEN sym, of \"-\\<^sub>a x\"] deg_minus_eq,\n             simp add:s_cf_deg[of x]) )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        j \\<le> fst (s_cf R S X x); pol_coeff S (m_cf S (s_cf R S X x));\n        \\<zero> \\<in> carrier R; -\\<^sub>a x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> h (snd (m_cf S (s_cf R S X x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (frule_tac j = j in pol_coeff_mem[of \"s_cf R S X x\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        j \\<le> fst (s_cf R S X x); pol_coeff S (m_cf S (s_cf R S X x));\n        \\<zero> \\<in> carrier R; -\\<^sub>a x \\<noteq> \\<zero>;\n        snd (s_cf R S X x) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h (snd (m_cf S (s_cf R S X x)) j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (subst m_cf_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; x \\<in> carrier R;\n        aGroup R; Subring R S; Ring S; Ring A; aGroup A; Subring A B;\n        Ring B; x \\<noteq> \\<zero>; pol_coeff S (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        -\\<^sub>a x \\<in> carrier R; pol_coeff S (s_cf R S X (-\\<^sub>a x));\n        j \\<le> fst (s_cf R S X x); pol_coeff S (m_cf S (s_cf R S X x));\n        \\<zero> \\<in> carrier R; -\\<^sub>a x \\<noteq> \\<zero>;\n        snd (s_cf R S X x) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h (-\\<^sub>a\\<^bsub>S\\<^esub> snd (s_cf R S X x)\n                  j) =\n                         -\\<^sub>a\\<^bsub>B\\<^esub> h (snd (s_cf R S X x) j)", "apply (simp add:rHom_inv_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erHomTr1:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n      deg_n R S X a = deg_n R S X b\\<rbrakk> \\<Longrightarrow> \n      erH R S X A B Y h (a \\<plusminus> b) = erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub> \n                                             (erH R S X A B Y h b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     deg_n R S X a = deg_n R S X b\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                      erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h b", "apply (cut_tac ring_is_ag,\n       cut_tac subring, frule subring_Ring,\n       frule PolynRg.subring[of A B Y],\n       frule_tac x = a and y = b in aGroup.ag_pOp_closed[of \"R\"], \n       assumption+,\n       simp add:erH_def erh_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>; deg_n R S X a = deg_n R S X b;\n     aGroup R; Subring R S; Ring S; Subring A B;\n     a \\<plusminus> b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule s_cf_expr[of a], assumption,\n       frule s_cf_expr[of b], assumption,\n       frule s_cf_expr[of \"a \\<plusminus> b\"], assumption,\n       (erule conjE)+,\n       simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     a = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X a);\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b);\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     a \\<plusminus> b =\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule polyn_add1[of \"s_cf R S X a\" \"s_cf R S X b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     a = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X a);\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b);\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     a \\<plusminus> b =\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a) \\<plusminus>\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b) =\n     polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n      (add_cf S (s_cf R S X a) (s_cf R S X b))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (cut_tac a = \"a \\<plusminus> b\" and \n       b = \"polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b))) (s_cf R S X (a \\<plusminus> b))\" and\n       c = \"polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n       (add_cf S (s_cf R S X a) (s_cf R S X b))\" in box_equation, \n       drule sym, drule sym, drule sym, simp,\n       drule sym, drule sym, drule sym, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a) \\<plusminus>\n        polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b) =\n        polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n        (add_cf S (s_cf R S X a) (s_cf R S X b))\",\n       thin_tac \"a = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X a)\",\n       thin_tac \"b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b)\",\n       thin_tac \"a \\<plusminus> b = \n         polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b))) (s_cf R S X (a \\<plusminus> b))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n      (add_cf S (s_cf R S X a) (s_cf R S X b))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule cf_h_coeff[of A B Y h \"s_cf R S X a\"], assumption+,\n       frule cf_h_coeff[of A B Y h \"s_cf R S X b\"], assumption+,\n       frule cf_h_coeff[of A B Y h \"s_cf R S X (a \\<plusminus> b)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule PolynRg.polyn_add1[of A B Y \"cf_h h (s_cf R S X a)\" \n                                \"cf_h h (s_cf R S X b)\"], assumption+,\n       simp add:cf_h_len,\n       thin_tac \"polyn_expr A Y (fst (s_cf R S X b)) (cf_h h (s_cf R S X a))\n        \\<plusminus>\\<^bsub>A\\<^esub> polyn_expr A Y (fst (s_cf R S X b)) (cf_h h (s_cf R S X b)) =\n             polyn_expr A Y (fst (s_cf R S X b))\n               (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\",\n       frule PolynRg.add_cf_pol_coeff[of A B Y \"cf_h h (s_cf R S X a)\" \n                \"cf_h h (s_cf R S X b)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B\n      (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (case_tac \"fst (s_cf R S X (a \\<plusminus>\\<^bsub>R\\<^esub> b)) = fst (s_cf R S X b)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule PolynRg.pol_expr_unique2[of A B Y \"cf_h h (s_cf R S X (a \\<plusminus> b))\" \n              \"add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))\"],\n       assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> fst (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      fst (add_cf B (cf_h h (s_cf R S X a))\n                            (cf_h h (s_cf R S X b)))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (a \\<plusminus> b))))\n       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n      polyn_expr A Y\n       (fst (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))))\n       (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (a \\<plusminus> b))).\n         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n         snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\n          j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (simp add:cf_h_len add_cf_len,\n              simp add:PolynRg.add_cf_len cf_h_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     (polyn_expr A Y (fst (cf_h h (s_cf R S X (a \\<plusminus> b))))\n       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n      polyn_expr A Y\n       (fst (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))))\n       (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))) =\n     (\\<forall>j\\<le>fst (cf_h h (s_cf R S X (a \\<plusminus> b))).\n         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n         snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\n          j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (simp add:PolynRg.add_cf_len cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst (s_cf R S X b)) (cf_h h (s_cf R S X \n        (a \\<plusminus> b))) = polyn_expr A Y (fst (s_cf R S X b))\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))) =\n         (\\<forall>j\\<le>fst (s_cf R S X b).\n          snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n          snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))) j)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule pol_expr_unique2[of \"s_cf R S X (a \\<plusminus> b)\" \n              \"add_cf S (s_cf R S X a) (s_cf R S X b)\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S (s_cf R S X a) (s_cf R S X b))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X (a \\<plusminus> b)) =\n                      fst (add_cf S (s_cf R S X a) (s_cf R S X b))\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     (polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n       (s_cf R S X (a \\<plusminus> b)) =\n      polyn_expr R X (fst (add_cf S (s_cf R S X a) (s_cf R S X b)))\n       (add_cf S (s_cf R S X a) (s_cf R S X b))) =\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j\n 4. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (simp add:add_cf_pol_coeff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X (a \\<plusminus> b)) =\n                      fst (add_cf S (s_cf R S X a) (s_cf R S X b))\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     (polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n       (s_cf R S X (a \\<plusminus> b)) =\n      polyn_expr R X (fst (add_cf S (s_cf R S X a) (s_cf R S X b)))\n       (add_cf S (s_cf R S X a) (s_cf R S X b))) =\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j\n 3. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (simp add:add_cf_len, simp add:add_cf_len,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n                 polyn_expr R X (fst (s_cf R S X b))\n                 (add_cf S (s_cf R S X a) (s_cf R S X b))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     \\<forall>j\\<le>fst (s_cf R S X b).\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (rule allI, rule impI,\n       drule_tac a = j in forall_spec, assumption,\n       subst add_cf_def, simp add:cf_h_len,\n       (subst cf_h_def)+, (subst cmp_def)+, simp,\n        thin_tac \"snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        j \\<le> fst (s_cf R S X b)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n                             j) =\n                         h (snd (s_cf R S X a)\n                             j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         h (snd (s_cf R S X b) j)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (subst add_cf_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        j \\<le> fst (s_cf R S X b)\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X a)\n                             j \\<plusminus>\\<^bsub>S\\<^esub>\n                            snd (s_cf R S X b) j) =\n                         h (snd (s_cf R S X a)\n                             j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         h (snd (s_cf R S X b) j)\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule_tac j = j in pol_coeff_mem[of \"s_cf R S X a\"], simp, \n       frule_tac j = j in pol_coeff_mem[of \"s_cf R S X b\"], simp,\n       simp add:rHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq>\n     fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule s_cf_deg[of a], assumption, \n       frule s_cf_deg[of b], assumption,\n       frule s_cf_deg[of \"a \\<plusminus> b\"], assumption,\n       frule deg_pols_add2[of a b], assumption+,\n       simp add:deg_def, simp add:deg_def ale_natle,\n       frule_tac m = \"fst (s_cf R S X (a \\<plusminus> b))\" and n = \"fst (s_cf R S X b)\" \n                 in noteq_le_less, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b)))\n      (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<noteq> fst (s_cf R S X b);\n     deg_n R S X a = fst (s_cf R S X b); deg_n R S X b = fst (s_cf R S X b);\n     deg_n R S X (a \\<plusminus> b) = fst (s_cf R S X (a \\<plusminus> b));\n     fst (s_cf R S X (a \\<plusminus> b)) \\<le> fst (s_cf R S X b);\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule pol_expr_unique3[of \"s_cf R S X (a \\<plusminus> b)\"\n              \"add_cf S (s_cf R S X a) (s_cf R S X b)\"],\n       simp add:add_cf_pol_coeff,\n       simp add:add_cf_len,\n       simp add:add_cf_len,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X (a \\<plusminus> b))) (s_cf R S X (a \\<plusminus> b))\n        =  polyn_expr R X (fst (s_cf R S X b)) \n                           (add_cf S (s_cf R S X a) (s_cf R S X b))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     deg_n R S X a = fst (s_cf R S X b); deg_n R S X b = fst (s_cf R S X b);\n     deg_n R S X (a \\<plusminus> b) = fst (s_cf R S X (a \\<plusminus> b));\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                      (fst (s_cf R S X b)).\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule PolynRg.pol_expr_unique3[of A B Y \"cf_h h (s_cf R S X (a \\<plusminus> b))\" \n              \"add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))\"],\n         assumption+,\n       simp add:cf_h_len PolynRg.add_cf_len,\n       simp add:PolynRg.add_cf_len cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n       (cf_h h (s_cf R S X (a \\<plusminus> b))) = polyn_expr A Y (fst (s_cf R S X b))\n       (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))) =\n       ((\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n          snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n          snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))) j) \\<and>\n        (\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n          snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))) j =\n          \\<zero>\\<^bsub>B\\<^esub>))\",\n        thin_tac \"pol_coeff B (cf_h h (s_cf R S X a))\",\n        thin_tac \"pol_coeff B (cf_h h (s_cf R S X b))\",\n        thin_tac \"pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)))\",\n        thin_tac \"pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) \n                                         (cf_h h (s_cf R S X b)))\",\n        thin_tac \"deg_n R S X a = fst (s_cf R S X b)\",\n        thin_tac \"deg_n R S X b = fst (s_cf R S X b)\",\n        thin_tac \"deg_n R S X (a \\<plusminus> b) = fst (s_cf R S X (a \\<plusminus> b))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                      (fst (s_cf R S X b)).\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n                          snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                          snd (add_cf B (cf_h h (s_cf R S X a))\n                                (cf_h h (s_cf R S X b)))\n                           j) \\<and>\n                      (\\<forall>j\\<in>nset\n (Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n                          snd (add_cf B (cf_h h (s_cf R S X a))\n                                (cf_h h (s_cf R S X b)))\n                           j =\n                          \\<zero>\\<^bsub>B\\<^esub>)", "apply (rule conjI, erule conjE,\n      thin_tac \"\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j = \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     \\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j\n 2. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                      (fst (s_cf R S X b)).\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset\n(Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j =\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (rule allI, rule impI,\n          drule_tac a = j in forall_spec, assumption,\n          (subst cf_h_def)+, (subst cmp_def)+, simp,\n          (subst add_cf_def)+, simp,\n         frule_tac j = j in pol_coeff_mem[of \"s_cf R S X a\"], simp,\n         frule_tac j = j in pol_coeff_mem[of \"s_cf R S X b\"], simp,\n         simp add:rHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     (\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)).\n         snd (s_cf R S X (a \\<plusminus> b)) j =\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                      (fst (s_cf R S X b)).\n         snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset\n(Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j =\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (erule conjE,\n       thin_tac \"\\<forall>j\\<le>fst (s_cf R S X (a \\<plusminus> b)). snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n     \\<forall>j\\<in>nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                     (fst (s_cf R S X b)).\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset\n(Suc (fst (s_cf R S X (a \\<plusminus> b)))) (fst (s_cf R S X b)).\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j =\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (rule ballI,\n         drule_tac x = j in bspec, assumption,\n         simp add:add_cf_def cf_h_len,\n         simp add:cf_h_def cmp_def,\n         frule_tac j = j in pol_coeff_mem[of \"s_cf R S X a\"], \n         simp add:nset_def,\n         frule_tac j = j in pol_coeff_mem[of \"s_cf R S X b\"], \n         simp add:nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) = fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X a)\n         (fst (s_cf R S X (a \\<plusminus> b))) \\<plusminus>\\<^bsub>S\\<^esub>\n        snd (s_cf R S X b) (fst (s_cf R S X (a \\<plusminus> b))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) < fst (s_cf R S X b);\n        j \\<in> nset (Suc (fst (s_cf R S X (a \\<plusminus> b))))\n                 (fst (s_cf R S X b));\n        snd (s_cf R S X a) j \\<plusminus>\\<^bsub>S\\<^esub>\n        snd (s_cf R S X b) j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X a) j \\<in> carrier S;\n        snd (s_cf R S X b) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X a)\n                             j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         h (snd (s_cf R S X b) j) =\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (subst rHom_add[THEN sym, of h S B], assumption+, simp,\n         (frule PolynRg.is_Ring[of A B Y],\n          frule Ring.subring_Ring[of A B], assumption),\n         simp add:rHom_0_0[of S B])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erHomTr2:\"\\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; \n      a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n      deg_n R S X a < deg_n R S X b\\<rbrakk> \\<Longrightarrow> \n      erH R S X A B Y h (a \\<plusminus> b) = erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub> \n                                             (erH R S X A B Y h b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     deg_n R S X a < deg_n R S X b\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                      erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h b", "apply (cut_tac ring_is_ag,\n       cut_tac subring, frule subring_Ring,\n       frule PolynRg.subring[of A B Y],\n       frule_tac x = a and y = b in aGroup.ag_pOp_closed[of \"R\"], \n       assumption+,\n       simp add:erH_def erh_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>; deg_n R S X a < deg_n R S X b;\n     aGroup R; Subring R S; Ring S; Subring A B;\n     a \\<plusminus> b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X (a \\<plusminus> b)))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule s_cf_expr[of a], assumption,\n       frule s_cf_expr[of b], assumption,\n       frule s_cf_expr[of \"a \\<plusminus> b\"], assumption,\n       (erule conjE)+,\n       frule polyn_deg_add1[of a b], assumption+,\n       simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     a = polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a);\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b);\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     a \\<plusminus> b =\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule polyn_add1[of \"s_cf R S X a\" \"s_cf R S X b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     a = polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a);\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b);\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     a \\<plusminus> b =\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a) \\<plusminus>\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b) =\n     polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n      (add_cf S (s_cf R S X a) (s_cf R S X b))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (cut_tac a = \"a \\<plusminus> b\" and \n       b = \"polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b))\" and\n       c = \"polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n       (add_cf S (s_cf R S X a) (s_cf R S X b))\" in box_equation,\n       drule sym, drule sym, drule sym, simp,\n       drule sym, drule sym, drule sym, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a) \\<plusminus>\n        polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b) =\n        polyn_expr R X (max (fst (s_cf R S X a)) (fst (s_cf R S X b)))\n        (add_cf S (s_cf R S X a) (s_cf R S X b))\",\n       thin_tac \"a = polyn_expr R X (fst (s_cf R S X a)) (s_cf R S X a)\",\n       thin_tac \"b = polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X b)\",\n       thin_tac \"a \\<plusminus> b = polyn_expr R X (fst (s_cf R S X b)) \n                            (s_cf R S X (a \\<plusminus> b))\",\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule cf_h_coeff[of A B Y h \"s_cf R S X a\"], assumption+,\n       frule cf_h_coeff[of A B Y h \"s_cf R S X b\"], assumption+,\n       frule cf_h_coeff[of A B Y h \"s_cf R S X (a \\<plusminus> b)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X a))\n                       (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X b))", "apply (frule PolynRg.polyn_add1[of A B Y \"cf_h h (s_cf R S X a)\" \n                                \"cf_h h (s_cf R S X b)\"], assumption+,\n       simp add:cf_h_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     polyn_expr A Y (fst (s_cf R S X a))\n      (cf_h h (s_cf R S X a)) \\<plusminus>\\<^bsub>A\\<^esub>\n     polyn_expr A Y (fst (s_cf R S X b)) (cf_h h (s_cf R S X b)) =\n     polyn_expr A Y (fst (s_cf R S X b))\n      (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (thin_tac \"polyn_expr A Y (fst (s_cf R S X a)) (cf_h h (s_cf R S X a))\n        \\<plusminus>\\<^bsub>A\\<^esub> polyn_expr A Y (fst (s_cf R S X b)) (cf_h h (s_cf R S X b)) =\n        polyn_expr A Y (fst (s_cf R S X b))\n        (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\",\n       frule PolynRg.add_cf_pol_coeff[of A B Y \"cf_h h (s_cf R S X a)\" \n                \"cf_h h (s_cf R S X b)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B\n      (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X b))\n                       (cf_h h (s_cf R S X (a \\<plusminus> b))) =\n                      polyn_expr A Y (fst (s_cf R S X b))\n                       (add_cf B (cf_h h (s_cf R S X a))\n                         (cf_h h (s_cf R S X b)))", "apply (frule PolynRg.pol_expr_unique2[of A B Y \"cf_h h (s_cf R S X (a \\<plusminus> b))\" \n              \"add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))\"],\n       assumption+,\n       simp add:cf_h_len add_cf_len,\n       simp add:PolynRg.add_cf_len cf_h_len,\n       simp add:PolynRg.add_cf_len cf_h_len,\n       thin_tac \"(polyn_expr A Y (fst (s_cf R S X b)) \n        (cf_h h (s_cf R S X (a \\<plusminus> b))) = polyn_expr A Y (fst (s_cf R S X b))\n        (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))) =\n       (\\<forall>j\\<le>fst (s_cf R S X b).\n         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n         snd (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b))) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X (a \\<plusminus> b)) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B\n      (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j", "apply (frule pol_expr_unique2[of \"s_cf R S X (a \\<plusminus> b)\" \n              \"add_cf S (s_cf R S X a) (s_cf R S X b)\"],\n       simp add:add_cf_pol_coeff,\n       simp add:add_cf_len, simp add:add_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n     polyn_expr R X (fst (s_cf R S X b))\n      (add_cf S (s_cf R S X a) (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     \\<forall>j\\<le>fst (s_cf R S X b).\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j", "apply (thin_tac \"polyn_expr R X (fst (s_cf R S X b)) (s_cf R S X (a \\<plusminus> b)) =\n        polyn_expr R X (fst (s_cf R S X b))\n       (add_cf S (s_cf R S X a) (s_cf R S X b))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n     b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n     a \\<plusminus> b \\<noteq> \\<zero>;\n     fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S; Ring S;\n     Subring A B; a \\<plusminus> b \\<in> carrier R;\n     pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n     pol_coeff S (s_cf R S X (a \\<plusminus> b));\n     snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n      (fst (s_cf R S X b)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n     pol_coeff B (cf_h h (s_cf R S X a));\n     pol_coeff B (cf_h h (s_cf R S X b));\n     pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n     pol_coeff B (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n     \\<forall>j\\<le>fst (s_cf R S X b).\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X b).\n                         snd (cf_h h (s_cf R S X (a \\<plusminus> b))) j =\n                         snd (add_cf B (cf_h h (s_cf R S X a))\n                               (cf_h h (s_cf R S X b)))\n                          j", "apply (rule allI, rule impI,\n       drule_tac a = j in forall_spec, assumption,\n       subst add_cf_def, simp add:cf_h_len,\n       (subst cf_h_def)+, (subst cmp_def)+, simp,\n        subst add_cf_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        j \\<le> fst (s_cf R S X b);\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> fst (s_cf R S X a) \\<longrightarrow>\n                          h (snd (s_cf R S X a)\n                              j \\<plusminus>\\<^bsub>S\\<^esub>\n                             snd (s_cf R S X b) j) =\n                          h (snd (s_cf R S X a)\n                              j) \\<plusminus>\\<^bsub>B\\<^esub>\n                          h (snd (s_cf R S X b) j)) \\<and>\n                         (\\<not> j \\<le> fst\n    (s_cf R S X a) \\<longrightarrow>\n                          h (snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n                              j) =\n                          h (snd (s_cf R S X b) j))", "apply (case_tac \"j \\<le> fst (s_cf R S X a)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j;\n        j \\<le> fst (s_cf R S X a)\\<rbrakk>\n       \\<Longrightarrow> h (snd (s_cf R S X a)\n                             j \\<plusminus>\\<^bsub>S\\<^esub>\n                            snd (s_cf R S X b) j) =\n                         h (snd (s_cf R S X a)\n                             j) \\<plusminus>\\<^bsub>B\\<^esub>\n                         h (snd (s_cf R S X b) j)\n 2. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        j \\<le> fst (s_cf R S X b);\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j;\n        \\<not> j \\<le> fst (s_cf R S X a)\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> fst (s_cf R S X a) \\<longrightarrow>\n                          h (snd (s_cf R S X a)\n                              j \\<plusminus>\\<^bsub>S\\<^esub>\n                             snd (s_cf R S X b) j) =\n                          h (snd (s_cf R S X a)\n                              j) \\<plusminus>\\<^bsub>B\\<^esub>\n                          h (snd (s_cf R S X b) j)) \\<and>\n                         (\\<not> j \\<le> fst\n    (s_cf R S X a) \\<longrightarrow>\n                          h (snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n                              j) =\n                          h (snd (s_cf R S X b) j))", "apply (frule_tac j = j in pol_coeff_mem[of \"s_cf R S X a\"], simp, \n       frule_tac j = j in pol_coeff_mem[of \"s_cf R S X b\"], simp,\n       simp add:rHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>;\n        fst (s_cf R S X a) < fst (s_cf R S X b); aGroup R; Subring R S;\n        Ring S; Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        j \\<le> fst (s_cf R S X b);\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j;\n        \\<not> j \\<le> fst (s_cf R S X a)\\<rbrakk>\n       \\<Longrightarrow> (j \\<le> fst (s_cf R S X a) \\<longrightarrow>\n                          h (snd (s_cf R S X a)\n                              j \\<plusminus>\\<^bsub>S\\<^esub>\n                             snd (s_cf R S X b) j) =\n                          h (snd (s_cf R S X a)\n                              j) \\<plusminus>\\<^bsub>B\\<^esub>\n                          h (snd (s_cf R S X b) j)) \\<and>\n                         (\\<not> j \\<le> fst\n    (s_cf R S X a) \\<longrightarrow>\n                          h (snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n                              j) =\n                          h (snd (s_cf R S X b) j))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>PolynRg A B Y; h \\<in> rHom S B; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<noteq> \\<zero>; b \\<noteq> \\<zero>;\n        a \\<plusminus> b \\<noteq> \\<zero>; aGroup R; Subring R S; Ring S;\n        Subring A B; a \\<plusminus> b \\<in> carrier R;\n        pol_coeff S (s_cf R S X a); pol_coeff S (s_cf R S X b);\n        pol_coeff S (s_cf R S X (a \\<plusminus> b));\n        snd (s_cf R S X a) (fst (s_cf R S X a)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X b) (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n         (fst (s_cf R S X b)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X (a \\<plusminus> b)) = fst (s_cf R S X b);\n        pol_coeff B (cf_h h (s_cf R S X a));\n        pol_coeff B (cf_h h (s_cf R S X b));\n        pol_coeff B (cf_h h (s_cf R S X (a \\<plusminus> b)));\n        pol_coeff B\n         (add_cf B (cf_h h (s_cf R S X a)) (cf_h h (s_cf R S X b)));\n        j \\<le> fst (s_cf R S X b);\n        snd (s_cf R S X (a \\<plusminus> b)) j =\n        snd (add_cf S (s_cf R S X a) (s_cf R S X b)) j;\n        \\<not> j \\<le> fst (s_cf R S X a)\\<rbrakk>\n       \\<Longrightarrow> h (snd (add_cf S (s_cf R S X a) (s_cf R S X b))\n                             j) =\n                         h (snd (s_cf R S X b) j)", "apply (subst add_cf_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n   \\<Longrightarrow> erH R S X A B Y h \\<in> pHom R S X, A B Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> pHom R S X, A B Y", "apply (frule Idomain.idom_is_ring[of \"S\"],\n       cut_tac subring,\n       cut_tac polyn_ring_integral, simp,\n       frule PolynRg.subring[of A B Y],\n       frule PolynRg.is_Ring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> pHom R S X, A B Y", "apply (simp add:polyn_Hom_def,\n       rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h ` carrier S\n                      \\<subseteq> carrier B \\<and>\n                      erH R S X A B Y h X = Y", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h ` carrier S\n                      \\<subseteq> carrier B \\<and>\n                      erH R S X A B Y h X = Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (cut_tac polyn_ring_X_nonzero,\n       cut_tac X_mem_R, rule conjI,\n       rule subsetI, simp add:image_def,\n       erule bexE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n        X \\<noteq> \\<zero>; X \\<in> carrier R; xa \\<in> carrier S;\n        x = erH R S X A B Y h xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier B\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h X = Y\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (case_tac \"xa = \\<zero>\\<^bsub>S\\<^esub>\", \n       simp add:Subring_zero_ring_zero,\n       simp add:erH_rHom_0,\n       simp add:Ring.Subring_zero_ring_zero[THEN sym, of A B],\n       simp add:Ring.ring_zero[of B])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n        X \\<noteq> \\<zero>; X \\<in> carrier R; xa \\<in> carrier S;\n        x = erH R S X A B Y h xa;\n        xa \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier B\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h X = Y\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (simp add:Subring_zero_ring_zero,\n       frule_tac x = xa in mem_subring_mem_ring, assumption,\n       frule_tac p = xa in s_cf_expr, assumption+, (erule conjE)+,\n       frule_tac p1 = xa in s_cf_deg[THEN sym], assumption+,\n       frule_tac p1 = xa in pol_of_deg0[THEN sym], assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n        X \\<noteq> \\<zero>; X \\<in> carrier R; deg_n R S X xa = 0;\n        x = erH R S X A B Y h xa; xa \\<noteq> \\<zero>; xa \\<in> carrier R;\n        pol_coeff S (s_cf R S X xa); xa = polyn_expr R X 0 (s_cf R S X xa);\n        snd (s_cf R S X xa) 0 \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X xa) = 0; xa \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h xa \\<in> carrier B\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h X = Y\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (simp add:erH_def erh_def, subst polyn_expr_def, simp,\n       frule_tac c = \"s_cf R S X xa\" in cf_h_coeff[of A B Y h], assumption+,\n       frule_tac c = \"cf_h h (s_cf R S X xa)\" and j = 0 in \n                         PolynRg.pol_coeff_mem[of A B Y], assumption, simp,\n       frule_tac c = \"cf_h h (s_cf R S X xa)\" and j = 0 in \n                         PolynRg.pol_coeff_mem_R[of A B Y], assumption, simp,\n       simp add:Ring.ring_r_one[of A])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h X = Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (cut_tac pol_expr_of_X,\n       cut_tac special_cf_pol_coeff,\n       frule ext_cf_pol_coeff[of \"C\\<^sub>0 S\" \"Suc 0\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h X = Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (simp add:erH_def erh_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X X))\n                       (cf_h h (s_cf R S X X)) =\n                      Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (cut_tac deg_n_of_X)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R;\n     X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     deg_n R S X X = Suc 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X X))\n                       (cf_h h (s_cf R S X X)) =\n                      Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (frule s_cf_expr[of X], assumption+, (erule conjE)+,\n        frule_tac a = X and \n        b = \"polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\" and \n        c = \"polyn_expr R X (fst (s_cf R S X X)) (s_cf R S X X)\" in\n        box_equation, assumption+,\n        thin_tac \"X = polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S))\",\n        thin_tac \"X = polyn_expr R X (fst (s_cf R S X X)) (s_cf R S X X)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S)); deg_n R S X X = Suc 0;\n     pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (fst (s_cf R S X X)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (fst (s_cf R S X X)) (s_cf R S X X)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X X))\n                       (cf_h h (s_cf R S X X)) =\n                      Y\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (rule sym, subst PolynRg.pol_expr_of_X[of A B Y], assumption+,\n        frule s_cf_deg[of X], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n                      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (frule pol_expr_unique2[of \"ext_cf S (Suc 0) (C\\<^sub>0 S)\" \"s_cf R S X X\"],\n        assumption+, simp add:ext_cf_len special_cf_len,\n        simp add:ext_cf_len special_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j =\n        snd (s_cf R S X X) j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n                      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (frule cf_h_coeff[of A B Y h \"ext_cf S (Suc 0) (C\\<^sub>0 S)\"], assumption+,\n        frule cf_h_coeff[of A B Y h \"s_cf R S X X\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd (s_cf R S X X) j;\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)));\n     pol_coeff B (cf_h h (s_cf R S X X))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n                      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (frule PolynRg.pol_expr_unique2[of A B Y \n          \"cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))\" \"cf_h h (s_cf R S X X)\"],\n        assumption+,\n        simp add:cf_h_len ext_cf_len special_cf_len,\n        simp add:cf_h_len ext_cf_len special_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd (s_cf R S X X) j;\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)));\n     pol_coeff B (cf_h h (s_cf R S X X));\n     (polyn_expr A Y (Suc 0) (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) =\n      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))) =\n     (\\<forall>j\\<le>Suc 0.\n         snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n         snd (cf_h h (s_cf R S X X)) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y (Suc 0)\n                       (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n                      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (simp add:cf_h_special_cf)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd (s_cf R S X X) j;\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)));\n     pol_coeff B (cf_h h (s_cf R S X X));\n     (polyn_expr A Y (Suc 0) (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n      polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))) =\n     (\\<forall>j\\<le>Suc 0.\n         snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n         snd (cf_h h (s_cf R S X X)) j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc 0.\n                         snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (cf_h h (s_cf R S X X)) j\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (thin_tac \"(polyn_expr A Y (Suc 0) (ext_cf B (Suc 0) (C\\<^sub>0 B)) =\n        polyn_expr A Y (Suc 0) (cf_h h (s_cf R S X X))) =\n         (\\<forall>j\\<le>Suc 0.\n           snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n           snd (cf_h h (s_cf R S X X)) j)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; pol_coeff S (C\\<^sub>0 S);\n     pol_coeff S (ext_cf S (Suc 0) (C\\<^sub>0 S));\n     fst (s_cf R S X X) = Suc 0; pol_coeff S (s_cf R S X X);\n     snd (s_cf R S X X) (Suc 0) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (Suc 0) (ext_cf S (Suc 0) (C\\<^sub>0 S)) =\n     polyn_expr R X (Suc 0) (s_cf R S X X);\n     deg_n R S X X = Suc 0;\n     \\<forall>j\\<le>Suc 0.\n        snd (ext_cf S (Suc 0) (C\\<^sub>0 S)) j = snd (s_cf R S X X) j;\n     pol_coeff B (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S)));\n     pol_coeff B (cf_h h (s_cf R S X X))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc 0.\n                         snd (cf_h h (ext_cf S (Suc 0) (C\\<^sub>0 S))) j =\n                         snd (cf_h h (s_cf R S X X)) j\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, assumption,\n        (subst cf_h_def)+, (subst cmp_def)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (subst rHom_def, simp,\n       cut_tac ring_is_ag,\n       frule Ring.ring_is_ag[of A])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> aHom R A \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> aHom R A\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (subst aHom_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h\n                      \\<in> carrier R \\<rightarrow> carrier A \\<and>\n                      erH R S X A B Y h \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             erH R S X A B Y h (a \\<plusminus> b) =\n                             erH R S X A B Y h\n                              a \\<plusminus>\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h b)\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h\n                      \\<in> carrier R \\<rightarrow> carrier A\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             erH R S X A B Y h (a \\<plusminus> b) =\n                             erH R S X A B Y h\n                              a \\<plusminus>\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h b)\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:erH_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             erH R S X A B Y h (a \\<plusminus> b) =\n                             erH R S X A B Y h\n                              a \\<plusminus>\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h b)\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (rule conjI, simp add:erH_def erh_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>b\\<in>carrier R.\n                            erH R S X A B Y h (a \\<plusminus> b) =\n                            erH R S X A B Y h\n                             a \\<plusminus>\\<^bsub>A\\<^esub>\n                            erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (case_tac \"a = \\<zero>\\<^bsub>R\\<^esub>\", \n          case_tac \"b = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; \\<zero> \\<in> carrier R; a = \\<zero>; b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (\\<zero> \\<plusminus> \\<zero>) =\n                         erH R S X A B Y h\n                          \\<zero> \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h \\<zero>\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a = \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R;\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 4. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:erH_rHom_0,\n         frule Ring.ring_is_ag[of A], frule Ring.ring_zero[of A],\n         simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        \\<zero> \\<in> carrier R; a = \\<zero>; b = \\<zero>; aGroup A;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h \\<zero> =\n                         \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a = \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R;\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 4. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:erH_rHom_0, simp add:erH_rHom_0)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; \\<zero> \\<in> carrier R; b \\<in> carrier R; a = \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (\\<zero> \\<plusminus> b) =\n                         \\<zero>\\<^bsub>A\\<^esub> \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R;\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (frule_tac p = b in erH_mem[of A B Y h], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; \\<zero> \\<in> carrier R; b \\<in> carrier R; a = \\<zero>;\n        b \\<noteq> \\<zero>; erH R S X A B Y h b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (\\<zero> \\<plusminus> b) =\n                         \\<zero>\\<^bsub>A\\<^esub> \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R;\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R;\n        a \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (case_tac \"b = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; \\<zero> \\<in> carrier R;\n        a \\<noteq> \\<zero>; b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> \\<zero>) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h \\<zero>\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:erH_rHom_0,\n          frule_tac p = a in erH_mem[of A B Y h], assumption+,\n          simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (case_tac \"a \\<plusminus>\\<^bsub>R\\<^esub> b = \\<zero>\\<^bsub>R\\<^esub>\", simp add:erH_rHom_0)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (frule_tac x = a and y = b in aGroup.ag_inv_unique[of R],\n          assumption+, simp,\n          thin_tac \"b = -\\<^sub>a a\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; -\\<^sub>a a \\<in> carrier R;\n        a \\<noteq> \\<zero>; -\\<^sub>a a \\<noteq> \\<zero>;\n        a \\<plusminus> -\\<^sub>a a = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h (-\\<^sub>a a)\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (subst erHomTr0[of A B Y h], assumption+,\n          frule_tac p = a in erH_mem[of A B Y h], assumption+,\n          simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (case_tac \"deg_n R S X a = deg_n R S X b\",\n          simp add:erHomTr1[of A B Y h])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n        deg_n R S X a \\<noteq> deg_n R S X b\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (cut_tac y = \"deg_n R S X a\" and x = \"deg_n R S X b\" in less_linear,\n          simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n        deg_n R S X a \\<noteq> deg_n R S X b;\n        deg_n R S X b < deg_n R S X a \\<or>\n        deg_n R S X a < deg_n R S X b\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (erule disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n        deg_n R S X a \\<noteq> deg_n R S X b;\n        deg_n R S X b < deg_n R S X a\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n        deg_n R S X a \\<noteq> deg_n R S X b;\n        deg_n R S X a < deg_n R S X b\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 3. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (subst aGroup.ag_pOp_commute, assumption+,\n          frule_tac p = a in erH_mem[of A B Y h], assumption+,\n          frule_tac p = b in erH_mem[of A B Y h], assumption+,\n          subst aGroup.ag_pOp_commute[of A], assumption+,\n          rule erHomTr2[of A B Y h], assumption+,\n          simp add:aGroup.ag_pOp_commute, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; a \\<in> carrier R; b \\<in> carrier R; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a \\<plusminus> b \\<noteq> \\<zero>;\n        deg_n R S X a \\<noteq> deg_n R S X b;\n        deg_n R S X a < deg_n R S X b\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (a \\<plusminus> b) =\n                         erH R S X A B Y h a \\<plusminus>\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h b\n 2. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply(rule erHomTr2[of A B Y h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                             erH R S X A B Y h\n                              x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             erH R S X A B Y h y) \\<and>\n                      erH R S X A B Y h 1\\<^sub>r =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>", "apply (simp add:erH_rHomTr2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n     Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                            erH R S X A B Y h\n                             x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            erH R S X A B Y h y", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (case_tac \"x = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_0_x erH_rHom_0,\n        frule_tac p = y in erH_mem[of A B Y h], assumption+,\n        simp add:Ring.ring_times_0_x[of A])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (case_tac \"y = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_x_0 erH_rHom_0,\n        frule_tac p = x in erH_mem[of A B Y h], assumption+,\n        simp add:Ring.ring_times_x_0[of A])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (frule_tac p = x in s_cf_expr, assumption+,\n        frule_tac p = y in s_cf_expr, assumption+,\n        frule_tac x = x and y = y in ring_tOp_closed, assumption+, \n        frule_tac p = \"x \\<cdot>\\<^sub>r y\" in s_cf_expr,\n        simp add:Idomain.idom_tOp_nonzeros, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (frule_tac c = \"s_cf R S X x\" and d = \"s_cf R S X y\" in \n                  polyn_expr_tOp_c, assumption+, erule exE, (erule conjE)+,\n        cut_tac a = \"x \\<cdot>\\<^sub>r y\" and \n        b = \"polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) (s_cf R S X (x \\<cdot>\\<^sub>r y))\" \n        and c = \"polyn_expr R X (fst e) e\" in box_equation)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y =\n                         polyn_expr R X\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (s_cf R S X (x \\<cdot>\\<^sub>r y))\n 2. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y = polyn_expr R X (fst e) e\n 3. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst e) e\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y = polyn_expr R X (fst e) e\n 2. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst e) e\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (thin_tac \"x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) (s_cf R S X (x \\<cdot>\\<^sub>r y))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y = polyn_expr R X (fst e) e\n 2. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst e) e\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (drule sym, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x);\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst e) e\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply (thin_tac \"x = polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x)\",\n          thin_tac \"y = polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\",\n         thin_tac \"x \\<cdot>\\<^sub>r y =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) (s_cf R S X (x \\<cdot>\\<^sub>r y))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst e) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst e) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst e) e\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (x \\<cdot>\\<^sub>r y) =\n                         erH R S X A B Y h\n                          x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         erH R S X A B Y h y", "apply ((subst erH_def)+, (subst erh_def)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h h\n                            (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         polyn_expr A Y (fst (s_cf R S X y))\n                          (cf_h h (s_cf R S X y))", "apply (frule_tac c = \"s_cf R S X x\" and d = \"s_cf R S X y\" and e = e in\n        erH_multTr1[of A B Y h], assumption+, simp, simp,\n     thin_tac \"polyn_expr A Y (fst (s_cf R S X x)) (cf_h h (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n     polyn_expr A Y (fst (s_cf R S X y)) (cf_h h (s_cf R S X y)) =\n     polyn_expr A Y (fst (s_cf R S X x) + fst (s_cf R S X y)) (cf_h h e)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y);\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h e)", "apply (rotate_tac -1, drule sym, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X x)) (s_cf R S X x) \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X y)) (s_cf R S X y) =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) (s_cf R S X (x \\<cdot>\\<^sub>r y))\",\n       rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h e)", "apply (frule_tac p = x in s_cf_deg, assumption,\n         frule_tac p = y in s_cf_deg, assumption,\n         frule_tac x = x and y = y in Idomain.idom_tOp_nonzeros[of R],\n         assumption+,\n         frule_tac p = \"x \\<cdot>\\<^sub>r y\" in s_cf_deg, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>Idomain R; PolynRg A B Y; h \\<in> rHom S B; Ring S;\n        Subring R S; Idomain S; Subring A B; Ring A; Ring B; aGroup R;\n        aGroup A; x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n        y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        pol_coeff S (s_cf R S X x); pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e;\n        deg_n R S X x = fst (s_cf R S X x);\n        deg_n R S X y = fst (s_cf R S X y);\n        x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>;\n        deg_n R S X (x \\<cdot>\\<^sub>r y) =\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h e)", "apply (frule_tac p = x and q = y in deg_mult_pols, assumption+,\n         (erule conjE)+, simp,\n         thin_tac \"deg_n R S X x = fst (s_cf R S X x)\", \n         thin_tac \"deg_n R S X y = fst (s_cf R S X y)\", \n         thin_tac \"deg_n R S X (x \\<cdot>\\<^sub>r y) = fst (s_cf R S X (x \\<cdot>\\<^sub>r y))\",\n         rotate_tac -2, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>; Idomain R;\n        PolynRg A B Y; h \\<in> rHom S B; Ring S; Subring R S; Idomain S;\n        Subring A B; Ring A; Ring B; aGroup R; aGroup A; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R; pol_coeff S (s_cf R S X x);\n        pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd e (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X (x \\<cdot>\\<^sub>r y))) e;\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        fst (s_cf R S X x) + fst (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                          (cf_h h e)", "apply (simp add:cf_h_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>; Idomain R;\n        PolynRg A B Y; h \\<in> rHom S B; Ring S; Subring R S; Idomain S;\n        Subring A B; Ring A; Ring B; aGroup R; aGroup A; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R; pol_coeff S (s_cf R S X x);\n        pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X x) + fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e;\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        fst (s_cf R S X x) + fst (s_cf R S X y)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h e)", "apply (frule_tac c = \"s_cf R S X (x \\<cdot>\\<^sub>r y)\" in cf_h_coeff[of A B Y h],\n          assumption+,\n         frule_tac c = e in cf_h_coeff[of A B Y h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>; Idomain R;\n        PolynRg A B Y; h \\<in> rHom S B; Ring S; Subring R S; Idomain S;\n        Subring A B; Ring A; Ring B; aGroup R; aGroup A; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R; pol_coeff S (s_cf R S X x);\n        pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X x) + fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e;\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        fst (s_cf R S X x) + fst (s_cf R S X y);\n        pol_coeff B (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y)));\n        pol_coeff B (cf_h h e)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n                         polyn_expr A Y\n                          (fst (s_cf R S X x) + fst (s_cf R S X y))\n                          (cf_h h e)", "apply (frule_tac c = \"cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))\" and d = \"cf_h h e\" in \n         PolynRg.pol_expr_unique2[of A B Y], assumption+,\n         simp add:cf_h_len, simp add:cf_h_len,\n         thin_tac \"(polyn_expr A Y (fst (s_cf R S X x) + fst (s_cf R S X y))\n          (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) =\n           polyn_expr A Y (fst (s_cf R S X x) + fst (s_cf R S X y))\n          (cf_h h e)) =\n          (\\<forall>j\\<le>fst (s_cf R S X x) + fst (s_cf R S X y).\n            snd (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y))) j = snd (cf_h h e) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>; Idomain R;\n        PolynRg A B Y; h \\<in> rHom S B; Ring S; Subring R S; Idomain S;\n        Subring A B; Ring A; Ring B; aGroup R; aGroup A; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R; pol_coeff S (s_cf R S X x);\n        pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X (x \\<cdot>\\<^sub>r y))\n         (fst (s_cf R S X x) + fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e;\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        fst (s_cf R S X x) + fst (s_cf R S X y);\n        pol_coeff B (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y)));\n        pol_coeff B (cf_h h e)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X x) +\n  fst (s_cf R S X y).\n                            snd (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                             j =\n                            snd (cf_h h e) j", "apply (frule_tac c = \"s_cf R S X (x \\<cdot>\\<^sub>r y)\" and d = e in \n         pol_expr_unique2, assumption+, simp, simp,\n         thin_tac \"polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y))\n         (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n         polyn_expr R X (fst (s_cf R S X x) + fst (s_cf R S X y)) e\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y e.\n       \\<lbrakk>x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>; Idomain R;\n        PolynRg A B Y; h \\<in> rHom S B; Ring S; Subring R S; Idomain S;\n        Subring A B; Ring A; Ring B; aGroup R; aGroup A; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<noteq> \\<zero>; y \\<noteq> \\<zero>;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R; pol_coeff S (s_cf R S X x);\n        pol_coeff S (s_cf R S X y);\n        pol_coeff S (s_cf R S X (x \\<cdot>\\<^sub>r y));\n        snd (s_cf R S X x) (fst (s_cf R S X x)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        pol_coeff S e; fst e = fst (s_cf R S X x) + fst (s_cf R S X y);\n        snd e (fst (s_cf R S X x) + fst (s_cf R S X y)) =\n        snd (s_cf R S X x)\n         (fst (s_cf R S X x)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        snd (s_cf R S X y) (fst (s_cf R S X y));\n        fst (s_cf R S X (x \\<cdot>\\<^sub>r y)) =\n        fst (s_cf R S X x) + fst (s_cf R S X y);\n        pol_coeff B (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y)));\n        pol_coeff B (cf_h h e);\n        \\<forall>j\\<le>fst (s_cf R S X x) + fst (s_cf R S X y).\n           snd (s_cf R S X (x \\<cdot>\\<^sub>r y)) j = snd e j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X x) +\n  fst (s_cf R S X y).\n                            snd (cf_h h (s_cf R S X (x \\<cdot>\\<^sub>r y)))\n                             j =\n                            snd (cf_h h e) j", "apply (rule allI, rule impI, drule_tac a = j in forall_spec, assumption,\n         subst cf_h_def, subst cmp_def, simp, \n         subst cf_h_def, subst cmp_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_q_rHom:\"\\<lbrakk>Idomain S; maximal_ideal S P; \n       PolynRg R' (S /\\<^sub>r P) Y\\<rbrakk> \\<Longrightarrow>\n       erH R S X R' (S /\\<^sub>r P) Y (pj S P) \\<in> pHom R S X, R' (S /\\<^sub>r P) Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; maximal_ideal S P;\n     PolynRg R' (S /\\<^sub>r P) Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                      \\<in> pHom R S X, R' S /\\<^sub>r P Y", "apply (frule Idomain.idom_is_ring[of \"S\"],\n       frule Ring.qring_ring[of S P], simp add:Ring.maximal_ideal_ideal,\n       rule erH_rHom[of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; maximal_ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     Ring S; Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> pj S P \\<in> rHom S (S /\\<^sub>r P)", "apply (rule pj_Hom[of S P], assumption+,\n       simp add:Ring.maximal_ideal_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_add:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n                   p \\<in> carrier R; q \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n          erH R S X A B Y h (p \\<plusminus> q) =\n                 (erH R S X A B Y h p) \\<plusminus>\\<^bsub>A\\<^esub> (erH R S X A B Y h q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (p \\<plusminus> q) =\n                      erH R S X A B Y h p \\<plusminus>\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h q", "apply (frule erH_rHom[of A B Y h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     q \\<in> carrier R; erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (p \\<plusminus> q) =\n                      erH R S X A B Y h p \\<plusminus>\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h q", "apply (simp add:polyn_Hom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     q \\<in> carrier R; erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (p \\<plusminus> q) =\n                      erH R S X A B Y h p \\<plusminus>\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h q", "apply (simp add:rHom_add)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_minus:\"\\<lbrakk>Idomain S; PolynRg A B Y; \n       h \\<in> rHom S B; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n        erH R S X A B Y h (-\\<^sub>a p) = -\\<^sub>a\\<^bsub>A\\<^esub> (erH R S X A B Y h p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a p) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h p", "apply (frule erH_rHom[of A B Y h], assumption+,\n       simp add:polyn_Hom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a p) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h p", "apply (frule PolynRg.is_Ring[of A B Y])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y; Ring A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (-\\<^sub>a p) =\n                      -\\<^sub>a\\<^bsub>A\\<^esub> erH R S X A B Y h p", "apply (rule rHom_inv_inv[of R A p \"erH R S X A B Y h\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y; Ring A\\<rbrakk>\n    \\<Longrightarrow> Ring R\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y; Ring A\\<rbrakk>\n    \\<Longrightarrow> Ring A\n 3. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y; Ring A\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 4. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     erH R S X A B Y h \\<in> rHom R A;\n     erH R S X A B Y h ` carrier S \\<subseteq> carrier B;\n     erH R S X A B Y h X = Y; Ring A\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h \\<in> rHom R A", "apply (cut_tac is_Ring, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_mult:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n      p \\<in> carrier R; q \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n      erH R S X A B Y h (p \\<cdot>\\<^sub>r q) =\n                 (erH R S X A B Y h p) \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> (erH R S X A B Y h q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; p \\<in> carrier R;\n     q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (p \\<cdot>\\<^sub>r q) =\n                      erH R S X A B Y h p \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                      erH R S X A B Y h q", "apply (frule erH_rHom[of A B Y h], assumption+,\n       simp add:polyn_Hom_def, (erule conjE)+,\n       frule PolynRg.is_Ring[of A B Y],\n       cut_tac is_Ring,\n       rule rHom_tOp[of R A p q \"erH R S X A B Y h\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom_cf:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n                   s \\<in> carrier S\\<rbrakk>  \\<Longrightarrow> erH R S X A B Y h s = h s\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     s \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h s = h s", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.subring[of A B Y], \n       frule PolynRg.is_Ring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption,\n       frule mem_subring_mem_ring[of S s], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; s \\<in> carrier S;\n     Subring R S; Ring S; Subring A B; Ring A; Ring B;\n     s \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h s = h s", "apply (case_tac \"s = \\<zero>\\<^bsub>S\\<^esub>\", simp add:Subring_zero_ring_zero,\n       simp add:erH_rHom_0,\n       simp add:Subring_zero_ring_zero[THEN sym], \n       simp add:rHom_0_0, simp add:Ring.Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; s \\<in> carrier S;\n     Subring R S; Ring S; Subring A B; Ring A; Ring B; s \\<in> carrier R;\n     s \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h s = h s", "apply (frule s_cf_expr[of s],simp add:Subring_zero_ring_zero,\n       (erule conjE)+,\n       simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; s \\<in> carrier S;\n     Subring R S; Ring S; Subring A B; Ring A; Ring B; s \\<in> carrier R;\n     s \\<noteq> \\<zero>; pol_coeff S (s_cf R S X s);\n     s = polyn_expr R X (fst (s_cf R S X s)) (s_cf R S X s);\n     snd (s_cf R S X s) (fst (s_cf R S X s)) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h s = h s", "apply (frule s_cf_deg[of s], assumption+,\n       frule pol_of_deg0[of s], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; s \\<in> carrier S;\n     Subring R S; Ring S; Subring A B; Ring A; Ring B; s \\<in> carrier R;\n     s \\<noteq> \\<zero>; pol_coeff S (s_cf R S X s);\n     s = polyn_expr R X 0 (s_cf R S X s);\n     snd (s_cf R S X s) 0 \\<noteq> \\<zero>; deg_n R S X s = 0;\n     fst (s_cf R S X s) = 0\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h s = h s", "apply (subst erH_def, simp,\n       subst erh_rHom_coeff[of A B Y h \"s_cf R S X s\"], assumption+,\n       simp add:cmp_def polyn_expr_def,\n       frule_tac c = \"s_cf R S X s\" and j = 0 in pol_coeff_mem, simp,\n       frule mem_subring_mem_ring[of S \"snd (s_cf R S X s) 0\"], assumption+,\n       simp add:ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom_coeff:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       pol_coeff S (n, f)\\<rbrakk>  \\<Longrightarrow> pol_coeff B (n, cmp h f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     pol_coeff S (n, f)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff B (n, cmp h f)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     \\<forall>j\\<le>n. f j \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp h f j \\<in> carrier B", "apply (rule allI, rule impI, drule_tac a = j in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; j \\<le> n;\n        f j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> cmp h f j \\<in> carrier B", "apply (simp add:cmp_def rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom_unique:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n     \\<Longrightarrow>  \\<exists>!g. g \\<in> pHom R S X, A B Y \\<and> (\\<forall>x\\<in>carrier S. h x = g x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!g.\n                         g \\<in> pHom R S X, A B Y \\<and>\n                         (\\<forall>x\\<in>carrier S. h x = g x)", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac is_Ring,\n       frule PolynRg.subring[of A B Y], \n       frule PolynRg.is_Ring[of A B Y],\n       frule Ring.subring_Ring[of A B], assumption,\n       frule Idomain.idom_is_ring[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n     Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!g.\n                         g \\<in> pHom R S X, A B Y \\<and>\n                         (\\<forall>x\\<in>carrier S. h x = g x)", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n     Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g.\n                         g \\<in> pHom R S X, A B Y \\<and>\n                         (\\<forall>x\\<in>carrier S. h x = g x)\n 2. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = g x);\n        y \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = y x)\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (frule erH_rHom[of A B Y h], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n     Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g.\n                         g \\<in> pHom R S X, A B Y \\<and>\n                         (\\<forall>x\\<in>carrier S. h x = g x)\n 2. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = g x);\n        y \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = y x)\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (subgoal_tac \"\\<forall>x\\<in>carrier S. h x = (erH R S X A B Y h) x\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n     Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier S. h x = erH R S X A B Y h x\n 2. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = g x);\n        y \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = y x)\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule ballI, simp add:erH_rHom_cf, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y;\n        \\<forall>x\\<in>carrier S. h x = y x\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (frule pHom_rHom[of A B Y], assumption+,\n        frule pHom_rHom[of A B Y], assumption+,\n        frule_tac f = g in rHom_func[of _ R A],\n        frule_tac f = y in rHom_func[of _ R A])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = y x;\n        g \\<in> rHom R A; y \\<in> rHom R A;\n        g \\<in> carrier R \\<rightarrow> carrier A;\n        y \\<in> carrier R \\<rightarrow> carrier A\\<rbrakk>\n       \\<Longrightarrow> g = y", "apply (rule_tac f = g and g = y in funcset_eq[of _ \"carrier R\"],\n        simp add:rHom_def aHom_def, simp add:rHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = y x;\n        g \\<in> rHom R A; y \\<in> rHom R A;\n        g \\<in> carrier R \\<rightarrow> carrier A;\n        y \\<in> carrier R \\<rightarrow> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier R. g x = y x", "apply (rule ballI,\n        thin_tac \"g \\<in> carrier R \\<rightarrow> carrier A\",\n        thin_tac \"y \\<in> carrier R \\<rightarrow> carrier A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = y x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g x = y x", "apply (case_tac \"x = \\<zero>\\<^bsub>R\\<^esub>\", simp,\n        subst rHom_0_0[of R A], assumption+, rule sym, \n        subst rHom_0_0[of R A], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = y x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> g x = y x", "apply (subst pHom_pol_mem[of A B Y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring S; Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = y x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (deg_n R S X x)\n                          (cf_h g (s_cf R S X x)) =\n                         y x", "apply (frule_tac f = y and p = x in pHom_pol_mem[of A B Y], assumption+,\n        simp,\n        frule_tac f = g and c = \"s_cf R S X x\" in polyn_Hom_coeff_to_coeff,\n        assumption+, simp add:s_cf_pol_coeff,\n        frule_tac f = y and c = \"s_cf R S X x\" in polyn_Hom_coeff_to_coeff,\n        assumption+, simp add:s_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (deg_n R S X x) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (deg_n R S X x)\n                          (cf_h g (s_cf R S X x)) =\n                         polyn_expr A Y (deg_n R S X x)\n                          (cf_h y (s_cf R S X x))", "apply (simp add:s_cf_deg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h g (s_cf R S X x)) =\n                         polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h y (s_cf R S X x))", "apply (frule_tac f = g and c = \"s_cf R S X x\" in cf_h_len1[of A B Y h],\n         assumption+, rule ballI, rule sym, simp, rule s_cf_pol_coeff, \n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x));\n        fst (cf_h g (s_cf R S X x)) = fst (cf_h h (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h g (s_cf R S X x)) =\n                         polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h y (s_cf R S X x))", "apply (frule_tac f = y and c = \"s_cf R S X x\" in cf_h_len1[of A B Y h],\n         assumption+, rule ballI, rule sym, simp, rule s_cf_pol_coeff, \n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x));\n        fst (cf_h g (s_cf R S X x)) = fst (cf_h h (s_cf R S X x));\n        fst (cf_h y (s_cf R S X x)) = fst (cf_h h (s_cf R S X x))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h g (s_cf R S X x)) =\n                         polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h y (s_cf R S X x))", "apply (frule_tac c = \"cf_h g (s_cf R S X x)\" and d = \"cf_h y (s_cf R S X x)\"\n         in PolynRg.pol_expr_unique2[of A B Y], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x));\n        fst (cf_h g (s_cf R S X x)) = fst (cf_h h (s_cf R S X x));\n        fst (cf_h y (s_cf R S X x)) = fst (cf_h h (s_cf R S X x));\n        (polyn_expr A Y (fst (cf_h g (s_cf R S X x)))\n          (cf_h g (s_cf R S X x)) =\n         polyn_expr A Y (fst (cf_h y (s_cf R S X x)))\n          (cf_h y (s_cf R S X x))) =\n        (\\<forall>j\\<le>fst (cf_h g (s_cf R S X x)).\n            snd (cf_h g (s_cf R S X x)) j =\n            snd (cf_h y (s_cf R S X x)) j)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h g (s_cf R S X x)) =\n                         polyn_expr A Y (fst (s_cf R S X x))\n                          (cf_h y (s_cf R S X x))", "apply (frule_tac p = x in s_cf_pol_coeff, simp add:cf_h_len,\n        thin_tac \"(polyn_expr A Y (fst (s_cf R S X x)) (cf_h g (s_cf R S X x))\n         = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x))) =\n        (\\<forall>j\\<le>fst (s_cf R S X x).\n            snd (cf_h g (s_cf R S X x)) j = snd (cf_h y (s_cf R S X x)) j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x));\n        fst (cf_h g (s_cf R S X x)) = fst (s_cf R S X x);\n        fst (cf_h y (s_cf R S X x)) = fst (s_cf R S X x);\n        pol_coeff S (s_cf R S X x)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X x).\n                            snd (cf_h g (s_cf R S X x)) j =\n                            snd (cf_h y (s_cf R S X x)) j", "apply (rule allI, rule impI,\n        (subst cf_h_def)+, (subst cmp_def)+, simp,\n        frule_tac c = \"s_cf R S X x\" and j = j in pol_coeff_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g y x j.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; Subring R S;\n        Ring R; Subring A B; Ring A; Ring B; Ring S;\n        g \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. y x = g x;\n        y \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. h x = g x;\n        g \\<in> rHom R A; y \\<in> rHom R A; x \\<in> carrier R;\n        x \\<noteq> \\<zero>;\n        y x = polyn_expr A Y (fst (s_cf R S X x)) (cf_h y (s_cf R S X x));\n        pol_coeff B (cf_h g (s_cf R S X x));\n        pol_coeff B (cf_h y (s_cf R S X x));\n        fst (cf_h g (s_cf R S X x)) = fst (s_cf R S X x);\n        fst (cf_h y (s_cf R S X x)) = fst (s_cf R S X x);\n        pol_coeff S (s_cf R S X x); j \\<le> fst (s_cf R S X x);\n        snd (s_cf R S X x) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> g (snd (s_cf R S X x) j) = y (snd (s_cf R S X x) j)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_rHom_unique1:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       f \\<in> pHom R S X, A B Y; \\<forall>x \\<in> carrier S. f x = h x\\<rbrakk> \\<Longrightarrow> \n       f = (erH R S X A B Y h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     f \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. f x = h x\\<rbrakk>\n    \\<Longrightarrow> f = erH R S X A B Y h", "apply (frule erH_rHom_unique[of A B Y h], assumption+,\n       erule ex1E,\n       frule_tac x = f in spec,\n       drule_tac x = \"erH R S X A B Y h\" in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n        f \\<in> pHom R S X, A B Y; \\<forall>x\\<in>carrier S. f x = h x;\n        g \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = g x);\n        f \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S. h x = f x) \\<longrightarrow>\n        f = g;\n        erH R S X A B Y h \\<in> pHom R S X, A B Y \\<and>\n        (\\<forall>x\\<in>carrier S.\n            h x = erH R S X A B Y h x) \\<longrightarrow>\n        erH R S X A B Y h = g\\<rbrakk>\n       \\<Longrightarrow> f = erH R S X A B Y h", "apply (frule erH_rHom[of A B Y h], assumption+,\n        simp add:erH_rHom_cf[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_dec_deg:\"\\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; \n       p \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                  deg A B Y (f p) \\<le> deg R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y;\n     p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg A B Y (f p) \\<le> deg R S X p", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.subring[of A B Y],\n       cut_tac is_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R\\<rbrakk>\n    \\<Longrightarrow> deg A B Y (f p) \\<le> deg R S X p", "apply (frule PolynRg.is_Ring[of A B Y], \n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> deg A B Y (f p) \\<le> deg R S X p", "apply (case_tac \"f p = \\<zero>\\<^bsub>A\\<^esub>\",\n       case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\",\n       simp add:deg_def, simp add:deg_def an_def,\n       simp add:deg_def, subst ale_natle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       an (deg_n A B Y (f \\<zero>))\n                       \\<le> - \\<infinity>) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       deg_n A B Y (f p) \\<le> deg_n R S X p)", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\",\n       frule pHom_rHom[of A B Y f], assumption+,\n       rule conjI, rule impI, frule rHom_0_0[of R A f], assumption+,\n       simp, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (p = \\<zero> \\<longrightarrow>\n                       an (deg_n A B Y (f \\<zero>))\n                       \\<le> - \\<infinity>) \\<and>\n                      (p \\<noteq> \\<zero> \\<longrightarrow>\n                       deg_n A B Y (f p) \\<le> deg_n R S X p)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n A B Y (f p) \\<le> deg_n R S X p", "apply (frule pHom_pol_mem[of A B Y f p], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> deg_n A B Y (f p) \\<le> deg_n R S X p", "apply (cut_tac polyn_Hom_coeff_to_coeff[of A B Y f \"s_cf R S X p\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p));\n     pol_coeff B (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> deg_n A B Y (f p) \\<le> deg_n R S X p\n 2. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 3. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> f \\<in> pHom R S X, A B Y\n 4. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)", "apply (frule PolynRg.pol_deg_le_n[of A B Y \"f p\" \"cf_h f (s_cf R S X p)\"],\n        frule pHom_rHom[of A B Y f], assumption+,\n        rule rHom_mem[of f R A p], assumption+,\n        frule s_cf_pol_coeff[of p],\n        subst cf_h_len2[of A B Y f \"s_cf R S X p\"], assumption+,\n        simp add:s_cf_deg,\n       thin_tac \"f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     pol_coeff B (cf_h f (s_cf R S X p));\n     deg_n A B Y (f p) \\<le> fst (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> deg_n A B Y (f p) \\<le> deg_n R S X p\n 2. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> PolynRg A B Y\n 3. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> f \\<in> pHom R S X, A B Y\n 4. \\<lbrakk>PolynRg A B Y; f \\<in> pHom R S X, A B Y; p \\<in> carrier R;\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     f p \\<noteq> \\<zero>\\<^bsub>A\\<^esub>; p \\<noteq> \\<zero>;\n     f p = polyn_expr A Y (deg_n R S X p) (cf_h f (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (s_cf R S X p)", "apply (frule s_cf_pol_coeff[of p], simp add:cf_h_len2, \n              simp add:s_cf_deg[THEN sym],\n              assumption+,\n              simp add:s_cf_pol_coeff)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_map:\"\\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; \n       pol_coeff S (n, c)\\<rbrakk> \\<Longrightarrow> \n      (erH R S X A B Y h) (polyn_expr R X n (n, c)) = \n                           polyn_expr A Y n (n, (cmp h c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n     pol_coeff S (n, c)\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (cut_tac subring, frule subring_Ring,\n       frule PolynRg.subring[of A B Y],\n       cut_tac is_Ring,\n       frule PolynRg.is_Ring[of A B Y], \n       frule Ring.subring_Ring[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (case_tac \"polyn_expr R X n (n, c) = \\<zero>\\<^bsub>R\\<^esub>\", simp add:erH_rHom_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> =\n                      polyn_expr A Y n (n, cmp h c)\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (frule coeff_0_pol_0[THEN sym, of \"(n, c)\" n], simp, simp,\n        thin_tac \"polyn_expr R X n (n, c) = \\<zero>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     \\<forall>j\\<le>n. c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> =\n                      polyn_expr A Y n (n, cmp h c)\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (frule cf_h_coeff[of A B Y h \"(n, c)\"], assumption+,\n        simp add:cf_h_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     \\<forall>j\\<le>n. c j = \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (n, cmp h c)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> =\n                      polyn_expr A Y n (n, cmp h c)\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (rule sym, \n        frule_tac PolynRg.coeff_0_pol_0[THEN sym, of A B Y \"(n, cmp h c)\" n], \n        simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     \\<forall>j\\<le>n. c j = \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff B (n, cmp h c);\n     (polyn_expr A Y n (n, cmp h c) = \\<zero>\\<^bsub>A\\<^esub>) =\n     (\\<forall>j\\<le>n. cmp h c j = \\<zero>\\<^bsub>B\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp h c j = \\<zero>\\<^bsub>B\\<^esub>\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (rule allI, rule impI, simp add:cmp_def, simp add:rHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (frule erH_rHom[of A B Y h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X A B Y h (polyn_expr R X n (n, c)) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (subst pHom_mem[of A B Y \"erH R S X A B Y h\" n c], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y n (n, cmp (erH R S X A B Y h) c) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (frule PolynRg.pol_expr_unique2[of A B Y \n        \"(n, cmp (erH R S X A B Y h) c)\" \"(n, cmp h c)\"],\n       simp add:cmp_pol_coeff_e, simp add:cmp_pol_coeff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> fst (n, cmp (erH R S X A B Y h) c) = fst (n, cmp h c)\n 2. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y;\n     (polyn_expr A Y (fst (n, cmp (erH R S X A B Y h) c))\n       (n, cmp (erH R S X A B Y h) c) =\n      polyn_expr A Y (fst (n, cmp h c)) (n, cmp h c)) =\n     (\\<forall>j\\<le>fst (n, cmp (erH R S X A B Y h) c).\n         snd (n, cmp (erH R S X A B Y h) c) j = snd (n, cmp h c) j)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr A Y n (n, cmp (erH R S X A B Y h) c) =\n                      polyn_expr A Y n (n, cmp h c)", "apply (simp, simp,\n        thin_tac \"(polyn_expr A Y n (n, cmp (erH R S X A B Y h) c) =\n        polyn_expr A Y n (n, cmp h c)) =\n       (\\<forall>j\\<le>n. cmp (erH R S X A B Y h) c j = cmp h c j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B; pol_coeff S (n, c);\n     Subring R S; Ring S; Subring A B; Ring R; Ring A; Ring B;\n     polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n     erH R S X A B Y h \\<in> pHom R S X, A B Y\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (erH R S X A B Y h) c j = cmp h c j", "apply (rule allI, rule impI,\n        frule_tac j = j in pol_coeff_mem[of \"(n, c)\"], simp,\n        simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>Idomain S; PolynRg A B Y; h \\<in> rHom S B;\n        pol_coeff S (n, c); Subring R S; Ring S; Subring A B; Ring R;\n        Ring A; Ring B; polyn_expr R X n (n, c) \\<noteq> \\<zero>;\n        erH R S X A B Y h \\<in> pHom R S X, A B Y; j \\<le> n;\n        c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> erH R S X A B Y h (c j) = h (c j)", "apply (simp add:erH_rHom_cf)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Relatively prime polynomials\""], ["", "definition\n  rel_prime_pols :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a,\n         'a, 'a ] \\<Rightarrow> bool\" where\n  \"rel_prime_pols R S X p q \\<longleftrightarrow> (1\\<^sub>r\\<^bsub>R\\<^esub>) \\<in> ((Rxa R p) \\<minusplus>\\<^bsub>R\\<^esub> (Rxa R q))\""], ["", "definition\n  div_condn :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, nat, \n                'a, 'a ] \\<Rightarrow> bool\" where\n  \"div_condn R S X n g f \\<longleftrightarrow> f \\<in> carrier R \\<and> n = deg_n R S X f \\<longrightarrow>\n   (\\<exists>q.  q \\<in> carrier R \\<and> ((f \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (q \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> g)) = \\<zero>\\<^bsub>R\\<^esub>) \\<or> (deg_n R S X \n    (f \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (q \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> g))) < deg_n R S X g)))\""], ["", "lemma (in PolynRg) divisionTr0:\"\\<lbrakk>Idomain S; p \\<in> carrier R; \n       c \\<in> carrier S; c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> \n                     lcf R S X (c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) = c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (lcf R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> lcf R S X\n                       (c \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                        p) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X p", "apply (cut_tac polyn_ring_integral, simp,\n       cut_tac subring, frule subring_Ring,\n       cut_tac polyn_ring_X_nonzero,\n       cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> lcf R S X\n                       (c \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                        p) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X p", "apply (frule mem_subring_mem_ring[of S c], assumption+,\n      frule npClose[of X n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> lcf R S X\n                       (c \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                        p) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X p", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp,\n       frule ring_tOp_closed[of c \"X^\\<^bsup>R n\\<^esup>\"], assumption+,\n       simp add:ring_times_x_0 lcf_val_0,\n       simp add:Ring.ring_times_x_0[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> lcf R S X\n                       (c \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                        p) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X p", "apply (frule_tac x = c and y = \" X^\\<^bsup>R n\\<^esup>\" in Idomain.idom_tOp_nonzeros[of R],\n      assumption+,\n      simp add:Subring_zero_ring_zero,\n      frule Idomain.idom_potent_nonzero[of R X n], assumption+,\n      frule_tac x = c and y = \" X^\\<^bsup>R n\\<^esup>\" in ring_tOp_closed, assumption+,\n      frule_tac x = \"c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup>\" and y = p in Idomain.idom_tOp_nonzeros[of R],\n      assumption+,\n      frule_tac x = \"c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup>\" and y = p in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> lcf R S X\n                       (c \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                        p) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X p", "apply (simp add:lcf_val)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                             p))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                               p))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+,\n       simp add:ring_tOp_assoc[of c _ p],\n       frule low_deg_terms_zero1[THEN sym, of \"s_cf R S X p\" n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (ext_cf S n (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (cut_tac a = \"X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r \n                    polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\" and \n               b = \"X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p\" and \n               c = \"polyn_expr R X (fst (s_cf R S X p) + n) \n                     (ext_cf S n (s_cf R S X p))\" in box_equation,\n       simp, assumption,\n   thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n   thin_tac \"X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) =\n     polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (ext_cf S n (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (frule ext_cf_pol_coeff[of \"s_cf R S X p\" n],\n       frule scalar_times_pol_expr[of c \"ext_cf S n (s_cf R S X p)\" \n            \"fst (s_cf R S X p) + n\"], assumption+,\n       simp add:ext_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p =\n     polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p));\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     c \\<cdot>\\<^sub>r\n     polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p)) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)))\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (frule sp_cf_pol_coeff[of \"ext_cf S n (s_cf R S X p)\" c],\n          assumption+,\n     cut_tac a = \"c \\<cdot>\\<^sub>r\n     polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p))\"\n     and b = \"c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\" and \n         c = \"polyn_expr R X (fst (s_cf R S X p) + n)\n              (sp_cf S c (ext_cf S n (s_cf R S X p)))\" in box_equation,\n     simp, simp,\n     thin_tac \"X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p =\n        polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p))\",\n     thin_tac \"c \\<cdot>\\<^sub>r\n        polyn_expr R X (fst (s_cf R S X p) + n) (ext_cf S n (s_cf R S X p)) =\n        polyn_expr R X (fst (s_cf R S X p) + n)\n        (sp_cf S c (ext_cf S n (s_cf R S X p)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)))\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (frule s_cf_expr[of \"c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\"], assumption+,\n         (erule conjE)+,\n         drule_tac a = \"c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\" and \n         b = \"polyn_expr R X (fst (s_cf R S X (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))))\n                       (s_cf R S X (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\" and \n         c = \"polyn_expr R X (fst (s_cf R S X p) + n)\n             (sp_cf S c (ext_cf S n (s_cf R S X p)))\" in box_equation,\n       assumption,\n       thin_tac \"c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) =\n          polyn_expr R X (fst (s_cf R S X p) + n)\n          (sp_cf S c (ext_cf S n (s_cf R S X p)))\",\n       frule pol_expr_unique2[of \"s_cf R S X (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\" \n               \"sp_cf S c (ext_cf S n (s_cf R S X p))\"], assumption+,\n       subst s_cf_deg[THEN sym], assumption+,\n        frule_tac Idomain.idom_potent_nonzero[of R X n], assumption+,\n        frule_tac x = \"X^\\<^bsup>R n\\<^esup>\" and y = p in Idomain.idom_tOp_nonzeros[of R],\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r\n              (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (c \\<cdot>\\<^sub>r\n                        (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) =\n                      fst (sp_cf S c (ext_cf S n (s_cf R S X p)))\n 2. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r\n              (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X\n       (fst (s_cf R S X\n              (c \\<cdot>\\<^sub>r\n               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))))\n       (s_cf R S X\n         (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n      polyn_expr R X (fst (sp_cf S c (ext_cf S n (s_cf R S X p))))\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>fst (s_cf R S X\n                           (c \\<cdot>\\<^sub>r\n                            (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j)\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (subst deg_mult_pols, assumption+, simp add:Subring_zero_ring_zero,\n        simp add:ring_tOp_closed, assumption+,\n        subst deg_mult_pols, assumption+,\n        simp add:deg_to_X_d,\n        cut_tac pol_of_deg0[THEN sym, of c], simp,\n        simp add:sp_cf_len ext_cf_len s_cf_deg, assumption+,\n        simp add:Subring_zero_ring_zero,\n        simp add:sp_cf_len ext_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r\n              (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (fst (s_cf R S X\n             (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (fst (s_cf R S X p) + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (fst (s_cf R S X p) + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + fst (s_cf R S X p))\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>fst (s_cf R S X\n                           (c \\<cdot>\\<^sub>r\n                            (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j)\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (fst (s_cf R S X\n                              (c \\<cdot>\\<^sub>r\n                               (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                                p)))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (fst (s_cf R S X p))", "apply (subst s_cf_deg[THEN sym], assumption+,\n        frule_tac Idomain.idom_potent_nonzero[of R X n], assumption+,\n        frule_tac x = \"X^\\<^bsup>R n\\<^esup>\" and y = p in Idomain.idom_tOp_nonzeros[of R],\n        assumption+,\n        simp add:s_cf_deg[THEN sym],\n        frule_tac x = \"X^\\<^bsup>R n\\<^esup>\" and y = p in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X\n        (c \\<cdot>\\<^sub>r\n         (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X\n                      (c \\<cdot>\\<^sub>r\n                       (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X\n                            (c \\<cdot>\\<^sub>r\n                             (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n                       (deg_n R S X\n                         (c \\<cdot>\\<^sub>r\n                          (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (deg_n R S X p)", "apply (frule deg_mult_pols[of c \"X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p\"], assumption+,\n        simp add:Subring_zero_ring_zero, assumption+, (erule conjE)+, simp,\n        thin_tac \"deg_n R S X (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) =\n                          deg_n R S X c + deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\",\n        cut_tac pol_of_deg0[THEN sym, of c], simp,\n        frule deg_mult_pols[of \"X^\\<^bsup>R n\\<^esup>\" p], assumption+, (erule conjE)+,\n             simp,\n      thin_tac \"deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) = deg_n R S X (X^\\<^bsup>R n\\<^esup>) + deg_n R S X p\",\n      simp add:deg_to_X_d, simp add:add.commute[of n],\n      thin_tac \"polyn_expr R X (deg_n R S X p + n) \n          (s_cf R S X (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) = polyn_expr R X (deg_n R S X p + n)\n                                      (sp_cf S c (ext_cf S n (s_cf R S X p)))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; deg_n R S X c = 0;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (sp_cf S c (ext_cf S n (s_cf R S X p)))\n      (deg_n R S X p + n) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>deg_n R S X p + n.\n        snd (s_cf R S X\n              (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n         j =\n        snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j;\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<in> carrier S;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> snd (sp_cf S c (ext_cf S n (s_cf R S X p)))\n                       (deg_n R S X p + n) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (deg_n R S X p)\n 2. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X c +\n                     deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<in> carrier R\n 3. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X c +\n                     deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<noteq> \\<zero>", "apply (subst sp_cf_def, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; deg_n R S X c = 0;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (sp_cf S c (ext_cf S n (s_cf R S X p)))\n      (deg_n R S X p + n) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>deg_n R S X p + n.\n        snd (s_cf R S X\n              (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n         j =\n        snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j;\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>;\n     c \\<in> carrier S;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (ext_cf S n (s_cf R S X p)) (deg_n R S X p + n) =\n                      c \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      snd (s_cf R S X p) (deg_n R S X p)\n 2. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X c +\n                     deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<in> carrier R\n 3. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X c +\n                     deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<noteq> \\<zero>", "apply (subst ext_cf_def, simp add:sliden_def, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain R; p \\<in> carrier R; c \\<in> carrier S;\n     c \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; Idomain S; Subring R S; Ring S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; c \\<in> carrier R;\n     X^\\<^bsup>R n\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)\n     \\<in> carrier R;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S n (s_cf R S X p));\n     pol_coeff S (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     pol_coeff S\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)));\n     snd (s_cf R S X\n           (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X\n      (deg_n R S X c +\n       deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))\n      (s_cf R S X\n        (c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p))) =\n     polyn_expr R X (deg_n R S X p + n)\n      (sp_cf S c (ext_cf S n (s_cf R S X p)));\n     (polyn_expr R X (deg_n R S X p + n)\n       (sp_cf S c (ext_cf S n (s_cf R S X p))) =\n      polyn_expr R X (n + deg_n R S X p)\n       (sp_cf S c (ext_cf S n (s_cf R S X p)))) =\n     (\\<forall>j\\<le>deg_n R S X c +\n                     deg_n R S X (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p).\n         snd (s_cf R S X\n               (c \\<cdot>\\<^sub>r\n                (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p)))\n          j =\n         snd (sp_cf S c (ext_cf S n (s_cf R S X p))) j);\n     X^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<noteq> \\<zero>;\n     X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p \\<in> carrier R;\n     c \\<cdot>\\<^sub>r (X^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r p) \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c \\<noteq> \\<zero>", "apply (simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) divisionTr1:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n      0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f\\<rbrakk>\n      \\<Longrightarrow> \n      f \\<plusminus> -\\<^sub>a ((lcf R S X f) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((lcf R S X g)\\<^bsup>\\<hyphen> S\\<^esup>) \\<cdot>\\<^sub>r \n                     (X^\\<^bsup>R ((deg_n R S X f) - (deg_n R S X g))\\<^esup>) \\<cdot>\\<^sub>r g) = \\<zero> \\<or> \n      deg_n R S X (f \\<plusminus> -\\<^sub>a ((lcf R S X f) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((lcf R S X g)\\<^bsup>\\<hyphen> S\\<^esup>) \\<cdot>\\<^sub>r \n                 (X^\\<^bsup>R ((deg_n R S X f) - (deg_n R S X g))\\<^esup>) \\<cdot>\\<^sub>r g)) < deg_n R S X f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (deg_n R S X f -\n       deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (deg_n R S X f -\n         deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < deg_n R S X f", "apply (cut_tac ring_is_ag,\n       cut_tac subring, \n       frule Corps.field_is_idom[of \"S\"],\n       frule subring_Ring,\n       cut_tac subring,\n       cut_tac polyn_ring_X_nonzero,\n       cut_tac X_mem_R,\n       cut_tac polyn_ring_integral, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f; aGroup R; Idomain R; Ring S;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (deg_n R S X f -\n       deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (deg_n R S X f -\n         deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < deg_n R S X f", "apply (frule npClose[of X \"deg_n R S X f - deg_n R S X g\"],\n       frule_tac Idomain.idom_potent_nonzero[of R X \n                \"fst (s_cf R S X f) - fst (s_cf R S X g)\"], assumption+,\n       frule s_cf_expr[of f], assumption+, (erule conjE)+,\n       frule s_cf_expr[of g], assumption+, (erule conjE)+,\n       simp add:s_cf_deg, simp add:lcf_val[THEN sym],\n       frule Corps.invf_closed1[of S \"lcf R S X g\"], simp, simp add:lcf_mem,\n       frule lcf_mem[of f], simp,\n       frule subring_Ring, frule Ring.ring_is_ag[of S], (erule conjE)+,\n       frule_tac x = \"lcf R S X f\" and y = \"lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" in \n                 Ring.ring_tOp_closed[of S], assumption+,\n       frule mem_subring_mem_ring[of S \" lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \"],\n         assumption+,\n       frule_tac x = \"lcf R S X f\" and y = \"lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" in \n         Idomain.idom_tOp_nonzeros[of S], assumption+,\n       simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply(frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" and \n       y = \"X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\" in \n      Idomain.idom_tOp_nonzeros[of R], assumption+,\n      frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" and \n       y = \"X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\" in ring_tOp_closed, \n      assumption+,\n      frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r \n       X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\" and y = g in \n        Idomain.idom_tOp_nonzeros[of R], assumption+,\n      frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r \n       X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\" and y = g in ring_tOp_closed,\n      assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (frule pol_diff_deg_less[of f \"s_cf R S X f\" \n       \"s_cf R S X (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r \n                 X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r g)\"], assumption+,\n       simp add:s_cf_pol_coeff)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R S X f) =\n                      fst (s_cf R S X\n                            (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             lcf R S X\n                              g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R (fst (s_cf R S X f) -\n    fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                             g))\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X f) (fst (s_cf R S X f)) =\n                      snd (s_cf R S X\n                            (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             lcf R S X\n                              g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R (fst (s_cf R S X f) -\n    fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                             g))\n                       (fst (s_cf R S X\n                              (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                               lcf R S X\n                                g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R (fst (s_cf R S X f) -\n      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                               g)))\n 3. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f)\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (simp add:s_cf_deg[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f; aGroup R; Idomain R; Subring R S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (deg_n R S X f) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (deg_n R S X g) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X f =\n                      deg_n R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (deg_n R S X f -\n                                     deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                        g)\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X f) (fst (s_cf R S X f)) =\n                      snd (s_cf R S X\n                            (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             lcf R S X\n                              g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R (fst (s_cf R S X f) -\n    fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                             g))\n                       (fst (s_cf R S X\n                              (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                               lcf R S X\n                                g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R (fst (s_cf R S X f) -\n      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                               g)))\n 3. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f)\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (frule deg_mult_pols[of \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (lcf R S X g)\\<^bsup>\\<hyphen> S\\<^esup>\" \n                   \"(X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> )\\<cdot>\\<^sub>r g\"], assumption+,\n          rule ring_tOp_closed, assumption+,\n          rule Idomain.idom_tOp_nonzeros[of R], assumption+,\n          (erule conjE)+, \n          subst ring_tOp_assoc[of \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" _ g],\n                 assumption+, simp,\n          cut_tac pol_of_deg0[THEN sym, of \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\"], \n          simp,\n          thin_tac \"deg_n R S X (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n              (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g)) =\n               deg_n R S X (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g)\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f; aGroup R; Idomain R; Subring R S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (deg_n R S X f) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (deg_n R S X g) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     deg_n R S X\n      (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n       lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>) =\n     0;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n      g) \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X f =\n                      deg_n R S X\n                       (X^\\<^bsup>R (deg_n R S X f -\n                                     deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                        g)\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f; aGroup R; Idomain R; Subring R S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (deg_n R S X f) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (deg_n R S X g) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n      g) \\<noteq>\n     \\<zero>;\n     deg_n R S X\n      (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n       lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n       (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g)) =\n     deg_n R S X\n      (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n       lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>) +\n     deg_n R S X\n      (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n       g)\\<rbrakk>\n    \\<Longrightarrow> lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n                      \\<in> carrier R\n 3. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; f \\<noteq> \\<zero>;\n     deg_n R S X g \\<le> deg_n R S X f; aGroup R; Idomain R; Subring R S;\n     X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (deg_n R S X f) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (deg_n R S X g) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n      g) \\<noteq>\n     \\<zero>;\n     deg_n R S X\n      (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n       lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n       (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g)) =\n     deg_n R S X\n      (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n       lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>) +\n     deg_n R S X\n      (X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n       g)\\<rbrakk>\n    \\<Longrightarrow> lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n                      \\<zero>\n 4. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd (s_cf R S X f) (fst (s_cf R S X f)) =\n                      snd (s_cf R S X\n                            (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             lcf R S X\n                              g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R (fst (s_cf R S X f) -\n    fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                             g))\n                       (fst (s_cf R S X\n                              (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                               lcf R S X\n                                g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R (fst (s_cf R S X f) -\n      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                               g)))\n 5. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f)\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (frule deg_mult_pols[of \"(X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> )\" g], \n          assumption+, simp,\n          simp add:deg_to_X_d, assumption+,\n          fold lcf_def,\n          subst divisionTr0[of g \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" \n                        \"fst (s_cf R S X f) - fst (s_cf R S X g)\"],\n          assumption+, simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> lcf R S X f =\n                      lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      lcf R S X\n                       g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      lcf R S X g\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f)\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (subst Ring.ring_tOp_assoc, assumption+, simp add:lcf_mem,\n          frule Corps.invf_inv[of S \"lcf R S X g\"], simp add:lcf_mem,\n          simp add:Subring_zero_ring_zero, simp add:Ring.ring_r_one,\n          frule s_cf_expr[of \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n               X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r g\"],\n          rule  Idomain.idom_tOp_nonzeros[of R], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f);\n     pol_coeff S\n      (s_cf R S X\n        (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n         lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n         X^\\<^bsup>R (fst (s_cf R S X f) -\n                      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n         g)) \\<and>\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g =\n     polyn_expr R X\n      (fst (s_cf R S X\n             (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n              lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n              X^\\<^bsup>R (fst (s_cf R S X f) -\n                           fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n              g)))\n      (s_cf R S X\n        (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n         lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n         X^\\<^bsup>R (fst (s_cf R S X f) -\n                      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n         g)) \\<and>\n     snd (s_cf R S X\n           (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n            lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n            X^\\<^bsup>R (fst (s_cf R S X f) -\n                         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n            g))\n      (fst (s_cf R S X\n             (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n              lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n              X^\\<^bsup>R (fst (s_cf R S X f) -\n                           fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n              g))) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply ((erule conjE)+,\n        thin_tac \"snd (s_cf R S X\n           (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n            X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r  g))\n           (fst (s_cf R S X (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n              X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r g))) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < fst (s_cf R S X g); f \\<in> carrier R; f \\<noteq> \\<zero>;\n     fst (s_cf R S X g) \\<le> fst (s_cf R S X f); aGroup R; Idomain R;\n     Subring R S; X \\<noteq> \\<zero>; X \\<in> carrier R; Idomain S;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     pol_coeff S (s_cf R S X f);\n     f = polyn_expr R X (fst (s_cf R S X f)) (s_cf R S X f);\n     lcf R S X f \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     lcf R S X g \\<noteq> \\<zero>; lcf R S X f \\<in> carrier S; Ring S;\n     aGroup S; lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq> \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier S;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup> \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) - fst (s_cf R S X g))\\<^esup>\n     \\<in> carrier R;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g \\<noteq>\n     \\<zero>;\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g\n     \\<in> carrier R;\n     f \\<plusminus>\n     -\\<^sub>a polyn_expr R X\n                (fst (s_cf R S X\n                       (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (fst (s_cf R S X f) -\n                                     fst\n(s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                        g)))\n                (s_cf R S X\n                  (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (fst (s_cf R S X f) -\n                                fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                   g)) =\n     \\<zero> \\<or>\n     deg_n R S X\n      (f \\<plusminus>\n       -\\<^sub>a polyn_expr R X\n                  (fst (s_cf R S X\n                         (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                          lcf R S X\n                           g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R (fst (s_cf R S X f) -\n fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                          g)))\n                  (s_cf R S X\n                    (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (fst (s_cf R S X f) -\n                                  fst (s_cf R S X\n  g))\\<^esup> \\<cdot>\\<^sub>r\n                     g)))\n     < fst (s_cf R S X f);\n     pol_coeff S\n      (s_cf R S X\n        (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n         lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n         X^\\<^bsup>R (fst (s_cf R S X f) -\n                      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n         g));\n     lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n     X^\\<^bsup>R (fst (s_cf R S X f) -\n                  fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n     g =\n     polyn_expr R X\n      (fst (s_cf R S X\n             (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n              lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n              X^\\<^bsup>R (fst (s_cf R S X f) -\n                           fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n              g)))\n      (s_cf R S X\n        (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n         lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n         X^\\<^bsup>R (fst (s_cf R S X f) -\n                      fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n         g))\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus>\n                      -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                lcf R S X\n                                 g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R (fst (s_cf R S X f) -\n       fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                g =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (f \\<plusminus>\n                        -\\<^sub>a lcf R S X\n                                   f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                  lcf R S X\n                                   g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                                  X^\\<^bsup>R (fst (s_cf R S X f) -\n         fst (s_cf R S X g))\\<^esup> \\<cdot>\\<^sub>r\n                                  g)\n                      < fst (s_cf R S X f)", "apply (rotate_tac -1, drule sym, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) divisionTr2:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n                   0 < deg_n R S X g\\<rbrakk>  \\<Longrightarrow>  \\<forall>f. div_condn R S X n g f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f. div_condn R S X n g f", "apply (cut_tac ring_is_ag,\n       frule Corps.field_is_idom[of \"S\"],\n       cut_tac subring, frule subring_Ring,\n       cut_tac polyn_ring_integral, simp,\n       cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S; Idomain S;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f. div_condn R S X n g f", "apply (rule nat_less_induct)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f. div_condn R S X n g f", "apply (rule allI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f\\<rbrakk>\n       \\<Longrightarrow> div_condn R S X n g f", "apply (subst div_condn_def, rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (case_tac \"f = \\<zero>\\<^bsub>R\\<^esub>\",\n       cut_tac ring_zero,\n       subgoal_tac \" f \\<plusminus> -\\<^sub>a (\\<zero> \\<cdot>\\<^sub>r g) = \\<zero>\",\n       blast,\n       simp add:ring_times_0_x, simp add:aGroup.ag_inv_zero[of \"R\"],\n       simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (case_tac \"n < deg_n R S X g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; n < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)\n 2. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>;\n        \\<not> n < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (cut_tac ring_zero,\n        subgoal_tac \"deg_n R S X (f \\<plusminus> -\\<^sub>a (\\<zero> \\<cdot>\\<^sub>r g)) < deg_n R S X g\", \n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; n < deg_n R S X g;\n        \\<zero> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> deg_n R S X\n                          (f \\<plusminus>\n                           -\\<^sub>a \\<zero> \\<cdot>\\<^sub>r g)\n                         < deg_n R S X g\n 2. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>;\n        \\<not> n < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply ( \n       simp add:ring_times_0_x, simp add:aGroup.ag_inv_zero,\n       simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>;\n        \\<not> n < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = n and y = \"deg_n R S X g\" in leI,\n       thin_tac \"\\<not> n < deg_n R S X g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>;\n        deg_n R S X g \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "(** deg_n R S X g \\<le> deg_n R S X f **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>;\n        deg_n R S X g \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac f = f in divisionTr1[of g], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac p = f in lcf_mem,\n       frule lcf_mem[of g],\n       frule lcf_nonzero[of g], assumption+,\n       frule Corps.invf_closed1[of S \"lcf R S X g\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = \"lcf R S X f\" and y = \"lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" in \n                 Ring.ring_tOp_closed[of S], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>};\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" in mem_subring_mem_ring,\n        assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>};\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac n = \"deg_n R S X f - deg_n R S X g\" in npClose[of X],\n        frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\" and \n                  y = \"X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\" in \n                  ring_tOp_closed, assumption+,\n        frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r \n                       X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\"  and \n                  y = g in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>};\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (erule disjE, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R;\n        \\<forall>m<n. \\<forall>f. div_condn R S X m g f; f \\<in> carrier R;\n        n = deg_n R S X f; f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>};\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (drule_tac a = \"deg_n R S X (f \\<plusminus> -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> \n          lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g))\" in\n          forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> n;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S - {\\<zero>\\<^bsub>S\\<^esub>};\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        \\<forall>fa.\n           div_condn R S X\n            (deg_n R S X\n              (f \\<plusminus>\n               -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         lcf R S X\n                          g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R (deg_n R S X f -\ndeg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                         g))\n            g fa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (simp add:div_condn_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S \\<and>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        \\<forall>fa.\n           fa \\<in> carrier R \\<and>\n           deg_n R S X\n            (f \\<plusminus>\n             -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                       lcf R S X\n                        g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                       X^\\<^bsup>R (deg_n R S X f -\n                                    deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                       g) =\n           deg_n R S X fa \\<longrightarrow>\n           (\\<exists>q.\n               q \\<in> carrier R \\<and>\n               (fa \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                \\<zero> \\<or>\n                deg_n R S X (fa \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                < deg_n R S X g))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (drule_tac x = \"f \\<plusminus>\n             -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                 X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                 g)\" in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S \\<and>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R \\<and>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g) =\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g) \\<longrightarrow>\n        (\\<exists>q.\n            q \\<in> carrier R \\<and>\n            (f \\<plusminus>\n             -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                       lcf R S X\n                        g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                       X^\\<^bsup>R (deg_n R S X f -\n                                    deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                       g \\<plusminus>\n             -\\<^sub>a q \\<cdot>\\<^sub>r g =\n             \\<zero> \\<or>\n             deg_n R S X\n              (f \\<plusminus>\n               -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         lcf R S X\n                          g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R (deg_n R S X f -\ndeg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                         g \\<plusminus>\n               -\\<^sub>a q \\<cdot>\\<^sub>r g)\n             < deg_n R S X g))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n           X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g\" in aGroup.ag_mOp_closed,\n           assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S \\<and>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X f;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R \\<and>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g) =\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                    lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                    X^\\<^bsup>R (deg_n R S X f -\n                                 deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                    g) \\<longrightarrow>\n        (\\<exists>q.\n            q \\<in> carrier R \\<and>\n            (f \\<plusminus>\n             -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                       lcf R S X\n                        g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                       X^\\<^bsup>R (deg_n R S X f -\n                                    deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                       g \\<plusminus>\n             -\\<^sub>a q \\<cdot>\\<^sub>r g =\n             \\<zero> \\<or>\n             deg_n R S X\n              (f \\<plusminus>\n               -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         lcf R S X\n                          g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R (deg_n R S X f -\ndeg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                         g \\<plusminus>\n               -\\<^sub>a q \\<cdot>\\<^sub>r g)\n             < deg_n R S X g));\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = f and y = \"-\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n               X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g)\" in \n        aGroup.ag_pOp_closed, assumption+, simp,\n        thin_tac \"deg_n R S X (f \\<plusminus>  -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                 X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g)) < deg_n R S X f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S \\<and>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        \\<exists>q.\n           q \\<in> carrier R \\<and>\n           (f \\<plusminus>\n            -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                      lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R (deg_n R S X f -\n                                   deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                      g \\<plusminus>\n            -\\<^sub>a q \\<cdot>\\<^sub>r g =\n            \\<zero> \\<or>\n            deg_n R S X\n             (f \\<plusminus>\n              -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                        lcf R S X\n                         g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                        X^\\<^bsup>R (deg_n R S X f -\n                                     deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                        g \\<plusminus>\n              -\\<^sub>a q \\<cdot>\\<^sub>r g)\n            < deg_n R S X g);\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        f \\<plusminus>\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (erule exE,\n        thin_tac \"f \\<plusminus> -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n            X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r g) \\<in> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S \\<and>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        q \\<in> carrier R \\<and>\n        (f \\<plusminus>\n         -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (deg_n R S X f -\n                                deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                   g \\<plusminus>\n         -\\<^sub>a q \\<cdot>\\<^sub>r g =\n         \\<zero> \\<or>\n         deg_n R S X\n          (f \\<plusminus>\n           -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (deg_n R S X f -\n                                  deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                     g \\<plusminus>\n           -\\<^sub>a q \\<cdot>\\<^sub>r g)\n         < deg_n R S X g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply ((erule conjE)+,\n        frule_tac x = q and y = g in ring_tOp_closed, assumption+,\n        frule_tac x = \"q \\<cdot>\\<^sub>r g\" in aGroup.ag_mOp_closed, assumption+,\n        simp add:aGroup.ag_pOp_assoc,\n        simp add:aGroup.ag_p_inv[THEN sym],\n        simp add:ring_distrib2[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q \\<in> carrier R;\n        f \\<plusminus>\n        -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (deg_n R S X f -\n                                deg_n R S X g)\\<^esup> \\<plusminus>\n                   q) \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (deg_n R S X f -\n                                  deg_n R S X g)\\<^esup> \\<plusminus>\n                     q) \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X g;\n        q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        -\\<^sub>a q \\<cdot>\\<^sub>r g \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (frule_tac x = \"lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n         X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\" and y = q in \n                          aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q \\<in> carrier R;\n        f \\<plusminus>\n        -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (deg_n R S X f -\n                                deg_n R S X g)\\<^esup> \\<plusminus>\n                   q) \\<cdot>\\<^sub>r\n                  g =\n        \\<zero> \\<or>\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (deg_n R S X f -\n                                  deg_n R S X g)\\<^esup> \\<plusminus>\n                     q) \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X g;\n        q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        -\\<^sub>a q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<plusminus>\n        q\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        -\\<^sub>a q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<plusminus>\n        q\n        \\<in> carrier R;\n        f \\<plusminus>\n        -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                   lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                   X^\\<^bsup>R (deg_n R S X f -\n                                deg_n R S X g)\\<^esup> \\<plusminus>\n                   q) \\<cdot>\\<^sub>r\n                  g =\n        \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)\n 2. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        -\\<^sub>a q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<plusminus>\n        q\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (deg_n R S X f -\n                                  deg_n R S X g)\\<^esup> \\<plusminus>\n                     q) \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; aGroup R; Idomain R; Subring R S; Ring S;\n        Idomain S; X \\<in> carrier R; f \\<in> carrier R; n = deg_n R S X f;\n        f \\<noteq> \\<zero>; deg_n R S X g \\<le> deg_n R S X f;\n        lcf R S X f \\<in> carrier S; lcf R S X g \\<in> carrier S;\n        lcf R S X g \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier S;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup>\n        \\<in> carrier R;\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup>\n        \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n        g\n        \\<in> carrier R;\n        -\\<^sub>a lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                  lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R (deg_n R S X f -\n                               deg_n R S X g)\\<^esup> \\<cdot>\\<^sub>r\n                  g\n        \\<in> carrier R;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<in> carrier S;\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        -\\<^sub>a q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n        X^\\<^bsup>R (deg_n R S X f - deg_n R S X g)\\<^esup> \\<plusminus>\n        q\n        \\<in> carrier R;\n        deg_n R S X\n         (f \\<plusminus>\n          -\\<^sub>a (lcf R S X f \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                     lcf R S X g\\<^bsup>\\<hyphen> S\\<^esup> \\<cdot>\\<^sub>r\n                     X^\\<^bsup>R (deg_n R S X f -\n                                  deg_n R S X g)\\<^esup> \\<plusminus>\n                     q) \\<cdot>\\<^sub>r\n                    g)\n        < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q.\n                            q \\<in> carrier R \\<and>\n                            (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                             \\<zero> \\<or>\n                             deg_n R S X\n                              (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                             < deg_n R S X g)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) divisionTr3:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n      0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n     \\<exists>q\\<in>carrier R. (f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r  g) = \\<zero>) \\<or> ( f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g) \\<noteq> \\<zero> \\<and>\n      deg_n R S X (f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g)) < (deg_n R S X g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                         \\<zero> \\<or>\n                         f \\<plusminus>\n                         -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq>\n                         \\<zero> \\<and>\n                         deg_n R S X\n                          (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                         < deg_n R S X g", "apply (frule divisionTr2[of g \"deg_n R S X f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R;\n     \\<forall>fa. div_condn R S X (deg_n R S X f) g fa\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                         \\<zero> \\<or>\n                         f \\<plusminus>\n                         -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq>\n                         \\<zero> \\<and>\n                         deg_n R S X\n                          (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                         < deg_n R S X g", "apply (drule_tac x = f in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R;\n     div_condn R S X (deg_n R S X f) g f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g =\n                         \\<zero> \\<or>\n                         f \\<plusminus>\n                         -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq>\n                         \\<zero> \\<and>\n                         deg_n R S X\n                          (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n                         < deg_n R S X g", "apply (simp add:div_condn_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) divisionTr4:\"\\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>; \n       0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk> \\<Longrightarrow>  \n   \\<exists>q\\<in>carrier R. (f = q \\<cdot>\\<^sub>r g) \\<or> (\\<exists>r\\<in>carrier R. r \\<noteq> \\<zero> \\<and> (f = (q \\<cdot>\\<^sub>r g) \\<plusminus> r)\n     \\<and> (deg_n R S X r) < (deg_n R S X g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         f = q \\<cdot>\\<^sub>r g \\<or>\n                         (\\<exists>r\\<in>carrier R.\n                             r \\<noteq> \\<zero> \\<and>\n                             f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                             deg_n R S X r < deg_n R S X g)", "apply (cut_tac is_Ring,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n     0 < deg_n R S X g; f \\<in> carrier R; Ring R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         f = q \\<cdot>\\<^sub>r g \\<or>\n                         (\\<exists>r\\<in>carrier R.\n                             r \\<noteq> \\<zero> \\<and>\n                             f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                             deg_n R S X r < deg_n R S X g)", "apply (frule divisionTr3[of g f], assumption+,\n       erule bexE,\n       frule_tac x = q in ring_tOp_closed[of  _ g], assumption+,\n       erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; f \\<in> carrier R; Ring R; aGroup R;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                            f = q \\<cdot>\\<^sub>r g \\<or>\n                            (\\<exists>r\\<in>carrier R.\n                                r \\<noteq> \\<zero> \\<and>\n                                f =\n                                q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                                deg_n R S X r < deg_n R S X g)\n 2. \\<And>q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; f \\<in> carrier R; Ring R; aGroup R;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq> \\<zero> \\<and>\n        deg_n R S X (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n        < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                            f = q \\<cdot>\\<^sub>r g \\<or>\n                            (\\<exists>r\\<in>carrier R.\n                                r \\<noteq> \\<zero> \\<and>\n                                f =\n                                q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                                deg_n R S X r < deg_n R S X g)", "apply (simp add:aGroup.ag_eq_diffzero[THEN sym, of \"R\" \"f\"], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; f \\<in> carrier R; Ring R; aGroup R;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq> \\<zero> \\<and>\n        deg_n R S X (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n        < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                            f = q \\<cdot>\\<^sub>r g \\<or>\n                            (\\<exists>r\\<in>carrier R.\n                                r \\<noteq> \\<zero> \\<and>\n                                f =\n                                q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                                deg_n R S X r < deg_n R S X g)", "apply (subgoal_tac \"f = q \\<cdot>\\<^sub>r g \\<plusminus> (f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g))\",\n       subgoal_tac \"(f \\<plusminus> -\\<^sub>a (q \\<cdot>\\<^sub>r g)) \\<in> carrier R\", blast,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; g \\<noteq> \\<zero>;\n        0 < deg_n R S X g; f \\<in> carrier R; Ring R; aGroup R;\n        q \\<in> carrier R; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g \\<noteq> \\<zero> \\<and>\n        deg_n R S X (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)\n        < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> f =\n                         q \\<cdot>\\<^sub>r g \\<plusminus>\n                         (f \\<plusminus> -\\<^sub>a q \\<cdot>\\<^sub>r g)", "apply (frule_tac x = \"q \\<cdot>\\<^sub>r g\" in aGroup.ag_mOp_closed, assumption+,\n       subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n       subst aGroup.ag_pOp_commute[of R _ f], assumption+,\n       subst aGroup.ag_pOp_assoc, assumption+,\n              simp add:aGroup.ag_r_inv1, simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) divisionTr:\"\\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g; \n       f \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n       \\<exists>q\\<in>carrier R. (\\<exists>r\\<in>carrier R. (f = (q \\<cdot>\\<^sub>r g) \\<plusminus> r) \\<and> \n                                  (deg R S X r) < (deg R S X g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g;\n     f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         \\<exists>r\\<in>carrier R.\n                            f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                            deg R S X r < deg R S X g", "apply (subgoal_tac \"g \\<noteq> \\<zero>\",\n       frule divisionTr4[of g f], assumption+,\n       simp add:deg_def, simp only:an_0[THEN sym],\n       cut_tac aless_nat_less[of \"0\" \"deg_n R S X g\"],  simp, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g; f \\<in> carrier R;\n     g \\<noteq> \\<zero>;\n     \\<exists>q\\<in>carrier R.\n        f = q \\<cdot>\\<^sub>r g \\<or>\n        (\\<exists>r\\<in>carrier R.\n            r \\<noteq> \\<zero> \\<and>\n            f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n            deg_n R S X r < deg_n R S X g)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                         \\<exists>r\\<in>carrier R.\n                            f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                            deg R S X r < deg R S X g\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g;\n     f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> g \\<noteq> \\<zero>", "apply (erule bexE, erule disjE,\n       cut_tac ring_is_ag, frule aGroup.ag_r_zero[of \"R\" \"f\"], simp, simp,\n       rotate_tac -1, frule sym,\n       cut_tac ring_zero,\n       subgoal_tac \"deg R S X \\<zero> < deg R S X g\", blast,\n       simp add:deg_def an_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>q.\n       \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g;\n        f \\<in> carrier R; g \\<noteq> \\<zero>; q \\<in> carrier R;\n        \\<exists>r\\<in>carrier R.\n           r \\<noteq> \\<zero> \\<and>\n           f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n           deg_n R S X r < deg_n R S X g\\<rbrakk>\n       \\<Longrightarrow> \\<exists>q\\<in>carrier R.\n                            \\<exists>r\\<in>carrier R.\n                               f = q \\<cdot>\\<^sub>r g \\<plusminus> r \\<and>\n                               deg R S X r < deg R S X g\n 2. \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g;\n     f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> g \\<noteq> \\<zero>", "apply (erule bexE, (erule conjE)+,\n       cut_tac n1 = \"deg_n R S X r\" and m1 = \"deg_n R S X g\" in \n       aless_natless[THEN sym], simp add:deg_def,\n       drule sym, simp, rotate_tac -1, drule sym, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; g \\<in> carrier R; 0 < deg R S X g;\n     f \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> g \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+,\n       simp add:deg_def, frule aless_imp_le[of \"0\" \"-\\<infinity>\"],\n       cut_tac minf_le_any[of \"0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; \\<zero> \\<in> carrier R; 0 < - \\<infinity>;\n     f \\<in> carrier R; g = \\<zero>; 0 \\<le> - \\<infinity>;\n     - \\<infinity> \\<le> 0\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule ale_antisym[of \"0\" \"-\\<infinity>\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; \\<zero> \\<in> carrier R; 0 < - \\<infinity>;\n     f \\<in> carrier R; g = \\<zero>; 0 \\<le> - \\<infinity>;\n     - \\<infinity> \\<le> 0; 0 = - \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) rel_prime_equation:\"\\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n      0 < deg R S X f; 0 < deg R S X g; rel_prime_pols R S X f g;\n      h \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n     \\<exists>u \\<in> carrier R. \\<exists>v \\<in> carrier R.\n     (deg R S X u \\<le> amax ((deg R S X h) - (deg R S X f)) (deg R S X g)) \\<and>\n     (deg R S X v \\<le> (deg R S X f)) \\<and> (u \\<cdot>\\<^sub>r f \\<plusminus> (v \\<cdot>\\<^sub>r g) = h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         \\<exists>v\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            deg R S X v \\<le> deg R S X f \\<and>\n                            u \\<cdot>\\<^sub>r f \\<plusminus>\n                            v \\<cdot>\\<^sub>r g =\n                            h", "apply (cut_tac ring_is_ag,\n       cut_tac ring_zero, cut_tac subring, frule subring_Ring,\n       frule aless_imp_le [of \"0\" \"deg R S X f\"],\n       frule  pol_nonzero[of f], simp,\n       frule aless_imp_le [of \"0\" \"deg R S X g\"], \n       frule  pol_nonzero[of g], simp,\n       frule Corps.field_is_idom[of \"S\"],\n       cut_tac polyn_ring_integral, simp,\n       frule Idomain.idom_tOp_nonzeros[of R f g], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)", "apply (case_tac \"h = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)\n 2. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)", "apply (cut_tac ring_is_ag,\n        cut_tac ring_zero,\n        subgoal_tac \"deg R S X \\<zero> \\<le> \n                      amax (deg R S X h - deg R S X f) (deg R S X g)\",\n        subgoal_tac \"deg R S X \\<zero> \\<le> deg R S X f \\<and> \n                     \\<zero> \\<cdot>\\<^sub>r f \\<plusminus> \\<zero> \\<cdot>\\<^sub>r g = h\", blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h = \\<zero>; aGroup R; \\<zero> \\<in> carrier R;\n     deg R S X \\<zero>\n     \\<le> amax (deg R S X h - deg R S X f) (deg R S X g)\\<rbrakk>\n    \\<Longrightarrow> deg R S X \\<zero> \\<le> deg R S X f \\<and>\n                      \\<zero> \\<cdot>\\<^sub>r f \\<plusminus>\n                      \\<zero> \\<cdot>\\<^sub>r g =\n                      h\n 2. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h = \\<zero>; aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X \\<zero>\n                      \\<le> amax (deg R S X h - deg R S X f) (deg R S X g)\n 3. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)", "apply (simp add:ring_times_0_x, simp add:aGroup.ag_r_zero,\n        simp add:deg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h = \\<zero>; aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> deg R S X \\<zero>\n                      \\<le> amax (deg R S X h - deg R S X f) (deg R S X g)\n 2. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)", "apply (simp add:deg_def amax_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R; 0 < deg R S X f;\n     0 < deg R S X g; rel_prime_pols R S X f g; h \\<in> carrier R; aGroup R;\n     \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n     0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n     Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n     h \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                         deg R S X u\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g) \\<and>\n                         (\\<exists>v\\<in>carrier R.\n                             deg R S X v \\<le> deg R S X f \\<and>\n                             u \\<cdot>\\<^sub>r f \\<plusminus>\n                             v \\<cdot>\\<^sub>r g =\n                             h)", "apply (simp add:rel_prime_pols_def,\n       frule principal_ideal[of f], frule principal_ideal[of g],\n       frule ideals_set_sum[of \"R \\<diamondsuit>\\<^sub>p f\" \"R \\<diamondsuit>\\<^sub>p g\" \"1\\<^sub>r\"], assumption+,\n       thin_tac \"1\\<^sub>r \\<in> R \\<diamondsuit>\\<^sub>p f \\<minusplus> R \\<diamondsuit>\\<^sub>p g\",\n       (erule bexE)+,\n       thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p f)\", thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p g)\",\n       simp add:Rxa_def, (erule bexE)+, simp,\n       thin_tac \"ha = r \\<cdot>\\<^sub>r f\", thin_tac \"k = ra \\<cdot>\\<^sub>r g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha k r ra.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r f \\<plusminus> ra \\<cdot>\\<^sub>r g;\n        r \\<in> carrier R; ra \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (frule_tac x = r in ring_tOp_closed[of _ f], assumption+,\n       frule_tac x = ra in ring_tOp_closed[of _ g], assumption+,\n       frule_tac y1 = \"r \\<cdot>\\<^sub>r f\" and z1 = \"ra \\<cdot>\\<^sub>r g\" in ring_distrib1[THEN sym, \n       of \"h\"], assumption+, simp add:ring_r_one, drule sym,\n       simp,\n       thin_tac \"r \\<cdot>\\<^sub>r f \\<plusminus> ra \\<cdot>\\<^sub>r g = 1\\<^sub>r\",\n       simp add:ring_tOp_assoc[THEN sym], simp add:ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>; r \\<in> carrier R; ra \\<in> carrier R;\n        r \\<cdot>\\<^sub>r f \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r g \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r \\<cdot>\\<^sub>r f \\<plusminus>\n        h \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r g =\n        h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (frule_tac f = \"h \\<cdot>\\<^sub>r r\" in divisionTr[of g], assumption+,\n       simp add:ring_tOp_closed,\n       frule_tac f = \"h \\<cdot>\\<^sub>r ra\" in divisionTr[of f], assumption+,\n       simp add:ring_tOp_closed,\n       (erule bexE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>; r \\<in> carrier R; ra \\<in> carrier R;\n        r \\<cdot>\\<^sub>r f \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r g \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r \\<cdot>\\<^sub>r f \\<plusminus>\n        h \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r = q \\<cdot>\\<^sub>r g \\<plusminus> rb;\n        deg R S X rb < deg R S X g;\n        h \\<cdot>\\<^sub>r ra = qa \\<cdot>\\<^sub>r f \\<plusminus> rc;\n        deg R S X rc < deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "(** final **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>; r \\<in> carrier R; ra \\<in> carrier R;\n        r \\<cdot>\\<^sub>r f \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r g \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r \\<cdot>\\<^sub>r f \\<plusminus>\n        h \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r = q \\<cdot>\\<^sub>r g \\<plusminus> rb;\n        deg R S X rb < deg R S X g;\n        h \\<cdot>\\<^sub>r ra = qa \\<cdot>\\<^sub>r f \\<plusminus> rc;\n        deg R S X rc < deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (thin_tac \" r \\<in> carrier R\",\n       thin_tac \"ra \\<in> carrier R\",\n       thin_tac \"r \\<cdot>\\<^sub>r f \\<in> carrier R\",\n       thin_tac \"ra \\<cdot>\\<^sub>r g \\<in> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        h \\<cdot>\\<^sub>r r \\<cdot>\\<^sub>r f \\<plusminus>\n        h \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R;\n        h \\<cdot>\\<^sub>r r = q \\<cdot>\\<^sub>r g \\<plusminus> rb;\n        deg R S X rb < deg R S X g;\n        h \\<cdot>\\<^sub>r ra = qa \\<cdot>\\<^sub>r f \\<plusminus> rc;\n        deg R S X rc < deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (frule_tac x = q in ring_tOp_closed[of _ g], assumption+,\n       frule_tac x = qa in ring_tOp_closed[of _ f], assumption+,\n       frule_tac x = \"q \\<cdot>\\<^sub>r g\" and y = rb in aGroup.ag_pOp_commute, assumption+,\n       simp, \n       thin_tac \"q \\<cdot>\\<^sub>r g \\<plusminus> rb = rb \\<plusminus> q \\<cdot>\\<^sub>r g\",\n       thin_tac  \"h \\<cdot>\\<^sub>r r =  rb \\<plusminus> q \\<cdot>\\<^sub>r g\",\n       thin_tac \"h \\<cdot>\\<^sub>r ra =  qa \\<cdot>\\<^sub>r f \\<plusminus> rc\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; f \\<cdot>\\<^sub>r g \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f \\<plusminus>\n        (qa \\<cdot>\\<^sub>r f \\<plusminus> rc) \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (simp add:ring_distrib2[of g],\n     frule_tac x = rb and y = \"q \\<cdot>\\<^sub>r g\" in aGroup.ag_pOp_closed[of R], \n       assumption+,\n     frule_tac x = \"rb \\<plusminus> q \\<cdot>\\<^sub>r g\" and y = f in ring_tOp_closed, \n      assumption+,\n     frule_tac x = \"qa \\<cdot>\\<^sub>r f\" and y = g in ring_tOp_closed, assumption+,\n     frule_tac x = rc and y = g in ring_tOp_closed, assumption+,\n     simp add:aGroup.ag_pOp_assoc[THEN sym, of \"R\"],\n     simp add:ring_tOp_assoc[of _ f g],\n     simp add:ring_tOp_commute[of f g],\n     simp add:ring_tOp_assoc[THEN sym, of  _ g f],\n     frule_tac x = qa and y = g in ring_tOp_closed, assumption+,\n     simp add:ring_distrib2[THEN sym],\n     simp add:aGroup.ag_pOp_assoc,\n     simp add:ring_distrib2[THEN sym],\n     case_tac \"q \\<plusminus>\\<^bsub>R\\<^esub> qa = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_0_x,\n          simp add:aGroup.ag_r_zero,\n     subgoal_tac \"deg R S X rb \\<le> \n                         amax (deg R S X h - deg R S X f) (deg R S X g)\",\n            subgoal_tac \"deg R S X rc \\<le> deg R S X f\",\n            blast,\n        simp add:aless_imp_le,\n        frule_tac x = \"deg R S X rb\" and y = \"deg R S X g\" in\n           aless_imp_le,\n        rule_tac i = \"deg R S X rb\" in ale_trans[of _ \"deg R S X g\" \n          \"amax (deg R S X h - deg R S X f) (deg R S X g)\"], assumption,\n           simp add:amax_def, simp add:aneg_le aless_imp_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>u\\<in>carrier R.\n                            deg R S X u\n                            \\<le> amax (deg R S X h - deg R S X f)\n                                   (deg R S X g) \\<and>\n                            (\\<exists>v\\<in>carrier R.\n                                deg R S X v \\<le> deg R S X f \\<and>\n                                u \\<cdot>\\<^sub>r f \\<plusminus>\n                                v \\<cdot>\\<^sub>r g =\n                                h)", "apply (subgoal_tac \"rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g \\<in> carrier R\",\n       subgoal_tac \"deg R S X (rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<le> \n                    amax (deg R S X h - deg R S X f) (deg R S X g)\",\n       subgoal_tac \"deg R S X rc \\<le> deg R S X f\",  blast,\n     simp add:aless_imp_le,\n     frule_tac x = q and y = qa in aGroup.ag_pOp_closed[of \"R\"], assumption+,\n     frule_tac p = rb and q = \"(q \\<plusminus> qa) \\<cdot>\\<^sub>r g\" in deg_pols_add1,\n     rule ring_tOp_closed, assumption+, simp add:deg_mult_pols1,\n     frule_tac p1 = \"q \\<plusminus> qa\" in pol_nonzero[THEN sym], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        0 \\<le> deg R S X (q \\<plusminus> qa);\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> deg R S X rb\n                         < deg R S X (q \\<plusminus> qa) + deg R S X g\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X (rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) =\n        deg R S X ((q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (rb \\<plusminus>\n                           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (frule_tac y = \"deg R S X (q \\<plusminus> qa)\" and z = \"deg R S X rb\" in \n                                   aadd_le_mono[of \"0\"], simp add:aadd_0_l)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        0 \\<le> deg R S X (q \\<plusminus> qa);\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        deg R S X rb\n        \\<le> deg R S X (q \\<plusminus> qa) + deg R S X rb\\<rbrakk>\n       \\<Longrightarrow> deg R S X rb\n                         < deg R S X (q \\<plusminus> qa) + deg R S X g\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X (rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) =\n        deg R S X ((q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (rb \\<plusminus>\n                           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (frule_tac p = \"q \\<plusminus> qa\" in deg_ant_int, assumption+,\n       frule_tac x = \"deg R S X rb\" and y = \"deg R S X g\" and \n                 z = \"int (deg_n R S X ( q \\<plusminus> qa))\" in aadd_less_mono_z,\n       simp add:aadd_commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X (rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) =\n        deg R S X ((q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (rb \\<plusminus>\n                           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g)\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (simp add:deg_mult_pols1,\n       frule_tac p = \"rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\" and q = f in \n            deg_mult_pols1, assumption+, simp,\n       thin_tac \"deg R S X (rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) = \n                       deg R S X (q \\<plusminus> qa) + deg R S X g\",\n       frule_tac x = \"rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\" and y = f in \n       ring_tOp_closed,  assumption+, simp only:aGroup.ag_pOp_commute,\n       frule_tac p = \"rc \\<cdot>\\<^sub>r g\" and q = \"(rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\" in \n        deg_pols_add1, assumption+, simp,\n       thin_tac \"deg R S X ((rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> deg R S X (rc \\<cdot>\\<^sub>r g)\n                         < deg R S X (q \\<plusminus> qa) + deg R S X g +\n                           deg R S X f\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X\n         (rc \\<cdot>\\<^sub>r g \\<plusminus>\n          (rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (simp add:deg_mult_pols1,\n       frule_tac p1 = \"q \\<plusminus> qa\" in pol_nonzero[THEN sym], simp,\n       simp add:deg_ant_int[of g])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg_n R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>;\n        0 \\<le> ant (int (deg_n R S X g)); Idomain R; Idomain S;\n        g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < ant (int (deg_n R S X g));\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        0 \\<le> deg R S X (q \\<plusminus> qa);\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> deg R S X rc + ant (int (deg_n R S X g))\n                         < deg R S X (q \\<plusminus> qa) +\n                           ant (int (deg_n R S X g)) +\n                           deg R S X f\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X\n         (rc \\<cdot>\\<^sub>r g \\<plusminus>\n          (rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (frule_tac x = \"deg R S X rc\" and y = \"deg R S X f\" and \n        z = \"int (deg_n R S X g)\" in aadd_less_mono_z,\n       frule_tac a = \"deg R S X ( q \\<plusminus> qa)\" in aadd_pos_le[of _ \n                   \"deg R S X f + ant (int (deg_n R S X g))\"],\n       frule_tac x = \"deg R S X rc + ant (int (deg_n R S X g))\" and \n        y = \"deg R S X f + ant (int (deg_n R S X g))\" and \n        z = \"deg R S X ( q \\<plusminus> qa) + (deg R S X f + ant (int (deg_n R S X g)))\" \n       in aless_le_trans, assumption+,\n       thin_tac \"deg R S X rc + ant (int (deg_n R S X g))\n                       < deg R S X f + ant (int (deg_n R S X g))\",\n       thin_tac \"deg R S X f + ant (int (deg_n R S X g))\n           \\<le> deg R S X ( q \\<plusminus> qa) + (deg R S X f + ant (int (deg_n R S X g)))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg_n R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>;\n        0 \\<le> ant (int (deg_n R S X g)); Idomain R; Idomain S;\n        g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < ant (int (deg_n R S X g));\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        0 \\<le> deg R S X (q \\<plusminus> qa);\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        deg R S X rc + ant (int (deg_n R S X g))\n        < deg R S X (q \\<plusminus> qa) +\n          (deg R S X f + ant (int (deg_n R S X g)))\\<rbrakk>\n       \\<Longrightarrow> deg R S X rc + ant (int (deg_n R S X g))\n                         < deg R S X (q \\<plusminus> qa) +\n                           ant (int (deg_n R S X g)) +\n                           deg R S X f\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X\n         (rc \\<cdot>\\<^sub>r g \\<plusminus>\n          (rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (simp add:deg_ant_int[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg_n R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        0 \\<le> deg R S X (q \\<plusminus> qa);\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        deg R S X rc + deg R S X g\n        < deg R S X (q \\<plusminus> qa) +\n          (deg R S X f + deg R S X g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X rc + deg R S X g\n                         < deg R S X (q \\<plusminus> qa) + deg R S X g +\n                           deg R S X f\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X\n         (rc \\<cdot>\\<^sub>r g \\<plusminus>\n          (rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax (deg R S X h - deg R S X f)\n                                (deg R S X g)\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (frule_tac p = \"q \\<plusminus> qa\" in deg_in_aug_minf,\n        frule_tac p = \"g\" in deg_in_aug_minf, \n        frule_tac p = \"f\" in deg_in_aug_minf, \n        simp add:aadd_commute[of \"deg R S X f\" \"deg R S X g\"],\n        simp only:aadd_assoc_m[THEN sym], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X h =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax\n                                (deg R S X (q \\<plusminus> qa) +\n                                 deg R S X g +\n                                 deg R S X f -\n                                 deg R S X f)\n                                (deg R S X g)\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (frule_tac p = \"g\" in deg_in_aug_minf,\n        frule_tac p = \"f\" in deg_in_aug_minf,\n        frule_tac p = \"q \\<plusminus> qa\" in deg_in_aug_minf,\n        simp add:diff_ant_def,\n        subgoal_tac \"-(deg R S X f) \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X h =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        deg R S X g \\<in> Z\\<^sub>-\\<^sub>\\<infinity>;\n        deg R S X f \\<in> Z\\<^sub>-\\<^sub>\\<infinity>;\n        deg R S X (q \\<plusminus> qa) \\<in> Z\\<^sub>-\\<^sub>\\<infinity>;\n        - deg R S X f \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\\<rbrakk>\n       \\<Longrightarrow> deg R S X (q \\<plusminus> qa) + deg R S X g\n                         \\<le> amax\n                                (deg R S X (q \\<plusminus> qa) +\n                                 deg R S X g +\n                                 deg R S X f +\n                                 - deg R S X f)\n                                (deg R S X g)\n 2. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        rc \\<cdot>\\<^sub>r g \\<plusminus>\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>;\n        rb \\<plusminus> (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n        \\<in> carrier R;\n        q \\<plusminus> qa \\<in> carrier R;\n        deg R S X\n         ((rb \\<plusminus>\n           (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n          f) =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f\n        \\<in> carrier R;\n        deg R S X h =\n        deg R S X (q \\<plusminus> qa) + deg R S X g + deg R S X f;\n        deg R S X g \\<in> Z\\<^sub>-\\<^sub>\\<infinity>;\n        deg R S X f \\<in> Z\\<^sub>-\\<^sub>\\<infinity>;\n        deg R S X (q \\<plusminus> qa)\n        \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\\<rbrakk>\n       \\<Longrightarrow> - deg R S X f \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 3. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (subst aadd_assoc_m[of _ \"deg R S X f\" \"- deg R S X f\"],\n       simp add:Zminf_pOp_closed, assumption+,\n       (simp add:aadd_minus_r, simp add:aadd_0_r), simp add:amax_ge_l,\n       simp add:deg_ant_int, simp add:aminus, simp add:z_in_aug_minf)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>q qa rb rc.\n       \\<lbrakk>Corps S; f \\<in> carrier R; g \\<in> carrier R;\n        0 < deg R S X f; 0 < deg R S X g; h \\<in> carrier R; aGroup R;\n        \\<zero> \\<in> carrier R; Subring R S; Ring S; f \\<noteq> \\<zero>;\n        0 \\<le> deg R S X f; g \\<noteq> \\<zero>; 0 \\<le> deg R S X g;\n        Idomain R; Idomain S; g \\<cdot>\\<^sub>r f \\<noteq> \\<zero>;\n        h \\<noteq> \\<zero>;\n        (rb \\<plusminus>\n         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r\n        f \\<plusminus>\n        rc \\<cdot>\\<^sub>r g =\n        h;\n        q \\<in> carrier R; qa \\<in> carrier R; rb \\<in> carrier R;\n        rc \\<in> carrier R; deg R S X rb < deg R S X g;\n        deg R S X rc < deg R S X f; q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rb \\<plusminus> q \\<cdot>\\<^sub>r g \\<in> carrier R;\n        (rb \\<plusminus> q \\<cdot>\\<^sub>r g) \\<cdot>\\<^sub>r f\n        \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<cdot>\\<^sub>r f \\<in> carrier R;\n        rc \\<cdot>\\<^sub>r g \\<in> carrier R;\n        qa \\<cdot>\\<^sub>r g \\<in> carrier R;\n        q \\<plusminus> qa \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> rb \\<plusminus>\n                         (q \\<plusminus> qa) \\<cdot>\\<^sub>r g\n                         \\<in> carrier R", "apply (rule aGroup.ag_pOp_closed, assumption+,\n        rule ring_tOp_closed,\n        rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Polynomial, coeff mod P\""], ["", "definition\n  P_mod :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme, 'a, 'a set,\n          'a] \\<Rightarrow> bool\" where\n  \"P_mod R S X P p \\<longleftrightarrow> p = \\<zero>\\<^bsub>R\\<^esub> \\<or> \n     (\\<forall>j \\<le> (fst (s_cf R S X p)). (snd (s_cf R S X p) j) \\<in> P)\""], ["", "lemma (in PolynRg) P_mod_whole:\"p \\<in> carrier R \\<Longrightarrow>\n                         P_mod R S X (carrier S) p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> P_mod R S X (carrier S) p", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (carrier S) p", "apply (simp add:P_mod_def,\n       rule allI, rule impI,\n       rule pol_coeff_mem,\n       simp add:s_cf_pol_coeff,\n       assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) zero_P_mod:\"ideal S I \\<Longrightarrow> P_mod R S X I \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal S I \\<Longrightarrow> P_mod R S X I \\<zero>", "by (simp add:P_mod_def)"], ["", "lemma (in PolynRg) P_mod_mod:\"\\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n                     p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> \n                     (\\<forall>j \\<le> (fst c). (snd c) j \\<in> I) = (P_mod R S X I p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (simp add:P_mod_def,\n          drule sym,\n          frule coeff_0_pol_0[THEN sym, of c \"fst c\"], simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; \\<zero> \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p = \\<zero>;\n     \\<forall>j\\<le>fst c. snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<exists>j. j \\<le> fst c) \\<longrightarrow>\n                      \\<zero>\\<^bsub>S\\<^esub> \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (rule impI,\n          simp add:Ring.ideal_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule s_cf_expr[of p],\n       simp add:P_mod_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule polyn_c_max[of c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule coeff_nonzero_polyn_nonzero[of c \"fst c\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     (polyn_expr R X (fst c) c \\<noteq> \\<zero>) =\n     (\\<exists>j\\<le>fst c.\n         snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule coeff_max_nonzeroTr[of c], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     (polyn_expr R X (fst c) c \\<noteq> \\<zero>) =\n     (\\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>);\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (thin_tac \"(polyn_expr R X (fst c) c \\<noteq> \\<zero>) = (\\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule coeff_max_bddTr[of c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule polyn_expr_short[of c \"c_max S c\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c \\<le> fst c;\n     polyn_expr R X (c_max S c) c =\n     polyn_expr R X (c_max S c) (c_max S c, snd c)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule pol_expr_unique[of p \"(c_max S c, snd c)\" \"s_cf R S X p\"],\n        assumption+, rule split_pol_coeff[of c], assumption+,\n        simp, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c \\<le> fst c;\n     polyn_expr R X (c_max S c) c =\n     polyn_expr R X (c_max S c) (c_max S c, snd c);\n     fst (c_max S c, snd c) = fst (s_cf R S X p) \\<and>\n     (\\<forall>j\\<le>fst (c_max S c, snd c).\n         snd (c_max S c, snd c) j = snd (s_cf R S X p) j)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (thin_tac \"p = polyn_expr R X (fst c) c\",\n        thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n        thin_tac \"polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\",\n        thin_tac \"polyn_expr R X (c_max S c) c =\n                      polyn_expr R X (c_max S c) (c_max S c, snd c)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c \\<le> fst c;\n     fst (c_max S c, snd c) = fst (s_cf R S X p) \\<and>\n     (\\<forall>j\\<le>fst (c_max S c, snd c).\n         snd (c_max S c, snd c) j = snd (s_cf R S X p) j)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (frule coeff_max_zeroTr[of c], (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c \\<le> fst c;\n     \\<forall>j.\n        j \\<le> fst c \\<and> c_max S c < j \\<longrightarrow>\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst (c_max S c, snd c) = fst (s_cf R S X p);\n     \\<forall>j\\<le>fst (c_max S c, snd c).\n        snd (c_max S c, snd c) j = snd (s_cf R S X p) j\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      P_mod R S X I p", "apply (subst P_mod_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<le> fst c;\n     \\<forall>j.\n        j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow>\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c = fst (s_cf R S X p);\n     \\<forall>j\\<le>fst (s_cf R S X p).\n        snd c j = snd (s_cf R S X p) j\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j \\<in> I) =\n                      (\\<forall>j\\<le>fst (s_cf R S X p).\n                          snd (s_cf R S X p) j \\<in> I)", "apply (rule iffI, rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n        Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X p) \\<le> fst c;\n        \\<forall>j.\n           j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow>\n           snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n        c_max S c = fst (s_cf R S X p);\n        \\<forall>j\\<le>fst (s_cf R S X p). snd c j = snd (s_cf R S X p) j;\n        \\<forall>j\\<le>fst c. snd c j \\<in> I;\n        j \\<le> fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X p) j \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<le> fst c;\n     \\<forall>j.\n        j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow>\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c = fst (s_cf R S X p);\n     \\<forall>j\\<le>fst (s_cf R S X p). snd c j = snd (s_cf R S X p) j;\n     \\<forall>j\\<le>fst (s_cf R S X p).\n        snd (s_cf R S X p) j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j \\<in> I", "apply (rotate_tac 10,\n        drule_tac a = j in forall_spec,\n        drule_tac x = j in spec, assumption,\n        frule_tac i = j and j = \"fst (s_cf R S X p)\" and k = \"fst c\" in \n                  le_trans, assumption+, \n        drule_tac a = j in forall_spec, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n     Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     fst (s_cf R S X p) \\<le> fst c;\n     \\<forall>j.\n        j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow>\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     c_max S c = fst (s_cf R S X p);\n     \\<forall>j\\<le>fst (s_cf R S X p). snd c j = snd (s_cf R S X p) j;\n     \\<forall>j\\<le>fst (s_cf R S X p).\n        snd (s_cf R S X p) j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j \\<in> I", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; pol_coeff S c; Subring R S;\n        Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        fst (s_cf R S X p) \\<le> fst c;\n        \\<forall>j.\n           j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow>\n           snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n        c_max S c = fst (s_cf R S X p);\n        \\<forall>j\\<le>fst (s_cf R S X p). snd c j = snd (s_cf R S X p) j;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<in> I", "apply (case_tac \"fst (s_cf R S X p) < j\", \n        drule_tac a = j in forall_spec, simp,\n        simp add:Ring.ideal_zero,\n        frule_tac x = \"fst (s_cf R S X p)\" and y = j in leI,\n        thin_tac \"\\<forall>j. j \\<le> fst c \\<and> fst (s_cf R S X p) < j \\<longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>\",\n        drule_tac a = j in forall_spec, assumption,\n        drule_tac a = j in forall_spec, assumption, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) monomial_P_mod_mod:\"\\<lbrakk>ideal S I; c \\<in> carrier S; \n       p = c \\<cdot>\\<^sub>r (X^\\<^bsup>R d\\<^esup>)\\<rbrakk> \\<Longrightarrow>  (c \\<in> I) = (P_mod R S X I p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) = P_mod R S X I p", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) = P_mod R S X I p", "apply (cut_tac monomial_d[THEN sym, of \"(0, \\<lambda>j. c)\" \"d\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)); Subring R S;\n     Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> =\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c))\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) =\n                      P_mod R S X I\n                       (polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)))\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) = P_mod R S X I p\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (subst P_mod_mod[THEN sym, of I p \"ext_cf S d (0, \\<lambda>j. c)\"],\n       assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (ext_cf S d (0, \\<lambda>j. c))\n 3. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (ext_cf S d (0, \\<lambda>j. c)))\n                       (ext_cf S d (0, \\<lambda>j. c))\n 4. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) =\n                      (\\<forall>j\\<le>fst (ext_cf S d (0, \\<lambda>j. c)).\n                          snd (ext_cf S d (0, \\<lambda>j. c)) j \\<in> I)\n 5. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (frule mem_subring_mem_ring[of S c], assumption,\n          cut_tac X_mem_R, \n          frule npClose[of X d], drule sym, simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (ext_cf S d (0, \\<lambda>j. c))\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> p =\n                      polyn_expr R X (fst (ext_cf S d (0, \\<lambda>j. c)))\n                       (ext_cf S d (0, \\<lambda>j. c))\n 3. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) =\n                      (\\<forall>j\\<le>fst (ext_cf S d (0, \\<lambda>j. c)).\n                          snd (ext_cf S d (0, \\<lambda>j. c)) j \\<in> I)\n 4. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (simp add:pol_coeff_def, rule allI, rule impI, \n       simp add:ext_cf_def sliden_def, rule impI, simp add:Ring.ring_zero,\n       subst ext_cf_len, simp add:pol_coeff_def,\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d (ext_cf S d (0, \\<lambda>j. c)) = p\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) =\n                      (\\<forall>j\\<le>fst (ext_cf S d (0, \\<lambda>j. c)).\n                          snd (ext_cf S d (0, \\<lambda>j. c)) j \\<in> I)\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (subst ext_cf_len, simp add:pol_coeff_def,\n          simp add:ext_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d\n      (d, \\<lambda>i.\n             if d \\<le> i then snd (0, \\<lambda>j. c) (sliden d i)\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     p\\<rbrakk>\n    \\<Longrightarrow> (c \\<in> I) =\n                      (\\<forall>j.\n                          (d = j \\<longrightarrow> c \\<in> I) \\<and>\n                          (d \\<noteq> j \\<longrightarrow>\n                           j \\<le> d \\<longrightarrow>\n                           \\<zero>\\<^bsub>S\\<^esub> \\<in> I))\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (rule iffI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d\n      (d, \\<lambda>i.\n             if d \\<le> i then snd (0, \\<lambda>j. c) (sliden d i)\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     p;\n     c \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j.\n                         (d = j \\<longrightarrow> c \\<in> I) \\<and>\n                         (d \\<noteq> j \\<longrightarrow>\n                          j \\<le> d \\<longrightarrow>\n                          \\<zero>\\<^bsub>S\\<^esub> \\<in> I)\n 2. \\<lbrakk>ideal S I; c \\<in> carrier S; Subring R S; Ring S;\n     c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup> = p;\n     polyn_expr R X d\n      (d, \\<lambda>i.\n             if d \\<le> i then snd (0, \\<lambda>j. c) (sliden d i)\n             else \\<zero>\\<^bsub>S\\<^esub>) =\n     p;\n     \\<forall>j.\n        (d = j \\<longrightarrow> c \\<in> I) \\<and>\n        (d \\<noteq> j \\<longrightarrow>\n         j \\<le> d \\<longrightarrow>\n         \\<zero>\\<^bsub>S\\<^esub> \\<in> I)\\<rbrakk>\n    \\<Longrightarrow> c \\<in> I\n 3. \\<lbrakk>ideal S I; c \\<in> carrier S;\n     p = c \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, \\<lambda>j. c)", "apply (simp add:Ring.ideal_zero,\n          drule_tac x = d in spec,\n          simp, simp add:pol_coeff_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_add:\"\\<lbrakk>ideal S I; p \\<in> carrier R;\n      q \\<in> carrier R; P_mod R S X I p; P_mod R S X I q\\<rbrakk> \\<Longrightarrow> \n               P_mod R S X I (p \\<plusminus> q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (cut_tac subring,\n       frule subring_Ring,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_l_zero,\n       case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (case_tac \"p \\<plusminus>\\<^bsub>R\\<^esub> q = \\<zero>\\<^bsub>R\\<^esub>\", simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (frule s_cf_expr[of p], assumption,\n       frule s_cf_expr[of q], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (frule polyn_add1[of \"s_cf R S X p\" \"s_cf R S X q\"], assumption+,\n       drule sym, drule sym, simp, drule sym, simp,\n       rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q) = q;\n     p \\<plusminus> q =\n     polyn_expr R X (max (fst (s_cf R S X p)) (fst (s_cf R S X q)))\n      (add_cf S (s_cf R S X p) (s_cf R S X q))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (frule P_mod_mod[THEN sym, of I p \"s_cf R S X p\"], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\",\n       frule P_mod_mod[THEN sym, of I q \"s_cf R S X q\"], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q) = q\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     p \\<plusminus> q =\n     polyn_expr R X (max (fst (s_cf R S X p)) (fst (s_cf R S X q)))\n      (add_cf S (s_cf R S X p) (s_cf R S X q));\n     P_mod R S X I p =\n     (\\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I);\n     P_mod R S X I q =\n     (\\<forall>j\\<le>fst (s_cf R S X q).\n         snd (s_cf R S X q) j \\<in> I)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (frule aGroup.ag_pOp_closed[of R p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     p \\<plusminus> q =\n     polyn_expr R X (max (fst (s_cf R S X p)) (fst (s_cf R S X q)))\n      (add_cf S (s_cf R S X p) (s_cf R S X q));\n     P_mod R S X I p =\n     (\\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I);\n     P_mod R S X I q =\n     (\\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I);\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<plusminus> q)", "apply (subst P_mod_mod[THEN sym, of I \"p \\<plusminus> q\" \n             \"add_cf S (s_cf R S X p) (s_cf R S X q)\"], assumption+,\n       simp add:add_cf_pol_coeff, simp, simp add:add_cf_len,\n       thin_tac \"p \\<plusminus> q =\n         polyn_expr R X (max (fst (s_cf R S X p)) (fst (s_cf R S X q)))\n         (add_cf S (s_cf R S X p) (s_cf R S X q))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X I q; Subring R S; Ring S; aGroup R;\n     p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X I p =\n     (\\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I);\n     P_mod R S X I q =\n     (\\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I);\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst\n(add_cf S (s_cf R S X p) (s_cf R S X q)).\n                         snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n     Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X I p; P_mod R S X I q;\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst\n(add_cf S (s_cf R S X p) (s_cf R S X q)).\n                         snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (subst add_cf_len, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n     Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>; q \\<noteq> \\<zero>;\n     p \\<plusminus> q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X I p; P_mod R S X I q;\n     p \\<plusminus> q \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>max (fst (s_cf R S X p))\n(fst (s_cf R S X q)).\n                         snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q))\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (cut_tac x = \"fst (s_cf R S X p)\" and y = \"fst (s_cf R S X q)\" in \n       less_linear)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) < fst (s_cf R S X q) \\<or>\n        fst (s_cf R S X p) = fst (s_cf R S X q) \\<or>\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) < fst (s_cf R S X q)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I\n 2. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) = fst (s_cf R S X q) \\<or>\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (simp, subst add_cf_def, simp,\n       (rule impI, \n        drule_tac a = j in forall_spec, assumption,\n        drule_tac x = j in spec,\n        frule_tac x = j and y = \"fst (s_cf R S X p)\" and \n           z = \"fst (s_cf R S X q)\" in le_less_trans, assumption+,\n        frule_tac x = j and y = \"fst (s_cf R S X q)\" in less_imp_le, simp))"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        fst (s_cf R S X p) < fst (s_cf R S X q); j \\<le> fst (s_cf R S X p);\n        snd (s_cf R S X p) j \\<in> I; snd (s_cf R S X q) j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X p) j \\<plusminus>\\<^bsub>S\\<^esub>\n                         snd (s_cf R S X q) j\n                         \\<in> I\n 2. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) = fst (s_cf R S X q) \\<or>\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (rule Ring.ideal_pOp_closed[of S I], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) = fst (s_cf R S X q) \\<or>\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X p) = fst (s_cf R S X q)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I\n 2. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (simp, subst add_cf_def, simp,\n        drule_tac a = j in forall_spec, assumption,\n        drule_tac a = j in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> fst (s_cf R S X q); fst (s_cf R S X p) = fst (s_cf R S X q);\n        snd (s_cf R S X p) j \\<in> I; snd (s_cf R S X q) j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X p) j \\<plusminus>\\<^bsub>S\\<^esub>\n                         snd (s_cf R S X q) j\n                         \\<in> I\n 2. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (rule Ring.ideal_pOp_closed[of S I], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        \\<forall>j\\<le>fst (s_cf R S X q). snd (s_cf R S X q) j \\<in> I;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        j \\<le> max (fst (s_cf R S X p)) (fst (s_cf R S X q));\n        fst (s_cf R S X q) < fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (s_cf R S X p) (s_cf R S X q)) j\n                         \\<in> I", "apply (simp add: max.absorb1 max.absorb2, subst add_cf_def, simp, rule impI,\n        drule_tac x = j in spec, \n        drule_tac a = j in forall_spec, assumption,\n        frule_tac x = j and y = \"fst (s_cf R S X q)\" and \n           z = \"fst (s_cf R S X p)\" in le_less_trans, assumption+,\n        frule_tac x = j and y = \"fst (s_cf R S X p)\" in less_imp_le, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n        Subring R S; Ring S; aGroup R; p \\<noteq> \\<zero>;\n        q \\<noteq> \\<zero>; p \\<plusminus> q \\<noteq> \\<zero>;\n        pol_coeff S (s_cf R S X p); pol_coeff S (s_cf R S X q);\n        snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X I p; P_mod R S X I q; p \\<plusminus> q \\<in> carrier R;\n        fst (s_cf R S X q) < fst (s_cf R S X p); j \\<le> fst (s_cf R S X q);\n        snd (s_cf R S X p) j \\<in> I; snd (s_cf R S X q) j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X p) j \\<plusminus>\\<^bsub>S\\<^esub>\n                         snd (s_cf R S X q) j\n                         \\<in> I", "apply (rule Ring.ideal_pOp_closed[of S I], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_minus:\"\\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p\\<rbrakk> \\<Longrightarrow>\n                  P_mod R S X I (-\\<^sub>a p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (-\\<^sub>a p)", "apply (cut_tac ring_is_ag,\n       cut_tac subring,\n       frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p; aGroup R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (-\\<^sub>a p)", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p; aGroup R;\n     Subring R S; Ring S; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (-\\<^sub>a p)", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+,\n       frule polyn_minus_m_cf[of \"s_cf R S X p\" \"fst (s_cf R S X p)\"],\n       simp,\n       frule aGroup.ag_inv_inj[of R p \\<zero>], assumption,\n       simp add:ring_zero, assumption, simp add:aGroup.ag_inv_zero,\n       frule m_cf_pol_coeff[of \"s_cf R S X p\"],\n       drule sym, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p; aGroup R;\n     Subring R S; Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p \\<noteq> \\<zero>; pol_coeff S (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p;\n     polyn_expr R X (fst (s_cf R S X p)) (m_cf S (s_cf R S X p)) =\n     -\\<^sub>a p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (-\\<^sub>a p)", "apply (subst P_mod_mod[THEN sym, of I \"-\\<^sub>a p\" \"m_cf S (s_cf R S X p)\"],\n        assumption+,\n      rule aGroup.ag_mOp_closed[of R p], assumption+,\n      simp add:m_cf_len,\n      thin_tac \"polyn_expr R X (fst (s_cf R S X p)) \n                                 (m_cf S (s_cf R S X p)) = -\\<^sub>a p\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; P_mod R S X I p; aGroup R;\n     Subring R S; Ring S; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p \\<noteq> \\<zero>; pol_coeff S (m_cf S (s_cf R S X p));\n     polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (m_cf S (s_cf R S X p)).\n                         snd (m_cf S (s_cf R S X p)) j \\<in> I", "apply (frule P_mod_mod[THEN sym, of I p \"s_cf R S X p\"], assumption+, simp,\n       thin_tac \"polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p) = p\",\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     aGroup R; Subring R S; Ring S; p \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     -\\<^sub>a p \\<noteq> \\<zero>; pol_coeff S (m_cf S (s_cf R S X p));\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (m_cf S (s_cf R S X p)).\n                         snd (m_cf S (s_cf R S X p)) j \\<in> I", "apply (rule allI, rule impI,\n       drule_tac a = j in forall_spec, simp add:m_cf_len,\n       subst m_cf_def, simp,\n       rule Ring.ideal_inv1_closed[of S I], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_pre:\"\\<lbrakk>ideal S I; pol_coeff S ((Suc n), f); \n       P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X I (polyn_expr R X n (n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; pol_coeff S (Suc n, f);\n     P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (polyn_expr R X n (n, f))", "apply (frule pol_coeff_pre[of n f],\n       frule polyn_mem[of \"(n, f)\" n],simp,\n       frule polyn_mem[of \"(Suc n, f)\" \"Suc n\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; pol_coeff S (Suc n, f);\n     P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f)); pol_coeff S (n, f);\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X (Suc n) (Suc n, f) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (polyn_expr R X n (n, f))", "apply (case_tac \"polyn_expr R X n (n, f) = \\<zero>\\<^bsub>R\\<^esub>\", simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; pol_coeff S (Suc n, f);\n     P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f)); pol_coeff S (n, f);\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X (Suc n) (Suc n, f) \\<in> carrier R;\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (polyn_expr R X n (n, f))", "apply (subst P_mod_mod[THEN sym, of I \n                  \"polyn_expr R X n (n, f)\" \"(n, f)\"], assumption+, simp,\n       frule P_mod_mod[THEN sym, of I \"polyn_expr R X (Suc n) (Suc n, f)\"\n               \"(Suc n, f)\"], assumption+, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_pre1:\"\\<lbrakk>ideal S I; pol_coeff S ((Suc n), f); \n       P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X I (polyn_expr R X n (Suc n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; pol_coeff S (Suc n, f);\n     P_mod R S X I (polyn_expr R X (Suc n) (Suc n, f))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (polyn_expr R X n (Suc n, f))", "by (simp add:polyn_expr_restrict[of n f], simp add:P_mod_pre)"], ["", "lemma (in PolynRg) P_mod_coeffTr:\"\\<lbrakk>ideal S I; d \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                   (P_mod R S X I d) = (d \\<in> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; d \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I d = (d \\<in> I)", "apply (cut_tac subring, frule subring_Ring,\n       subst monomial_P_mod_mod[of I d \"d \\<cdot>\\<^sub>r X^\\<^bsup>R 0\\<^esup>\" 0], assumption+,\n       simp, simp,\n       frule mem_subring_mem_ring[of _ d], assumption+,\n       simp add:ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult_const:\"\\<lbrakk>ideal S I; ideal S J; \n     pol_coeff S (n, f); P_mod R S X I (polyn_expr R X n (n, f));\n     pol_coeff S (0, g); P_mod R S X J (polyn_expr R X 0 (0, g))\\<rbrakk> \\<Longrightarrow> \n       P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r \n                                        (polyn_expr R X 0 (0, g)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (frule_tac c = \"(n, f)\" in polyn_mem[of _ n], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (frule Ring.ideal_prod_ideal[of S I J], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (case_tac \"polyn_expr R X n (n, f) = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I \\<zero>; pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S;\n     \\<zero> \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (\\<zero> \\<cdot>\\<^sub>r polyn_expr R X 0 (0, g))\n 2. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (frule_tac c = \"(0, g)\" in polyn_mem[of _ 0], simp,\n        simp add:ring_times_0_x, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (polyn_expr R X 0 (0, g)); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        polyn_expr R X 0 (0, g))", "apply (simp add:polyn_expr_def [of _ _ \"0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (g 0 \\<cdot>\\<^sub>r 1\\<^sub>r); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                        (g 0 \\<cdot>\\<^sub>r 1\\<^sub>r))", "apply (frule pol_coeff_mem[of \"(0, g)\" 0], simp, simp,\n        frule mem_subring_mem_ring[of S \"g 0\"], assumption,\n        simp add:ring_r_one,\n        simp add:ring_tOp_commute[of _ \"g 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (g 0); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n     g 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (g 0 \\<cdot>\\<^sub>r polyn_expr R X n (n, f))", "apply (frule sp_cf_pol_coeff[of \"(n, f)\" \"g 0\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (g 0); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n     g 0 \\<in> carrier R; pol_coeff S (sp_cf S (g 0) (n, f))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (g 0 \\<cdot>\\<^sub>r polyn_expr R X n (n, f))", "apply (subst scalar_times_pol_expr[of \"g 0\" \"(n, f)\" n], assumption+,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (g 0); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n     g 0 \\<in> carrier R; pol_coeff S (sp_cf S (g 0) (n, f))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (sp_cf S (g 0) (n, f)))", "apply (subst P_mod_mod[THEN sym, of \"I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J\" \n        \"polyn_expr R X n (sp_cf S (g 0) (n, f))\" \"sp_cf S (g 0) (n, f)\"],\n         assumption+,\n         simp add:polyn_mem, simp add:sp_cf_pol_coeff,\n         rule polyn_mem, simp add:sp_cf_pol_coeff,\n         simp add:sp_cf_len, simp,\n         simp add:sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); pol_coeff S (0, g);\n     P_mod R S X J (g 0); Subring R S; Ring S;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n     g 0 \\<in> carrier R; pol_coeff S (sp_cf S (g 0) (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (sp_cf S (g 0) (n, f)).\n                         snd (sp_cf S (g 0) (n, f)) j\n                         \\<in> I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J", "apply (frule P_mod_mod[THEN sym, of I \"polyn_expr R X n (n, f)\" \n         \"(n, f)\"], assumption+, simp, simp,\n        simp add:sp_cf_len, subst sp_cf_def, simp,\n        simp add:P_mod_coeffTr[of J \"g 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     \\<forall>j\\<le>n. f j \\<in> I; pol_coeff S (0, g); g 0 \\<in> J;\n     Subring R S; Ring S; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n     g 0 \\<in> carrier R; pol_coeff S (sp_cf S (g 0) (n, f));\n     P_mod R S X I (polyn_expr R X n (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         g 0 \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f j\n                         \\<in> I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, assumption,\n        frule_tac h = \"f j\" in Ring.ideal_subset[of S I], assumption+,\n        simp add:Ring.ring_tOp_commute[of S \"g 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        pol_coeff S (0, g); g 0 \\<in> J; Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; g 0 \\<in> carrier S;\n        g 0 \\<in> carrier R; pol_coeff S (sp_cf S (g 0) (n, f));\n        P_mod R S X I (polyn_expr R X n (n, f)); j \\<le> n; f j \\<in> I;\n        f j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> f j \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0\n                         \\<in> I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J", "apply (simp add:Ring.prod_mem_prod_ideals[of S I J])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult_const1:\"\\<lbrakk>ideal S I; ideal S J; \n       pol_coeff S (n, f); P_mod R S X I (polyn_expr R X n (n, f));\n       d \\<in> J\\<rbrakk> \\<Longrightarrow> \n       P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); d \\<in> J\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r d)", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); d \\<in> J; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r d)", "apply (frule P_mod_coeffTr[THEN sym, of J d],\n       simp add:Ring.ideal_subset, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); P_mod R S X J d; Subring R S;\n     Ring S; d \\<in> J\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r d)", "apply (frule P_mod_mult_const[of I J n f \"\\<lambda>j. d\"], assumption+,\n       simp add:pol_coeff_def, simp add:Ring.ideal_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); P_mod R S X J d; Subring R S;\n     Ring S; d \\<in> J\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J (polyn_expr R X 0 (0, \\<lambda>j. d))\n 2. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); P_mod R S X J d; Subring R S;\n     Ring S; d \\<in> J;\n     P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n      (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n       polyn_expr R X 0 (0, \\<lambda>j. d))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r d)", "apply (subst polyn_expr_def, simp,\n       frule Ring.ideal_subset[of S  J d], assumption+,\n       frule mem_subring_mem_ring[of S d], assumption,\n       simp add:ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); P_mod R S X J d; Subring R S;\n     Ring S; d \\<in> J;\n     P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n      (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n       polyn_expr R X 0 (0, \\<lambda>j. d))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r d)", "apply (simp add:polyn_expr_def[of _ _ 0],\n       frule Ring.ideal_subset[of S  J d], assumption+,\n       frule mem_subring_mem_ring[of S d], assumption,\n       simp add:ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult_monomial:\"\\<lbrakk>ideal S I; p \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n           (P_mod R S X I p ) = (P_mod R S X I (p \\<cdot>\\<^sub>r X^\\<^bsup>R m\\<^esup>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p =\n                      P_mod R S X I\n                       (p \\<cdot>\\<^sub>r X^\\<^bsup>R m\\<^esup>)", "apply (cut_tac X_mem_R,\n       cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p =\n                      P_mod R S X I\n                       (p \\<cdot>\\<^sub>r X^\\<^bsup>R m\\<^esup>)", "apply (frule npClose[of X m],\n       simp add:ring_tOp_commute[of p ])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p =\n                      P_mod R S X I\n                       (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p =\n                      P_mod R S X I\n                       (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+,\n       cut_tac low_deg_terms_zero[THEN sym, of \"fst (s_cf R S X p)\" \n               \"snd (s_cf R S X p)\" m],\n       simp add:polyn_expr_split[THEN sym],\n       thin_tac \"X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p =\n       polyn_expr R X (fst (s_cf R S X p) + m) (ext_cf S m (s_cf R S X p))\",\n       frule ext_cf_pol_coeff[of \"s_cf R S X p\" m])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S m (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (polyn_expr R X (fst (s_cf R S X p) + m)\n                         (ext_cf S m (s_cf R S X p)))\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 3. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (frule P_mod_mod[THEN sym, of I p \"s_cf R S X p\"], assumption+,\n       thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n       simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S m (s_cf R S X p)); P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (polyn_expr R X (fst (s_cf R S X p) + m)\n                         (ext_cf S m (s_cf R S X p)))\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 3. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (frule P_mod_mod[THEN sym, of I \"polyn_expr R X (fst (s_cf R S X p) + \n          m) (ext_cf S m (s_cf R S X p))\" \"ext_cf S m (s_cf R S X p)\"],\n       rule polyn_mem, assumption, simp add:ext_cf_def,\n       assumption, simp add:ext_cf_len add.commute, simp,\n       thin_tac \"P_mod R S X I (polyn_expr R X (fst (s_cf R S X p) + m)\n        (ext_cf S m (s_cf R S X p))) = (\\<forall>j\\<le>fst (ext_cf S m (s_cf R S X p)).\n         snd (ext_cf S m (s_cf R S X p)) j \\<in> I)\",\n       thin_tac \"snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     pol_coeff S (s_cf R S X p); pol_coeff S (ext_cf S m (s_cf R S X p));\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (ext_cf S m (s_cf R S X p)).\n                         snd (ext_cf S m (s_cf R S X p)) j \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 3. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (rule allI, rule impI, simp add:ext_cf_len)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R;\n        Subring R S; Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R;\n        p \\<noteq> \\<zero>;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        pol_coeff S (s_cf R S X p); pol_coeff S (ext_cf S m (s_cf R S X p));\n        P_mod R S X I p; j \\<le> m + fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (ext_cf S m (s_cf R S X p)) j \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 3. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (\n       subst ext_cf_def, simp add:sliden_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R;\n        Subring R S; Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R;\n        p \\<noteq> \\<zero>;\n        \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n        pol_coeff S (s_cf R S X p); pol_coeff S (ext_cf S m (s_cf R S X p));\n        P_mod R S X I p; j \\<le> m + fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> \\<not> m \\<le> j \\<longrightarrow>\n                         \\<zero>\\<^bsub>S\\<^esub> \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 3. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (rule impI,\n       simp add:Ring.ideal_zero[of S])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I p; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (simp add:pol_coeff_split[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p", "apply (frule s_cf_expr[of p], assumption+, (erule conjE)+,\n       cut_tac low_deg_terms_zero[THEN sym, of \"fst (s_cf R S X p)\" \n               \"snd (s_cf R S X p)\" m],\n       simp add:polyn_expr_split[THEN sym],\n       thin_tac \"X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p =\n       polyn_expr R X (fst (s_cf R S X p) + m) (ext_cf S m (s_cf R S X p))\",\n       frule ext_cf_pol_coeff[of \"s_cf R S X p\" m])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I\n      (polyn_expr R X (fst (s_cf R S X p) + m) (ext_cf S m (s_cf R S X p)));\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (ext_cf S m (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p);\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))", "apply (frule P_mod_mod[THEN sym, of I \"polyn_expr R X (fst (s_cf R S X p) + \n          m) (ext_cf S m (s_cf R S X p))\" \"ext_cf S m (s_cf R S X p)\"],\n       rule polyn_mem, assumption, simp add:ext_cf_def,\n       assumption, simp add:ext_cf_len add.commute, simp,\n       thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n       thin_tac \"P_mod R S X I\n       (polyn_expr R X (fst (s_cf R S X p) + m) (ext_cf S m (s_cf R S X p)))\",\n       thin_tac \"snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     \\<forall>j\\<le>fst (ext_cf S m (s_cf R S X p)).\n        snd (ext_cf S m (s_cf R S X p)) j \\<in> I;\n     pol_coeff S (s_cf R S X p);\n     pol_coeff S (ext_cf S m (s_cf R S X p))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I p\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p);\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))", "apply (subst P_mod_mod[THEN sym, of I p \"s_cf R S X p\"], assumption+,\n       cut_tac s_cf_expr[of p], simp, assumption+,\n       rule allI, rule impI,\n       thin_tac \"pol_coeff S (ext_cf S m (s_cf R S X p))\",\n       simp add:ext_cf_len, simp add:ext_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R;\n        Subring R S; Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R;\n        p \\<noteq> \\<zero>;\n        \\<forall>j\\<le>m + fst (s_cf R S X p).\n           (if m \\<le> j then snd (s_cf R S X p) (sliden m j)\n            else \\<zero>\\<^bsub>S\\<^esub>)\n           \\<in> I;\n        pol_coeff S (s_cf R S X p); j \\<le> fst (s_cf R S X p)\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X p) j \\<in> I\n 2. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p);\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))", "apply (drule_tac x = \"m + j\" in spec,\n       frule_tac i = j and j = \"fst (s_cf R S X p)\" and k = m and l = m in \n       add_le_mono, simp, simp only:add.commute[of _ m],\n       thin_tac \"j \\<le> fst (s_cf R S X p)\", simp,\n       simp add:sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; X \\<in> carrier R; Subring R S;\n     Ring S; X^\\<^bsup>R m\\<^esup> \\<in> carrier R; p \\<noteq> \\<zero>;\n     P_mod R S X I (X^\\<^bsup>R m\\<^esup> \\<cdot>\\<^sub>r p);\n     pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_multTr:\"\\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f); \n       P_mod R S X I (polyn_expr R X n (n, f))\\<rbrakk> \\<Longrightarrow> \\<forall>g. ((pol_coeff S (m, g)\n       \\<and> (P_mod R S X J (polyn_expr R X m (m, g))))  \\<longrightarrow>  \n          P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) \n           ((polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag, cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (frule polyn_mem[of \"(n, f)\" n], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (frule Ring.ideal_prod_ideal[of \"S\" \"I\" \"J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (case_tac \"polyn_expr R X n (n, f) = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I \\<zero>; Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; \\<zero> \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (\\<zero> \\<cdot>\\<^sub>r polyn_expr R X m (m, g))\n 2. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I \\<zero>; Subring R S; Ring S; aGroup R;\n        X \\<in> carrier R; \\<zero> \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) = \\<zero>; pol_coeff S (m, g);\n        P_mod R S X J (polyn_expr R X m (m, g))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (\\<zero> \\<cdot>\\<^sub>r polyn_expr R X m (m, g))\n 2. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (frule_tac c = \"(m, g)\" in polyn_mem[of _ m], simp,\n        simp add:ring_times_0_x, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X m (m, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X m (m, g))", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n     P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S; aGroup R;\n     X \\<in> carrier R; polyn_expr R X n (n, f) \\<in> carrier R;\n     ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n     polyn_expr R X n (n, f) \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (0, g) \\<and>\n                         P_mod R S X J\n                          (polyn_expr R X 0 (0, g)) \\<longrightarrow>\n                         P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X 0 (0, g))\n 2. \\<And>na.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<and>\n           P_mod R S X J (polyn_expr R X na (na, g)) \\<longrightarrow>\n           P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n            (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n             polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<and>\n                            P_mod R S X J\n                             (polyn_expr R X (Suc na)\n                               (Suc na, g)) \\<longrightarrow>\n                            P_mod R S X\n                             (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                             (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                              polyn_expr R X (Suc na) (Suc na, g))", "apply (rule allI, rule impI, erule conjE,\n        rule_tac g = g in P_mod_mult_const[of I J n f], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<and>\n           P_mod R S X J (polyn_expr R X na (na, g)) \\<longrightarrow>\n           P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n            (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n             polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<and>\n                            P_mod R S X J\n                             (polyn_expr R X (Suc na)\n                               (Suc na, g)) \\<longrightarrow>\n                            P_mod R S X\n                             (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                             (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                              polyn_expr R X (Suc na) (Suc na, g))", "(* case m = 0 done *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<and>\n           P_mod R S X J (polyn_expr R X na (na, g)) \\<longrightarrow>\n           P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n            (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n             polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<and>\n                            P_mod R S X J\n                             (polyn_expr R X (Suc na)\n                               (Suc na, g)) \\<longrightarrow>\n                            P_mod R S X\n                             (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                             (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                              polyn_expr R X (Suc na) (Suc na, g))", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<and>\n           P_mod R S X J (polyn_expr R X na (na, g)) \\<longrightarrow>\n           P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n            (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n             polyn_expr R X na (na, g));\n        pol_coeff S (Suc na, g);\n        P_mod R S X J (polyn_expr R X (Suc na) (Suc na, g))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X (Suc na) (Suc na, g))", "apply (frule_tac n = na and f = g in pol_coeff_pre,\n       frule_tac n = na and f = g in P_mod_pre[of J], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<and>\n           P_mod R S X J (polyn_expr R X na (na, g)) \\<longrightarrow>\n           P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n            (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n             polyn_expr R X na (na, g));\n        pol_coeff S (Suc na, g);\n        P_mod R S X J (polyn_expr R X (Suc na) (Suc na, g));\n        pol_coeff S (na, g);\n        P_mod R S X J (polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X (Suc na) (Suc na, g))", "apply (drule_tac a = g in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J (polyn_expr R X (Suc na) (Suc na, g));\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X (Suc na) (Suc na, g))", "apply (frule_tac n = na and f = g in polyn_Suc_split, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X (Suc na) (Suc na, g) =\n        polyn_expr R X na (na, g) \\<plusminus>\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (polyn_expr R X na (na, g) \\<plusminus>\n                            g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))", "apply (thin_tac \"polyn_expr R X (Suc na) (Suc na, g) =\n        polyn_expr R X na (na, g) \\<plusminus> g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc na)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (polyn_expr R X na (na, g) \\<plusminus>\n                            g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))", "apply (frule_tac c = \"(na, g)\" and k = na in polyn_mem, simp,\n       subgoal_tac \"(g (Suc na)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc na)\\<^esup>) \\<in> carrier R\",\n       subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (frule_tac p = \"(polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X na (na, g))\"\n       and  q = \"(polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r \n                      ((g (Suc na)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc na)\\<^esup>))\" in \n        P_mod_add[of \"I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                         polyn_expr R X na (na, g)\n                         \\<in> carrier R\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                         (g (Suc na) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc na\\<^esup>)\n                         \\<in> carrier R\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g))\n 4. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 5. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 6. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (simp add:ring_tOp_closed, rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (frule_tac c = \"(Suc na, g)\" and j = \"Suc na\" in pol_coeff_mem_R,\n        simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        snd (Suc na, g) (Suc na) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (subst ring_tOp_assoc[THEN sym], assumption+, simp,\n        rule npClose, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        snd (Suc na, g) (Suc na) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           g (Suc na) \\<cdot>\\<^sub>r\n                           X^\\<^bsup>R Suc na\\<^esup>)\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (subst P_mod_mult_monomial[THEN sym, of \"I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J\"], assumption,\n       rule ring_tOp_closed, assumption+, simp add:pol_coeff_mem_R)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        snd (Suc na, g) (Suc na) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           g (Suc na))\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (rule P_mod_mult_const1, assumption+,\n       thin_tac \"P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X na (na, g))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        snd (Suc na, g) (Suc na) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<in> J\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (cut_tac n1 = na and c1 = \"(Suc na, g)\" in polyn_Suc[THEN sym], simp,\n        simp,\n        frule_tac c = \"(Suc na, g)\" and k = na in polyn_expr_short,\n        simp,  simp,\n              thin_tac \"P_mod R S X J (polyn_expr R X na (na, g))\",\n              thin_tac \"polyn_expr R X na (na, g) \\<in> carrier R\",\n              thin_tac \"polyn_expr R X na (na, g) \\<plusminus> g (Suc na) \\<cdot>\\<^sub>r (X^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r X)\n                       =  polyn_expr R X (Suc na) (Suc na, g)\",\n              thin_tac \"polyn_expr R X na (Suc na, g) =\n                                         polyn_expr R X na (na, g)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J (polyn_expr R X (Suc na) (Suc na, g));\n        pol_coeff S (na, g);\n        g (Suc na) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        g (Suc na) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<in> J\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 3. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (frule_tac p1 = \"polyn_expr R X (Suc na) (Suc na, g)\" and \n                c1 = \"(Suc na, g)\" in P_mod_mod[THEN sym, of J],\n        simp add:polyn_mem, assumption, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g) \\<plusminus>\n          polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          (g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                          (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           polyn_expr R X na (na, g) \\<plusminus>\n                           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                           (g (Suc na) \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R Suc na\\<^esup>))\n 2. \\<And>na g.\n       \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, f);\n        P_mod R S X I (polyn_expr R X n (n, f)); Subring R S; Ring S;\n        aGroup R; X \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        ideal S (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J);\n        polyn_expr R X n (n, f) \\<noteq> \\<zero>; pol_coeff S (Suc na, g);\n        P_mod R S X J\n         (polyn_expr R X na (na, g) \\<plusminus>\n          g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>);\n        pol_coeff S (na, g); P_mod R S X J (polyn_expr R X na (na, g));\n        P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n         (polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n          polyn_expr R X na (na, g));\n        polyn_expr R X na (na, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc na\\<^esup>\n                         \\<in> carrier R", "apply (simp,\n        rule ring_tOp_closed,\n        cut_tac c = \"(Suc na, g)\" and j = \"Suc na\" in pol_coeff_mem_R,\n               assumption, simp, simp, rule npClose, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult:\"\\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, c); \n      pol_coeff S (m, d); P_mod R S X I (polyn_expr R X n (n, c)); \n      P_mod R S X J (polyn_expr R X m (m, d))\\<rbrakk>  \\<Longrightarrow> \n      P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) ((polyn_expr R X n (n, c)) \\<cdot>\\<^sub>r \n                                        (polyn_expr R X m (m, d)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; pol_coeff S (n, c); pol_coeff S (m, d);\n     P_mod R S X I (polyn_expr R X n (n, c));\n     P_mod R S X J (polyn_expr R X m (m, d))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (polyn_expr R X n (n, c) \\<cdot>\\<^sub>r\n                        polyn_expr R X m (m, d))", "apply (simp add:P_mod_multTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult1:\"\\<lbrakk>ideal S I; ideal S J;\n      p \\<in> carrier R; q \\<in> carrier R; P_mod R S X I p; P_mod R S X J q\\<rbrakk>  \\<Longrightarrow> \n      P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J) (p \\<cdot>\\<^sub>r q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)\n 2. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (simp add:ring_times_0_x, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (case_tac \"q = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)\n 2. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (simp add:ring_times_x_0, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (frule s_cf_expr[of p], assumption+,\n       frule s_cf_expr[of q], assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)", "apply (cut_tac P_mod_mult[of I J \"fst (s_cf R S X p)\" \"snd (s_cf R S X p)\"\n       \"fst (s_cf R S X q)\"  \"snd (s_cf R S X q)\"])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n      (polyn_expr R X (fst (s_cf R S X p))\n        (fst (s_cf R S X p), snd (s_cf R S X p)) \\<cdot>\\<^sub>r\n       polyn_expr R X (fst (s_cf R S X q))\n        (fst (s_cf R S X q), snd (s_cf R S X q)))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> J)\n                       (p \\<cdot>\\<^sub>r q)\n 2. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ideal S I\n 3. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ideal S J\n 4. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 5. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X q), snd (s_cf R S X q))\n 6. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (fst (s_cf R S X p), snd (s_cf R S X p)))\n 7. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J\n                       (polyn_expr R X (fst (s_cf R S X q))\n                         (fst (s_cf R S X q), snd (s_cf R S X q)))", "apply (simp add:polyn_expr_split[THEN sym], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X p), snd (s_cf R S X p))\n 2. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X q), snd (s_cf R S X q))\n 3. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (fst (s_cf R S X p), snd (s_cf R S X p)))\n 4. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J\n                       (polyn_expr R X (fst (s_cf R S X q))\n                         (fst (s_cf R S X q), snd (s_cf R S X q)))", "apply (simp add:pol_coeff_split[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X q), snd (s_cf R S X q))\n 2. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I\n                       (polyn_expr R X (fst (s_cf R S X p))\n                         (fst (s_cf R S X p), snd (s_cf R S X p)))\n 3. \\<lbrakk>ideal S I; ideal S J; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; P_mod R S X J q; p \\<noteq> \\<zero>;\n     q \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     pol_coeff S (s_cf R S X q);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     q = polyn_expr R X (fst (s_cf R S X q)) (s_cf R S X q);\n     snd (s_cf R S X q) (fst (s_cf R S X q)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J\n                       (polyn_expr R X (fst (s_cf R S X q))\n                         (fst (s_cf R S X q), snd (s_cf R S X q)))", "apply (simp add:polyn_expr_split[THEN sym])+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult2l:\"\\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R; \n      P_mod R S X I p\\<rbrakk>  \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (cut_tac subring, frule subring_Ring[of S],\n       frule Ring.whole_ideal[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; Subring R S; Ring S; ideal S (carrier S)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (frule P_mod_whole[of q])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; Subring R S; Ring S; ideal S (carrier S);\n     P_mod R S X (carrier S) q\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (frule P_mod_mult1[of I \"carrier S\" p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I p; Subring R S; Ring S; ideal S (carrier S);\n     P_mod R S X (carrier S) q;\n     P_mod R S X (I \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> carrier S)\n      (p \\<cdot>\\<^sub>r q)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (simp add:Ring.idealprod_whole_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_mult2r:\"\\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R; \n      P_mod R S X I q\\<rbrakk>  \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I q\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (cut_tac subring, frule subring_Ring[of S],\n       frule Ring.whole_ideal[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I q; Subring R S; Ring S; ideal S (carrier S)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (frule P_mod_whole[of p])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I q; Subring R S; Ring S; ideal S (carrier S);\n     P_mod R S X (carrier S) p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (frule P_mod_mult1[of \"carrier S\" I p q], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S I; p \\<in> carrier R; q \\<in> carrier R;\n     P_mod R S X I q; Subring R S; Ring S; ideal S (carrier S);\n     P_mod R S X (carrier S) p;\n     P_mod R S X (carrier S \\<diamondsuit>\\<^sub>r\\<^bsub>S\\<^esub> I)\n      (p \\<cdot>\\<^sub>r q)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X I (p \\<cdot>\\<^sub>r q)", "apply (simp add:Ring.idealprod_whole_l)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) csrp_fn_pol_coeff:\"\\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       pol_coeff (S /\\<^sub>r P) (n,  c')\\<rbrakk> \\<Longrightarrow>\n                          pol_coeff S (n, (cmp (csrp_fn S P) c'))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, cmp (csrp_fn S P) c')", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, cmp (csrp_fn S P) c')", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     \\<forall>j\\<le>n. c' j \\<in> carrier (S /\\<^sub>r P); Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (csrp_fn S P) c' j \\<in> carrier S", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n        \\<forall>j\\<le>n. c' j \\<in> carrier (S /\\<^sub>r P); Subring R S;\n        Ring S; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> csrp_fn S P (c' j) \\<in> carrier S", "apply (rule Ring.csrp_fn_mem[of S P], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n        \\<forall>j\\<le>n. c' j \\<in> carrier (S /\\<^sub>r P); Subring R S;\n        Ring S; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> c' j \\<in> carrier (S /\\<^sub>r P)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pj_csrp_mem_coeff:\"\\<lbrakk>ideal S P; pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk>\n      \\<Longrightarrow> \\<forall>j \\<le> n. (pj S P) ((csrp_fn S P) (c' j)) = c' j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S P; pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. pj S P (csrp_fn S P (c' j)) = c' j", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal S P; pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. pj S P (csrp_fn S P (c' j)) = c' j", "apply (rule allI, rule impI, simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>ideal S P;\n        \\<forall>j\\<le>n. c' j \\<in> carrier (S /\\<^sub>r P); Subring R S;\n        Ring S; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> pj S P (csrp_fn S P (c' j)) = c' j", "apply (simp add:Ring.csrp_pj)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pHom_pj_csrp:\"\\<lbrakk>Idomain S; ideal S P;\n             PolynRg R' (S /\\<^sub>r P) Y; pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk> \\<Longrightarrow>\n              erH R S X R' (S /\\<^sub>r P) Y (pj S P) \n                 (polyn_expr R X n (n, (cmp (csrp_fn S P) c')))\n                                     = polyn_expr R' Y n (n, c')\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c')\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (polyn_expr R X n (n, cmp (csrp_fn S P) c')) =\n                      polyn_expr R' Y n (n, c')", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.qring_ring[of \"S\" \"P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (polyn_expr R X n (n, cmp (csrp_fn S P) c')) =\n                      polyn_expr R' Y n (n, c')", "apply (subst pHom_mem[of R' \"(S /\\<^sub>r P)\" Y \"erH R S X R' (S /\\<^sub>r P) Y (pj S P)\" \n      n  \"cmp (csrp_fn S P) c'\"], assumption+,\n      rule erH_rHom[of R' \"S /\\<^sub>r P\" Y \"pj S P\"],\n       assumption+,\n      simp add:pj_Hom, simp add:csrp_fn_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R' Y n\n                       (n, cmp (erH R S X R' (S /\\<^sub>r P) Y (pj S P))\n                            (cmp (csrp_fn S P) c')) =\n                      polyn_expr R' Y n (n, c')", "apply (rule PolynRg.polyn_exprs_eq[of R' \"S /\\<^sub>r P\" Y \n       \"(n, cmp (erH R S X R' (S /\\<^sub>r P) Y (pj S P)) (cmp (csrp_fn S P) c'))\"\n       \"(n, c')\" n], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff (S /\\<^sub>r P)\n                       (n, cmp (erH R S X R' (S /\\<^sub>r P) Y (pj S P))\n                            (cmp (csrp_fn S P) c'))\n 2. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff (S /\\<^sub>r P) (n, c')\n 3. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> n \\<le> min (fst (n,\n  cmp (erH R S X R' (S /\\<^sub>r P) Y (pj S P)) (cmp (csrp_fn S P) c')))\n                               (fst (n, c'))\n 4. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         snd (n, cmp (erH R S X R' (S /\\<^sub>r P) Y\n (pj S P))\n                                  (cmp (csrp_fn S P) c'))\n                          j =\n                         snd (n, c') j", "apply (frule csrp_fn_pol_coeff[of P R' Y n c'], assumption+,\n       frule erH_rHom [of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+,\n       simp add:pj_Hom,\n       rule cmp_pol_coeff_e[of R' \"S /\\<^sub>r P\" Y \"erH R S X R' (S /\\<^sub>r P) Y (pj S P)\"\n       n \"cmp (csrp_fn S P) c'\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n     Ring (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         snd (n, cmp (erH R S X R' (S /\\<^sub>r P) Y\n (pj S P))\n                                  (cmp (csrp_fn S P) c'))\n                          j =\n                         snd (n, c') j", "apply (rule allI, rule impI, simp add:cmp_def,\n       frule_tac c = \"(n, c')\" and j = j in \n             PolynRg.pol_coeff_mem[of R' \"S /\\<^sub>r P\" Y], assumption+, simp+,\n       frule_tac x = \"c' j\" in Ring.csrp_fn_mem[of S P], assumption+,\n       frule_tac s = \"csrp_fn S P (c' j)\" in \n            erH_rHom_cf[of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+,\n            simp add:pj_Hom, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n        pol_coeff (S /\\<^sub>r P) (n, c'); Subring R S; Ring S;\n        Ring (S /\\<^sub>r P); j \\<le> n; c' j \\<in> carrier (S /\\<^sub>r P);\n        csrp_fn S P (c' j) \\<in> carrier S;\n        erH R S X R' (S /\\<^sub>r P) Y (pj S P) (csrp_fn S P (c' j)) =\n        pj S P (csrp_fn S P (c' j))\\<rbrakk>\n       \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                          (csrp_fn S P (c' j)) =\n                         c' j", "apply (simp add:pj_csrp_mem_coeff)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_csrp_fn_nonzero:\"\\<lbrakk>Idomain S; ideal S P; \n      PolynRg R' (S /\\<^sub>r P) Y; g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub> \\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X (deg_n R' (S /\\<^sub>r P) Y g') ((deg_n R' (S /\\<^sub>r P) Y g'),\n          (cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R' (S /\\<^sub>r P) Y g')\n                       (deg_n R' (S /\\<^sub>r P) Y g',\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g'))) \\<noteq>\n                      \\<zero>", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.qring_ring[of \"S\" \"P\"], assumption+,\n       frule pj_Hom[of \"S\" \"P\"], assumption+,\n       frule PolynRg.s_cf_expr[of R' \"S /\\<^sub>r P\" Y g'], assumption+,\n       (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R' (S /\\<^sub>r P) Y g')\n                       (deg_n R' (S /\\<^sub>r P) Y g',\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g'))) \\<noteq>\n                      \\<zero>", "apply (simp add:PolynRg.s_cf_deg[THEN sym, of R' \"S /\\<^sub>r P\" Y g'],\n       frule csrp_fn_pol_coeff[of P R' Y \"deg_n R' (S /\\<^sub>r P) Y g'\"\n                  \"snd (s_cf R' (S /\\<^sub>r P) Y g')\"], assumption+,\n       simp add:PolynRg.s_cf_deg[of R' \"S /\\<^sub>r P\" Y g'])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (deg_n R' (S /\\<^sub>r P) Y g')\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (deg_n R' (S /\\<^sub>r P) Y g') \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     pol_coeff S\n      (deg_n R' (S /\\<^sub>r P) Y g',\n       cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R' (S /\\<^sub>r P) Y g')\n                       (deg_n R' (S /\\<^sub>r P) Y g',\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g'))) \\<noteq>\n                      \\<zero>", "apply (subst coeff_nonzero_polyn_nonzero[of \"(deg_n R' (S /\\<^sub>r P) Y g', \n             cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\" \n             \"deg_n R' (S /\\<^sub>r P) Y g'\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (deg_n R' (S /\\<^sub>r P) Y g')\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (deg_n R' (S /\\<^sub>r P) Y g') \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     pol_coeff S\n      (deg_n R' (S /\\<^sub>r P) Y g',\n       cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>j\\<le>deg_n R' (S /\\<^sub>r P) Y g'.\n                         snd (deg_n R' (S /\\<^sub>r P) Y g',\n                              cmp (csrp_fn S P)\n                               (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n                          j \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:cmp_def, rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (deg_n R' (S /\\<^sub>r P) Y g')\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (deg_n R' (S /\\<^sub>r P) Y g') \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     pol_coeff S\n      (deg_n R' (S /\\<^sub>r P) Y g',\n       \\<lambda>x. csrp_fn S P (snd (s_cf R' (S /\\<^sub>r P) Y g') x));\n     \\<forall>j\\<le>deg_n R' (S /\\<^sub>r P) Y g'.\n        csrp_fn S P (snd (s_cf R' (S /\\<^sub>r P) Y g') j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (drule_tac a = \"deg_n R' (S /\\<^sub>r P) Y g'\" in forall_spec, simp,\n       frule pj_csrp_mem_coeff[of P \"deg_n R' (S /\\<^sub>r P) Y g'\" \n                                \"snd (s_cf R' (S /\\<^sub>r P) Y g')\"],\n       simp add:PolynRg.s_cf_deg[of R' \"S /\\<^sub>r P\" Y g'])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (deg_n R' (S /\\<^sub>r P) Y g')\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (deg_n R' (S /\\<^sub>r P) Y g') \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     pol_coeff S\n      (deg_n R' (S /\\<^sub>r P) Y g',\n       \\<lambda>x. csrp_fn S P (snd (s_cf R' (S /\\<^sub>r P) Y g') x));\n     csrp_fn S P\n      (snd (s_cf R' (S /\\<^sub>r P) Y g') (deg_n R' (S /\\<^sub>r P) Y g')) =\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>deg_n R' (S /\\<^sub>r P) Y g'.\n        pj S P (csrp_fn S P (snd (s_cf R' (S /\\<^sub>r P) Y g') j)) =\n        snd (s_cf R' (S /\\<^sub>r P) Y g') j\\<rbrakk>\n    \\<Longrightarrow> False", "apply (drule_tac a = \"deg_n R' (S /\\<^sub>r P) Y g'\" in forall_spec, simp,\n       simp,\n       frule pj_Hom[of S P], assumption, simp add:rHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) erH_inv:\"\\<lbrakk>Idomain S; ideal S P; Ring R'; \n       PolynRg R' (S /\\<^sub>r P) Y; g' \\<in> carrier R'\\<rbrakk> \\<Longrightarrow> \n      \\<exists>g\\<in>carrier R. deg R S X g \\<le> (deg R' (S /\\<^sub>r P) Y g') \\<and>\n                (erH R S X R' (S /\\<^sub>r P) Y (pj S P)) g = g'\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.qring_ring[of \"S\" \"P\"], assumption+,\n       frule pj_Hom[of \"S\" \"P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (frule erH_rHom[of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (case_tac \"g' = \\<zero>\\<^bsub>R'\\<^esub>\", simp,\n       frule erH_rHom_0[of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+,\n       cut_tac ring_zero,\n       subgoal_tac \"deg R S X (\\<zero>) \\<le> deg R' (S /\\<^sub>r P) Y g'\", blast,\n       simp add:deg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (frule PolynRg.s_cf_expr [of R' \"S /\\<^sub>r P\" Y g'], assumption+,\n       (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     g' =\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (frule pHom_pj_csrp[of P R' Y \"fst (s_cf R' (S /\\<^sub>r P) Y g')\" \n                      \"snd (s_cf R' (S /\\<^sub>r P) Y g')\"], assumption+,\n       simp add:PolynRg.pol_coeff_split[THEN sym],\n       drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g\\<in>carrier R.\n                         deg R S X g\n                         \\<le> deg R' (S /\\<^sub>r P) Y g' \\<and>\n                         erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = g'", "apply (subgoal_tac \"deg R S X (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) \n           Y g')) (fst (s_cf R' (S /\\<^sub>r P) Y g'), cmp (csrp_fn S P) \n          (snd (s_cf R' (S /\\<^sub>r P) Y g')))) \\<le> deg R' (S /\\<^sub>r P) Y g'\",\n         subgoal_tac \"polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n          (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n           cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g'))) \\<in> carrier R\",\n         blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g';\n     deg R S X\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n     \\<le> deg R' (S /\\<^sub>r P) Y g'\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n                      \\<in> carrier R\n 2. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                          cmp (csrp_fn S P)\n                           (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n                      \\<le> deg R' (S /\\<^sub>r P) Y g'", "apply(thin_tac \" deg R S X\n         (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n         \\<le> deg R' (S /\\<^sub>r P) Y g'\",\n     thin_tac \"polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g')) \n         (s_cf R' (S /\\<^sub>r P) Y g') = g'\",\n     thin_tac \"erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n         (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) = g'\",\n     thin_tac \"snd (s_cf R' (S /\\<^sub>r P) Y g') (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n               \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g')\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n                      \\<in> carrier R\n 2. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                          cmp (csrp_fn S P)\n                           (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n                      \\<le> deg R' (S /\\<^sub>r P) Y g'", "apply (rule_tac c = \"(fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\" and \n         k = \"fst (s_cf R' (S /\\<^sub>r P) Y g')\" in polyn_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g')\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n 2. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g')\\<rbrakk>\n    \\<Longrightarrow> fst (s_cf R' (S /\\<^sub>r P) Y g')\n                      \\<le> fst (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                                 cmp (csrp_fn S P)\n                                  (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n 3. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                          cmp (csrp_fn S P)\n                           (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n                      \\<le> deg R' (S /\\<^sub>r P) Y g'", "apply (rule csrp_fn_pol_coeff, assumption+,\n         simp, simp,\n         cut_tac pol_deg_le_n[of \"polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n          (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n          cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\"\n            \"(fst (s_cf R' (S /\\<^sub>r P) Y g'),\n          cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g';\n     deg_n R S X\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n     \\<le> fst (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                cmp (csrp_fn S P)\n                 (snd (s_cf R' (S /\\<^sub>r P) Y g')))\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                         (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                          cmp (csrp_fn S P)\n                           (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n                      \\<le> deg R' (S /\\<^sub>r P) Y g'\n 2. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n                      \\<in> carrier R\n 3. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))\n 4. \\<lbrakk>Idomain S; ideal S P; Ring R'; PolynRg R' (S /\\<^sub>r P) Y;\n     g' \\<in> carrier R'; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     g' \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n     pol_coeff (S /\\<^sub>r P) (s_cf R' (S /\\<^sub>r P) Y g');\n     snd (s_cf R' (S /\\<^sub>r P) Y g')\n      (fst (s_cf R' (S /\\<^sub>r P) Y g')) \\<noteq>\n     \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n        (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n         cmp (csrp_fn S P) (snd (s_cf R' (S /\\<^sub>r P) Y g')))) =\n     g';\n     polyn_expr R' Y (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n      (s_cf R' (S /\\<^sub>r P) Y g') =\n     g'\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (s_cf R' (S /\\<^sub>r P) Y g'))\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g'))) =\n                      polyn_expr R X\n                       (fst (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                             cmp (csrp_fn S P)\n                              (snd (s_cf R' (S /\\<^sub>r P) Y g'))))\n                       (fst (s_cf R' (S /\\<^sub>r P) Y g'),\n                        cmp (csrp_fn S P)\n                         (snd (s_cf R' (S /\\<^sub>r P) Y g')))", "apply (simp, \n        simp add:PolynRg.s_cf_deg[THEN sym, of R' \"S /\\<^sub>r P\" Y g'],\n        frule ext_csrp_fn_nonzero[of P R' Y g'], assumption+,\n        simp add:deg_def, simp add:ale_natle,\n        rule polyn_mem, simp add:csrp_fn_pol_coeff, simp,\n        simp add:csrp_fn_pol_coeff, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_0:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       g \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = \\<zero>\\<^bsub>R'\\<^esub>) = (P_mod R S X P g)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.qring_ring[of \"S\" \"P\"], assumption+,\n       frule pj_Hom[of \"S\" \"P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P)\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (case_tac \"g = \\<zero>\\<^bsub>R\\<^esub>\",\n       cut_tac ring_zero, simp add:P_mod_def,\n       rule erH_rHom_0[of R' \"S /\\<^sub>r P\" Y \"pj S P\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (frule s_cf_expr[of g], assumption+, (erule conjE)+,\n       cut_tac polyn_expr_split[of \"fst (s_cf R S X g)\" \"s_cf R S X g\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) =\n     polyn_expr R X (fst (s_cf R S X g))\n      (fst (s_cf R S X g), snd (s_cf R S X g))\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (frule erH_map[of R' \"S /\\<^sub>r P\" Y \"pj S P\" \"fst (s_cf R S X g)\" \n                        \"snd (s_cf R S X g)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) =\n     polyn_expr R X (fst (s_cf R S X g))\n      (fst (s_cf R S X g), snd (s_cf R S X g))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (fst (s_cf R S X g), snd (s_cf R S X g))\n 2. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) =\n     polyn_expr R X (fst (s_cf R S X g))\n      (fst (s_cf R S X g), snd (s_cf R S X g));\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R S X g))\n        (fst (s_cf R S X g), snd (s_cf R S X g))) =\n     polyn_expr R' Y (fst (s_cf R S X g))\n      (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (subst pol_coeff_split[THEN sym], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) =\n     polyn_expr R X (fst (s_cf R S X g))\n      (fst (s_cf R S X g), snd (s_cf R S X g));\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n      (polyn_expr R X (fst (s_cf R S X g))\n        (fst (s_cf R S X g), snd (s_cf R S X g))) =\n     polyn_expr R' Y (fst (s_cf R S X g))\n      (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n     polyn_expr R' Y (fst (s_cf R S X g))\n      (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)));\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) = g\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R' Y (fst (s_cf R S X g))\n                        (fst (s_cf R S X g),\n                         cmp (pj S P) (snd (s_cf R S X g))) =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (thin_tac \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n       polyn_expr R' Y (fst (s_cf R S X g))\n      (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) = g\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R' Y (fst (s_cf R S X g))\n                        (fst (s_cf R S X g),\n                         cmp (pj S P) (snd (s_cf R S X g))) =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (rotate_tac -1, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g)\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R' Y (fst (s_cf R S X g))\n                        (fst (s_cf R S X g),\n                         cmp (pj S P) (snd (s_cf R S X g))) =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      P_mod R S X P g", "apply (subst P_mod_mod[THEN sym, of P g \"s_cf R S X g\"], assumption+,\n       thin_tac \"g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g)\",\n       frule erH_rHom_coeff[of R' \"S /\\<^sub>r P\" Y \"pj S P\" \"fst (s_cf R S X g)\"\n       \"snd (s_cf R S X g)\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff (S /\\<^sub>r P)\n      (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R' Y (fst (s_cf R S X g))\n                        (fst (s_cf R S X g),\n                         cmp (pj S P) (snd (s_cf R S X g))) =\n                       \\<zero>\\<^bsub>R'\\<^esub>) =\n                      (\\<forall>j\\<le>fst (s_cf R S X g).\n                          snd (s_cf R S X g) j \\<in> P)", "apply (subst PolynRg.coeff_0_pol_0[THEN sym, of R' \"S /\\<^sub>r P\" Y \n        \"(fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\" \n        \"fst (s_cf R S X g)\"], assumption+, simp,\n       thin_tac \"pol_coeff (S /\\<^sub>r P)\n       (fst (s_cf R S X g), cmp (pj S P) (snd (s_cf R S X g)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst (s_cf R S X g).\n                          snd (fst (s_cf R S X g),\n                               cmp (pj S P) (snd (s_cf R S X g)))\n                           j =\n                          \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>) =\n                      (\\<forall>j\\<le>fst (s_cf R S X g).\n                          snd (s_cf R S X g) j \\<in> P)", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst (s_cf R S X g).\n                          pj S P (snd (s_cf R S X g) j) =\n                          \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>) =\n                      (\\<forall>j\\<le>fst (s_cf R S X g).\n                          snd (s_cf R S X g) j \\<in> P)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>fst (s_cf R S X g).\n        pj S P (snd (s_cf R S X g) j) =\n        \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         snd (s_cf R S X g) j \\<in> P\n 2. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>fst (s_cf R S X g).\n        snd (s_cf R S X g) j \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         pj S P (snd (s_cf R S X g) j) =\n                         \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, assumption,\n        frule_tac j = j in pol_coeff_mem[of \"s_cf R S X g\"], assumption+,\n        simp add:pj_zero[of S P])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; Subring R S; Ring S; Ring (S /\\<^sub>r P);\n     pj S P \\<in> rHom S (S /\\<^sub>r P); g \\<noteq> \\<zero>;\n     pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     \\<forall>j\\<le>fst (s_cf R S X g).\n        snd (s_cf R S X g) j \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         pj S P (snd (s_cf R S X g) j) =\n                         \\<zero>\\<^bsub>S /\\<^sub>r P\\<^esub>", "apply (rule allI, rule impI,\n        drule_tac a = j in forall_spec, assumption,\n        frule_tac j = j in pol_coeff_mem[of \"s_cf R S X g\"], assumption+,\n        simp add:pj_zero[THEN sym, of S P])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_I_J:\"\\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; \n          I \\<subseteq> J;  P_mod R S X I p\\<rbrakk> \\<Longrightarrow> P_mod R S X J p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J p", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<zero> \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I \\<zero>; p = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J \\<zero>\n 2. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I p; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J p", "apply (simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I p; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J p", "apply (frule s_cf_expr[of p], assumption, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I p; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J p", "apply (frule P_mod_mod[THEN sym, of I p \"s_cf R S X p\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     P_mod R S X I p; p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X I p =\n     (\\<forall>j\\<le>fst (s_cf R S X p).\n         snd (s_cf R S X p) j \\<in> I)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X J p", "apply (subst P_mod_mod[THEN sym, of J p \"s_cf R S X p\"], assumption+, \n        thin_tac \"p = polyn_expr R X (fst (s_cf R S X p)) (s_cf R S X p)\",\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; ideal S I; ideal S J; I \\<subseteq> J;\n     \\<forall>j\\<le>fst (s_cf R S X p). snd (s_cf R S X p) j \\<in> I;\n     p \\<noteq> \\<zero>; pol_coeff S (s_cf R S X p);\n     snd (s_cf R S X p) (fst (s_cf R S X p)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X I p\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X p).\n                         snd (s_cf R S X p) j \\<in> J", "apply (rule allI, rule impI, drule_tac a = j in forall_spec, assumption,\n        simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_n_1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; \n       P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)) g\\<rbrakk> \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n      g\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.npClose[of S t n], assumption+,\n       frule Ring.npClose[of S t \"Suc n\"], assumption+,\n       frule Ring.principal_ideal[of S t], assumption+, \n       frule Ring.principal_ideal[of S \"t^\\<^bsup>S (Suc n)\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n     t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (case_tac \"g = \\<zero>\\<^bsub>R\\<^esub>\", simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n     t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>));\n     g \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (frule s_cf_expr[of g], assumption,\n        (erule conjE)+,\n       subst P_mod_mod[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" \"g\" \"s_cf R S X g\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n     t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>));\n     g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         snd (s_cf R S X g) j\n                         \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (frule_tac P_mod_mod[THEN sym, of \"S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)\" g \"s_cf R S X g\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n     t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>));\n     g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g =\n     (\\<forall>j\\<le>fst (s_cf R S X g).\n         snd (s_cf R S X g) j\n         \\<in> S \\<diamondsuit>\\<^sub>p\n               (t^\\<^bsup>S Suc n\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         snd (s_cf R S X g) j\n                         \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (simp del:npow_suc,\n       thin_tac \"g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     \\<forall>j\\<le>fst (s_cf R S X g).\n        snd (s_cf R S X g) j\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>);\n     Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n     t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>));\n     g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n     snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n      g\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                         snd (s_cf R S X g) j\n                         \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (rule allI, rule impI,\n       drule_tac a = j in forall_spec, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        Subring R S; Ring S; t^\\<^bsup>S n\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S Suc n\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>));\n        g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n        snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         g;\n        j \\<le> fst (s_cf R S X g);\n        snd (s_cf R S X g) j\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> snd (s_cf R S X g) j\n                         \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (simp add:Rxa_def, erule bexE, simp,\n       simp add:Ring.ring_tOp_assoc[THEN sym, of S],\n       frule_tac x = r and y = \"t^\\<^bsup>S n\\<^esup>\" in Ring.ring_tOp_closed, assumption+,\n       blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_n_m:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; \n      m \\<le> n; P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)) g\\<rbrakk> \\<Longrightarrow> \n               P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n      g\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       g", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       g", "apply (rule P_mod_I_J[of g \"S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)\" \"S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)\"],\n       assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> ideal S\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> ideal S\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)\n                      \\<subseteq> S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>)\n 4. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (rule Ring.principal_ideal, assumption+,\n        rule Ring.npClose, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> ideal S\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)\n                      \\<subseteq> S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>)\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (rule Ring.principal_ideal, assumption+,\n        rule Ring.npClose, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)\n                      \\<subseteq> S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>)\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc n)\\<^esup>)) g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)\n                      \\<subseteq> S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>)\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n        Subring R S; Ring S;\n        x \\<in> S \\<diamondsuit>\\<^sub>p\n                (t^\\<^bsup>S Suc n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> S \\<diamondsuit>\\<^sub>p\n                                 (t^\\<^bsup>S Suc m\\<^esup>)\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (simp del:npow_suc add:Rxa_def, erule bexE, simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n        Subring R S; Ring S; r \\<in> carrier S;\n        x =\n        r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        t^\\<^bsup>S Suc n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ra\\<in>carrier S.\n                            r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc n\\<^esup> =\n                            ra \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc m\\<^esup>\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (frule Ring.npMulDistr[THEN sym, of S t \"Suc n - Suc m\" \"Suc m\"],\n          assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n        Subring R S; Ring S; r \\<in> carrier S;\n        x = r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t^\\<^bsup>S Suc n\\<^esup>;\n        t^\\<^bsup>S (Suc n - Suc m + Suc m)\\<^esup> =\n        t^\\<^bsup>S (Suc n - Suc m)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n        t^\\<^bsup>S Suc m\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ra\\<in>carrier S.\n                            r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc n\\<^esup> =\n                            ra \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc m\\<^esup>\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (simp del:npow_suc,\n          thin_tac \"t^\\<^bsup>S (Suc n)\\<^esup> = t^\\<^bsup>S (n - m)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t^\\<^bsup>S (Suc m)\\<^esup>\",\n          thin_tac \"x = r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (t^\\<^bsup>S (n - m)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t^\\<^bsup>S (Suc m)\\<^esup>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n        Subring R S; Ring S; r \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ra\\<in>carrier S.\n                            r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            (t^\\<^bsup>S (n -\n    m)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             t^\\<^bsup>S Suc m\\<^esup>) =\n                            ra \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc m\\<^esup>\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (subst Ring.ring_tOp_assoc[THEN sym, of S], assumption+,\n          (rule Ring.npClose, assumption+)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n        Subring R S; Ring S; r \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ra\\<in>carrier S.\n                            r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S (n -\n   m)\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc m\\<^esup> =\n                            ra \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            t^\\<^bsup>S Suc m\\<^esup>\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply (frule_tac x = r and y = \"t^\\<^bsup>S (n - m)\\<^esup>\" in Ring.ring_tOp_closed,\n           assumption+,\n          rule Ring.npClose, assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R; m \\<le> n;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>)) g;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc n\\<^esup>))\n                       g", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_diff:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n       g \\<in> carrier R; h \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n    (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = (erH R S X R' (S /\\<^sub>r P) Y (pj S P) h))\n     = (P_mod R S X P (g \\<plusminus> -\\<^sub>a h))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       erH R S X R' (S /\\<^sub>r P) Y (pj S P) h) =\n                      P_mod R S X P (g \\<plusminus> -\\<^sub>a h)", "apply (cut_tac ring_is_ag,\n       frule PolynRg.is_Ring[of R'],\n       cut_tac subring,\n       frule subring_Ring,\n       frule Ring.qring_ring[of S P], assumption+,\n       frule pj_Hom[of \"S\" \"P\"], assumption+,\n       frule erH_rHom[of R' \"S /\\<^sub>r P\" Y \"pj S P\"],\n       assumption+,\n       frule Ring.ring_is_ag[of R'])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       erH R S X R' (S /\\<^sub>r P) Y (pj S P) h) =\n                      P_mod R S X P (g \\<plusminus> -\\<^sub>a h)", "apply (frule erH_mem[of R' \"S /\\<^sub>r P\" Y \"pj S P\" g], assumption+,\n       frule erH_mem[of R' \"S /\\<^sub>r P\" Y \"pj S P\" h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R'\\<rbrakk>\n    \\<Longrightarrow> (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                       erH R S X R' (S /\\<^sub>r P) Y (pj S P) h) =\n                      P_mod R S X P (g \\<plusminus> -\\<^sub>a h)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X P (g \\<plusminus> -\\<^sub>a h)\n 2. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     P_mod R S X P (g \\<plusminus> -\\<^sub>a h)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P) h", "apply (frule_tac a = \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) g\" and \n                 b = \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) h\" in \n       aGroup.ag_eq_diffzero[of R'], assumption+, simp,\n       simp add:erH_minus[THEN sym, of R' \"S /\\<^sub>r P\" Y \"pj S P\" h],\n       drule sym, simp,\n       thin_tac \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) h =\n                        erH R S X R' (S /\\<^sub>r P) Y (pj S P) g\",\n       frule_tac x = h in aGroup.ag_mOp_closed, assumption+,\n       simp add:erH_add[THEN sym, of  R' \"S /\\<^sub>r P\" Y \"pj S P\" g \"-\\<^sub>a h\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) (g \\<plusminus> -\\<^sub>a h) =\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     -\\<^sub>a h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X P (g \\<plusminus> -\\<^sub>a h)\n 2. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     P_mod R S X P (g \\<plusminus> -\\<^sub>a h)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P) h", "apply (subst P_mod_0[THEN sym, of P R' Y \"g \\<plusminus> -\\<^sub>a h\"], assumption+,\n         rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     P_mod R S X P (g \\<plusminus> -\\<^sub>a h)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P) h", "apply (frule_tac a = \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) g\" and \n                 b = \"erH R S X R' (S /\\<^sub>r P) Y (pj S P) h\" in \n       aGroup.ag_eq_diffzero[of R'], assumption+, simp,\n       simp add:erH_minus[THEN sym, of R' \"S /\\<^sub>r P\" Y \"pj S P\" h])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     P_mod R S X P (g \\<plusminus> -\\<^sub>a h);\n     (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n      erH R S X R' (S /\\<^sub>r P) Y (pj S P) h) =\n     (erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n       g \\<plusminus>\\<^bsub>R'\\<^esub>\n      erH R S X R' (S /\\<^sub>r P) Y (pj S P) (-\\<^sub>a h) =\n      \\<zero>\\<^bsub>R'\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       g \\<plusminus>\\<^bsub>R'\\<^esub>\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (-\\<^sub>a h) =\n                      \\<zero>\\<^bsub>R'\\<^esub>", "apply (subst erH_add[THEN sym, of  R' \"S /\\<^sub>r P\" Y \"pj S P\" g \"-\\<^sub>a h\"],\n          assumption+,\n          rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; h \\<in> carrier R; aGroup R; Ring R'; Subring R S;\n     Ring S; Ring (S /\\<^sub>r P); pj S P \\<in> rHom S (S /\\<^sub>r P);\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n     \\<in> pHom R S X, R' S /\\<^sub>r P Y;\n     aGroup R'; erH R S X R' (S /\\<^sub>r P) Y (pj S P) g \\<in> carrier R';\n     erH R S X R' (S /\\<^sub>r P) Y (pj S P) h \\<in> carrier R';\n     P_mod R S X P (g \\<plusminus> -\\<^sub>a h);\n     (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n      erH R S X R' (S /\\<^sub>r P) Y (pj S P) h) =\n     (erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n       g \\<plusminus>\\<^bsub>R'\\<^esub>\n      erH R S X R' (S /\\<^sub>r P) Y (pj S P) (-\\<^sub>a h) =\n      \\<zero>\\<^bsub>R'\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (g \\<plusminus> -\\<^sub>a h) =\n                      \\<zero>\\<^bsub>R'\\<^esub>", "apply (subst P_mod_0[of P R' Y \"g \\<plusminus> -\\<^sub>a h\"], assumption+,\n          rule aGroup.ag_pOp_closed, assumption+,\n          rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_erH:\"\\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y; \n        g \\<in> carrier R; v \\<in> carrier R; t \\<in> P \\<rbrakk> \\<Longrightarrow>\n        (erH R S X R' (S /\\<^sub>r P) Y (pj S P) g = \n                  (erH R S X R' (S /\\<^sub>r P) Y (pj S P) (g \\<plusminus> (t \\<cdot>\\<^sub>r v))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; v \\<in> carrier R; t \\<in> P\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (g \\<plusminus> t \\<cdot>\\<^sub>r v)", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag,\n       frule Ring.ideal_subset[of S P t], assumption+,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       frule ring_tOp_closed[of t v], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; v \\<in> carrier R; t \\<in> P; Subring R S; Ring S;\n     aGroup R; t \\<in> carrier S; t \\<in> carrier R;\n     t \\<cdot>\\<^sub>r v \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X R' (S /\\<^sub>r P) Y (pj S P) g =\n                      erH R S X R' (S /\\<^sub>r P) Y (pj S P)\n                       (g \\<plusminus> t \\<cdot>\\<^sub>r v)", "apply (subst P_mod_diff[of P R' Y g \"g \\<plusminus> (t \\<cdot>\\<^sub>r v)\"], assumption+,\n       rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; v \\<in> carrier R; t \\<in> P; Subring R S; Ring S;\n     aGroup R; t \\<in> carrier S; t \\<in> carrier R;\n     t \\<cdot>\\<^sub>r v \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X P\n                       (g \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus> t \\<cdot>\\<^sub>r v))", "apply (simp add:aGroup.ag_p_inv,\n       frule aGroup.ag_mOp_closed[of R g], assumption+,\n       frule aGroup.ag_mOp_closed[of R \"t \\<cdot>\\<^sub>r v\"], assumption+,\n       subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n       simp add:aGroup.ag_r_inv1, simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S P; PolynRg R' (S /\\<^sub>r P) Y;\n     g \\<in> carrier R; v \\<in> carrier R; t \\<in> P; Subring R S; Ring S;\n     aGroup R; t \\<in> carrier S; t \\<in> carrier R;\n     t \\<cdot>\\<^sub>r v \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n     -\\<^sub>a t \\<cdot>\\<^sub>r v \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X P (-\\<^sub>a t \\<cdot>\\<^sub>r v)", "apply (rule P_mod_minus[of P \"t \\<cdot>\\<^sub>r v\"], assumption+,\n       frule P_mod_mult1[of P \"carrier S\" t v],\n       simp add:Ring.whole_ideal, assumption+,\n       subst P_mod_coeffTr[of P t], assumption+,\n       rule P_mod_whole[of v], assumption+,\n       simp add:Ring.idealprod_whole_r[of S P])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_principalTr:\"\\<lbrakk>t \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n    \\<forall>f. pol_coeff S (n, f) \\<and> (\\<forall>j \\<le> n. f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n          (\\<exists>f'. pol_coeff S (n, f') \\<and> (\\<forall>j \\<le> n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (f' j)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. t \\<in> carrier S \\<Longrightarrow>\n    \\<forall>f.\n       pol_coeff S (n, f) \\<and>\n       (\\<forall>j\\<le>n.\n           f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n       (\\<exists>f'.\n           pol_coeff S (n, f') \\<and>\n           (\\<forall>j\\<le>n.\n               f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j))", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f.\n                         pol_coeff S (n, f) \\<and>\n                         (\\<forall>j\\<le>n.\n                             f j\n                             \\<in> S \\<diamondsuit>\\<^sub>p\n                                   t) \\<longrightarrow>\n                         (\\<exists>f'.\n                             pol_coeff S (n, f') \\<and>\n                             (\\<forall>j\\<le>n.\n                                 f j =\n                                 t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j))", "apply (induct_tac n,\n       rule allI, rule impI, erule conjE, \n       simp add:Rxa_def, erule bexE,\n       simp add:Ring.ring_tOp_commute[of S _ t],\n       subgoal_tac \"pol_coeff S (0, (\\<lambda>j. r))\",\n       subgoal_tac \"t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((\\<lambda>j. r) 0)\", blast,\n       simp, \n       simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            pol_coeff S (Suc n, f) \\<and>\n                            (\\<forall>j\\<le>Suc n.\n                                f j\n                                \\<in> S \\<diamondsuit>\\<^sub>p\nt) \\<longrightarrow>\n                            (\\<exists>f'.\n                                pol_coeff S (Suc n, f') \\<and>\n                                (\\<forall>j\\<le>Suc n.\n                                    f j =\n                                    t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                    f' j))", "apply (rule allI, rule impI, erule conjE,\n       frule_tac n = n and f = f in pol_coeff_pre,\n       subgoal_tac \"\\<forall>j \\<le> n. f j \\<in> S \\<diamondsuit>\\<^sub>p t\",\n       drule_tac a = f in forall_spec, simp,\n       erule exE, erule conjE,\n       frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in \n        pol_coeff_mem, simp, simp,\n        drule_tac x = \"Suc n\" in spec, simp,\n        simp add:Rxa_def,\n        erule bexE, simp add:Ring.ring_tOp_commute[of \"S\" _ \"t\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f f' r.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f); pol_coeff S (n, f);\n        \\<forall>j\\<le>n.\n           \\<exists>r\\<in>carrier S.\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        pol_coeff S (n, f');\n        \\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r \\<in> carrier S;\n        r \\<in> carrier S;\n        f (Suc n) = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>f'.\n                            pol_coeff S (Suc n, f') \\<and>\n                            (\\<forall>j\\<le>Suc n.\n                                f j =\n                                t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j)\n 2. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j));\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (subgoal_tac \"pol_coeff S ((Suc n), (\\<lambda>j. if j \\<le> n then (f' j) else r))\n         \\<and>\n        (\\<forall>j \\<le> (Suc n). f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((\\<lambda>j. if j \\<le> n then (f' j) else r) j))\",\n       blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f f' r.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f); pol_coeff S (n, f);\n        \\<forall>j\\<le>n.\n           \\<exists>r\\<in>carrier S.\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        pol_coeff S (n, f');\n        \\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r \\<in> carrier S;\n        r \\<in> carrier S;\n        f (Suc n) = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S\n                          (Suc n,\n                           \\<lambda>j. if j \\<le> n then f' j else r) \\<and>\n                         (\\<forall>j\\<le>Suc n.\n                             f j =\n                             t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                             (if j \\<le> n then f' j else r))\n 2. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j));\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (rule conjI, simp add:pol_coeff_def,\n         rule allI, rule impI, \n         case_tac \"j \\<le> n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f f' r j.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f); pol_coeff S (n, f);\n        \\<forall>j\\<le>n.\n           \\<exists>r\\<in>carrier S.\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        pol_coeff S (n, f');\n        \\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r \\<in> carrier S;\n        r \\<in> carrier S; f (Suc n) = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        j \\<le> Suc n; \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j =\n                         t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         (if j \\<le> n then f' j else r)\n 2. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j));\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f f' r j.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f); pol_coeff S (n, f);\n        \\<forall>j\\<le>n.\n           \\<exists>r\\<in>carrier S.\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        pol_coeff S (n, f');\n        \\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r \\<in> carrier S;\n        r \\<in> carrier S; f (Suc n) = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        j \\<le> Suc n; \\<not> j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r\n 2. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j));\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (drule_tac y = j and x = n in not_le_imp_less,\n         drule_tac m = n and n = j in Suc_leI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f f' r j.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f); pol_coeff S (n, f);\n        \\<forall>j\\<le>n.\n           \\<exists>r\\<in>carrier S.\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        pol_coeff S (n, f');\n        \\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r \\<in> carrier S;\n        r \\<in> carrier S; f (Suc n) = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r;\n        j \\<le> Suc n; Suc n \\<le> j\\<rbrakk>\n       \\<Longrightarrow> f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> r\n 2. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<and>\n           (\\<forall>j\\<le>n.\n               f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n           (\\<exists>f'.\n               pol_coeff S (n, f') \\<and>\n               (\\<forall>j\\<le>n.\n                   f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j));\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (frule_tac m = j and n = \"Suc n\" in le_antisym, assumption, simp,\n         thin_tac \"\\<forall>f. pol_coeff S (n, f) \\<and> (\\<forall>j\\<le>n. f j \\<in> S \\<diamondsuit>\\<^sub>p t) \\<longrightarrow>\n                  (\\<exists>f'. pol_coeff S (n, f') \\<and> (\\<forall>j\\<le>n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>t \\<in> carrier S; Subring R S; Ring S; aGroup R;\n        pol_coeff S (Suc n, f);\n        \\<forall>j\\<le>Suc n. f j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            f j \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (rule allI, rule impI, \n         drule_tac a = j in forall_spec, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_principal:\"\\<lbrakk>t \\<in> carrier S; pol_coeff S (n, f); \n          \\<forall>j \\<le> n. f j \\<in> S \\<diamondsuit>\\<^sub>p t\\<rbrakk> \\<Longrightarrow>\n          \\<exists>f'. pol_coeff S (n, f') \\<and> (\\<forall>j \\<le> n. f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (f' j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; pol_coeff S (n, f);\n     \\<forall>j\\<le>n. f j \\<in> S \\<diamondsuit>\\<^sub>p t\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f'.\n                         pol_coeff S (n, f') \\<and>\n                         (\\<forall>j\\<le>n.\n                             f j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j)", "apply (simp add:coeff_principalTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) Pmod_0_principal:\"\\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n            P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\\<rbrakk> \\<Longrightarrow> \\<exists>h\\<in> carrier R. g = t \\<cdot>\\<^sub>r h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h", "apply (case_tac \"g = \\<zero>\\<^bsub>R\\<^esub>\",\n       cut_tac ring_zero,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       frule ring_times_x_0[THEN sym, of t], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g; Subring R S; Ring S;\n     g \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h", "apply (frule s_cf_expr[of g], assumption+,\n        (erule conjE)+, frule Ring.principal_ideal[of S t], assumption,\n       simp add:P_mod_mod[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" g],\n       frule coeff_principal[of t \"fst (s_cf R S X g)\" \"snd (s_cf R S X g)\"],\n         simp add:pol_coeff_split[THEN sym], assumption+, \n       erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        Subring R S; Ring S; g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n        g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n        snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pol_coeff S (fst (s_cf R S X g), f');\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j =\n           t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h", "apply (frule_tac c = \"(fst (s_cf R S X g), f')\" and k = \"fst (s_cf R S X g)\"\n        in polyn_mem, simp,\n        subgoal_tac \"g = t \\<cdot>\\<^sub>r \n        (polyn_expr R X (fst (s_cf R S X g)) (fst (s_cf R S X g), f'))\",\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        Subring R S; Ring S; g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n        g = polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g);\n        snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pol_coeff S (fst (s_cf R S X g), f');\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        polyn_expr R X (fst (s_cf R S X g)) (fst (s_cf R S X g), f')\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g =\n                         t \\<cdot>\\<^sub>r\n                         polyn_expr R X (fst (s_cf R S X g))\n                          (fst (s_cf R S X g), f')", "apply (subst scalar_times_pol_expr[of  t \"(fst (s_cf R S X g), f')\" \n           \"fst (s_cf R S X g)\"], assumption+, simp,\n        drule sym,\n        subgoal_tac \"polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) =\n     polyn_expr R X (fst (s_cf R S X g)) (sp_cf S t (fst (s_cf R S X g), f'))\",\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j \\<in> S \\<diamondsuit>\\<^sub>p t;\n        Subring R S; Ring S; g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n        snd (s_cf R S X g) (fst (s_cf R S X g)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pol_coeff S (fst (s_cf R S X g), f');\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        polyn_expr R X (fst (s_cf R S X g)) (fst (s_cf R S X g), f')\n        \\<in> carrier R;\n        polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) = g\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst (s_cf R S X g))\n                          (s_cf R S X g) =\n                         polyn_expr R X (fst (s_cf R S X g))\n                          (sp_cf S t (fst (s_cf R S X g), f'))", "apply (frule_tac c = \"(fst (s_cf R S X g), f')\" in sp_cf_pol_coeff[of _ t],\n        assumption+,\n        frule_tac d = \"sp_cf S t (fst (s_cf R S X g), f')\" in \n         pol_expr_unique2[of \"s_cf R S X g\"], assumption+,\n        simp, simp add:sp_cf_len, simp add:sp_cf_len,\n       thin_tac \"(g =\n           polyn_expr R X (fst (s_cf R S X g))\n            (sp_cf S t (fst (s_cf R S X g), f'))) =\n          (\\<forall>j\\<le>fst (s_cf R S X g).\n              t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j = snd (sp_cf S t (fst (s_cf R S X g), f')) j)\",\n       thin_tac \"polyn_expr R X (fst (s_cf R S X g)) (s_cf R S X g) = g\",\n       thin_tac \"polyn_expr R X (fst (s_cf R S X g)) (fst (s_cf R S X g), f')\n          \\<in> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j\n           \\<in> S \\<diamondsuit>\\<^sub>p t;\n        Subring R S; Ring S; g \\<noteq> \\<zero>; pol_coeff S (s_cf R S X g);\n        t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' (fst (s_cf R S X g)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pol_coeff S (fst (s_cf R S X g), f');\n        \\<forall>j\\<le>fst (s_cf R S X g).\n           snd (s_cf R S X g) j = t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j;\n        pol_coeff S (sp_cf S t (fst (s_cf R S X g), f'))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>fst (s_cf R S X g).\n                            t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> f' j =\n                            snd (sp_cf S t (fst (s_cf R S X g), f')) j", "apply (rule allI, rule impI, \n        drule_tac a = j in forall_spec, assumption+,\n        simp add:sp_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) Pmod0_principal_rev:\"\\<lbrakk>Idomain S; t \\<in> carrier S; \n                     g \\<in> carrier R; \\<exists>h\\<in> carrier R. g = t \\<cdot>\\<^sub>r  h\\<rbrakk> \\<Longrightarrow> \n                                       P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n     \\<exists>h\\<in>carrier R. g = t \\<cdot>\\<^sub>r h; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        Subring R S; Ring S; h \\<in> carrier R;\n        g = t \\<cdot>\\<^sub>r h\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (case_tac \"t = \\<zero>\\<^bsub>S\\<^esub>\", \n       frule Subring_zero_ring_zero, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>h.\n       \\<lbrakk>Idomain S; \\<zero> \\<in> carrier S;\n        \\<zero> \\<cdot>\\<^sub>r h \\<in> carrier R; Subring R S; Ring S;\n        h \\<in> carrier R; g = \\<zero> \\<cdot>\\<^sub>r h; t = \\<zero>;\n        \\<zero>\\<^bsub>S\\<^esub> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p \\<zero>)\n                          (\\<zero> \\<cdot>\\<^sub>r h)\n 2. \\<And>h.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        Subring R S; Ring S; h \\<in> carrier R; g = t \\<cdot>\\<^sub>r h;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (simp add:ring_times_0_x, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain S; t \\<in> carrier S; g \\<in> carrier R;\n        Subring R S; Ring S; h \\<in> carrier R; g = t \\<cdot>\\<^sub>r h;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) g", "apply (case_tac \"h = \\<zero>\\<^bsub>R\\<^esub>\", simp,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       simp add:ring_times_x_0, simp add:P_mod_def,\n       cut_tac polyn_ring_integral, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain R; t \\<in> carrier S;\n        t \\<cdot>\\<^sub>r h \\<in> carrier R; Subring R S; Ring S;\n        h \\<in> carrier R; g = t \\<cdot>\\<^sub>r h;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; h \\<noteq> \\<zero>;\n        Idomain S\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (t \\<cdot>\\<^sub>r h)", "apply (frule_tac p = h in s_cf_expr, assumption+, (erule conjE)+,\n       frule_tac c = \"s_cf R S X h\" and n = \"fst (s_cf R S X h)\" in \n       scalar_times_pol_expr[of  t], assumption+, simp,\n       thin_tac \"g = t \\<cdot>\\<^sub>r h\",\n       drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain R; t \\<in> carrier S;\n        polyn_expr R X (fst (s_cf R S X h)) (sp_cf S t (s_cf R S X h))\n        \\<in> carrier R;\n        Subring R S; Ring S; h \\<in> carrier R;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; h \\<noteq> \\<zero>; Idomain S;\n        pol_coeff S (s_cf R S X h);\n        snd (s_cf R S X h) (fst (s_cf R S X h)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        t \\<cdot>\\<^sub>r h =\n        polyn_expr R X (fst (s_cf R S X h)) (sp_cf S t (s_cf R S X h));\n        polyn_expr R X (fst (s_cf R S X h)) (s_cf R S X h) = h\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (polyn_expr R X (fst (s_cf R S X h))\n                            (sp_cf S t (s_cf R S X h)))", "apply (frule Ring.principal_ideal[of S t], assumption+,\n       frule_tac c1 = \"sp_cf S t (s_cf R S X h)\" and p1 = \"t \\<cdot>\\<^sub>r h\" in \n       P_mod_mod[THEN sym],\n       frule_tac x = t in mem_subring_mem_ring, assumption,\n                 rule ring_tOp_closed, assumption+,\n       simp add:sp_cf_pol_coeff, simp add:sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain R; t \\<in> carrier S;\n        polyn_expr R X (fst (s_cf R S X h)) (sp_cf S t (s_cf R S X h))\n        \\<in> carrier R;\n        Subring R S; Ring S; h \\<in> carrier R;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; h \\<noteq> \\<zero>; Idomain S;\n        pol_coeff S (s_cf R S X h);\n        snd (s_cf R S X h) (fst (s_cf R S X h)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        t \\<cdot>\\<^sub>r h =\n        polyn_expr R X (fst (s_cf R S X h)) (sp_cf S t (s_cf R S X h));\n        polyn_expr R X (fst (s_cf R S X h)) (s_cf R S X h) = h;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r h) =\n        (\\<forall>j\\<le>fst (sp_cf S t (s_cf R S X h)).\n            snd (sp_cf S t (s_cf R S X h)) j\n            \\<in> S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (polyn_expr R X (fst (s_cf R S X h))\n                            (sp_cf S t (s_cf R S X h)))", "apply (drule sym, simp,\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r h) =\n         (\\<forall>j\\<le>fst (sp_cf S t (s_cf R S X h)).\n             snd (sp_cf S t (s_cf R S X h)) j \\<in> S \\<diamondsuit>\\<^sub>p t)\",\n       thin_tac \"polyn_expr R X (fst (s_cf R S X h)) \n                     (sp_cf S t (s_cf R S X h)) = t \\<cdot>\\<^sub>r h\",\n       thin_tac \"polyn_expr R X (fst (s_cf R S X h)) (s_cf R S X h) = h\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>Idomain R; t \\<in> carrier S;\n        t \\<cdot>\\<^sub>r h \\<in> carrier R; Subring R S; Ring S;\n        h \\<in> carrier R; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        h \\<noteq> \\<zero>; Idomain S; pol_coeff S (s_cf R S X h);\n        snd (s_cf R S X h) (fst (s_cf R S X h)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>fst (sp_cf S t (s_cf R S X h)).\n                            snd (sp_cf S t (s_cf R S X h)) j\n                            \\<in> S \\<diamondsuit>\\<^sub>p t", "apply (rule allI, rule impI, simp add:sp_cf_len,\n       subst sp_cf_def, simp, subst Rxa_def, simp,\n       frule_tac c = \"s_cf R S X h\" and j = j in pol_coeff_mem,\n       assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h j.\n       \\<lbrakk>Idomain R; t \\<in> carrier S;\n        t \\<cdot>\\<^sub>r h \\<in> carrier R; Subring R S; Ring S;\n        h \\<in> carrier R; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        h \\<noteq> \\<zero>; Idomain S; pol_coeff S (s_cf R S X h);\n        snd (s_cf R S X h) (fst (s_cf R S X h)) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); j \\<le> fst (s_cf R S X h);\n        snd (s_cf R S X h) j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier S.\n                            t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            snd (s_cf R S X h) j =\n                            r \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t", "apply (simp add:Ring.ring_tOp_commute[of S t], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(** NOTE. if t \\<noteq> 0\\<^sub>S then, deg g = deg h, because deg t = 0 **)"], ["", "lemma (in PolynRg) Pmod0_principal_rev1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; \n                     h \\<in> carrier R\\<rbrakk> \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r h)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (t \\<cdot>\\<^sub>r h)", "apply (rule Pmod0_principal_rev[of t \"t \\<cdot>\\<^sub>r h\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> t \\<cdot>\\<^sub>r h \\<in> carrier R\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ha\\<in>carrier R.\n                         t \\<cdot>\\<^sub>r h = t \\<cdot>\\<^sub>r ha", "apply (cut_tac subring,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S; h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>ha\\<in>carrier R.\n                         t \\<cdot>\\<^sub>r h = t \\<cdot>\\<^sub>r ha", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) Pmod0_principal_erH_vanish_t:\"\\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \\<rbrakk> \\<Longrightarrow>\n      erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) t = \\<zero>\\<^bsub>R'\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) t =\n                      \\<zero>\\<^bsub>R'\\<^esub>", "apply (cut_tac subring, frule subring_Ring,\n       frule mem_subring_mem_ring[of S t], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; Subring R S;\n     Ring S; t \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) t =\n                      \\<zero>\\<^bsub>R'\\<^esub>", "apply (subst P_mod_0[of \"S \\<diamondsuit>\\<^sub>p t\" R' Y t], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; Subring R S;\n     Ring S; t \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) t", "apply (rule Pmod0_principal_rev[of t t], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; Subring R S;\n     Ring S; t \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>carrier R. t = t \\<cdot>\\<^sub>r h", "apply (cut_tac ring_one,\n        frule ring_r_one[THEN sym, of t], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_diffxxx1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>; u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>; \n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq> \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h) = t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra; 0 < m; \n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) u)\n         \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) v)\n         \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>))\n           (f \\<plusminus> -\\<^sub>a ((g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (cut_tac is_Ring,\n       cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag,\n       frule PolynRg.is_Ring[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y],\n       frule Ring.ring_is_ag[of R'],\n       frule Ring.maximal_ideal_ideal[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule Ring.qring_ring[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption+, \n       frule erH_rHom[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \"pj S (S \\<diamondsuit>\\<^sub>p t)\"], assumption+,\n       frule mem_subring_mem_ring[of S t], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pj S (S \\<diamondsuit>\\<^sub>p t)\n                      \\<in> rHom S\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r\n                          (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule pj_Hom[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule pHom_rHom[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \n        \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R'\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (simp del:npow_suc add:rHom_tOp[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g) \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R'\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac ring_tOp_closed[of u g], assumption,\n       frule_tac ring_tOp_closed[of v h], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g) \\<plusminus>\\<^bsub>R'\\<^esub>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (simp del:npow_suc add:rHom_add[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     0 < m;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n     Ring R; Subring R S; Ring S; aGroup R; Ring R'; aGroup R';\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rotate_tac 17, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule P_mod_diff[of \"S \\<diamondsuit>\\<^sub>p t\" R' Y ra  \"u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h\n                      \\<in> carrier R\n 2. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n      erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t))\n       (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)) =\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (ra \\<plusminus>\n       -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus>\n                  v \\<cdot>\\<^sub>r h))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule aGroup.ag_pOp_closed, assumption+, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (ra \\<plusminus>\n       -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule Pmod_0_principal[of t \"ra \\<plusminus> -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (ra \\<plusminus>\n       -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> ra \\<plusminus>\n                      -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus>\n                                 v \\<cdot>\\<^sub>r h)\n                      \\<in> carrier R\n 2. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (ra \\<plusminus>\n       -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (ra \\<plusminus>\n                        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus>\n                                   v \\<cdot>\\<^sub>r h))\n 3. \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n     aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n     \\<in> rHom R R';\n     u \\<cdot>\\<^sub>r g \\<in> carrier R;\n     v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n     u \\<in> carrier R; v \\<in> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     ra \\<in> carrier R;\n     f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (ra \\<plusminus>\n       -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n     \\<exists>ha\\<in>carrier R.\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v) \\<cdot>\\<^sub>r\n                                  (h \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule aGroup.ag_pOp_closed, assumption+,\n        rule aGroup.ag_mOp_closed, assumption,\n        rule aGroup.ag_pOp_closed, assumption+, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule Ring.npClose[of S t m], assumption+,\n       frule mem_subring_mem_ring[of S \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n       subst ring_distrib1,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule ring_tOp_closed, simp add:mem_subring_mem_ring,\n       assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a ((g \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\nh \\<plusminus>\n(g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n(t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))", "apply (rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a ((g \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\nh \\<plusminus>\n(g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n(t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))", "apply (subst ring_distrib2, assumption+,\n       rule ring_tOp_closed, assumption+ )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<cdot>\\<^sub>r h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h \\<plusminus>\n(g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n(t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))", "apply (frule_tac x = g and y = h in ring_tOp_closed, assumption+,\n       frule_tac x = \"t^\\<^bsup>S m\\<^esup>\" and y = v in ring_tOp_closed, assumption+,\n       frule_tac x = \"t^\\<^bsup>S m\\<^esup>\" and y = u in ring_tOp_closed, assumption+,\n       frule_tac x = \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\" and y = h in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<cdot>\\<^sub>r h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h \\<plusminus>\n(g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n(t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))", "apply (subst ring_distrib2, assumption+,\n      frule_tac x = \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\" and y = \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\" in ring_tOp_closed, \n      assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<cdot>\\<^sub>r h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h \\<plusminus>\n(g \\<cdot>\\<^sub>r (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))))", "apply (subst aGroup.ag_p_inv, assumption+,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           (-\\<^sub>a (g \\<cdot>\\<^sub>r h \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h) \\<plusminus>\n                            -\\<^sub>a (g \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))))", "apply (subst aGroup.ag_p_inv, assumption+,\n       frule aGroup.ag_mOp_closed[of R \"g \\<cdot>\\<^sub>r h\"], assumption+,\n       frule aGroup.ag_mOp_closed[of R \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        -\\<^sub>a g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           (-\\<^sub>a g \\<cdot>\\<^sub>r h \\<plusminus>\n                            -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\nv \\<cdot>\\<^sub>r\nh \\<plusminus>\n                            -\\<^sub>a (g \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))))", "apply (subst aGroup.ag_pOp_assoc[of R \"-\\<^sub>a (g \\<cdot>\\<^sub>r h)\" \" -\\<^sub>a (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h)\"],\n       assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        -\\<^sub>a g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (g \\<cdot>\\<^sub>r\n                                    (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                     u) \\<plusminus>\n                                    t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                    v \\<cdot>\\<^sub>r\n                                    (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                     u))\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        -\\<^sub>a g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           (-\\<^sub>a g \\<cdot>\\<^sub>r h \\<plusminus>\n                            (-\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n v \\<cdot>\\<^sub>r\n h \\<plusminus>\n                             -\\<^sub>a (g \\<cdot>\\<^sub>r\n  (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n  t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n  (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))))", "apply (rule aGroup.ag_mOp_closed, assumption,\n       rule aGroup.ag_pOp_closed, assumption,\n       rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (ra \\<plusminus>\n          -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        -\\<^sub>a g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           (-\\<^sub>a g \\<cdot>\\<^sub>r h \\<plusminus>\n                            (-\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n v \\<cdot>\\<^sub>r\n h \\<plusminus>\n                             -\\<^sub>a (g \\<cdot>\\<^sub>r\n  (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n  t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n  (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)))))", "apply (subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n       rule aGroup.ag_pOp_closed, assumption,\n       rule aGroup.ag_mOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule ring_tOp_closed, assumption+, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        -\\<^sub>a g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r h\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           ra \\<plusminus>\n                           (-\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\nv \\<cdot>\\<^sub>r\nh \\<plusminus>\n                            -\\<^sub>a (g \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) \\<plusminus>\n t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))))", "apply (subst aGroup.ag_p_inv, assumption,\n       rule ring_tOp_closed, assumption+,\n       simp del:npow_suc add:ring_tOp_assoc[of \"t^\\<^bsup>S m\\<^esup>\" v h],\n       simp add:del:npow_suc add:ring_tOp_commute[of g \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\"],\n       simp del:npow_suc add:ring_tOp_assoc[of \"t^\\<^bsup>S m\\<^esup>\" u g],\n       simp del:npow_suc add:ring_inv1_2,\n       subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n                            rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                         (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                         v \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                          (-\\<^sub>a u))\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           ra \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (v \\<cdot>\\<^sub>r (-\\<^sub>a h)) \\<plusminus>\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (rule aGroup.ag_pOp_closed, assumption+,\n              (rule ring_tOp_closed, assumption+)+,\n              rule aGroup.ag_mOp_closed, assumption+,\n              (rule ring_tOp_closed, assumption+)+,\n              rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           ra \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (v \\<cdot>\\<^sub>r (-\\<^sub>a h)) \\<plusminus>\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (subst ring_distrib1[THEN sym, of \"t^\\<^bsup>S m\\<^esup>\" ra  \"v \\<cdot>\\<^sub>r (-\\<^sub>a h)\"],\n             assumption+,\n             rule ring_tOp_closed, assumption+, rule aGroup.ag_mOp_closed,\n             assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h)) \\<plusminus>\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n             rule ring_tOp_closed, assumption+,\n             rule aGroup.ag_pOp_closed, assumption+,\n             rule ring_tOp_closed, assumption+, rule aGroup.ag_mOp_closed,\n             assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                         (u \\<cdot>\\<^sub>r (-\\<^sub>a g))\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                         v \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                          (-\\<^sub>a u))\n                         \\<in> carrier R\n 3. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           v \\<cdot>\\<^sub>r\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))", "apply ((rule ring_tOp_closed, assumption+)+,\n              rule aGroup.ag_mOp_closed, assumption+,\n             (rule ring_tOp_closed, assumption+)+,\n             rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           v \\<cdot>\\<^sub>r\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))", "apply (subst ring_distrib1[THEN sym, of \"t^\\<^bsup>S m\\<^esup>\"],\n               assumption+,\n               rule aGroup.ag_pOp_closed, assumption+,\n               rule ring_tOp_closed, assumption+,\n               rule aGroup.ag_mOp_closed, assumption+,\n               rule ring_tOp_closed, assumption+,\n               rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n                            u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           v \\<cdot>\\<^sub>r\n                           (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))", "apply (subst ring_tOp_assoc[of \"t^\\<^bsup>S m\\<^esup>\" v], assumption+,\n                rule ring_tOp_closed, assumption+,\n                rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n                            u \\<cdot>\\<^sub>r (-\\<^sub>a g)) \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (subst ring_distrib1[THEN sym, of \"t^\\<^bsup>S m\\<^esup>\"],\n                assumption+,\n                rule aGroup.ag_pOp_closed, assumption+,\n                rule aGroup.ag_pOp_closed, assumption+,\n                rule ring_tOp_closed, assumption,\n                rule aGroup.ag_mOp_closed, assumption+,\n                rule ring_tOp_closed, assumption,\n                rule aGroup.ag_mOp_closed, assumption+,\n                (rule ring_tOp_closed, assumption+)+,\n                rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus>\n        -\\<^sub>a (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (ra \\<plusminus>\n                            v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n                            u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<plusminus>\n                            v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (frule ring_tOp_closed[of u g], assumption+,\n           frule ring_tOp_closed[of v h], assumption+,\n           simp del:npow_suc add:aGroup.ag_p_inv[of R \"u \\<cdot>\\<^sub>r g\" \"v \\<cdot>\\<^sub>r h\"],\n           simp del:npow_suc add:add:ring_inv1_2,\n           frule aGroup.ag_mOp_closed[of R g], assumption+,\n                  frule aGroup.ag_mOp_closed[of R h], assumption+,\n           frule ring_tOp_closed[of u \"-\\<^sub>a g\"], assumption+,\n                  frule ring_tOp_closed[of v \"-\\<^sub>a h\"], assumption+,\n           simp del:npow_suc add:aGroup.ag_pOp_commute[of R\n                  \"u \\<cdot>\\<^sub>r (-\\<^sub>a g)\" \"v \\<cdot>\\<^sub>r (-\\<^sub>a h)\"],\n           simp del:npow_suc add:aGroup.ag_pOp_assoc[THEN sym, \n                  of R ra \"v \\<cdot>\\<^sub>r (-\\<^sub>a h)\" \"u \\<cdot>\\<^sub>r (-\\<^sub>a g)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (t \\<cdot>\\<^sub>r ha \\<plusminus>\n                            v \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))", "apply (subst ring_tOp_assoc[THEN sym, of v \"t^\\<^bsup>S m\\<^esup>\" \"-\\<^sub>a u\"], assumption+,\n         rule aGroup.ag_mOp_closed, assumption+,\n         simp only:ring_tOp_commute[of v \"t^\\<^bsup>S m\\<^esup>\"],\n         subgoal_tac \"t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v = t \\<cdot>\\<^sub>r (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\", \n         simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (t \\<cdot>\\<^sub>r ha \\<plusminus>\n                            t \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                             v) \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (subst ring_tOp_assoc[of t],\n         frule mem_subring_mem_ring[of S t], assumption+,\n         rule ring_tOp_closed)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> v \\<in> carrier R\n 3. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a u \\<in> carrier R\n 4. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (t \\<cdot>\\<^sub>r ha \\<plusminus>\n                            t \\<cdot>\\<^sub>r\n                            (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                             v \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))\n 5. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n          simp add:mem_subring_mem_ring, assumption,\n          rule aGroup.ag_mOp_closed, assumption+,\n          subst ring_distrib1[THEN sym, of t],\n          simp add:mem_subring_mem_ring, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                         v \\<cdot>\\<^sub>r\n                         (-\\<^sub>a u)\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (t \\<cdot>\\<^sub>r\n                            (ha \\<plusminus>\n                             t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                             v \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))\n 3. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply ((rule ring_tOp_closed)+,\n          frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n          simp add:mem_subring_mem_ring, assumption,\n          rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           (t \\<cdot>\\<^sub>r\n                            (ha \\<plusminus>\n                             t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                             v \\<cdot>\\<^sub>r\n                             (-\\<^sub>a u))))\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (subst ring_tOp_assoc[THEN sym],\n         frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n         simp add:mem_subring_mem_ring)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> ha \\<plusminus>\n                         t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                         v \\<cdot>\\<^sub>r\n                         (-\\<^sub>a u)\n                         \\<in> carrier R\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                           t \\<cdot>\\<^sub>r\n                           (ha \\<plusminus>\n                            t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                            v \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))\n 3. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (rule aGroup.ag_pOp_closed, assumption+,\n         rule ring_tOp_closed,\n         frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n         rule ring_tOp_closed, simp add:mem_subring_mem_ring,\n         assumption, rule aGroup.ag_mOp_closed, assumption+,\n         simp add:Subring_tOp_ring_tOp[THEN sym],\n         simp only:npow_suc[THEN sym, of S t m])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n        t \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (t^\\<^bsup>S Suc m\\<^esup> \\<cdot>\\<^sub>r\n                           (ha \\<plusminus>\n                            t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r\n                            v \\<cdot>\\<^sub>r\n                            (-\\<^sub>a u)))\n 2. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (rule Pmod0_principal_rev1[of \"t^\\<^bsup>S (Suc m)\\<^esup>\"], assumption+,\n         rule Ring.npClose, assumption+,\n         rule aGroup.ag_pOp_closed, assumption+,\n         (rule ring_tOp_closed)+,\n         frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n         simp add:mem_subring_mem_ring, assumption,\n         rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ha.\n       \\<lbrakk>0 < m; Ring R; Subring R S; Ring S; aGroup R; Ring R';\n        aGroup R'; ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> rHom R R';\n        Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        f \\<noteq> \\<zero>; g \\<noteq> \\<zero>; h \\<noteq> \\<zero>;\n        u \\<in> carrier R; v \\<in> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        ra \\<in> carrier R;\n        f \\<plusminus> g \\<cdot>\\<^sub>r (-\\<^sub>a h) =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (t \\<cdot>\\<^sub>r ha);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (u \\<cdot>\\<^sub>r g \\<plusminus> v \\<cdot>\\<^sub>r h);\n        ha \\<in> carrier R;\n        ra \\<plusminus> v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<plusminus>\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) =\n        t \\<cdot>\\<^sub>r ha;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r h)\n        \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r\n        (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<in> carrier R;\n        g \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n        (v \\<cdot>\\<^sub>r (-\\<^sub>a h))\n        \\<in> carrier R;\n        u \\<cdot>\\<^sub>r g \\<in> carrier R;\n        v \\<cdot>\\<^sub>r h \\<in> carrier R; -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a h \\<in> carrier R;\n        u \\<cdot>\\<^sub>r (-\\<^sub>a g) \\<in> carrier R;\n        v \\<cdot>\\<^sub>r (-\\<^sub>a h) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                         t \\<cdot>\\<^sub>r\n                         (t^\\<^bsup>S (m - Suc 0)\\<^esup> \\<cdot>\\<^sub>r v)", "apply (frule Ring.npClose[of S t \"m - Suc 0\"], assumption+,\n         frule mem_subring_mem_ring[of S t], assumption,\n         frule mem_subring_mem_ring[of S \"t^\\<^bsup>S (m - Suc 0)\\<^esup>\"], assumption,\n         simp add:ring_tOp_assoc[THEN sym],\n         simp add:ring_tOp_commute[of t \"t^\\<^bsup>S (m - Suc 0)\\<^esup>\"],\n         subgoal_tac \"t^\\<^bsup>S m\\<^esup> = t^\\<^bsup>S (Suc (m - Suc 0))\\<^esup>\",\n         simp del:Suc_pred add:Subring_tOp_ring_tOp,\n         simp only:Suc_pred)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_diffxxx2:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n   maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n   f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  deg R S X h + \n  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n                                      \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h)); 0 < m\\<rbrakk> \\<Longrightarrow> \n\\<exists>g1 h1. g1 \\<in>carrier R \\<and> h1 \\<in> carrier R \\<and> \n     (deg R S X g1 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (g \\<plusminus> -\\<^sub>a g1) \\<and>  (deg R S X h1 + \n  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n      \\<le> deg R S X f) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (h \\<plusminus> -\\<^sub>a h1) \\<and> \n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a (g1 \\<cdot>\\<^sub>r h1)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1 h1.\n                         g1 \\<in> carrier R \\<and>\n                         h1 \\<in> carrier R \\<and>\n                         deg R S X g1\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  g1) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                         deg R S X h1 +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus> -\\<^sub>a g1 \\<cdot>\\<^sub>r h1)", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag,\n       frule Ring.residue_field_cd[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule Ring.maximal_ideal_ideal[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule pj_Hom[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       frule Ring.qring_ring[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule  PolynRg.pol_nonzero[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \n         \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g\"],\n       rule erH_mem, assumption+,\n       frule erH_rHom_nonzero[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \"pj S (S \\<diamondsuit>\\<^sub>p t)\" \"g\"], \n       assumption+, simp add:aless_imp_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     (0 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g)) =\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n      \\<zero>\\<^bsub>R'\\<^esub>);\n     g \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1 h1.\n                         g1 \\<in> carrier R \\<and>\n                         h1 \\<in> carrier R \\<and>\n                         deg R S X g1\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  g1) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                         deg R S X h1 +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus> -\\<^sub>a g1 \\<cdot>\\<^sub>r h1)", "apply (frule PolynRg.pol_nonzero[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \n        \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h\"], \n       rule erH_mem, assumption+,\n       frule erH_rHom_nonzero[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \"pj S (S \\<diamondsuit>\\<^sub>p t)\" \"h\"], \n       assumption+, simp add:aless_imp_le, simp del:npow_suc add:aless_imp_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     h \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1.\n                         g1 \\<in> carrier R \\<and>\n                         (\\<exists>h1.\n                             h1 \\<in> carrier R \\<and>\n                             deg R S X g1\n                             \\<le> deg R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                             deg R S X h1 +\n                             deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                             \\<le> deg R S X f \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S Suc m\\<^esup>))\n                              (f \\<plusminus>\n                               -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (\n       frule pol_nonzero[THEN sym, of \"h\"], simp del:npow_suc,\n       frule aadd_pos_poss[of \"deg R S X h\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"], assumption+,\n       frule aless_le_trans[of \"0\" \"(deg R S X h) +\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\"\n          \"deg R S X f\"], assumption+,\n       frule pol_nonzero[of f], simp del:npow_suc add:aless_imp_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     0 \\<le> deg R S X h; h \\<noteq> \\<zero>;\n     0 < deg R S X h +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R S X f; f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1.\n                         g1 \\<in> carrier R \\<and>\n                         (\\<exists>h1.\n                             h1 \\<in> carrier R \\<and>\n                             deg R S X g1\n                             \\<le> deg R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                             deg R S X h1 +\n                             deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                             \\<le> deg R S X f \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S Suc m\\<^esup>))\n                              (f \\<plusminus>\n                               -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (thin_tac \"0 < deg R S X f\",\n         thin_tac \"0 < deg R S X h +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1.\n                         g1 \\<in> carrier R \\<and>\n                         (\\<exists>h1.\n                             h1 \\<in> carrier R \\<and>\n                             deg R S X g1\n                             \\<le> deg R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                             deg R S X h1 +\n                             deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                             \\<le> deg R S X f \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S Suc m\\<^esup>))\n                              (f \\<plusminus>\n                               -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule Pmod_0_principal[of \"t^\\<^bsup>S m\\<^esup>\" \"f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h)\"],\n        rule Ring.npClose, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h\n                      \\<in> carrier R\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m; Subring R S; Ring S; aGroup R;\n     Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     pj S (S \\<diamondsuit>\\<^sub>p t)\n     \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     g \\<noteq> \\<zero>;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n     \\<zero>\\<^bsub>R'\\<^esub>;\n     0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n     \\<exists>ha\\<in>carrier R.\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ha\\<rbrakk>\n    \\<Longrightarrow> \\<exists>g1.\n                         g1 \\<in> carrier R \\<and>\n                         (\\<exists>h1.\n                             h1 \\<in> carrier R \\<and>\n                             deg R S X g1\n                             \\<le> deg R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                             deg R S X h1 +\n                             deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n                             \\<le> deg R S X f \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S m\\<^esup>))\n                              (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                             P_mod R S X\n                              (S \\<diamondsuit>\\<^sub>p\n                               (t^\\<^bsup>S Suc m\\<^esup>))\n                              (f \\<plusminus>\n                               -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+,\n       rule ring_tOp_closed, assumption+,\n       erule bexE, rename_tac ra)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "(******* deg (t^\\<^sup>S\\<^sup> \\<^sup>m) ra \\<le> deg f ******)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule deg_mult_pols1 [of g h], assumption+,\n       frule aadd_le_mono[of \"deg R S X g\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"\n              \"deg R S X h\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g) +\n              deg R S X h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (simp only:aadd_commute[of \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"\n             \"deg R S X h\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h\n        \\<le> deg R S X h +\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule ale_trans[of \"deg R S X g + deg R S X h\" \"deg R S X h +\n       deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n       (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"  \"deg R S X f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h\n        \\<le> deg R S X h +\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X g + deg R S X h \\<le> deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (thin_tac \"deg R S X g + deg R S X h\n          \\<le> deg R S X h +\n            deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule_tac ring_tOp_closed[of g h], assumption+,\n        frule deg_minus_eq1[of \"g \\<cdot>\\<^sub>r h\"],\n        frule polyn_deg_add4[of \"f\" \"-\\<^sub>a (g \\<cdot>\\<^sub>r h)\" \"deg_n R S X f\"],\n        rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h) =\n        deg R S X (g \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X f \\<le> an (deg_n R S X f)\n 2. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h) =\n        deg R S X (g \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h)\n                         \\<le> an (deg_n R S X f)\n 3. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h) =\n        deg R S X (g \\<cdot>\\<^sub>r h);\n        deg R S X (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\n        \\<le> an (deg_n R S X f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (subst deg_an[THEN sym], assumption+, simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h) =\n        deg R S X (g \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h)\n                         \\<le> an (deg_n R S X f)\n 2. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h;\n        deg R S X g + deg R S X h \\<le> deg R S X f;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (-\\<^sub>a g \\<cdot>\\<^sub>r h) =\n        deg R S X (g \\<cdot>\\<^sub>r h);\n        deg R S X (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\n        \\<le> an (deg_n R S X f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (simp add:deg_an[THEN sym], simp del:npow_suc add:deg_an[THEN sym],\n         thin_tac \"deg R S X (g \\<cdot>\\<^sub>r h) = deg R S X g + deg R S X h\",\n         thin_tac \"deg R S X g + deg R S X h \\<le> deg R S X f\",\n         thin_tac \"deg R S X (-\\<^sub>a (g \\<cdot>\\<^sub>r h)) = deg R S X g + deg R S X h\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra)\n        \\<le> deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "(******* deg (t^\\<^sup>S\\<^sup> \\<^sup>m) ra \\<le> deg f  done *** next show deg ra \\<le> deg f ***)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra)\n        \\<le> deg R S X f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule Ring.npClose[of S t m], assumption,\n         frule Idomain.idom_potent_nonzero[of S t m], assumption+,\n         frule_tac p = ra in const_times_polyn1[of _ \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n         simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) =\n        deg R S X ra\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "(******************  got deg ra \\<le> deg f ***********************) \n\n(******  make g1 and h1 ******)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) =\n        deg R S X ra\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule_tac h = \n       \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\" in \n       PolynRg.rel_prime_equation[of R' \"(S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\" \"Y\" \n        \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g\" \n        \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h\"], \n       assumption+,\n       simp del:npow_suc add:erH_mem, simp del:npow_suc add:erH_mem, \n       assumption+,\n       simp del:npow_suc add:erH_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        \\<exists>u\\<in>carrier R'.\n           \\<exists>v\\<in>carrier R'.\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u\n              \\<le> amax\n                     (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n                     (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) h)) \\<and>\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v\n              \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                     (erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<and>\n              u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n              erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t))\n               g \\<plusminus>\\<^bsub>R'\\<^esub>\n              v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n              erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n              erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (erule bexE, erule bexE, (erule conjE)+,\n      frule_tac erH_mem[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n                     \"pj S (S \\<diamondsuit>\\<^sub>p t)\" \"g\"], assumption+,\n      frule_tac erH_mem[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n                      \"pj S (S \\<diamondsuit>\\<^sub>p t)\" \"h\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u v.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u \\<in> carrier R'; v \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (rename_tac ra u' v')"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule_tac g' = v' in erH_inv[of \"S \\<diamondsuit>\\<^sub>p t\" R' Y], assumption+,\n        simp add:PolynRg.is_Ring[of R'], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        \\<exists>g\\<in>carrier R.\n           deg R S X g\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  v' \\<and>\n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n           v'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (frule_tac g' = u' in erH_inv[of \"S \\<diamondsuit>\\<^sub>p t\" R' Y ], assumption+,\n        simp add:PolynRg.is_Ring[of R'], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v'.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        \\<exists>g\\<in>carrier R.\n           deg R S X g\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  v' \\<and>\n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n           v';\n        \\<exists>g\\<in>carrier R.\n           deg R S X g\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  u' \\<and>\n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n           u'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply ((erule bexE)+, rename_tac ra u' v' v u, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u'\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (\n    frule_tac p1 = u in erH_mult[THEN sym, of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \n        \"pj S (S \\<diamondsuit>\\<^sub>p t)\"  _ \"g\"], assumption+,\n    frule_tac p1 = v in erH_mult[THEN sym, of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n        \"pj S (S \\<diamondsuit>\\<^sub>p t)\"  _ \"h\"], assumption+,\n    thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n    thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n    thin_tac \"rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))", "apply (subgoal_tac \"g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v \\<in> carrier R \\<and>\n         h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u \\<in> carrier R \\<and>\n         deg R S X (g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v) \\<le>  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) (g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v))  \\<and>\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (g \\<plusminus> -\\<^sub>a (g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v)) \\<and>\n         deg R S X (h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u) +  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n            (g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v)) \\<le> deg R S X f \\<and>\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ( h \\<plusminus> -\\<^sub>a (h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u)) \\<and>\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>))\n         ( f \\<plusminus> -\\<^sub>a ((g \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r (h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n        \\<in> carrier R \\<and>\n        h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n        \\<in> carrier R \\<and>\n        deg R S X (g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (g \\<plusminus>\n                  t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (g \\<plusminus>\n          -\\<^sub>a (g \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n        deg R S X (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (h \\<plusminus>\n          -\\<^sub>a (h \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a (g \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                     v) \\<cdot>\\<^sub>r\n                    (h \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> g \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R \\<and>\n                         h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (thin_tac \"deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f\",\n      thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n            deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h))\",\n      thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v' \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n      thin_tac \"u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \n         \\<in> carrier R'\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h \n          \\<in> carrier R'\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) v = v'\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) u = u'\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g)\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R'; v \\<in> carrier R;\n        u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n        \\<in> carrier R \\<and>\n        h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n        \\<in> carrier R \\<and>\n        deg R S X (g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (g \\<plusminus>\n                  t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (g \\<plusminus>\n          -\\<^sub>a (g \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n        deg R S X (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (h \\<plusminus>\n          -\\<^sub>a (h \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a (g \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                     v) \\<cdot>\\<^sub>r\n                    (h \\<plusminus>\n                     t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g1.\n                            g1 \\<in> carrier R \\<and>\n                            (\\<exists>h1.\n                                h1 \\<in> carrier R \\<and>\n                                deg R S X g1\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a g1) \\<and>\n                                deg R S X h1 +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     g1)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a h1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a g1 \\<cdot>\\<^sub>r h1))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> g \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R \\<and>\n                         h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\\<rbrakk>\n       \\<Longrightarrow> g \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R \\<and>\n                         h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule mem_subring_mem_ring[of \"S\" \"t^\\<^bsup>S  m\\<^esup>\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R \\<and>\n                         h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> g \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule aGroup.ag_pOp_closed, assumption+,\n        rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus>\n                         t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n                         \\<in> carrier R \\<and>\n                         deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI,\n        rule aGroup.ag_pOp_closed, assumption+,\n        rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule Ring.a_in_principal[of \"S\" \"t\"], assumption+,\n       frule Ring.maximal_ideal_ideal[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\"], assumption+,\n       frule Ring.ideal_npow_closed[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\" \"t\" \"m\"], assumption+,\n       frule PolynRg.is_Ring[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y],\n       frule Ring.ring_is_ag[of R'],\n       frule erH_rHom[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y \"pj S (S \\<diamondsuit>\\<^sub>p t)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\n                                   v)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule pHom_dec_deg[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n      \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\" g], assumption+,\n       frule_tac i = \"deg R S X v\" and j = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\" and \n        k = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" in ale_trans,\n      assumption, \n      thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u' \\<le> amax (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n            deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h))\",\n       thin_tac \"u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\",\n        thin_tac \"deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X g;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (g \\<plusminus>\n                                   t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst P_mod_erH[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" \"R'\" \"Y\" \"g\" _  \"t^\\<^bsup>S m\\<^esup>\"], \n       assumption+,\n       thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                   \\<le> deg R S X g\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac p = v in const_times_polyn1[of _ \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n       frule_tac q = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v\" in polyn_deg_add4[of \"g\" _ \n          \"deg_n R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) =\n        deg R S X v\\<rbrakk>\n       \\<Longrightarrow> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n                         \\<in> carrier R\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) =\n        deg R S X v\\<rbrakk>\n       \\<Longrightarrow> deg R S X g\n                         \\<le> an (deg_n R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) =\n        deg R S X v\\<rbrakk>\n       \\<Longrightarrow> deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> an (deg_n R'\n                                    (S /\\<^sub>r\n                                     (S \\<diamondsuit>\\<^sub>p t))\n                                    Y (erH R S X R'\n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n  (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n 4. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) = deg R S X v;\n        deg R S X (g \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n        \\<le> an (deg_n R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                     Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (g \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 5. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule ring_tOp_closed, assumption+,\n        simp del:npow_suc add:PolynRg.deg_an[THEN sym],\n        simp add:PolynRg.deg_an[THEN sym],\n        simp add:PolynRg.deg_an[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)) \\<and>\n                         deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule Ring.principal_ideal[of S \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        frule Ring.a_in_principal[of S \"t^\\<^bsup>S m\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        t^\\<^bsup>S m\\<^esup>\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac y = v in ring_tOp_closed[of \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        subst aGroup.ag_p_inv, assumption+,\n        frule aGroup.ag_mOp_closed[of \"R\" \"g\"], assumption+,\n        frule_tac x = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v\" in aGroup.ag_mOp_closed[of \"R\"], \n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        t^\\<^bsup>S m\\<^esup>\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>);\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (g \\<plusminus>\n                           (-\\<^sub>a g \\<plusminus>\n                            -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r\nv))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n        subst aGroup.ag_r_inv1[of \"R\"], assumption+,\n        subst aGroup.ag_l_zero[of \"R\"], assumption+,\n        rule P_mod_minus, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        t^\\<^bsup>S m\\<^esup>\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>);\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v)\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule_tac g = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r v\" in Pmod0_principal_rev[of  \n       \"t^\\<^bsup>S m\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        t^\\<^bsup>S m\\<^esup>\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>);\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v \\<in> carrier R;\n        -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>carrier R.\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v =\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r h\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (g \\<plusminus>\n                             t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v))\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst P_mod_erH[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" R' Y g _ \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra)\",\n       thin_tac \"f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h) = t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra\",\n       thin_tac \n        \"u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n         v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (case_tac \"\n         (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n          deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)) \\<le> \n         (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (simp add:amax_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac i = \"deg R S X u\" and j = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\" and \n       k = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\" in ale_trans, \n          assumption+,\n       frule pHom_dec_deg[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n          \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\" h], assumption+,\n       frule_tac i = \"deg R S X u\" and j = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\" and \n           k = \"deg R S X h\" in ale_trans, assumption+,\n       frule_tac p = u and c = \"t^\\<^bsup>S m\\<^esup>\" in const_times_polyn1,\n             assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\n        \\<le> deg R S X h;\n        deg R S X u \\<le> deg R S X h;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) =\n        deg R S X u\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac q = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u\" in polyn_deg_add4[of h _  \"deg_n R S X h\"],\n       rule ring_tOp_closed, assumption+,\n       subst deg_an[THEN sym], assumption+, rule ale_refl,\n       subst deg_an[THEN sym], assumption+,\n       simp, frule deg_an[THEN sym, of h], assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\n        \\<le> deg R S X h;\n        deg R S X u \\<le> deg R S X h;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) = deg R S X u;\n        deg R S X (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<le> deg R S X h;\n        an (deg_n R S X h) = deg R S X h\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule_tac x = \"deg R S X ( h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u)\" in aadd_le_mono[of _ \n       \"deg R S X h\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"],\n       rule_tac i = \"deg R S X ( h \\<plusminus> (t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u) + (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n         Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\" in  \n         ale_trans[of _ \"deg R S X h + (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\" \"deg R S X f\"], \n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (simp add:amax_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        \\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n               deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n               \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                      (erH R S X R'\n                        (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                        (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (thin_tac \"\\<not> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n          deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n          \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<le> deg R S X f\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst aplus_le_aminus[of _ \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" \"deg R S X f\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n                         \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X f \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 4. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> - deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                            Y (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 5. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n                         \\<le> deg R S X f -\n                               deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 6. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule deg_in_aug_minf,\n        rule aGroup.ag_pOp_closed, assumption+,\n        rule ring_tOp_closed, assumption+,\n        rule PolynRg.deg_in_aug_minf, assumption+,\n        rule deg_in_aug_minf, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> - deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                            Y (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n                         \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n                         \\<le> deg R S X f -\n                               deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst PolynRg.deg_an, assumption+, simp add:minus_an_in_aug_minf,\n        frule_tac y = u in ring_tOp_closed[of \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        frule_tac q = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u\" in polyn_deg_add5[of h _ \n         \"deg R S X f - deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"],\n         assumption+,\n        frule deg_in_aug_minf[of h],\n        subst aplus_le_aminus[THEN sym, of \"deg R S X h\" \n         \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" \n        \"deg R S X f\"], assumption+,\n        rule PolynRg.deg_in_aug_minf, assumption+,\n        rule deg_in_aug_minf, assumption+,\n        subst PolynRg.deg_an, assumption+,\n        simp add:minus_an_in_aug_minf,\n        assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n                         \\<le> deg R S X f -\n                               deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R; g \\<cdot>\\<^sub>r h \\<in> carrier R;\n        deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        deg R S X (h \\<plusminus> t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n        \\<le> deg R S X f -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n       \\<Longrightarrow> deg R S X\n                          (h \\<plusminus>\n                           t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)\n                         \\<le> deg R S X f -\n                               deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n 3. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (subst const_times_polyn1, assumption+,\n        frule_tac i = \"deg R S X u\" and j = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\" and\n         k = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n              deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" in \n         ale_trans, assumption+,\n        frule_tac p = ra in pHom_dec_deg[of R' \"S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)\" Y\n         \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\"], assumption+,\n        frule_tac i = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra)\" and \n         j = \"deg R S X ra\" and k = \"deg R S X f\" in ale_trans, assumption+,\n        frule_tac a = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra)\" and \n          a' = \"deg R S X f\" and b = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" in\n          adiff_le_adiff,\n        frule_tac i = \"deg R S X u\" and j = \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n           deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" and \n          k = \"deg R S X f - deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" in \n           ale_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (h \\<plusminus>\n                           -\\<^sub>a (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (frule Ring.principal_ideal[of \"S\" \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        frule Ring.a_in_principal[of \"S\" \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        frule_tac y = u in ring_tOp_closed[of \"t^\\<^bsup>S m\\<^esup>\"], assumption+,\n        subst aGroup.ag_p_inv, assumption+,\n        frule aGroup.ag_mOp_closed[of \"R\" \"g\"], assumption+,\n        frule_tac x = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u\" in aGroup.ag_mOp_closed[of \"R\"], \n          assumption+,\n        subst aGroup.ag_pOp_assoc[THEN sym], assumption+,\n        rule aGroup.ag_mOp_closed, assumption+,\n        subst aGroup.ag_r_inv1[of \"R\"], assumption+,\n        subst aGroup.ag_l_zero[of \"R\"], assumption+,\n        rule P_mod_minus, assumption+,\n        rule_tac g = \"(t^\\<^bsup>S m\\<^esup>) \\<cdot>\\<^sub>r u\" in Pmod0_principal_rev[of \"t^\\<^bsup>S m\\<^esup>\"], \n         assumption+,\n        thin_tac \"deg R S X g\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n        thin_tac \"deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f\",\n        thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u' \\<le> amax\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n            deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n           (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h))\",\n        thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v' \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n        thin_tac \"\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) ra\",\n        thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g)\",\n        thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t) Y;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        t^\\<^bsup>S m\\<^esup>\n        \\<in> S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>);\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u \\<in> carrier R;\n        -\\<^sub>a g \\<in> carrier R;\n        -\\<^sub>a t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>carrier R.\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u =\n                            t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r h\n 2. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a (g \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r v) \\<cdot>\\<^sub>r\n                                     (h \\<plusminus>\nt^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r u))", "apply (rule_tac u = u and v = v and ra = ra in P_mod_diffxxx1[of t R' Y f g h],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ra u' v' v u.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra);\n        0 < m; Subring R S; Ring S; aGroup R;\n        Corps (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        pj S (S \\<diamondsuit>\\<^sub>p t)\n        \\<in> rHom S (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        t \\<in> carrier R; Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        g \\<noteq> \\<zero>;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<noteq>\n        \\<zero>\\<^bsub>R'\\<^esub>;\n        0 \\<le> deg R S X h; h \\<noteq> \\<zero>; f \\<noteq> \\<zero>;\n        ra \\<in> carrier R;\n        f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h =\n        t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra;\n        g \\<cdot>\\<^sub>r h \\<in> carrier R; deg R S X ra \\<le> deg R S X f;\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        t^\\<^bsup>S m\\<^esup> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        deg R S X (t^\\<^bsup>S m\\<^esup> \\<cdot>\\<^sub>r ra) = deg R S X ra;\n        u' \\<in> carrier R'; v' \\<in> carrier R';\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u'\n        \\<le> amax\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) ra) -\n                deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) g))\n               (deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                   (pj S (S \\<diamondsuit>\\<^sub>p t)) h));\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v'\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        u' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         g \\<plusminus>\\<^bsub>R'\\<^esub>\n        v' \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) ra;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g\n        \\<in> carrier R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n        \\<in> carrier R';\n        v \\<in> carrier R; u \\<in> carrier R;\n        deg R S X v\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y v';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) v =\n        v';\n        deg R S X u\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) u =\n        u';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (u \\<cdot>\\<^sub>r g);\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (v \\<cdot>\\<^sub>r h);\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier R;\n        t \\<in> S \\<diamondsuit>\\<^sub>p t;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        t^\\<^bsup>S m\\<^esup> \\<in> S \\<diamondsuit>\\<^sub>p t; Ring R';\n        aGroup R';\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n        \\<in> pHom R S X, R' S /\\<^sub>r\n                             (S \\<diamondsuit>\\<^sub>p t) Y\\<rbrakk>\n       \\<Longrightarrow> erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          u \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          g \\<plusminus>\\<^bsub>R'\\<^esub>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          v \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) h =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) ra", "apply (rotate_tac -12,\n       drule sym, drule sym, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(** Hensel_next R S X t R' Y f m gh **)"], ["", "definition\n  Hensel_next :: \"[('a, 'b) Ring_scheme, ('a, 'c) Ring_scheme, 'a, 'a,\n ('a set, 'm) Ring_scheme, 'a set,'a, nat] \\<Rightarrow> ('a \\<times> 'a) \\<Rightarrow> ('a \\<times> 'a)\"\n     (\"(9Hen\\<^bsub> _ _ _ _ _ _ _\\<^esub> _ _)\"  [67,67,67,67,67,67,67,68]67) where\n\n \"Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh = (SOME gh1. \n      gh1 \\<in> carrier R \\<times> carrier R \\<and>\n      (deg R S X (fst gh1) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst gh) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (fst gh1)) \\<and> \n  (deg R S X (snd gh1) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n      (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p  t)) Y (pj S (S \\<diamondsuit>\\<^sub>p  t)) (fst gh1)) \\<le> deg R S X f) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd gh) \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> (snd gh1)) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> ((fst gh1) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (snd gh1)))))\""], ["", "lemma  cart_prod_fst:\"x \\<in> A \\<times> B \\<Longrightarrow> fst x \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> A \\<times> B \\<Longrightarrow> fst x \\<in> A", "by auto"], ["", "lemma  cart_prod_snd:\"x \\<in> A \\<times> B \\<Longrightarrow> snd x \\<in> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> A \\<times> B \\<Longrightarrow> snd x \\<in> B", "by auto"], ["", "lemma cart_prod_split:\"((x,y) \\<in> A \\<times> B) = (x \\<in> A \\<and> y \\<in> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ((x, y) \\<in> A \\<times> B) = (x \\<in> A \\<and> y \\<in> B)", "by auto"], ["", "lemma (in PolynRg) P_mod_diffxxx3:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n   maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n   f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n   deg R S X (fst gh) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));  \n   deg R S X (snd gh) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst gh) \\<cdot>\\<^sub>r (snd gh))); 0 < m\\<rbrakk> \\<Longrightarrow> \n  \\<exists>gh1. gh1 \\<in>carrier R \\<times> carrier R \\<and> \n       (deg R S X (fst gh1) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))) \\<and> \n   P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst gh) \\<plusminus> -\\<^sub>a (fst gh1)) \\<and> \n       (deg R S X (snd gh1) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<le> \n                                                              deg R S X f) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd gh) \\<plusminus> -\\<^sub>a (snd gh1)) \\<and> \n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a ((fst gh1) \\<cdot>\\<^sub>r (snd gh1))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst gh)\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     deg R S X (snd gh) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>gh1.\n                         gh1 \\<in> carrier R \\<times> carrier R \\<and>\n                         deg R S X (fst gh1)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst gh1)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n                         deg R S X (snd gh1) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1)", "apply (cases gh)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst gh)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n        deg R S X (snd gh) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n        0 < m; gh = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>gh1.\n                            gh1 \\<in> carrier R \\<times> carrier R \\<and>\n                            deg R S X (fst gh1)\n                            \\<le> deg R'\n                                   (S /\\<^sub>r\n                                    (S \\<diamondsuit>\\<^sub>p t))\n                                   Y (erH R S X R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n                            P_mod R S X\n                             (S \\<diamondsuit>\\<^sub>p\n                              (t^\\<^bsup>S m\\<^esup>))\n                             (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n                            deg R S X (snd gh1) +\n                            deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst gh1))\n                            \\<le> deg R S X f \\<and>\n                            P_mod R S X\n                             (S \\<diamondsuit>\\<^sub>p\n                              (t^\\<^bsup>S m\\<^esup>))\n                             (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n                            P_mod R S X\n                             (S \\<diamondsuit>\\<^sub>p\n                              (t^\\<^bsup>S Suc m\\<^esup>))\n                             (f \\<plusminus>\n                              -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1)", "apply (simp del: npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; a \\<in> carrier R \\<and> b \\<in> carrier R;\n        deg R S X a\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) a);\n        deg R S X b +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) a)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) a);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) b);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) a)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) b);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b);\n        0 < m; gh = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>aa.\n                            aa \\<in> carrier R \\<and>\n                            (\\<exists>ba.\n                                ba \\<in> carrier R \\<and>\n                                deg R S X aa\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) aa) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (a \\<plusminus> -\\<^sub>a aa) \\<and>\n                                deg R S X ba +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     aa)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (b \\<plusminus> -\\<^sub>a ba) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a aa \\<cdot>\\<^sub>r ba))", "apply (rename_tac g h)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        0 < m; gh = (g, h)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            a \\<in> carrier R \\<and>\n                            (\\<exists>b.\n                                b \\<in> carrier R \\<and>\n                                deg R S X a\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) a) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a a) \\<and>\n                                deg R S X b +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     a)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a b) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a a \\<cdot>\\<^sub>r b))", "apply (erule conjE,\n        frule_tac g = g and h = h and f = f in P_mod_diffxxx2[of t R' Y],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        0 < m; gh = (g, h); g \\<in> carrier R; h \\<in> carrier R;\n        \\<exists>g1 h1.\n           g1 \\<in> carrier R \\<and>\n           h1 \\<in> carrier R \\<and>\n           deg R S X g1\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                    (pj S (S \\<diamondsuit>\\<^sub>p t)) g1) \\<and>\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n            (g \\<plusminus> -\\<^sub>a g1) \\<and>\n           deg R S X h1 +\n           deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g1)\n           \\<le> deg R S X f \\<and>\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n            (h \\<plusminus> -\\<^sub>a h1) \\<and>\n           P_mod R S X\n            (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n            (f \\<plusminus> -\\<^sub>a g1 \\<cdot>\\<^sub>r h1)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a.\n                            a \\<in> carrier R \\<and>\n                            (\\<exists>b.\n                                b \\<in> carrier R \\<and>\n                                deg R S X a\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) a) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (g \\<plusminus> -\\<^sub>a a) \\<and>\n                                deg R S X b +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     a)\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (h \\<plusminus> -\\<^sub>a b) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a a \\<cdot>\\<^sub>r b))", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_diffxxx4:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n      gh \\<in> carrier R \\<times> carrier R;\n      deg R S X (fst gh) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));  \n   deg R S X (snd gh) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh)) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst gh) \\<cdot>\\<^sub>r (snd gh))); 0 < m\\<rbrakk> \\<Longrightarrow> \n  (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh) \\<in> carrier R \\<times> carrier R  \\<and> (deg R S X\n     (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                                   (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)))) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst gh) \\<plusminus> -\\<^sub>a (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<and> \n  (deg R S X (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n        (fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<le>  deg R S X f) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd gh) \\<plusminus> -\\<^sub>a (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh))) \\<and> \n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) (f \\<plusminus> (-\\<^sub>a ((fst (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)) \\<cdot>\\<^sub>r \n             (snd (Hen\\<^bsub>R S X t R' Y f \\<^esub> m gh)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst gh)\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     deg R S X (snd gh) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst gh \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh)) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd gh \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> m gh))", "apply (unfold Hensel_next_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst gh)\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     deg R S X (snd gh) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> (SOME gh1.\n                          gh1 \\<in> carrier R \\<times> carrier R \\<and>\n                          deg R S X (fst gh1)\n                          \\<le> deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     (fst gh1)) \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S m\\<^esup>))\n                           (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n                          deg R S X (snd gh1) +\n                          deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst gh1))\n                          \\<le> deg R S X f \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S m\\<^esup>))\n                           (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S Suc m\\<^esup>))\n                           (f \\<plusminus>\n                            -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1))\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      deg R S X\n                       (fst (SOME gh1.\n                                gh1\n                                \\<in> carrier R \\<times> carrier R \\<and>\n                                deg R S X (fst gh1)\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (fst gh \\<plusminus>\n                                  -\\<^sub>a fst gh1) \\<and>\n                                deg R S X (snd gh1) +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     (fst gh1))\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (snd gh \\<plusminus>\n                                  -\\<^sub>a snd gh1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r\n      snd gh1)))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (SOME gh1.\n  gh1 \\<in> carrier R \\<times> carrier R \\<and>\n  deg R S X (fst gh1)\n  \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n   (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n  deg R S X (snd gh1) +\n  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n  \\<le> deg R S X f \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n   (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n   (f \\<plusminus> -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1)))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst gh \\<plusminus>\n                        -\\<^sub>a fst (SOME gh1.\n    gh1 \\<in> carrier R \\<times> carrier R \\<and>\n    deg R S X (fst gh1)\n    \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n    deg R S X (snd gh1) +\n    deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n    \\<le> deg R S X f \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n     (f \\<plusminus> -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1))) \\<and>\n                      deg R S X\n                       (snd (SOME gh1.\n                                gh1\n                                \\<in> carrier R \\<times> carrier R \\<and>\n                                deg R S X (fst gh1)\n                                \\<le> deg R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (fst gh \\<plusminus>\n                                  -\\<^sub>a fst gh1) \\<and>\n                                deg R S X (snd gh1) +\n                                deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     (fst gh1))\n                                \\<le> deg R S X f \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S m\\<^esup>))\n                                 (snd gh \\<plusminus>\n                                  -\\<^sub>a snd gh1) \\<and>\n                                P_mod R S X\n                                 (S \\<diamondsuit>\\<^sub>p\n                                  (t^\\<^bsup>S Suc m\\<^esup>))\n                                 (f \\<plusminus>\n                                  -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r\n      snd gh1))) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (SOME gh1.\n                                  gh1\n                                  \\<in> carrier R \\<times> carrier R \\<and>\n                                  deg R S X (fst gh1)\n                                  \\<le> deg R'\n   (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n                                  P_mod R S X\n                                   (S \\<diamondsuit>\\<^sub>p\n                                    (t^\\<^bsup>S m\\<^esup>))\n                                   (fst gh \\<plusminus>\n                                    -\\<^sub>a fst gh1) \\<and>\n                                  deg R S X (snd gh1) +\n                                  deg R'\n                                   (S /\\<^sub>r\n                                    (S \\<diamondsuit>\\<^sub>p t))\n                                   Y (erH R S X R'\n (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n                                  \\<le> deg R S X f \\<and>\n                                  P_mod R S X\n                                   (S \\<diamondsuit>\\<^sub>p\n                                    (t^\\<^bsup>S m\\<^esup>))\n                                   (snd gh \\<plusminus>\n                                    -\\<^sub>a snd gh1) \\<and>\n                                  P_mod R S X\n                                   (S \\<diamondsuit>\\<^sub>p\n                                    (t^\\<^bsup>S Suc m\\<^esup>))\n                                   (f \\<plusminus>\n                                    -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r\n        snd gh1))))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd gh \\<plusminus>\n                        -\\<^sub>a snd (SOME gh1.\n    gh1 \\<in> carrier R \\<times> carrier R \\<and>\n    deg R S X (fst gh1)\n    \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n    deg R S X (snd gh1) +\n    deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n    \\<le> deg R S X f \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n     (f \\<plusminus> -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (SOME gh1.\n    gh1 \\<in> carrier R \\<times> carrier R \\<and>\n    deg R S X (fst gh1)\n    \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n    deg R S X (snd gh1) +\n    deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n    \\<le> deg R S X f \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n     (f \\<plusminus>\n      -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1)) \\<cdot>\\<^sub>r\n                                  snd (SOME gh1.\n    gh1 \\<in> carrier R \\<times> carrier R \\<and>\n    deg R S X (fst gh1)\n    \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1)) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (fst gh \\<plusminus> -\\<^sub>a fst gh1) \\<and>\n    deg R S X (snd gh1) +\n    deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n     (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh1))\n    \\<le> deg R S X f \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n     (snd gh \\<plusminus> -\\<^sub>a snd gh1) \\<and>\n    P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n     (f \\<plusminus> -\\<^sub>a fst gh1 \\<cdot>\\<^sub>r snd gh1)))", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst gh)\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     deg R S X (snd gh) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n      (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a.\n                         a \\<in> carrier R \\<times> carrier R \\<and>\n                         deg R S X (fst a)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst a)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst gh \\<plusminus> -\\<^sub>a fst a) \\<and>\n                         deg R S X (snd a) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst a))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd gh \\<plusminus> -\\<^sub>a snd a) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst a \\<cdot>\\<^sub>r snd a)\n 2. \\<And>x.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; gh \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst gh)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n        deg R S X (snd gh) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst gh))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd gh));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a fst gh \\<cdot>\\<^sub>r snd gh);\n        0 < m;\n        x \\<in> carrier R \\<times> carrier R \\<and>\n        deg R S X (fst x)\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst x)) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst gh \\<plusminus> -\\<^sub>a fst x) \\<and>\n        deg R S X (snd x) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst x))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd gh \\<plusminus> -\\<^sub>a snd x) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (f \\<plusminus> -\\<^sub>a fst x \\<cdot>\\<^sub>r snd x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R \\<times> carrier R \\<and>\n                         deg R S X (fst x)\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst x)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst gh \\<plusminus> -\\<^sub>a fst x) \\<and>\n                         deg R S X (snd x) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst x))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd gh \\<plusminus> -\\<^sub>a snd x) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc m\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst x \\<cdot>\\<^sub>r snd x)", "apply (rule P_mod_diffxxx3, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(* Hensel_pair R S X t R' Y f g h m *)"], ["", "primrec\n  Hensel_pair :: \"[('a, 'b) Ring_scheme, ('a, 'c) Ring_scheme, 'a, 'a,\n    ('a set, 'm) Ring_scheme, 'a set, 'a, 'a, 'a, nat] \\<Rightarrow> ('a \\<times> 'a)\"\n      (\"(10Hpr\\<^bsub> _ _ _ _ _ _ _ _ _\\<^esub> _)\"  [67,67,67,67,67,67,67,67,67,68]67)\nwhere\n  Hpr_0: \"Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> 0 = (g, h)\"\n| Hpr_Suc: \"Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m) = \n            Hen\\<^bsub>R S X t R' Y f \\<^esub> (Suc m) (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)\""], ["", "lemma (in PolynRg) fst_xxx:\" \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; ideal S (S \\<diamondsuit>\\<^sub>p t);  \n   \\<forall>(n::nat). (F n) \\<in> carrier R \\<times> carrier R; \n   \\<forall>m. P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (fst (F m) \\<plusminus> -\\<^sub>a (fst (F (Suc m))))\\<rbrakk> \\<Longrightarrow>\n       P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (fst (F 0) \\<plusminus> -\\<^sub>a (fst (F n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n     Subring R S; Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n     Subring R S; Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (fst (F 0) \\<plusminus> -\\<^sub>a fst (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (drule_tac x = 0 in spec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n     Subring R S; Ring S; aGroup R;\n     F 0 \\<in> carrier R \\<times> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (fst (F 0) \\<plusminus> -\\<^sub>a fst (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (frule cart_prod_fst[of \"F 0\" \"carrier R\" \"carrier R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n     Subring R S; Ring S; aGroup R; F 0 \\<in> carrier R \\<times> carrier R;\n     fst (F 0) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (fst (F 0) \\<plusminus> -\\<^sub>a fst (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n     Subring R S; Ring S; aGroup R; F 0 \\<in> carrier R \\<times> carrier R;\n     fst (F 0) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (frule_tac x = 0 in spec,\n       frule_tac x = n in spec,\n       drule_tac x = \"Suc n\" in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (frule_tac x = \"F 0\" in cart_prod_fst[of _ \"carrier R\" \"carrier R\"],\n        frule_tac x = \"F n\" in cart_prod_fst[of _ \"carrier R\" \"carrier R\"],\n        frule_tac x = \"F (Suc n)\" in cart_prod_fst[of _ \"carrier R\" \n                                                             \"carrier R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (fst (F m) \\<plusminus> -\\<^sub>a fst (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (drule_tac x = n in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (frule_tac p = \"fst (F 0) \\<plusminus> -\\<^sub>a (fst (F n))\" and \n                 q = \"fst (F n) \\<plusminus> -\\<^sub>a (fst (F (Suc n)))\" in \n       P_mod_add[of  \"S \\<diamondsuit>\\<^sub>p t\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> fst (F 0) \\<plusminus> -\\<^sub>a fst (F n)\n                         \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n))\n                         \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n))\n 4. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)))\n 5. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n) \\<plusminus>\n          (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed, \n       assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n) \\<plusminus>\n          (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (frule_tac x = \"fst (F n)\" in aGroup.ag_mOp_closed, assumption+,\n       frule_tac x = \"fst (F (Suc n))\" in aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        fst (F 0) \\<in> carrier R; fst (F n) \\<in> carrier R;\n        fst (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (F 0) \\<plusminus> -\\<^sub>a fst (F n) \\<plusminus>\n          (fst (F n) \\<plusminus> -\\<^sub>a fst (F (Suc n))));\n        -\\<^sub>a fst (F n) \\<in> carrier R;\n        -\\<^sub>a fst (F (Suc n)) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (fst (F 0) \\<plusminus> -\\<^sub>a fst (F (Suc n)))", "apply (simp add:aGroup.pOp_assocTr41[of \"R\", THEN sym],\n       simp add:aGroup.pOp_assocTr42[of \"R\"],\n       simp add:aGroup.ag_l_inv1,\n       simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) snd_xxx:\"\\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n   ideal S (S \\<diamondsuit>\\<^sub>p t);  \\<forall>(n::nat). (F n) \\<in> carrier R \\<times> carrier R; \n  \\<forall>m. P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (snd (F m) \\<plusminus> -\\<^sub>a (snd (F (Suc m))))\\<rbrakk> \\<Longrightarrow>\n   P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (snd (F 0) \\<plusminus> -\\<^sub>a (snd (F n)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)))\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n     Subring R S; Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n     Subring R S; Ring S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (snd (F 0) \\<plusminus> -\\<^sub>a snd (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (drule_tac x = 0 in spec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n     Subring R S; Ring S; aGroup R;\n     F 0 \\<in> carrier R \\<times> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (snd (F 0) \\<plusminus> -\\<^sub>a snd (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (frule cart_prod_snd[of \"F 0\" \"carrier R\" \"carrier R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n     Subring R S; Ring S; aGroup R; F 0 \\<in> carrier R \\<times> carrier R;\n     snd (F 0) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (snd (F 0) \\<plusminus> -\\<^sub>a snd (F 0))\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     \\<forall>m.\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n     Subring R S; Ring S; aGroup R; F 0 \\<in> carrier R \\<times> carrier R;\n     snd (F 0) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t) \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>n. F n \\<in> carrier R \\<times> carrier R;\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (frule_tac x = 0 in spec,\n       frule_tac x = n in spec,\n       drule_tac x = \"Suc n\" in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (frule_tac x = \"F 0\" in cart_prod_snd[of _ \"carrier R\" \"carrier R\"],\n        frule_tac x = \"F n\" in cart_prod_snd[of _ \"carrier R\" \"carrier R\"],\n        frule_tac x = \"F (Suc n)\" in cart_prod_snd[of _ \"carrier R\" \n                                                             \"carrier R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        \\<forall>m.\n           P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n            (snd (F m) \\<plusminus> -\\<^sub>a snd (F (Suc m)));\n        Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (drule_tac x = n in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (frule_tac p = \"snd (F 0) \\<plusminus> -\\<^sub>a (snd (F n))\" and \n                 q = \"snd (F n) \\<plusminus> -\\<^sub>a (snd (F (Suc n)))\" in \n       P_mod_add[of  \"S \\<diamondsuit>\\<^sub>p t\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> snd (F 0) \\<plusminus> -\\<^sub>a snd (F n)\n                         \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n))\n                         \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n))\n 4. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)))\n 5. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n) \\<plusminus>\n          (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed, \n       assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n) \\<plusminus>\n          (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (frule_tac x = \"snd (F n)\" in aGroup.ag_mOp_closed, assumption+,\n       frule_tac x = \"snd (F (Suc n))\" in aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        ideal S (S \\<diamondsuit>\\<^sub>p t); Subring R S; Ring S; aGroup R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n));\n        F 0 \\<in> carrier R \\<times> carrier R;\n        F n \\<in> carrier R \\<times> carrier R;\n        F (Suc n) \\<in> carrier R \\<times> carrier R;\n        snd (F 0) \\<in> carrier R; snd (F n) \\<in> carrier R;\n        snd (F (Suc n)) \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (F 0) \\<plusminus> -\\<^sub>a snd (F n) \\<plusminus>\n          (snd (F n) \\<plusminus> -\\<^sub>a snd (F (Suc n))));\n        -\\<^sub>a snd (F n) \\<in> carrier R;\n        -\\<^sub>a snd (F (Suc n)) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                          (snd (F 0) \\<plusminus> -\\<^sub>a snd (F (Suc n)))", "apply (simp add:aGroup.pOp_assocTr41[of \"R\", THEN sym],\n       simp add:aGroup.pOp_assocTr42[of \"R\"],\n       simp add:aGroup.ag_l_inv1,\n       simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) P_mod_diffxxx5:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n      f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (g, h)) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));  \n  deg R S X (snd (g, h)) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n  (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h))) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n                                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h))) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n  (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)) \\<in> carrier R \\<times> carrier R  \\<and>\n   erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                       (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n            erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n   erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                       (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n            erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     (deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n                                     (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))))) \\<and> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                             (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n(deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<le>  deg R S X f) \\<and>\nP_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc m))\\<^esup>)) (f \\<plusminus> -\\<^sub>a ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<cdot>\\<^sub>r (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (g, h))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     deg R S X (snd (g, h)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (g, h)) \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (g, h)) \\<and>\n                      deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n m))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m) \\<cdot>\\<^sub>r\n                                  snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m))", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac ring_is_ag,\n       frule mem_subring_mem_ring[of S t], assumption+,\n       frule Ring.maximal_ideal_ideal[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (g, h))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     deg R S X (snd (g, h)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (g, h)) \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (g, h)) \\<and>\n                      deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n m))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m) \\<cdot>\\<^sub>r\n                                  snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m))", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (g, h))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     deg R S X (snd (g, h)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc 0\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               0)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (g, h)) \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               0)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (g, h)) \\<and>\n                      deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc 0))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n 0))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   0)) \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               0)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 0)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   0)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   0) \\<cdot>\\<^sub>r\n                                  snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   0))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (simp del:Hpr_0 npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                   0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0) \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                             0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0) \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> 0))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (simp only:Hpr_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h)))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                   0 (g, h)))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (g, h) \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                             0 (g, h))))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (g, h) \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (frule P_mod_diffxxx4[of t R' Y f \"(g, h)\" \"Suc 0\"],\n           assumption+)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> (g, h) \\<in> carrier R \\<times> carrier R\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> deg R S X (fst (g, h))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (g, h)))\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> deg R S X (snd (g, h)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n                      \\<le> deg R S X f\n 4. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> 0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (g, h)))\n 5. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> 0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (snd (g, h)))\n 6. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> rel_prime_pols R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)))\n 7. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (g, h) \\<cdot>\\<^sub>r snd (g, h))\n 8. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> 0 < Suc 0\n 9. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n     \\<in> carrier R \\<times> carrier R \\<and>\n     deg R S X (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                  0 (g, h)))) \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (fst (g, h) \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     deg R S X (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (snd (g, h) \\<plusminus>\n       -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)) \\<cdot>\\<^sub>r\n                 snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)))\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h)))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                   0 (g, h)))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (g, h) \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                             0 (g, h))))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (g, h) \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)))\n 10. \\<And>n.\n        \\<lbrakk>Idomain S; t \\<in> carrier S;\n         t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n         maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n         PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n         f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n         deg R S X (fst (g, h))\n         \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n         deg R S X (snd (g, h)) +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         \\<le> deg R S X f;\n         0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n         0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n         rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n          (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n         Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n         ideal S (S \\<diamondsuit>\\<^sub>p t);\n         Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n         \\<in> carrier R \\<times> carrier R \\<and>\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n         deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n         \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                  (pj S (S \\<diamondsuit>\\<^sub>p t))\n                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                          n))) \\<and>\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n           -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                            n)) \\<and>\n         deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t))\n            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n         \\<le> deg R S X f \\<and>\n         P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n           -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                            n)) \\<and>\n         P_mod R S X\n          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n          (f \\<plusminus>\n           -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                            n) \\<cdot>\\<^sub>r\n                     snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                            n))\\<rbrakk>\n        \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                          \\<in> carrier R \\<times> carrier R \\<and>\n                          erH R S X R'\n                           (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                           (pj S (S \\<diamondsuit>\\<^sub>p t))\n                           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   (Suc n))) =\n                          erH R S X R'\n                           (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                           (pj S (S \\<diamondsuit>\\<^sub>p t))\n                           (fst (g, h)) \\<and>\n                          erH R S X R'\n                           (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                           (pj S (S \\<diamondsuit>\\<^sub>p t))\n                           (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   (Suc n))) =\n                          erH R S X R'\n                           (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                           (pj S (S \\<diamondsuit>\\<^sub>p t))\n                           (snd (g, h)) \\<and>\n                          deg R S X\n                           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   (Suc n)))\n                          \\<le> deg R'\n                                 (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                 Y (erH R S X R'\n                                     (S /\\<^sub>r\n(S \\<diamondsuit>\\<^sub>p t))\n                                     Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                     (fst\n (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))) \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   n) \\<plusminus>\n                            -\\<^sub>a fst\n (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                          deg R S X\n                           (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   (Suc n))) +\n                          deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n (Suc n))))\n                          \\<le> deg R S X f \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                           (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                   n) \\<plusminus>\n                            -\\<^sub>a snd\n (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                          P_mod R S X\n                           (S \\<diamondsuit>\\<^sub>p\n                            (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                           (f \\<plusminus>\n                            -\\<^sub>a fst\n (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\nsnd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (simp add:cart_prod_split, simp+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (1\\<^sub>r\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         t))\n                       (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> 0 < Suc 0\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n     \\<in> carrier R \\<times> carrier R \\<and>\n     deg R S X (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                  0 (g, h)))) \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (fst (g, h) \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     deg R S X (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (snd (g, h) \\<plusminus>\n       -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)) \\<cdot>\\<^sub>r\n                 snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)))\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h)))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                   0 (g, h)))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (g, h) \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                             0 (g, h))))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (g, h) \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)))\n 4. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (simp add:Ring.ring_l_one, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t);\n     Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n     \\<in> carrier R \\<times> carrier R \\<and>\n     deg R S X (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                  0 (g, h)))) \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (fst (g, h) \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     deg R S X (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc 0\\<^esup>))\n      (snd (g, h) \\<plusminus>\n       -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h))) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)) \\<cdot>\\<^sub>r\n                 snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)))\\<rbrakk>\n    \\<Longrightarrow> Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h \\<and>\n                      deg R S X\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h)))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                   0 (g, h)))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (fst (g, h) \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      deg R S X\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                             0 (g, h))))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc 0\\<^esup>))\n                       (snd (g, h) \\<plusminus>\n                        -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc 0)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)) \\<cdot>\\<^sub>r\n                                  snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                                     0 (g, h)))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (simp add:Ring.ring_l_one, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t); g \\<in> carrier R;\n     h \\<in> carrier R;\n     Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (g \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)));\n     deg R S X (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (h \\<plusminus>\n       -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)) \\<cdot>\\<^sub>r\n                 snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)))\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (frule P_mod_diff[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" R' Y g \n                      \"fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> (Suc 0) (g, h))\"], assumption+,\n        simp add:cart_prod_fst, rotate_tac -1, drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))));\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t))\n            (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))));\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n     ideal S (S \\<diamondsuit>\\<^sub>p t); g \\<in> carrier R;\n     h \\<in> carrier R;\n     Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))));\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (g \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)));\n     deg R S X (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h))))\n     \\<le> deg R S X f;\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (h \\<plusminus>\n       -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> t))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                    0 (g, h)) \\<cdot>\\<^sub>r\n                 snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc 0 (g, h)))\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                           0 (g, h))) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t)) h\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply (frule P_mod_diff[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" R' Y h \n                      \"snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> (Suc 0) (g, h))\"], assumption+,\n        simp add:cart_prod_snd, rotate_tac -1, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           n))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc n)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc n))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc n))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  n) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc n))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc n)))", "apply ((erule conjE)+, rename_tac m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc m)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc m))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))", "apply (frule_tac m = \"Suc (Suc m)\" and gh = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc m)\" in \n       P_mod_diffxxx4[of t R' Y f], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> 0 < deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n  m)))\n 2. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> 0 < deg R'\n                              (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                              (erH R S X R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n  m)))\n 3. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> rel_prime_pols R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    m)))\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    m)))\n 4. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n 5. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m))\\<rbrakk>\n       \\<Longrightarrow> 0 < Suc (Suc m)\n 6. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n      (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R \\<and>\n        deg R S X\n         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                     (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m))) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)) \\<and>\n        deg R S X\n         (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n               (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m) \\<cdot>\\<^sub>r\n                    snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc m)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc m))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))", "apply (simp, simp, simp, simp del:npow_suc, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n      (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R \\<and>\n        deg R S X\n         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                     (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m))) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)) \\<and>\n        deg R S X\n         (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n               (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)) \\<and>\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m) \\<cdot>\\<^sub>r\n                    snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc m)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc m))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; (g, h) \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (g, h))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        deg R S X (snd (g, h)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)));\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n      (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        deg R S X\n         (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                     (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m));\n        deg R S X\n         (snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n             (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n               (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n        \\<le> deg R S X f;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m) \\<cdot>\\<^sub>r\n                    snd (Hen\\<^bsub> R S X t R' Y f\\<^esub> Suc\n                       (Suc m) Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m))\\<rbrakk>\n       \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n                         \\<in> carrier R \\<times> carrier R \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (g, h)) \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (g, h)) \\<and>\n                         deg R S X\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m)))\n                         \\<le> deg R'\n                                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                                (erH R S X R'\n                                  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                                  Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                                  (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (Suc m)))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         deg R S X\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) +\n                         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (erH R S X R'\n                            (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                            (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                    (Suc m))))\n                         \\<le> deg R S X f \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n                          (f \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)) \\<cdot>\\<^sub>r\n                                     snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))", "apply (simp del:npow_suc del:Hpr_Suc \n                add:Hpr_Suc[THEN sym, of R S X t R' Y f _ g h])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h;\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n        \\<in> carrier R \\<times> carrier R;\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         (Suc m))));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        deg R S X\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))))\n        \\<le> deg R S X f;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)))\\<rbrakk>\n       \\<Longrightarrow> erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) h", "apply (thin_tac \"deg R S X g\n         \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n       thin_tac \"deg R S X h +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         \\<le> deg R S X f\",\n       thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n       thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n       thin_tac \"rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n       thin_tac \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n         \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n       thin_tac \"deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         \\<le> deg R S X f\",\n       thin_tac \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)))\n         \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))))\",\n       thin_tac \"deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))) +\n         deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))))\n         \\<le> deg R S X f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)))\\<rbrakk>\n       \\<Longrightarrow> erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) h", "apply (frule_tac g = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc m)) \\<plusminus> -\\<^sub>a (fst\n       (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m))))\" and n = \"Suc m\" in P_mod_n_1\n       [of t], assumption+,\n       (rule aGroup.ag_pOp_closed, assumption+, simp add:cart_prod_fst,\n       rule aGroup.ag_mOp_closed, assumption+, simp add:cart_prod_fst,\n       assumption),\n       (frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\" in cart_prod_fst[of _ \n       \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m))\" in cart_prod_fst[of _ \n       \"carrier R\" \"carrier R\"]),\n       (frule_tac g1 = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc m))\" and \n       h1 = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m)))\" in \n       P_mod_diff[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" R' Y], assumption+))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))\n        \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m))) =\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                  (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) h", "apply (frule_tac g = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc m)) \\<plusminus> -\\<^sub>a (snd\n       (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m))))\" and n = \"Suc m\" in P_mod_n_1\n       [of t], assumption+,\n       (rule aGroup.ag_pOp_closed, assumption+, simp add:cart_prod_snd,\n       rule aGroup.ag_mOp_closed, assumption+, simp add:cart_prod_snd,\n       assumption),\n       (frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\" in cart_prod_snd[of _ \n       \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m))\" in cart_prod_snd[of _ \n       \"carrier R\" \"carrier R\"]),\n       (frule_tac g1 = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc m))\" and \n       h1 = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (Suc m)))\" in \n       P_mod_diff[THEN sym, of \"S \\<diamondsuit>\\<^sub>p t\" R' Y], assumption+))"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R \\<and> h \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        Subring R S; Ring S; aGroup R; t \\<in> carrier R;\n        ideal S (S \\<diamondsuit>\\<^sub>p t);\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) g;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) h;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           m) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (Suc m))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))\n        \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m))) =\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m)));\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (Suc m))\n        \\<in> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (Suc m))) =\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                  (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) g \\<and>\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                  (Suc m))) =\n                         erH R S X R'\n                          (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                          (pj S (S \\<diamondsuit>\\<^sub>p t)) h", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*** Hensel_pair basic ***)"], ["", "lemma (in PolynRg) P_mod_diffxxx5_1:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; \n  f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                     (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)) \\<in> carrier R \\<times> carrier R  \\<and>\n erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n     (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) = \n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) \n     (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) =  \n           erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     (deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<le> deg R' \n  (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y  \n                    (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                                      (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n (deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) + \n   deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n     (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<le>  deg R S X f) \\<and>\n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc m)\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus> -\\<^sub>a \n                                      (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))) \\<and> \n P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc m))\\<^esup>)) (f \\<plusminus> -\\<^sub>a \n  ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m))) \\<cdot>\\<^sub>r (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (Suc m)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (g, h)) \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (g, h)) \\<and>\n                      deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n m))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m) \\<cdot>\\<^sub>r\n                                  snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m))", "apply (frule P_mod_diffxxx5[of t R' Y f g h m], assumption+)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> (g, h) \\<in> carrier R \\<times> carrier R\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> deg R S X (fst (g, h))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (g, h)))\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> deg R S X (snd (g, h)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n                      \\<le> deg R S X f\n 4. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> 0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (g, h)))\n 5. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> 0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\n                           Y (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (snd (g, h)))\n 6. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> rel_prime_pols R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)))\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)))\n 7. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n                       (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\n 8. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n     \\<in> carrier R \\<times> carrier R \\<and>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))) \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) \\<and>\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)))\n     \\<le> deg R S X f \\<and>\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc m\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m)) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        m) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        m))\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m\n                      \\<in> carrier R \\<times> carrier R \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (fst (g, h)) \\<and>\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) =\n                      erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                       (snd (g, h)) \\<and>\n                      deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc m))\n                      \\<le> deg R'\n                             (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                             (erH R S X R'\n                               (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                               (pj S (S \\<diamondsuit>\\<^sub>p t))\n                               (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n m))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                               m)) +\n                      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (erH R S X R'\n                         (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                         (pj S (S \\<diamondsuit>\\<^sub>p t))\n                         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                                 m)))\n                      \\<le> deg R S X f \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p\n                        (t^\\<^bsup>S Suc (Suc m)\\<^esup>))\n                       (f \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m) \\<cdot>\\<^sub>r\n                                  snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n   m))", "apply (simp add:cart_prod_split, simp, simp, simp, simp, simp, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*** Hpr sequence of polynomial pair ***)"], ["", "lemma (in PolynRg) P_mod_diffxxx5_2:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                      (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n                (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m) \\<in> carrier R \\<times> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n                      \\<in> carrier R \\<times> carrier R", "apply (case_tac \"m = 0\", simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n                      \\<in> carrier R \\<times> carrier R", "apply (frule P_mod_diffxxx5_1[of t R' Y f g h \n       \"m - Suc 0\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R \\<and>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h)) \\<and>\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h)) \\<and>\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0)))) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0))) \\<and>\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0))) \\<and>\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m - Suc 0))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)))\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n                      \\<in> carrier R \\<times> carrier R", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0))));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f;\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m - Suc 0))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)))\\<rbrakk>\n    \\<Longrightarrow> Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n                      \\<in> carrier R \\<times> carrier R", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*** Cauchy 1***)"], ["", "lemma (in PolynRg) P_mod_diffxxx5_3:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n  maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n  0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus>\n                                -\\<^sub>a (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (m + n)))) \\<and>\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)) ((snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<plusminus>\n                                -\\<^sub>a (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> (m + n))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   n))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   n)))", "apply (cut_tac ring_is_ag,\n       cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     aGroup R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   n))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   n)))", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     aGroup R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   0))) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n   0)))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     aGroup R; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (frule P_mod_diffxxx5_2[of t R' Y f g h m], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     aGroup R; Subring R S; Ring S;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (frule cart_prod_fst[of \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\" \"carrier R\" \"carrier R\"],\n        frule cart_prod_snd[of \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\" \"carrier R\" \"carrier R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     aGroup R; Subring R S; Ring S;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n     snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) \\<and>\n                      P_mod R S X\n                       (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                        -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (simp add:aGroup.ag_r_inv1, simp add:P_mod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n))) \\<and>\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                           n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (frule_tac m = \"m + n\" in P_mod_diffxxx5_1[of t R' Y f g h], \n        assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         (m + n))));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        deg R S X\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))))\n        \\<le> deg R S X f;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m + n))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (frule_tac m = m in P_mod_diffxxx5_2[of t R' Y f g h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         (m + n))));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        deg R S X\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))))\n        \\<le> deg R S X f;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m + n))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (frule_tac m = \"m + n\" in P_mod_diffxxx5_2[of t R' Y f g h], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n        deg R S X g\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        deg R S X h +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n        \\<le> deg R S X f;\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n        0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n             (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n         (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n        aGroup R; Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n        deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n        \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n               (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                 (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                         (m + n))));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        deg R S X\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) +\n        deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n           (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))))\n        \\<le> deg R S X f;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m + n))\\<^esup>))\n         (f \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)) \\<cdot>\\<^sub>r\n                    snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (thin_tac \"deg R S X g\n           \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n       thin_tac \"deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f\",\n       thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n       thin_tac \"0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n       thin_tac \"rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p t) ( f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                            (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h))\",\n       thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                 (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) =\n                  erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n          (snd (g, h))\",\n       thin_tac \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n          \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n                      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))))\",\n      thin_tac \"deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) +\n      deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n           (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))) \\<le> deg R S X f\",\n      thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc (m + n)))\\<^esup>))\n          (f \\<plusminus>  -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)) \\<cdot>\\<^sub>r\n                      snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + Suc n)))", "apply (simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\" in \n          cart_prod_fst[of _ \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\" in \n          cart_prod_fst[of _ \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (m + n))\" in \n          cart_prod_fst[of _ \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\" in \n          cart_prod_snd[of _ \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\" in \n          cart_prod_snd[of _ \"carrier R\" \"carrier R\"],\n       frule_tac x = \"Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc (m + n))\" in \n          cart_prod_snd[of _ \"carrier R\" \"carrier R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (case_tac \"m = 0\", simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>S\\<^esub>)\n         (g \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<^bsub>S\\<^esub>)\n         (h \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        m = 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           1\\<^sub>r\\<^bsub>S\\<^esub>)\n                          (g \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           1\\<^sub>r\\<^bsub>S\\<^esub>)\n                          (h \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (simp only:Ring.Rxa_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (carrier S)\n         (g \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        P_mod R S X (carrier S)\n         (h \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        m = 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (carrier S)\n                          (g \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n)) \\<and>\n                         P_mod R S X (carrier S)\n                          (h \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (carrier S)\n         (g \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        P_mod R S X (carrier S)\n         (h \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        m = 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (carrier S)\n                          (g \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (carrier S)\n         (g \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        P_mod R S X (carrier S)\n         (h \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        m = 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (carrier S)\n                          (h \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n 3. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (rule_tac p = \"g \\<plusminus> -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc n)))\" in\n       P_mod_whole,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (carrier S)\n         (g \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        P_mod R S X (carrier S)\n         (h \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc n\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> n) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n) \\<in> carrier R;\n        m = 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X (carrier S)\n                          (h \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc n))\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (rule_tac p = \"h \\<plusminus> -\\<^sub>a (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (Suc n)))\" in\n       P_mod_whole,\n       rule aGroup.ag_pOp_closed, assumption+,\n       rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule_tac g = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus> \n     -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\" and n = \"m + n\" in \n     P_mod_n_m[of t _ \"m - Suc 0\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                                n)) \\<plusminus>\n                         -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (m + n))\n                         \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> m - Suc 0 \\<le> m + n\n 3. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                                  n)) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n 4. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        m \\<noteq> 0;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed, \n       assumption+,\n       arith,\n       simp del:npow_suc Hpr_Suc, simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule Ring.npClose[of S t m], assumption,\n       frule Ring.principal_ideal[of S \"t^\\<^bsup>S m\\<^esup>\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a fst\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))) \\<and>\n                         P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule_tac p = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n           -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)))\" and \n       q = \"fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n           -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\" in \n       P_mod_add[of \"S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)\"],\n      (rule aGroup.ag_pOp_closed, assumption+,\n             rule aGroup.ag_mOp_closed, assumption+)+,\n      simp del:npow_suc Hpr_Suc add:aGroup.pOp_assoc_cancel)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule_tac g = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus> \n     -\\<^sub>a (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\" and n = \"m + n\" in \n     P_mod_n_m[of t _ \"m - Suc 0\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                                n)) \\<plusminus>\n                         -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n    (m + n))\n                         \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> m - Suc 0 \\<le> m + n\n 3. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p\n                           (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m +\n                                  n)) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\n 4. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (rule aGroup.ag_pOp_closed, assumption+, rule aGroup.ag_mOp_closed, \n       assumption+,\n       arith,\n       simp del:npow_suc Hpr_Suc, simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Idomain S; t \\<in> carrier S;\n        t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n        PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n        f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R; aGroup R;\n        Subring R S; Ring S;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X\n         (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m + n)\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n        \\<in> carrier R \\<times> carrier R;\n        Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)\n        \\<in> carrier R \\<times> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n))\n        \\<in> carrier R;\n        snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n))\n        \\<in> carrier R;\n        0 < m;\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        t^\\<^bsup>S m\\<^esup> \\<in> carrier S;\n        ideal S (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n          -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)));\n        P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n         (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n          -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                           (m + n)))\\<rbrakk>\n       \\<Longrightarrow> P_mod R S X\n                          (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>))\n                          (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n                           -\\<^sub>a snd\n(Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))", "apply (frule_tac p = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m) \\<plusminus>\n           -\\<^sub>a (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)))\" and \n       q = \"snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m + n)) \\<plusminus>\n           -\\<^sub>a (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m + n)))\" in \n       P_mod_add[of \"S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S m\\<^esup>)\"],\n      (rule aGroup.ag_pOp_closed, assumption+,\n             rule aGroup.ag_mOp_closed, assumption+)+,\n      simp del:npow_suc Hpr_Suc add:aGroup.pOp_assoc_cancel)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*** Cauchy, deg bounded ****)"], ["", "lemma (in PolynRg) P_mod_diffxxx5_4:\"\\<lbrakk>Idomain S; t \\<in> carrier S; t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      maximal_ideal S (S \\<diamondsuit>\\<^sub>p t); PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y; f \\<in> carrier R; \n  g \\<in> carrier R; h \\<in> carrier R;\n  deg R S X g \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n   (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);  \n  deg R S X h + deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (erH R S X R' \n                (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f;\n    0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n    0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y \n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n  P_mod R S X (S \\<diamondsuit>\\<^sub>p t) (f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\\<rbrakk> \\<Longrightarrow> \n       deg R S X (fst (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<le> deg R S X g \\<and>\n       deg R S X (snd (Hpr\\<^bsub>R S X t R' Y f g h\\<^esub> m)) \\<le> deg R S X f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h)\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.maximal_ideal_ideal[of S \"S \\<diamondsuit>\\<^sub>p t\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t)\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (case_tac \"m = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m = 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m = 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X h \\<le> deg R S X f\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule aless_imp_le[of \"0\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); m = 0;\n     0 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n    \\<Longrightarrow> deg R S X h \\<le> deg R S X f\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule aadd_le_mono[of \"0\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n       (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" \"deg R S X h\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); m = 0;\n     0 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 + deg R S X h\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g) +\n           deg R S X h\\<rbrakk>\n    \\<Longrightarrow> deg R S X h \\<le> deg R S X f\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (simp add:aadd_0_l, simp add:aadd_commute[of  _ \"deg R S X h\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule P_mod_diffxxx5_1[of t R' Y f g h \"m - Suc 0\"], \n        assumption+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0))));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f;\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m - Suc 0))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)))\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (thin_tac \"deg R S X g\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     deg R S X h +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0))));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f;\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m - Suc 0))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)))\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (thin_tac \"deg R S X h +  deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     P_mod R S X (S \\<diamondsuit>\\<^sub>p t)\n      (f \\<plusminus> -\\<^sub>a g \\<cdot>\\<^sub>r h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0))));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f;\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (m - Suc 0)\\<^esup>))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n       -\\<^sub>a snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)));\n     P_mod R S X\n      (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S Suc (Suc (m - Suc 0))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)) \\<cdot>\\<^sub>r\n                 snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                        (m - Suc 0)))\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (thin_tac \"rel_prime_pols R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h)\",\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p t) ( f \\<plusminus> -\\<^sub>a (g \\<cdot>\\<^sub>r h))\",\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (m - Suc 0))\\<^esup>))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n         -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\",\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (m - Suc 0))\\<^esup>))\n      ( snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> (m - Suc 0)) \\<plusminus>\n          -\\<^sub>a (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\",\n       thin_tac \"P_mod R S X (S \\<diamondsuit>\\<^sub>p (t^\\<^bsup>S (Suc (Suc (m - Suc 0)))\\<^esup>))\n      (f \\<plusminus>\n       -\\<^sub>a (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)) \\<cdot>\\<^sub>r\n           snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t);\n     m \\<noteq> 0;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (fst (g, h));\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) (snd (g, h));\n     deg R S X\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0)))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t))\n              (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc\n                      (m - Suc 0))));\n     deg R S X\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> Suc (m - Suc 0))))\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (simp del:npow_suc Hpr_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) g;\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t))\n      (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) =\n     erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (pj S (S \\<diamondsuit>\\<^sub>p t)) h;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n         (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) =\n         erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g\",\n        thin_tac \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\n        (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) =\n        erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) h\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule_tac p = g in pHom_dec_deg[of R' \"(S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\" Y\n         \"erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t))\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                      \\<in> pHom R S X, R' S /\\<^sub>r\n     (S \\<diamondsuit>\\<^sub>p t) Y\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> g \\<in> carrier R\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X g\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule Ring.qring_ring[of \"S\" \"S \\<diamondsuit>\\<^sub>p t\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     Ring (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\\<rbrakk>\n    \\<Longrightarrow> erH R S X R'\n                       (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                       (pj S (S \\<diamondsuit>\\<^sub>p t))\n                      \\<in> pHom R S X, R' S /\\<^sub>r\n     (S \\<diamondsuit>\\<^sub>p t) Y\n 2. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> g \\<in> carrier R\n 3. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X g\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (rule erH_rHom[of R' \"(S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t))\" Y \"pj S (S \\<diamondsuit>\\<^sub>p t)\"], assumption+,\n       simp add:pj_Hom, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X g\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule ale_trans[of \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\" \n        \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" \"deg R S X g\"], \n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X g;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R S X g\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X g \\<and>\n                      deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X g;\n     deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R S X g\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (thin_tac \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                  \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                    (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\",\n      thin_tac \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n         (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g) \\<le> deg R S X g\",\n      thin_tac \"deg R S X (fst (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) \\<le> deg R S X g\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule aless_imp_le[of \"0\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (frule aadd_le_mono[of \"0\" \"deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\" \n           \"deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; t \\<in> carrier S;\n     t \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     maximal_ideal S (S \\<diamondsuit>\\<^sub>p t);\n     PolynRg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y;\n     f \\<in> carrier R; g \\<in> carrier R; h \\<in> carrier R;\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 < deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n          (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (pj S (S \\<diamondsuit>\\<^sub>p t)) h);\n     Subring R S; Ring S; ideal S (S \\<diamondsuit>\\<^sub>p t); 0 < m;\n     Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m\n     \\<in> carrier R \\<times> carrier R;\n     deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m)) +\n     deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n      (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n        (pj S (S \\<diamondsuit>\\<^sub>p t)) g)\n     \\<le> deg R S X f;\n     0 \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n                (pj S (S \\<diamondsuit>\\<^sub>p t)) g);\n     0 + deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n     \\<le> deg R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n            (erH R S X R' (S /\\<^sub>r (S \\<diamondsuit>\\<^sub>p t)) Y\n              (pj S (S \\<diamondsuit>\\<^sub>p t)) g) +\n           deg R S X\n            (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\\<rbrakk>\n    \\<Longrightarrow> deg R S X\n                       (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\n                      \\<le> deg R S X f", "apply (simp add:aadd_0_l, simp add:aadd_commute[of  _ \n                \"deg R S X (snd (Hpr\\<^bsub> R S X t R' Y f g h\\<^esub> m))\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "declare max.absorb1 [simp del] max.absorb2 [simp del]"], ["", "end"]]}