{"file_name": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module/Algebra5.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module", "problem_names": ["lemma (in Ring) ideal_sumTr1:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> \n          A \\<minusplus> B = \\<Inter> {J. ideal R J \\<and> (A \\<union> B) \\<subseteq> J}\"", "lemma (in Ring) sum_ideals_commute:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>   \n                       A \\<minusplus> B = B \\<minusplus> A\"", "lemma (in Ring) ideal_prod_mono1:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n                A \\<subseteq> B \\<rbrakk> \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C \\<subseteq> B \\<diamondsuit>\\<^sub>r C\"", "lemma (in Ring) ideal_prod_mono2:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n                A \\<subseteq> B \\<rbrakk> \\<Longrightarrow> C \\<diamondsuit>\\<^sub>r A \\<subseteq> C \\<diamondsuit>\\<^sub>r B\"", "lemma (in Ring) cont_ideal_prod:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n        A \\<subseteq> C; B \\<subseteq> C \\<rbrakk> \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> C\"", "lemma (in Ring) ideal_distrib:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n             A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C) =  A \\<diamondsuit>\\<^sub>r B \\<minusplus>  A \\<diamondsuit>\\<^sub>r C\"", "lemma (in Ring) coprimeTr:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n                coprime_ideals R A B = (\\<exists>a \\<in> A. \\<exists>b \\<in> B. a \\<plusminus> b = 1\\<^sub>r)\"", "lemma (in Ring) coprime_int_prod:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n       \\<Longrightarrow>   A \\<inter> B = A \\<diamondsuit>\\<^sub>r B\"", "lemma (in Ring) coprime_elems:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk> \\<Longrightarrow>\n                    \\<exists>a\\<in>A. \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\"", "lemma (in Ring) coprime_elemsTr:\"\\<lbrakk>ideal R A; ideal R B; a\\<in>A; b\\<in>B; a \\<plusminus> b = 1\\<^sub>r\\<rbrakk> \n               \\<Longrightarrow> pj R A b = 1\\<^sub>r\\<^bsub>(qring R A)\\<^esub> \\<and> pj R B a = 1\\<^sub>r\\<^bsub>(qring R B)\\<^esub>\"", "lemma (in Ring) partition_of_unity:\"\\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R; \n       a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R; v \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                                 pj R A (a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u ) = pj R A u\"", "lemma (in Ring) coprimes_commute:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B \\<rbrakk>\n \\<Longrightarrow> coprime_ideals R B A\"", "lemma (in Ring) coprime_surjTr:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B; \n                 X \\<in> carrier (qring R A); Y \\<in> carrier (qring R B) \\<rbrakk> \\<Longrightarrow> \n                         \\<exists>r\\<in>carrier R. pj R A r = X \\<and> pj R B r = Y\"", "lemma (in Ring) coprime_n_idealsTr0:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; \n         coprime_ideals R A C; coprime_ideals R B C \\<rbrakk> \\<Longrightarrow> \n             coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C\"", "lemma (in Ring) coprime_n_idealsTr1:\"ideal R C \\<Longrightarrow>\n    (\\<forall>k \\<le> n. ideal R (J k)) \\<and> (\\<forall>i \\<le> n.  coprime_ideals R (J i) C) \\<longrightarrow> \n    coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\"", "lemma (in Ring) coprime_n_idealsTr2:\"\\<lbrakk>ideal R C; (\\<forall>k \\<le> n. ideal R (J k)); \n       (\\<forall>i \\<le> n. coprime_ideals R (J i) C) \\<rbrakk> \\<Longrightarrow> \n                                     coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\"", "lemma (in Ring) coprime_n_idealsTr3:\"(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n    (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). i \\<noteq> j \\<longrightarrow> \n    coprime_ideals R (J i) (J j)) \\<longrightarrow>  coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))\"", "lemma (in Ring) coprime_n_idealsTr4:\"\\<lbrakk>(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n   (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). i \\<noteq> j \\<longrightarrow> \n    coprime_ideals R (J i) (J j))\\<rbrakk> \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))\"", "lemma carr_prodrg_mem_eq:\"\\<lbrakk>f \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A); g \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n       \\<forall>i\\<in>I. f i = g i \\<rbrakk> \\<Longrightarrow> f = g\"", "lemma prod_tOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow> prod_tOp I A X Y \\<in> carr_prodag I A\"", "lemma prod_tOp_func:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    prod_tOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<rightarrow> carr_prodag I A\"", "lemma prod_one_func:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n                           prod_one I A \\<in> carr_prodag I A\"", "lemma prodrg_carrier:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n                  carrier (prodrg I A) = carrier (prodag I A)\"", "lemma prodrg_ring:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> Ring (prodrg I A)\"", "lemma prodrg_elem_extensional:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); f \\<in> carrier (prodrg I A)\\<rbrakk>\n      \\<Longrightarrow>  f \\<in> extensional I\"", "lemma prodrg_pOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  pop (prodrg I A) = prod_pOp I A\"", "lemma prodrg_mOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  mop (prodrg I A) = prod_mOp I A\"", "lemma prodrg_zero:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  zero (prodrg I A) = prod_zero I A\"", "lemma prodrg_tOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  tp (prodrg I A) = prod_tOp I A\"", "lemma prodrg_one:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  un (prodrg I A) = prod_one I A\"", "lemma prodrg_sameTr5:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_tOp I A = prod_tOp I B\"", "lemma prodrg_sameTr6:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_one I A = prod_one I B\"", "lemma prodrg_same:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prodrg I A = prodrg I B\"", "lemma prodrg_component:\"\\<lbrakk>f \\<in> carrier (prodrg I A); i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                 f i \\<in> carrier (A i)\"", "lemma project_rhom:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         PRoject I A j \\<in> rHom ( prodrg I A) (A j)\"", "lemma augm_funcTr:\"\\<lbrakk>\\<forall>k \\<le>(Suc n). Ring (B k); \n                       f \\<in> carr_prodag {i. i \\<le> (Suc n)} B\\<rbrakk> \\<Longrightarrow> \n f = augm_func n (restrict f {i. i \\<le> n}) (Un_carrier {i. i \\<le> n} B) (Suc 0)  \n     (\\<lambda>x\\<in>{0::nat}. f (x + Suc n)) \n             (Un_carrier {0} (compose {0} B (slide (Suc n))))\"", "lemma A_to_prodag_mem:\"\\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);  \\<forall>k\\<in>I. (S k) \\<in> \n rHom A (B k); x \\<in> carrier A \\<rbrakk> \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B\"", "lemma A_to_prodag_rHom:\"\\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. (S k) \\<in> \n      rHom A (B k) \\<rbrakk>  \\<Longrightarrow> A_to_prodag A I S B \\<in> rHom A (r\\<Pi>\\<^bsub>I\\<^esub> B)\"", "lemma ac_fProd_ProdTr1:\"\\<forall>k \\<le> (Suc n). Ring (B k) \\<Longrightarrow> \n ag_setfunc n B (Suc 0) (compose {0::nat} B (slide (Suc n))) \n   (carr_prodag {i. i \\<le> n} B) (carr_prodag {0} \n     (compose {0} B (slide (Suc n)))) \\<subseteq>  carr_prodag {i. i \\<le> (Suc n)} B\"", "lemma ac_fProd_Prod:\"\\<forall>k \\<le> n. Ring (B k) \\<Longrightarrow> \n                      ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\"", "lemma fprodrg_ring:\"\\<forall>k \\<le> n. Ring (B k) \\<Longrightarrow> Ring (fprodrg n B)\"", "lemma Chinese_remTr1:\"\\<lbrakk>Ring A; \\<forall>k \\<le> (n::nat). ideal A (J k); \n \\<forall>k \\<le> n. B k = qring A (J k); \\<forall>k \\<le> n. S k = pj A (J k) \\<rbrakk> \\<Longrightarrow>\n   ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B)\\<^esub> (A_to_prodag A {j. j \\<le> n} S B) = \n                                        \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = (J k)}\"", "lemma (in Ring) coprime_prod_int2Tr:\n\"((\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))))\n  \\<longrightarrow> (\\<Inter> {I. \\<exists>k \\<le> (Suc n). I = (J k)} = ideal_n_prod R (Suc n) J)\"", "lemma (in Ring) coprime_prod_int2:\"\\<lbrakk> \\<forall>k \\<le> (Suc n). ideal R (J k); \n \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk>\n \\<Longrightarrow> (\\<Inter> {I. \\<exists>k \\<le> (Suc n). I = (J k)} = ideal_n_prod R (Suc n) J)\"", "lemma (in Ring) coprime_2_n:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n (qring R A) \\<Oplus>\\<^sub>r (qring R B) = r\\<Pi>\\<^bsub>{j. j \\<le> (Suc 0)}\\<^esub> (prodB1 (qring R A) (qring R B))\"", "lemma (in Ring) A_to_prodag2_hom:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B\\<rbrakk>  \\<Longrightarrow> \n      A_to_prodag R {j. j \\<le> (Suc 0)} S (prodB1 (qring R A) (qring R B)) \\<in> \n      rHom R (qring R A \\<Oplus>\\<^sub>r qring R B)\"", "lemma (in Ring) A2coprime_rsurjecTr:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B\\<rbrakk> \\<Longrightarrow> \n      (carrier (qring R A \\<Oplus>\\<^sub>r qring R B)) = \n        carr_prodag {j. j \\<le> (Suc 0)} (prodB1 (qring R A) (qring R B))\"", "lemma (in Ring) A2coprime_rsurjec:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B; coprime_ideals R A B\\<rbrakk> \\<Longrightarrow> \n      surjec\\<^bsub>R,((qring R A) \\<Oplus>\\<^sub>r (qring R B))\\<^esub> \n           (A_to_prodag R {j. j\\<le>(Suc 0)} S (prodB1 (qring R A) (qring R B)))\"", "lemma (in Ring) prod2_n_Tr1:\"\\<lbrakk>\\<forall>k \\<le> (Suc 0). ideal R (J k); \n      \\<forall>k \\<le> (Suc 0). B k = qring R (J k); \n      \\<forall>k \\<le> (Suc 0). S k = pj R (J k) \\<rbrakk>  \\<Longrightarrow> \n    A_to_prodag R {j. j \\<le> (Suc 0)} S \n            (prodB1 (qring R (J 0)) (qring R (J (Suc 0)))) = \n                               A_to_prodag R {j. j \\<le> (Suc 0)} S B\"", "lemma (in aGroup) restrict_prod_Suc:\"\\<lbrakk>\\<forall>k \\<le> (Suc (Suc n)). ideal R (J k);\n        \\<forall>k \\<le> (Suc (Suc n)). B k = R /\\<^sub>r J k;\n        \\<forall>k \\<le> (Suc (Suc n)). S k = pj R (J k);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc (Suc n))}\\<^esub> B)\\<rbrakk> \\<Longrightarrow> \n        restrict f {j. j \\<le> (Suc n)} \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\"", "lemma (in Ring) Chinese_remTr2:\"(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n     (\\<forall>k\\<le>(Suc n). B k = qring R (J k)) \\<and> \n     (\\<forall>k\\<le>(Suc n). S k = pj R (J k)) \\<and> \n     (\\<forall>i\\<le>(Suc n). \\<forall>j\\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> \n     coprime_ideals R (J i) (J j))) \\<longrightarrow> \n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j\\<le> (Suc n)}\\<^esub> B)\\<^esub> \n                   (A_to_prodag R {j. j\\<le>(Suc n)} S B)\"", "lemma (in Ring) Chinese_remTr3:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). ideal R (J k); \n      \\<forall>k \\<le> (Suc n). B k = qring R (J k); \\<forall>k\\<le> (Suc n). S k = pj R (J k); \n  \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk> \\<Longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\\<^esub> \n                   (A_to_prodag R {j. j \\<le> (Suc n)} S B)\"", "lemma (in Ring) imset:\"\\<lbrakk>\\<forall>k\\<le> (Suc n). ideal R (J k)\\<rbrakk>\n\\<Longrightarrow> {I. \\<exists>k\\<le> (Suc n). I = J k} = {J k| k. k \\<in> {j. j \\<le> (Suc n)}}\"", "theorem (in Ring) Chinese_remThm:\"\\<lbrakk>(\\<forall>k \\<le> (Suc n). ideal R (J k)); \n \\<forall>k\\<le>(Suc n). B k = qring R (J k); \\<forall>k \\<le> (Suc n). S k = pj R (J k); \n \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk> \n\\<Longrightarrow> bijec\\<^bsub>(qring R (\\<Inter> {J k | k. k\\<in>{j. j \\<le> (Suc n)}})),(r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\\<^esub> \n     ((A_to_prodag R {j. j \\<le> (Suc n)} S B)\\<degree>\\<^bsub>R,(prodrg {j. j \\<le> (Suc n)} B)\\<^esub>)\"", "lemma (in Ring) prod_prime:\"\\<lbrakk>ideal R A; \\<forall>k\\<le>(Suc n). prime_ideal R (P k);\n      \\<forall>l\\<le>(Suc n). \\<not> (A \\<subseteq> P l); \n      \\<forall>k\\<le> (Suc n). \\<forall>l\\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l)\\<rbrakk> \\<Longrightarrow> \n     \\<forall>i \\<le> (Suc n). (nprod R (ppa R P A i) n \\<in> A \\<and> \n        (\\<forall>l \\<in> {j. j\\<le>(Suc n)} - {i}. nprod R (ppa R P A i) n \\<in> P l) \\<and> \n        (nprod R (ppa R P A i) n \\<notin> P i))\"", "lemma skip_im1:\"\\<lbrakk>i \\<le> (Suc n); P \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> Collect (prime_ideal R)\\<rbrakk>\n    \\<Longrightarrow>\n   compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n} = P ` ({j. j \\<le> (Suc n)} - {i})\"", "lemma (in Ring) mutch_aux1:\"\\<lbrakk>ideal R A; i \\<le> (Suc n);\n        P \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> Collect (prime_ideal R)\\<rbrakk> \\<Longrightarrow> \n        compose {j. j \\<le> n} P (skip i) \\<in> {j. j \\<le> n} \\<rightarrow> Collect (prime_ideal R)\"", "lemma (in Ring) prime_ideal_cont1Tr:\"ideal R A  \\<Longrightarrow> \n      \\<forall>P. ((P \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {X. prime_ideal R X}) \\<and> \n                   (A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}))) \\<longrightarrow> (\\<exists>i\\<le> n. A \\<subseteq> (P i))\"", "lemma (in Ring) prime_ideal_cont1:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> (n::nat). \n     prime_ideal R (P i); A \\<subseteq> \\<Union> {X. (\\<exists>i \\<le> n. X = (P i))} \\<rbrakk> \\<Longrightarrow> \n     \\<exists>i\\<le> n. A\\<subseteq>(P i)\"", "lemma (in Ring) prod_n_ideal_contTr0:\"(\\<forall>l\\<le> n. ideal R (J l)) \\<longrightarrow>\n                               i\\<Pi>\\<^bsub>R,n\\<^esub> J  \\<subseteq>  \\<Inter>{X. (\\<exists>k\\<le>n. X = (J k))}\"", "lemma (in Ring) prod_n_ideal_contTr:\"\\<lbrakk>\\<forall>l\\<le> n. ideal R (J l)\\<rbrakk> \\<Longrightarrow>\n             i\\<Pi>\\<^bsub>R,n\\<^esub> J  \\<subseteq>  \\<Inter>{X. (\\<exists>k \\<le> n. X = (J k))}\"", "lemma (in Ring) prod_n_ideal_cont2:\"\\<lbrakk>\\<forall>l\\<le> (n::nat). ideal R (J l); \n     prime_ideal R P; \\<Inter>{X. (\\<exists>k\\<le> n. X = (J k))} \\<subseteq> P\\<rbrakk> \\<Longrightarrow> \n     \\<exists>l\\<le> n. (J l) \\<subseteq> P\"", "lemma (in Ring) prod_n_ideal_cont3:\"\\<lbrakk>\\<forall>l\\<le> (n::nat). ideal R (J l); \n      prime_ideal R P; \\<Inter>{X. (\\<exists>k\\<le> n. X = (J k))} = P\\<rbrakk> \\<Longrightarrow> \n      \\<exists>l\\<le> n. (J l) = P\"", "lemma (in Ring) ideal_quotient_is_ideal:\n  \"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> ideal R (ideal_quotient R A B)\"", "lemma (in aGroup) nsum_mem1Tr:\" A +> J  \\<Longrightarrow>  \n                     (\\<forall>j \\<le> n. f j \\<in> J)  \\<longrightarrow> nsum A f n \\<in> J\"", "lemma (in aGroup) fSum_mem:\"\\<lbrakk>\\<forall>j \\<in> nset (Suc n) m. f j \\<in> carrier A; n < m\\<rbrakk> \\<Longrightarrow>\n                   fSum A f (Suc n) m \\<in> carrier A\"", "lemma (in aGroup) nsum_mem1:\"\\<lbrakk>A +> J; \\<forall>j \\<le> n. f j \\<in> J\\<rbrakk> \\<Longrightarrow> nsum A f n \\<in> J\"", "lemma (in aGroup) nsum_eq_i:\"\\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; \\<forall>j\\<le>n. g j \\<in> carrier A;\n i \\<le> n; \\<forall>l \\<le> i. f l = g l\\<rbrakk> \\<Longrightarrow> nsum A f i = nsum A g i\"", "lemma (in aGroup) nsum_cmp_eq:\"\\<lbrakk>f \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> carrier A; \n h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};  h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; i \\<le> n\\<rbrakk> \\<Longrightarrow>\n nsum A (cmp f (cmp h2 h1)) i = nsum A (cmp (cmp f h2) h1) i\"", "lemma (in aGroup) nsum_cmp_eq_transpos:\"\\<lbrakk> \\<forall>j\\<le>(Suc n). f j \\<in> carrier A; \n       i \\<le> n;i \\<noteq> n \\<rbrakk> \\<Longrightarrow>\n nsum A (cmp f (cmp (transpos i n) (cmp (transpos n (Suc n)) (transpos i n))))\n (Suc n) = nsum A (cmp f (transpos i (Suc n))) (Suc n)\"", "lemma transpos_Tr_n1:\"Suc (Suc 0) \\<le> n \\<Longrightarrow> \n                           transpos (n - Suc 0) n n = n - Suc 0\"", "lemma transpos_Tr_n2:\"Suc (Suc 0) \\<le> n \\<Longrightarrow> \n               transpos (n - (Suc 0)) n (n - (Suc 0)) = n\"", "lemma (in aGroup) additionTr0:\"\\<lbrakk>0 < n; \\<forall>j \\<le> n. f j \\<in> carrier A\\<rbrakk>\n \\<Longrightarrow> nsum A (cmp f (transpos (n - 1) n)) n = nsum A f n\"", "lemma (in aGroup) additionTr1:\"\\<lbrakk> \\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> {j. j\\<le>(Suc n)} \\<and> inj_on h {j. j\\<le>(Suc n)} \\<longrightarrow>\n       nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n       f \\<in> {j. j\\<le>(Suc (Suc n))} \\<rightarrow> carrier A; \n       h \\<in> {j. j\\<le>(Suc (Suc n))} \\<rightarrow> {j. j\\<le>(Suc (Suc n))}; \n       inj_on h {j. j\\<le>(Suc (Suc n))}; h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n        \\<Longrightarrow> nsum A (cmp f h) (Suc (Suc n)) = nsum A f (Suc (Suc n))\"", "lemma (in aGroup) additionTr1_1:\"\\<lbrakk>\\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>Suc n} \\<rightarrow> carrier A \\<and>\n      h \\<in> {j. j\\<le>Suc n} \\<rightarrow> {j. j\\<le>Suc n} \\<and> inj_on h {j. j\\<le>Suc n} \\<longrightarrow>\n      nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n      f \\<in> {j. j\\<le>Suc (Suc n)} \\<rightarrow> carrier A; i \\<le> n\\<rbrakk> \\<Longrightarrow> \n    nsum A (cmp f (transpos i (Suc n))) (Suc (Suc n)) = nsum A f (Suc (Suc n))\"", "lemma (in aGroup) additionTr1_2:\"\\<lbrakk>\\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j\\<le>Suc n} \\<rightarrow> {j. j\\<le>Suc n} \\<and> \n          inj_on h {j. j\\<le>Suc n} \\<longrightarrow>\n          nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n         f \\<in> {j. j\\<le> Suc (Suc n)} \\<rightarrow> carrier A; i \\<le> (Suc n)\\<rbrakk> \\<Longrightarrow> \n       nsum A (cmp f (transpos i (Suc (Suc n)))) (Suc (Suc n)) = \n                                             nsum A f (Suc (Suc n))\"", "lemma (in aGroup) additionTr2:\" \\<forall>f. \\<forall>h. f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier A \\<and> \n        h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. j \\<le> (Suc n)} \\<and> \n        inj_on h {j. j \\<le> (Suc n)} \\<longrightarrow> \n          nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\"", "lemma (in aGroup) addition2:\"\\<lbrakk>f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier A; \n  h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. j \\<le> (Suc n)}; inj_on h {j. j \\<le> (Suc n)}\\<rbrakk> \\<Longrightarrow>\n  nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\"", "lemma (in aGroup) addition21:\"\\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A; \n       h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; inj_on h {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow>\n       nsum A (cmp f h) n = nsum A f n\"", "lemma (in aGroup) addition3:\"\\<lbrakk>\\<forall>j \\<le> (Suc n). f j \\<in> carrier A; j \\<le> (Suc n);\nj \\<noteq> Suc n\\<rbrakk> \\<Longrightarrow> nsum A f (Suc n) = nsum A (cmp f (transpos j (Suc n))) (Suc n)\"", "lemma (in aGroup) nsum_splitTr:\"(\\<forall>j \\<le> (Suc (n + m)). f j \\<in> carrier A) \\<longrightarrow>\n   nsum A f (Suc (n + m)) = nsum A f n \\<plusminus> (nsum A (cmp f (slide (Suc n))) m)\"", "lemma (in aGroup) nsum_split:\"\\<forall>j \\<le> (Suc (n + m)). f j \\<in> carrier A \\<Longrightarrow>\n   nsum A f (Suc (n + m)) = nsum A f n \\<plusminus> (nsum A (cmp f (slide (Suc n))) m)\"", "lemma (in aGroup) nsum_split1:\"\\<lbrakk>\\<forall>j \\<le> m. f j \\<in> carrier A; n < m\\<rbrakk> \\<Longrightarrow>\n                   nsum A f m = nsum A f n \\<plusminus> (fSum A f (Suc n) m)\"", "lemma (in aGroup) nsum_minusTr:\" (\\<forall>j \\<le> n. f j \\<in> carrier A) \\<longrightarrow>\n                    -\\<^sub>a (nsum A f n) = nsum A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a (f x)) n\"", "lemma (in aGroup) nsum_minus:\"\\<forall>j \\<le> n. f j \\<in> carrier A \\<Longrightarrow> \n                    -\\<^sub>a (nsum A f n) = nsum A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a (f x)) n\"", "lemma (in aGroup) ring_nsum_zeroTr:\"(\\<forall>j \\<le> (n::nat). f j \\<in> carrier A) \\<and> \n                    (\\<forall>j \\<le> n. f j = \\<zero>) \\<longrightarrow> nsum A f n = \\<zero>\"", "lemma (in aGroup) ring_nsum_zero:\"\\<forall>j \\<le> (n::nat). f j = \\<zero>  \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n = \\<zero>\"", "lemma (in aGroup) ag_nsum_1_nonzeroTr:\n\"\\<forall>f. (\\<forall>j \\<le> n. f j \\<in> carrier A) \\<and> \n       (l \\<le> n \\<and> (\\<forall>j \\<in> {j. j \\<le> n} - {l}. f j = \\<zero>))\n      \\<longrightarrow> nsum A f n = f l\"", "lemma (in aGroup) ag_nsum_1_nonzero:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; l \\<le> n; \n       \\<forall>j\\<in>({j. j \\<le> n} - {l}). f j = \\<zero> \\<rbrakk> \\<Longrightarrow> nsum A f n = f l\"", "lemma (in Ring) set_mult_sub:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n                                    set_mult R A B \\<subseteq> carrier R\"", "lemma (in Ring) set_mult_mono:\"\\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R; A1 \\<subseteq> A2; \n       B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow> set_mult R A1 B \\<subseteq> set_mult R A2 B\"", "lemma (in Ring) sum_mult_Tr1:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n               (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> nsum R f n \\<in> carrier R\"", "lemma (in Ring) sum_mult_mem:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n   \\<forall>j \\<le> n. f j \\<in> set_mult R A B\\<rbrakk>  \\<Longrightarrow> nsum R f n \\<in> carrier R\"", "lemma (in Ring) sum_mult_mem1:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n        x \\<in> sum_mult R A B\\<rbrakk>  \\<Longrightarrow>\n        \\<exists>n. \\<exists>f\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> set_mult R A B. nsum R f n = x\"", "lemma (in Ring) sum_mult_subR:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n                         sum_mult R A B \\<subseteq> carrier R\"", "lemma (in Ring) times_mem_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n       a \\<in> A; b \\<in> B \\<rbrakk>  \\<Longrightarrow>  a \\<cdot>\\<^sub>r b \\<in> sum_mult R A B\"", "lemma (in Ring) mem_minus_sum_multTr2:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n       \\<forall>j \\<le> n. f j \\<in> set_mult R A B; i \\<le> n\\<rbrakk> \\<Longrightarrow> f i \\<in> carrier R\"", "lemma (in aGroup) nsum_jointfun:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \n      \\<forall>j \\<le> m. g j \\<in> carrier A\\<rbrakk>  \\<Longrightarrow> \n      \\<Sigma>\\<^sub>e A (jointfun n f m g) (Suc (n + m)) =  \\<Sigma>\\<^sub>e A f n \\<plusminus> (\\<Sigma>\\<^sub>e A g m)\"", "lemma (in Ring) sum_mult_pOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n       a \\<in> sum_mult R A B;  b \\<in> sum_mult R A B \\<rbrakk> \\<Longrightarrow> a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> sum_mult R A B\"", "lemma (in Ring) set_mult_mOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n       x \\<in> set_mult R A B\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> set_mult R A B\"", "lemma (in Ring) set_mult_ring_times_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n       x \\<in> set_mult R A B; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow> r \\<cdot>\\<^sub>r  x \\<in> set_mult R A B\"", "lemma (in Ring) set_mult_sub_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk> \\<Longrightarrow>\n                   set_mult R A B \\<subseteq> sum_mult R A B\"", "lemma (in Ring) sum_mult_pOp_closedn:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>  \\<Longrightarrow> \n               (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\"", "lemma (in Ring) mem_minus_sum_multTr4:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk> \\<Longrightarrow>\n        (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> -\\<^sub>a (nsum R f n) \\<in> sum_mult R A B\"", "lemma (in Ring) sum_mult_iOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; \n       x \\<in> sum_mult R A B \\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> sum_mult R A B\"", "lemma (in Ring) sum_mult_ring_multiplicationTr:\n      \"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n       (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> r \\<cdot>\\<^sub>r (nsum R f n) \\<in> sum_mult R A B\"", "lemma (in Ring) sum_mult_ring_multiplication:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; \n r \\<in> carrier R; a \\<in> sum_mult R A B\\<rbrakk>  \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> sum_mult R A B\"", "lemma (in Ring) ideal_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B\\<rbrakk> \\<Longrightarrow>\n                ideal R (sum_mult R A B)\"", "lemma (in Ring) ideal_inc_set_multTr:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C; \n       set_mult R A B \\<subseteq> C \\<rbrakk> \\<Longrightarrow>\n         \\<forall>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R A B. \\<Sigma>\\<^sub>e R f n \\<in> C\"", "lemma (in Ring) ideal_inc_set_mult:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C; \n                           set_mult R A B \\<subseteq> C \\<rbrakk> \\<Longrightarrow> sum_mult R A B \\<subseteq> C\"", "lemma (in Ring) AB_inc_sum_mult:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> \n                                     sum_mult R A B \\<subseteq> A \\<inter> B\"", "lemma (in Ring) sum_mult_is_ideal_prod:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n                                  sum_mult R A B =  A \\<diamondsuit>\\<^sub>r B\"", "lemma (in Ring) ideal_prod_assocTr0:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; \n                 z \\<in> set_mult R A B\\<rbrakk> \\<Longrightarrow> z \\<cdot>\\<^sub>r y \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\"", "lemma (in Ring) ideal_prod_assocTr1:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C\\<rbrakk>\n \\<Longrightarrow> \\<forall>f \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> set_mult R A B. (\\<Sigma>\\<^sub>e R f n) \\<cdot>\\<^sub>r y \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\"", "lemma (in Ring) ideal_quotient_idealTr:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; \n       x \\<in> carrier R;\\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> ideal_quotient R A B\\<rbrakk> \\<Longrightarrow> \n       f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R B C \\<longrightarrow>  x \\<cdot>\\<^sub>r (nsum R f n) \\<in> A\"", "lemma (in Ring) ideal_quotient_ideal:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow> \n                         A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C = A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\"", "lemma (in Ring) ideal_prod_assocTr:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n  \\<forall>f. (f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R (A \\<diamondsuit>\\<^sub>r B) C \\<longrightarrow> \n                                          (\\<Sigma>\\<^sub>e R f n) \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C))\"", "lemma (in Ring) ideal_prod_assoc:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n            (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C = A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\"", "lemma (in Ring) prod_principal_idealTr0:\"  \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n         z \\<in> set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk> \\<Longrightarrow>  z \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\"", "lemma (in Ring) prod_principal_idealTr1:\"  \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      \\<forall>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b). \n                                         \\<Sigma>\\<^sub>e R f n \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\"", "lemma (in Ring) prod_principal_ideal:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                     (Rxa R a) \\<diamondsuit>\\<^sub>r (Rxa R b) = Rxa R (a \\<cdot>\\<^sub>r b)\"", "lemma (in Ring) principal_ideal_n_pow1:\"a \\<in> carrier R \\<Longrightarrow>  \n                                  (Rxa R a)\\<^bsup>\\<diamondsuit>R n\\<^esup>  = Rxa R (a^\\<^bsup>R n \\<^esup>)\"", "lemma (in Ring) principal_ideal_n_pow:\"\\<lbrakk>a \\<in> carrier R; I = Rxa R a\\<rbrakk> \\<Longrightarrow>  \n                                  I \\<^bsup>\\<diamondsuit>R n\\<^esup>  = Rxa R (a^\\<^bsup>R n\\<^esup>)\"", "lemma (in Ring) nprod_eqTr:\" f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and> (\\<forall>j \\<le> n. f j = g j) \\<longrightarrow>\n       nprod R f n = nprod R g n\"", "lemma (in Ring) nprod_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier R; \\<forall>j \\<le> n. g j \\<in> carrier R;\n(\\<forall>j \\<le> (n::nat). f j = g j)\\<rbrakk> \\<Longrightarrow> nprod R f n = nprod R g n\"", "lemma (in Ring) mprodR_Suc:\"\\<lbrakk>e \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. (0::nat) \\<le> j};\n                 f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow> \n       mprod_expR R e f (Suc n) = \n            (mprod_expR R e f n) \\<cdot>\\<^sub>r ((f (Suc n))^\\<^bsup>R (e (Suc n))\\<^esup>)\"", "lemma (in Ring) mprod_expR_memTr:\"e \\<in> {j. j \\<le> n} \\<rightarrow> {j. (0::nat) \\<le> j} \\<and> \n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R  \\<longrightarrow>  mprod_expR R e f n \\<in> carrier R\"", "lemma (in Ring) mprod_expR_mem:\"\\<lbrakk> e \\<in> {j. j \\<le> n} \\<rightarrow> {j. (0::nat) \\<le> j};\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>   \\<Longrightarrow>  mprod_expR R e f n \\<in> carrier R\"", "lemma (in Ring) prod_n_principal_idealTr:\"e \\<in> {j. j\\<le>n} \\<rightarrow> {j. (0::nat)\\<le>j} \\<and> \nf \\<in> {j. j\\<le>n} \\<rightarrow> carrier R \\<and> (\\<forall>k \\<le> n. J k = (Rxa R (f k))\\<^bsup>\\<diamondsuit>R (e k)\\<^esup>) \\<longrightarrow>\n                 ideal_n_prod R n J = Rxa R (mprod_expR R e f n)\"", "lemma (in Ring) prod_n_principal_ideal:\"\\<lbrakk>e \\<in> {j. j\\<le>n} \\<rightarrow> {j. (0::nat)\\<le>j};  \nf \\<in> {j. j\\<le>n} \\<rightarrow> carrier R; \\<forall>k\\<le> n. J k = (Rxa R (f k))\\<^bsup>\\<diamondsuit>R (e k)\\<^esup>\\<rbrakk> \\<Longrightarrow>\n                 ideal_n_prod R n J = Rxa R (mprod_expR R e f n)\"", "lemma (in Idomain) a_notin_n_pow1:\"\\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n\\<rbrakk>\n  \\<Longrightarrow>  a \\<notin> (Rxa R a) \\<^bsup>\\<diamondsuit>R  (Suc n)\\<^esup>\"", "lemma (in Idomain) a_notin_n_pow2:\"\\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; \n 0 < n\\<rbrakk> \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<notin> (Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>\"", "lemma (in Idomain) n_pow_not_prime:\"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;  0 < n\\<rbrakk>\n            \\<Longrightarrow>   \\<not> prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>)\"", "lemma (in Idomain) principal_pow_prime_condTr:\n  \"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>)\\<rbrakk> \\<Longrightarrow> n = 0\"", "lemma (in Idomain) principal_pow_prime_cond:\n  \"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;  prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk> \\<Longrightarrow> n = Suc 0\"", "lemma (in TwoRings) i_contract_sub:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                       (i_contract f R R' J) \\<subseteq> carrier R\"", "lemma (in TwoRings) i_contract_ideal:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                                          ideal R (i_contract f R R' J)\"", "lemma (in TwoRings) i_contract_mono:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n J1 \\<subseteq> J2 \\<rbrakk> \\<Longrightarrow> i_contract f R R' J1 \\<subseteq> i_contract f R R' J2\"", "lemma (in TwoRings) i_contract_prime:\"\\<lbrakk>f \\<in> rHom R R'; prime_ideal R' P\\<rbrakk> \\<Longrightarrow> \n                            prime_ideal R (i_contract f R R' P)\"", "lemma (in TwoRings) i_extension_ideal:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I \\<rbrakk> \\<Longrightarrow>\n                            ideal R' (i_extension f R R' I)\"", "lemma (in TwoRings) i_extension_mono:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n I1 \\<subseteq> I2 \\<rbrakk> \\<Longrightarrow> (i_extension f R R' I1) \\<subseteq> (i_extension f R R' I2)\"", "lemma (in TwoRings) e_c_inc_self:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I\\<rbrakk> \\<Longrightarrow>\n              I \\<subseteq> i_contract f R R' (i_extension f R R' I)\"", "lemma (in TwoRings) c_e_incd_self:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                          i_extension f R R' (i_contract f R R' J) \\<subseteq> J\"", "lemma (in TwoRings) c_e_c_eq_c:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n  i_contract f R R' (i_extension f R R' (i_contract f R R' J)) \n                                          = i_contract f R R' J\"", "lemma (in TwoRings) e_c_e_eq_e:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I \\<rbrakk> \\<Longrightarrow>\n  i_extension f R R' (i_contract f R R' (i_extension f R R' I)) \n                                          = i_extension f R R' I\"", "lemma (in Ring) csrp_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) csrp_same:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I = a \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) csrp_mem1:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I x \\<in> x\"", "lemma (in Ring) csrp_fn_mem:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                              (csrp_fn R I x) \\<in> carrier R\"", "lemma (in Ring) csrp_eq_coset:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                           (csrp_fn R I x) \\<uplus>\\<^bsub>R\\<^esub> I = x\"", "lemma (in Ring) csrp_nz_nz:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I);\n        x \\<noteq> \\<zero>\\<^bsub>(R /\\<^sub>r I)\\<^esub>\\<rbrakk> \\<Longrightarrow> (csrp_fn R I x) \\<noteq> \\<zero>\"", "lemma (in Ring) csrp_diff_in_vpr:\"\\<lbrakk>ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n              x \\<plusminus> (-\\<^sub>a (csrp_fn R I (pj R I x))) \\<in> I\"", "lemma (in Ring) csrp_pj:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                 (pj R I) (csrp_fn R I x) = x\"", "lemma Subring_subset:\"Subring R S \\<Longrightarrow> carrier S \\<subseteq> carrier R\"", "lemma (in Ring) subring_Ring:\"Subring R S \\<Longrightarrow> Ring S\"", "lemma (in Ring) mem_subring_mem_ring:\"\\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n                      x \\<in> carrier R\"", "lemma (in Ring) Subring_pOp_ring_pOp:\"\\<lbrakk>Subring R S; a \\<in> carrier S;\n b \\<in> carrier S \\<rbrakk> \\<Longrightarrow> a \\<plusminus>\\<^bsub>S\\<^esub> b = a \\<plusminus> b\"", "lemma (in Ring) Subring_tOp_ring_tOp:\"\\<lbrakk>Subring R S; a \\<in> carrier S;\n              b \\<in> carrier S \\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b = a \\<cdot>\\<^sub>r b\"", "lemma (in Ring) Subring_one_ring_one:\"Subring R S \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r\"", "lemma (in Ring) Subring_zero_ring_zero:\"Subring R S \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> = \\<zero>\"", "lemma (in Ring) Subring_minus_ring_minus:\"\\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk>\n      \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x\"", "lemma (in PolynRg) Subring_pow_ring_pow:\"x \\<in> carrier S \\<Longrightarrow>\n                   x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>\"", "lemma (in PolynRg) is_Ring: \"Ring R\"", "lemma (in PolynRg) polyn_ring_nonzero:\"1\\<^sub>r \\<noteq> \\<zero>\"", "lemma (in PolynRg) polyn_ring_S_nonzero:\"1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) polyn_ring_X_nonzero:\"X \\<noteq> \\<zero>\"", "lemma (in PolynRg) pol_coeff_split:\"pol_coeff S f = pol_coeff S (fst f, snd f)\"", "lemma (in PolynRg) pol_coeff_cartesian:\"pol_coeff S c \\<Longrightarrow>\n                   (fst c, snd c) = c\"", "lemma (in PolynRg) split_pol_coeff:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n                                               pol_coeff S (k, snd c)\"", "lemma (in PolynRg) pol_coeff_pre:\"pol_coeff S ((Suc n), f) \\<Longrightarrow> \n                   pol_coeff S (n, f)\"", "lemma (in PolynRg) pol_coeff_le:\"\\<lbrakk>pol_coeff S c; n \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n                               pol_coeff S (n, (snd c))\"", "lemma (in PolynRg) pol_coeff_mem:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n                                                   ((snd c) j) \\<in> carrier S\"", "lemma (in PolynRg) pol_coeff_mem_R:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c)\\<rbrakk>\n                  \\<Longrightarrow>  ((snd c) j) \\<in> carrier R\"", "lemma (in PolynRg) Slide_pol_coeff:\"\\<lbrakk>pol_coeff S c; n < (fst c)\\<rbrakk> \\<Longrightarrow>\n        pol_coeff S (((fst c) - Suc n), (\\<lambda>x. (snd c) (Suc (n + x))))\"", "lemma (in PolynRg) monomial_mem:\"pol_coeff S c \\<Longrightarrow> \n                        \\<forall>j \\<le> (fst c). (snd c) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> \\<in> carrier R\"", "lemma (in PolynRg) polyn_mem:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n                                        polyn_expr R X k c \\<in> carrier R\"", "lemma (in PolynRg) polyn_exprs_eq:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n         k \\<le> (min (fst c) (fst d)); \\<forall>j \\<le> k. (snd c) j = (snd d) j\\<rbrakk> \\<Longrightarrow> \n                     polyn_expr R X k c = polyn_expr R X k d\"", "lemma (in PolynRg) polyn_expr_restrict:\"pol_coeff S (Suc n, f) \\<Longrightarrow>\n              polyn_expr R X n (Suc n, f) = polyn_expr R X n (n, f)\"", "lemma (in PolynRg) polyn_expr_short:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n         polyn_expr R X k c = polyn_expr R X k (k, snd c)\"", "lemma (in PolynRg) polyn_expr0:\"pol_coeff S c \\<Longrightarrow> \n                                   polyn_expr R X 0 c = (snd c) 0\"", "lemma (in PolynRg) polyn_expr_split:\"\n          polyn_expr R X k f = polyn_expr R X k (fst f, snd f)\"", "lemma (in PolynRg) polyn_Suc:\"Suc n \\<le> (fst c) \\<Longrightarrow> \n       polyn_expr R X (Suc n) ((Suc n), (snd c)) = \n               polyn_expr R X n c \\<plusminus> ((snd c) (Suc n)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc n)\\<^esup>)\"", "lemma (in PolynRg) polyn_Suc_split:\"pol_coeff S (Suc n, f) \\<Longrightarrow> \n       polyn_expr R X (Suc n) ((Suc n), f) = \n          polyn_expr R X n (n, f) \\<plusminus> (f (Suc n)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc n)\\<^esup>)\"", "lemma (in PolynRg) polyn_n_m:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X m (m, (snd c)) = polyn_expr R X n (n, (snd c)) \\<plusminus>  \n                        (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\"", "lemma (in PolynRg) polyn_n_m1:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X m c = polyn_expr R X n c \\<plusminus>  \n                        (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\"", "lemma (in PolynRg) polyn_n_m_mem:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n            (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m) \\<in> carrier R\"", "lemma (in PolynRg) polyn_n_ms_eq:\"\\<lbrakk>pol_coeff S c; pol_coeff S d;\n        m \\<le> min (fst c) (fst d); n < m; \n       \\<forall>j\\<in>nset (Suc n) m. (snd c) j = (snd d) j\\<rbrakk> \\<Longrightarrow> \n            (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m) =\n                    (fSum R (\\<lambda>j. ((snd d) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\"", "lemma (in PolynRg) polyn_addTr:\n \"(pol_coeff S (n, f)) \\<and> (pol_coeff S (n, g)) \\<longrightarrow>\n    (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =\n                 nsum R (\\<lambda>j. ((f j) \\<plusminus>\\<^bsub>S\\<^esub> (g j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) n\"", "lemma (in PolynRg) polyn_add_n:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk> \\<Longrightarrow> \n      (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =  \n           nsum R (\\<lambda>j. ((f j) \\<plusminus>\\<^bsub>S\\<^esub> (g j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) n\"", "lemma (in PolynRg) add_cf_pol_coeff:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n      \\<Longrightarrow>  pol_coeff S (add_cf S c d)\"", "lemma (in PolynRg) add_cf_len:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n      \\<Longrightarrow> fst (add_cf S c d) = (max (fst c) (fst d))\"", "lemma (in PolynRg) polyn_expr_restrict1:\"\\<lbrakk>pol_coeff S (n, f);\n    pol_coeff S (Suc (m + n), g)\\<rbrakk> \\<Longrightarrow> \n    polyn_expr R X (m + n) (add_cf S (n, f) (m + n, g)) = \n    polyn_expr R X (m + n) (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\"", "lemma (in PolynRg) polyn_add_n1:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk> \\<Longrightarrow> \n      (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =  \n                                polyn_expr R X n (add_cf S (n, f) (n, g))\"", "lemma (in PolynRg) add_cf_val_hi:\"(fst c) < (fst d) \\<Longrightarrow>\n                       snd (add_cf S c d) (fst d) = (snd d) (fst d)\"", "lemma (in PolynRg) add_cf_commute:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n  \\<Longrightarrow> \\<forall>j \\<le> (max (fst c) (fst d)). snd (add_cf S c d) j = \n                           snd (add_cf S d c) j\"", "lemma (in PolynRg) polyn_addTr1:\"pol_coeff S (n, f) \\<Longrightarrow>\n  \\<forall>g. pol_coeff S (n + m, g) \\<longrightarrow> \n        (polyn_expr R X n (n, f) \\<plusminus> (polyn_expr R X (n + m) ((n + m), g))\n                   = polyn_expr R X (n + m) (add_cf S (n, f) ((n + m), g)))\"", "lemma (in PolynRg) polyn_add:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus> (polyn_expr R X m (m, g))\n                   = polyn_expr R X (max n m) (add_cf S (n, f) (m, g))\"", "lemma (in PolynRg) polyn_add1:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus> (polyn_expr R X (fst d) d)\n                   = polyn_expr R X (max (fst c) (fst d)) (add_cf S c d)\"", "lemma (in PolynRg) polyn_minus_nsum:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (polyn_expr R X k c) = nsum R (\\<lambda>j. ((-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>))) k\"", "lemma (in PolynRg) minus_pol_coeff:\"pol_coeff S c \\<Longrightarrow> \n                         pol_coeff S ((fst c), (\\<lambda>j. (-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j))))\"", "lemma (in PolynRg) polyn_minus:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (polyn_expr R X k c) = \n                    polyn_expr R X k (fst c, (\\<lambda>j. (-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j))))\"", "lemma (in PolynRg) m_cf_pol_coeff:\"pol_coeff S c \\<Longrightarrow>\n                              pol_coeff S (m_cf S c)\"", "lemma (in PolynRg) m_cf_len:\"pol_coeff S c \\<Longrightarrow>\n                                         fst (m_cf S c) = fst c\"", "lemma (in PolynRg) polyn_minus_m_cf:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n        -\\<^sub>a (polyn_expr R X k c) =  \n                     polyn_expr R X k (m_cf S c)\"", "lemma (in PolynRg) polyn_zero_minus_zero:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       (polyn_expr R X k c = \\<zero>) = (polyn_expr R X k (m_cf S c) = \\<zero>)\"", "lemma (in PolynRg) coeff_0_pol_0:\"\\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk> \\<Longrightarrow>\n       (\\<forall>j\\<le> k. (snd c) j = \\<zero>\\<^bsub>S\\<^esub>) = (polyn_expr R X k c = \\<zero>)\"", "lemma (in PolynRg) special_cf_pol_coeff:\"pol_coeff S (C\\<^sub>0 S)\"", "lemma (in PolynRg) special_cf_len:\"fst (C\\<^sub>0 S) = 0\"", "lemma (in PolynRg) ext_cf_pol_coeff:\"pol_coeff S c \\<Longrightarrow> \n                           pol_coeff S (ext_cf S n c)\"", "lemma (in PolynRg) ext_cf_len:\"pol_coeff S c \\<Longrightarrow>\n                   fst (ext_cf S m c) = m + fst c\"", "lemma (in PolynRg) ext_special_cf_len:\"fst (ext_cf S m (C\\<^sub>0 S)) = m\"", "lemma (in PolynRg) ext_cf_self:\"pol_coeff S c \\<Longrightarrow> \n                   \\<forall>j \\<le> (fst c). snd (ext_cf S 0 c) j = (snd c) j\"", "lemma (in PolynRg) ext_cf_hi:\"pol_coeff S c \\<Longrightarrow> \n                   (snd c) (fst c)  =\n                      snd (ext_cf S n c) (n + (fst c))\"", "lemma (in PolynRg) ext_special_cf_hi:\"snd (ext_cf S n (C\\<^sub>0 S)) n = 1\\<^sub>r\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) ext_cf_lo_zero:\"\\<lbrakk>pol_coeff S c; 0 < n; x \\<le> (n - Suc 0)\\<rbrakk>\n              \\<Longrightarrow> snd (ext_cf S n c) x = \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) ext_special_cf_lo_zero:\"\\<lbrakk>0 < n; x \\<le> (n - Suc 0)\\<rbrakk>\n              \\<Longrightarrow> snd (ext_cf S n (C\\<^sub>0 S)) x = \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) sp_cf_pol_coeff:\"\\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                   pol_coeff S (sp_cf S a c)\"", "lemma (in PolynRg) sp_cf_len:\"\\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                    fst (sp_cf S a c) = fst c\"", "lemma (in PolynRg) sp_cf_val:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c); a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                    snd (sp_cf S a c) j =  a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((snd c) j)\"", "lemma (in PolynRg) polyn_ext_cf_lo_zero:\"\\<lbrakk>pol_coeff S c; 0 < j\\<rbrakk> \\<Longrightarrow>  \n                     polyn_expr R X (j - Suc 0) (ext_cf S j c) = \\<zero>\"", "lemma (in PolynRg) monomial_d:\"pol_coeff S c \\<Longrightarrow>\n                  polyn_expr R X d (ext_cf S d c) = ((snd c) 0) \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\"", "lemma (in PolynRg) X_to_d:\" X^\\<^bsup>R d\\<^esup> =  polyn_expr R X d (ext_cf S d (C\\<^sub>0 S))\"", "lemma (in PolynRg) c_max_ext_special_cf:\"c_max S (ext_cf S n (C\\<^sub>0 S)) = n\"", "lemma (in PolynRg) scalar_times_polynTr:\"a \\<in> carrier S \\<Longrightarrow> \n       \\<forall>f. pol_coeff S (n, f) \\<longrightarrow> \n        a \\<cdot>\\<^sub>r (polyn_expr R X n (n, f)) = polyn_expr R X n (sp_cf S a (n, f))\"", "lemma (in PolynRg) scalar_times_pol_expr:\"\\<lbrakk>a \\<in> carrier S; pol_coeff S c; \n       n \\<le> fst c\\<rbrakk> \\<Longrightarrow> \n           a \\<cdot>\\<^sub>r (polyn_expr R X n c) = polyn_expr R X n (sp_cf S a c)\"", "lemma (in PolynRg) sp_coeff_nonzero:\"\\<lbrakk>Idomain S; a \\<in> carrier S; a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n       pol_coeff S c; (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; j \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       snd (sp_cf S a c) j \\<noteq>  \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) ext_cf_inductTl:\"pol_coeff S (Suc n, f) \\<Longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (Suc n, f)) = \n                      polyn_expr R X (n + j) (ext_cf S j (n, f))\"", "lemma (in PolynRg) low_deg_terms_zeroTr:\" \n     pol_coeff S (n, f) \\<longrightarrow>\n     polyn_expr R X (n + j) (ext_cf S j (n, f)) = \n                     (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X n (n, f))\"", "lemma (in PolynRg) low_deg_terms_zero:\"pol_coeff S (n, f) \\<Longrightarrow> \n  polyn_expr R X (n + j) (ext_cf S j (n, f)) = \n                            (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X n (n, f))\"", "lemma (in PolynRg) low_deg_terms_zero1:\"pol_coeff S c \\<Longrightarrow> \n  polyn_expr R X ((fst c) + j) (ext_cf S j c) = \n                            (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X (fst c) c)\"", "lemma (in PolynRg) polyn_expr_tOpTr:\"pol_coeff S (n, f) \\<Longrightarrow> \n      \\<forall>g. (pol_coeff S (m, g) \\<longrightarrow> (\\<exists>h. pol_coeff S ((n + m), h) \\<and>\n           h (n + m) = (f n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (g m) \\<and>\n  (polyn_expr R X (n + m) (n + m, h) = \n          (polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g)))))\"", "lemma (in PolynRg) polyn_expr_tOp:\"\\<lbrakk>\n  pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk> \\<Longrightarrow> \\<exists>e. pol_coeff S ((n + m), e) \\<and>\n  e (n + m) = (f n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (g m) \\<and>\n  polyn_expr R X (n + m)(n + m, e) = \n           (polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g))\"", "lemma (in PolynRg) polyn_expr_tOp_c:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk> \\<Longrightarrow>\n      \\<exists>e. pol_coeff S e \\<and> (fst e = fst c + fst d) \\<and>\n          (snd e) (fst e) = (snd c (fst c)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (snd d) (fst d) \\<and>\n          polyn_expr R X (fst e) e =\n                  (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X (fst d) d)\"", "lemma (in PolynRg) polyn_degreeTr:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n       (polyn_expr R X k c = \\<zero> ) = ({j. j \\<le> k \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} = {})\"", "lemma (in PolynRg) higher_part_zero:\"\\<lbrakk>pol_coeff S c; k < fst c;\n      \\<forall>j\\<in>nset (Suc k) (fst c). snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>   \n             \\<Sigma>\\<^sub>f R (\\<lambda>j. snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) (Suc k) (fst c) = \\<zero>\"", "lemma (in PolynRg) coeff_nonzero_polyn_nonzero:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c \\<noteq> \\<zero>) = (\\<exists>j\\<le>k. (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub> )\"", "lemma (in PolynRg) pol_expr_unique:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; \n      pol_coeff S c; p = polyn_expr R X (fst c) c; (snd c) (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      pol_coeff S d; p = polyn_expr R X (fst d) d; (snd d) (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      (fst c) = (fst d) \\<and> (\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j)\"", "lemma (in PolynRg) pol_expr_unique2:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n      fst c = fst d\\<rbrakk> \\<Longrightarrow>\n  (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d ) =\n      (\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j)\"", "lemma (in PolynRg) pol_expr_unique3:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n      fst c < fst d\\<rbrakk> \\<Longrightarrow>\n  (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d ) =\n      ((\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j) \\<and>\n                        (\\<forall>j\\<in>nset (Suc (fst c)) (fst d). (snd d) j = \\<zero>\\<^bsub>S\\<^esub>))\"", "lemma (in PolynRg) polyn_degree_unique:\"\\<lbrakk>pol_coeff S c; pol_coeff S d;\n      polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk> \\<Longrightarrow> \n      c_max S c = c_max S d\"", "lemma (in PolynRg) ex_polyn_expr:\"p \\<in> carrier R \\<Longrightarrow>\n         \\<exists>c. pol_coeff S c \\<and> p = polyn_expr R X (fst c) c\"", "lemma (in PolynRg) c_max_eqTr0:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c);\n     polyn_expr R X k c = polyn_expr R X (fst c) c; \\<exists>j\\<le>k. (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n               c_max S (k, snd c) = c_max S c\"", "lemma (in PolynRg) ex_cf_sol:\"p \\<in> carrier R \\<Longrightarrow>\n                                    \\<exists>c. cf_sol R S X p c\"", "lemma (in PolynRg) deg_in_aug_minf:\"p \\<in> carrier R \\<Longrightarrow>\n                                   deg R S X p \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\"", "lemma (in PolynRg) deg_noninf:\"p \\<in> carrier R \\<Longrightarrow>\n                                   deg R S X p \\<noteq> \\<infinity>\"", "lemma (in PolynRg) deg_ant_int:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n                  \\<Longrightarrow> deg R S X p = ant (int (deg_n R S X p))\"", "lemma (in PolynRg) deg_an:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n        \\<Longrightarrow> deg R S X p = an (deg_n R S X p)\"", "lemma (in PolynRg) pol_SOME_1:\"p \\<in> carrier R  \\<Longrightarrow> \n             cf_sol R S X p (SOME f. cf_sol R S X p f)\"", "lemma (in PolynRg) pol_SOME_2:\"p \\<in> carrier R \\<Longrightarrow>\n         pol_coeff S (SOME c. cf_sol R S X p c) \\<and>  \n           p = polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n                                      (SOME c. cf_sol R S X p c)\"", "lemma (in PolynRg) coeff_max_zeroTr:\"pol_coeff S c \\<Longrightarrow>\n                   \\<forall>j. j \\<le> (fst c) \\<and> (c_max S c) < j \\<longrightarrow> (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) coeff_max_nonzeroTr:\"\\<lbrakk>pol_coeff S c; \n       \\<exists>j \\<le> (fst c). (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> (snd c) (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) coeff_max_bddTr:\"pol_coeff S c \\<Longrightarrow> c_max S c \\<le> (fst c)\"", "lemma (in PolynRg) pol_coeff_max:\"pol_coeff S c \\<Longrightarrow> \n                             pol_coeff S ((c_max S c), snd c)\"", "lemma (in PolynRg) polyn_c_max:\"pol_coeff S c \\<Longrightarrow>\n       polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\"", "lemma (in PolynRg) pol_deg_eq_c_max:\"\\<lbrakk>p \\<in> carrier R; \n       pol_coeff S c; p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> \n                   deg_n R S X p = c_max S c\"", "lemma (in PolynRg) pol_deg_le_n:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> deg_n R S X p \\<le> (fst c)\"", "lemma (in PolynRg) pol_deg_le_n1:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> (fst c); \n       p = polyn_expr R X k c\\<rbrakk> \\<Longrightarrow> deg_n R S X p \\<le> k\"", "lemma (in PolynRg) pol_len_gt_deg:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       p = polyn_expr R X (fst c) c; deg R S X p < (an j); j \\<le> (fst c)\\<rbrakk>\n       \\<Longrightarrow>  (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) pol_diff_deg_less:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n      p = polyn_expr R X (fst c) c; pol_coeff S d;\n      fst c = fst d; (snd c) (fst c) = (snd d) (fst d)\\<rbrakk> \\<Longrightarrow>\n      p \\<plusminus> (-\\<^sub>a (polyn_expr R X (fst d) d)) = \\<zero> \\<or> \n     deg_n R S X (p \\<plusminus> (-\\<^sub>a (polyn_expr R X (fst d) d))) < (fst c)\"", "lemma (in PolynRg) pol_pre_lt_deg:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c;\n      deg_n R S X p \\<le> (fst c); (deg_n R S X p) \\<noteq> 0;\n      p = polyn_expr R X (deg_n R S X p) c \\<rbrakk> \\<Longrightarrow> \n (deg_n R S X (polyn_expr R X ((deg_n R S X p) - Suc 0) c)) < (deg_n R S X p)\"", "lemma (in PolynRg) pol_deg_n:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       n \\<le> fst c; p = polyn_expr R X n c; (snd c) n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n                   deg_n R S X p = n\"", "lemma (in PolynRg) pol_expr_deg:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \n       \\<Longrightarrow> \\<exists>c. pol_coeff S c \\<and> deg_n R S X p \\<le> (fst c) \\<and> \n                p = polyn_expr R X (deg_n R S X p) c \\<and> \n               (snd c) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\"", "lemma (in PolynRg) deg_n_pos:\"p \\<in> carrier R \\<Longrightarrow> 0 \\<le> deg_n R S X p\"", "lemma (in PolynRg) pol_expr_deg1:\"\\<lbrakk>p \\<in> carrier R; d = na (deg R S X p)\\<rbrakk> \\<Longrightarrow> \n                \\<exists>c. (pol_coeff S c \\<and> p = polyn_expr R X d c)\""], "translations": [["", "lemma (in Ring) ideal_sumTr1:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> \n          A \\<minusplus> B = \\<Inter> {J. ideal R J \\<and> (A \\<union> B) \\<subseteq> J}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B =\n                      \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}", "apply (frule sum_ideals[of \"A\" \"B\"], assumption,\n       frule sum_ideals_la1[of \"A\" \"B\"], assumption,\n       frule sum_ideals_la2[of \"A\" \"B\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B =\n                      \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B\n                      \\<subseteq> \\<Inter>\n                                   {J. ideal R J \\<and>\n A \\<union> B \\<subseteq> J}\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\n                      \\<subseteq> A \\<minusplus> B", "(* A \\<minusplus>\\<^sub>R B \\<subseteq> \\<Inter>{J. ideal R J \\<and> A \\<union> B \\<subseteq> J} *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B\n                      \\<subseteq> \\<Inter>\n                                   {J. ideal R J \\<and>\n A \\<union> B \\<subseteq> J}\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\n                      \\<subseteq> A \\<minusplus> B", "apply (rule_tac A = \"{J. ideal R J \\<and> (A \\<union> B) \\<subseteq> J}\" and C = \"A \\<minusplus> B\" in\n                Inter_greatest)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n        A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B;\n        X \\<in> {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\\<rbrakk>\n       \\<Longrightarrow> A \\<minusplus> B \\<subseteq> X\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\n                      \\<subseteq> A \\<minusplus> B", "apply (simp, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n        A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B;\n        ideal R X; A \\<subseteq> X; B \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> A \\<minusplus> B \\<subseteq> X\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\n                      \\<subseteq> A \\<minusplus> B", "apply (rule_tac A = A and B = B and I = X in sum_ideals_cont,\n        simp add:ideal_subset1, simp add:ideal_subset1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\n                      \\<subseteq> A \\<minusplus> B", "apply (rule_tac B = \"A \\<minusplus> B\" and A = \"{J. ideal R J \\<and> (A \\<union> B) \\<subseteq> J}\" in\n         Inter_lower)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<minusplus> B);\n     A \\<subseteq> A \\<minusplus> B; B \\<subseteq> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B\n                      \\<in> {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_ideals_commute:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>   \n                       A \\<minusplus> B = B \\<minusplus> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B = B \\<minusplus> A", "apply (frule ideal_sumTr1 [of \"B\"], assumption+,\n       frule ideal_sumTr1 [of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     B \\<minusplus> A =\n     \\<Inter> {J. ideal R J \\<and> B \\<union> A \\<subseteq> J};\n     A \\<minusplus> B =\n     \\<Inter> {J. ideal R J \\<and> A \\<union> B \\<subseteq> J}\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B = B \\<minusplus> A", "apply (simp add:Un_commute[of \"B\" \"A\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_mono1:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n                A \\<subseteq> B \\<rbrakk> \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C \\<subseteq> B \\<diamondsuit>\\<^sub>r C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> B \\<diamondsuit>\\<^sub>r C", "apply (frule ideal_prod_ideal[of \"B\" \"C\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B;\n     ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> B \\<diamondsuit>\\<^sub>r C", "apply (rule ideal_prod_subTr[of \"A\" \"C\" \"B \\<diamondsuit>\\<^sub>r C\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B;\n     ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>A.\n                         \\<forall>j\\<in>C.\n                            i \\<cdot>\\<^sub>r j\n                            \\<in> B \\<diamondsuit>\\<^sub>r C", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B;\n        ideal R (B \\<diamondsuit>\\<^sub>r C); i \\<in> A; j \\<in> C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> B \\<diamondsuit>\\<^sub>r C", "apply (frule_tac c = i in subsetD[of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B;\n        ideal R (B \\<diamondsuit>\\<^sub>r C); i \\<in> A; j \\<in> C;\n        i \\<in> B\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> B \\<diamondsuit>\\<^sub>r C", "apply (rule_tac i = i and j = j in prod_mem_prod_ideals[of \"B\" \"C\"],\n                 assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_mono2:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n                A \\<subseteq> B \\<rbrakk> \\<Longrightarrow> C \\<diamondsuit>\\<^sub>r A \\<subseteq> C \\<diamondsuit>\\<^sub>r B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> C \\<diamondsuit>\\<^sub>r A\n                      \\<subseteq> C \\<diamondsuit>\\<^sub>r B", "apply (frule ideal_prod_mono1[of \"A\" \"B\" \"C\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> B;\n     A \\<diamondsuit>\\<^sub>r C\n     \\<subseteq> B \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n    \\<Longrightarrow> C \\<diamondsuit>\\<^sub>r A\n                      \\<subseteq> C \\<diamondsuit>\\<^sub>r B", "apply (simp add:ideal_prod_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) cont_ideal_prod:\"\\<lbrakk>ideal R A; ideal R B; ideal R C;\n        A \\<subseteq> C; B \\<subseteq> C \\<rbrakk> \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n     B \\<subseteq> C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> C", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n     B \\<subseteq> C\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>A.\n                                  \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}\n                      \\<subseteq> C", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n        B \\<subseteq> C;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C", "apply (frule ideal_prod_ideal[of \"A\" \"B\"], assumption,\n        frule_tac a = \"A \\<diamondsuit>\\<^sub>r B\" in forall_spec,\n   thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j} \\<subseteq> xa \\<longrightarrow> x \\<in> xa\",\n   simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n     B \\<subseteq> C; ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>i\\<in>A.\n                             \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n        B \\<subseteq> C;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        x \\<in> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C", "apply (rule subsetI, simp, (erule bexE)+, simp add:prod_mem_prod_ideals)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; A \\<subseteq> C;\n        B \\<subseteq> C;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        x \\<in> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C", "apply (frule ideal_prod_la1[of \"A\" \"B\"], assumption,\n        frule_tac c = x in subsetD[of \"A \\<diamondsuit>\\<^sub>r B\" \"A\"], assumption+,\n        simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_distrib:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n             A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C) =  A \\<diamondsuit>\\<^sub>r B \\<minusplus>  A \\<diamondsuit>\\<^sub>r C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C) =\n                      A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C", "apply (frule sum_ideals[of \"B\" \"C\"], assumption,\n       frule ideal_prod_ideal[of \"A\" \"B \\<minusplus> C\"], assumption+,\n       frule ideal_prod_ideal[of \"A\" \"B\"], assumption+,\n       frule ideal_prod_ideal[of \"A\" \"C\"], assumption+,\n       frule sum_ideals[of \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r C\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C) =\n                      A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                                  A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ideal_prod_subTr[of \"A\" \"B \\<minusplus> C\" \"A \\<diamondsuit>\\<^sub>r B \\<minusplus> A \\<diamondsuit>\\<^sub>r C\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>A.\n                         \\<forall>j\\<in>B \\<minusplus> C.\n                            i \\<cdot>\\<^sub>r j\n                            \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                                  A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; j \\<in> B \\<minusplus> C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (frule_tac x = j in ideals_set_sum[of B C], assumption+,\n        (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i j h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; j = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r (h \\<plusminus> k)\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (\n        thin_tac \"j = h \\<plusminus> k\",\n        frule_tac h = i in ideal_subset[of \"A\"], assumption+,\n        frule_tac h = h in ideal_subset[of \"B\"], assumption+,\n        frule_tac h = k in ideal_subset[of \"C\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i j h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; i \\<in> carrier R; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r (h \\<plusminus> k)\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (simp add:ring_distrib1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; i \\<in> carrier R; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r h \\<plusminus>\n                         i \\<cdot>\\<^sub>r k\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (frule_tac i = i and j = h in prod_mem_prod_ideals[of \"A\" \"B\"],\n         assumption+,\n        frule_tac i = i and j = k in prod_mem_prod_ideals[of \"A\" \"C\"],\n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; i \\<in> carrier R; h \\<in> carrier R; k \\<in> carrier R;\n        i \\<cdot>\\<^sub>r h \\<in> A \\<diamondsuit>\\<^sub>r B;\n        i \\<cdot>\\<^sub>r k \\<in> A \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r h \\<plusminus>\n                         i \\<cdot>\\<^sub>r k\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (frule sum_ideals_la1[of \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r C\"], assumption+,\n        frule sum_ideals_la2[of \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r C\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; i \\<in> carrier R; h \\<in> carrier R; k \\<in> carrier R;\n        i \\<cdot>\\<^sub>r h \\<in> A \\<diamondsuit>\\<^sub>r B;\n        i \\<cdot>\\<^sub>r k \\<in> A \\<diamondsuit>\\<^sub>r C;\n        A \\<diamondsuit>\\<^sub>r B\n        \\<subseteq> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                    A \\<diamondsuit>\\<^sub>r C;\n        A \\<diamondsuit>\\<^sub>r C\n        \\<subseteq> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                    A \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r h \\<plusminus>\n                         i \\<cdot>\\<^sub>r k\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (frule_tac c = \"i \\<cdot>\\<^sub>r h\" in subsetD[of \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r B \\<minusplus> A \\<diamondsuit>\\<^sub>r C\"], \n                                assumption+,\n        frule_tac c = \"i \\<cdot>\\<^sub>r k\" in subsetD[of \"A \\<diamondsuit>\\<^sub>r C\" \"A \\<diamondsuit>\\<^sub>r B \\<minusplus> A \\<diamondsuit>\\<^sub>r C\"], \n                                assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i h k.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; h \\<plusminus> k \\<in> B \\<minusplus> C; h \\<in> B;\n        k \\<in> C; i \\<in> carrier R; h \\<in> carrier R; k \\<in> carrier R;\n        i \\<cdot>\\<^sub>r h \\<in> A \\<diamondsuit>\\<^sub>r B;\n        i \\<cdot>\\<^sub>r k \\<in> A \\<diamondsuit>\\<^sub>r C;\n        A \\<diamondsuit>\\<^sub>r B\n        \\<subseteq> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                    A \\<diamondsuit>\\<^sub>r C;\n        A \\<diamondsuit>\\<^sub>r C\n        \\<subseteq> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                    A \\<diamondsuit>\\<^sub>r C;\n        i \\<cdot>\\<^sub>r h\n        \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n              A \\<diamondsuit>\\<^sub>r C;\n        i \\<cdot>\\<^sub>r k\n        \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n              A \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r h \\<plusminus>\n                         i \\<cdot>\\<^sub>r k\n                         \\<in> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                               A \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (simp add:ideal_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n                      A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule sum_ideals_cont[of \"A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)\" \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r C\" ],\n          assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ideal_prod_subTr[of \"A\" \"B\" \"A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>A.\n                         \\<forall>j\\<in>B.\n                            i \\<cdot>\\<^sub>r j\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i j.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; j \\<in> B\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (frule sum_ideals_la1[of \"B\" \"C\"], assumption+,\n         frule_tac c = j in subsetD[of \"B\" \"B \\<minusplus> C\"], assumption+,\n         rule_tac i = i and j = j in prod_mem_prod_ideals[of \"A\" \"B \\<minusplus> C\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ideal_prod_subTr[of \"A\" \"C\" \"A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n     ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r C);\n     ideal R\n      (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n       A \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>A.\n                         \\<forall>j\\<in>C.\n                            i \\<cdot>\\<^sub>r j\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<minusplus> C)", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i j.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; ideal R (B \\<minusplus> C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C));\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        ideal R (A \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r B \\<minusplus>\n          A \\<diamondsuit>\\<^sub>r C);\n        i \\<in> A; j \\<in> C\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> A \\<diamondsuit>\\<^sub>r (B \\<minusplus> C)", "apply (frule sum_ideals_la2[of \"B\" \"C\"], assumption+,\n         frule_tac c = j in subsetD[of \"C\" \"B \\<minusplus> C\"], assumption+,\n         rule_tac i = i and j = j in prod_mem_prod_ideals[of \"A\" \"B \\<minusplus> C\"],\n         assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  coprime_ideals::\"[_, 'a set, 'a set] \\<Rightarrow> bool\" where\n  \"coprime_ideals R A B \\<longleftrightarrow> A \\<minusplus>\\<^bsub>R\\<^esub> B = carrier R\""], ["", "lemma (in Ring) coprimeTr:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n                coprime_ideals R A B = (\\<exists>a \\<in> A. \\<exists>b \\<in> B. a \\<plusminus> b = 1\\<^sub>r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R A B =\n                      (\\<exists>a\\<in>A.\n                          \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A.\n                         \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\n 2. \\<lbrakk>ideal R A; ideal R B;\n     \\<exists>a\\<in>A.\n        \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R A B", "apply (simp add:coprime_ideals_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<minusplus> B = carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A.\n                         \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\n 2. \\<lbrakk>ideal R A; ideal R B;\n     \\<exists>a\\<in>A.\n        \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R A B", "apply (cut_tac ring_one, frule sym, thin_tac \"A \\<minusplus> B = carrier R\", simp,\n        thin_tac \"carrier R = A \\<minusplus> B\", frule ideals_set_sum[of A B],\n        assumption+, (erule bexE)+, frule sym, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     \\<exists>a\\<in>A.\n        \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R A B", "apply (erule bexE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R A B", "apply (frule ideal_subset1[of A], frule ideal_subset1[of B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R A B", "apply (frule_tac a = a and b = b in set_sum_mem[of _ A _ B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R;\n        a \\<plusminus> b \\<in> A \\<minusplus> B\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R A B", "apply (simp add:coprime_ideals_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R; 1\\<^sub>r \\<in> A \\<minusplus> B\\<rbrakk>\n       \\<Longrightarrow> A \\<minusplus> B = carrier R", "apply (frule sum_ideals[of \"A\" \"B\"], assumption+,\n        frule ideal_inc_one[of \"A \\<minusplus> B\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R; 1\\<^sub>r \\<in> A \\<minusplus> B;\n        ideal R (A \\<minusplus> B); A \\<minusplus> B = carrier R\\<rbrakk>\n       \\<Longrightarrow> A \\<minusplus> B = carrier R", "apply (simp add:coprime_ideals_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_int_prod:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n       \\<Longrightarrow>   A \\<inter> B = A \\<diamondsuit>\\<^sub>r B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B = A \\<diamondsuit>\\<^sub>r B", "apply (frule ideal_prod_la1[of \"A\" \"B\"], assumption+,\n       frule ideal_prod_la2[of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B = A \\<diamondsuit>\\<^sub>r B", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 2. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> A \\<inter> B", "defer"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> A \\<inter> B\n 2. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "(**  A \\<diamondsuit>\\<^bsub>R\\<^esub> B \\<subseteq> A \\<inter> B **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> A \\<inter> B\n 2. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (simp add:coprime_ideals_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<minusplus> B = carrier R;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule int_ideal[of \"A\" \"B\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<minusplus> B = carrier R;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B;\n     ideal R (A \\<inter> B)\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule idealprod_whole_r[of \"A \\<inter> B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<minusplus> B = carrier R;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r carrier R = A \\<inter> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule sym, thin_tac \"A \\<minusplus> B = carrier R\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r (A \\<minusplus> B) =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (simp add:ideal_distrib)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r A \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (simp add:ideal_prod_commute[of \"A \\<inter> B\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (cut_tac Int_lower1[of \"A\" \"B\"], cut_tac Int_lower2[of \"A\" \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B; A \\<inter> B \\<subseteq> A;\n     A \\<inter> B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule ideal_prod_mono2[of \"A \\<inter> B\" \"B\" \"A\"], assumption+,  \n        frule ideal_prod_mono1[of \"A \\<inter> B\" \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B; A \\<inter> B \\<subseteq> A;\n     A \\<inter> B \\<subseteq> B;\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B)\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B;\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule ideal_prod_ideal[of \"A \\<inter> B\" \"B\"], assumption+,\n        frule ideal_prod_ideal[of \"A\" \"A \\<inter> B\"], assumption+,\n        frule ideal_subset1[of \"A \\<diamondsuit>\\<^sub>r (A \\<inter> B)\"],\n        frule ideal_subset1[of \"(A \\<inter> B) \\<diamondsuit>\\<^sub>r B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B; A \\<inter> B \\<subseteq> A;\n     A \\<inter> B \\<subseteq> B;\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B)\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B;\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B;\n     ideal R ((A \\<inter> B) \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r (A \\<inter> B));\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<subseteq> carrier R;\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply (frule ideal_prod_ideal[of A B], assumption+,\n        frule sum_ideals_cont[of \"A \\<diamondsuit>\\<^sub>r B\" \"A \\<diamondsuit>\\<^sub>r (A \\<inter> B)\" \"(A \\<inter> B) \\<diamondsuit>\\<^sub>r B\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<diamondsuit>\\<^sub>r B \\<subseteq> A;\n     A \\<diamondsuit>\\<^sub>r B \\<subseteq> B; ideal R (A \\<inter> B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B =\n     A \\<inter> B;\n     carrier R = A \\<minusplus> B; A \\<inter> B \\<subseteq> A;\n     A \\<inter> B \\<subseteq> B;\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B)\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B;\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B;\n     ideal R ((A \\<inter> B) \\<diamondsuit>\\<^sub>r B);\n     ideal R (A \\<diamondsuit>\\<^sub>r (A \\<inter> B));\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<subseteq> carrier R;\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B \\<subseteq> carrier R;\n     ideal R (A \\<diamondsuit>\\<^sub>r B);\n     A \\<diamondsuit>\\<^sub>r (A \\<inter> B) \\<minusplus>\n     (A \\<inter> B) \\<diamondsuit>\\<^sub>r B\n     \\<subseteq> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n    \\<Longrightarrow> A \\<inter> B \\<subseteq> A \\<diamondsuit>\\<^sub>r B", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_elems:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk> \\<Longrightarrow>\n                    \\<exists>a\\<in>A. \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>a\\<in>A.\n                         \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r", "by (simp add:coprimeTr)"], ["", "lemma (in Ring) coprime_elemsTr:\"\\<lbrakk>ideal R A; ideal R B; a\\<in>A; b\\<in>B; a \\<plusminus> b = 1\\<^sub>r\\<rbrakk> \n               \\<Longrightarrow> pj R A b = 1\\<^sub>r\\<^bsub>(qring R A)\\<^esub> \\<and> pj R B a = 1\\<^sub>r\\<^bsub>(qring R B)\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (frule pj_Hom [OF Ring, of \"A\"],\n       frule pj_Hom [OF Ring, of \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (frule qring_ring[of \"A\"], frule qring_ring[of \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (cut_tac ring_is_ag,\n        frule Ring.ring_is_ag[of \"R /\\<^sub>r A\"],\n         frule Ring.ring_is_ag[of \"R /\\<^sub>r B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (frule_tac a = a and b = b in aHom_add[of \"R\" \"R /\\<^sub>r A\" \"pj R A\"],\n         assumption+,\n       simp add:rHom_def, simp add:ideal_subset,\n       simp add:ideal_subset, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B);\n     pj R A 1\\<^sub>r =\n     pj R A a \\<plusminus>\\<^bsub>R /\\<^sub>r A\\<^esub> pj R A b\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (frule ideal_subset[of \"A\" \"a\"], assumption,\n        frule ideal_subset[of \"B\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; a \\<in> A; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B);\n     pj R A 1\\<^sub>r =\n     pj R A a \\<plusminus>\\<^bsub>R /\\<^sub>r A\\<^esub> pj R A b;\n     a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (simp only:pj_zero[OF Ring, THEN sym, of \"A\" \"a\"],\n        frule rHom_mem[of \"pj R A\" \"R\" \"qring R A\" \"b\"], assumption+,\n        simp add:aGroup.l_zero[of \"R /\\<^sub>r A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B); pj R A 1\\<^sub>r = pj R A b; a \\<in> carrier R;\n     b \\<in> carrier R; pj R A b \\<in> carrier (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R A b =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<and>\n                      pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (simp add:rHom_one[OF Ring, of \"qring R A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B);\n     1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> = pj R A b; a \\<in> carrier R;\n     b \\<in> carrier R; pj R A b \\<in> carrier (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (frule_tac a = a and b = b in aHom_add[of \"R\" \"R /\\<^sub>r B\" \"pj R B\"],\n         assumption+,\n       simp add:rHom_def, simp add:ideal_subset,\n       simp add:ideal_subset, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>; b \\<in> B;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B);\n     1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> = pj R A b; a \\<in> carrier R;\n     b \\<in> carrier R; pj R A b \\<in> carrier (R /\\<^sub>r A);\n     pj R B 1\\<^sub>r =\n     pj R B a \\<plusminus>\\<^bsub>R /\\<^sub>r B\\<^esub> pj R B b\\<rbrakk>\n    \\<Longrightarrow> pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (simp only:pj_zero[OF Ring, THEN sym, of \"B\" \"b\"],\n        frule rHom_mem[of \"pj R B\" \"R\" \"qring R B\" \"a\"], assumption+,\n        simp add:aGroup.ag_r_zero[of \"R /\\<^sub>r B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     pj R B b = \\<zero>\\<^bsub>R /\\<^sub>r B\\<^esub>;\n     a \\<plusminus> b = 1\\<^sub>r; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B); Ring (R /\\<^sub>r A);\n     Ring (R /\\<^sub>r B); aGroup R; aGroup (R /\\<^sub>r A);\n     aGroup (R /\\<^sub>r B);\n     1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> = pj R A b; a \\<in> carrier R;\n     b \\<in> carrier R; pj R A b \\<in> carrier (R /\\<^sub>r A);\n     pj R B 1\\<^sub>r = pj R B a;\n     pj R B a \\<in> carrier (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> pj R B a = 1\\<^sub>r\\<^bsub>R /\\<^sub>r B\\<^esub>", "apply (simp add:rHom_one[OF Ring, of \"qring R B\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) partition_of_unity:\"\\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R; \n       a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R; v \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                                 pj R A (a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u ) = pj R A u\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R;\n     a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n     v \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pj R A\n                       (a \\<cdot>\\<^sub>r v \\<plusminus>\n                        b \\<cdot>\\<^sub>r u) =\n                      pj R A u", "apply (frule pj_Hom [OF Ring, of \"A\"],\n       frule ideal_subset [of \"A\" \"a\"], assumption+,\n       frule ring_tOp_closed[of \"a\" \"v\"], assumption+,\n       frule ring_tOp_closed[of \"b\" \"u\"], assumption+,\n       frule qring_ring[of \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R;\n     a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R; v \\<in> carrier R;\n     pj R A \\<in> rHom R (R /\\<^sub>r A); a \\<in> carrier R;\n     a \\<cdot>\\<^sub>r v \\<in> carrier R;\n     b \\<cdot>\\<^sub>r u \\<in> carrier R; Ring (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R A\n                       (a \\<cdot>\\<^sub>r v \\<plusminus>\n                        b \\<cdot>\\<^sub>r u) =\n                      pj R A u", "apply (simp add:ringhom1[OF Ring, of \"qring R A\" \"a \\<cdot>\\<^sub>r v\" \"b \\<cdot>\\<^sub>r u\" \"pj R A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R;\n     a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R; v \\<in> carrier R;\n     pj R A \\<in> rHom R (R /\\<^sub>r A); a \\<in> carrier R;\n     a \\<cdot>\\<^sub>r v \\<in> carrier R;\n     b \\<cdot>\\<^sub>r u \\<in> carrier R; Ring (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R A\n                       (a \\<cdot>\\<^sub>r\n                        v) \\<plusminus>\\<^bsub>R /\\<^sub>r A\\<^esub>\n                      pj R A (b \\<cdot>\\<^sub>r u) =\n                      pj R A u", "apply (frule ideal_ring_multiple1[of \"A\" \"a\" \"v\"], assumption+,\n        simp add:pj_zero[OF Ring, THEN sym, of \"A\" \"a \\<cdot>\\<^sub>r v\"],\n        frule rHom_mem[of \"pj R A\" \"R\" \"qring R A\" \"b \\<cdot>\\<^sub>r u\"], assumption+,\n        simp add:Ring.l_zero, simp add:rHom_tOp[OF Ring])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; a \\<in> A; b \\<in> carrier R;\n     a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R; v \\<in> carrier R;\n     pj R A \\<in> rHom R (R /\\<^sub>r A); a \\<in> carrier R;\n     a \\<cdot>\\<^sub>r v \\<in> carrier R;\n     b \\<cdot>\\<^sub>r u \\<in> carrier R; Ring (R /\\<^sub>r A);\n     pj R A a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> pj R A v =\n     \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     pj R A b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> pj R A u\n     \\<in> carrier (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R A b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n                      pj R A u =\n                      pj R A u", "apply (frule ringhom1[OF Ring, of \"qring R A\" \"a\" \"b\" \"pj R A\"], assumption+,\n        simp,\n        simp add:pj_zero[OF Ring, THEN sym, of \"A\" \"a\"],\n        frule rHom_mem[of \"pj R A\" \"R\" \"qring R A\" \"b\"], assumption+,\n        simp add:Ring.l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     b \\<in> carrier R; a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n     v \\<in> carrier R; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     a \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n     b \\<cdot>\\<^sub>r u \\<in> carrier R; Ring (R /\\<^sub>r A);\n     \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n     pj R A v =\n     \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     pj R A b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> pj R A u\n     \\<in> carrier (R /\\<^sub>r A);\n     pj R A 1\\<^sub>r = pj R A b;\n     pj R A b \\<in> carrier (R /\\<^sub>r A)\\<rbrakk>\n    \\<Longrightarrow> pj R A b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n                      pj R A u =\n                      pj R A u", "apply (simp add:rHom_one[OF Ring, of \"qring R A\" \"pj R A\"],\n          rotate_tac -2, frule sym, thin_tac \"1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> = pj R A b\",\n          simp,\n          rule Ring.ring_l_one[of \"qring R A\" \"pj R A u\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n             \\<in> carrier (R /\\<^sub>r A);\n     ideal R A; pj R A a = \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     b \\<in> carrier R; a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n     v \\<in> carrier R; pj R A \\<in> rHom R (R /\\<^sub>r A);\n     a \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n     b \\<cdot>\\<^sub>r u \\<in> carrier R; Ring (R /\\<^sub>r A);\n     \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n     pj R A v =\n     \\<zero>\\<^bsub>R /\\<^sub>r A\\<^esub>;\n     1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\n     pj R A u\n     \\<in> carrier (R /\\<^sub>r A);\n     pj R A b = 1\\<^sub>r\\<^bsub>R /\\<^sub>r A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pj R A u \\<in> carrier (R /\\<^sub>r A)", "apply (simp add:rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprimes_commute:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B \\<rbrakk>\n \\<Longrightarrow> coprime_ideals R B A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R B A", "apply (simp add:coprime_ideals_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<minusplus> B = carrier R\\<rbrakk>\n    \\<Longrightarrow> B \\<minusplus> A = carrier R", "apply (simp add:sum_ideals_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_surjTr:\"\\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B; \n                 X \\<in> carrier (qring R A); Y \\<in> carrier (qring R B) \\<rbrakk> \\<Longrightarrow> \n                         \\<exists>r\\<in>carrier R. pj R A r = X \\<and> pj R B r = Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     X \\<in> carrier (R /\\<^sub>r A);\n     Y \\<in> carrier (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         pj R A r = X \\<and> pj R B r = Y", "apply (frule qring_ring [of \"A\"], \n       frule qring_ring [of \"B\"], \n       frule coprime_elems [of \"A\" \"B\"], assumption+,\n       frule pj_Hom [OF Ring, of \"A\"],\n       frule pj_Hom [OF Ring, of \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n     X \\<in> carrier (R /\\<^sub>r A); Y \\<in> carrier (R /\\<^sub>r B);\n     Ring (R /\\<^sub>r A); Ring (R /\\<^sub>r B);\n     \\<exists>a\\<in>A. \\<exists>b\\<in>B. a \\<plusminus> b = 1\\<^sub>r;\n     pj R A \\<in> rHom R (R /\\<^sub>r A);\n     pj R B \\<in> rHom R (R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         pj R A r = X \\<and> pj R B r = Y", "apply (erule bexE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n        X \\<in> carrier (R /\\<^sub>r A); Y \\<in> carrier (R /\\<^sub>r B);\n        Ring (R /\\<^sub>r A); Ring (R /\\<^sub>r B);\n        pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            pj R A r = X \\<and> pj R B r = Y", "apply (simp add:qring_carrier[of \"A\"],\n        simp add:qring_carrier[of \"B\"], (erule bexE)+,\n        rename_tac a b u v)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>ideal R A; ideal R B; coprime_ideals R A B;\n        Ring (R /\\<^sub>r A); Ring (R /\\<^sub>r B);\n        pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        u \\<uplus>\\<^bsub>R\\<^esub> A = X; v \\<in> carrier R;\n        v \\<uplus>\\<^bsub>R\\<^esub> B = Y\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            pj R A r = X \\<and> pj R B r = Y", "apply (rotate_tac -1, frule sym, thin_tac \"v \\<uplus>\\<^bsub>R\\<^esub> B = Y\",\n        rotate_tac -3, frule sym, thin_tac \"u \\<uplus>\\<^bsub>R\\<^esub> A = X\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>v \\<in> carrier R; Y = v \\<uplus>\\<^bsub>R\\<^esub> B;\n        ideal R A; ideal R B; coprime_ideals R A B; Ring (R /\\<^sub>r A);\n        Ring (R /\\<^sub>r B); pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        X = u \\<uplus>\\<^bsub>R\\<^esub> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            pj R A r = u \\<uplus>\\<^bsub>R\\<^esub> A \\<and>\n                            pj R B r = v \\<uplus>\\<^bsub>R\\<^esub> B", "apply (frule_tac h = a in ideal_subset[of \"A\"], assumption+,\n       frule_tac h = b in ideal_subset[of \"B\"], assumption+,\n       frule_tac x = a and y = v in ring_tOp_closed, assumption+,\n       frule_tac x = b and y = u in ring_tOp_closed, assumption+,\n       cut_tac ring_is_ag,\n       frule_tac x = \"a \\<cdot>\\<^sub>r v\" and y = \"b \\<cdot>\\<^sub>r u\" in aGroup.ag_pOp_closed[of \"R\"], \n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>v \\<in> carrier R; Y = v \\<uplus>\\<^bsub>R\\<^esub> B;\n        ideal R A; ideal R B; coprime_ideals R A B; Ring (R /\\<^sub>r A);\n        Ring (R /\\<^sub>r B); pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        X = u \\<uplus>\\<^bsub>R\\<^esub> A; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R; aGroup R;\n        a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            pj R A r = u \\<uplus>\\<^bsub>R\\<^esub> A \\<and>\n                            pj R B r = v \\<uplus>\\<^bsub>R\\<^esub> B", "apply (frule_tac a = a and b = b and u = u and v = v in \n                  partition_of_unity[of \"A\"], assumption+,\n        simp add:pj_mem[OF Ring, of \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>v \\<in> carrier R; Y = v \\<uplus>\\<^bsub>R\\<^esub> B;\n        ideal R A; ideal R B; coprime_ideals R A B; Ring (R /\\<^sub>r A);\n        Ring (R /\\<^sub>r B); pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        X = u \\<uplus>\\<^bsub>R\\<^esub> A; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R; aGroup R;\n        a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u\n        \\<in> carrier R;\n        (a \\<cdot>\\<^sub>r v \\<plusminus>\n         b \\<cdot>\\<^sub>r u) \\<uplus>\\<^bsub>R\\<^esub> A =\n        u \\<uplus>\\<^bsub>R\\<^esub> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            r \\<uplus>\\<^bsub>R\\<^esub> A =\n                            u \\<uplus>\\<^bsub>R\\<^esub> A \\<and>\n                            pj R B r = v \\<uplus>\\<^bsub>R\\<^esub> B", "apply (frule_tac a = b and b = a and u = v and v = u in \n           partition_of_unity[of \"B\"], assumption+,\n        subst aGroup.ag_pOp_commute[of \"R\"], assumption+,\n        simp add:pj_mem[OF Ring, of \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>v \\<in> carrier R; Y = v \\<uplus>\\<^bsub>R\\<^esub> B;\n        ideal R A; ideal R B; coprime_ideals R A B; Ring (R /\\<^sub>r A);\n        Ring (R /\\<^sub>r B); pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        X = u \\<uplus>\\<^bsub>R\\<^esub> A; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R; aGroup R;\n        a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u\n        \\<in> carrier R;\n        (a \\<cdot>\\<^sub>r v \\<plusminus>\n         b \\<cdot>\\<^sub>r u) \\<uplus>\\<^bsub>R\\<^esub> A =\n        u \\<uplus>\\<^bsub>R\\<^esub> A;\n        pj R B (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        v \\<uplus>\\<^bsub>R\\<^esub> B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            r \\<uplus>\\<^bsub>R\\<^esub> A =\n                            u \\<uplus>\\<^bsub>R\\<^esub> A \\<and>\n                            r \\<uplus>\\<^bsub>R\\<^esub> B =\n                            v \\<uplus>\\<^bsub>R\\<^esub> B", "apply (frule_tac x = \"b \\<cdot>\\<^sub>r u\" and y = \"a \\<cdot>\\<^sub>r v\" in \n             aGroup.ag_pOp_commute[of \"R\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b u v.\n       \\<lbrakk>v \\<in> carrier R; Y = v \\<uplus>\\<^bsub>R\\<^esub> B;\n        ideal R A; ideal R B; coprime_ideals R A B; Ring (R /\\<^sub>r A);\n        Ring (R /\\<^sub>r B); pj R A \\<in> rHom R (R /\\<^sub>r A);\n        pj R B \\<in> rHom R (R /\\<^sub>r B); a \\<in> A; b \\<in> B;\n        a \\<plusminus> b = 1\\<^sub>r; u \\<in> carrier R;\n        X = u \\<uplus>\\<^bsub>R\\<^esub> A; a \\<in> carrier R;\n        b \\<in> carrier R; a \\<cdot>\\<^sub>r v \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R; aGroup R;\n        a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u\n        \\<in> carrier R;\n        (a \\<cdot>\\<^sub>r v \\<plusminus>\n         b \\<cdot>\\<^sub>r u) \\<uplus>\\<^bsub>R\\<^esub> A =\n        u \\<uplus>\\<^bsub>R\\<^esub> A;\n        pj R B (a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u) =\n        v \\<uplus>\\<^bsub>R\\<^esub> B;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v =\n        a \\<cdot>\\<^sub>r v \\<plusminus> b \\<cdot>\\<^sub>r u\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            r \\<uplus>\\<^bsub>R\\<^esub> A =\n                            u \\<uplus>\\<^bsub>R\\<^esub> A \\<and>\n                            r \\<uplus>\\<^bsub>R\\<^esub> B =\n                            v \\<uplus>\\<^bsub>R\\<^esub> B", "apply (simp add:pj_mem[OF Ring], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_n_idealsTr0:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; \n         coprime_ideals R A C; coprime_ideals R B C \\<rbrakk> \\<Longrightarrow> \n             coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; coprime_ideals R A C;\n     coprime_ideals R B C\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (simp add:coprimeTr[of \"A\" \"C\"],\n       simp add:coprimeTr[of \"B\" \"C\"], (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B;\n        b \\<in> C; a \\<plusminus> b = 1\\<^sub>r; ba \\<in> C;\n        aa \\<plusminus> ba = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (cut_tac ring_is_ag,\n       frule_tac h = a in ideal_subset[of \"A\"], assumption+,\n       frule_tac h = aa in ideal_subset[of \"B\"], assumption+,\n       frule_tac h = b in ideal_subset[of \"C\"], assumption+,\n       frule_tac h = ba in ideal_subset[of \"C\"], assumption+,\n       frule_tac x = a and y = b in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B;\n        b \\<in> C; a \\<plusminus> b = 1\\<^sub>r; ba \\<in> C;\n        aa \\<plusminus> ba = 1\\<^sub>r; aGroup R; a \\<in> carrier R;\n        aa \\<in> carrier R; b \\<in> carrier R; ba \\<in> carrier R;\n        a \\<plusminus> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule_tac x = \"a \\<plusminus> b\" and y = aa and z = ba in ring_distrib1,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B;\n        b \\<in> C; a \\<plusminus> b = 1\\<^sub>r; ba \\<in> C;\n        aa \\<plusminus> ba = 1\\<^sub>r; aGroup R; a \\<in> carrier R;\n        aa \\<in> carrier R; b \\<in> carrier R; ba \\<in> carrier R;\n        a \\<plusminus> b \\<in> carrier R;\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r (aa \\<plusminus> ba) =\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r ba\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (\n       rotate_tac 6, frule sym, thin_tac \"a \\<plusminus> b = 1\\<^sub>r\",\n       frule sym, thin_tac \"aa \\<plusminus> ba = 1\\<^sub>r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R;\n        a \\<plusminus> b \\<in> carrier R;\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r (aa \\<plusminus> ba) =\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<plusminus> b) \\<cdot>\\<^sub>r ba;\n        ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        1\\<^sub>r = a \\<plusminus> b;\n        1\\<^sub>r = aa \\<plusminus> ba\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (simp only:ring_distrib2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R;\n        a \\<plusminus> b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r (a \\<plusminus> b) \\<plusminus>\n        b \\<cdot>\\<^sub>r (a \\<plusminus> b) =\n        a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba);\n        ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        aa \\<plusminus> ba = a \\<plusminus> b;\n        1\\<^sub>r = a \\<plusminus> b\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (rotate_tac -1, frule sym, thin_tac \"1\\<^sub>r = a \\<plusminus> b\", simp,\n       thin_tac \"aa \\<plusminus> ba = 1\\<^sub>r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        a \\<cdot>\\<^sub>r 1\\<^sub>r \\<plusminus>\n        b \\<cdot>\\<^sub>r 1\\<^sub>r =\n        a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba);\n        ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (simp add:ring_r_one,\n       thin_tac \"a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus> (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba) \\<in> carrier R\",\n       thin_tac \"a \\<plusminus> b = a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus> (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R;\n        1\\<^sub>r =\n        a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba);\n        ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B;\n        b \\<in> C\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule_tac x = a and y = aa in ring_tOp_closed, assumption+,\n        frule_tac x = b and y = aa in ring_tOp_closed, assumption+,\n        frule_tac x = a and y = ba in ring_tOp_closed, assumption+,\n        frule_tac x = b and y = ba in ring_tOp_closed, assumption+, \n        frule_tac x = \"a \\<cdot>\\<^sub>r ba\" and y = \"b \\<cdot>\\<^sub>r ba\" in aGroup.ag_pOp_closed, \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R;\n        1\\<^sub>r =\n        a \\<cdot>\\<^sub>r aa \\<plusminus> b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba);\n        ideal R A; ideal R B; ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (simp add:aGroup.ag_pOp_assoc,\n         frule sym, thin_tac \"1\\<^sub>r = a \\<cdot>\\<^sub>r aa \\<plusminus> (b \\<cdot>\\<^sub>r aa \\<plusminus> (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; ideal R A; ideal R B;\n        ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R;\n        a \\<cdot>\\<^sub>r aa \\<plusminus>\n        (b \\<cdot>\\<^sub>r aa \\<plusminus>\n         (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)) =\n        1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule_tac i = a and j = aa in prod_mem_prod_ideals[of \"A\" \"B\"],\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; ideal R A; ideal R B;\n        ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R;\n        a \\<cdot>\\<^sub>r aa \\<plusminus>\n        (b \\<cdot>\\<^sub>r aa \\<plusminus>\n         (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)) =\n        1\\<^sub>r;\n        a \\<cdot>\\<^sub>r aa \\<in> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule_tac x = ba and r = a in ideal_ring_multiple[of \"C\"],\n           assumption+,\n         frule_tac x = ba and r = b in ideal_ring_multiple[of \"C\"],\n           assumption+,\n         frule_tac x = b and r = aa in ideal_ring_multiple1[of \"C\"],\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; ideal R A; ideal R B;\n        ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R;\n        a \\<cdot>\\<^sub>r aa \\<plusminus>\n        (b \\<cdot>\\<^sub>r aa \\<plusminus>\n         (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)) =\n        1\\<^sub>r;\n        a \\<cdot>\\<^sub>r aa \\<in> A \\<diamondsuit>\\<^sub>r B;\n        a \\<cdot>\\<^sub>r ba \\<in> C; b \\<cdot>\\<^sub>r ba \\<in> C;\n        b \\<cdot>\\<^sub>r aa \\<in> C\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule_tac I = C and x = \"a \\<cdot>\\<^sub>r ba\" and y = \"b \\<cdot>\\<^sub>r ba\" in \n         ideal_pOp_closed, assumption+,\n         frule_tac I = C and x = \"b \\<cdot>\\<^sub>r aa\" and y = \"a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\" in \n         ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; ideal R A; ideal R B;\n        ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R;\n        a \\<cdot>\\<^sub>r aa \\<plusminus>\n        (b \\<cdot>\\<^sub>r aa \\<plusminus>\n         (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)) =\n        1\\<^sub>r;\n        a \\<cdot>\\<^sub>r aa \\<in> A \\<diamondsuit>\\<^sub>r B;\n        a \\<cdot>\\<^sub>r ba \\<in> C; b \\<cdot>\\<^sub>r ba \\<in> C;\n        b \\<cdot>\\<^sub>r aa \\<in> C;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba \\<in> C;\n        b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)\n        \\<in> C\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (frule ideal_prod_ideal[of \"A\" \"B\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa b ba.\n       \\<lbrakk>ba \\<in> C; aGroup R; a \\<in> carrier R; aa \\<in> carrier R;\n        b \\<in> carrier R; ba \\<in> carrier R; ideal R A; ideal R B;\n        ideal R C; a \\<in> A; aa \\<in> B; b \\<in> C;\n        a \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        b \\<cdot>\\<^sub>r aa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        b \\<cdot>\\<^sub>r ba \\<in> carrier R;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba\n        \\<in> carrier R;\n        a \\<cdot>\\<^sub>r aa \\<plusminus>\n        (b \\<cdot>\\<^sub>r aa \\<plusminus>\n         (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)) =\n        1\\<^sub>r;\n        a \\<cdot>\\<^sub>r aa \\<in> A \\<diamondsuit>\\<^sub>r B;\n        a \\<cdot>\\<^sub>r ba \\<in> C; b \\<cdot>\\<^sub>r ba \\<in> C;\n        b \\<cdot>\\<^sub>r aa \\<in> C;\n        a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba \\<in> C;\n        b \\<cdot>\\<^sub>r aa \\<plusminus>\n        (a \\<cdot>\\<^sub>r ba \\<plusminus> b \\<cdot>\\<^sub>r ba)\n        \\<in> C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (A \\<diamondsuit>\\<^sub>r B) C", "apply (subst coprimeTr, assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_n_idealsTr1:\"ideal R C \\<Longrightarrow>\n    (\\<forall>k \\<le> n. ideal R (J k)) \\<and> (\\<forall>i \\<le> n.  coprime_ideals R (J i) C) \\<longrightarrow> \n    coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R C \\<Longrightarrow>\n    (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n    coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R C \\<Longrightarrow>\n    (\\<forall>k\\<le>0. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>0. coprime_ideals R (J i) C) \\<longrightarrow>\n    coprime_ideals R (i\\<Pi>\\<^bsub>R,0\\<^esub> J) C\n 2. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             coprime_ideals R (J i) C) \\<longrightarrow>\n                         coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R C;\n     (\\<forall>k\\<le>0. ideal R (J k)) \\<and>\n     (\\<forall>i\\<le>0. coprime_ideals R (J i) C)\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,0\\<^esub> J) C\n 2. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             coprime_ideals R (J i) C) \\<longrightarrow>\n                         coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R C; \\<forall>k\\<le>0. ideal R (J k);\n     \\<forall>i\\<le>0. coprime_ideals R (J i) C\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,0\\<^esub> J) C\n 2. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             coprime_ideals R (J i) C) \\<longrightarrow>\n                         coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             coprime_ideals R (J i) C) \\<longrightarrow>\n                         coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n. coprime_ideals R (J i) C)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>i\\<le>Suc n. coprime_ideals R (J i) C\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (cut_tac n = \"Suc n\" in n_in_Nsetn)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>i\\<le>Suc n. coprime_ideals R (J i) C;\n        Suc n \\<in> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply (cut_tac n = n in Nset_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>n. coprime_ideals R (J i) C) \\<longrightarrow>\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>i\\<le>Suc n. coprime_ideals R (J i) C;\n        Suc n \\<in> {i. i \\<le> Suc n};\n        {j. j \\<le> Suc n} = insert (Suc n) {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          C", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C; coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>i\\<le>Suc n. coprime_ideals R (J i) C;\n        {j. j \\<le> Suc n} = insert (Suc n) {j. j \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R\n                          (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                           J (Suc n))\n                          C", "apply (cut_tac n = n and J = J in n_prod_ideal,\n        rule allI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R C; coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>i\\<le>Suc n. coprime_ideals R (J i) C;\n        {j. j \\<le> Suc n} = insert (Suc n) {j. j \\<le> n};\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R\n                          (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                           J (Suc n))\n                          C", "apply (rule_tac A = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" and B = \"J (Suc n)\" in \n                coprime_n_idealsTr0[of _ _ \"C\"], simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_n_idealsTr2:\"\\<lbrakk>ideal R C; (\\<forall>k \\<le> n. ideal R (J k)); \n       (\\<forall>i \\<le> n. coprime_ideals R (J i) C) \\<rbrakk> \\<Longrightarrow> \n                                     coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R C; \\<forall>k\\<le>n. ideal R (J k);\n     \\<forall>i\\<le>n. coprime_ideals R (J i) C\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) C", "by (simp add:coprime_n_idealsTr1)"], ["", "lemma (in Ring) coprime_n_idealsTr3:\"(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n    (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). i \\<noteq> j \\<longrightarrow> \n    coprime_ideals R (J i) (J j)) \\<longrightarrow>  coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))", "apply (rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n                       (J (Suc n))", "apply (case_tac \"n = 0\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n                       (J (Suc n))", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n                       (J (Suc n))", "apply (cut_tac nat_eq_le[of \"Suc n\" \"Suc n\"],\n        frule_tac a = \"Suc n\" in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n; Suc n \\<le> Suc n; ideal R (J (Suc n))\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n                       (J (Suc n))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> Suc n = Suc n", "apply (rotate_tac 1, frule_tac a = \"Suc n\" in forall_spec, assumption,\n        thin_tac \"\\<forall>j\\<le>Suc n. Suc n \\<noteq> j \\<longrightarrow> coprime_ideals R (J (Suc n)) (J j)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<le>Suc n.\n                \\<forall>j\\<le>Suc n.\n                   i \\<noteq> j \\<longrightarrow>\n                   coprime_ideals R (J i) (J j);\n     0 < n; Suc n \\<le> Suc n; ideal R (J (Suc n));\n     \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n    \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n                       (J (Suc n))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> Suc n = Suc n", "apply (rule_tac C = \"J (Suc n)\" and n = n and J = J in coprime_n_idealsTr2,\n        assumption, rule allI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i\\<le>Suc n.\n                \\<forall>j\\<le>Suc n.\n                   i \\<noteq> j \\<longrightarrow>\n                   coprime_ideals R (J i) (J j);\n     0 < n; Suc n \\<le> Suc n; ideal R (J (Suc n));\n     \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>n. coprime_ideals R (J i) (J (Suc n))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> Suc n = Suc n", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>i\\<le>Suc n.\n                   \\<forall>j\\<le>Suc n.\n                      i \\<noteq> j \\<longrightarrow>\n                      coprime_ideals R (J i) (J j);\n        0 < n; Suc n \\<le> Suc n; ideal R (J (Suc n));\n        \\<forall>k\\<le>Suc n. ideal R (J k); i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J i) (J (Suc n))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> Suc n = Suc n", "apply (frule_tac a = i in forall_spec, simp,\n       thin_tac \"\\<forall>i\\<le>Suc n. \\<forall>j\\<le>Suc n. i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j)\",\n       rotate_tac -1,\n       frule_tac a = \"Suc n\" in forall_spec, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>j\\<le>Suc n.\n                   i \\<noteq> j \\<longrightarrow>\n                   coprime_ideals R (J i) (J j);\n        0 < n; Suc n \\<le> Suc n; ideal R (J (Suc n));\n        \\<forall>k\\<le>Suc n. ideal R (J k); i \\<le> n;\n        i \\<noteq> Suc n \\<longrightarrow>\n        coprime_ideals R (J i) (J (Suc n))\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J i) (J (Suc n))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> Suc n = Suc n", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_n_idealsTr4:\"\\<lbrakk>(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n   (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). i \\<noteq> j \\<longrightarrow> \n    coprime_ideals R (J i) (J j))\\<rbrakk> \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<Longrightarrow>\n    coprime_ideals R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) (J (Suc n))", "apply (simp add:coprime_n_idealsTr3)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Direct product1, general case\""], ["", "definition\n  prod_tOp :: \"['i set,  'i \\<Rightarrow> ('a, 'm) Ring_scheme] \\<Rightarrow> \n    ('i \\<Rightarrow> 'a) \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow>  ('i \\<Rightarrow> 'a)\" where\n  \"prod_tOp I A = (\\<lambda>f\\<in>carr_prodag I A. \\<lambda>g\\<in>carr_prodag I A.\n                           \\<lambda>x\\<in>I. (f x) \\<cdot>\\<^sub>r\\<^bsub>(A x)\\<^esub> (g x))\""], ["", "(** Let x \\<in> I, then A x is a ring, {A x | x \\<in> I} is a set of rings. **)"], ["", "definition\n  prod_one::\"['i set,  'i  \\<Rightarrow> ('a, 'm) Ring_scheme] \\<Rightarrow> ('i \\<Rightarrow> 'a)\" where\n  \"prod_one I A == \\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>(A x)\\<^esub>\""], ["", "(** 1\\<^sub>(A x) is the unit of a ring A x. **)"], ["", "definition\n  prodrg :: \"['i set, 'i \\<Rightarrow> ('a, 'more) Ring_scheme] \\<Rightarrow> ('i \\<Rightarrow> 'a) Ring\" where\n  \"prodrg I A = \\<lparr>carrier = carr_prodag I A, pop = prod_pOp I A, mop = \n    prod_mOp I A, zero = prod_zero I A, tp = prod_tOp I A, \n    un = prod_one I A \\<rparr>\""], ["", "(** I is the index set **)"], ["", "abbreviation\n  PRODRING  (\"(r\\<Pi>\\<^bsub>_\\<^esub>/ _)\" [72,73]72) where\n  \"r\\<Pi>\\<^bsub>I\\<^esub> A == prodrg I A\""], ["", "definition\n  augm_func :: \"[nat, nat \\<Rightarrow> 'a,'a set, nat, nat \\<Rightarrow> 'a, 'a set] \\<Rightarrow> nat \\<Rightarrow> 'a\" where\n  \"augm_func n f A m g B = (\\<lambda>i\\<in>{j. j \\<le> (n + m)}. if i \\<le> n then f i else\n    if (Suc n) \\<le> i \\<and> i \\<le> n + m then g ((sliden (Suc n)) i) else undefined)\""], ["", "(* Remark. g is a function of Nset (m - 1) \\<rightarrow> B *)"], ["", "definition    \n  ag_setfunc :: \"[nat, nat \\<Rightarrow> ('a, 'more) Ring_scheme, nat, \nnat \\<Rightarrow> ('a, 'more)  Ring_scheme] \\<Rightarrow> (nat \\<Rightarrow> 'a) set \\<Rightarrow> (nat \\<Rightarrow> 'a) set\n \\<Rightarrow> (nat  \\<Rightarrow> 'a) set\" where\n  \"ag_setfunc n B1 m B2 X Y =\n    {f. \\<exists>g. \\<exists>h. (g\\<in>X) \\<and>(h\\<in>Y) \\<and>(f = (augm_func n g (Un_carrier {j. j \\<le> n} B1) \n      m h (Un_carrier {j. j \\<le> (m - 1)} B2)))}\""], ["", "(* Later we consider X = ac_Prod_Rg (Nset n) B1 and Y = ac_Prod_Rg (Nset (m - 1)) B2 *)"], ["", "primrec\n  ac_fProd_Rg :: \"[nat, nat \\<Rightarrow> ('a, 'more) Ring_scheme] \\<Rightarrow>\n                 (nat \\<Rightarrow> 'a) set\"\nwhere\n  fprod_0: \"ac_fProd_Rg 0 B = carr_prodag {0::nat} B\"\n| frpod_n: \"ac_fProd_Rg (Suc n) B = ag_setfunc n B (Suc 0) (compose {0::nat} \n B (slide (Suc n))) (carr_prodag {j. j \\<le> n} B) (carr_prodag {0} (compose {0} B (slide (Suc n))))\""], ["", "definition\n  prodB1 :: \"[('a, 'm) Ring_scheme, ('a, 'm) Ring_scheme] \\<Rightarrow>\n                 (nat \\<Rightarrow> ('a, 'm) Ring_scheme)\" where\n  \"prodB1 R S = (\\<lambda>k. if k=0 then R else if k=Suc 0 then S else\n                 undefined)\""], ["", "definition\n  Prod2Rg :: \"[('a, 'm) Ring_scheme, ('a, 'm) Ring_scheme]\n              \\<Rightarrow> (nat \\<Rightarrow> 'a) Ring\" (infixl \"\\<Oplus>\\<^sub>r\" 80) where\n  \"A1 \\<Oplus>\\<^sub>r A2 = prodrg {0, Suc 0} (prodB1 A1 A2)\""], ["", "text \\<open>Don't try \\<open>(Prod_ring (Nset n) B) \\<Oplus>\\<^sub>r (B (Suc n))\\<close>\\<close>"], ["", "lemma carr_prodrg_mem_eq:\"\\<lbrakk>f \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A); g \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n       \\<forall>i\\<in>I. f i = g i \\<rbrakk> \\<Longrightarrow> f = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>i\\<in>I. f i = g i\\<rbrakk>\n    \\<Longrightarrow> f = g", "by (simp add:prodrg_def carr_prodag_def, (erule conjE)+,\n    rule funcset_eq[of _ I], assumption+)"], ["", "lemma prod_tOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow> prod_tOp I A X Y \\<in> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y \\<in> carr_prodag I A", "apply (subst carr_prodag_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y \\<in> extensional I \\<and>\n                      prod_tOp I A X Y\n                      \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                      (\\<forall>i\\<in>I.\n                          prod_tOp I A X Y i \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y \\<in> extensional I\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y\n                      \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                      (\\<forall>i\\<in>I.\n                          prod_tOp I A X Y i \\<in> carrier (A i))", "apply (simp add:prod_tOp_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y\n                      \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                      (\\<forall>i\\<in>I.\n                          prod_tOp I A X Y i \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A X Y \\<in> I \\<rightarrow> Un_carrier I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         prod_tOp I A X Y i \\<in> carrier (A i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n        Y \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A X Y x \\<in> Un_carrier I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         prod_tOp I A X Y i \\<in> carrier (A i)", "apply (simp add:Un_carrier_def prod_tOp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n        Y \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            X x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> Y x\n                            \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         prod_tOp I A X Y i \\<in> carrier (A i)", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); x \\<in> I;\n        X \\<in> extensional I; Y \\<in> extensional I;\n        X \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. X i \\<in> carrier (A i);\n        Y \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. Y i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            X x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> Y x\n                            \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         prod_tOp I A X Y i \\<in> carrier (A i)", "apply (blast dest: Ring.ring_tOp_closed del:PiE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         prod_tOp I A X Y i \\<in> carrier (A i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n        Y \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A X Y i \\<in> carrier (A i)", "apply (simp add:prod_tOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); X \\<in> carr_prodag I A;\n        Y \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> X i \\<cdot>\\<^sub>r\\<^bsub>A i\\<^esub> Y i\n                         \\<in> carrier (A i)", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); i \\<in> I;\n        X \\<in> extensional I; Y \\<in> extensional I;\n        X \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. X i \\<in> carrier (A i);\n        Y \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. Y i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> X i \\<cdot>\\<^sub>r\\<^bsub>A i\\<^esub> Y i\n                         \\<in> carrier (A i)", "apply (simp add:Ring.ring_tOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_tOp_func:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    prod_tOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<rightarrow> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    prod_tOp I A\n    \\<in> carr_prodag I A \\<rightarrow>\n          carr_prodag I A \\<rightarrow> carr_prodag I A", "by (simp add:prod_tOp_mem)"], ["", "lemma prod_one_func:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n                           prod_one I A \\<in> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    prod_one I A \\<in> carr_prodag I A", "apply (simp add:prod_one_def carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>A x\\<^esub>)\n    \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n    (\\<forall>i\\<in>I. 1\\<^sub>r\\<^bsub>A i\\<^esub> \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>A x\\<^esub>)\n    \\<in> I \\<rightarrow> Un_carrier I A\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. 1\\<^sub>r\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>A x\\<^esub>) x\n                         \\<in> Un_carrier I A\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. 1\\<^sub>r\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            1\\<^sub>r\\<^bsub>A x\\<^esub> \\<in> xa\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. 1\\<^sub>r\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (blast dest: Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. 1\\<^sub>r\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (simp add: Ring.ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_carrier:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n                  carrier (prodrg I A) = carrier (prodag I A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) =\n    carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)", "by (simp add:prodrg_def prodag_def)"], ["", "lemma prodrg_ring:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> Ring (prodrg I A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    Ring (r\\<Pi>\\<^bsub>I\\<^esub> A)", "apply (rule Ring.intro)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 8. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 9. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 10. \\<And>a b.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          b =\n                          b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a\nA total of 13 subgoals...", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (13 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    prod_pOp I A\n    \\<in> carr_prodag I A \\<rightarrow>\n          carr_prodag I A \\<rightarrow> carr_prodag I A\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 8. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 9. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 10. \\<And>a b.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          b =\n                          b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a\nA total of 13 subgoals...", "apply (rule prod_pOp_func,\n        rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 5. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 6. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 7. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 8. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 9. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 10. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\nA total of 12 subgoals...", "apply (simp add:prodrg_def, rule prod_pOp_assoc,\n        simp add:Ring.ring_is_ag, assumption+)"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 8. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 9. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 10. \\<And>a b c.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c\nA total of 11 subgoals...", "apply (simp add:prodrg_def, rule prod_pOp_commute,\n          simp add:Ring.ring_is_ag, assumption+)"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 5. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 6. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 7. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 8. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 9. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 10. \\<And>a.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a =\n                          a", "apply (simp add:prodrg_def, rule prod_mOp_func,\n           simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 6. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 7. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 8. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 9. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 6. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 7. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 8. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 9. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (cut_tac X = a in prod_mOp_mem[of \"I\" \"A\"])"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I. aGroup (A j)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carr_prodag I A\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 8. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 9. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 10. \\<And>a b c.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n         c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c\nA total of 11 subgoals...", "apply (simp add:Ring.ring_is_ag, assumption)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 6. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 7. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 8. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 9. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (cut_tac X = \"prod_mOp I A a\" and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n        simp add:Ring.ring_is_ag, assumption+,\n        cut_tac prod_zero_func[of \"I\" \"A\"])"], ["proof (prove)\ngoal (10 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 5. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 6. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 7. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 8. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 9. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 10. \\<And>a.\n        \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n         a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n        \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          a =\n                          a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"],\n        simp add:Ring.ring_is_ag, assumption+,\n        rule ballI, simp add:prod_pOp_def,\n        subst prod_mOp_mem_i, simp add:Ring.ring_is_ag, assumption+,\n        subst prod_zero_i, simp add:Ring.ring_is_ag, assumption+,\n        rule aGroup.l_m, simp add:Ring.ring_is_ag,\n        simp add:prodag_comp_i, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 5. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 8. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def,\n        rule prod_zero_func, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 4. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 5. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 6. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 7. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def,\n        cut_tac prod_zero_func[of \"I\" \"A\"],\n        cut_tac X = \"prod_zero I A\" and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n        simp add:Ring.ring_is_ag, assumption+,\n        rule carr_prodag_mem_eq[of \"I\" \"A\"],\n        simp add:Ring.ring_is_ag, assumption+)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_zero I A) a l = a l\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 5. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 8. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule ballI)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a l = a l\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 5. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 8. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prod_pOp_def prod_zero_def)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then \\<zero>\\<^bsub>A x\\<^esub>\n             else undefined) \\<plusminus>\\<^bsub>A x\\<^esub>\n            a x)\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A l\\<^esub> \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 5. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 8. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule aGroup.ag_l_zero, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then \\<zero>\\<^bsub>A x\\<^esub>\n             else undefined) \\<plusminus>\\<^bsub>A x\\<^esub>\n            a x)\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<in> carrier (A l)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 5. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 6. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 7. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 8. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodag_comp_i, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 4. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 5. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 6. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def,\n        rule prod_tOp_func, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A (prod_tOp I A a b) c =\n                         prod_tOp I A a (prod_tOp I A b c)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (frule_tac X = a and Y = b in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         frule_tac X = \"prod_tOp I A a b\" and Y = c in \n                                      prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         frule_tac X = b and Y = c in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         frule_tac X = a and Y = \"prod_tOp I A b c\" in \n                                      prod_tOp_mem[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_tOp I A a b \\<in> carr_prodag I A;\n        prod_tOp I A (prod_tOp I A a b) c \\<in> carr_prodag I A;\n        prod_tOp I A b c \\<in> carr_prodag I A;\n        prod_tOp I A a (prod_tOp I A b c) \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A (prod_tOp I A a b) c =\n                         prod_tOp I A a (prod_tOp I A b c)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"],\n         simp add:Ring.ring_is_ag, assumption+, rule ballI)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_tOp I A a b \\<in> carr_prodag I A;\n        prod_tOp I A (prod_tOp I A a b) c \\<in> carr_prodag I A;\n        prod_tOp I A b c \\<in> carr_prodag I A;\n        prod_tOp I A a (prod_tOp I A b c) \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A (prod_tOp I A a b) c l =\n                         prod_tOp I A a (prod_tOp I A b c) l\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prod_tOp_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> b x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> b x\n             else undefined) \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub>\n            c x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. b x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> c x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I.\n            a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub>\n            (if x \\<in> I then b x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> c x\n             else undefined))\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub>\n                         b l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub>\n                         (b l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub> c l)\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 3. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 4. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 5. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule Ring.ring_tOp_assoc, simp, (simp add:prodag_comp_i)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A a b = prod_tOp I A b a\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (frule_tac X = a and Y = b in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         frule_tac X = b and Y = a in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         rule carr_prodag_mem_eq[of \"I\" \"A\"],\n         simp add:Ring.ring_is_ag, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; prod_tOp I A a b \\<in> carr_prodag I A;\n        prod_tOp I A b a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_tOp I A a b l = prod_tOp I A b a l\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule ballI, simp add:prod_tOp_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> b x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. b x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> a x)\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub> b l =\n                         b l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub> a l\n 2. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 4. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule Ring.ring_tOp_commute, (simp add:prodag_comp_i)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def, rule prod_one_func, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        c \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         b \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         c\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A a (prod_pOp I A b c) =\n                         prod_pOp I A (prod_tOp I A a b) (prod_tOp I A a c)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (cut_tac X = b and Y = c in prod_pOp_mem[of \"I\" \"A\"],\n         simp add:Ring.ring_is_ag, assumption+,\n         cut_tac X = a and Y = b in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         cut_tac X = a and Y = c in prod_tOp_mem[of \"I\" \"A\"], assumption+,\n         cut_tac X = \"prod_tOp I A a b\" and Y = \"prod_tOp I A a c\" in \n         prod_pOp_mem[of \"I\" \"A\"], simp add:Ring.ring_is_ag, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_tOp I A a b \\<in> carr_prodag I A;\n        prod_tOp I A a c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_tOp I A a b) (prod_tOp I A a c)\n        \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A a (prod_pOp I A b c) =\n                         prod_pOp I A (prod_tOp I A a b) (prod_tOp I A a c)\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"],\n         simp add:Ring.ring_is_ag, rule prod_tOp_mem[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_tOp I A a b \\<in> carr_prodag I A;\n        prod_tOp I A a c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_tOp I A a b) (prod_tOp I A a c)\n        \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_tOp I A a (prod_pOp I A b c) l =\n                            prod_pOp I A (prod_tOp I A a b)\n                             (prod_tOp I A a c) l\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule ballI, simp add:prod_tOp_def prod_pOp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. b x \\<plusminus>\\<^bsub>A x\\<^esub> c x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> b x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> c x)\n        \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> b x\n             else undefined) \\<plusminus>\\<^bsub>A x\\<^esub>\n            (if x \\<in> I then a x \\<cdot>\\<^sub>r\\<^bsub>A x\\<^esub> c x\n             else undefined))\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l) =\n                         a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l \\<cdot>\\<^sub>r\\<^bsub>A l\\<^esub> c l\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (rule Ring.ring_distrib1, (simp add:prodag_comp_i)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         a =\n                         a", "apply (simp add:prodrg_def,\n        cut_tac prod_one_func[of \"I\" \"A\"],\n        cut_tac X = \"prod_one I A\" and Y = a in prod_tOp_mem[of \"I\" \"A\"], \n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); a \\<in> carr_prodag I A;\n        prod_one I A \\<in> carr_prodag I A;\n        prod_tOp I A (prod_one I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A (prod_one I A) a = a\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. Ring (A k)", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"],\n        simp add:Ring.ring_is_ag, assumption+,\n        rule ballI, simp add:prod_tOp_def prod_one_def,\n        rule Ring.ring_l_one, simp, simp add:prodag_comp_i)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. Ring (A k)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_elem_extensional:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); f \\<in> carrier (prodrg I A)\\<rbrakk>\n      \\<Longrightarrow>  f \\<in> extensional I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     f \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:prodag_def carr_prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_pOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  pop (prodrg I A) = prod_pOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>) = prod_pOp I A", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_mOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  mop (prodrg I A) = prod_mOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    mop (r\\<Pi>\\<^bsub>I\\<^esub> A) = prod_mOp I A", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_zero:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  zero (prodrg I A) = prod_zero I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> = prod_zero I A", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_tOp:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  tp (prodrg I A) = prod_tOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    (\\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>) =\n    prod_tOp I A", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_one:\"\\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow> \n                  un (prodrg I A) = prod_one I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. Ring (A k) \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> = prod_one I A", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_sameTr5:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_tOp I A = prod_tOp I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A = prod_tOp I B", "apply (frule prod_tOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A = prod_tOp I B", "apply (subgoal_tac \"carr_prodag I A = carr_prodag I B\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A = prod_tOp I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (frule prod_tOp_func [of \"I\" \"B\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A = prod_tOp I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule funcset_eq [of _ \"carr_prodag I B\" _])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I A \\<in> extensional (carr_prodag I B)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I B \\<in> extensional (carr_prodag I B)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         prod_tOp I A x = prod_tOp I B x\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (simp add:prod_tOp_def extensional_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_tOp I B \\<in> extensional (carr_prodag I B)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         prod_tOp I A x = prod_tOp I B x\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (simp add:prod_tOp_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B;\n     carr_prodag I A = carr_prodag I B;\n     prod_tOp I B\n     \\<in> carr_prodag I B \\<rightarrow>\n           carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        prod_tOp I A\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        carr_prodag I A = carr_prodag I B;\n        prod_tOp I B\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        x \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (frule_tac x = x in funcset_mem [of \"prod_tOp I A\" \"carr_prodag I B\"\n \"carr_prodag I B \\<rightarrow> carr_prodag I B\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        prod_tOp I A\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        carr_prodag I A = carr_prodag I B;\n        prod_tOp I B\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        x \\<in> carr_prodag I B;\n        prod_tOp I A x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (frule_tac x = x in funcset_mem [of \"prod_tOp I B\" \"carr_prodag I B\"\n \"carr_prodag I B \\<rightarrow> carr_prodag I B\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        prod_tOp I A\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        carr_prodag I A = carr_prodag I B;\n        prod_tOp I B\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (thin_tac \" prod_tOp I A\n           \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B \\<rightarrow> carr_prodag I B\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B;\n        prod_tOp I B\n        \\<in> carr_prodag I B \\<rightarrow>\n              carr_prodag I B \\<rightarrow> carr_prodag I B;\n        x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (thin_tac \"prod_tOp I B\n           \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B \\<rightarrow> carr_prodag I B\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x = prod_tOp I B x\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule funcset_eq [of _ \"carr_prodag I B\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x \\<in> extensional (carr_prodag I B)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I B x \\<in> extensional (carr_prodag I B)\n 3. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<in>carr_prodag I B.\n                            prod_tOp I A x xa = prod_tOp I B x xa\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (simp add:prod_tOp_def extensional_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I B x \\<in> extensional (carr_prodag I B)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<in>carr_prodag I B.\n                            prod_tOp I A x xa = prod_tOp I B x xa\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (simp add:prod_tOp_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x\n        \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<in>carr_prodag I B.\n                            prod_tOp I A x xa = prod_tOp I B x xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x xa = prod_tOp I B x xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (frule_tac f = \"prod_tOp I A x\" and A = \"carr_prodag I B\" and\n         x = xa in funcset_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B;\n        prod_tOp I A x xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x xa = prod_tOp I B x xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (frule_tac f = \"prod_tOp I B x\" and A = \"carr_prodag I B\" and\n         x = xa in funcset_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x xa = prod_tOp I B x xa\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (subgoal_tac \"\\<forall>k\\<in>I. aGroup (B k)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B;\n        \\<forall>k\\<in>I. aGroup (B k)\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x xa = prod_tOp I B x xa\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule carr_prodag_mem_eq, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B;\n        \\<forall>k\\<in>I. aGroup (B k)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_tOp I A x xa l = prod_tOp I B x xa l\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule ballI, simp add:prod_tOp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B;\n        prod_tOp I A x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        prod_tOp I B x \\<in> carr_prodag I B \\<rightarrow> carr_prodag I B;\n        xa \\<in> carr_prodag I B; prod_tOp I A x xa \\<in> carr_prodag I B;\n        prod_tOp I B x xa \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule ballI, rule Ring.ring_is_ag, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (subgoal_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A;\n     \\<forall>k\\<in>I. aGroup (A k)\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (simp add:prodag_sameTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_tOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (rule ballI, rule Ring.ring_is_ag, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_sameTr6:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_one I A = prod_one I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> prod_one I A = prod_one I B", "apply (frule prod_one_func [of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_one I A = prod_one I B", "apply (cut_tac prodag_sameTr1[of \"I\" \"A\" \"B\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I A = prod_one I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply (rule carr_prodag_mem_eq[of I A \"prod_one I A\" \"prod_one I B\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I A \\<in> carr_prodag I A\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I B \\<in> carr_prodag I A\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. prod_one I A l = prod_one I B l\n 5. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 6. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply (simp add:Ring.ring_is_ag, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I B \\<in> carr_prodag I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. prod_one I A l = prod_one I B l\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply (cut_tac prod_one_func [of \"I\" \"B\"], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. Ring (B k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. prod_one I A l = prod_one I B l\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I. prod_one I A l = prod_one I B l\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply (rule ballI, simp add:prod_one_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     prod_one I A \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. A k = B k", "apply (simp add:Ring.ring_is_ag, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_same:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prodrg I A = prodrg I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B", "apply (subgoal_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k)\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodag_sameTr1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k);\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodag_sameTr2, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k); carr_prodag I A = carr_prodag I B;\n     prod_pOp I A = prod_pOp I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodag_sameTr3, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k); carr_prodag I A = carr_prodag I B;\n     prod_pOp I A = prod_pOp I B; prod_mOp I A = prod_mOp I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodag_sameTr4, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k); carr_prodag I A = carr_prodag I B;\n     prod_pOp I A = prod_pOp I B; prod_mOp I A = prod_mOp I B;\n     prod_zero I A = prod_zero I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodrg_sameTr5, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k); carr_prodag I A = carr_prodag I B;\n     prod_pOp I A = prod_pOp I B; prod_mOp I A = prod_mOp I B;\n     prod_zero I A = prod_zero I B; prod_tOp I A = prod_tOp I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (frule prodrg_sameTr6, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); \\<forall>k\\<in>I. A k = B k;\n     \\<forall>k\\<in>I. aGroup (A k); carr_prodag I A = carr_prodag I B;\n     prod_pOp I A = prod_pOp I B; prod_mOp I A = prod_mOp I B;\n     prod_zero I A = prod_zero I B; prod_tOp I A = prod_tOp I B;\n     prod_one I A = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> r\\<Pi>\\<^bsub>I\\<^esub> A = r\\<Pi>\\<^bsub>I\\<^esub> B\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (rule ballI, rule Ring.ring_is_ag, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodrg_component:\"\\<lbrakk>f \\<in> carrier (prodrg I A); i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                 f i \\<in> carrier (A i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A); i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> f i \\<in> carrier (A i)", "by (simp add:prodrg_def carr_prodag_def)"], ["", "lemma project_rhom:\"\\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         PRoject I A j \\<in> rHom ( prodrg I A) (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> rHom (r\\<Pi>\\<^bsub>I\\<^esub> A) (A j)", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> aHom (r\\<Pi>\\<^bsub>I\\<^esub> A) (A j) \\<and>\n                      (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> aHom (r\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> carrier\n                             (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n                            carrier (A j) \\<and>\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> carrier\n                             (r\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n                            carrier (A j)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule Pi_I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) x \\<in> carrier (A j)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) x \\<in> carrier (A j)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (cut_tac prodag_carrier[of I A], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) x \\<in> carrier (A j)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:PRoject_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> x j \\<in> carrier (A j)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (cut_tac prodag_carrier[of I A], simp,\n        thin_tac \"carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> x j \\<in> carrier (A j)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 5. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodag_comp_i)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (subgoal_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k)\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (frule project_aHom [of \"I\" \"A\" \"j\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (r\\<Pi>\\<^bsub>I\\<^esub> A))\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 4. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_carrier aHom_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_pOp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (prod_pOp I A a b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodag_pOp[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     \\<forall>k\\<in>I. aGroup (A k);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>y\\<in>carrier\n    (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               y) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) y) \\<and>\n                      (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>y\\<in>carrier (r\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              y) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           y) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           y) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (cut_tac prodag_carrier[of I A], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A; y \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           y) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (frule_tac X = x and Y = y in prod_tOp_mem[of I A], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A; y \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A;\n        prod_tOp I A x y \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           y) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_tOp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A; y \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A;\n        prod_tOp I A x y \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) (prod_tOp I A x y) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) y\n 2. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:PRoject_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carr_prodag I A; y \\<in> carr_prodag I A;\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A;\n        prod_tOp I A x y \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I A x y j =\n                         x j \\<cdot>\\<^sub>r\\<^bsub>A j\\<^esub> y j\n 2. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 3. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prod_tOp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y k.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        y \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); k \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A k)\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (frule prodrg_ring [of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (frule Ring.ring_one[of \"r\\<Pi>\\<^bsub>I\\<^esub> A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (r\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>", "apply (cut_tac prodag_carrier[of I A], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carr_prodag I A;\n     carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (simp add:PRoject_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carr_prodag I A;\n     carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> j =\n                      1\\<^sub>r\\<^bsub>A j\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring\n      \\<lparr>carrier = carr_prodag I A, pop = prod_pOp I A,\n         mop = prod_mOp I A, zero = prod_zero I A, tp = prod_tOp I A,\n         un = prod_one I A\\<rparr>;\n     prod_one I A \\<in> carr_prodag I A;\n     carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_one I A j = 1\\<^sub>r\\<^bsub>A j\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (fold prodrg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A); prod_one I A \\<in> carr_prodag I A;\n     carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_one I A j = 1\\<^sub>r\\<^bsub>A j\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (simp add:prod_one_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n     Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n     1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (A k)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k\\<in>I. Ring (A k); j \\<in> I;\n        Ring (r\\<Pi>\\<^bsub>I\\<^esub> A);\n        1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        k \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A k)", "apply (simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma augm_funcTr:\"\\<lbrakk>\\<forall>k \\<le>(Suc n). Ring (B k); \n                       f \\<in> carr_prodag {i. i \\<le> (Suc n)} B\\<rbrakk> \\<Longrightarrow> \n f = augm_func n (restrict f {i. i \\<le> n}) (Un_carrier {i. i \\<le> n} B) (Suc 0)  \n     (\\<lambda>x\\<in>{0::nat}. f (x + Suc n)) \n             (Un_carrier {0} (compose {0} B (slide (Suc n))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> f =\n                      augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))", "apply (rule carr_prodag_mem_eq [of \"{i. i \\<le> (Suc n)}\" \"B\" \"f\"\n \"augm_func n (restrict f {i. i \\<le> n}) (Un_carrier {i. i \\<le> n} B) (Suc 0)\n (\\<lambda>x\\<in>{0}. f (x + Suc n)) (Un_carrier {0} (compose {0} B (slide (Suc n))))\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc n}. aGroup (B k)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carr_prodag {i. i \\<le> Suc n} B\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> carr_prodag {i. i \\<le> Suc n} B\n 4. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carr_prodag {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> carr_prodag {i. i \\<le> Suc n} B\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> carr_prodag {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> extensional {i. i \\<le> Suc n} \\<and>\n                      augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                            Un_carrier {i. i \\<le> Suc n} B \\<and>\n                      (\\<forall>i\\<le>Suc n.\n                          augm_func n (restrict f {i. i \\<le> n})\n                           (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                           (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                           (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                           i\n                          \\<in> carrier (B i))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> extensional {i. i \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                            Un_carrier {i. i \\<le> Suc n} B \\<and>\n                      (\\<forall>i\\<le>Suc n.\n                          augm_func n (restrict f {i. i \\<le> n})\n                           (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                           (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                           (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                           i\n                          \\<in> carrier (B i))\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                            Un_carrier {i. i \\<le> Suc n} B \\<and>\n                      (\\<forall>i\\<le>Suc n.\n                          augm_func n (restrict f {i. i \\<le> n})\n                           (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                           (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                           (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                           i\n                          \\<in> carrier (B i))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                       (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                       (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                       (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                      \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                            Un_carrier {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule Pi_I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B \\<and>\n        (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i));\n        x \\<in> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) x\n                         \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:augm_func_def sliden_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B \\<and>\n        (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i));\n        x \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          f x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (erule conjE)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          f x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (frule_tac x = x in funcset_mem[of f \"{i. i \\<le> Suc n}\" \n                           \"Un_carrier {i. i \\<le> Suc n} B\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {i. i \\<le> Suc n}\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        f x \\<in> Un_carrier {i. i \\<le> Suc n} B\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          f x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 4. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        f x \\<in> Un_carrier {i. i \\<le> Suc n} B\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          f x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        f x \\<in> Un_carrier {i. i \\<le> Suc n} B\\<rbrakk>\n       \\<Longrightarrow> \\<not> x \\<le> n \\<longrightarrow>\n                         f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        f x \\<in> Un_carrier {i. i \\<le> Suc n} B; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule_tac x = \"Suc n\" in funcset_mem[of f \"{i. i \\<le> Suc n}\" \n                  \"Un_carrier {i. i \\<le> Suc n} B\"], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        f x \\<in> Un_carrier {i. i \\<le> Suc n} B; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> Suc n \\<in> {i. i \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> extensional {i. i \\<le> Suc n} \\<and>\n     f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n             Un_carrier {i. i \\<le> Suc n} B \\<and>\n     (\\<forall>i\\<le>Suc n. f i \\<in> carrier (B i))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule allI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> i \\<le> Suc n \\<longrightarrow>\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) i\n                         \\<in> carrier (B i)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> (sliden (Suc n) i = 0 \\<longrightarrow>\n                          \\<not> i \\<le> n \\<longrightarrow>\n                          i \\<le> Suc n \\<longrightarrow>\n                          f (Suc n) \\<in> carrier (B i)) \\<and>\n                         (0 < sliden (Suc n) i \\<longrightarrow>\n                          \\<not> i \\<le> n \\<longrightarrow>\n                          i \\<le> Suc n \\<longrightarrow>\n                          undefined \\<in> carrier (B i))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (case_tac \"i \\<le> n\", simp add:sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i);\n        \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (sliden (Suc n) i = 0 \\<longrightarrow>\n                          \\<not> i \\<le> n \\<longrightarrow>\n                          i \\<le> Suc n \\<longrightarrow>\n                          f (Suc n) \\<in> carrier (B i)) \\<and>\n                         (0 < sliden (Suc n) i \\<longrightarrow>\n                          \\<not> i \\<le> n \\<longrightarrow>\n                          i \\<le> Suc n \\<longrightarrow>\n                          undefined \\<in> carrier (B i))\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:sliden_def, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> extensional {i. i \\<le> Suc n};\n        f \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                Un_carrier {i. i \\<le> Suc n} B;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier (B i); \\<not> i \\<le> n;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier (B i)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:nat_not_le_less,\n        frule_tac m = n and n = i in Suc_leI,\n        frule_tac m = i and n = \"Suc n\" in Nat.le_antisym, assumption+,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n     f \\<in> carr_prodag {i. i \\<le> Suc n} B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> Suc n}.\n                         f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (x + Suc n))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (rule ballI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> carr_prodag {i. i \\<le> Suc n} B; l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f l =\n                         augm_func n (restrict f {i. i \\<le> n})\n                          (Un_carrier {i. i \\<le> n} B) (Suc 0)\n                          (\\<lambda>x\\<in>{0}. f (Suc (x + n)))\n                          (Un_carrier {0} (compose {0} B (slide (Suc n)))) l", "apply (simp add:augm_func_def sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> carr_prodag {i. i \\<le> Suc n} B; l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<not> l \\<le> n \\<longrightarrow> f l = f (Suc n)", "apply (rule impI, simp add:nat_not_le_less)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> carr_prodag {i. i \\<le> Suc n} B; l \\<le> Suc n;\n        n < l\\<rbrakk>\n       \\<Longrightarrow> f l = f (Suc n)", "apply (frule_tac n = l in Suc_leI[of n _])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        f \\<in> carr_prodag {i. i \\<le> Suc n} B; l \\<le> Suc n; n < l;\n        Suc n \\<le> l\\<rbrakk>\n       \\<Longrightarrow> f l = f (Suc n)", "apply (frule_tac m = l and n = \"Suc n\" in Nat.le_antisym, assumption+,\n         simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma A_to_prodag_mem:\"\\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);  \\<forall>k\\<in>I. (S k) \\<in> \n rHom A (B k); x \\<in> carrier A \\<rbrakk> \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> extensional I \\<and>\n                      A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> extensional I\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (simp add:A_to_prodag_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B x xa \\<in> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (simp add: A_to_prodag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (subgoal_tac \"(S xa) \\<in> rHom A (B xa)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa)\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S xa \\<in> rHom A (B xa)\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S xa \\<in> rHom A (B xa)\n 2. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa)\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa)\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (thin_tac \"\\<forall>k\\<in>I. S k \\<in> rHom A (B k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa)\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (frule_tac f = \"S xa\" and A = A and R = \"B xa\" in rHom_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa);\n        S xa x \\<in> carrier (B xa)\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k); x \\<in> carrier A;\n        xa \\<in> I; S xa \\<in> rHom A (B xa);\n        S xa x \\<in> carrier (B xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I.\n                         A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B x i \\<in> carrier (B i)", "apply (simp add:A_to_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S i x \\<in> carrier (B i)", "apply (rule_tac f = \"S i\" and A = A and R = \"B i\" and a = x in rHom_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S i \\<in> rHom A (B i)\n 2. \\<And>i.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma A_to_prodag_rHom:\"\\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k); \\<forall>k\\<in>I. (S k) \\<in> \n      rHom A (B k) \\<rbrakk>  \\<Longrightarrow> A_to_prodag A I S B \\<in> rHom A (r\\<Pi>\\<^bsub>I\\<^esub> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> rHom A (r\\<Pi>\\<^bsub>I\\<^esub> B)", "apply (simp add:rHom_def [of \"A\" \"r\\<Pi>\\<^bsub>I\\<^esub> B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> aHom A (r\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n                      (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> aHom A (r\\<Pi>\\<^bsub>I\\<^esub> B)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (cut_tac A_to_prodag_aHom[of A I B S])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> aHom A (r\\<Pi>\\<^bsub>I\\<^esub> B)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (subst aHom_def, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (r\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n                      A_to_prodag A I S B\n                      \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:prodrg_carrier)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n                      A_to_prodag A I S B\n                      \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B\n     \\<in> carrier A \\<rightarrow>\n           carrier (a\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n     A_to_prodag A I S B \\<in> extensional (carrier A) \\<and>\n     (\\<forall>a\\<in>carrier A.\n         \\<forall>b\\<in>carrier A.\n            A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n            A_to_prodag A I S B\n             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n            A_to_prodag A I S B b)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            A_to_prodag A I S B\n                             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B b =\n                            A_to_prodag A I S B\n                             a \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B b\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B\n     \\<in> carrier A \\<rightarrow>\n           carrier (a\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n     A_to_prodag A I S B \\<in> extensional (carrier A) \\<and>\n     (\\<forall>a\\<in>carrier A.\n         \\<forall>b\\<in>carrier A.\n            A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n            A_to_prodag A I S B\n             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n            A_to_prodag A I S B b)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            A_to_prodag A I S B\n                             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B b =\n                            prod_pOp I B (A_to_prodag A I S B a)\n                             (A_to_prodag A I S B b)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (cut_tac prodag_pOp[of I B], simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     A_to_prodag A I S B\n     \\<in> carrier A \\<rightarrow>\n           carrier (a\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n     A_to_prodag A I S B \\<in> extensional (carrier A) \\<and>\n     (\\<forall>a\\<in>carrier A.\n         \\<forall>b\\<in>carrier A.\n            A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n            A_to_prodag A I S B\n             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n            A_to_prodag A I S B b)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> aGroup A\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule ballI, simp add:Ring.ring_is_ag,\n        simp add:Ring.ring_is_ag,\n        rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); k \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S k \\<in> aHom A (B k)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             A_to_prodag A I S B\n                              x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B y) \\<and>\n                      A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         \\<forall>y\\<in>carrier A.\n                            A_to_prodag A I S B\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                            A_to_prodag A I S B\n                             x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B y\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         A_to_prodag A I S B\n                          x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B y\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (frule_tac x = x and y = y in Ring.ring_tOp_closed[of A], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         A_to_prodag A I S B\n                          x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B y\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (frule_tac x = \"x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y\" in A_to_prodag_mem[of A I B S], assumption+,\n        frule_tac x = x in A_to_prodag_mem[of A I B S], assumption+,\n        frule_tac x = y in A_to_prodag_mem[of A I B S], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         A_to_prodag A I S B\n                          x \\<cdot>\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B y\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:prodrg_tOp[of I B])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (frule_tac X = \"A_to_prodag A I S B x \" and Y = \"A_to_prodag A I S B y\"         in prod_tOp_mem[of I B], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (cut_tac X = \"A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\" and Y = \"prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\" in carr_prodag_mem_eq[of I B])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 2. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n                         \\<in> carr_prodag I B\n 3. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n                         \\<in> carr_prodag I B\n 4. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            A_to_prodag A I S B\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) l =\n                            prod_tOp I B (A_to_prodag A I S B x)\n                             (A_to_prodag A I S B y) l\n 5. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 6. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n                         \\<in> carr_prodag I B\n 2. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n                         \\<in> carr_prodag I B\n 3. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            A_to_prodag A I S B\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) l =\n                            prod_tOp I B (A_to_prodag A I S B x)\n                             (A_to_prodag A I S B y) l\n 4. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply assumption+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            A_to_prodag A I S B\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) l =\n                            prod_tOp I B (A_to_prodag A I S B x)\n                             (A_to_prodag A I S B y) l\n 2. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (rule ballI, simp add:prod_tOp_def A_to_prodag_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y l.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k x) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k y) \\<in> carr_prodag I B;\n        (\\<lambda>xa\\<in>I.\n            (if xa \\<in> I then S xa x\n             else undefined) \\<cdot>\\<^sub>r\\<^bsub>B xa\\<^esub>\n            (if xa \\<in> I then S xa y else undefined))\n        \\<in> carr_prodag I B;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S l (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         S l x \\<cdot>\\<^sub>r\\<^bsub>B l\\<^esub> S l y\n 2. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. Ring (B k)\",\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. S k \\<in> rHom A (B k)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y l.\n       \\<lbrakk>Ring A; x \\<in> carrier A; y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k x) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k y) \\<in> carr_prodag I B;\n        (\\<lambda>xa\\<in>I.\n            (if xa \\<in> I then S xa x\n             else undefined) \\<cdot>\\<^sub>r\\<^bsub>B xa\\<^esub>\n            (if xa \\<in> I then S xa y else undefined))\n        \\<in> carr_prodag I B;\n        l \\<in> I; Ring (B l); S l \\<in> rHom A (B l)\\<rbrakk>\n       \\<Longrightarrow> S l (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         S l x \\<cdot>\\<^sub>r\\<^bsub>B l\\<^esub> S l y\n 2. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:rHom_tOp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k); x \\<in> carrier A;\n        y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B x \\<in> carr_prodag I B;\n        A_to_prodag A I S B y \\<in> carr_prodag I B;\n        prod_tOp I B (A_to_prodag A I S B x) (A_to_prodag A I S B y)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n        prod_tOp I B (A_to_prodag A I S B x)\n         (A_to_prodag A I S B y)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         prod_tOp I B (A_to_prodag A I S B x)\n                          (A_to_prodag A I S B y)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>r\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>", "apply (simp add:prodrg_one[of I B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (frule prod_one_func[of I B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (frule Ring.ring_one[of A],\n        frule_tac x = \"1\\<^sub>r\\<^bsub>A\\<^esub>\" in A_to_prodag_mem[of A I B S], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (cut_tac X = \"A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\" and Y = \"prod_one I B\" in \n        carr_prodag_mem_eq[of I B])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>I. aGroup (B k)\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n                      \\<in> carr_prodag I B\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I B \\<in> carr_prodag I B\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I.\n                         A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> l =\n                         prod_one I B l\n 5. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (rule ballI, simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n                      \\<in> carr_prodag I B\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_one I B \\<in> carr_prodag I B\n 3. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I.\n                         A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> l =\n                         prod_one I B l\n 4. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n     \\<in> carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<in>I.\n                         A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> l =\n                         prod_one I B l\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n        prod_one I B \\<in> carr_prodag I B;\n        1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n        A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n        \\<in> carr_prodag I B;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> l =\n                         prod_one I B l\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (subst A_to_prodag_def, simp add:prod_one_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n        \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n        (\\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>B x\\<^esub>)\n        \\<in> carr_prodag I B;\n        1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n        A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n        \\<in> carr_prodag I B;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S l 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                         1\\<^sub>r\\<^bsub>B l\\<^esub>\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. Ring (B k)\",\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. S k \\<in> rHom A (B k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>Ring A;\n        (\\<lambda>x\\<in>I. 1\\<^sub>r\\<^bsub>B x\\<^esub>)\n        \\<in> carr_prodag I B;\n        1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n        A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub>\n        \\<in> carr_prodag I B;\n        l \\<in> I; Ring (B l); S l \\<in> rHom A (B l)\\<rbrakk>\n       \\<Longrightarrow> S l 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                         1\\<^sub>r\\<^bsub>B l\\<^esub>\n 2. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply (simp add:rHom_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<in>I. Ring (B k);\n     \\<forall>k\\<in>I. S k \\<in> rHom A (B k);\n     prod_one I B \\<in> carr_prodag I B;\n     1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carrier A;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> \\<in> carr_prodag I B;\n     A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> = prod_one I B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      prod_one I B", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ac_fProd_ProdTr1:\"\\<forall>k \\<le> (Suc n). Ring (B k) \\<Longrightarrow> \n ag_setfunc n B (Suc 0) (compose {0::nat} B (slide (Suc n))) \n   (carr_prodag {i. i \\<le> n} B) (carr_prodag {0} \n     (compose {0} B (slide (Suc n)))) \\<subseteq>  carr_prodag {i. i \\<le> (Suc n)} B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>Suc n. Ring (B k) \\<Longrightarrow>\n    ag_setfunc n B (Suc 0) (compose {0} B (slide (Suc n)))\n     (carr_prodag {i. i \\<le> n} B)\n     (carr_prodag {0} (compose {0} B (slide (Suc n))))\n    \\<subseteq> carr_prodag {i. i \\<le> Suc n} B", "supply [[simproc del: defined_all]]"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>Suc n. Ring (B k) \\<Longrightarrow>\n    ag_setfunc n B (Suc 0) (compose {0} B (slide (Suc n)))\n     (carr_prodag {i. i \\<le> n} B)\n     (carr_prodag {0} (compose {0} B (slide (Suc n))))\n    \\<subseteq> carr_prodag {i. i \\<le> Suc n} B", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        x \\<in> ag_setfunc n B (Suc 0) (compose {0} B (slide (Suc n)))\n                 (carr_prodag {i. i \\<le> n} B)\n                 (carr_prodag {0} (compose {0} B (slide (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag {i. i \\<le> Suc n} B", "apply (simp add:ag_setfunc_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        \\<exists>g.\n           g \\<in> carr_prodag {i. i \\<le> n} B \\<and>\n           (\\<exists>h.\n               h \\<in> carr_prodag {0}\n                        (compose {0} B (slide (Suc n))) \\<and>\n               x =\n               augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0) h\n                (Un_carrier {0} (compose {0} B (slide (Suc n)))))\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag {i. i \\<le> Suc n} B", "apply (erule exE, erule conjE, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x =\n        augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0) h\n         (Un_carrier {0} (compose {0} B (slide (Suc n))))\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag {i. i \\<le> Suc n} B", "apply (simp,\n       thin_tac \"x =\n        augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0) h\n         (Un_carrier {0} (compose {0} B (slide (Suc n))))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> carr_prodag {i. i \\<le> Suc n} B", "apply (simp add:carr_prodag_def [of \"{j. j \\<le> (Suc n)}\" \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> extensional {i. i \\<le> Suc n} \\<and>\n                         augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                               Un_carrier {i. i \\<le> Suc n} B \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             augm_func n g (Un_carrier {j. j \\<le> n} B)\n                              (Suc 0) h\n                              (Un_carrier {0}\n                                (compose {0} B (slide (Suc n))))\n                              i\n                             \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> extensional {i. i \\<le> Suc n}\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                               Un_carrier {i. i \\<le> Suc n} B \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             augm_func n g (Un_carrier {j. j \\<le> n} B)\n                              (Suc 0) h\n                              (Un_carrier {0}\n                                (compose {0} B (slide (Suc n))))\n                              i\n                             \\<in> carrier (B i))", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                               Un_carrier {i. i \\<le> Suc n} B \\<and>\n                         (\\<forall>i\\<le>Suc n.\n                             augm_func n g (Un_carrier {j. j \\<le> n} B)\n                              (Suc 0) h\n                              (Un_carrier {0}\n                                (compose {0} B (slide (Suc n))))\n                              i\n                             \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                         \\<in> {i. i \\<le> Suc n} \\<rightarrow>\n                               Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             x\n                            \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> x \\<le> Suc n \\<longrightarrow>\n                         augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                          x\n                         \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                          x\n                         \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (case_tac \"x \\<le> n\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> extensional {i. i \\<le> n} \\<and>\n        g \\<in> {i. i \\<le> n} \\<rightarrow>\n                Un_carrier {i. i \\<le> n} B \\<and>\n        (\\<forall>i\\<le>n. g i \\<in> carrier (B i));\n        h \\<in> extensional {0} \\<and>\n        h 0 \\<in> Un_carrier {0} (compose {0} B (slide (Suc n))) \\<and>\n        h 0 \\<in> carrier (compose {0} B (slide (Suc n)) 0);\n        x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (erule conjE)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> n;\n        g \\<in> extensional {i. i \\<le> n}; h \\<in> extensional {0};\n        g \\<in> {i. i \\<le> n} \\<rightarrow> Un_carrier {i. i \\<le> n} B;\n        \\<forall>i\\<le>n. g i \\<in> carrier (B i);\n        h 0 \\<in> Un_carrier {0} (compose {0} B (slide (Suc n)));\n        h 0 \\<in> carrier (compose {0} B (slide (Suc n)) 0)\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (frule_tac x = x in mem_of_Nset [of _ \"n\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> n;\n        g \\<in> extensional {i. i \\<le> n}; h \\<in> extensional {0};\n        g \\<in> {i. i \\<le> n} \\<rightarrow> Un_carrier {i. i \\<le> n} B;\n        \\<forall>i\\<le>n. g i \\<in> carrier (B i);\n        h 0 \\<in> Un_carrier {0} (compose {0} B (slide (Suc n)));\n        h 0 \\<in> carrier (compose {0} B (slide (Suc n)) 0);\n        x \\<in> {i. i \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (frule_tac f = g and x = x in funcset_mem[of _ \"{j. j \\<le> n}\" \n                      \"Un_carrier {j. j \\<le> n} B\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> n;\n        g \\<in> extensional {i. i \\<le> n}; h \\<in> extensional {0};\n        g \\<in> {i. i \\<le> n} \\<rightarrow> Un_carrier {i. i \\<le> n} B;\n        \\<forall>i\\<le>n. g i \\<in> carrier (B i);\n        h 0 \\<in> Un_carrier {0} (compose {0} B (slide (Suc n)));\n        h 0 \\<in> carrier (compose {0} B (slide (Suc n)) 0);\n        x \\<in> {i. i \\<le> n};\n        g x \\<in> Un_carrier {j. j \\<le> n} B\\<rbrakk>\n       \\<Longrightarrow> g x \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 3. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:Un_carrier_def,\n        erule exE, erule conjE, erule exE, simp, erule conjE,\n        frule_tac x = i and y = n and z = \"Suc n\" in le_less_trans,\n        simp, \n        frule_tac x = i and y = \"Suc n\" in less_imp_le, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (x \\<le> n \\<longrightarrow>\n                          g x \\<in> Un_carrier {i. i \\<le> Suc n} B) \\<and>\n                         (\\<not> x \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) x)\n                          \\<in> Un_carrier {i. i \\<le> Suc n} B)\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        x \\<le> Suc n; \\<not> x \\<le> n\\<rbrakk>\n       \\<Longrightarrow> h 0 \\<in> Un_carrier {i. i \\<le> Suc n} B\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:carr_prodag_def Un_carrier_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        \\<not> x \\<le> n; g \\<in> extensional {i. i \\<le> n};\n        h \\<in> extensional {0};\n        h 0 \\<in> carrier (compose {0} B (slide (Suc n)) 0);\n        g \\<in> {i. i \\<le> n} \\<rightarrow>\n                \\<Union> {X. \\<exists>i\\<le>n. X = carrier (B i)};\n        \\<forall>i\\<le>n. g i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i\\<le>Suc n. x = carrier (B i)) \\<and>\n                            h 0 \\<in> x\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (simp add:compose_def slide_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h x.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k); x \\<le> Suc n;\n        \\<not> x \\<le> n; g \\<in> extensional {i. i \\<le> n};\n        h \\<in> extensional {0}; h 0 \\<in> carrier (B (Suc n));\n        g \\<in> {i. i \\<le> n} \\<rightarrow>\n                \\<Union> {X. \\<exists>i\\<le>n. X = carrier (B i)};\n        \\<forall>i\\<le>n. g i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i\\<le>Suc n. x = carrier (B i)) \\<and>\n                            h 0 \\<in> x\n 2. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (cut_tac n_in_Nsetn[of \"Suc n\"], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                            augm_func n g (Un_carrier {j. j \\<le> n} B)\n                             (Suc 0) h\n                             (Un_carrier {0}\n                               (compose {0} B (slide (Suc n))))\n                             i\n                            \\<in> carrier (B i)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> augm_func n g (Un_carrier {j. j \\<le> n} B) (Suc 0)\n                          h (Un_carrier {0} (compose {0} B (slide (Suc n))))\n                          i\n                         \\<in> carrier (B i)", "apply (simp add:augm_func_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (i \\<le> n \\<longrightarrow>\n                          g i \\<in> carrier (B i)) \\<and>\n                         (\\<not> i \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) i) \\<in> carrier (B i))", "apply (case_tac \"i \\<le> n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> g i \\<in> carrier (B i)\n 2. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (i \\<le> n \\<longrightarrow>\n                          g i \\<in> carrier (B i)) \\<and>\n                         (\\<not> i \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) i) \\<in> carrier (B i))", "apply (simp add:carr_prodag_def [of \"{i. i \\<le> n}\" _])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> (i \\<le> n \\<longrightarrow>\n                          g i \\<in> carrier (B i)) \\<and>\n                         (\\<not> i \\<le> n \\<longrightarrow>\n                          h (sliden (Suc n) i) \\<in> carrier (B i))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        g \\<in> carr_prodag {i. i \\<le> n} B;\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> h (sliden (Suc n) i) \\<in> carrier (B i)", "apply (thin_tac \"g \\<in> carr_prodag {i. i \\<le> n} B\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i \\<le> Suc n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> h (sliden (Suc n) i) \\<in> carrier (B i)", "apply (simp add: not_less [symmetric, of _ n],\n        frule_tac n = i in Suc_leI[of n],\n        frule_tac m = i and n = \"Suc n\" in le_antisym, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h i.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. Ring (B k);\n        h \\<in> carr_prodag {0} (compose {0} B (slide (Suc n)));\n        i = Suc n\\<rbrakk>\n       \\<Longrightarrow> h (sliden (Suc n) (Suc n))\n                         \\<in> carrier (B (Suc n))", "apply (simp add:carr_prodag_def compose_def slide_def sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ac_fProd_Prod:\"\\<forall>k \\<le> n. Ring (B k) \\<Longrightarrow> \n                      ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>n. Ring (B k) \\<Longrightarrow>\n    ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B", "apply (case_tac \"n = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n = 0\\<rbrakk>\n    \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B", "apply (subgoal_tac \"\\<exists>m. n = Suc m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n     \\<exists>m. n = Suc m\\<rbrakk>\n    \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (subgoal_tac \"\\<forall>m. n = Suc m \\<longrightarrow> \n                     ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n     \\<exists>m. n = Suc m;\n     \\<forall>m.\n        n = Suc m \\<longrightarrow>\n        ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\\<rbrakk>\n    \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n     \\<exists>m. n = Suc m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m.\n                         n = Suc m \\<longrightarrow>\n                         ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n     \\<exists>m. n = Suc m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m.\n                         n = Suc m \\<longrightarrow>\n                         ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (thin_tac \"\\<exists>m. n = Suc m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<forall>m.\n                         n = Suc m \\<longrightarrow>\n                         ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m.\n       \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n        n = Suc m\\<rbrakk>\n       \\<Longrightarrow> ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp, thin_tac \"n = Suc m\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m.\n       \\<forall>k\\<le>Suc m. Ring (B k) \\<Longrightarrow>\n       ag_setfunc m B (Suc 0) (compose {0} B (slide (Suc m)))\n        (carr_prodag {j. j \\<le> m} B)\n        (carr_prodag {0} (compose {0} B (slide (Suc m)))) =\n       carr_prodag {j. j \\<le> Suc m} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m.\n       \\<forall>k\\<le>Suc m. Ring (B k) \\<Longrightarrow>\n       ag_setfunc m B (Suc 0) (compose {0} B (slide (Suc m)))\n        (carr_prodag {j. j \\<le> m} B)\n        (carr_prodag {0} (compose {0} B (slide (Suc m))))\n       \\<subseteq> carr_prodag {j. j \\<le> Suc m} B\n 2. \\<And>m.\n       \\<forall>k\\<le>Suc m. Ring (B k) \\<Longrightarrow>\n       carr_prodag {j. j \\<le> Suc m} B\n       \\<subseteq> ag_setfunc m B (Suc 0) (compose {0} B (slide (Suc m)))\n                    (carr_prodag {j. j \\<le> m} B)\n                    (carr_prodag {0} (compose {0} B (slide (Suc m))))\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:ac_fProd_ProdTr1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m.\n       \\<forall>k\\<le>Suc m. Ring (B k) \\<Longrightarrow>\n       carr_prodag {j. j \\<le> Suc m} B\n       \\<subseteq> ag_setfunc m B (Suc 0) (compose {0} B (slide (Suc m)))\n                    (carr_prodag {j. j \\<le> m} B)\n                    (carr_prodag {0} (compose {0} B (slide (Suc m))))\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m x.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        x \\<in> carr_prodag {j. j \\<le> Suc m} B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ag_setfunc m B (Suc 0)\n                                  (compose {0} B (slide (Suc m)))\n                                  (carr_prodag {j. j \\<le> m} B)\n                                  (carr_prodag {0}\n                                    (compose {0} B (slide (Suc m))))\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rename_tac m f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B\\<rbrakk>\n       \\<Longrightarrow> f \\<in> ag_setfunc m B (Suc 0)\n                                  (compose {0} B (slide (Suc m)))\n                                  (carr_prodag {j. j \\<le> m} B)\n                                  (carr_prodag {0}\n                                    (compose {0} B (slide (Suc m))))\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (frule augm_funcTr, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (x + Suc m))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> f \\<in> ag_setfunc m B (Suc 0)\n                                  (compose {0} B (slide (Suc m)))\n                                  (carr_prodag {j. j \\<le> m} B)\n                                  (carr_prodag {0}\n                                    (compose {0} B (slide (Suc m))))\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:ag_setfunc_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g.\n                            g \\<in> carr_prodag {j. j \\<le> m} B \\<and>\n                            (\\<exists>h.\n                                h \\<in> carr_prodag {0}\n   (compose {0} B (slide (Suc m))) \\<and>\n                                f =\n                                augm_func m g (Un_carrier {j. j \\<le> m} B)\n                                 (Suc 0) h\n                                 (Un_carrier {0}\n                                   (compose {0} B (slide (Suc m)))))\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (subgoal_tac \"(restrict f {j. j \\<le> m}) \\<in> carr_prodag {j. j \\<le> m} B\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))));\n        restrict f {j. j \\<le> m}\n        \\<in> carr_prodag {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g.\n                            g \\<in> carr_prodag {j. j \\<le> m} B \\<and>\n                            (\\<exists>h.\n                                h \\<in> carr_prodag {0}\n   (compose {0} B (slide (Suc m))) \\<and>\n                                f =\n                                augm_func m g (Un_carrier {j. j \\<le> m} B)\n                                 (Suc 0) h\n                                 (Un_carrier {0}\n                                   (compose {0} B (slide (Suc m)))))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (subgoal_tac \"(\\<lambda>x\\<in>{0::nat}. f (Suc (x + m))) \\<in>  carr_prodag {0}\n                           (compose {0} B (slide (Suc m)))\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))));\n        restrict f {j. j \\<le> m} \\<in> carr_prodag {j. j \\<le> m} B;\n        (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n        \\<in> carr_prodag {0} (compose {0} B (slide (Suc m)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>g.\n                            g \\<in> carr_prodag {j. j \\<le> m} B \\<and>\n                            (\\<exists>h.\n                                h \\<in> carr_prodag {0}\n   (compose {0} B (slide (Suc m))) \\<and>\n                                f =\n                                augm_func m g (Un_carrier {j. j \\<le> m} B)\n                                 (Suc 0) h\n                                 (Un_carrier {0}\n                                   (compose {0} B (slide (Suc m)))))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))));\n        restrict f {j. j \\<le> m}\n        \\<in> carr_prodag {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n                         \\<in> carr_prodag {0}\n                                (compose {0} B (slide (Suc m)))\n 3. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 4. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))));\n        restrict f {j. j \\<le> m}\n        \\<in> carr_prodag {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n                         \\<in> carr_prodag {0}\n                                (compose {0} B (slide (Suc m)))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (thin_tac \"f =\n           augm_func m (restrict f {i. i \\<le> m}) (Un_carrier {i. i \\<le> m} B)\n            (Suc 0) (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n            (Un_carrier {0} (compose {0} B (slide (Suc m))))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        restrict f {j. j \\<le> m}\n        \\<in> carr_prodag {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n                         \\<in> carr_prodag {0}\n                                (compose {0} B (slide (Suc m)))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        restrict f {j. j \\<le> m}\n        \\<in> {j. j \\<le> m} \\<rightarrow>\n              Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> Un_carrier {0}\n                                (compose {0} B (slide (Suc m))) \\<and>\n                         f (Suc m)\n                         \\<in> carrier (compose {0} B (slide (Suc m)) 0)\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule conjI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        restrict f {j. j \\<le> m}\n        \\<in> {j. j \\<le> m} \\<rightarrow>\n              Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> Un_carrier {0}\n                                (compose {0} B (slide (Suc m)))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        restrict f {j. j \\<le> m}\n        \\<in> {j. j \\<le> m} \\<rightarrow>\n              Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> carrier (compose {0} B (slide (Suc m)) 0)\n 3. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 4. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:Pi_def restrict_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        (\\<forall>x\\<le>Suc m.\n            f x \\<in> Un_carrier {j. j \\<le> Suc m} B) \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        \\<forall>x\\<le>m. f x \\<in> Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> Un_carrier {0}\n                                (compose {0} B (slide (Suc m)))\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        restrict f {j. j \\<le> m}\n        \\<in> {j. j \\<le> m} \\<rightarrow>\n              Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> carrier (compose {0} B (slide (Suc m)) 0)\n 3. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 4. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:Un_carrier_def compose_def slide_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        restrict f {j. j \\<le> m}\n        \\<in> {j. j \\<le> m} \\<rightarrow>\n              Un_carrier {j. j \\<le> m} B\\<rbrakk>\n       \\<Longrightarrow> f (Suc m)\n                         \\<in> carrier (compose {0} B (slide (Suc m)) 0)\n 2. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 3. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:compose_def slide_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B;\n        f =\n        augm_func m (restrict f {i. i \\<le> m})\n         (Un_carrier {i. i \\<le> m} B) (Suc 0)\n         (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n         (Un_carrier {0} (compose {0} B (slide (Suc m))))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (thin_tac \"f =\n           augm_func m (restrict f {i. i \\<le> m}) (Un_carrier {i. i \\<le> m} B)\n            (Suc 0) (\\<lambda>x\\<in>{0}. f (Suc (x + m)))\n            (Un_carrier {0} (compose {0} B (slide (Suc m))))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> carr_prodag {j. j \\<le> Suc m} B\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> carr_prodag {j. j \\<le> m} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                Un_carrier {j. j \\<le> Suc m} B \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> {j. j \\<le> m} \\<rightarrow>\n                               Un_carrier {j. j \\<le> m} B\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        f \\<in> {j. j \\<le> Suc m} \\<rightarrow>\n                \\<Union> {X. \\<exists>i\\<le>Suc m. X = carrier (B i)} \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i))\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> m}\n                         \\<in> {j. j \\<le> m} \\<rightarrow>\n                               \\<Union>\n                                {X. \\<exists>i\\<le>m. X = carrier (B i)}\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        (\\<forall>x\\<le>Suc m.\n            \\<exists>xa.\n               (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n               f x \\<in> xa) \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<le>m.\n                            \\<exists>xa.\n                               (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                               f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        (\\<forall>x\\<le>Suc m.\n            \\<exists>xa.\n               (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n               f x \\<in> xa) \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i))\\<rbrakk>\n       \\<Longrightarrow> x \\<le> m \\<longrightarrow>\n                         (\\<exists>xa.\n                             (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                             f x \\<in> xa)\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k);\n        f \\<in> extensional {j. j \\<le> Suc m} \\<and>\n        (\\<forall>x\\<le>Suc m.\n            \\<exists>xa.\n               (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n               f x \\<in> xa) \\<and>\n        (\\<forall>i\\<le>Suc m. f i \\<in> carrier (B i));\n        x \\<le> m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x.\n       \\<lbrakk>\\<forall>k\\<le>Suc m. Ring (B k); x \\<le> m;\n        f \\<in> extensional {j. j \\<le> Suc m};\n        \\<forall>x\\<le>Suc m.\n           \\<exists>xa.\n              (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n              f x \\<in> xa;\n        \\<forall>i\\<le>Suc m. f i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (rotate_tac 1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x.\n       \\<lbrakk>x \\<le> m; f \\<in> extensional {j. j \\<le> Suc m};\n        \\<forall>x\\<le>Suc m.\n           \\<exists>xa.\n              (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n              f x \\<in> xa;\n        \\<forall>i\\<le>Suc m. f i \\<in> carrier (B i);\n        \\<forall>k\\<le>Suc m. Ring (B k)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (frule_tac a = x in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x.\n       \\<lbrakk>x \\<le> m; f \\<in> extensional {j. j \\<le> Suc m};\n        \\<forall>x\\<le>Suc m.\n           \\<exists>xa.\n              (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n              f x \\<in> xa;\n        \\<forall>i\\<le>Suc m. f i \\<in> carrier (B i);\n        \\<forall>k\\<le>Suc m. Ring (B k);\n        \\<exists>xa.\n           (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n           f x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (erule exE,\n        thin_tac \"\\<forall>x\\<le>Suc m. \\<exists>xa. (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and> f x \\<in> xa\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x xa.\n       \\<lbrakk>x \\<le> m; f \\<in> extensional {j. j \\<le> Suc m};\n        \\<forall>i\\<le>Suc m. f i \\<in> carrier (B i);\n        \\<forall>k\\<le>Suc m. Ring (B k);\n        (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and>\n        f x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (frule_tac a = x in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m f x xa.\n       \\<lbrakk>x \\<le> m; f \\<in> extensional {j. j \\<le> Suc m};\n        \\<forall>i\\<le>Suc m. f i \\<in> carrier (B i);\n        \\<forall>k\\<le>Suc m. Ring (B k);\n        (\\<exists>i\\<le>Suc m. xa = carrier (B i)) \\<and> f x \\<in> xa;\n        f x \\<in> carrier (B x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>m. xa = carrier (B i)) \\<and>\n                            f x \\<in> xa\n 2. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply (cut_tac t = n in Suc_pred[THEN sym], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k); n \\<noteq> 0;\n     n = Suc (n - Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>m. n = Suc m", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>A direct product of a finite number of rings defined with\n \\<open>ac_fProd_Rg\\<close> is equal to that defined by using \\<open>carr_prodag\\<close>.\\<close>"], ["", "definition\n fprodrg :: \"[nat, nat \\<Rightarrow> ('a, 'more) Ring_scheme] \\<Rightarrow> \n  \\<lparr>carrier:: (nat \\<Rightarrow> 'a) set, pop::[(nat \\<Rightarrow> 'a), (nat \\<Rightarrow> 'a)]\n   \\<Rightarrow> (nat \\<Rightarrow> 'a), mop:: (nat \\<Rightarrow> 'a) \\<Rightarrow> (nat \\<Rightarrow> 'a), zero::(nat \\<Rightarrow> 'a), \n   tp :: [(nat \\<Rightarrow> 'a), (nat \\<Rightarrow> 'a)] \\<Rightarrow> (nat \\<Rightarrow> 'a), un :: (nat \\<Rightarrow> 'a) \\<rparr>\" where\n  \n  \"fprodrg n B = \\<lparr> carrier = ac_fProd_Rg n B,\n     pop = \\<lambda>f. \\<lambda>g. prod_pOp {i. i \\<le> n} B f g, mop = \\<lambda>f. prod_mOp {i. i \\<le> n} B f,\n     zero = prod_zero {i. i \\<le> n} B, tp =  \\<lambda>f. \\<lambda>g. prod_tOp {i. i \\<le> n} B f g, \n     un = prod_one {i. i \\<le> n} B \\<rparr>\""], ["", "definition\n  fPRoject ::\"[nat, nat \\<Rightarrow> ('a, 'more) Ring_scheme, nat]\n                   \\<Rightarrow> (nat \\<Rightarrow> 'a) \\<Rightarrow> 'a\" where\n  \"fPRoject n B x = (\\<lambda>f\\<in>ac_fProd_Rg n B. f x)\""], ["", "lemma fprodrg_ring:\"\\<forall>k \\<le> n. Ring (B k) \\<Longrightarrow> Ring (fprodrg n B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>n. Ring (B k) \\<Longrightarrow> Ring (fprodrg n B)", "apply (simp add:fprodrg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>n. Ring (B k) \\<Longrightarrow>\n    Ring\n     \\<lparr>carrier = ac_fProd_Rg n B, pop = prod_pOp {i. i \\<le> n} B,\n        mop = prod_mOp {i. i \\<le> n} B, zero = prod_zero {i. i \\<le> n} B,\n        tp = prod_tOp {i. i \\<le> n} B,\n        un = prod_one {i. i \\<le> n} B\\<rparr>", "apply (frule ac_fProd_Prod)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k);\n     ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\\<rbrakk>\n    \\<Longrightarrow> Ring\n                       \\<lparr>carrier = ac_fProd_Rg n B,\n                          pop = prod_pOp {i. i \\<le> n} B,\n                          mop = prod_mOp {i. i \\<le> n} B,\n                          zero = prod_zero {i. i \\<le> n} B,\n                          tp = prod_tOp {i. i \\<le> n} B,\n                          un = prod_one {i. i \\<le> n} B\\<rparr>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k);\n     ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\\<rbrakk>\n    \\<Longrightarrow> Ring\n                       \\<lparr>carrier = carr_prodag {j. j \\<le> n} B,\n                          pop = prod_pOp {i. i \\<le> n} B,\n                          mop = prod_mOp {i. i \\<le> n} B,\n                          zero = prod_zero {i. i \\<le> n} B,\n                          tp = prod_tOp {i. i \\<le> n} B,\n                          un = prod_one {i. i \\<le> n} B\\<rparr>", "apply (fold prodrg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. Ring (B k);\n     ac_fProd_Rg n B = carr_prodag {j. j \\<le> n} B\\<rbrakk>\n    \\<Longrightarrow> Ring (r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B)", "apply (simp add:prodrg_ring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Chinese remainder theorem\""], ["", "lemma Chinese_remTr1:\"\\<lbrakk>Ring A; \\<forall>k \\<le> (n::nat). ideal A (J k); \n \\<forall>k \\<le> n. B k = qring A (J k); \\<forall>k \\<le> n. S k = pj A (J k) \\<rbrakk> \\<Longrightarrow>\n   ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B)\\<^esub> (A_to_prodag A {j. j \\<le> n} S B) = \n                                        \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = (J k)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub>\n                                    B)\\<^esub> A_to_prodag A {j. j \\<le> n}\n          S B =\n                      \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub>\n                                    B)\\<^esub> A_to_prodag A {j. j \\<le> n}\n          S B\n                      \\<subseteq> \\<Inter>\n                                   {I. \\<exists>k\\<in>{j. j \\<le> n}.\n    I = J k}\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        x \\<in> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub>\n                              B)\\<^esub> A_to_prodag A {j. j \\<le> n} S\n    B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> \\<Inter>\n                                  {I. \\<exists>k\\<in>{j. j \\<le> n}.\n   I = J k}\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        x \\<in> carrier A \\<and>\n        A_to_prodag A {j. j \\<le> n} S B x =\n        \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow>\n                            x \\<in> xa\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        x \\<in> carrier A \\<and>\n        A_to_prodag A {j. j \\<le> n} S B x =\n        \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>;\n        \\<exists>k\\<le>n. xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (rename_tac a K, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a K.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); \\<exists>k\\<le>n. K = J k;\n        a \\<in> carrier A;\n        A_to_prodag A {j. j \\<le> n} S B a =\n        \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<in> K\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (simp add:prodrg_def, simp add:A_to_prodag_def prod_one_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a K.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); \\<exists>k\\<le>n. K = J k;\n        a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) =\n        prod_zero {j. j \\<le> n} B\\<rbrakk>\n       \\<Longrightarrow> a \\<in> K\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> K\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (subgoal_tac \"(\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k = (\\<lambda>x\\<in>{j. j \\<le> n}. \\<zero>\\<^bsub>B x\\<^esub>) k\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n        (\\<lambda>x\\<in>{j. j \\<le> n}. \\<zero>\\<^bsub>B x\\<^esub>)\n         k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> K\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (thin_tac \"(\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n        (\\<lambda>x\\<in>{j. j \\<le> n}. \\<zero>\\<^bsub>B x\\<^esub>)\n         k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> K\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k;\n        pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (frule_tac I = \"J k\" in Ring.qring_zero [of \"A\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k;\n        pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> ideal A (J k)\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 3. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 4. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (frule_tac I = \"J k\" and x = a in pj_mem [of \"A\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k\\<rbrakk>\n       \\<Longrightarrow> ideal A (J k)\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier A\n 3. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 4. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 5. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier A\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 3. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 4. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply assumption"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; pj A (J k) a = \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub>;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (frule_tac I = \"J k\" and a = a in Ring.a_in_ar_coset [of \"A\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = J k\\<rbrakk>\n       \\<Longrightarrow> ideal A (J k)\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier A\n 3. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k; pj A (J k) a = J k;\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 4. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 5. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k;\n        pj A (J k) a = J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier A\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k; pj A (J k) a = J k;\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 3. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 4. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply assumption"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A; k \\<le> n;\n        K = J k; a \\<uplus>\\<^bsub>A\\<^esub> J k = J k;\n        \\<zero>\\<^bsub>A /\\<^sub>r J k\\<^esub> = J k; pj A (J k) a = J k;\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> J k\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k\n 2. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 3. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a K k.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k); a \\<in> carrier A;\n        (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) = prod_zero {j. j \\<le> n} B;\n        k \\<le> n; K = J k\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k a) k =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                          k\n 2. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (simp add:prod_zero_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n     \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n     \\<forall>k\\<le>n. S k = pj A (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\n                      \\<subseteq> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                         j \\<le> n}\\<^esub>\n          B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        x \\<in> \\<Inter>\n                 {I. \\<exists>k\\<in>{j. j \\<le> n}. I = J k}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> ker\\<^bsub>A,(r\\<Pi>\\<^bsub>{j.\n                        j \\<le> n}\\<^esub>\n         B)\\<^esub> A_to_prodag A {j. j \\<le> n} S B", "apply (simp add:CollectI ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A \\<and>\n                         A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (cut_tac Nset_inc_0[of n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        0 \\<in> {i. i \\<le> n}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A \\<and>\n                         A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (frule_tac a = \"J 0\" in forall_spec, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        0 \\<in> {i. i \\<le> n}; x \\<in> J 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A \\<and>\n                         A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (frule_tac x = 0 in spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier A \\<and>\n                         A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (frule_tac h = x in Ring.ideal_subset [of \"A\" \"J 0\"], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J 0; x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (thin_tac \"x \\<in> J 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A {j. j \\<le> n} S B x =\n                         \\<zero>\\<^bsub>r\\<Pi>\\<^bsub>{j. j \\<le> n}\\<^esub> B\\<^esub>", "apply (simp add:A_to_prodag_def prodrg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k x) =\n                         prod_zero {j. j \\<le> n} B", "apply (simp add:prod_zero_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k x) =\n                         (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)", "apply (rule funcset_eq [of _ \"{j. j \\<le> n}\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>k\\<in>{j. j \\<le> n}. S k x)\n                         \\<in> extensional {j. j \\<le> n}\n 2. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>{j. j \\<le> n}.\n                             \\<zero>\\<^bsub>B x\\<^esub>)\n                         \\<in> extensional {j. j \\<le> n}\n 3. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<in>{j. j \\<le> n}.\n                            (\\<lambda>k\\<in>{j. j \\<le> n}. S k x) xa =\n                            (\\<lambda>x\\<in>{j. j \\<le> n}.\n                                \\<zero>\\<^bsub>B x\\<^esub>)\n                             xa", "apply (simp add:extensional_def restrict_def)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa\\<le>n.\n                            pj A (J xa) x =\n                            \\<zero>\\<^bsub>A /\\<^sub>r J xa\\<^esub>", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> pj A (J xa) x =\n                         \\<zero>\\<^bsub>A /\\<^sub>r J xa\\<^esub>", "apply (simp add:Ring.qring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. ideal A (J k);\n        \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n\\<rbrakk>\n       \\<Longrightarrow> pj A (J xa) x = J xa", "apply (frule_tac a = xa in forall_spec, assumption,\n        thin_tac \"\\<forall>k \\<le> n. ideal A (J k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n; ideal A (J xa)\\<rbrakk>\n       \\<Longrightarrow> pj A (J xa) x = J xa", "apply (subst pj_mem [of \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n; ideal A (J xa)\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>A\\<^esub> J xa = J xa", "apply (frule_tac I = \"J xa\" and a = x in Ring.a_in_ar_coset [of \"A\"], \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n; ideal A (J xa);\n        x \\<in> x \\<uplus>\\<^bsub>A\\<^esub> J xa\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>A\\<^esub> J xa = J xa", "apply (rule_tac a = x and I = \"J xa\" in Ring.Qring_fix1 [of \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; \\<forall>k\\<le>n. B k = A /\\<^sub>r J k;\n        \\<forall>k\\<le>n. S k = pj A (J k);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> carrier A; xa \\<le> n; ideal A (J xa);\n        x \\<in> x \\<uplus>\\<^bsub>A\\<^esub> J xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_prod_int2Tr:\n\"((\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n (\\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))))\n  \\<longrightarrow> (\\<Inter> {I. \\<exists>k \\<le> (Suc n). I = (J k)} = ideal_n_prod R (Suc n) J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n    i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>k\\<le>Suc 0. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k} =\n    i\\<Pi>\\<^bsub>R,Suc 0\\<^esub> J\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>k\\<le>Suc 0. ideal R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<Longrightarrow>\n    \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k} =\n    i\\<Pi>\\<^bsub>R,Suc 0\\<^esub> J\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k} =\n                      i\\<Pi>\\<^bsub>R,Suc 0\\<^esub> J\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k} =\n                      J 0 \\<diamondsuit>\\<^sub>r J (Suc 0)\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (subst coprime_int_prod [THEN sym, of \"J 0\" \"J (Suc 0)\"], simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k} =\n                      J 0 \\<inter> J (Suc 0)\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (rule equalityI, rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        x \\<in> \\<Inter> {I. \\<exists>k\\<le>Suc 0. I = J k}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J 0 \\<inter> J (Suc 0)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> J 0 \\<inter> J (Suc 0)\n                      \\<subseteq> \\<Inter>\n                                   {I. \\<exists>k\\<le>Suc 0. I = J k}\n 3. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (simp, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> J 0 \\<inter> J (Suc 0)\n                      \\<subseteq> \\<Inter>\n                                   {I. \\<exists>k\\<le>Suc 0. I = J k}\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (rule subsetI, simp, rule allI, rule impI, erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa k.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        x \\<in> J 0; x \\<in> J (Suc 0); k \\<le> Suc 0; xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa k.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        x \\<in> J 0; x \\<in> J (Suc 0); k \\<le> Suc 0; xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J k\n 2. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (simp add:Nset_1_1, erule disjE, (simp del:ideal_n_prodSn)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n       (\\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)) \\<longrightarrow>\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J", "apply (subgoal_tac \"\\<Inter>{I. \\<exists>k \\<le> (Suc (Suc n)). I = J k} =\n              (\\<Inter>{I. \\<exists>k \\<le> (Suc n). I = J k}) \\<inter> (J (Suc (Suc n)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (subgoal_tac \"\\<Inter>{I. \\<exists>k \\<le> (Suc n). I = J k} = (i\\<Pi>\\<^bsub>R,(Suc n)\\<^esub> J)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "(* apply (simp del:ideal_n_prodSn)*)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (frule_tac n = \"Suc n\" and J = J in coprime_n_idealsTr4)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (simp del:ideal_n_prodSn)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter>\n                         J (Suc (Suc n)) =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (subst coprime_int_prod)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc (Suc n)))\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          (J (Suc (Suc n)))\n 4. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc\n    n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc (Suc n)) =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 5. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 6. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (rule n_prod_ideal)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n. ideal R (J k)\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc (Suc n)))\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n                          (J (Suc (Suc n)))\n 4. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc\n    n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc (Suc n)) =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 5. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 6. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (rule allI, simp, simp, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc (Suc n).\n                    \\<forall>j\\<le>Suc (Suc n).\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<inter> J (Suc (Suc n));\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n        i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc\n    n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc (Suc n)) =\n                         i\\<Pi>\\<^bsub>R,Suc (Suc n)\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (cut_tac n = \"Suc n\" in Nsetn_sub_mem1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j));\n        \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n        \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n        J (Suc (Suc n));\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n                (\\<forall>i\\<le>Suc n.\n                    \\<forall>j\\<le>Suc n.\n                       i \\<noteq> j \\<longrightarrow>\n                       coprime_ideals R (J i) (J j)) \\<longrightarrow>\n                \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc (Suc n).\n            \\<forall>j\\<le>Suc (Suc n).\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j))\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n                         \\<Inter>\n                          {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter>\n                         J (Suc (Suc n))", "apply (thin_tac \"(\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n         (\\<forall>i\\<le>Suc n. \\<forall>j\\<le>Suc n. i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j)) \\<longrightarrow>\n         \\<Inter>{I. \\<exists>k\\<le>Suc n. I = J k} = i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\",\n        thin_tac \"(\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n         (\\<forall>i\\<le>Suc (Suc n).\n             \\<forall>j\\<le>Suc (Suc n). i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k} =\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter> J (Suc (Suc n))", "apply (rule equalityI, rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n x.\n       \\<forall>xa.\n          (\\<exists>k\\<le>Suc (Suc n). xa = J k) \\<longrightarrow>\n          x \\<in> xa \\<Longrightarrow>\n       (\\<forall>xa.\n           (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow>\n           x \\<in> xa) \\<and>\n       x \\<in> J (Suc (Suc n))\n 2. \\<And>n.\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter> J (Suc (Suc n))\n       \\<subseteq> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k}", "apply (rule conjI,\n        rule allI, rule impI, erule exE, erule conjE, simp,\n        frule_tac a = xa in forall_spec,\n        frule_tac x = k and y = \"Suc n\" and z = \"Suc (Suc n)\" in \n        le_less_trans, simp,\n        frule_tac x = k and y = \"Suc (Suc n)\" in less_imp_le, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n x xa k.\n       \\<lbrakk>\\<forall>xa.\n                   (\\<exists>k\\<le>Suc (Suc n). xa = J k) \\<longrightarrow>\n                   x \\<in> xa;\n        k \\<le> Suc n; xa = J k; x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J k\n 2. \\<And>n x.\n       \\<forall>xa.\n          (\\<exists>k\\<le>Suc (Suc n). xa = J k) \\<longrightarrow>\n          x \\<in> xa \\<Longrightarrow>\n       x \\<in> J (Suc (Suc n))\n 3. \\<And>n.\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter> J (Suc (Suc n))\n       \\<subseteq> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n x.\n       \\<forall>xa.\n          (\\<exists>k\\<le>Suc (Suc n). xa = J k) \\<longrightarrow>\n          x \\<in> xa \\<Longrightarrow>\n       x \\<in> J (Suc (Suc n))\n 2. \\<And>n.\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter> J (Suc (Suc n))\n       \\<subseteq> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k}", "apply (frule_tac a = \"J (Suc (Suc n))\" in forall_spec,\n        cut_tac n = \"Suc (Suc n)\" in le_refl, blast, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} \\<inter> J (Suc (Suc n))\n       \\<subseteq> \\<Inter> {I. \\<exists>k\\<le>Suc (Suc n). I = J k}", "apply (rule subsetI, simp, rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>(\\<forall>xa.\n                    (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow>\n                    x \\<in> xa) \\<and>\n                x \\<in> J (Suc (Suc n));\n        \\<exists>k\\<le>Suc (Suc n). xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>k \\<le> Suc (Suc n) \\<and> xa = J k;\n        \\<forall>xa.\n           (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (erule conjE, \n        case_tac \"k = Suc (Suc n)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>\\<forall>xa.\n                   (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow>\n                   x \\<in> xa;\n        x \\<in> J (Suc (Suc n)); k \\<le> Suc (Suc n); xa = J k;\n        k \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (frule_tac m = k and n = \"Suc (Suc n)\" in noteq_le_less, assumption,\n        thin_tac \"k \\<le> Suc (Suc n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>\\<forall>xa.\n                   (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow>\n                   x \\<in> xa;\n        x \\<in> J (Suc (Suc n)); xa = J k; k \\<noteq> Suc (Suc n);\n        k < Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (frule_tac x = k and n = \"Suc n\" in Suc_less_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>\\<forall>xa.\n                   (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow>\n                   x \\<in> xa;\n        x \\<in> J (Suc (Suc n)); xa = J k; k \\<noteq> Suc (Suc n);\n        k < Suc (Suc n); k \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (frule_tac a = xa in forall_spec, \n        blast,\n        thin_tac \"\\<forall>xa. (\\<exists>k\\<le>Suc n. xa = J k) \\<longrightarrow> x \\<in> xa\",\n        simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_prod_int2:\"\\<lbrakk> \\<forall>k \\<le> (Suc n). ideal R (J k); \n \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk>\n \\<Longrightarrow> (\\<Inter> {I. \\<exists>k \\<le> (Suc n). I = (J k)} = ideal_n_prod R (Suc n) J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {I. \\<exists>k\\<le>Suc n. I = J k} =\n                      i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J", "apply (simp add:coprime_prod_int2Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) coprime_2_n:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n (qring R A) \\<Oplus>\\<^sub>r (qring R B) = r\\<Pi>\\<^bsub>{j. j \\<le> (Suc 0)}\\<^esub> (prodB1 (qring R A) (qring R B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B =\n                      r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub>\n                      prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)", "apply (simp add:Prod2Rg_def Nset_1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>In this and following lemmata, ideals A and B are of type \n       \\<open>('a, 'more) RingType_scheme\\<close>. Don't try \n       \\<open>(r\\<Pi>\\<^sub>(Nset n) B) \\<Oplus>\\<^sub>r B (Suc n)\\<close>\\<close>"], ["", "lemma (in Ring) A_to_prodag2_hom:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B\\<rbrakk>  \\<Longrightarrow> \n      A_to_prodag R {j. j \\<le> (Suc 0)} S (prodB1 (qring R A) (qring R B)) \\<in> \n      rHom R (qring R A \\<Oplus>\\<^sub>r qring R B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n                      \\<in> rHom R\n                             (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)", "apply (subst coprime_2_n [of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n                      \\<in> rHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub>\n                              prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))", "apply (rule A_to_prodag_rHom, rule Ring_axioms)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (case_tac \"k = 0\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}; k = 0\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}; k \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 3. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp add:prodB1_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = 0\\<rbrakk>\n       \\<Longrightarrow> Ring (R /\\<^sub>r A)\n 2. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}; k \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 3. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp add:qring_ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}; k \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<le> Suc 0; 0 < k\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (frule_tac n = k in Suc_leI[of 0], thin_tac \"0 < k\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<le> Suc 0; Suc 0 \\<le> k\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (frule_tac m = k and n = \"Suc 0\" in le_antisym, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<le> Suc 0; Suc 0 \\<le> k; k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> Ring (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp, simp add:prodB1_def, simp add:qring_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k \\<in> {j. j \\<le> Suc 0}\\<rbrakk>\n       \\<Longrightarrow> S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = 0 \\<or> k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = 0\\<rbrakk>\n       \\<Longrightarrow> S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp add:prodB1_def, rule pj_Hom, rule Ring_axioms, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> S k\n                         \\<in> rHom R\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)", "apply (simp, simp add:prodB1_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> pj R B \\<in> rHom R (R /\\<^sub>r B)", "apply (rule pj_Hom, rule Ring_axioms, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) A2coprime_rsurjecTr:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B\\<rbrakk> \\<Longrightarrow> \n      (carrier (qring R A \\<Oplus>\\<^sub>r qring R B)) = \n        carr_prodag {j. j \\<le> (Suc 0)} (prodB1 (qring R A) (qring R B))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B\\<rbrakk>\n    \\<Longrightarrow> carrier\n                       (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B) =\n                      carr_prodag {j. j \\<le> Suc 0}\n                       (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))", "apply (simp add:Prod2Rg_def prodrg_def Nset_1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) A2coprime_rsurjec:\"\\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; \n      S (Suc 0) = pj R B; coprime_ideals R A B\\<rbrakk> \\<Longrightarrow> \n      surjec\\<^bsub>R,((qring R A) \\<Oplus>\\<^sub>r (qring R B))\\<^esub> \n           (A_to_prodag R {j. j\\<le>(Suc 0)} S (prodB1 (qring R A) (qring R B)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(R /\\<^sub>r A \\<Oplus>\\<^sub>r\n R /\\<^sub>r\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S\n             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))", "apply (frule A_to_prodag2_hom [of \"A\" \"B\" \"S\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(R /\\<^sub>r A \\<Oplus>\\<^sub>r\n R /\\<^sub>r\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S\n             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n                      \\<in> aHom R\n                             (R /\\<^sub>r A \\<Oplus>\\<^sub>r\n                              R /\\<^sub>r B) \\<and>\n                      surj_to\n                       (A_to_prodag R {j. j \\<le> Suc 0} S\n                         (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)))\n                       (carrier R)\n                       (carrier\n                         (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B))", "apply (rule conjI, \n       simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> surj_to\n                       (A_to_prodag R {j. j \\<le> Suc 0} S\n                         (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)))\n                       (carrier R)\n                       (carrier\n                         (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B))", "apply (rule surj_to_test[of \"A_to_prodag R {j. j \\<le> (Suc 0)} S \n       (prodB1 (qring R A) (qring R B))\" \"carrier R\" \n        \"carrier (qring R A \\<Oplus>\\<^sub>r qring R B)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n                      \\<in> carrier R \\<rightarrow>\n                            carrier\n                             (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\n 2. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier\n(R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B).\n                         \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:rHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n     coprime_ideals R A B;\n     A_to_prodag R {j. j \\<le> Suc 0} S\n      (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n     \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier\n(R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B).\n                         \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        A_to_prodag R {j. j \\<le> Suc 0} S\n         (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B);\n        b \\<in> carrier\n                 (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (frule rHom_func[of \"A_to_prodag R {j. j \\<le> (Suc 0)} S \n                                   (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\" R],\n        thin_tac \"A_to_prodag R {j. j \\<le> (Suc 0)} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         \\<in> rHom R (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carrier (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B);\n        A_to_prodag R {j. j \\<le> Suc 0} S\n         (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carrier\n               (R /\\<^sub>r A \\<Oplus>\\<^sub>r R /\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:A2coprime_rsurjecTr[of A B S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {j. j \\<le> Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {j. j \\<le> Suc 0} S\n         (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {j. j \\<le> Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (frule_tac X = \"b 0\" and Y = \"b (Suc 0)\" in \n                  coprime_surjTr[of A B], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b 0 \\<in> carrier (R /\\<^sub>r A)\n 2. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b (Suc 0) \\<in> carrier (R /\\<^sub>r B)\n 3. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        \\<exists>r\\<in>carrier R.\n           pj R A r = b 0 \\<and> pj R B r = b (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:carr_prodag_def prodB1_def,\n        simp add:carr_prodag_def prodB1_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        \\<exists>r\\<in>carrier R.\n           pj R A r = b 0 \\<and> pj R B r = b (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R;\n        pj R A r = b 0 \\<and> pj R B r = b (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (frule_tac x = r in funcset_mem[of \"A_to_prodag R {0, Suc 0} S \n        (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\"\n         \"carrier R\" \"carr_prodag {0, Suc 0} (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (cut_tac X = \"A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\" \n        and Y = b in \n        carr_prodag_mem_eq[of \"{0, Suc 0}\" \"prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{0, Suc 0}.\n                            aGroup\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\n                         \\<in> carr_prodag {0, Suc 0}\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag {0, Suc 0}\n                                  (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 4. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 5. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (rule ballI)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>b r k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        k \\<in> {0, Suc 0}\\<rbrakk>\n       \\<Longrightarrow> aGroup (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\n                         \\<in> carr_prodag {0, Suc 0}\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag {0, Suc 0}\n                                  (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 4. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 5. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp, erule disjE)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>b r k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        k = 0\\<rbrakk>\n       \\<Longrightarrow> aGroup (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>b r k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> aGroup (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\n                         \\<in> carr_prodag {0, Suc 0}\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 4. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag {0, Suc 0}\n                                  (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 5. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 6. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:prodB1_def, fold prodB1_def, \n                                simp add:qring_ring Ring.ring_is_ag)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>b r k.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> aGroup (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B) k)\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\n                         \\<in> carr_prodag {0, Suc 0}\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag {0, Suc 0}\n                                  (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 4. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 5. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (simp add:prodB1_def, fold prodB1_def, \n                               simp add:qring_ring Ring.ring_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r\n                         \\<in> carr_prodag {0, Suc 0}\n                                (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag {0, Suc 0}\n                                  (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 4. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                            b l\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (rule ballI, simp, erule disjE, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b r l.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        l = 0\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r 0 =\n                         b 0\n 2. \\<And>b r l.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        l = Suc 0\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                         b l\n 3. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (subst A_to_prodag_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b r l.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        l = Suc 0\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S\n                          (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) r l =\n                         b l\n 2. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply (subst A_to_prodag_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b r.\n       \\<lbrakk>ideal R A; ideal R B; S 0 = pj R A; S (Suc 0) = pj R B;\n        coprime_ideals R A B;\n        b \\<in> carr_prodag {0, Suc 0}\n                 (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n        \\<in> carrier R \\<rightarrow>\n              carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        r \\<in> carrier R; pj R A r = b 0 \\<and> pj R B r = b (Suc 0);\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r\n        \\<in> carr_prodag {0, Suc 0}\n               (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B));\n        A_to_prodag R {0, Suc 0} S (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B))\n         r =\n        b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S\n                             (prodB1 (R /\\<^sub>r A) (R /\\<^sub>r B)) a =\n                            b", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod2_n_Tr1:\"\\<lbrakk>\\<forall>k \\<le> (Suc 0). ideal R (J k); \n      \\<forall>k \\<le> (Suc 0). B k = qring R (J k); \n      \\<forall>k \\<le> (Suc 0). S k = pj R (J k) \\<rbrakk>  \\<Longrightarrow> \n    A_to_prodag R {j. j \\<le> (Suc 0)} S \n            (prodB1 (qring R (J 0)) (qring R (J (Suc 0)))) = \n                               A_to_prodag R {j. j \\<le> (Suc 0)} S B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))) =\n                      A_to_prodag R {j. j \\<le> Suc 0} S B", "apply (subgoal_tac \"\\<forall>k \\<le> (Suc 0). (prodB1 (qring R (J 0)) (qring R (J (Suc 0)))) k = B k\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>k\\<le>Suc 0.\n        prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0)) k = B k\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S\n                       (prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))) =\n                      A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>Suc 0.\n                         prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          k =\n                         B k", "apply (simp add:A_to_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>Suc 0.\n                         prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          k =\n                         B k", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k); k \\<le> Suc 0\\<rbrakk>\n       \\<Longrightarrow> prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          k =\n                         B k", "apply (case_tac \"k = 0\", simp add:Nset_1_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k.\n                   (k = 0 \\<longrightarrow> ideal R (J 0)) \\<and>\n                   (k = Suc 0 \\<longrightarrow> ideal R (J (Suc 0)));\n        \\<forall>k.\n           (k = 0 \\<longrightarrow> B 0 = R /\\<^sub>r J 0) \\<and>\n           (k = Suc 0 \\<longrightarrow> B (Suc 0) = R /\\<^sub>r J (Suc 0));\n        \\<forall>k.\n           (k = 0 \\<longrightarrow> S 0 = pj R (J 0)) \\<and>\n           (k = Suc 0 \\<longrightarrow> S (Suc 0) = pj R (J (Suc 0)));\n        k = 0\\<rbrakk>\n       \\<Longrightarrow> prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          0 =\n                         R /\\<^sub>r J 0\n 2. \\<And>k.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k); k \\<le> Suc 0;\n        k \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          k =\n                         B k", "apply (simp add:prodB1_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k); k \\<le> Suc 0;\n        k \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          k =\n                         B k", "apply (simp add:Nset_1_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k.\n                   (k = 0 \\<longrightarrow> ideal R (J 0)) \\<and>\n                   (k = Suc 0 \\<longrightarrow> ideal R (J (Suc 0)));\n        \\<forall>k.\n           (k = 0 \\<longrightarrow> B 0 = R /\\<^sub>r J 0) \\<and>\n           (k = Suc 0 \\<longrightarrow> B (Suc 0) = R /\\<^sub>r J (Suc 0));\n        \\<forall>k.\n           (k = 0 \\<longrightarrow> S 0 = pj R (J 0)) \\<and>\n           (k = Suc 0 \\<longrightarrow> S (Suc 0) = pj R (J (Suc 0)));\n        k = Suc 0\\<rbrakk>\n       \\<Longrightarrow> prodB1 (R /\\<^sub>r J 0) (R /\\<^sub>r J (Suc 0))\n                          (Suc 0) =\n                         R /\\<^sub>r J (Suc 0)", "apply (simp add:prodB1_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) restrict_prod_Suc:\"\\<lbrakk>\\<forall>k \\<le> (Suc (Suc n)). ideal R (J k);\n        \\<forall>k \\<le> (Suc (Suc n)). B k = R /\\<^sub>r J k;\n        \\<forall>k \\<le> (Suc (Suc n)). S k = pj R (J k);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc (Suc n))}\\<^esub> B)\\<rbrakk> \\<Longrightarrow> \n        restrict f {j. j \\<le> (Suc n)} \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n     \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n     f \\<in> carrier\n              (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> restrict f {j. j \\<le> Suc n}\n                      \\<in> carrier\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)", "apply (cut_tac Nsetn_sub_mem1[of \"Suc n\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n     \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n     f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n     \\<forall>j.\n        j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n        j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n    \\<Longrightarrow> restrict f {j. j \\<le> Suc n}\n                      \\<in> carrier\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n     \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n     f \\<in> carr_prodag {j. j \\<le> Suc (Suc n)} B\\<rbrakk>\n    \\<Longrightarrow> restrict f {j. j \\<le> Suc n}\n                      \\<in> carr_prodag {j. j \\<le> Suc n} B", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n     \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n     f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             Un_carrier {j. j \\<le> Suc (Suc n)} B;\n     \\<forall>i\\<le>Suc (Suc n).\n        f i \\<in> carrier (R /\\<^sub>r J i)\\<rbrakk>\n    \\<Longrightarrow> restrict f {j. j \\<le> Suc n}\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            Un_carrier {j. j \\<le> Suc n} B", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n     \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n     f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             \\<Union>\n              {X. \\<exists>i\\<le>Suc (Suc n).\n                     X = carrier (R /\\<^sub>r J i)};\n     \\<forall>i\\<le>Suc (Suc n).\n        f i \\<in> carrier (R /\\<^sub>r J i)\\<rbrakk>\n    \\<Longrightarrow> restrict f {j. j \\<le> Suc n}\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            \\<Union>\n                             {X. \\<exists>i\\<le>Suc n.\n                                    X = carrier (R /\\<^sub>r J i)}", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        \\<forall>i\\<le>Suc (Suc n). f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> restrict f {j. j \\<le> Suc n} x\n                         \\<in> \\<Union>\n                                {X. \\<exists>i\\<le>Suc n.\n X = carrier (R /\\<^sub>r J i)}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        \\<forall>i\\<le>Suc (Suc n). f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply (frule_tac x = x in funcset_mem[of f \"{j. j \\<le> (Suc (Suc n))}\"\n        \"\\<Union>{X. \\<exists>i \\<le> (Suc (Suc n)). X = carrier (R /\\<^sub>r J i)}\"],\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        \\<forall>i\\<le>Suc (Suc n). f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n;\n        f x\n        \\<in> \\<Union>\n               {X. \\<exists>i\\<le>Suc (Suc n).\n                      X = carrier (R /\\<^sub>r J i)}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        \\<forall>i\\<le>Suc (Suc n). f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n;\n        \\<exists>xa.\n           (\\<exists>i\\<le>Suc (Suc n).\n               xa = carrier (R /\\<^sub>r J i)) \\<and>\n           f x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply (erule exE, erule conjE, erule exE, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa i.\n       \\<lbrakk>\\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        \\<forall>i\\<le>Suc (Suc n). f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n; f x \\<in> carrier (R /\\<^sub>r J i);\n        i \\<le> Suc (Suc n); xa = carrier (R /\\<^sub>r J i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply (rotate_tac -5)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa i.\n       \\<lbrakk>\\<forall>i\\<le>Suc (Suc n).\n                   f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n; f x \\<in> carrier (R /\\<^sub>r J i);\n        i \\<le> Suc (Suc n); xa = carrier (R /\\<^sub>r J i);\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply (frule_tac a = x in forall_spec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa i.\n       \\<lbrakk>\\<forall>i\\<le>Suc (Suc n).\n                   f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n; f x \\<in> carrier (R /\\<^sub>r J i);\n        i \\<le> Suc (Suc n); xa = carrier (R /\\<^sub>r J i);\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)}\\<rbrakk>\n       \\<Longrightarrow> x \\<le> Suc (Suc n)\n 2. \\<And>x xa i.\n       \\<lbrakk>\\<forall>i\\<le>Suc (Suc n).\n                   f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n; f x \\<in> carrier (R /\\<^sub>r J i);\n        i \\<le> Suc (Suc n); xa = carrier (R /\\<^sub>r J i);\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        f x \\<in> carrier (R /\\<^sub>r J x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa i.\n       \\<lbrakk>\\<forall>i\\<le>Suc (Suc n).\n                   f i \\<in> carrier (R /\\<^sub>r J i);\n        x \\<le> Suc n; f x \\<in> carrier (R /\\<^sub>r J i);\n        i \\<le> Suc (Suc n); xa = carrier (R /\\<^sub>r J i);\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        f \\<in> extensional {j. j \\<le> Suc (Suc n)};\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                \\<Union>\n                 {X. \\<exists>i\\<le>Suc (Suc n).\n                        X = carrier (R /\\<^sub>r J i)};\n        f x \\<in> carrier (R /\\<^sub>r J x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<le>Suc n.\n                                xa = carrier (R /\\<^sub>r J i)) \\<and>\n                            f x \\<in> xa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Chinese_remTr2:\"(\\<forall>k \\<le> (Suc n). ideal R (J k)) \\<and> \n     (\\<forall>k\\<le>(Suc n). B k = qring R (J k)) \\<and> \n     (\\<forall>k\\<le>(Suc n). S k = pj R (J k)) \\<and> \n     (\\<forall>i\\<le>(Suc n). \\<forall>j\\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> \n     coprime_ideals R (J i) (J j))) \\<longrightarrow> \n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j\\<le> (Suc n)}\\<^esub> B)\\<^esub> \n                   (A_to_prodag R {j. j\\<le>(Suc n)} S B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n    (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n    (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                     B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (cut_tac Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring R \\<Longrightarrow>\n    (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n    (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n    (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                     B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Ring R \\<Longrightarrow>\n    (\\<forall>k\\<le>Suc 0. ideal R (J k)) \\<and>\n    (\\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k) \\<and>\n    (\\<forall>k\\<le>Suc 0. S k = pj R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub>\n                     B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "(* case n = 0, i.e. two coprime_ideals *)  (** use coprime_surjTr **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Ring R \\<Longrightarrow>\n    (\\<forall>k\\<le>Suc 0. ideal R (J k)) \\<and>\n    (\\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k) \\<and>\n    (\\<forall>k\\<le>Suc 0. S k = pj R (J k)) \\<and>\n    (\\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)) \\<longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub>\n                     B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R;\n     (\\<forall>k\\<le>Suc 0. ideal R (J k)) \\<and>\n     (\\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k) \\<and>\n     (\\<forall>k\\<le>Suc 0. S k = pj R (J k)) \\<and>\n     (\\<forall>i\\<le>Suc 0.\n         \\<forall>j\\<le>Suc 0.\n            i \\<noteq> j \\<longrightarrow>\n            coprime_ideals R (J i) (J j))\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (frule  A_to_prodag_rHom [of R \"{j. j \\<le> Suc 0}\" \"B\" \"S\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}. Ring (B k)\n 2. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k \\<in> rHom R (B k)\n 3. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule ballI, simp add:Ring.qring_ring)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc 0}.\n                         S k \\<in> rHom R (B k)\n 2. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule ballI, simp add:pj_Hom)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (frule rHom_func[of \"A_to_prodag R {j. j \\<le> (Suc 0)} S B\" R \n                           \"r\\<Pi>\\<^bsub>{j. j \\<le> (Suc 0)}\\<^esub> B\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc 0}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc 0} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S B\n                      \\<in> aHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub>\n                              B) \\<and>\n                      surj_to (A_to_prodag R {j. j \\<le> Suc 0} S B)\n                       (carrier R)\n                       (carrier\n                         (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc 0} S B\n                      \\<in> aHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\n 2. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surj_to (A_to_prodag R {j. j \\<le> Suc 0} S B)\n                       (carrier R)\n                       (carrier\n                         (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B))\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surj_to (A_to_prodag R {j. j \\<le> Suc 0} S B)\n                       (carrier R)\n                       (carrier\n                         (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule surj_to_test, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n     \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n     \\<forall>i\\<le>Suc 0.\n        \\<forall>j\\<le>Suc 0.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n     A_to_prodag R {j. j \\<le> Suc 0} S B\n     \\<in> carrier R \\<rightarrow>\n           carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier\n(r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B).\n                         \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {j. j \\<le> Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B);\n        b \\<in> carrier\n                 (r\\<Pi>\\<^bsub>{j. j \\<le> Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc 0} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (cut_tac coprime_elems [of \"J 0\" \"J (Suc 0)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        \\<exists>a\\<in>J 0.\n           \\<exists>b\\<in>J (Suc 0). a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = b\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rename_tac f)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        \\<exists>a\\<in>J 0.\n           \\<exists>b\\<in>J (Suc 0). a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (erule bexE, erule bexE)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B); a \\<in> J 0;\n        b \\<in> J (Suc 0); a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:prodrg_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R\n               \\<lparr>carrier = carr_prodag {0, Suc 0} B,\n                  pop = prod_pOp {0, Suc 0} B, mop = prod_mOp {0, Suc 0} B,\n                  zero = prod_zero {0, Suc 0} B, tp = prod_tOp {0, Suc 0} B,\n                  un = prod_one {0, Suc 0} B\\<rparr>;\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (fold prodrg_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (cut_tac X = \"f 0\" and Y = \"f (Suc 0)\" in \n                  coprime_surjTr[of \"J 0\" \"J (Suc 0)\"], simp+)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> f 0 \\<in> carrier (R /\\<^sub>r J 0)\n 2. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> f (Suc 0) \\<in> carrier (R /\\<^sub>r J (Suc 0))\n 3. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r;\n        \\<exists>r\\<in>carrier R.\n           pj R (J 0) r = f 0 \\<and> pj R (J (Suc 0)) r = f (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 5. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 6. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 7. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:carr_prodag_def, simp add:carr_prodag_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r;\n        \\<exists>r\\<in>carrier R.\n           pj R (J 0) r = f 0 \\<and> pj R (J (Suc 0)) r = f (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (erule bexE, (erule conjE)+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (frule_tac x = r in funcset_mem[of \"A_to_prodag R {0, Suc 0} S B\"\n        \"carrier R\" \"carr_prodag {0, Suc 0} B\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (cut_tac X = \"A_to_prodag R {0, Suc 0} S B r\" and Y = f in \n         carr_prodag_mem_eq[of \"{0, Suc 0}\" B])"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{0, Suc 0}. aGroup (B k)\n 2. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S B r\n                         \\<in> carr_prodag {0, Suc 0} B\n 3. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> f \\<in> carr_prodag {0, Suc 0} B\n 4. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S B r l = f l\n 5. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        A_to_prodag R {0, Suc 0} S B r = f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 6. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 7. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 8. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 9. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule ballI, simp, erule disjE, simp add:qring_ring \n                           Ring.ring_is_ag,\n         simp add:Ring.qring_ring Ring.ring_is_ag)"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S B r\n                         \\<in> carr_prodag {0, Suc 0} B\n 2. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> f \\<in> carr_prodag {0, Suc 0} B\n 3. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S B r l = f l\n 4. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        A_to_prodag R {0, Suc 0} S B r = f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 5. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 6. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 7. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 8. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply assumption+"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r\n        \\<in> carr_prodag {0, Suc 0} B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{0, Suc 0}.\n                            A_to_prodag R {0, Suc 0} S B r l = f l\n 2. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        A_to_prodag R {0, Suc 0} S B r = f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 5. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 6. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule ballI, simp, erule disjE, simp)"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>f a b r l.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        l = 0\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S B r 0 = f 0\n 2. \\<And>f a b r l.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        l = Suc 0\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {0, Suc 0} S B r l = f l\n 3. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        A_to_prodag R {0, Suc 0} S B r = f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 5. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 6. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 7. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (simp add:A_to_prodag_def, simp add:A_to_prodag_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>f a b r.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow> carr_prodag {0, Suc 0} B;\n        f \\<in> carr_prodag {0, Suc 0} B; a \\<in> J 0; b \\<in> J (Suc 0);\n        a \\<plusminus> b = 1\\<^sub>r; r \\<in> carrier R; pj R (J 0) r = f 0;\n        pj R (J (Suc 0)) r = f (Suc 0);\n        A_to_prodag R {0, Suc 0} S B r \\<in> carr_prodag {0, Suc 0} B;\n        A_to_prodag R {0, Suc 0} S B r = f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {0, Suc 0} S B a = f\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 4. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 5. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply blast"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J 0)\n 2. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc 0))\n 3. \\<And>b.\n       \\<lbrakk>Ring R; \\<forall>k\\<le>Suc 0. ideal R (J k);\n        \\<forall>k\\<le>Suc 0. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc 0. S k = pj R (J k);\n        \\<forall>i\\<le>Suc 0.\n           \\<forall>j\\<le>Suc 0.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        A_to_prodag R {0, Suc 0} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{0, Suc 0}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> coprime_ideals R (J 0) (J (Suc 0))\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply simp+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                     B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             B k = R /\\<^sub>r J k) \\<and>\n                         (\\<forall>k\\<le>Suc (Suc n).\n                             S k = pj R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i)\n                                 (J j)) \\<longrightarrow>\n                         surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "(**** n ****)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow>\n              coprime_ideals R (J i) (J j)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (cut_tac n = \"Suc n\" in Nsetn_sub_mem1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B", "apply (subgoal_tac \"\\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac I = \"{i. i \\<le> Suc (Suc n)}\"  in A_to_prodag_rHom [of \"R\" _ \"B\" \"S\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}.\n                            S k \\<in> rHom R (B k)\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply assumption"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}.\n                            S k \\<in> rHom R (B k)\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n k.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k);\n        k \\<in> {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> S k \\<in> rHom R (B k)\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:pj_Hom)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)};\n        \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                   j \\<le> Suc (Suc n)}\\<^esub>\n    B)\\<^esub> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (subst surjec_def, rule conjI,\n        simp add:rHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surj_to\n                          (A_to_prodag R {j. j \\<le> Suc (Suc n)} S B)\n                          (carrier R)\n                          (carrier\n                            (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub>\n                             B))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (cut_tac n = \"Suc n\" in coprime_n_idealsTr4[of  _ J])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc (Suc n). ideal R (J k)) \\<and>\n                         (\\<forall>i\\<le>Suc (Suc n).\n                             \\<forall>j\\<le>Suc (Suc n).\n                                i \\<noteq> j \\<longrightarrow>\n                                coprime_ideals R (J i) (J j))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> surj_to\n                          (A_to_prodag R {j. j \\<le> Suc (Suc n)} S B)\n                          (carrier R)\n                          (carrier\n                            (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub>\n                             B))\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> surj_to\n                          (A_to_prodag R {j. j \\<le> Suc (Suc n)} S B)\n                          (carrier R)\n                          (carrier\n                            (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub>\n                             B))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"A_to_prodag R {j. j \\<le> (Suc (Suc n))} S B\" and \n        A = R in rHom_func)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> surj_to\n                          (A_to_prodag R {j. j \\<le> Suc (Suc n)} S B)\n                          (carrier R)\n                          (carrier\n                            (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub>\n                             B))\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule_tac f = \"A_to_prodag R {j. j \\<le> (Suc (Suc n))} S B\" and\n        A = \"carrier R\" and B = \"carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc (Suc n))}\\<^esub> B)\" in\n        surj_to_test, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier\n               (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>carrier\n   (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B).\n                            \\<exists>a\\<in>carrier R.\n                               A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n                                a =\n                               b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier\n                 (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (cut_tac n = \"Suc n\" in n_prod_ideal[of  _ J])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier\n                 (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n. ideal R (J k)\n 2. \\<And>n b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = b\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule allI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac A = \"i\\<Pi>\\<^bsub>R,(Suc n)\\<^esub> J\" and B = \"J (Suc (Suc n))\" in \n        coprime_elems,\n        cut_tac n = \"Suc (Suc n)\" in n_in_Nsetn,\n        blast, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        \\<exists>a\\<in>i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J.\n           \\<exists>b\\<in>J (Suc (Suc n)).\n              a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (erule bexE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n b a ba.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        b \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; ba \\<in> J (Suc (Suc n));\n        a \\<plusminus> ba = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = b\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rename_tac n f a b)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        coprime_ideals R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)\n         (J (Suc (Suc n)));\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (thin_tac \" coprime_ideals R (i\\<Pi>\\<^bsub>R,(Suc n)\\<^esub> J) (J (Suc (Suc n)))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (cut_tac n = \"Suc n\" and a = a and J = J in ele_n_prod,\n        rule allI, simp, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac n = n and f = f in aGroup.restrict_prod_Suc[of R _ R J B S],\n          assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac S = \"r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B\" and \n        f = \"A_to_prodag R {j. j \\<le> (Suc n)} S B\" in surjec_surj_to[of R])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"A_to_prodag R {j. j \\<le> (Suc n)} S B\" and A = \"carrier R\"\n        and B = \"carrier (r\\<Pi>\\<^bsub>{j. j \\<le>  (Suc n)}\\<^esub> B)\" and \n        b = \"restrict f {j. j \\<le> (Suc n)}\" in surj_to_el2, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        \\<exists>a\\<in>carrier R.\n           A_to_prodag R {j. j \\<le> Suc n} S B a =\n           restrict f {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (erule bexE, rename_tac n f a b u)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (cut_tac n = \"Suc (Suc n)\" in n_in_Nsetn,\n        frule_tac f = f and I = \"{j. j \\<le> (Suc (Suc n))}\" and A = B and \n         i = \"Suc (Suc n)\" in prodrg_component, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J);\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J; b \\<in> J (Suc (Suc n));\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        Suc (Suc n) \\<in> {i. i \\<le> Suc (Suc n)};\n        f (Suc (Suc n)) \\<in> carrier (B (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac J = \"J (Suc (Suc n))\" and X = \"f (Suc (Suc n))\" in \n                pj_surj_to[of R], simp, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        \\<exists>r\\<in>carrier R.\n           pj R (J (Suc (Suc n))) r = f (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (erule bexE, rename_tac n f a b u v)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R;\n        pj R (J (Suc (Suc n))) v = f (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac a = \"Suc (Suc n)\" in forall_spec, simp,\n        frule_tac I = \"J (Suc (Suc n))\" and h = b in Ring.ideal_subset[of R],\n        assumption+,\n        cut_tac I = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> J (Suc n)\" and h = a in \n                       Ring.ideal_subset[of R], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R;\n        a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac x = b and y = u in  Ring.ring_tOp_closed[of R], assumption+,\n        frule_tac x = a and y = v in  Ring.ring_tOp_closed[of R], assumption+,\n       frule Ring.ring_is_ag[of R],\n       frule_tac x = \"b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> u\" and y = \"a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> v\" in aGroup.ag_pOp_closed[of R],\n       assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"A_to_prodag R {j. j \\<le> (Suc (Suc n))} S B\" and \n        A = \"carrier R\" and B = \"carrier (r\\<Pi>\\<^bsub>{j. j \\<le> (Suc (Suc n))}\\<^esub> B)\" and\n        x = \"b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> u \\<plusminus>\\<^bsub>R\\<^esub> a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> v\" in funcset_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier\n               (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"A_to_prodag R {j. j \\<le> (Suc (Suc n))} S B \n                       (b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> u \\<plusminus>\\<^bsub>R\\<^esub> a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> v)\" and I = \"{j. j \\<le> (Suc (Suc n))}\"\n           and  g = f in carr_prodrg_mem_eq, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier\n               (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>{j. j \\<le> Suc (Suc n)}.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n                             (b \\<cdot>\\<^sub>r u \\<plusminus>\n                              a \\<cdot>\\<^sub>r v)\n                             i =\n                            f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n                          (b \\<cdot>\\<^sub>r u \\<plusminus>\n                           a \\<cdot>\\<^sub>r v)\n                          i =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (subst A_to_prodag_def, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          (b \\<cdot>\\<^sub>r u \\<plusminus>\n                           a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac I = \"J i\" in pj_Hom[of R], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n);\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i)\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          (b \\<cdot>\\<^sub>r u \\<plusminus>\n                           a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add: rHom_add)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n);\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i)\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          (b \\<cdot>\\<^sub>r\n                           u) \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac a = i in forall_spec, assumption,\n        thin_tac \"\\<forall>k \\<le> (Suc (Suc n)). ideal R (J k)\",\n        frule_tac I = \"J i\" in Ring.qring_ring[of R], assumption,\n        thin_tac \"\\<forall>k \\<le> (Suc (Suc n)). Ring (R /\\<^sub>r J k)\",\n        frule_tac R = \"R /\\<^sub>r (J i)\" and x = b and y = u and f = \"pj R (J i)\" in\n         rHom_tOp[of R], assumption+, simp,\n     thin_tac \"pj R (J i) (b \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> u) = pj R (J i) b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub> pj R (J i) u\",\n     frule_tac R = \"R /\\<^sub>r (J i)\" and x = a and y = v and f = \"pj R (J i)\" in\n     rHom_tOp[of R], simp add:Ring.qring_ring, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"pj R (J i)\" and R = \"R /\\<^sub>r J i\" and a = v in\n                    rHom_mem[of _ R], assumption+,\n         frule_tac f = \"pj R (J i)\" and R = \"R /\\<^sub>r J i\" and a = u in\n                    rHom_mem[of _ R], assumption+,\n         frule_tac f = \"pj R (J i)\" and R = \"R /\\<^sub>r J i\" and a = b in\n                    rHom_mem[of _ R], assumption+,\n         frule_tac f = \"pj R (J i)\" and R = \"R /\\<^sub>r J i\" and a = a in\n                    rHom_mem[of _ R], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i)\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac R = \"R /\\<^sub>r J i\" in Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i)\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (case_tac \"i \\<le> (Suc n)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac I1 = \"J i\" and x1 = a in pj_zero[THEN sym, of R ],\n            assumption+, simp,\n    thin_tac \"pj R (J i) (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> v) = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub> pj R (J i) v\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) v =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:Ring.ring_times_0_x)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"pj R (J i)\" and A = R and R = \"R /\\<^sub>r J i\" and\n                 x = a and y = b in rHom_add, assumption+, simp,\n         thin_tac \"A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B)\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) 1\\<^sub>r =\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) b\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) 1\\<^sub>r = pj R (J i) b\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rotate_tac -1, frule sym, thin_tac \" pj R (J i) 1\\<^sub>r\\<^bsub>R\\<^esub> = pj R (J i) b\",\n         simp add:rHom_one)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) b = 1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) b = 1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub> =\n                         f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) b = 1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R (J i) u = f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"A_to_prodag R {j. j \\<le> (Suc n)} S B u\" and \n          g = \"restrict f {j. j \\<le> (Suc n)}\" and x = i in eq_fun_eq_val,\n    thin_tac \"A_to_prodag R {j. j\\<le>(Suc n)} S B u = restrict f {j. j\\<le>(Suc n)}\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        pj R (J i) \\<in> rHom R (R /\\<^sub>r J i); ideal R (J i);\n        Ring (R /\\<^sub>r J i);\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); i \\<le> Suc n;\n        pj R (J i) a = \\<zero>\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        pj R (J i) b = 1\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>;\n        A_to_prodag R {j. j \\<le> Suc n} S B u i =\n        restrict f {j. j \\<le> Suc n} i\\<rbrakk>\n       \\<Longrightarrow> pj R (J i) u = f i\n 2. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 3. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 4. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:A_to_prodag_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) (a \\<cdot>\\<^sub>r v) =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        i \\<le> Suc (Suc n); pj R (J i) \\<in> rHom R (R /\\<^sub>r J i);\n        ideal R (J i); Ring (R /\\<^sub>r J i);\n        pj R (J i) (a \\<cdot>\\<^sub>r v) =\n        pj R (J i) a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n        pj R (J i) v;\n        pj R (J i) v \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) u \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) b \\<in> carrier (R /\\<^sub>r J i);\n        pj R (J i) a \\<in> carrier (R /\\<^sub>r J i);\n        aGroup (R /\\<^sub>r J i); \\<not> i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> pj R (J i)\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i)\n                          a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J i\\<^esub>\n                         pj R (J i) v =\n                         f i\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac y = i and x = \"Suc n\" in not_le_imp_less, \n         frule_tac m = \"Suc n\" and n = i in Suc_leI,\n         frule_tac m = i and n = \"Suc (Suc n)\" in Nat.le_antisym, assumption+,\n         simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J (Suc (Suc n))) \\<in> rHom R (R /\\<^sub>r J (Suc (Suc n)));\n        ideal R (J (Suc (Suc n))); Ring (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) (a \\<cdot>\\<^sub>r v) =\n        pj R (J (Suc (Suc n)))\n         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        f (Suc (Suc n));\n        pj R (J (Suc (Suc n))) u\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) b\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) a\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        aGroup (R /\\<^sub>r J (Suc (Suc n))); i = Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> pj R (J (Suc (Suc n)))\n                          b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         pj R (J (Suc (Suc n)))\n                          u \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         pj R (J (Suc (Suc n)))\n                          a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         f (Suc (Suc n)) =\n                         f (Suc (Suc n))\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac I1 = \"J (Suc (Suc n))\" and x1 = b in pj_zero[THEN sym, of\n          R ],  assumption+, simp add:Ring.ring_times_0_x)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        pj R (J (Suc (Suc n))) b =\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>;\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J (Suc (Suc n))) \\<in> rHom R (R /\\<^sub>r J (Suc (Suc n)));\n        ideal R (J (Suc (Suc n))); Ring (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) (a \\<cdot>\\<^sub>r v) =\n        pj R (J (Suc (Suc n)))\n         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        f (Suc (Suc n));\n        pj R (J (Suc (Suc n))) u\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) a\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        aGroup (R /\\<^sub>r J (Suc (Suc n))); i = Suc (Suc n);\n        b \\<in> J (Suc (Suc n))\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         pj R (J (Suc (Suc n)))\n                          a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         f (Suc (Suc n)) =\n                         f (Suc (Suc n))\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (frule_tac f = \"pj R (J (Suc (Suc n)))\" and A = R and \n          R = \"R /\\<^sub>r J (Suc (Suc n))\" and\n                 x = a and y = b in rHom_add, assumption+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        pj R (J (Suc (Suc n))) b =\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>;\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J (Suc (Suc n))) \\<in> rHom R (R /\\<^sub>r J (Suc (Suc n)));\n        ideal R (J (Suc (Suc n))); Ring (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) (a \\<cdot>\\<^sub>r v) =\n        pj R (J (Suc (Suc n)))\n         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        f (Suc (Suc n));\n        pj R (J (Suc (Suc n))) u\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) a\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        aGroup (R /\\<^sub>r J (Suc (Suc n))); i = Suc (Suc n);\n        b \\<in> J (Suc (Suc n));\n        pj R (J (Suc (Suc n))) 1\\<^sub>r =\n        pj R (J (Suc (Suc n)))\n         a \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         pj R (J (Suc (Suc n)))\n                          a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         f (Suc (Suc n)) =\n                         f (Suc (Suc n))\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        pj R (J (Suc (Suc n))) b =\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>;\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J (Suc (Suc n))) \\<in> rHom R (R /\\<^sub>r J (Suc (Suc n)));\n        ideal R (J (Suc (Suc n))); Ring (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) (a \\<cdot>\\<^sub>r v) =\n        pj R (J (Suc (Suc n)))\n         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        f (Suc (Suc n));\n        pj R (J (Suc (Suc n))) u\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) a\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        aGroup (R /\\<^sub>r J (Suc (Suc n))); i = Suc (Suc n);\n        b \\<in> J (Suc (Suc n));\n        pj R (J (Suc (Suc n))) 1\\<^sub>r = pj R (J (Suc (Suc n))) a\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         pj R (J (Suc (Suc n)))\n                          a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         f (Suc (Suc n)) =\n                         f (Suc (Suc n))\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rotate_tac -1, frule sym, \n          thin_tac \"pj R (J (Suc (Suc n))) 1\\<^sub>r\\<^bsub>R\\<^esub> = pj R (J (Suc (Suc n))) a\",\n          simp add:rHom_one,\n          simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f a b u v i.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        pj R (J (Suc (Suc n))) b =\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>;\n        a \\<plusminus> b = 1\\<^sub>r; \\<forall>k\\<le>Suc n. a \\<in> J k;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r\n          u) \\<plusminus>\\<^bsub>r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B\\<^esub>\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B (a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        pj R (J (Suc (Suc n))) \\<in> rHom R (R /\\<^sub>r J (Suc (Suc n)));\n        ideal R (J (Suc (Suc n))); Ring (R /\\<^sub>r J (Suc (Suc n)));\n        pj R (J (Suc (Suc n))) (a \\<cdot>\\<^sub>r v) = f (Suc (Suc n));\n        pj R (J (Suc (Suc n))) u\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n        \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        aGroup (R /\\<^sub>r J (Suc (Suc n))); i = Suc (Suc n);\n        b \\<in> J (Suc (Suc n));\n        pj R (J (Suc (Suc n))) a =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r J (Suc (Suc n))\\<^esub>\n                         f (Suc (Suc n)) =\n                         f (Suc (Suc n))\n 2. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 3. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f a b u v.\n       \\<lbrakk>Ring R;\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>k\\<le>Suc (Suc n). Ring (R /\\<^sub>r J k);\n        A_to_prodag R {i. i \\<le> Suc (Suc n)} S B\n        \\<in> rHom R (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n        \\<in> carrier R \\<rightarrow>\n              carrier (r\\<Pi>\\<^bsub>{i. i \\<le> Suc (Suc n)}\\<^esub> B);\n        f \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        ideal R\n         (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n));\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        b \\<in> J (Suc (Suc n)); a \\<plusminus> b = 1\\<^sub>r;\n        \\<forall>k\\<le>Suc n. a \\<in> J k; aGroup R;\n        restrict f {j. j \\<le> Suc n}\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        surj_to (A_to_prodag R {j. j \\<le> Suc n} S B) (carrier R)\n         (carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B));\n        u \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc n} S B u =\n        restrict f {j. j \\<le> Suc n};\n        f (Suc (Suc n)) \\<in> carrier (R /\\<^sub>r J (Suc (Suc n)));\n        v \\<in> carrier R; pj R (J (Suc (Suc n))) v = f (Suc (Suc n));\n        ideal R (J (Suc (Suc n))); b \\<in> carrier R; a \\<in> carrier R;\n        b \\<cdot>\\<^sub>r u \\<in> carrier R;\n        a \\<cdot>\\<^sub>r v \\<in> carrier R; aGroup R;\n        b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v\n        \\<in> carrier R;\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v)\n        \\<in> carrier (r\\<Pi>\\<^bsub>{j. j \\<le> Suc (Suc n)}\\<^esub> B);\n        A_to_prodag R {j. j \\<le> Suc (Suc n)} S B\n         (b \\<cdot>\\<^sub>r u \\<plusminus> a \\<cdot>\\<^sub>r v) =\n        f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            A_to_prodag R {j. j \\<le> Suc (Suc n)} S B a = f\n 2. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R;\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        (\\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k) \\<and>\n        (\\<forall>k\\<le>Suc n. S k = pj R (J k)) \\<and>\n        (\\<forall>i\\<le>Suc n.\n            \\<forall>j\\<le>Suc n.\n               i \\<noteq> j \\<longrightarrow>\n               coprime_ideals R (J i) (J j)) \\<longrightarrow>\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        \\<forall>k\\<le>Suc (Suc n). ideal R (J k);\n        \\<forall>k\\<le>Suc (Suc n). B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc (Suc n). S k = pj R (J k);\n        \\<forall>i\\<le>Suc (Suc n).\n           \\<forall>j\\<le>Suc (Suc n).\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        \\<forall>j.\n           j \\<in> {j. j \\<le> Suc n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<in>{i. i \\<le> Suc (Suc n)}. Ring (B k)", "apply (rule ballI, simp add:Ring.qring_ring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Chinese_remTr3:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). ideal R (J k); \n      \\<forall>k \\<le> (Suc n). B k = qring R (J k); \\<forall>k\\<le> (Suc n). S k = pj R (J k); \n  \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk> \\<Longrightarrow>\n    surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\\<^esub> \n                   (A_to_prodag R {j. j \\<le> (Suc n)} S B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (simp add:Chinese_remTr2 [of  \"n\" \"J\" \"B\" \"S\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) imset:\"\\<lbrakk>\\<forall>k\\<le> (Suc n). ideal R (J k)\\<rbrakk>\n\\<Longrightarrow> {I. \\<exists>k\\<le> (Suc n). I = J k} = {J k| k. k \\<in> {j. j \\<le> (Suc n)}}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>Suc n. ideal R (J k) \\<Longrightarrow>\n    {I. \\<exists>k\\<le>Suc n. I = J k} =\n    {J k |k. k \\<in> {j. j \\<le> Suc n}}", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "theorem (in Ring) Chinese_remThm:\"\\<lbrakk>(\\<forall>k \\<le> (Suc n). ideal R (J k)); \n \\<forall>k\\<le>(Suc n). B k = qring R (J k); \\<forall>k \\<le> (Suc n). S k = pj R (J k); \n \\<forall>i \\<le> (Suc n). \\<forall>j \\<le> (Suc n). (i \\<noteq>j \\<longrightarrow> coprime_ideals R (J i) (J j))\\<rbrakk> \n\\<Longrightarrow> bijec\\<^bsub>(qring R (\\<Inter> {J k | k. k\\<in>{j. j \\<le> (Suc n)}})),(r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B)\\<^esub> \n     ((A_to_prodag R {j. j \\<le> (Suc n)} S B)\\<degree>\\<^bsub>R,(prodrg {j. j \\<le> (Suc n)} B)\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow>\n           coprime_ideals R (J i) (J j)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<in> {j.\n        j \\<le> Suc n}},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\nB\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<^esub>)", "apply (frule Chinese_remTr3, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                  B\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<in> {j.\n        j \\<le> Suc n}},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\nB\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<^esub>)", "apply (cut_tac I = \"{j. j \\<le> (Suc n)}\" and A = B in prodrg_ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S\n                                  B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc n}. Ring (B k)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<in> {j.\n        j \\<le> Suc n}},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\nB\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<^esub>)", "apply (rule ballI, simp add:qring_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<in> {j.\n        j \\<le> Suc n}},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\nB\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<^esub>)", "apply (cut_tac surjec_ind_bijec [of \"R\" \"r\\<Pi>\\<^bsub>{j. j \\<le> (Suc n)}\\<^esub> B\" \n                   \"A_to_prodag R {j. j \\<le> (Suc n)} S B\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n     bijec\\<^bsub>R /\\<^sub>r\n                  (ker\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                                 B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n}\n       S B),(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n             B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\n                          B\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                        j \\<le> Suc n}\\<^esub>\n         B)\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<in> {j.\n        j \\<le> Suc n}},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\nB\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<^esub>)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> Ring R\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\n 4. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc n} S B\n                      \\<in> rHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\n 5. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (cut_tac Ring,\n       simp add:Chinese_remTr1 [of \"R\" \"Suc n\" \"J\" \"B\" \"S\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n     bijec\\<^bsub>R /\\<^sub>r\n                  \\<Inter>\n                   {I. \\<exists>k\\<le>Suc n.\n                          I =\n                          J k},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                                B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n}\n       S B\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                              B)\\<^esub>);\n     Ring R\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>R /\\<^sub>r\n                                   \\<Inter>\n                                    {J k |k.\n                                     k \\<le> Suc\n        n},(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n            B)\\<^esub> (A_to_prodag R {j. j \\<le> Suc n} S\n                         B\\<degree>\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                       j \\<le> Suc n}\\<^esub>\n        B)\\<^esub>)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> Ring R\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\n 4. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc n} S B\n                      \\<in> rHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\n 5. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (simp add:imset, rule Ring_axioms, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag R {j. j \\<le> Suc n} S B\n                      \\<in> rHom R\n                             (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (rule A_to_prodag_rHom, rule Ring_axioms)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc n}. Ring (B k)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc n}.\n                         S k \\<in> rHom R (B k)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>k.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n        \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n        \\<forall>k\\<le>Suc n. S k = pj R (J k);\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n.\n              i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n        surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                         B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n        Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B);\n        k \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> Ring (B k)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc n}.\n                         S k \\<in> rHom R (B k)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (simp add:qring_ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<in>{j. j \\<le> Suc n}.\n                         S k \\<in> rHom R (B k)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply (rule ballI, simp, rule pj_Hom, rule Ring_axioms, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     \\<forall>k\\<le>Suc n. B k = R /\\<^sub>r J k;\n     \\<forall>k\\<le>Suc n. S k = pj R (J k);\n     \\<forall>i\\<le>Suc n.\n        \\<forall>j\\<le>Suc n.\n           i \\<noteq> j \\<longrightarrow> coprime_ideals R (J i) (J j);\n     surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub>\n                      B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B;\n     Ring (r\\<Pi>\\<^bsub>{j. j \\<le> Suc n}\\<^esub> B)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>R,(r\\<Pi>\\<^bsub>{j.\n                j \\<le> Suc n}\\<^esub>\n B)\\<^esub> A_to_prodag R {j. j \\<le> Suc n} S B", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_prime:\"\\<lbrakk>ideal R A; \\<forall>k\\<le>(Suc n). prime_ideal R (P k);\n      \\<forall>l\\<le>(Suc n). \\<not> (A \\<subseteq> P l); \n      \\<forall>k\\<le> (Suc n). \\<forall>l\\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l)\\<rbrakk> \\<Longrightarrow> \n     \\<forall>i \\<le> (Suc n). (nprod R (ppa R P A i) n \\<in> A \\<and> \n        (\\<forall>l \\<in> {j. j\\<le>(Suc n)} - {i}. nprod R (ppa R P A i) n \\<in> P l) \\<and> \n        (nprod R (ppa R P A i) n \\<notin> P i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n     \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n     \\<forall>k\\<le>Suc n.\n        \\<forall>l\\<le>Suc n.\n           k = l \\<or> \\<not> P k \\<subseteq> P l\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>Suc n.\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                         \\<in> A \\<and>\n                         (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                         \\<in> A \\<and>\n                         (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac i = i in prod_primeTr1[of n P A], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac n = n and f = \"ppa R P A i\" in ideal_nprod_inc[of  A])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ia\\<le>n. ppa R P A i ia \\<in> carrier R\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>n. ppa R P A i l \\<in> A\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i ia.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ia \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i ia \\<in> carrier R\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>n. ppa R P A i l \\<in> A\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rotate_tac -2, \n         frule_tac a = ia in forall_spec, assumption,\n         thin_tac \"\\<forall>l \\<le> n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n         simp add:ideal_subset)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>n. ppa R P A i l \\<in> A\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rotate_tac -1, \n         frule_tac a = n in forall_spec, simp,\n         thin_tac \"\\<forall>l\\<le> n.\n            ppa R P A i l \\<in> A \\<and>\n            ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n         (erule conjE)+, \n         blast, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac i = i in prod_primeTr1[of n P A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i\n                             \\<in> P l) \\<and>\n                         e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n                            e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac a = l in forall_spec, simp,\n        frule_tac I = \"P l\" in prime_ideal_ideal)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac n = n and f = \"ppa R P A i\" and A = \"P l\" in ideal_nprod_inc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ia\\<le>n. ppa R P A i ia \\<in> carrier R\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule allI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l ia.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> ia \\<le> n \\<longrightarrow>\n                         ppa R P A i ia \\<in> carrier R\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (simp add:ppa_mem, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (case_tac \"l < i\",\n        thin_tac \"\\<forall>l\\<le> (Suc n). \\<not> A \\<subseteq> P l\",\n        thin_tac \"\\<forall>k\\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> P k \\<subseteq> P l\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l); l < i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l);\n        \\<not> l < i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (erule conjE,\n         frule_tac x = l and y = i and z = \"Suc n\" in less_le_trans,\n         assumption,\n         frule_tac x = l and n = n in Suc_less_le)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); l < i; l \\<le> Suc n; l \\<noteq> i; l < Suc n;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l);\n        \\<not> l < i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rotate_tac 2, \n         frule_tac a = l in forall_spec, assumption,\n         thin_tac \"\\<forall>l\\<le>n. ppa R P A i l \\<in> A \\<and>\n                 ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n         thin_tac \"l < Suc n\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>i \\<le> Suc n; ideal R (P l); l < i; l \\<le> Suc n;\n        l \\<noteq> i; l \\<le> n; ideal R A;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        ppa R P A i l \\<in> A \\<and>\n        ppa R P A i l \\<in> P (skip i l) \\<and>\n        ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l);\n        \\<not> l < i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (simp only:skip_im_Tr1_2, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l);\n        \\<not> l < i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac x = l and y = i in leI,\n         thin_tac \"\\<not> l < i\",\n         cut_tac x = l and A = \"{j. j \\<le> (Suc n)}\" and a = i in in_diff1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l); i \\<le> l\\<rbrakk>\n       \\<Longrightarrow> l \\<in> {j. j \\<le> Suc n} - {i}\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l); i \\<le> l;\n        l \\<noteq> i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<le> Suc n \\<and> l \\<noteq> i; ideal R (P l); i \\<le> l;\n        l \\<noteq> i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (erule conjE,\n         frule not_sym, thin_tac \"l \\<noteq> i\",\n         frule_tac x = i and y = l in le_imp_less_or_eq,\n         erule disjE, thin_tac \"i \\<le> l\",\n         frule_tac x = i and n = l in less_le_diff)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); l \\<le> Suc n; l \\<noteq> i; i \\<noteq> l; i < l;\n        i \\<le> l - Suc 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); i \\<le> l; l \\<le> Suc n; l \\<noteq> i; i \\<noteq> l;\n        i = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (cut_tac i = i and n = n and x = \"l - Suc 0\" in skip_im_Tr2_1,\n         simp, assumption+, simp,\n         frule_tac x = l and n = n in le_Suc_diff_le)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); l \\<le> Suc n; i < l; i \\<le> l - Suc 0;\n        skip i (l - Suc 0) = l; l - Suc 0 \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); i \\<le> l; l \\<le> Suc n; l \\<noteq> i; i \\<noteq> l;\n        i = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rotate_tac -7,\n         frule_tac a = \"l - Suc 0\" in forall_spec, assumption,\n         thin_tac \"\\<forall>l\\<le>n. ppa R P A i l \\<in> A \\<and>\n                 ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n         simp, (erule conjE)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R (P l); l \\<le> Suc n; i < l; i \\<le> l - Suc 0;\n        skip i (l - Suc 0) = l; l - Suc 0 \\<le> n; ideal R A;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        ppa R P A i (l - Suc 0) \\<in> A; ppa R P A i (l - Suc 0) \\<in> P l;\n        ppa R P A i (l - Suc 0) \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); i \\<le> l; l \\<le> Suc n; l \\<noteq> i; i \\<noteq> l;\n        i = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 3. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 4. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        ideal R (P l); i \\<le> l; l \\<le> Suc n; l \\<noteq> i; i \\<noteq> l;\n        i = l\\<rbrakk>\n       \\<Longrightarrow> \\<exists>la\\<le>n. ppa R P A i la \\<in> P l\n 2. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 3. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        l \\<in> {j. j \\<le> Suc n} - {i}; prime_ideal R (P l);\n        ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>k\\<le>Suc n. prime_ideal R (P k);\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (frule_tac a = i in forall_spec, assumption,\n           thin_tac \"\\<forall>k\\<le> (Suc n). prime_ideal R (P k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i)\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i", "apply (rule_tac P = \"P i\" and n = n and f = \"ppa R P A i\" in\n             prime_nprod_exc, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>ia\\<le>n. ppa R P A i ia \\<in> carrier R\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. ppa R P A i l \\<notin> P i", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i ia.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i); ia \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i ia \\<in> carrier R\n 2. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. ppa R P A i l \\<notin> P i", "apply (rotate_tac -3, \n           frule_tac a = ia in forall_spec, assumption,\n           thin_tac \"\\<forall>l \\<le> n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n           simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>n. ppa R P A i l \\<notin> P i", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i l.\n       \\<lbrakk>ideal R A; \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n;\n        \\<forall>l\\<le>n.\n           ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and>\n           ppa R P A i l \\<notin> P i;\n        prime_ideal R (P i); l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<notin> P i", "apply (\n           rotate_tac 4,\n           frule_tac a = l in forall_spec, assumption,\n           thin_tac \"\\<forall>l\\<le> n.\n            ppa R P A i l \\<in> A \\<and>\n            ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\",\n           simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma skip_im1:\"\\<lbrakk>i \\<le> (Suc n); P \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> Collect (prime_ideal R)\\<rbrakk>\n    \\<Longrightarrow>\n   compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n} = P ` ({j. j \\<le> (Suc n)} - {i})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n             Collect (prime_ideal R)\\<rbrakk>\n    \\<Longrightarrow> compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n} =\n                      P ` ({j. j \\<le> Suc n} - {i})", "apply (cut_tac skip_fun[of i n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow> Collect (prime_ideal R);\n     skip i \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n} =\n                      P ` ({j. j \\<le> Suc n} - {i})", "apply (subst setim_cmpfn[of _ _ _ _ \"{X. prime_ideal R X}\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow> Collect (prime_ideal R);\n     skip i \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> n} \\<subseteq> {j. j \\<le> n}\n 2. \\<lbrakk>i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow> Collect (prime_ideal R);\n     skip i \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> P ` skip i ` {j. j \\<le> n} =\n                      P ` ({j. j \\<le> Suc n} - {i})", "apply  simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow> Collect (prime_ideal R);\n     skip i \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> P ` skip i ` {j. j \\<le> n} =\n                      P ` ({j. j \\<le> Suc n} - {i})", "apply (simp add:skip_fun_im)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mutch_aux1:\"\\<lbrakk>ideal R A; i \\<le> (Suc n);\n        P \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> Collect (prime_ideal R)\\<rbrakk> \\<Longrightarrow> \n        compose {j. j \\<le> n} P (skip i) \\<in> {j. j \\<le> n} \\<rightarrow> Collect (prime_ideal R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n             Collect (prime_ideal R)\\<rbrakk>\n    \\<Longrightarrow> compose {j. j \\<le> n} P (skip i)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            Collect (prime_ideal R)", "apply (cut_tac skip_fun[of i n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; i \\<le> Suc n;\n     P \\<in> {j. j \\<le> Suc n} \\<rightarrow> Collect (prime_ideal R);\n     skip i \\<in> {i. i \\<le> n} \\<rightarrow> {i. i \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> compose {j. j \\<le> n} P (skip i)\n                      \\<in> {j. j \\<le> n} \\<rightarrow>\n                            Collect (prime_ideal R)", "apply (simp add:composition[of \"skip i\" \"{j. j \\<le> n}\" \"{j. j \\<le> (Suc n)}\" P \n            \"Collect (prime_ideal R)\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prime_ideal_cont1Tr:\"ideal R A  \\<Longrightarrow> \n      \\<forall>P. ((P \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> {X. prime_ideal R X}) \\<and> \n                   (A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}))) \\<longrightarrow> (\\<exists>i\\<le> n. A \\<subseteq> (P i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    \\<forall>P.\n       P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n       A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n       (\\<exists>i\\<le>n. A \\<subseteq> P i)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    \\<forall>P.\n       P \\<in> {j. j \\<le> 0} \\<rightarrow> {X. prime_ideal R X} \\<and>\n       A \\<subseteq> \\<Union> (P ` {j. j \\<le> 0}) \\<longrightarrow>\n       (\\<exists>i\\<le>0. A \\<subseteq> P i)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>P.\n                            P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {X. prime_ideal R X} \\<and>\n                            A \\<subseteq> \\<Union>\n     (P ` {j. j \\<le> Suc n}) \\<longrightarrow>\n                            (\\<exists>i\\<le>Suc n. A \\<subseteq> P i)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> 0} \\<rightarrow> {X. prime_ideal R X} \\<and>\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>0. A \\<subseteq> P i\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>P.\n                            P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {X. prime_ideal R X} \\<and>\n                            A \\<subseteq> \\<Union>\n     (P ` {j. j \\<le> Suc n}) \\<longrightarrow>\n                            (\\<exists>i\\<le>Suc n. A \\<subseteq> P i)", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> 0} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> 0})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>0. A \\<subseteq> P i\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>P.\n                            P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {X. prime_ideal R X} \\<and>\n                            A \\<subseteq> \\<Union>\n     (P ` {j. j \\<le> Suc n}) \\<longrightarrow>\n                            (\\<exists>i\\<le>Suc n. A \\<subseteq> P i)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>P.\n                            P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {X. prime_ideal R X} \\<and>\n                            A \\<subseteq> \\<Union>\n     (P ` {j. j \\<le> Suc n}) \\<longrightarrow>\n                            (\\<exists>i\\<le>Suc n. A \\<subseteq> P i)", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>P.\n                            P \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    {X. prime_ideal R X} \\<and>\n                            A \\<subseteq> \\<Union>\n     (P ` {j. j \\<le> Suc n}) \\<longrightarrow>\n                            (\\<exists>i\\<le>Suc n. A \\<subseteq> P i)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (case_tac \"\\<exists>i \\<le> (Suc n). \\<exists>j\\<le> (Suc n). (i \\<noteq> j \\<and> P i \\<subseteq> P j)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<exists>i\\<le>Suc n.\n           \\<exists>j\\<le>Suc n.\n              i \\<noteq> j \\<and> P i \\<subseteq> P j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply ((erule exE, erule conjE)+, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P i j.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n}); i \\<le> Suc n;\n        j \\<le> Suc n; i \\<noteq> j; P i \\<subseteq> P j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (frule_tac f = P and n = n and X = \"{X. prime_ideal R X}\" and\n         A = A and i = i and j = j in Un_less_Un, assumption+, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P i j.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n}); i \\<le> Suc n;\n        j \\<le> Suc n; i \\<noteq> j; P i \\<subseteq> P j;\n        A \\<subseteq> \\<Union>\n                       (compose {j. j \\<le> n} P (skip i) `\n                        {j. j \\<le> n})\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (frule mutch_aux1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P i j.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n}); i \\<le> Suc n;\n        j \\<le> Suc n; i \\<noteq> j; P i \\<subseteq> P j;\n        A \\<subseteq> \\<Union>\n                       (compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n});\n        compose {j. j \\<le> n} P (skip i)\n        \\<in> {j. j \\<le> n} \\<rightarrow> Collect (prime_ideal R)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (frule_tac a = \"compose {j. j \\<le> n} P (skip i)\" in forall_spec,\n        simp, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P i j ia.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n}); i \\<le> Suc n;\n        j \\<le> Suc n; i \\<noteq> j; P i \\<subseteq> P j;\n        A \\<subseteq> \\<Union>\n                       (compose {j. j \\<le> n} P (skip i) ` {j. j \\<le> n});\n        compose {j. j \\<le> n} P (skip i)\n        \\<in> {j. j \\<le> n} \\<rightarrow> Collect (prime_ideal R);\n        ia \\<le> n \\<and>\n        A \\<subseteq> compose {j. j \\<le> n} P (skip i) ia\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (cut_tac i = i and n = n and x = ia in skip_fun_im1,\n               simp+, erule conjE, simp add:compose_def,blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "(** last_step induction assumption is of no use **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        \\<forall>P.\n           P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n           A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n           (\\<exists>i\\<le>n. A \\<subseteq> P i);\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<not> (\\<exists>i\\<le>Suc n.\n                   \\<exists>j\\<le>Suc n.\n                      i \\<noteq> j \\<and> P i \\<subseteq> P j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. A \\<subseteq> P i", "apply (thin_tac \"\\<forall>P. P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n               A \\<subseteq> \\<Union>(P ` {j. j \\<le> n}) \\<longrightarrow>\n               (\\<exists>i\\<le>n. A \\<subseteq> P i)\",\n       rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac n = n and P = P in prod_prime [of A], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n. prime_ideal R (P k)\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l\n 3. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n.\n                            \\<forall>l\\<le>Suc n.\n                               k = l \\<or> \\<not> P k \\<subseteq> P l\n 4. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> False", "apply (rule allI, rule impI,\n     frule_tac f = P and A = \"{j. j \\<le> (Suc n)}\" and B = \"{X. prime_ideal R X}\"\n     and x = k in funcset_mem, simp, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac n = \"Suc n\" and \n        f = \"\\<lambda>i\\<in>{j. j \\<le> (Suc n)}. (nprod R (ppa R P A i) n)\" in \n        nsum_ideal_inc[of A], rule allI, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"(nsum R (\\<lambda>i\\<in>{j. j \\<le> (Suc n)}. nprod R (ppa R P A i) n) \n        (Suc n)) \\<notin> (\\<Union>x\\<in>{j. j \\<le> (Suc n)}. P x)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<notin> \\<Union> (P ` {j. j \\<le> Suc n})\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                       j \\<le> Suc n}.\n          e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                         \\<notin> \\<Union> (P ` {j. j \\<le> Suc n})", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                       j \\<le> Suc n}.\n          e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                         \\<notin> \\<Union> (P ` {j. j \\<le> Suc n})", "apply (simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<le>Suc n.\n                            \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                          j \\<le> Suc n}.\n             e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                            \\<notin> P x", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P x.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A;\n        x \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                       j \\<le> Suc n}.\n          e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                         \\<notin> P x", "apply (rename_tac n P l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A;\n        l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                       j \\<le> Suc n}.\n          e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                         \\<notin> P l", "apply (frule_tac f = P and A = \"{j. j \\<le> (Suc n)}\" and \n         B = \"{X. prime_ideal R X}\"\n         and x = l in funcset_mem, simp, simp del:nsum_suc,\n         frule_tac I = \"P l\" in prime_ideal_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j.\n                       j \\<le> Suc n}.\n          e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n                         \\<notin> P l", "apply (rule_tac A = \"P l\" and n = \"Suc n\" and \n         f = \"\\<lambda>i\\<in>{j. j \\<le> (Suc n)}. (nprod R (ppa R P A i) n)\" in \n         nsum_ideal_exc, simp+, rule allI, simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i) Suc n\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>Suc n.\n                            (\\<forall>la\\<in>{i. i \\<le> Suc n} - {j}.\n                                (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                                    e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i)\n                                 la\n                                \\<in> P l) \\<and>\n                            (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                                e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i)\n                             j\n                            \\<notin> P l", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j;\n        \\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i;\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        \\<forall>j\\<le>Suc n.\n           (\\<exists>la\\<in>{i. i \\<le> Suc n} - {j}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P l) \\<or>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A j \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> False", "apply (rotate_tac -1,\n         frule_tac a = l in forall_spec, simp,\n         thin_tac \"\\<forall>j\\<le>Suc n.\n           (\\<exists>la\\<in>{i. i \\<le> Suc n} - {j}. e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P l) \\<or>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A j \\<in> P l\",\n         thin_tac \"\\<forall>i\\<le>Suc n. \\<forall>j\\<le>Suc n. i = j \\<or> \\<not> P i \\<subseteq> P j\",\n         thin_tac \"\\<forall>i\\<le>Suc n. \\<not> A \\<subseteq> P i\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        (\\<exists>la\\<in>{i. i \\<le> Suc n} - {l}.\n            e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P l) \\<or>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A l \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> False", "apply (erule disjE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P l la.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        la \\<in> {i. i \\<le> Suc n} - {l};\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P l\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A l \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = la in forall_spec, simp,\n         thin_tac \"\\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}. e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i\",\n           (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n P l la.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        la \\<in> {i. i \\<le> Suc n} - {l};\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P l;\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<in> A;\n        \\<forall>l\\<in>{j. j \\<le> Suc n} - {la}.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<in> P l;\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A la \\<notin> P la\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A l \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> False", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n P l.\n       \\<lbrakk>ideal R A;\n        P \\<in> {j. j \\<le> Suc n} \\<rightarrow> {X. prime_ideal R X};\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> Suc n});\n        \\<forall>i\\<le>Suc n.\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> A \\<and>\n           (\\<forall>l\\<in>{j. j \\<le> Suc n} - {i}.\n               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<in> P l) \\<and>\n           e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A i \\<notin> P i;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> Suc n}.\n                               e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A\n                    i) n \\<plusminus>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A (Suc n)\n        \\<in> A;\n        l \\<le> Suc n; prime_ideal R (P l); ideal R (P l);\n        e\\<Pi>\\<^bsub>R,n\\<^esub> ppa R P A l \\<in> P l\\<rbrakk>\n       \\<Longrightarrow> False", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prime_ideal_cont1:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> (n::nat). \n     prime_ideal R (P i); A \\<subseteq> \\<Union> {X. (\\<exists>i \\<le> n. X = (P i))} \\<rbrakk> \\<Longrightarrow> \n     \\<exists>i\\<le> n. A\\<subseteq>(P i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. prime_ideal R (P i);\n     A \\<subseteq> \\<Union> {X. \\<exists>i\\<le>n. X = P i}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i\\<le>n. A \\<subseteq> P i", "apply (frule prime_ideal_cont1Tr[of A n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. prime_ideal R (P i);\n     A \\<subseteq> \\<Union> {X. \\<exists>i\\<le>n. X = P i};\n     \\<forall>P.\n        P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n        (\\<exists>i\\<le>n. A \\<subseteq> P i)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i\\<le>n. A \\<subseteq> P i", "apply (frule_tac a = P in forall_spec,\n       thin_tac \"\\<forall>P. P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and> \n       A \\<subseteq> \\<Union>(P ` {j. j \\<le> n}) \\<longrightarrow> (\\<exists>i\\<le>n. A \\<subseteq> P i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. prime_ideal R (P i);\n     A \\<subseteq> \\<Union> {X. \\<exists>i\\<le>n. X = P i}\\<rbrakk>\n    \\<Longrightarrow> P \\<in> {j. j \\<le> n} \\<rightarrow>\n                              {X. prime_ideal R X} \\<and>\n                      A \\<subseteq> \\<Union> (P ` {j. j \\<le> n})\n 2. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. prime_ideal R (P i);\n     A \\<subseteq> \\<Union> {X. \\<exists>i\\<le>n. X = P i};\n     \\<forall>P.\n        P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n        (\\<exists>i\\<le>n. A \\<subseteq> P i);\n     \\<exists>i\\<le>n. A \\<subseteq> P i\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i\\<le>n. A \\<subseteq> P i", "apply (rule conjI, simp,\n       rule subsetI, simp,\n       frule_tac c = x in subsetD[of A \"\\<Union>{X. \\<exists>i\\<le>n. X = P i}\"], assumption+,\n       simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. prime_ideal R (P i);\n     A \\<subseteq> \\<Union> {X. \\<exists>i\\<le>n. X = P i};\n     \\<forall>P.\n        P \\<in> {j. j \\<le> n} \\<rightarrow> {X. prime_ideal R X} \\<and>\n        A \\<subseteq> \\<Union> (P ` {j. j \\<le> n}) \\<longrightarrow>\n        (\\<exists>i\\<le>n. A \\<subseteq> P i);\n     \\<exists>i\\<le>n. A \\<subseteq> P i\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i\\<le>n. A \\<subseteq> P i", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_n_ideal_contTr0:\"(\\<forall>l\\<le> n. ideal R (J l)) \\<longrightarrow>\n                               i\\<Pi>\\<^bsub>R,n\\<^esub> J  \\<subseteq>  \\<Inter>{X. (\\<exists>k\\<le>n. X = (J k))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>l\\<le>n. ideal R (J l)) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,n\\<^esub> J\n    \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k}", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>l\\<le>0. ideal R (J l)) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,0\\<^esub> J\n    \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>0. X = J k}\n 2. \\<And>n.\n       (\\<forall>l\\<le>n. ideal R (J l)) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J\n       \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<Longrightarrow>\n       (\\<forall>l\\<le>Suc n. ideal R (J l)) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n       \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>Suc n. X = J k}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>l\\<le>n. ideal R (J l)) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J\n       \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<Longrightarrow>\n       (\\<forall>l\\<le>Suc n. ideal R (J l)) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n       \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>Suc n. X = J k}", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>l\\<le>n. ideal R (J l)) \\<longrightarrow>\n                i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (cut_tac n = n in Nsetn_sub_mem1,\n         simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (cut_tac n = n in n_prod_ideal[of _ J], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (cut_tac I = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" and J = \"J (Suc n)\" in \n             ideal_prod_sub_Int)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc n))\n 3. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply assumption"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc n))\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (frule_tac A = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> J (Suc n)\" and \n        B = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\" and\n        C = \"\\<Inter>{X. \\<exists>k\\<le> n. X = J k} \\<inter> J (Suc n)\" in subset_trans)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                                     J (Suc n)\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                    J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (rule_tac A = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" and B = \"\\<Inter>{X. \\<exists>k\\<le>n. X = J k}\" and \n        C = \"J (Suc n)\" in inter_mono, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                    J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (rule_tac A = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\" and\n                 B = \"\\<Inter>{X. \\<exists>k\\<le> n. X = J k} \\<inter> J (Suc n)\" and\n                 C = \"\\<Inter>{X. \\<exists>k\\<le> (Suc n). X = J k}\" in subset_trans,\n         assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                    J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                         J (Suc n)\n                         \\<subseteq> \\<Inter>\n{X. \\<exists>k\\<le>Suc n. X = J k}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<inter> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                    J (Suc n);\n        x \\<in> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<inter>\n                J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> \\<Inter> {X. \\<exists>k\\<le>Suc n. X = J k}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        (\\<forall>xa.\n            (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow>\n            x \\<in> xa) \\<and>\n        x \\<in> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            (\\<exists>k\\<le>Suc n.\n                                xa = J k) \\<longrightarrow>\n                            x \\<in> xa", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        (\\<forall>xa.\n            (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow>\n            x \\<in> xa) \\<and>\n        x \\<in> J (Suc n);\n        \\<exists>k\\<le>Suc n. xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc n); k \\<le> Suc n; xa = J k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (case_tac \"k = Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc n); k \\<le> Suc n; xa = J k;\n        k \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (frule_tac m = k and n = \"Suc n\" in noteq_le_less, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc n); k \\<le> Suc n; xa = J k; k \\<noteq> Suc n;\n        k < Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (thin_tac \" k \\<le> Suc n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>l\\<le>Suc n. ideal R (J l);\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc n); xa = J k; k \\<noteq> Suc n; k < Suc n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (frule_tac x = k and n = \"Suc n\" in less_le_diff,\n         thin_tac \"k < Suc n\", simp, thin_tac \"\\<forall>l\\<le>Suc n. ideal R (J l)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n x xa k.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J\n                \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> i\\<Pi>\\<^bsub>R,n\\<^esub> J;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> J (Suc n);\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        x \\<in> J (Suc n); xa = J k; k \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J k", "apply (frule_tac a = xa in forall_spec, blast,\n         thin_tac \"\\<forall>xa. (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa\",\n         simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_n_ideal_contTr:\"\\<lbrakk>\\<forall>l\\<le> n. ideal R (J l)\\<rbrakk> \\<Longrightarrow>\n             i\\<Pi>\\<^bsub>R,n\\<^esub> J  \\<subseteq>  \\<Inter>{X. (\\<exists>k \\<le> n. X = (J k))}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l\\<le>n. ideal R (J l) \\<Longrightarrow>\n    i\\<Pi>\\<^bsub>R,n\\<^esub> J\n    \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k}", "apply (simp add:prod_n_ideal_contTr0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_n_ideal_cont2:\"\\<lbrakk>\\<forall>l\\<le> (n::nat). ideal R (J l); \n     prime_ideal R P; \\<Inter>{X. (\\<exists>k\\<le> n. X = (J k))} \\<subseteq> P\\<rbrakk> \\<Longrightarrow> \n     \\<exists>l\\<le> n. (J l) \\<subseteq> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l \\<subseteq> P", "apply (frule prod_n_ideal_contTr[of n J])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<subseteq> P;\n     i\\<Pi>\\<^bsub>R,n\\<^esub> J\n     \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l \\<subseteq> P", "apply (frule_tac A = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" and B = \"\\<Inter>{X. \\<exists>k\\<le> n. X = J k}\" and C = P \n       in subset_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<subseteq> P;\n     i\\<Pi>\\<^bsub>R,n\\<^esub> J\n     \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n     i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l \\<subseteq> P", "apply (thin_tac \"\\<Inter>{X. \\<exists>k\\<le> n. X = J k} \\<subseteq> P\",\n       thin_tac \"i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> \\<Inter>{X. \\<exists>k\\<le> n. X = J k}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l \\<subseteq> P", "apply (simp add:ideal_n_prod_prime)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_n_ideal_cont3:\"\\<lbrakk>\\<forall>l\\<le> (n::nat). ideal R (J l); \n      prime_ideal R P; \\<Inter>{X. (\\<exists>k\\<le> n. X = (J k))} = P\\<rbrakk> \\<Longrightarrow> \n      \\<exists>l\\<le> n. (J l) = P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l = P", "apply (frule prod_n_ideal_cont2[of n J P], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> {X. \\<exists>k\\<le>n. X = J k} \\<subseteq> P\n 2. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n     \\<exists>l\\<le>n. J l \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l = P", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n     \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n     \\<exists>l\\<le>n. J l \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>l\\<le>n. J l = P", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>n. J l = P", "apply (subgoal_tac \"J l = P\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P; J l = P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>l\\<le>n. J l = P\n 2. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> J l = P", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> J l = P", "apply (rule equalityI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> P \\<subseteq> J l", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l x.\n       \\<lbrakk>\\<forall>l\\<le>n. ideal R (J l); prime_ideal R P;\n        \\<Inter> {X. \\<exists>k\\<le>n. X = J k} = P;\n        l \\<le> n \\<and> J l \\<subseteq> P; x \\<in> P\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J l", "apply (rotate_tac -4, frule sym, thin_tac \"\\<Inter>{X. \\<exists>k\\<le> n. X = J k} = P\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l x.\n       \\<lbrakk>prime_ideal R P; l \\<le> n \\<and> J l \\<subseteq> P;\n        x \\<in> P; \\<forall>l\\<le>n. ideal R (J l);\n        P = \\<Inter> {X. \\<exists>k\\<le>n. X = J k}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J l", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l x.\n       \\<lbrakk>prime_ideal R (\\<Inter> {X. \\<exists>k\\<le>n. X = J k});\n        l \\<le> n \\<and>\n        J l \\<subseteq> \\<Inter> {X. \\<exists>k\\<le>n. X = J k};\n        \\<forall>xa.\n           (\\<exists>k\\<le>n. xa = J k) \\<longrightarrow> x \\<in> xa;\n        \\<forall>l\\<le>n. ideal R (J l);\n        P = \\<Inter> {X. \\<exists>k\\<le>n. X = J k}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J l", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ideal_quotient :: \"[_ , 'a set, 'a set] \\<Rightarrow> 'a set\" where\n  \"ideal_quotient R A B = {x| x. x \\<in> carrier R \\<and> (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b \\<in> A)}\""], ["", "abbreviation\n  IDEALQT  (\"(3_/ \\<dagger>\\<^sub>_/ _)\" [82,82,83]82) where\n  \"A \\<dagger>\\<^sub>R B == ideal_quotient R A B\""], ["", "lemma (in Ring) ideal_quotient_is_ideal:\n  \"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> ideal R (ideal_quotient R A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> ideal R (A \\<dagger>\\<^sub>R B)", "apply (rule ideal_condition)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<noteq> {}\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 4. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule subsetI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<noteq> {}\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 4. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_quotient_def CollectI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<noteq> {}\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_quotient_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (subgoal_tac \"\\<forall>b\\<in>B. \\<zero> \\<cdot>\\<^sub>r b \\<in> A\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R;\n     \\<forall>b\\<in>B. \\<zero> \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\n 2. \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>B. \\<zero> \\<cdot>\\<^sub>r b \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 4. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>B. \\<zero> \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ballI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R;\n        b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (frule_tac h = b in ideal_subset[of B], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R; b \\<in> B;\n        b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (frule_tac x = b in ring_times_0_x )"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>ideal R A; ideal R B; \\<zero> \\<in> carrier R; b \\<in> B;\n        b \\<in> carrier R; \\<zero> \\<cdot>\\<^sub>r b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                         \\<forall>y\\<in>A \\<dagger>\\<^sub>R B.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> A \\<dagger>\\<^sub>R B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<dagger>\\<^sub>R B;\n        y \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y\n                         \\<in> A \\<dagger>\\<^sub>R B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_quotient_def, (erule conjE)+,\n        rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                            \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ideal_pOp_closed)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> ideal R (carrier R)\n 2. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 4. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                            \\<in> A\n 5. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:whole_ideal, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                            \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                            \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                            \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> -\\<^sub>a y) \\<cdot>\\<^sub>r b\n                         \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (subst ring_distrib2)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier R\n 2. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 4. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<plusminus>\n                         (-\\<^sub>a y) \\<cdot>\\<^sub>r b\n                         \\<in> A\n 5. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_subset, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<plusminus>\n                         (-\\<^sub>a y) \\<cdot>\\<^sub>r b\n                         \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (cut_tac ring_is_ag, simp add: aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<plusminus>\n                         (-\\<^sub>a y) \\<cdot>\\<^sub>r b\n                         \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (frule_tac a1 = y and b1 = b in ring_inv1_1 [THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier R\n 2. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B;\n        (-\\<^sub>a y) \\<cdot>\\<^sub>r b =\n        -\\<^sub>a y \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<plusminus>\n                         (-\\<^sub>a y) \\<cdot>\\<^sub>r b\n                         \\<in> A\n 3. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_subset, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B;\n        (-\\<^sub>a y) \\<cdot>\\<^sub>r b =\n        -\\<^sub>a y \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<plusminus>\n                         -\\<^sub>a y \\<cdot>\\<^sub>r b\n                         \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ideal_pOp_closed, assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y b.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; y \\<in> carrier R;\n        \\<forall>b\\<in>B. y \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B;\n        (-\\<^sub>a y) \\<cdot>\\<^sub>r b =\n        -\\<^sub>a y \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a y \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ideal_inv1_closed, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>A \\<dagger>\\<^sub>R B.\n                            r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> A \\<dagger>\\<^sub>R B", "apply (simp add:ideal_quotient_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B.\n                             r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> carrier R\n 2. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> carrier R\n 2. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A", "apply (simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x b.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r b \\<in> A", "apply (subst ring_tOp_assoc, assumption+, simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x b.\n       \\<lbrakk>ideal R A; ideal R B; r \\<in> carrier R; x \\<in> carrier R;\n        \\<forall>b\\<in>B. x \\<cdot>\\<^sub>r b \\<in> A; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r b) \\<in> A", "apply (simp add:ideal_ring_multiple [of \"A\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \\<open>Addition of finite elements of a ring and \\<open>ideal_multiplication\\<close>\\<close>"], ["", "text\\<open>We consider sum in an abelian group\\<close>"], ["", "lemma (in aGroup) nsum_mem1Tr:\" A +> J  \\<Longrightarrow>  \n                     (\\<forall>j \\<le> n. f j \\<in> J)  \\<longrightarrow> nsum A f n \\<in> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> J \\<Longrightarrow>\n    (\\<forall>j\\<le>n. f j \\<in> J) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f n \\<in> J", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. A +> J \\<Longrightarrow>\n    (\\<forall>j\\<le>0. f j \\<in> J) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 \\<in> J\n 2. \\<And>n.\n       \\<lbrakk>A +> J;\n        (\\<forall>j\\<le>n. f j \\<in> J) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e A f n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> J) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e A f Suc n \\<in> J", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A +> J; \\<forall>j\\<le>0. f j \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f 0 \\<in> J\n 2. \\<And>n.\n       \\<lbrakk>A +> J;\n        (\\<forall>j\\<le>n. f j \\<in> J) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e A f n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> J) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e A f Suc n \\<in> J", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A +> J;\n        (\\<forall>j\\<le>n. f j \\<in> J) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e A f n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> J) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e A f Suc n \\<in> J", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A +> J;\n        (\\<forall>j\\<le>n. f j \\<in> J) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e A f n \\<in> J;\n        \\<forall>j\\<le>Suc n. f j \\<in> J\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n \\<in> J", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A +> J; \\<Sigma>\\<^sub>e A f n \\<in> J;\n        \\<forall>j\\<le>Suc n. f j \\<in> J\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n)\n                         \\<in> J", "apply (rule asubg_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A +> J; \\<Sigma>\\<^sub>e A f n \\<in> J;\n        \\<forall>j\\<le>Suc n. f j \\<in> J\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> J", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) fSum_mem:\"\\<lbrakk>\\<forall>j \\<in> nset (Suc n) m. f j \\<in> carrier A; n < m\\<rbrakk> \\<Longrightarrow>\n                   fSum A f (Suc n) m \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A;\n     n < m\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f Suc n m \\<in> carrier A", "apply (simp add:fSum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A;\n     n < m\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) (m - Suc n)\n                      \\<in> carrier A", "apply (rule nsum_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A;\n     n < m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m - Suc n.\n                         cmp f (slide (Suc n)) j \\<in> carrier A", "apply (rule allI, simp add:cmp_def slide_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A;\n        n < m\\<rbrakk>\n       \\<Longrightarrow> j \\<le> m - Suc n \\<longrightarrow>\n                         f (Suc (n + j)) \\<in> carrier A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A; n < m;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> f (Suc (n + j)) \\<in> carrier A", "apply (frule_tac x = \"Suc (n + j)\" in bspec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A; n < m;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> Suc (n + j) \\<in> nset (Suc n) m\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>nset (Suc n) m. f j \\<in> carrier A; n < m;\n        j \\<le> m - Suc n; f (Suc (n + j)) \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (Suc (n + j)) \\<in> carrier A", "apply (simp add:nset_def, arith)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_mem1:\"\\<lbrakk>A +> J; \\<forall>j \\<le> n. f j \\<in> J\\<rbrakk> \\<Longrightarrow> nsum A f n \\<in> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> J; \\<forall>j\\<le>n. f j \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<in> J", "apply (simp add:nsum_mem1Tr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_eq_i:\"\\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; \\<forall>j\\<le>n. g j \\<in> carrier A;\n i \\<le> n; \\<forall>l \\<le> i. f l = g l\\<rbrakk> \\<Longrightarrow> nsum A f i = nsum A g i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A; i \\<le> n;\n     \\<forall>l\\<le>i. f l = g l\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f i = \\<Sigma>\\<^sub>e A g i", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A; i \\<le> n;\n     \\<forall>l\\<le>i. f l = g l\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>i. f j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A; i \\<le> n;\n     \\<forall>l\\<le>i. f l = g l\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>i. g j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A; i \\<le> n;\n     \\<forall>l\\<le>i. f l = g l\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>i. f j = g j", "apply (rule allI, rule impI, simp)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_cmp_eq:\"\\<lbrakk>f \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> carrier A; \n h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};  h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; i \\<le> n\\<rbrakk> \\<Longrightarrow>\n nsum A (cmp f (cmp h2 h1)) i = nsum A (cmp (cmp f h2) h1) i\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (cmp h2 h1) i =\n                      \\<Sigma>\\<^sub>e A cmp (cmp f h2) h1 i", "apply (rule nsum_eq_i [of n \"cmp f (cmp h2 h1)\" \"cmp (cmp f h2) h1\" i])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp f (cmp h2 h1) j \\<in> carrier A\n 2. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp (cmp f h2) h1 j \\<in> carrier A\n 3. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> n\n 4. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>i.\n                         cmp f (cmp h2 h1) l = cmp (cmp f h2) h1 l", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n        h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; i \\<le> n;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (h2 (h1 j)) \\<in> carrier A\n 2. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp (cmp f h2) h1 j \\<in> carrier A\n 3. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> n\n 4. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>i.\n                         cmp f (cmp h2 h1) l = cmp (cmp f h2) h1 l", "apply ((rule funcset_mem, assumption)+, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp (cmp f h2) h1 j \\<in> carrier A\n 2. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> n\n 3. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>i.\n                         cmp f (cmp h2 h1) l = cmp (cmp f h2) h1 l", "apply (rule allI, rule impI, simp add:cmp_def,\n        (rule funcset_mem, assumption)+, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h1 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h2 \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>i.\n                         cmp f (cmp h2 h1) l = cmp (cmp f h2) h1 l", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_cmp_eq_transpos:\"\\<lbrakk> \\<forall>j\\<le>(Suc n). f j \\<in> carrier A; \n       i \\<le> n;i \\<noteq> n \\<rbrakk> \\<Longrightarrow>\n nsum A (cmp f (cmp (transpos i n) (cmp (transpos n (Suc n)) (transpos i n))))\n (Suc n) = nsum A (cmp f (transpos i (Suc n))) (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (cmp (transpos i n) (cmp (transpos n (Suc n)) (transpos i n))) Suc n =\n                      \\<Sigma>\\<^sub>e A cmp f (transpos i (Suc n)) Suc n", "apply (rule nsum_eq [of \"Suc n\" \"cmp f (cmp (transpos i n) \n                            (cmp (transpos n (Suc n)) (transpos i n)))\" \n       \"cmp f (transpos i (Suc n))\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (transpos i n\n                             (transpos n (Suc n) (transpos i n j)))\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (cut_tac i = i and n = \"Suc n\" and j = n and l = j in transpos_mem,\n       simp+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n; transpos i n j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (transpos i n\n                             (transpos n (Suc n) (transpos i n j)))\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (cut_tac i = n and n = \"Suc n\" and j = \"Suc n\" and l = \"transpos i n j\"\n        in transpos_mem, simp+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n; transpos i n j \\<le> Suc n;\n        transpos n (Suc n) (transpos i n j) \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (transpos i n\n                             (transpos n (Suc n) (transpos i n j)))\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (cut_tac i = i and n = \"Suc n\" and j = n and\n        l = \"transpos n (Suc n) (transpos i n j)\" in transpos_mem,\n       simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (transpos i (Suc n) j) \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (cut_tac i = i and n = \"Suc n\" and j = \"Suc n\" and l = j in transpos_mem,\n       simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n     i \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc n.\n                         cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> cmp f\n                          (cmp (transpos i n)\n                            (cmp (transpos n (Suc n)) (transpos i n)))\n                          j =\n                         cmp f (transpos i (Suc n)) j", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; i \\<le> n;\n        i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> f (transpos i n\n                             (transpos n (Suc n) (transpos i n j))) =\n                         f (transpos i (Suc n) j)", "apply (thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> carrier A\",\n        rule eq_elems_eq_val[of _ _ f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>i \\<le> n; i \\<noteq> n; j \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> transpos i n\n                          (transpos n (Suc n) (transpos i n j)) =\n                         transpos i (Suc n) j", "apply (simp add:transpos_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma transpos_Tr_n1:\"Suc (Suc 0) \\<le> n \\<Longrightarrow> \n                           transpos (n - Suc 0) n n = n - Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc (Suc 0) \\<le> n \\<Longrightarrow>\n    transpos (n - Suc 0) n n = n - Suc 0", "apply (simp add:transpos_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma transpos_Tr_n2:\"Suc (Suc 0) \\<le> n \\<Longrightarrow> \n               transpos (n - (Suc 0)) n (n - (Suc 0)) = n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc (Suc 0) \\<le> n \\<Longrightarrow>\n    transpos (n - Suc 0) n (n - Suc 0) = n", "apply (simp add:transpos_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) additionTr0:\"\\<lbrakk>0 < n; \\<forall>j \\<le> n. f j \\<in> carrier A\\<rbrakk>\n \\<Longrightarrow> nsum A (cmp f (transpos (n - 1) n)) n = nsum A f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (case_tac \"n \\<le> 1\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     n \\<le> Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos 0 n) n =\n                      \\<Sigma>\\<^sub>e A f n\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (frule Suc_leI [of \"0\" \"n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A; n \\<le> Suc 0;\n     Suc 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos 0 n) n =\n                      \\<Sigma>\\<^sub>e A f n\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (frule le_antisym [of \"n\" \"Suc 0\"], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc 0. f j \\<in> carrier A; n = Suc 0\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos 0 (Suc 0)) 0 \\<plusminus>\n                      cmp f (transpos 0 (Suc 0)) (Suc 0) =\n                      f 0 \\<plusminus> f (Suc 0)\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc 0. f j \\<in> carrier A; n = Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (transpos 0 (Suc 0) 0) \\<plusminus>\n                      f (transpos 0 (Suc 0) (Suc 0)) =\n                      f 0 \\<plusminus> f (Suc 0)\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (subst transpos_ij_1[of 0 \"Suc 0\"], simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc 0. f j \\<in> carrier A; n = Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (Suc 0) \\<plusminus>\n                      f (transpos 0 (Suc 0) (Suc 0)) =\n                      f 0 \\<plusminus> f (Suc 0)\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (subst transpos_ij_2[of 0 \"Suc 0\"], simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc 0. f j \\<in> carrier A; n = Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (Suc 0) \\<plusminus> f 0 =\n                      f 0 \\<plusminus> f (Suc 0)\n 2. \\<lbrakk>0 < n; \\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> 1\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - 1) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (rule ag_pOp_commute, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<not> n \\<le> Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (frule not_le_imp_less[of n \"Suc 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; \\<not> n \\<le> Suc 0;\n     Suc 0 < n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (frule_tac Suc_leI [of \"Suc 0\" \"n\"],\n       thin_tac \"\\<not> n \\<le> Suc 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc 0 < n;\n     Suc (Suc 0) \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (cut_tac nsum_suc[of A f \"n - Suc 0\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) \\<le> n;\n     \\<Sigma>\\<^sub>e A f n =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (cut_tac nsum_suc[of A \"cmp f (transpos (n - Suc 0) n)\" \"n - Suc 0\"], \n        simp,\n        thin_tac \"\\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n\",\n        thin_tac \"\\<Sigma>\\<^sub>e A (cmp f (transpos (n - Suc 0) n)) n =\n     \\<Sigma>\\<^sub>e A (cmp f (transpos (n - Suc 0) n)) (n - Suc 0) \\<plusminus>\n     (cmp f (transpos (n - Suc 0) n) n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     Suc (Suc 0) \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (case_tac \"n = Suc (Suc 0)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> cmp f (transpos (Suc 0) (Suc (Suc 0))) 0 \\<plusminus>\n                      cmp f (transpos (Suc 0) (Suc (Suc 0)))\n                       (Suc 0) \\<plusminus>\n                      cmp f (transpos (Suc 0) (Suc (Suc 0))) (Suc (Suc 0)) =\n                      f 0 \\<plusminus> f (Suc 0) \\<plusminus>\n                      f (Suc (Suc 0))\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) \\<le> n;\n     n \\<noteq> Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (cut_tac transpos_id_1[of \"Suc 0\" \"Suc (Suc 0)\" \"Suc (Suc 0)\" 0],\n        cut_tac transpos_ij_1[of \"Suc 0\" \"Suc (Suc 0)\" \"Suc (Suc 0)\"],\n        cut_tac transpos_ij_2[of \"Suc 0\" \"Suc (Suc 0)\" \"Suc (Suc 0)\"],\n        simp add:cmp_def,\n        thin_tac \"n = Suc (Suc 0)\",\n        thin_tac \"transpos (Suc 0) (Suc (Suc 0)) 0 = 0\",\n        thin_tac \"transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\",\n        thin_tac \"transpos (Suc 0) (Suc (Suc 0)) (Suc (Suc 0)) = Suc 0\")"], ["proof (prove)\ngoal (14 subgoals):\n 1. \\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A \\<Longrightarrow>\n    f 0 \\<plusminus> f (Suc (Suc 0)) \\<plusminus> f (Suc 0) =\n    f 0 \\<plusminus> f (Suc 0) \\<plusminus> f (Suc (Suc 0))\n 2. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 3. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 4. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 5. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 6. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 7. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 8. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 9. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 10. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n      n = Suc (Suc 0)\\<rbrakk>\n     \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\nA total of 14 subgoals...", "apply (subst ag_pOp_assoc, simp+)"], ["proof (prove)\ngoal (14 subgoals):\n 1. \\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A \\<Longrightarrow>\n    f 0 \\<plusminus> (f (Suc (Suc 0)) \\<plusminus> f (Suc 0)) =\n    f 0 \\<plusminus> f (Suc 0) \\<plusminus> f (Suc (Suc 0))\n 2. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 3. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 4. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 5. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 6. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 7. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 8. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 9. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 10. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n      n = Suc (Suc 0)\\<rbrakk>\n     \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\nA total of 14 subgoals...", "apply (subst ag_pOp_commute[of \"f (Suc (Suc 0))\" \"f (Suc 0)\"], simp+)"], ["proof (prove)\ngoal (14 subgoals):\n 1. \\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A \\<Longrightarrow>\n    f 0 \\<plusminus> (f (Suc 0) \\<plusminus> f (Suc (Suc 0))) =\n    f 0 \\<plusminus> f (Suc 0) \\<plusminus> f (Suc (Suc 0))\n 2. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 3. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 4. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0;\n     transpos (Suc 0) (Suc (Suc 0)) (Suc 0) = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 5. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 6. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 7. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0); transpos (Suc 0) (Suc (Suc 0)) 0 = 0\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\n 8. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc 0 \\<le> Suc (Suc 0)\n 9. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n     n = Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc 0) \\<le> Suc (Suc 0)\n 10. \\<lbrakk>\\<forall>j\\<le>Suc (Suc 0). f j \\<in> carrier A;\n      n = Suc (Suc 0)\\<rbrakk>\n     \\<Longrightarrow> Suc 0 \\<noteq> Suc (Suc 0)\nA total of 14 subgoals...", "apply (subst ag_pOp_assoc[THEN sym], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) \\<le> n;\n     n \\<noteq> Suc (Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (frule not_sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) \\<le> n;\n     n \\<noteq> Suc (Suc 0); Suc (Suc 0) \\<noteq> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (frule noteq_le_less[of \"Suc (Suc 0)\" n], assumption,\n        thin_tac \"Suc (Suc 0) \\<le> n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (cut_tac nsum_suc[of A f \"n - Suc 0 - Suc 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc 0) \\<plusminus> f n", "apply (cut_tac Suc_pred[of \"n - Suc 0\"], simp del:nsum_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f (n - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus> f (n - Suc 0);\n     Suc (n - Suc (Suc 0)) = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac nsum_suc[of A \"cmp f (transpos (n - Suc 0) n)\"  \n                \"n - Suc (Suc 0)\"], simp del:nsum_suc,\n     thin_tac \"\\<Sigma>\\<^sub>e A f (n - Suc 0) = \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus> f (n - Suc 0)\",\n     thin_tac \"Suc (n - Suc (Suc 0)) = n - Suc 0\",\n     thin_tac \"\\<Sigma>\\<^sub>e A (cmp f (transpos (n - Suc 0) n)) (n - Suc 0) =\n     \\<Sigma>\\<^sub>e A (cmp f (transpos (n - Suc 0) n)) (n - Suc (Suc 0)) \\<plusminus>\n     (cmp f (transpos (n - Suc 0) n)) (n - Suc 0)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (n - Suc 0) n) (n - Suc (Suc 0)) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n)\n                       (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac nsum_eq_i[of n \"cmp f (transpos (n - Suc 0) n)\" f \n                 \"n - Suc (Suc 0)\"], simp,   \n        thin_tac \"\\<Sigma>\\<^sub>e A (cmp f (transpos (n - Suc 0) n)) (n - Suc (Suc 0)) =\n     \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0))\")"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n)\n                       (n - Suc 0) \\<plusminus>\n                      cmp f (transpos (n - Suc 0) n) n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (transpos (n - Suc 0) n (n - Suc 0)) \\<plusminus>\n                      f (transpos (n - Suc 0) n n) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac transpos_ij_1[of \"n - Suc 0\" n n], simp)"], ["proof (prove)\ngoal (9 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f n \\<plusminus>\n                      f (transpos (n - Suc 0) n n) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac transpos_ij_2[of \"n - Suc 0\" n n], simp)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f n \\<plusminus>\n                      f (n - Suc 0) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\nA total of 12 subgoals...", "apply (subst ag_pOp_assoc,\n        rule nsum_mem, rule allI, rule impI)"], ["proof (prove)\ngoal (15 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        transpos (n - Suc 0) n (n - Suc 0) = n;\n        transpos (n - Suc 0) n n = n - Suc 0;\n        j \\<le> n - Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (n - Suc 0) \\<in> carrier A\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      (f n \\<plusminus> f (n - Suc 0)) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc 0 \\<noteq> n\nA total of 15 subgoals...", "apply (frule_tac x = j and y = \"n - Suc (Suc 0)\" and z = n in \n        le_less_trans, simp, frule_tac x = j and y = n in less_imp_le)"], ["proof (prove)\ngoal (15 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        transpos (n - Suc 0) n (n - Suc 0) = n;\n        transpos (n - Suc 0) n n = n - Suc 0; j \\<le> n - Suc (Suc 0);\n        j < n; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (n - Suc 0) \\<in> carrier A\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      (f n \\<plusminus> f (n - Suc 0)) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc 0 \\<noteq> n\nA total of 15 subgoals...", "apply simp+"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      (f n \\<plusminus> f (n - Suc 0)) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\nA total of 12 subgoals...", "apply (subst ag_pOp_commute[of \"f n\"], simp, simp)"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      (f (n - Suc 0) \\<plusminus> f n) =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\nA total of 12 subgoals...", "apply (subst ag_pOp_assoc[THEN sym],\n         rule nsum_mem, rule allI, rule impI,\n         frule_tac x = j and y = \"n - Suc (Suc 0)\" and z = n in \n         le_less_trans, simp, frule_tac x = j and y = n in less_imp_le)"], ["proof (prove)\ngoal (15 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        transpos (n - Suc 0) n (n - Suc 0) = n;\n        transpos (n - Suc 0) n n = n - Suc 0; j \\<le> n - Suc (Suc 0);\n        j < n; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f (n - Suc 0) \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> f n \\<in> carrier A\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n;\n     transpos (n - Suc 0) n n = n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n =\n                      \\<Sigma>\\<^sub>e A f (n - Suc (Suc 0)) \\<plusminus>\n                      f (n - Suc 0) \\<plusminus>\n                      f n\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 6. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 7. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n     transpos (n - Suc 0) n (n - Suc 0) = n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<noteq> n\n 8. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc 0 \\<le> n\n 9. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n \\<le> n\n 10. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n      Suc (Suc 0) < n\\<rbrakk>\n     \\<Longrightarrow> n - Suc 0 \\<noteq> n\nA total of 15 subgoals...", "apply simp+"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp f (transpos (n - Suc 0) n) j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n j) \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> n - Suc (Suc 0) \\<le> n\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 5. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac i = \"n - Suc 0\" and n = n and j = n and l = j in transpos_mem,\n        simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n - Suc (Suc 0).\n                         cmp f (transpos (n - Suc 0) n) l = f l\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> cmp f (transpos (n - Suc 0) n) l = f l\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n l) = f l\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac i = \"n - Suc 0\" and n = n and j = n and x = l in transpos_id,\n        simp+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> l \\<le> n \\<and>\n                         l \\<noteq> n - Suc 0 \\<and> l \\<noteq> n\n 2. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); transpos (n - Suc 0) n l = l\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n l) = f l\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply (cut_tac x = l and y = \"n - Suc (Suc 0)\" and z = n in le_less_trans,\n        assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0)\\<rbrakk>\n       \\<Longrightarrow> n - Suc (Suc 0) < n\n 2. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); l < n\\<rbrakk>\n       \\<Longrightarrow> l \\<le> n \\<and>\n                         l \\<noteq> n - Suc 0 \\<and> l \\<noteq> n\n 3. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); transpos (n - Suc 0) n l = l\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n l) = f l\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); l < n\\<rbrakk>\n       \\<Longrightarrow> l \\<le> n \\<and>\n                         l \\<noteq> n - Suc 0 \\<and> l \\<noteq> n\n 2. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); transpos (n - Suc 0) n l = l\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n l) = f l\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply arith"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; Suc (Suc 0) < n;\n        l \\<le> n - Suc (Suc 0); transpos (n - Suc 0) n l = l\\<rbrakk>\n       \\<Longrightarrow> f (transpos (n - Suc 0) n l) = f l\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; n \\<noteq> Suc (Suc 0);\n     Suc (Suc 0) \\<noteq> n; Suc (Suc 0) < n;\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0 - Suc 0) =\n     \\<Sigma>\\<^sub>e A f (n - Suc 0 - Suc 0) \\<plusminus>\n     f (Suc (n - Suc 0 - Suc 0))\\<rbrakk>\n    \\<Longrightarrow> 0 < n - Suc 0", "apply arith"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) additionTr1:\"\\<lbrakk> \\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> {j. j\\<le>(Suc n)} \\<and> inj_on h {j. j\\<le>(Suc n)} \\<longrightarrow>\n       nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n       f \\<in> {j. j\\<le>(Suc (Suc n))} \\<rightarrow> carrier A; \n       h \\<in> {j. j\\<le>(Suc (Suc n))} \\<rightarrow> {j. j\\<le>(Suc (Suc n))}; \n       inj_on h {j. j\\<le>(Suc (Suc n))}; h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n        \\<Longrightarrow> nsum A (cmp f h) (Suc (Suc n)) = nsum A f (Suc (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subgoal_tac \"f \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> carrier A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (subgoal_tac \"h \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> {j. j\\<le>(Suc n)}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (subgoal_tac \"inj_on h {j. j\\<le>(Suc n)}\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (subgoal_tac \"nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n};\n     \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                      \\<Sigma>\\<^sub>e A f Suc n\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 5. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (thin_tac \"\\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j\\<le>(Suc n)} \\<rightarrow> {j. j\\<le>(Suc n)} \\<and> inj_on h {j. j\\<le>(Suc n)} \\<longrightarrow>\n       nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n};\n     \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                      \\<Sigma>\\<^sub>e A f Suc n\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 5. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "prefer 2"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                      \\<Sigma>\\<^sub>e A f Suc n\n 2. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n};\n     \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 5. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n};\n     \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n};\n     \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n     \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      f (Suc n) \\<plusminus>\n                      cmp f h (Suc (Suc n)) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      f (Suc n) \\<plusminus>\n                      f (Suc (Suc n))\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (thin_tac \"nsum A (cmp f h) n \\<plusminus> (cmp f h (Suc n)) =  nsum A f n \\<plusminus> (f (Suc n))\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      f (Suc n) \\<plusminus>\n                      cmp f h (Suc (Suc n)) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      f (Suc n) \\<plusminus>\n                      f (Suc (Suc n))\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (thin_tac \"\\<forall>f h. (f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A) \\<and>\n           (h \\<in> {j. j\\<le>Suc n} \\<rightarrow> {j. j\\<le>Suc n}) \\<and> (inj_on h {j. j\\<le>Suc n}) \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A (cmp f h) (Suc n) = \\<Sigma>\\<^sub>e A f (Suc n)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (frule Nset_injTr0 [of \"h\" \"Suc n\"], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)}; h (Suc (Suc n)) = Suc (Suc n);\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                              {j. j \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (frule Nset_injTr0 [of \"h\" \"Suc n\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n             {j. j \\<le> Suc (Suc n)};\n     inj_on h {j. j \\<le> Suc (Suc n)};\n     h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) additionTr1_1:\"\\<lbrakk>\\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>Suc n} \\<rightarrow> carrier A \\<and>\n      h \\<in> {j. j\\<le>Suc n} \\<rightarrow> {j. j\\<le>Suc n} \\<and> inj_on h {j. j\\<le>Suc n} \\<longrightarrow>\n      nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n      f \\<in> {j. j\\<le>Suc (Suc n)} \\<rightarrow> carrier A; i \\<le> n\\<rbrakk> \\<Longrightarrow> \n    nsum A (cmp f (transpos i (Suc n))) (Suc (Suc n)) = nsum A f (Suc (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc n)) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule additionTr1 [of \"n\" \"f\" \"transpos i (Suc n)\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n)\n                      \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                            {j. j \\<le> Suc (Suc n)}\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos i (Suc n)) {j. j \\<le> Suc (Suc n)}\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n) (Suc (Suc n)) = Suc (Suc n)", "apply (rule transpos_hom [of \"i\" \"Suc (Suc n)\" \"Suc n\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> Suc n \\<le> Suc (Suc n)\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<noteq> Suc n\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos i (Suc n)) {j. j \\<le> Suc (Suc n)}\n 5. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n) (Suc (Suc n)) = Suc (Suc n)", "apply simp+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos i (Suc n)) {j. j \\<le> Suc (Suc n)}\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n) (Suc (Suc n)) = Suc (Suc n)", "apply (rule transpos_inj [of \"i\" \"Suc (Suc n)\" \"Suc n\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> Suc n \\<le> Suc (Suc n)\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<noteq> Suc n\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n) (Suc (Suc n)) = Suc (Suc n)", "apply simp+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> transpos i (Suc n) (Suc (Suc n)) = Suc (Suc n)", "apply (subst transpos_id[of i \"Suc (Suc n)\" \"Suc n\" \"Suc (Suc n)\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<le> Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> Suc n \\<le> Suc (Suc n)\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> i \\<noteq> Suc n\n 4. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc n)\n                      \\<in> {k. k \\<le> Suc (Suc n)} - {i, Suc n}\n 5. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h n \\<plusminus> cmp f h (Suc n) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> Suc (Suc n) = Suc (Suc n)", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) additionTr1_2:\"\\<lbrakk>\\<forall>f. \\<forall>h. f \\<in> {j. j\\<le>Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j\\<le>Suc n} \\<rightarrow> {j. j\\<le>Suc n} \\<and> \n          inj_on h {j. j\\<le>Suc n} \\<longrightarrow>\n          nsum A (cmp f h) (Suc n) = nsum A f (Suc n); \n         f \\<in> {j. j\\<le> Suc (Suc n)} \\<rightarrow> carrier A; i \\<le> (Suc n)\\<rbrakk> \\<Longrightarrow> \n       nsum A (cmp f (transpos i (Suc (Suc n)))) (Suc (Suc n)) = \n                                             nsum A f (Suc (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (case_tac \"i = Suc n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i = Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp del:nsum_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i = Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos (Suc n) (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac additionTr0 [of \"Suc (Suc n)\" \"f\"], simp, simp,\n         rule allI, rule impI, rule funcset_mem[of f \"{j. j \\<le> Suc (Suc n)}\"\n         \"carrier A\"], (simp del:nsum_suc)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst nsum_cmp_eq_transpos [THEN sym, of \"Suc n\" f i],\n        rule allI, rule impI, rule funcset_mem[of f \"{j. j \\<le> Suc (Suc n)}\" \n        \"carrier A\"], assumption+,\n        simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (cmp (transpos i (Suc n))\n      (cmp (transpos (Suc n) (Suc (Suc n)))\n        (transpos i (Suc n)))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst nsum_cmp_eq [of \"f\" \"Suc (Suc n)\"  \n        \"cmp (transpos (Suc n) (Suc(Suc n))) (transpos i (Suc n))\" \n        \"transpos i (Suc n)\" \"Suc (Suc n)\"], assumption+,\n        rule Pi_I, simp add:cmp_def,\n        rule transpos_mem, (simp del:nsum_suc)+,\n        rule transpos_mem, (simp del:nsum_suc)+,\n        rule Pi_I, simp,\n        rule transpos_mem, (simp del:nsum_suc)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f (transpos i (Suc n)))\n    (cmp (transpos (Suc n) (Suc (Suc n)))\n      (transpos i (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst nsum_cmp_eq [of \"cmp f (transpos i (Suc n))\" \"Suc (Suc n)\"  \n       \"(transpos i (Suc n))\" \"transpos (Suc n) (Suc (Suc n))\" \"Suc (Suc n)\"],\n       rule Pi_I, simp add:cmp_def,\n       rule funcset_mem[of f \"{j. j \\<le> Suc (Suc n)}\" \"carrier A\"], assumption,\n       simp,\n       rule transpos_mem, (simp del:nsum_suc)+,\n       (rule Pi_I, simp,\n        rule transpos_mem, (simp del:nsum_suc)+)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp\n    (cmp (cmp f (transpos i (Suc n))) (transpos (Suc n) (Suc (Suc n))))\n    (transpos i (Suc n)) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst additionTr1_1 [of \"n\" \"cmp (cmp f (transpos i (Suc n)))\n               (transpos (Suc n) (Suc (Suc n)))\" \"i\"], assumption+,\n       rule  cmp_fun [of _ \"{j. j \\<le> (Suc (Suc n))}\" \n                       \"{j. j \\<le> (Suc (Suc n))}\" _ \"carrier A\"],\n       rule transpos_hom, simp, simp, simp,\n       rule cmp_fun [of _ \"{j. j \\<le> (Suc (Suc n))}\" \n                       \"{j. j \\<le> (Suc (Suc n))}\" \"f\" \"carrier A\"],\n       rule transpos_hom, simp, simp, assumption+, arith)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f (transpos i (Suc n)))\n    (transpos (Suc n) (Suc (Suc n))) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac additionTr0 [of  \"Suc (Suc n)\" \"cmp f (transpos i (Suc n))\"],\n       simp del:nsum_suc,\n       thin_tac \"nsum A (cmp \n  (cmp f (transpos i (Suc n))) (transpos (Suc n) (Suc (Suc n)))) (Suc (Suc n))\n  = nsum A (cmp f (transpos i (Suc n))) (Suc (Suc n))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n    (transpos i (Suc n)) Suc (Suc n) =\n                      \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> 0 < Suc (Suc n)\n 3. \\<lbrakk>\\<forall>f h.\n                f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                        {j. j \\<le> Suc n} \\<and>\n                inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                \\<Sigma>\\<^sub>e A f Suc n;\n     f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n     i \\<le> Suc n; i \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (Suc n).\n                         cmp f (transpos i (Suc n)) j \\<in> carrier A", "apply (rule additionTr1_1, assumption+, arith, simp,\n       rule allI, rule impI, simp add:cmp_def,\n       rule funcset_mem[of f \"{j. j \\<le> Suc (Suc n)}\" \"carrier A\"],\n       assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A (\\<lambda>x. f (h x)) n \\<plusminus>\n                   f (h (Suc n)) =\n                   \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n);\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        i \\<le> Suc n; i \\<noteq> Suc n; j \\<le> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> transpos i (Suc n) j \\<in> {j. j \\<le> Suc (Suc n)}", "apply (simp add:transpos_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) additionTr2:\" \\<forall>f. \\<forall>h. f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier A \\<and> \n        h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. j \\<le> (Suc n)} \\<and> \n        inj_on h {j. j \\<le> (Suc n)} \\<longrightarrow> \n          nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f h.\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n       inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>f h.\n       f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0} \\<and>\n       inj_on h {j. j \\<le> Suc 0} \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A cmp f h Suc 0 = \\<Sigma>\\<^sub>e A f Suc 0\n 2. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule allI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f h.\n       f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0} \\<and>\n       inj_on h {j. j \\<le> Suc 0} \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A cmp f h Suc 0 = \\<Sigma>\\<^sub>e A f Suc 0\n 2. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f h.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0};\n        inj_on h {j. j \\<le> Suc 0}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc 0 =\n                         \\<Sigma>\\<^sub>e A f Suc 0\n 2. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f h.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0};\n        inj_on h {j. j \\<le> Suc 0}\\<rbrakk>\n       \\<Longrightarrow> f (h 0) \\<plusminus> f (h (Suc 0)) =\n                         f 0 \\<plusminus> f (Suc 0)\n 2. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (case_tac \"h 0 = 0\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f h.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0};\n        inj_on h {j. j \\<le> Suc 0}; h 0 = 0\\<rbrakk>\n       \\<Longrightarrow> f (h 0) \\<plusminus> f (h (Suc 0)) =\n                         f 0 \\<plusminus> f (Suc 0)\n 2. \\<And>f h.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0};\n        inj_on h {j. j \\<le> Suc 0}; h 0 \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> f (h 0) \\<plusminus> f (h (Suc 0)) =\n                         f 0 \\<plusminus> f (Suc 0)\n 3. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp add:Nset_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f h.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc 0} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc 0} \\<rightarrow> {j. j \\<le> Suc 0};\n        inj_on h {j. j \\<le> Suc 0}; h 0 \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> f (h 0) \\<plusminus> f (h (Suc 0)) =\n                         f 0 \\<plusminus> f (Suc 0)\n 2. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp add:Nset_1 ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "(************* n *****************)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                  {j. j \\<le> Suc (Suc n)} \\<and>\n          inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n          \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule allI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<forall>f h.\n          f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n          h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n          inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A cmp f h Suc n =\n          \\<Sigma>\\<^sub>e A f Suc n \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A \\<and>\n       h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n               {j. j \\<le> Suc (Suc n)} \\<and>\n       inj_on h {j. j \\<le> Suc (Suc n)} \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n       \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (case_tac \"h (Suc (Suc n)) = Suc (Suc n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) = Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)\n 2. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule additionTr1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac f = h and n = \"Suc (Suc n)\" in inj_surj, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        h ` {i. i \\<le> Suc (Suc n)} = {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule sym, thin_tac \"h ` {i. i \\<le> Suc (Suc n)} = {i. i \\<le> Suc (Suc n)}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        {i. i \\<le> Suc (Suc n)} = h ` {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac n = \"Suc (Suc n)\" in n_in_Nsetn)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        {i. i \\<le> Suc (Suc n)} = h ` {i. i \\<le> Suc (Suc n)};\n        Suc (Suc n) \\<in> {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac a = \"Suc (Suc n)\" and A = \"{i. i \\<le> Suc (Suc n)}\" and \n        B = \"h ` {i. i \\<le> Suc (Suc n)}\" in eq_set_inc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        {i. i \\<le> Suc (Suc n)} = h ` {i. i \\<le> Suc (Suc n)};\n        Suc (Suc n) \\<in> {i. i \\<le> Suc (Suc n)};\n        Suc (Suc n) \\<in> h ` {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (thin_tac \"{i. i \\<le> Suc (Suc n)} = h ` {i. i \\<le> Suc (Suc n)}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        Suc (Suc n) \\<in> {i. i \\<le> Suc (Suc n)};\n        Suc (Suc n) \\<in> h ` {i. i \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp del:nsum_suc add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n);\n        \\<exists>x\\<le>Suc (Suc n). Suc (Suc n) = h x\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        Suc (Suc n) = h x\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule sym, thin_tac \"Suc (Suc n) = h x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac i = x and n = \"Suc (Suc n)\" and j = \"Suc (Suc n)\" in \n                  transpos_ij_2, simp del:nsum_suc add:n_in_Nsetn)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> Suc (Suc n)\n 2. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        transpos x (Suc (Suc n)) (Suc (Suc n)) = x\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule contrapos_pp, (simp del:nsum_suc)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        transpos x (Suc (Suc n)) (Suc (Suc n)) = x\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac x = \"transpos x (Suc (Suc n)) (Suc (Suc n))\" and y = x and \n        f = h in eq_elems_eq_val,\n        thin_tac \"transpos x (Suc (Suc n)) (Suc (Suc n)) = x\",           \n        simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac f = h and A = \"{i. i \\<le> Suc (Suc n)}\" and x = x and \n                  y = \"Suc (Suc n)\" in inj_onTr2, simp, simp,\n        frule not_sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac f1 = \"cmp f h\" and n1 = n and i1 = x in \n        additionTr1_2[THEN sym], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> cmp f h\n                         \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                               carrier A\n 2. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> x \\<le> Suc n\n 3. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n        \\<Sigma>\\<^sub>e A cmp (cmp f h)\n                            (transpos x (Suc (Suc n))) Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule cmp_fun, simp, assumption, arith)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n        \\<Sigma>\\<^sub>e A cmp (cmp f h)\n                            (transpos x (Suc (Suc n))) Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp del:nsum_suc,\n        thin_tac \"\\<Sigma>\\<^sub>e A (cmp f h) (Suc (Suc n)) =\n        \\<Sigma>\\<^sub>e A (cmp (cmp f h) (transpos x (Suc (Suc n)))) (Suc (Suc n))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f h)\n       (transpos x (Suc (Suc n))) Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac f = f and n = \"Suc n\" and A = \"carrier A\" in func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f h)\n       (transpos x (Suc (Suc n))) Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac f = \"cmp h (transpos x (Suc (Suc n)))\" and A = \"{j. j \\<le> (Suc (        Suc n))}\" and ?A1.0 = \"{j. j \\<le> (Suc n)}\" in restrict_inj)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n       \\<Longrightarrow> inj_on (cmp h (transpos x (Suc (Suc n))))\n                          {j. j \\<le> Suc (Suc n)}\n 2. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> Suc n}\n                         \\<subseteq> {j. j \\<le> Suc (Suc n)}\n 3. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f h)\n       (transpos x (Suc (Suc n))) Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule_tac f = \"transpos x (Suc (Suc n))\" and A = \"{j. j \\<le> Suc (Suc n)}\"\n and B = \"{j. j \\<le> Suc (Suc n)}\" and g = h and C = \"{j. j \\<le> Suc (Suc n)}\" in\n  cmp_inj, simp,\n  rule transpos_hom, simp, simp, assumption+,\n  rule transpos_inj, simp, simp, assumption+,\n  rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f h)\n       (transpos x (Suc (Suc n))) Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst nsum_cmp_assoc,\n       rule allI, rule impI, simp add:Pi_def,\n       rule transpos_hom, assumption, simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac f = \"cmp f (cmp h (transpos x (Suc (Suc n))))\" and n = \"Suc n\"\n        in nsum_suc[of A ], simp del:nsum_suc,\n   thin_tac \"\\<Sigma>\\<^sub>e A (cmp f (cmp h (transpos x (Suc (Suc n))))) (Suc (Suc n)) =\n        \\<Sigma>\\<^sub>e A (cmp f (cmp h (transpos x (Suc (Suc n))))) (Suc n) \\<plusminus>\n        cmp f (cmp h (transpos x (Suc (Suc n)))) (Suc (Suc n))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>\\<forall>f h.\n                   f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n                   h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                           {j. j \\<le> Suc n} \\<and>\n                   inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                   \\<Sigma>\\<^sub>e A f Suc n;\n        f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac x = f in spec,\n        thin_tac \"\\<forall>f h. f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n              h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and>\n              inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n              \\<Sigma>\\<^sub>e A (cmp f h) (Suc n) = \\<Sigma>\\<^sub>e A f (Suc n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n =\n           \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac a = \"cmp h (transpos x (Suc (Suc n)))\" in forall_spec,\n        thin_tac \"\\<forall>h. f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n         h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and> inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n         \\<Sigma>\\<^sub>e A (cmp f h) (Suc n) = \\<Sigma>\\<^sub>e A f (Suc n)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 carrier A \\<and>\n                         cmp h (transpos x (Suc (Suc n)))\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                               {j. j \\<le> Suc n} \\<and>\n                         inj_on (cmp h (transpos x (Suc (Suc n))))\n                          {j. j \\<le> Suc n}\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n))))\n         {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> cmp h (transpos x (Suc (Suc n)))\n                         \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                               {j. j \\<le> Suc n}\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        xa \\<in> {j. j \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> cmp h (transpos x (Suc (Suc n))) xa\n                         \\<in> {j. j \\<le> Suc n}\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp add:cmp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> h (transpos x (Suc (Suc n)) xa) \\<le> Suc n\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (case_tac \"xa = x\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        x \\<le> Suc n; xa = x\\<rbrakk>\n       \\<Longrightarrow> h (transpos x (Suc (Suc n)) x) \\<le> Suc n\n 2. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> h (transpos x (Suc (Suc n)) xa) \\<le> Suc n\n 3. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac i = x and n = \"Suc (Suc n)\" and j = \"Suc (Suc n)\" in \n         transpos_ij_1, simp, simp, simp, simp,\n        frule_tac x = \"Suc (Suc n)\" and f = h and A = \"{j. j \\<le> Suc (Suc n)}\"\n         and B = \"{j. j \\<le> Suc (Suc n)}\" in funcset_mem, simp,\n        thin_tac \"h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> {j. j \\<le> Suc (Suc n)}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        x \\<le> Suc n; xa = x; transpos x (Suc (Suc n)) x = Suc (Suc n);\n        h (Suc (Suc n)) \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> h (Suc (Suc n)) \\<le> Suc n\n 2. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> h (transpos x (Suc (Suc n)) xa) \\<le> Suc n\n 3. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac m = \"h (Suc (Suc n))\" and n = \"Suc (Suc n)\" in noteq_le_less,\n        simp, simp,\n        rule_tac x = \"h (Suc (Suc n))\" and n = \"Suc n\" in Suc_less_le,\n        assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x\\<rbrakk>\n       \\<Longrightarrow> h (transpos x (Suc (Suc n)) xa) \\<le> Suc n\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (subst transpos_id, simp, simp, simp, simp,\n        frule_tac x = xa and f = h and A = \"{j. j \\<le> Suc (Suc n)}\" and \n        B = \"{j. j \\<le> Suc (Suc n)}\" in funcset_mem, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x;\n        h xa \\<in> {j. j \\<le> Suc (Suc n)}\\<rbrakk>\n       \\<Longrightarrow> h xa \\<le> Suc n\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (frule_tac f = h and A = \"{j. j \\<le> Suc (Suc n)}\" and x = xa and y = x \n        in injective, simp, simp, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x; h xa \\<in> {j. j \\<le> Suc (Suc n)};\n        h xa \\<noteq> h x\\<rbrakk>\n       \\<Longrightarrow> h xa \\<le> Suc n\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (cut_tac m = \"h xa\" and n = \"Suc (Suc n)\" in noteq_le_less, simp,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f h x xa.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        xa \\<le> Suc n; xa \\<noteq> x; h xa \\<in> {j. j \\<le> Suc (Suc n)};\n        h xa \\<noteq> h x; h xa < Suc (Suc n)\\<rbrakk>\n       \\<Longrightarrow> h xa \\<le> Suc n\n 2. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<forall>h.\n           f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n           h \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                   {j. j \\<le> Suc n} \\<and>\n           inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n           \\<Sigma>\\<^sub>e A cmp f h Suc n = \\<Sigma>\\<^sub>e A f Suc n;\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (rule Suc_less_le, assumption,\n        thin_tac \"\\<forall>h. f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A \\<and>\n        h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n} \\<and> inj_on h {j. j \\<le> Suc n} \\<longrightarrow>\n        \\<Sigma>\\<^sub>e A (cmp f h) (Suc n) = \\<Sigma>\\<^sub>e A f (Suc n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (cmp h (transpos x (Suc (Suc n)))) {j. j \\<le> Suc n};\n        \\<Sigma>\\<^sub>e A cmp f (cmp h (transpos x (Suc (Suc n)))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f\n       (cmp h (transpos x (Suc (Suc n)))) Suc n \\<plusminus>\n                         cmp f (cmp h (transpos x (Suc (Suc n))))\n                          (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply (simp del:nsum_suc add:cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f h x.\n       \\<lbrakk>f \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow> carrier A;\n        h \\<in> {j. j \\<le> Suc (Suc n)} \\<rightarrow>\n                {j. j \\<le> Suc (Suc n)};\n        inj_on h {j. j \\<le> Suc (Suc n)};\n        h (Suc (Suc n)) \\<noteq> Suc (Suc n); x \\<le> Suc (Suc n);\n        h x = Suc (Suc n);\n        h (transpos x (Suc (Suc n)) (Suc (Suc n))) = Suc (Suc n);\n        x \\<noteq> Suc (Suc n);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n        inj_on (\\<lambda>xa. h (transpos x (Suc (Suc n)) xa))\n         {j. j \\<le> Suc n};\n        \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                               f (h (transpos x (Suc (Suc n)) a))) Suc n =\n        \\<Sigma>\\<^sub>e A f Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n \\<plusminus>\n                         f (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f Suc (Suc n)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) addition2:\"\\<lbrakk>f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier A; \n  h \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. j \\<le> (Suc n)}; inj_on h {j. j \\<le> (Suc n)}\\<rbrakk> \\<Longrightarrow>\n  nsum A (cmp f h) (Suc n) = nsum A f (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. j \\<le> Suc n};\n     inj_on h {j. j \\<le> Suc n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h Suc n =\n                      \\<Sigma>\\<^sub>e A f Suc n", "apply (simp del:nsum_suc add:additionTr2)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) addition21:\"\\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A; \n       h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; inj_on h {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow>\n       nsum A (cmp f h) n = nsum A f n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h n = \\<Sigma>\\<^sub>e A f n", "apply (case_tac \"n = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n = 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h n = \\<Sigma>\\<^sub>e A f n\n 2. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h n = \\<Sigma>\\<^sub>e A f n", "apply (simp add: cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h n = \\<Sigma>\\<^sub>e A f n", "apply (cut_tac f = f and n = \"n - Suc 0\" and h = h in addition2)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              carrier A\n 2. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> h \\<in> {j. j \\<le> Suc (n - Suc 0)} \\<rightarrow>\n                              {j. j \\<le> Suc (n - Suc 0)}\n 3. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> inj_on h {j. j \\<le> Suc (n - Suc 0)}\n 4. \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier A;\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     inj_on h {j. j \\<le> n}; n \\<noteq> 0;\n     \\<Sigma>\\<^sub>e A cmp f h Suc (n - Suc 0) =\n     \\<Sigma>\\<^sub>e A f Suc (n - Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f h n = \\<Sigma>\\<^sub>e A f n", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) addition3:\"\\<lbrakk>\\<forall>j \\<le> (Suc n). f j \\<in> carrier A; j \\<le> (Suc n);\nj \\<noteq> Suc n\\<rbrakk> \\<Longrightarrow> nsum A f (Suc n) = nsum A (cmp f (transpos j (Suc n))) (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n =\n                      \\<Sigma>\\<^sub>e A cmp f (transpos j (Suc n)) Suc n", "apply (rule addition2 [THEN sym,of \"f\" \"n\" \"transpos j (Suc n)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> transpos j (Suc n)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            {j. j \\<le> Suc n}\n 3. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> transpos j (Suc n)\n                      \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                            {j. j \\<le> Suc n}\n 2. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (rule transpos_hom, assumption+, simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A; j \\<le> Suc n;\n     j \\<noteq> Suc n\\<rbrakk>\n    \\<Longrightarrow> inj_on (transpos j (Suc n)) {j. j \\<le> Suc n}", "apply (rule transpos_inj, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_splitTr:\"(\\<forall>j \\<le> (Suc (n + m)). f j \\<in> carrier A) \\<longrightarrow>\n   nsum A f (Suc (n + m)) = nsum A f n \\<plusminus> (nsum A (cmp f (slide (Suc n))) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>Suc (n + m). f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc (n + m) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus>\n    \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) m", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>Suc (n + 0). f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc (n + 0) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus>\n    \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) 0\n 2. \\<And>na.\n       (\\<forall>j\\<le>Suc (n + na). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (n + Suc na).\n           f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>j\\<le>Suc (n + 0). f j \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc (n + 0) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus>\n    \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) 0\n 2. \\<And>na.\n       (\\<forall>j\\<le>Suc (n + na). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (n + Suc na).\n           f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na", "apply (simp add:slide_def cmp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       (\\<forall>j\\<le>Suc (n + na). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (n + Suc na).\n           f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na", "apply (rule impI, simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc (Suc (n + na)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na", "apply (cut_tac n = \"Suc (n + na)\" in nsum_suc[of A f],\n       simp del:nsum_suc,\n       thin_tac \"\\<Sigma>\\<^sub>e A f (Suc (Suc (n + na))) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A (cmp f (slide (Suc n))) na \\<plusminus> f (Suc (Suc (n + na)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A cmp f\n       (slide (Suc n)) na \\<plusminus>\n                         f (Suc (Suc (n + na))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na", "apply (cut_tac f = \"cmp f (slide (Suc n))\" and n = na in nsum_suc[of A],\n       simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A cmp f\n       (slide (Suc n)) na \\<plusminus>\n                         f (Suc (Suc (n + na))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          cmp f (slide (Suc n)) (Suc na))", "apply (subst ag_pOp_assoc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na\n                         \\<in> carrier A\n 3. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> f (Suc (Suc (n + na))) \\<in> carrier A\n 4. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          f (Suc (Suc (n + na)))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          cmp f (slide (Suc n)) (Suc na))", "apply (rule nsum_mem, rule allI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na\n                         \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> f (Suc (Suc (n + na))) \\<in> carrier A\n 3. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          f (Suc (Suc (n + na)))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          cmp f (slide (Suc n)) (Suc na))", "apply (rule_tac n = na in nsum_mem, \n        thin_tac \"\\<Sigma>\\<^sub>e A (cmp f (slide (Suc n))) (Suc na) =\n          \\<Sigma>\\<^sub>e A (cmp f (slide (Suc n))) na \\<plusminus> (cmp f (slide (Suc n)) (Suc na))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>na.\n                            cmp f (slide (Suc n)) j \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> f (Suc (Suc (n + na))) \\<in> carrier A\n 3. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          f (Suc (Suc (n + na)))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          cmp f (slide (Suc n)) (Suc na))", "apply (rule allI, rule impI,\n        simp add:cmp_def slide_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f Suc (n + na) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na;\n        \\<forall>j\\<le>Suc (Suc (n + na)). f j \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) Suc na =\n        \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) na \\<plusminus>\n        cmp f (slide (Suc n)) (Suc na)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          f (Suc (Suc (n + na)))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A cmp f\n        (slide (Suc n)) na \\<plusminus>\n                          cmp f (slide (Suc n)) (Suc na))", "apply (simp add:cmp_def slide_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_split:\"\\<forall>j \\<le> (Suc (n + m)). f j \\<in> carrier A \\<Longrightarrow>\n   nsum A f (Suc (n + m)) = nsum A f n \\<plusminus> (nsum A (cmp f (slide (Suc n))) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>Suc (n + m). f j \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc (n + m) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus>\n    \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) m", "by (simp del:nsum_suc add:nsum_splitTr)"], ["", "lemma (in aGroup) nsum_split1:\"\\<lbrakk>\\<forall>j \\<le> m. f j \\<in> carrier A; n < m\\<rbrakk> \\<Longrightarrow>\n                   nsum A f m = nsum A f n \\<plusminus> (fSum A f (Suc n) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>f A f Suc n m", "apply (cut_tac nsum_split[of n \"m - n - Suc 0\" f])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m;\n     \\<Sigma>\\<^sub>e A f Suc (n + (m - n - Suc 0)) =\n     \\<Sigma>\\<^sub>e A f n \\<plusminus>\n     \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) (m - n - Suc 0)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>f A f Suc n m\n 2. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (n + (m - n - Suc 0)).\n                         f j \\<in> carrier A", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m;\n     \\<Sigma>\\<^sub>e A f m =\n     \\<Sigma>\\<^sub>e A f n \\<plusminus>\n     \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) (m - Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp f (slide (Suc n)) (m - Suc n) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>f A f Suc n m\n 2. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (n + (m - n - Suc 0)).\n                         f j \\<in> carrier A", "apply (simp add:fSum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>m. f j \\<in> carrier A; n < m\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (n + (m - n - Suc 0)).\n                         f j \\<in> carrier A", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_minusTr:\" (\\<forall>j \\<le> n. f j \\<in> carrier A) \\<longrightarrow>\n                    -\\<^sub>a (nsum A f n) = nsum A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a (f x)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n    -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n    \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a f x) n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> carrier A) \\<longrightarrow>\n    -\\<^sub>a \\<Sigma>\\<^sub>e A f 0 =\n    \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> 0}. -\\<^sub>a f x) 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n       -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a f x) n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       -\\<^sub>a \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                              -\\<^sub>a f x) Suc n", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n       -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n                              -\\<^sub>a f x) n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       -\\<^sub>a \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                              -\\<^sub>a f x) Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e A f Suc n =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) Suc n", "apply (subst nsum_suc, subst nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (\\<Sigma>\\<^sub>e A f n \\<plusminus>\n                                    f (Suc n)) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n \\<plusminus>\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a f x)\n                          (Suc n)", "apply (subst ag_p_inv)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier A\n 3. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         -\\<^sub>a f (Suc n) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n \\<plusminus>\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a f x)\n                          (Suc n)", "apply (rule_tac n = n in nsum_mem [of _ f],\n        rule allI, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         -\\<^sub>a f (Suc n) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n \\<plusminus>\n                         (\\<lambda>x\\<in>{j. j \\<le> Suc n}. -\\<^sub>a f x)\n                          (Suc n)", "apply (subgoal_tac \"\\<forall>j\\<le>n. f j \\<in> carrier A\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>a.\n          if a \\<le> n then -\\<^sub>a f a else undefined) n \\<plusminus>\n                         -\\<^sub>a f (Suc n) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n \\<plusminus>\n                         -\\<^sub>a f (Suc n)\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A", "apply (rule_tac a = \"\\<Sigma>\\<^sub>e A (\\<lambda>u. if u \\<le> n then  -\\<^sub>a (f u) else undefined) n\"\n     and b = \"\\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> (Suc n)}. -\\<^sub>a (f x)) n\" and c = \"-\\<^sub>a (f (Suc n))\"\n     in ag_pOp_add_r,\n     rule_tac n = n in nsum_mem,\n     rule allI, rule impI, simp,\n     rule ag_mOp_closed, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n\n                         \\<in> carrier A\n 2. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a f (Suc n) \\<in> carrier A\n 3. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>u.\n          if u \\<le> n then -\\<^sub>a f u else undefined) n =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n\n 4. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A", "apply (rule_tac n = n in nsum_mem,\n        rule allI, rule impI, simp,\n        rule ag_mOp_closed, simp,\n        rule ag_mOp_closed, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>u.\n          if u \\<le> n then -\\<^sub>a f u else undefined) n =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j.\n                       j \\<le> Suc n}.\n          -\\<^sub>a f x) n\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A", "apply (rule_tac f = \"\\<lambda>u. if u \\<le> n then -\\<^sub>a (f u) else undefined\" and \n        n = n and g = \"\\<lambda>x\\<in>{j. j \\<le> (Suc n)}. -\\<^sub>a (f x)\" in nsum_eq,\n        rule allI, rule impI,\n        simp, rule ag_mOp_closed, simp,\n        rule allI, simp, rule impI, rule ag_mOp_closed, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>-\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>a.\n if a \\<le> n then -\\<^sub>a f a else undefined) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            (if j \\<le> n then -\\<^sub>a f j\n                             else undefined) =\n                            (\\<lambda>x\\<in>{j. j \\<le> Suc n}.\n                                -\\<^sub>a f x)\n                             j\n 2. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A", "apply (rule allI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}.\n -\\<^sub>a f x) n;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A", "apply (rule allI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_minus:\"\\<forall>j \\<le> n. f j \\<in> carrier A \\<Longrightarrow> \n                    -\\<^sub>a (nsum A f n) = nsum A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a (f x)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. f j \\<in> carrier A \\<Longrightarrow>\n    -\\<^sub>a \\<Sigma>\\<^sub>e A f n =\n    \\<Sigma>\\<^sub>e A (\\<lambda>x\\<in>{j. j \\<le> n}. -\\<^sub>a f x) n", "apply (simp add:nsum_minusTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ring_nsum_zeroTr:\"(\\<forall>j \\<le> (n::nat). f j \\<in> carrier A) \\<and> \n                    (\\<forall>j \\<le> n. f j = \\<zero>) \\<longrightarrow> nsum A f n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> carrier A) \\<and>\n    (\\<forall>j\\<le>0. f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 = \\<zero>\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> carrier A) \\<and>\n    (\\<forall>j\\<le>0. f j = \\<zero>) \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 = \\<zero>\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>0. f j \\<in> carrier A;\n     \\<forall>j\\<le>0. f j = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f 0 = \\<zero>\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f n = \\<zero>;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>((\\<exists>j. j \\<le> n) \\<longrightarrow>\n                 \\<zero> \\<in> carrier A) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f n = \\<zero>;\n        (\\<exists>j. j \\<le> Suc n) \\<longrightarrow>\n        \\<zero> \\<in> carrier A;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<zero> =\n                         \\<zero>", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n = \\<zero>;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (cut_tac ag_inc_zero,\n        simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ring_nsum_zero:\"\\<forall>j \\<le> (n::nat). f j = \\<zero>  \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. f j = \\<zero> \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (cut_tac ring_nsum_zeroTr[of n f])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j = \\<zero>;\n     (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n     (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n     \\<Sigma>\\<^sub>e A f n = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_nsum_1_nonzeroTr:\n\"\\<forall>f. (\\<forall>j \\<le> n. f j \\<in> carrier A) \\<and> \n       (l \\<le> n \\<and> (\\<forall>j \\<in> {j. j \\<le> n} - {l}. f j = \\<zero>))\n      \\<longrightarrow> nsum A f n = f l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       l \\<le> n \\<and>\n       (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n           f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = f l", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>f.\n       (\\<forall>j\\<le>0. f j \\<in> carrier A) \\<and>\n       l \\<le> 0 \\<and>\n       (\\<forall>j\\<in>{j. j \\<le> 0} - {l}.\n           f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f 0 = f l\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n          l \\<le> n \\<and>\n          (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n              f j = \\<zero>) \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A f n = f l \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n          l \\<le> Suc n \\<and>\n          (\\<forall>j\\<in>{j. j \\<le> Suc n} - {l}.\n              f j = \\<zero>) \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A f Suc n = f l", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f.\n          (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n          l \\<le> n \\<and>\n          (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n              f j = \\<zero>) \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A f n = f l \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<and>\n          l \\<le> Suc n \\<and>\n          (\\<forall>j\\<in>{j. j \\<le> Suc n} - {l}.\n              f j = \\<zero>) \\<longrightarrow>\n          \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (rule allI,\n       rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (case_tac \"l = Suc n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l\n 2. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {Suc n}. f j = \\<zero>;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                         f (Suc n)\n 2. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (subgoal_tac \"{j. j \\<le> Suc n} - {Suc n} = {j. j \\<le> n}\", simp,\n        frule ring_nsum_zero, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<le>n. f j = \\<zero>; l = Suc n;\n        {j. j \\<le> Suc n} - {Suc n} = {j. j \\<le> n};\n        \\<Sigma>\\<^sub>e A f n = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> f (Suc n) = f (Suc n)\n 2. \\<And>n f.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {Suc n}. f j = \\<zero>;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> Suc n} - {Suc n} = {j. j \\<le> n}\n 3. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (rule ag_l_zero, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {Suc n}. f j = \\<zero>;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> Suc n} - {Suc n} = {j. j \\<le> n}\n 2. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (rule equalityI, rule subsetI, simp,\n        rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A; l \\<le> Suc n;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (frule_tac m = l and n = \"Suc n\" in noteq_le_less, assumption,\n        thin_tac \"l \\<le> Suc n\",\n        frule_tac x = l and n = n in Suc_less_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   l \\<le> n \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<noteq> Suc n; l < Suc n; l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = f l", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n                   (\\<forall>j\\<in>{j. j \\<le> n} - {l}.\n                       f j = \\<zero>) \\<longrightarrow>\n                   \\<Sigma>\\<^sub>e A f n = f l;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f l \\<plusminus> \\<zero> = f l", "apply (thin_tac \"\\<forall>f. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n               (\\<forall>j\\<in>{j. j \\<le> n} - {l}. f j = \\<zero>) \\<longrightarrow>\n               \\<Sigma>\\<^sub>e A f n = f l\",\n        frule_tac a = l in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>j\\<le>Suc n. f j \\<in> carrier A;\n        \\<forall>j\\<in>{j. j \\<le> Suc n} - {l}. f j = \\<zero>; l \\<le> n;\n        f l \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f l \\<plusminus> \\<zero> = f l", "apply (simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_nsum_1_nonzero:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; l \\<le> n; \n       \\<forall>j\\<in>({j. j \\<le> n} - {l}). f j = \\<zero> \\<rbrakk> \\<Longrightarrow> nsum A f n = f l\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A; l \\<le> n;\n     \\<forall>j\\<in>{j. j \\<le> n} - {l}. f j = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n = f l", "apply (simp add:ag_nsum_1_nonzeroTr[of n l])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  set_mult :: \"[_ , 'a set, 'a set] \\<Rightarrow> 'a set\" where\n  \"set_mult R A B = {z. \\<exists>x\\<in>A. \\<exists>y\\<in>B.  x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y = z}\""], ["", "definition\n  sum_mult :: \"[_ , 'a set, 'a set] \\<Rightarrow> 'a set\" where\n  \"sum_mult R A B = {x. \\<exists>n. \\<exists>f \\<in> {j. j \\<le> (n::nat)}\n                           \\<rightarrow> set_mult R A B. nsum R f n = x}\""], ["", "(*\n zero_fini::\"[_ , 'a set, 'a set] \\<Rightarrow> (nat \\<Rightarrow> 'a)\"\n     \"zero_fini R A B i == \\<zero> \\<cdot>\\<^sub>r \\<zero>\" *)"], ["", "lemma (in Ring) set_mult_sub:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n                                    set_mult R A B \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> carrier R", "apply (rule subsetI, simp add:set_mult_def, (erule bexE)+,\n       frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa y.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        xa \\<in> A; y \\<in> B; x = xa \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (rule ring_tOp_closed, (simp add:subsetD)+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) set_mult_mono:\"\\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R; A1 \\<subseteq> A2; \n       B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow> set_mult R A1 B \\<subseteq> set_mult R A2 B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R;\n     A1 \\<subseteq> A2; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> set_mult R A1 B \\<subseteq> set_mult R A2 B", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R;\n        A1 \\<subseteq> A2; B \\<subseteq> carrier R;\n        x \\<in> set_mult R A1 B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> set_mult R A2 B", "apply (simp add:set_mult_def, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa y.\n       \\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R;\n        A1 \\<subseteq> A2; B \\<subseteq> carrier R; xa \\<in> A1; y \\<in> B;\n        xa \\<cdot>\\<^sub>r y = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>A2.\n                            \\<exists>y\\<in>B. xa \\<cdot>\\<^sub>r y = x", "apply (frule_tac c = xa in subsetD[of A1 A2], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa y.\n       \\<lbrakk>A1 \\<subseteq> carrier R; A2 \\<subseteq> carrier R;\n        A1 \\<subseteq> A2; B \\<subseteq> carrier R; xa \\<in> A1; y \\<in> B;\n        xa \\<cdot>\\<^sub>r y = x; xa \\<in> A2\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>A2.\n                            \\<exists>y\\<in>B. xa \\<cdot>\\<^sub>r y = x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_Tr1:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n               (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> nsum R f n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>0.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e R f 0 \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> carrier R", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n     f 0 \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> carrier R", "apply (frule set_mult_sub[of A B], assumption, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> carrier R", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<in> carrier R", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> carrier R", "apply (frule set_mult_sub[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> carrier R", "apply (frule_tac a = \"Suc n\" in forall_spec, simp,\n        frule_tac c = \"f (Suc n)\" in subsetD[of \"set_mult R A B\" \"carrier R\"],\n        assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R;\n        f (Suc n) \\<in> set_mult R A B; f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> carrier R", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_mem:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n   \\<forall>j \\<le> n. f j \\<in> set_mult R A B\\<rbrakk>  \\<Longrightarrow> nsum R f n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<forall>j\\<le>n. f j \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<forall>j\\<le>n. f j \\<in> set_mult R A B; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (simp add:sum_mult_Tr1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_mem1:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n        x \\<in> sum_mult R A B\\<rbrakk>  \\<Longrightarrow>\n        \\<exists>n. \\<exists>f\\<in>{j. j \\<le> (n::nat)} \\<rightarrow> set_mult R A B. nsum R f n = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     x \\<in> sum_mult R A B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f n = x", "by (simp add:sum_mult_def)"], ["", "lemma (in Ring) sum_mult_subR:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n                         sum_mult R A B \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> carrier R", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R", "apply (frule_tac x = x in sum_mult_mem1[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<in> sum_mult R A B;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n              \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R", "apply (erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n; aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R", "apply (rule aGroup.nsum_mem[of R], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n; aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier R", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f j.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n; aGroup R; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier R", "apply (frule_tac f = f and A = \"{j. j \\<le> n}\" and B = \"set_mult R A B\" and\n       x = j in funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f j.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n; aGroup R; j \\<le> n;\n        f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier R", "apply (frule set_mult_sub[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f j.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n; aGroup R; j \\<le> n;\n        f j \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> carrier R", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) times_mem_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n       a \\<in> A; b \\<in> B \\<rbrakk>  \\<Longrightarrow>  a \\<cdot>\\<^sub>r b \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<in> sum_mult R A B", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f n = a \\<cdot>\\<^sub>r b", "apply (subgoal_tac \"(\\<lambda>i\\<in>{j. j \\<le> (0::nat)}. a \\<cdot>\\<^sub>r b) \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B;\n     (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f n = a \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B", "apply (subgoal_tac \"nsum R (\\<lambda>i\\<in>{j. j \\<le> (0::nat)}. a \\<cdot>\\<^sub>r b) 0 = a \\<cdot>\\<^sub>r b\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B;\n     (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B;\n     \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}.\n                            a \\<cdot>\\<^sub>r b) 0 =\n     a \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f n = a \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B;\n     (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}.\n       a \\<cdot>\\<^sub>r b) 0 =\n                      a \\<cdot>\\<^sub>r b\n 3. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B;\n     (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n     \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}.\n       a \\<cdot>\\<^sub>r b) 0 =\n                      a \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; a \\<in> A;\n     b \\<in> B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>i\\<in>{j. j \\<le> 0}. a \\<cdot>\\<^sub>r b)\n                      \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B", "apply (rule Pi_I, simp add:set_mult_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mem_minus_sum_multTr2:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; \n       \\<forall>j \\<le> n. f j \\<in> set_mult R A B; i \\<le> n\\<rbrakk> \\<Longrightarrow> f i \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<forall>j\\<le>n. f j \\<in> set_mult R A B; i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> f i \\<in> carrier R", "apply (frule_tac a = i in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<forall>j\\<le>n. f j \\<in> set_mult R A B; i \\<le> n;\n     f i \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> f i \\<in> carrier R", "apply (frule set_mult_sub[of A B], assumption, simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_jointfun:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \n      \\<forall>j \\<le> m. g j \\<in> carrier A\\<rbrakk>  \\<Longrightarrow> \n      \\<Sigma>\\<^sub>e A (jointfun n f m g) (Suc (n + m)) =  \\<Sigma>\\<^sub>e A f n \\<plusminus> (\\<Sigma>\\<^sub>e A g m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g Suc (n + m) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply (subst nsum_split)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>Suc (n + m).\n                         jointfun n f m g j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>m. g j \\<in> carrier A; j \\<le> Suc (n + m)\\<rbrakk>\n       \\<Longrightarrow> jointfun n f m g j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply (frule_tac f = f and n = n and A = \"carrier A\" and g = g and m = m\n        and B = \"carrier A\" in jointfun_mem, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply (subgoal_tac \"nsum A (jointfun n f m g) n = nsum A f n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A;\n     \\<Sigma>\\<^sub>e A jointfun n f m g n = \\<Sigma>\\<^sub>e A f n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (subgoal_tac \"nsum A (cmp (jointfun n f m g) (slide (Suc n))) m =\n                               nsum A g m\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A;\n     \\<Sigma>\\<^sub>e A jointfun n f m g n = \\<Sigma>\\<^sub>e A f n;\n     \\<Sigma>\\<^sub>e A cmp (jointfun n f m g) (slide (Suc n)) m =\n     \\<Sigma>\\<^sub>e A g m\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A;\n     \\<Sigma>\\<^sub>e A jointfun n f m g n = \\<Sigma>\\<^sub>e A f n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A g m\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A;\n     \\<Sigma>\\<^sub>e A jointfun n f m g n = \\<Sigma>\\<^sub>e A f n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A g m\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (thin_tac \"nsum A (jointfun n f m g) n = nsum A f n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (jointfun n f m g)\n    (slide (Suc n)) m =\n                      \\<Sigma>\\<^sub>e A g m\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (jointfun n f m g) (slide (Suc n)) j\n                         \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m. g j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (jointfun n f m g) (slide (Suc n)) j = g j\n 4. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (rule allI, rule impI,\n        simp add:cmp_def jointfun_def slide_def sliden_def,\n        assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         cmp (jointfun n f m g) (slide (Suc n)) j = g j\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (rule allI, simp add:cmp_def jointfun_def slide_def sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g n =\n                      \\<Sigma>\\<^sub>e A f n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. jointfun n f m g j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. jointfun n f m g j = f j", "apply (rule allI, rule impI,\n             simp add:jointfun_def, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. jointfun n f m g j = f j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>m. g j \\<in> carrier A; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> jointfun n f m g j = f j", "apply (simp add:jointfun_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_pOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n       a \\<in> sum_mult R A B;  b \\<in> sum_mult R A B \\<rbrakk> \\<Longrightarrow> a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     a \\<in> sum_mult R A B; b \\<in> sum_mult R A B\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> sum_mult R A B", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     a \\<in> sum_mult R A B; b \\<in> sum_mult R A B; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> sum_mult R A B", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n = a;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n = b;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f n = a \\<plusminus> b", "apply ((erule exE)+, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na f fa.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n = a;\n        fa \\<in> {j. j \\<le> na} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R fa na = b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = a \\<plusminus> b", "apply (rename_tac n m f g)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n = a;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R g m = b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = a \\<plusminus> b", "apply (frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = a\", frule sym, \n        thin_tac \"\\<Sigma>\\<^sub>e R g m = b\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R f n \\<plusminus>\n                               \\<Sigma>\\<^sub>e R g m", "apply (frule set_mult_sub[of A B], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R f n \\<plusminus>\n                               \\<Sigma>\\<^sub>e R g m", "apply (subst aGroup.nsum_jointfun[THEN sym, of R], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n m f g fa na.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier R\n 2. \\<And>n m f g fa na.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>m. g j \\<in> carrier R\n 3. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R jointfun n f m\n             g Suc (n + m)", "apply (rule allI, rule impI, \n        frule_tac f = f and A = \"{j. j \\<le> n}\" and B = \"set_mult R A B\" and\n        x = j in funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m f g fa na.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>m. g j \\<in> carrier R\n 2. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R jointfun n f m\n             g Suc (n + m)", "apply (rule allI, rule impI, \n        frule_tac f = g and A = \"{j. j \\<le> m}\" and B = \"set_mult R A B\" and\n        x = j in funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R jointfun n f m\n             g Suc (n + m)", "apply (frule_tac f = f and n = n and A = \"set_mult R A B\" and g = g and m = m\n        and B = \"set_mult R A B\" in jointfun_hom, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R;\n        jointfun n f m g\n        \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow>\n              set_mult R A B \\<union> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R jointfun n f m\n             g Suc (n + m)", "apply (simp del:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m f g.\n       \\<lbrakk>A \\<subseteq> carrier R; B \\<subseteq> carrier R; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        g \\<in> {j. j \\<le> m} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n; b = \\<Sigma>\\<^sub>e R g m;\n        set_mult R A B \\<subseteq> carrier R;\n        jointfun n f m g\n        \\<in> {j. j \\<le> Suc (n + m)} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>na.\n                            \\<exists>fa\\<in>{j. j \\<le> na} \\<rightarrow>\n      set_mult R A B.\n                               \\<Sigma>\\<^sub>e R fa na =\n                               \\<Sigma>\\<^sub>e R jointfun n f m\n             g Suc (n + m)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) set_mult_mOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n       x \\<in> set_mult R A B\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> set_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n     x \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> set_mult R A B", "apply (cut_tac ring_is_ag,\n       simp add:set_mult_def,\n       (erule bexE)+, frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = x\", simp,\n       frule_tac c = xa in subsetD[of A \"carrier R\"], assumption+,\n       frule ideal_subset1[of B],\n       frule_tac c = y in subsetD[of B \"carrier R\"], assumption+,\n       simp add:ring_inv1_2,\n       frule_tac I = B and x = y in ideal_inv1_closed,\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R; xa \\<in> A;\n        y \\<in> B; x = xa \\<cdot>\\<^sub>r y; xa \\<in> carrier R;\n        B \\<subseteq> carrier R; y \\<in> carrier R;\n        -\\<^sub>a y \\<in> B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>A.\n                            \\<exists>ya\\<in>B.\n                               x \\<cdot>\\<^sub>r ya =\n                               xa \\<cdot>\\<^sub>r (-\\<^sub>a y)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) set_mult_ring_times_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n       x \\<in> set_mult R A B; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow> r \\<cdot>\\<^sub>r  x \\<in> set_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n     r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> set_mult R A B", "apply (cut_tac ring_is_ag,   \n       simp add:set_mult_def,\n       (erule bexE)+, frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = x\", simp,\n       frule_tac c = xa in subsetD[of A \"carrier R\"], assumption+,\n       frule ideal_subset1[of B],\n       frule_tac c = y in subsetD[of B \"carrier R\"], assumption,\n       frule_tac x = r and y = \"xa \\<cdot>\\<^sub>r y\" in ring_tOp_commute,\n       simp add:ring_tOp_closed, simp,\n       subst ring_tOp_assoc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; xa \\<in> A; y \\<in> B; x = xa \\<cdot>\\<^sub>r y;\n        xa \\<in> carrier R; B \\<subseteq> carrier R; y \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r y) =\n        xa \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>A.\n                            \\<exists>ya\\<in>B.\n                               x \\<cdot>\\<^sub>r ya =\n                               xa \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r r)", "apply (frule_tac x = y and y = r in ring_tOp_commute, assumption+,\n        simp,\n        frule_tac x = y and r = r in ideal_ring_multiple [of B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; xa \\<in> A; y \\<in> B; x = xa \\<cdot>\\<^sub>r y;\n        xa \\<in> carrier R; B \\<subseteq> carrier R; y \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r y) =\n        xa \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r r;\n        y \\<cdot>\\<^sub>r r = r \\<cdot>\\<^sub>r y;\n        r \\<cdot>\\<^sub>r y \\<in> B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>A.\n                            \\<exists>ya\\<in>B.\n                               x \\<cdot>\\<^sub>r ya =\n                               xa \\<cdot>\\<^sub>r (r \\<cdot>\\<^sub>r y)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) set_mult_sub_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk> \\<Longrightarrow>\n                   set_mult R A B \\<subseteq> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> sum_mult R A B", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        x \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        x \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = x", "apply (cut_tac f = \"(\\<lambda>i\\<in>{j. j \\<le> (0::nat)}. x)\" in nsum_0[of R])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}. x) 0 =\n        (\\<lambda>i\\<in>{j. j \\<le> 0}. x) 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = x", "apply (cut_tac n_in_Nsetn[of 0],\n        simp del:nsum_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{0}. x) 0 = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = x", "apply (cut_tac f = \"\\<lambda>i\\<in>{j. j \\<le> (0::nat)}. x\" and B = \"%_. set_mult R A B\" in \n                Pi_I[of \"{j. j \\<le> 0}\"],\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{0}. x) 0 = x;\n        (\\<lambda>i\\<in>{j. j \\<le> 0}. x)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = x", "apply (subgoal_tac \"\\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}. x) 0 = x\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{0}. x) 0 = x;\n        (\\<lambda>i\\<in>{j. j \\<le> 0}. x)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}. x) 0 = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R A B.\n                               \\<Sigma>\\<^sub>e R f n = x\n 2. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{0}. x) 0 = x;\n        (\\<lambda>i\\<in>{j. j \\<le> 0}. x)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}.\n          x) 0 =\n                         x", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{0}. x) 0 = x;\n        (\\<lambda>i\\<in>{j. j \\<le> 0}. x)\n        \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i\\<in>{j. j \\<le> 0}.\n          x) 0 =\n                         x", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_pOp_closedn:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>  \\<Longrightarrow> \n               (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>0.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> sum_mult R A B", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n     f 0 \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> sum_mult R A B", "apply (frule set_mult_sub_sum_mult[of A B], assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> sum_mult R A B", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<in> sum_mult R A B", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> sum_mult R A B", "apply (frule_tac a = \"Suc n\" in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> sum_mult R A B", "apply (frule set_mult_sub_sum_mult[of A B], assumption+, \n        frule_tac c= \"f (Suc n)\" in \n                  subsetD[of \"set_mult R A B\" \"sum_mult R A B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> sum_mult R A B;\n        f (Suc n) \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> sum_mult R A B", "apply (rule sum_mult_pOp_closed, assumption,\n        simp add:ideal_subset1, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mem_minus_sum_multTr4:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk> \\<Longrightarrow>\n        (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> -\\<^sub>a (nsum R f n) \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>0.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      -\\<^sub>a \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n     \\<forall>j\\<le>0. f j \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (cut_tac n_in_Nsetn[of 0])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n     \\<forall>j\\<le>0. f j \\<in> set_mult R A B;\n     0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (frule_tac x = \"f 0\" in set_mult_mOp_closed[of A B], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n     \\<forall>j\\<le>0. f j \\<in> set_mult R A B;\n     0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<in> set_mult R A B\n 2. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n     \\<forall>j\\<le>0. f j \\<in> set_mult R A B; 0 \\<in> {i. i \\<le> 0};\n     -\\<^sub>a f 0 \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 3. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n     \\<forall>j\\<le>0. f j \\<in> set_mult R A B; 0 \\<in> {i. i \\<le> 0};\n     -\\<^sub>a f 0 \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (frule set_mult_sub_sum_mult[of A B], assumption+, \n        simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus>\n                                    f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule sum_mult_subR[of A B], simp add:ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus>\n                                    f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule_tac n = n and f = f in sum_mult_pOp_closedn[of A B], assumption,\n        cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus>\n                                    f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule_tac c = \"\\<Sigma>\\<^sub>e R f n\" in subsetD[of \"sum_mult R A B\" \"carrier R\"],\n        assumption+,\n        frule_tac a = \"Suc n\" in forall_spec, simp,\n        thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\",\n        frule set_mult_sub[of A B], simp add:ideal_subset1,\n        frule_tac c = \"f (Suc n)\" in subsetD[of \"set_mult R A B\" \"carrier R\"],\n        assumption+ )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus>\n                                    f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule_tac x = \"\\<Sigma>\\<^sub>e R f n\" and y = \"f (Suc n)\" in aGroup.ag_p_inv[of R],\n        assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R; f (Suc n) \\<in> carrier R;\n        -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)) =\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<plusminus>\n        -\\<^sub>a f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<plusminus>\n                         -\\<^sub>a f (Suc n)\n                         \\<in> sum_mult R A B", "apply (rule_tac a = \"-\\<^sub>a (\\<Sigma>\\<^sub>e R f n)\" and b = \"-\\<^sub>a (f (Suc n))\" in \n        sum_mult_pOp_closed[of A B], assumption+,\n        simp add:ideal_subset1, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R; f (Suc n) \\<in> carrier R;\n        -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)) =\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<plusminus>\n        -\\<^sub>a f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a f (Suc n) \\<in> sum_mult R A B", "apply (frule_tac x = \"f (Suc n)\" in set_mult_mOp_closed[of A B], assumption+,\n        frule set_mult_sub_sum_mult[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; aGroup R;\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        sum_mult R A B \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R; f (Suc n) \\<in> carrier R;\n        -\\<^sub>a (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)) =\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<plusminus> -\\<^sub>a f (Suc n);\n        -\\<^sub>a f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a f (Suc n) \\<in> sum_mult R A B", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_iOp_closed:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; \n       x \\<in> sum_mult R A B \\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n     x \\<in> sum_mult R A B\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> sum_mult R A B", "apply (frule sum_mult_mem1 [of A B x],\n       simp add:ideal_subset1, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> sum_mult R A B;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> sum_mult R A B", "apply (erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; x \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a x \\<in> sum_mult R A B", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f n\n                         \\<in> sum_mult R A B", "apply (frule_tac n = n and f = f in mem_minus_sum_multTr4[of A B], \n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        -\\<^sub>a \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a \\<Sigma>\\<^sub>e R f n\n                         \\<in> sum_mult R A B", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_ring_multiplicationTr:\n      \"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n       (\\<forall>j \\<le> n. f j \\<in> set_mult R A B) \\<longrightarrow> r \\<cdot>\\<^sub>r (nsum R f n) \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n                      \\<in> sum_mult R A B", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>n.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n                      \\<in> sum_mult R A B", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>0.\n                          f j \\<in> set_mult R A B) \\<longrightarrow>\n                      r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0\n                      \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     aGroup R; f 0 \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (simp add:set_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     aGroup R;\n     \\<exists>x\\<in>A. \\<exists>y\\<in>B. x \\<cdot>\\<^sub>r y = f 0\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r f 0 \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply ((erule bexE)+, frule sym, thin_tac \"x \\<cdot>\\<^sub>r y = f 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; x \\<in> A; y \\<in> B; f 0 = x \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y)\n                         \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (frule_tac c = x in subsetD[of A \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; x \\<in> A; y \\<in> B; f 0 = x \\<cdot>\\<^sub>r y;\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y)\n                         \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (frule ideal_subset1[of B],\n        frule_tac c = y in subsetD[of B \"carrier R\"], assumption,\n        frule_tac x = r and y = \"x \\<cdot>\\<^sub>r y\" in ring_tOp_commute,\n        simp add:ring_tOp_closed, simp,\n        subst ring_tOp_assoc, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; x \\<in> A; y \\<in> B; f 0 = x \\<cdot>\\<^sub>r y;\n        x \\<in> carrier R; B \\<subseteq> carrier R; y \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) =\n        x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r r\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r r)\n                         \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (frule_tac x = y and y = r in ring_tOp_commute, assumption+,\n        simp,\n        frule_tac x = y and r = r in ideal_ring_multiple [of B], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R; x \\<in> A; y \\<in> B; f 0 = x \\<cdot>\\<^sub>r y;\n        x \\<in> carrier R; B \\<subseteq> carrier R; y \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) =\n        x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r r;\n        y \\<cdot>\\<^sub>r r = r \\<cdot>\\<^sub>r y;\n        r \\<cdot>\\<^sub>r y \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (r \\<cdot>\\<^sub>r y)\n                         \\<in> sum_mult R A B\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (rule times_mem_sum_mult, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n        \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> set_mult R A B) \\<longrightarrow>\n                         r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        (\\<forall>j\\<le>n. f j \\<in> set_mult R A B) \\<longrightarrow>\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> sum_mult R A B", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule_tac f = f and n = n in aGroup.nsum_mem,\n        frule set_mult_sub [of \"A\" \"B\"], simp add:ideal_subset1,\n        rule allI, rule impI, cut_tac n = n in Nsetn_sub_mem1,\n         simp add: subsetD,\n        frule_tac a = \"Suc n\" in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> sum_mult R A B", "apply (frule set_mult_sub[of A B], simp add:ideal_subset1,\n        frule_tac c = \"f (Suc n)\" in subsetD[of \"set_mult R A B\" \"carrier R\"],\n        assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R A B;\n        set_mult R A B \\<subseteq> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> sum_mult R A B", "apply (simp add: ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R f n \\<plusminus>\n                         r \\<cdot>\\<^sub>r f (Suc n)\n                         \\<in> sum_mult R A B", "apply (rule sum_mult_pOp_closed[of A B], assumption+,\n        simp add:ideal_subset1, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        aGroup R;\n        r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        \\<forall>j\\<le>Suc n. f j \\<in> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r f (Suc n) \\<in> sum_mult R A B", "apply (frule_tac x = \"f (Suc n)\" in set_mult_ring_times_closed [of A B _ r],\n        assumption+, simp, assumption,\n        frule set_mult_sub_sum_mult[of A B], assumption+,\n        simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_ring_multiplication:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; \n r \\<in> carrier R; a \\<in> sum_mult R A B\\<rbrakk>  \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> sum_mult R A B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     a \\<in> sum_mult R A B\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> sum_mult R A B", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     a \\<in> sum_mult R A B; aGroup R\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> sum_mult R A B", "apply (frule sum_mult_mem1[of A B a],\n       simp add:ideal_subset1, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n     a \\<in> sum_mult R A B; aGroup R;\n     \\<exists>n.\n        \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n = a\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> sum_mult R A B", "apply (erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = a\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n                         \\<in> sum_mult R A B", "apply (subgoal_tac \"\\<forall>j \\<le> n. f j \\<in> set_mult R A B\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n;\n        \\<forall>j\\<le>n. f j \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n\n                         \\<in> sum_mult R A B\n 2. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> set_mult R A B", "apply (simp add:sum_mult_ring_multiplicationTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; r \\<in> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B; aGroup R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        a = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> set_mult R A B", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_sum_mult:\"\\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B\\<rbrakk> \\<Longrightarrow>\n                ideal R (sum_mult R A B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B\\<rbrakk>\n    \\<Longrightarrow> ideal R (sum_mult R A B)", "apply (simp add:ideal_def [of _ \"sum_mult R A B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B\\<rbrakk>\n    \\<Longrightarrow> R +> sum_mult R A B \\<and>\n                      (\\<forall>r\\<in>carrier R.\n                          \\<forall>x\\<in>sum_mult R A B.\n                             r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> R +> sum_mult R A B \\<and>\n                      (\\<forall>r\\<in>carrier R.\n                          \\<forall>x\\<in>sum_mult R A B.\n                             r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> R +> sum_mult R A B\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule aGroup.asubg_test, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> carrier R\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 4. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule subsetI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 4. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (frule_tac x = x in sum_mult_mem1[of A B],\n        simp add:ideal_subset1, assumption,\n        erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 4. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule_tac f = f and n = n in sum_mult_mem[of A B _ _], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> B \\<subseteq> carrier R\n 2. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> set_mult R A B\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 4. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 5. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (simp add:ideal_subset1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> set_mult R A B\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 4. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (frule nonempty_ex[of A], erule exE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        x \\<in> A\\<rbrakk>\n       \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (frule ideal_zero[of B])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        x \\<in> A; \\<zero> \\<in> B\\<rbrakk>\n       \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (frule_tac a = x and b = \\<zero> in times_mem_sum_mult[of A B],\n        simp add:ideal_subset1, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        x \\<in> A; \\<zero> \\<in> B;\n        x \\<cdot>\\<^sub>r \\<zero> \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> sum_mult R A B \\<noteq> {}\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 3. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>sum_mult R A B.\n                         \\<forall>b\\<in>sum_mult R A B.\n                            a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        a \\<in> sum_mult R A B; b \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<in> sum_mult R A B\n 2. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule_tac a = a and b = \"-\\<^sub>a b\" in sum_mult_pOp_closed[of A B],\n        assumption, simp add:ideal_subset1, assumption+,\n        rule_tac x = b in sum_mult_iOp_closed[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>sum_mult R A B.\n                            r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>A \\<subseteq> carrier R; A \\<noteq> {}; ideal R B; aGroup R;\n        r \\<in> carrier R; x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> sum_mult R A B", "apply (rule sum_mult_ring_multiplication, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inc_set_multTr:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C; \n       set_mult R A B \\<subseteq> C \\<rbrakk> \\<Longrightarrow>\n         \\<forall>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R A B. \\<Sigma>\\<^sub>e R f n \\<in> C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n     set_mult R A B \\<subseteq> C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f n \\<in> C", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n     set_mult R A B \\<subseteq> C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> 0} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f 0 \\<in> C\n 2. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f Suc n \\<in> C", "apply (simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f Suc n \\<in> C", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<in> C", "apply (\n       frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" and \n                 B = \"set_mult R A B\"in funcset_mem, simp,\n       frule_tac c = \"f (Suc n)\" in subsetD[of \"set_mult R A B\" \"C\"], \n       assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B; f (Suc n) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> C", "apply (rule ideal_pOp_closed[of C], assumption+,\n        cut_tac n = n in Nsetn_sub_mem1, \n        frule_tac x = f in bspec, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B; f (Suc n) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B\n 2. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B; f (Suc n) \\<in> C;\n        \\<forall>j.\n           j \\<in> {j. j \\<le> n} \\<longrightarrow>\n           j \\<in> {j. j \\<le> Suc n};\n        \\<Sigma>\\<^sub>e R f n \\<in> C\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> C\n 3. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<in> C;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        f (Suc n) \\<in> set_mult R A B; f (Suc n) \\<in> C\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> C", "apply (simp add:Pi_def, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inc_set_mult:\"\\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C; \n                           set_mult R A B \\<subseteq> C \\<rbrakk> \\<Longrightarrow> sum_mult R A B \\<subseteq> C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n     set_mult R A B \\<subseteq> C\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> C", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C; x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C", "apply (frule_tac x = x in sum_mult_mem1[of A B],\n        simp add:ideal_subset1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C; x \\<in> sum_mult R A B;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n              \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C", "apply (erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp,\n        thin_tac \"x = \\<Sigma>\\<^sub>e R f n\", simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>A \\<subseteq> carrier R; ideal R B; ideal R C;\n        set_mult R A B \\<subseteq> C;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> C", "apply (simp add:ideal_inc_set_multTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) AB_inc_sum_mult:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow> \n                                     sum_mult R A B \\<subseteq> A \\<inter> B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply (frule ideal_subset1[of A], frule ideal_subset1[of B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply (frule ideal_inc_set_mult [of \"A\" \"B\" \"A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> A\n 2. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R; sum_mult R A B \\<subseteq> A\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply (rule subsetI, \n       simp add:set_mult_def, (erule bexE)+, frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = x\",\n       simp,\n       frule_tac c = xa in subsetD[of A \"carrier R\"], assumption+,\n       frule_tac c = y in subsetD[of B \"carrier R\"], assumption+,\n       subst ring_tOp_commute, assumption+,\n       simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R; sum_mult R A B \\<subseteq> A\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply (frule ideal_inc_set_mult [of \"A\" \"B\" \"B\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R; sum_mult R A B \\<subseteq> A\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> B\n 2. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R; sum_mult R A B \\<subseteq> A;\n     sum_mult R A B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply (rule subsetI, \n       simp add:set_mult_def, (erule bexE)+, frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = x\",\n       simp,\n       frule_tac c = xa in subsetD[of A \"carrier R\"], assumption+,\n       simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n     B \\<subseteq> carrier R; sum_mult R A B \\<subseteq> A;\n     sum_mult R A B \\<subseteq> B\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<inter> B", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_mult_is_ideal_prod:\"\\<lbrakk>ideal R A; ideal R B\\<rbrakk> \\<Longrightarrow>\n                                  sum_mult R A B =  A \\<diamondsuit>\\<^sub>r B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B = A \\<diamondsuit>\\<^sub>r B", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (frule ideal_prod_ideal [of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> sum_mult R A B \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (rule ideal_inc_set_mult)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> A \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> ideal R B\n 3. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> ideal R (A \\<diamondsuit>\\<^sub>r B)\n 4. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 5. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (simp add:ideal_subset1)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B;\n     ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n    \\<Longrightarrow> set_mult R A B \\<subseteq> A \\<diamondsuit>\\<^sub>r B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R (A \\<diamondsuit>\\<^sub>r B);\n        x \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r B\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (simp add:set_mult_def ideal_prod_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        ideal R\n         (\\<Inter>\n           {L. ideal R L \\<and>\n               {x. \\<exists>i\\<in>A.\n                      \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n               \\<subseteq> L});\n        \\<exists>xa\\<in>A.\n           \\<exists>y\\<in>B. xa \\<cdot>\\<^sub>r y = x\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            ideal R xa \\<and>\n                            {x. \\<exists>i\\<in>A.\n                                   \\<exists>j\\<in>B.\nx = i \\<cdot>\\<^sub>r j}\n                            \\<subseteq> xa \\<longrightarrow>\n                            x \\<in> xa\n 2. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (auto del:subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r B \\<subseteq> sum_mult R A B", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        x \\<in> A \\<diamondsuit>\\<^sub>r B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (frule ideal_subset1[of A],\n        frule ideal_sum_mult[of A B],\n        frule ideal_zero[of A], blast, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        A \\<subseteq> carrier R; ideal R (sum_mult R A B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (frule_tac a = \"sum_mult R A B\" in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        A \\<subseteq> carrier R; ideal R (sum_mult R A B)\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>A.\n                                \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> sum_mult R A B\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        A \\<subseteq> carrier R; ideal R (sum_mult R A B);\n        x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (rule subsetI, simp,\n        thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j} \\<subseteq> xa \\<longrightarrow> x \\<in> xa\",\n        (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa i j.\n       \\<lbrakk>ideal R A; ideal R B; A \\<subseteq> carrier R;\n        ideal R (sum_mult R A B); i \\<in> A; j \\<in> B;\n        xa = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> sum_mult R A B\n 2. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>A. \\<exists>j\\<in>B. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        A \\<subseteq> carrier R; ideal R (sum_mult R A B);\n        x \\<in> sum_mult R A B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R A B", "apply (rule times_mem_sum_mult, assumption,\n        simp add:ideal_subset1, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_assocTr0:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; \n                 z \\<in> set_mult R A B\\<rbrakk> \\<Longrightarrow> z \\<cdot>\\<^sub>r y \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C;\n     z \\<in> set_mult R A B\\<rbrakk>\n    \\<Longrightarrow> z \\<cdot>\\<^sub>r y\n                      \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:set_mult_def, (erule bexE)+,\n        frule sym, thin_tac \"x \\<cdot>\\<^sub>r ya = z\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x ya.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; x \\<in> A;\n        ya \\<in> B; z = x \\<cdot>\\<^sub>r ya\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r ya \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (frule_tac h = x in ideal_subset[of A], assumption,\n        frule_tac h = ya in ideal_subset[of B], assumption,\n        frule_tac h = y in ideal_subset[of C], assumption,\n        subst ring_tOp_assoc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x ya.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; x \\<in> A;\n        ya \\<in> B; z = x \\<cdot>\\<^sub>r ya; x \\<in> carrier R;\n        ya \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (ya \\<cdot>\\<^sub>r y)\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (frule ideal_subset1[of A],\n        frule ideal_subset1[of B], \n        frule ideal_subset1[of C],\n        frule ideal_prod_ideal[of B C], assumption,\n        frule ideal_subset1[of \"B \\<diamondsuit>\\<^sub>r C\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x ya.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; x \\<in> A;\n        ya \\<in> B; z = x \\<cdot>\\<^sub>r ya; x \\<in> carrier R;\n        ya \\<in> carrier R; y \\<in> carrier R; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        B \\<diamondsuit>\\<^sub>r C \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (ya \\<cdot>\\<^sub>r y)\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (rule times_mem_sum_mult[of A \"B \\<diamondsuit>\\<^sub>r C\"], assumption+,\n         subst sum_mult_is_ideal_prod[of B C, THEN sym], assumption+,\n         rule times_mem_sum_mult[of B C], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_assocTr1:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C\\<rbrakk>\n \\<Longrightarrow> \\<forall>f \\<in> {j. j\\<le>(n::nat)} \\<rightarrow> set_mult R A B. (\\<Sigma>\\<^sub>e R f n) \\<cdot>\\<^sub>r y \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (frule ideal_prod_ideal[of \"B\" \"C\"], assumption+,\n       subst sum_mult_is_ideal_prod[of A \"B \\<diamondsuit>\\<^sub>r C\", THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n     ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n     ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> 0} \\<rightarrow>\n                                     set_mult R A B.\n                         \\<Sigma>\\<^sub>e R f 0 \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f Suc n \\<cdot>\\<^sub>r y\n                            \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n     ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{0} \\<rightarrow> set_mult R A B.\n                         f 0 \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f Suc n \\<cdot>\\<^sub>r y\n                            \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:ideal_prod_assocTr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R A B.\n                            \\<Sigma>\\<^sub>e R f Suc n \\<cdot>\\<^sub>r y\n                            \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (rule ballI,\n       frule_tac x = f in bspec,\n       thin_tac \"\\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n            \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\",\n       rule Pi_I, simp,\n       frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and B = \"set_mult R A B\" and\n                 x = x in funcset_mem, simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> (\\<Sigma>\\<^sub>e R f n \\<plusminus>\n                          f (Suc n)) \\<cdot>\\<^sub>r\n                         y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (frule ideal_subset1[of A], frule ideal_subset1[of B],\n        frule set_mult_sub[of A B], assumption,\n        frule_tac f = f and A = \"{j. j \\<le> (Suc n)}\" in extend_fun[of _ _ \n                 \"set_mult R A B\"\n         \"carrier R\"], assumption,\n        subst ring_distrib2,\n        simp add:ideal_subset)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R\n 2. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R\n 3. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r\n                         y \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (rule aGroup.nsum_mem, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier R\n 2. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R\n 3. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r\n                         y \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R\n 2. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r\n                         y \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:funcset_mem del:Pi_I',\n        frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and B = \"set_mult R A B\" and\n        x =  \"Suc n\" in funcset_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> set_mult R A B\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r\n                         y \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (frule ideal_subset1[of A],\n       frule ideal_zero[of A],\n       frule ideal_sum_mult[of A \"B \\<diamondsuit>\\<^sub>r C\"], blast, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> set_mult R A B; A \\<subseteq> carrier R;\n        \\<zero> \\<in> A;\n        ideal R (sum_mult R A (B \\<diamondsuit>\\<^sub>r C))\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r\n                         y \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (rule ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; y \\<in> C; aGroup R;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n           \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n           \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R A B;\n        \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n        \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C);\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        set_mult R A B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> set_mult R A B; A \\<subseteq> carrier R;\n        \\<zero> \\<in> A;\n        ideal R (sum_mult R A (B \\<diamondsuit>\\<^sub>r C))\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<cdot>\\<^sub>r y\n                         \\<in> sum_mult R A (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:ideal_prod_assocTr0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_quotient_idealTr:\"\\<lbrakk>ideal R A; ideal R B; ideal R C; \n       x \\<in> carrier R;\\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> ideal_quotient R A B\\<rbrakk> \\<Longrightarrow> \n       f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R B C \\<longrightarrow>  x \\<cdot>\\<^sub>r (nsum R f n) \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C.\n        x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow>\n                              set_mult R B C \\<longrightarrow>\n                      x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A", "apply (frule ideal_subset1 [of \"A\"],\n       frule ideal_subset1 [of \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> n} \\<rightarrow>\n                              set_mult R B C \\<longrightarrow>\n                      x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                              set_mult R B C \\<longrightarrow>\n                      x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R B C\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (cut_tac n_in_Nsetn[of 0])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R B C;\n     0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule funcset_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R B C;\n     0 \\<in> {i. i \\<le> 0}; f 0 \\<in> set_mult R B C\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (thin_tac \"f \\<in> {j. j \\<le> 0} \\<rightarrow> set_mult R B C\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     0 \\<in> {i. i \\<le> 0}; f 0 \\<in> set_mult R B C\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (simp add:set_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n     \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n     \\<exists>x\\<in>B. \\<exists>y\\<in>C. x \\<cdot>\\<^sub>r y = f 0\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; xa \\<cdot>\\<^sub>r y = f 0\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = f 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; f 0 = xa \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r y) \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule_tac h = xa in ideal_subset[of B], assumption,\n        frule_tac h = y in ideal_subset[of C], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; f 0 = xa \\<cdot>\\<^sub>r y; xa \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r y) \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule_tac x = xa and y = y in ring_tOp_commute, assumption+,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; f 0 = y \\<cdot>\\<^sub>r xa; xa \\<in> carrier R;\n        y \\<in> carrier R;\n        xa \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r xa\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r xa) \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (subst ring_tOp_assoc[THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; f 0 = y \\<cdot>\\<^sub>r xa; xa \\<in> carrier R;\n        y \\<in> carrier R;\n        xa \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r xa\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r xa \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule_tac x = y in bspec, assumption,\n        thin_tac \"\\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R; xa \\<in> B;\n        y \\<in> C; f 0 = y \\<cdot>\\<^sub>r xa; xa \\<in> carrier R;\n        y \\<in> carrier R; xa \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r xa;\n        x \\<cdot>\\<^sub>r y \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r xa \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (simp add:ideal_quotient_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "(****** n ********)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                 set_mult R B C \\<longrightarrow>\n                         x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply (frule func_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R B C \\<longrightarrow>\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (frule ideal_subset1[of B], frule ideal_subset1[of C],\n        frule set_mult_sub[of B C], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (cut_tac  n = n in nsum_memr [of _ \"f\"],\n        rule allI, rule impI,\n        frule_tac x = i in funcset_mem, simp, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (frule_tac a = n in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (thin_tac \"\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R\",\n        frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and B = \"set_mult R B C\" \n                  and x = \"Suc n\" in funcset_mem, simp,\n        frule_tac c = \"f (Suc n)\" in subsetD[of \"set_mult R B C\" \" carrier R\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R B C; f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n))\n                         \\<in> A", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R B C; f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R f n \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc n)\n                         \\<in> A", "apply (rule ideal_pOp_closed[of A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        f (Suc n) \\<in> set_mult R B C; f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r f (Suc n) \\<in> A", "apply (simp add: set_mult_def, (erule bexE)+,\n        fold set_mult_def,\n        frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y = f (Suc n)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        xa \\<cdot>\\<^sub>r y \\<in> carrier R; xa \\<in> B; y \\<in> C;\n        f (Suc n) = xa \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r y) \\<in> A", "apply (frule_tac c = xa in subsetD[of B \"carrier R\"], assumption+,\n        frule_tac c = y in subsetD[of C \"carrier R\"], assumption+,\n        frule_tac x = xa and y = y in ring_tOp_commute, assumption, simp,\n        subst ring_tOp_assoc[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n xa y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>c\\<in>C. x \\<cdot>\\<^sub>r c \\<in> A \\<dagger>\\<^sub>R B;\n        A \\<subseteq> carrier R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R B C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C; aGroup R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        set_mult R B C \\<subseteq> carrier R;\n        \\<Sigma>\\<^sub>e R f n \\<in> carrier R;\n        y \\<cdot>\\<^sub>r xa \\<in> carrier R; xa \\<in> B; y \\<in> C;\n        f (Suc n) = y \\<cdot>\\<^sub>r xa; xa \\<in> carrier R;\n        y \\<in> carrier R;\n        xa \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r xa\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r xa \\<in> A", "apply (simp add:ideal_quotient_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_quotient_ideal:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow> \n                         A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C = A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C =\n                      A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C\n                      \\<subseteq> A \\<dagger>\\<^sub>R\n                                     B \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<dagger>\\<^sub>R\n                                    B \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:ideal_quotient_def [of _ _ \"C\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>C.\n            x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<dagger>\\<^sub>R\n                                    B \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C.\n           x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<dagger>\\<^sub>R\n                                    B \\<diamondsuit>\\<^sub>r C\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:ideal_quotient_def [of _ _ \"B \\<diamondsuit>\\<^sub>r C\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C.\n           x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B \\<diamondsuit>\\<^sub>r C.\n                            x \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        b \\<in> B \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:sum_mult_is_ideal_prod [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        b \\<in> sum_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R B C.\n              \\<Sigma>\\<^sub>e R f n = b\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x b n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C;\n        \\<Sigma>\\<^sub>e R f n = b\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (rename_tac x c n f)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x c n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C;\n        \\<Sigma>\\<^sub>e R f n = c\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r c \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (frule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x c n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C;\n        \\<Sigma>\\<^sub>e R f n = c; c = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r c \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x c n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>C. x \\<cdot>\\<^sub>r b \\<in> A \\<dagger>\\<^sub>R B;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R B C;\n        c = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n \\<in> A\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:ideal_quotient_idealTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<dagger>\\<^sub>R B \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:sum_mult_is_ideal_prod [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<dagger>\\<^sub>R sum_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<dagger>\\<^sub>R B \\<dagger>\\<^sub>R C", "apply (simp add:ideal_quotient_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> carrier R \\<and>\n        (\\<forall>b\\<in>sum_mult R B C.\n            x \\<cdot>\\<^sub>r b \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>C.\n                            x \\<cdot>\\<^sub>r b \\<in> carrier R \\<and>\n                            (\\<forall>ba\\<in>B.\n                                x \\<cdot>\\<^sub>r b \\<cdot>\\<^sub>r ba\n                                \\<in> A)", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>C.\n                            x \\<cdot>\\<^sub>r b \\<in> carrier R \\<and>\n                            (\\<forall>ba\\<in>B.\n                                x \\<cdot>\\<^sub>r b \\<cdot>\\<^sub>r ba\n                                \\<in> A)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x b.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        b \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r b \\<in> carrier R \\<and>\n                         (\\<forall>ba\\<in>B.\n                             x \\<cdot>\\<^sub>r b \\<cdot>\\<^sub>r ba \\<in> A)", "apply (rename_tac x c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x c.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        c \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r c \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B.\n                             x \\<cdot>\\<^sub>r c \\<cdot>\\<^sub>r b \\<in> A)", "apply (frule ideal_subset [of \"C\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x c.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        c \\<in> C; c \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r c \\<in> carrier R \\<and>\n                         (\\<forall>b\\<in>B.\n                             x \\<cdot>\\<^sub>r c \\<cdot>\\<^sub>r b \\<in> A)", "apply (simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x c.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        c \\<in> C; c \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>b\\<in>B.\n                            x \\<cdot>\\<^sub>r c \\<cdot>\\<^sub>r b \\<in> A", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x c b.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        c \\<in> C; c \\<in> carrier R; b \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r c \\<cdot>\\<^sub>r b \\<in> A", "apply (rename_tac x v u)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x v u.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        v \\<in> C; v \\<in> carrier R; u \\<in> B\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r u \\<in> A", "apply (frule ideal_subset [of \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x v u.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        v \\<in> C; v \\<in> carrier R; u \\<in> B; u \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r v \\<cdot>\\<^sub>r u \\<in> A", "apply (subst ring_tOp_assoc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x v u.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        v \\<in> C; v \\<in> carrier R; u \\<in> B; u \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r u) \\<in> A", "apply (frule ideal_subset1[of B],\n        frule ideal_subset1[of C],\n        frule_tac a = u and b = v in times_mem_sum_mult[of B C], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x v u.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> carrier R;\n        \\<forall>b\\<in>sum_mult R B C. x \\<cdot>\\<^sub>r b \\<in> A;\n        v \\<in> C; v \\<in> carrier R; u \\<in> B; u \\<in> carrier R;\n        B \\<subseteq> carrier R; C \\<subseteq> carrier R;\n        u \\<cdot>\\<^sub>r v \\<in> sum_mult R B C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r (v \\<cdot>\\<^sub>r u) \\<in> A", "apply (frule_tac x = u and y = v in ring_tOp_commute, assumption,\n        simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_assocTr:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n  \\<forall>f. (f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R (A \\<diamondsuit>\\<^sub>r B) C \\<longrightarrow> \n                                          (\\<Sigma>\\<^sub>e R f n) \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f.\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                  C \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f n\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (subgoal_tac \"\\<forall>x\\<in>(A \\<diamondsuit>\\<^sub>r B). \\<forall>y\\<in>C. x \\<cdot>\\<^sub>r y \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C;\n     \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n        \\<forall>y\\<in>C.\n           x \\<cdot>\\<^sub>r y\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f.\n                         f \\<in> {j. j \\<le> n} \\<rightarrow>\n                                 set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                  C \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f n\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (induct_tac n)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C;\n     \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n        \\<forall>y\\<in>C.\n           x \\<cdot>\\<^sub>r y\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f.\n                         f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                  C \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f 0\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 3. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (rule allI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r\n                    (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                                 set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                  C \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f 0\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 3. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f 0\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 3. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (frule_tac f = f and A = \"{j. j \\<le> 0}\" and B = \"set_mult R (A \\<diamondsuit>\\<^sub>r B) C\"\n        and x = 0 in funcset_mem, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f 0 \\<in> set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> f 0\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 3. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:set_mult_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<exists>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<exists>y\\<in>C. x \\<cdot>\\<^sub>r y = f 0\\<rbrakk>\n       \\<Longrightarrow> f 0\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 3. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply ((erule bexE)+, frule sym, thin_tac \"x \\<cdot>\\<^sub>r y = f 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r\n                 (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                                    set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                                     C \\<longrightarrow>\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (frule func_pre)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<forall>f.\n           f \\<in> {j. j \\<le> n} \\<rightarrow>\n                   set_mult R (A \\<diamondsuit>\\<^sub>r B)\n                    C \\<longrightarrow>\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (frule_tac a = f in forall_spec, simp,\n         thin_tac \"\\<forall>f. f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R (A \\<diamondsuit>\\<^sub>r B) C \\<longrightarrow>\n               \\<Sigma>\\<^sub>e R f n \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\",\n         frule ideal_prod_ideal[of \"B\" \"C\"], assumption+,\n         frule ideal_prod_ideal[of \"A\" \"B \\<diamondsuit>\\<^sub>r C\"], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C))\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (rule ideal_pOp_closed[of \"A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R\n         (A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C))\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (cut_tac n = \"Suc n\" in n_in_Nsetn,\n       frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and \n       B = \"set_mult R (A \\<diamondsuit>\\<^sub>r B) C\" and x = \"Suc n\" in funcset_mem, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C));\n        Suc n \\<in> {i. i \\<le> Suc n};\n        f (Suc n) \\<in> set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (thin_tac \"f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R (A \\<diamondsuit>\\<^sub>r B) C\",\n        thin_tac \"f \\<in> {j. j \\<le> Suc n} \\<rightarrow> set_mult R (A \\<diamondsuit>\\<^sub>r B) C\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C));\n        Suc n \\<in> {i. i \\<le> Suc n};\n        f (Suc n) \\<in> set_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:set_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<forall>y\\<in>C.\n              x \\<cdot>\\<^sub>r y\n              \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C));\n        \\<exists>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n           \\<exists>y\\<in>C. x \\<cdot>\\<^sub>r y = f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply ((erule bexE)+,\n        frule sym, thin_tac \"x \\<cdot>\\<^sub>r y = f (Suc n)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>A \\<diamondsuit>\\<^sub>r B.\n                         \\<forall>y\\<in>C.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<diamondsuit>\\<^sub>r B; y \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:sum_mult_is_ideal_prod[of A B, THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> sum_mult R A B;\n        y \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (frule ideal_subset1[of A], frule ideal_subset1[of B],\n        frule_tac x = x in sum_mult_mem1[of A B], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C; x \\<in> sum_mult R A B;\n        y \\<in> C; A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R A B.\n              \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (erule exE, erule bexE, frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\",\n               simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<Sigma>\\<^sub>e R f n \\<in> sum_mult R A B; y \\<in> C;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R A B;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<cdot>\\<^sub>r y\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)", "apply (simp add:ideal_prod_assocTr1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_assoc:\"\\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk> \\<Longrightarrow>\n            (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C = A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r\n                      C =\n                      A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C\n                      \\<subseteq> A \\<diamondsuit>\\<^sub>r\n                                  (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r\n                C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (frule ideal_prod_ideal[of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (frule sum_mult_is_ideal_prod[of \"A \\<diamondsuit>\\<^sub>r B\" \"C\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        sum_mult R (A \\<diamondsuit>\\<^sub>r B) C =\n        (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (frule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        sum_mult R (A \\<diamondsuit>\\<^sub>r B) C =\n        (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C;\n        (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C =\n        sum_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (thin_tac \"sum_mult R (A \\<diamondsuit>\\<^sub>r B) C = (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C =\n        sum_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B);\n        (A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C =\n        sum_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (thin_tac \"(A \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r C = sum_mult R (A \\<diamondsuit>\\<^sub>r B) C\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (thin_tac \"ideal R (A \\<diamondsuit>\\<^sub>r B)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (A \\<diamondsuit>\\<^sub>r B) C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (frule ideal_prod_ideal[of \"B\" \"C\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          set_mult R (A \\<diamondsuit>\\<^sub>r B) C.\n              \\<Sigma>\\<^sub>e R f n = x;\n        ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> A \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (A \\<diamondsuit>\\<^sub>r B) C;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n\n                         \\<in> A \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r C)\n 2. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (simp add:ideal_prod_assocTr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; ideal R C\\<rbrakk>\n    \\<Longrightarrow> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C)\n                      \\<subseteq> (A \\<diamondsuit>\\<^sub>r\n                                   B) \\<diamondsuit>\\<^sub>r\n                                  C", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<diamondsuit>\\<^sub>r\n                (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (A \\<diamondsuit>\\<^sub>r\n                                  B) \\<diamondsuit>\\<^sub>r\n                                 C", "apply (frule ideal_prod_ideal[of \"B\" \"C\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> A \\<diamondsuit>\\<^sub>r (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (A \\<diamondsuit>\\<^sub>r\n                                  B) \\<diamondsuit>\\<^sub>r\n                                 C", "apply (simp add:ideal_prod_commute [of \"A\" \"B \\<diamondsuit>\\<^sub>r C\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (B \\<diamondsuit>\\<^sub>r C) \\<diamondsuit>\\<^sub>r A;\n        ideal R (B \\<diamondsuit>\\<^sub>r C)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (A \\<diamondsuit>\\<^sub>r\n                                  B) \\<diamondsuit>\\<^sub>r\n                                 C", "apply (frule ideal_prod_ideal[of \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (B \\<diamondsuit>\\<^sub>r C) \\<diamondsuit>\\<^sub>r A;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> (A \\<diamondsuit>\\<^sub>r\n                                  B) \\<diamondsuit>\\<^sub>r\n                                 C", "apply (simp add:ideal_prod_commute[of \"A \\<diamondsuit>\\<^sub>r B\" \"C\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (B \\<diamondsuit>\\<^sub>r C) \\<diamondsuit>\\<^sub>r A;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (A \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (A \\<diamondsuit>\\<^sub>r B)", "apply (simp add:ideal_prod_commute[of \"A\" \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (B \\<diamondsuit>\\<^sub>r C) \\<diamondsuit>\\<^sub>r A;\n        ideal R (B \\<diamondsuit>\\<^sub>r C);\n        ideal R (B \\<diamondsuit>\\<^sub>r A)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (simp add:ideal_prod_commute[of \"B\" \"C\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        ideal R (B \\<diamondsuit>\\<^sub>r A)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (frule ideal_prod_ideal[of \"C\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (frule sum_mult_is_ideal_prod[of \"C \\<diamondsuit>\\<^sub>r B\" \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        sum_mult R (C \\<diamondsuit>\\<^sub>r B) A =\n        (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (frule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        sum_mult R (C \\<diamondsuit>\\<^sub>r B) A =\n        (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A =\n        sum_mult R (C \\<diamondsuit>\\<^sub>r B) A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (thin_tac \"sum_mult R (C \\<diamondsuit>\\<^sub>r B) A = (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A;\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A =\n        sum_mult R (C \\<diamondsuit>\\<^sub>r B) A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B);\n        (C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A =\n        sum_mult R (C \\<diamondsuit>\\<^sub>r B) A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (thin_tac \"(C \\<diamondsuit>\\<^sub>r B) \\<diamondsuit>\\<^sub>r A = sum_mult R (C \\<diamondsuit>\\<^sub>r B) A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (C \\<diamondsuit>\\<^sub>r B)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (thin_tac \"ideal R (C \\<diamondsuit>\\<^sub>r B)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        ideal R (B \\<diamondsuit>\\<^sub>r A)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (frule ideal_prod_ideal[of \"B\" \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        x \\<in> sum_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        ideal R (B \\<diamondsuit>\\<^sub>r A)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          set_mult R (C \\<diamondsuit>\\<^sub>r B) A.\n              \\<Sigma>\\<^sub>e R f n = x;\n        ideal R (B \\<diamondsuit>\\<^sub>r A)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> C \\<diamondsuit>\\<^sub>r\n                                 (B \\<diamondsuit>\\<^sub>r A)", "apply (frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n f.\n       \\<lbrakk>ideal R A; ideal R B; ideal R C;\n        ideal R (B \\<diamondsuit>\\<^sub>r A);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (C \\<diamondsuit>\\<^sub>r B) A;\n        x = \\<Sigma>\\<^sub>e R f n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n\n                         \\<in> C \\<diamondsuit>\\<^sub>r\n                               (B \\<diamondsuit>\\<^sub>r A)", "apply (simp add:ideal_prod_assocTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_principal_idealTr0:\"  \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n         z \\<in> set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk> \\<Longrightarrow>  z \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     z \\<in> set_mult R (R \\<diamondsuit>\\<^sub>p a)\n              (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> z \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)", "apply (simp add:set_mult_def, (erule bexE)+,\n       simp add:Rxa_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) = z;\n        r \\<in> carrier R; x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            z = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (frule_tac x = r and y = a and z = \"ra \\<cdot>\\<^sub>r b\" in ring_tOp_assoc,\n           assumption+, simp add:ring_tOp_closed, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b)) = z;\n        r \\<in> carrier R; x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) =\n        z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            z = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_assoc[THEN sym, of a _ b])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r b) = z;\n        r \\<in> carrier R; x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) =\n        z\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            z = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (frule_tac x = a and y = ra in ring_tOp_commute, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b) = z;\n        r \\<in> carrier R; x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) = z;\n        a \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            z = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_assoc[of _ a b],\n       frule_tac x = a and y = b in ring_tOp_closed, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)) = z;\n        r \\<in> carrier R; x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) = z;\n        a \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r a;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            z = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_assoc[THEN sym, of _ _ \"a \\<cdot>\\<^sub>r b\"],\n       frule sym, thin_tac \"r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b) = z\", simp,\n       frule_tac x = r and y = ra in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b) =\n        r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b);\n        a \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r a;\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        z = r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b);\n        r \\<cdot>\\<^sub>r ra \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r\n                            (a \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_principal_idealTr1:\"  \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      \\<forall>f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b). \n                                         \\<Sigma>\\<^sub>e R f n \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                                     set_mult R (R \\<diamondsuit>\\<^sub>p a)\n(R \\<diamondsuit>\\<^sub>p b).\n                         \\<Sigma>\\<^sub>e R f n\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> 0} \\<rightarrow>\n                                     set_mult R (R \\<diamondsuit>\\<^sub>p a)\n(R \\<diamondsuit>\\<^sub>p b).\n                         \\<Sigma>\\<^sub>e R f 0\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                       set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                        (R \\<diamondsuit>\\<^sub>p b).\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b).\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> R \\<diamondsuit>\\<^sub>p\n                                  (a \\<cdot>\\<^sub>r b)", "apply (rule ballI, \n        frule_tac f = f in funcset_mem[of _ \"{j. j \\<le> 0}\" \n         \"set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b)\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> {j. j \\<le> 0} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        f 0\n        \\<in> set_mult R (R \\<diamondsuit>\\<^sub>p a)\n               (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f 0\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                       set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                        (R \\<diamondsuit>\\<^sub>p b).\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b).\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> R \\<diamondsuit>\\<^sub>p\n                                  (a \\<cdot>\\<^sub>r b)", "apply (simp add:prod_principal_idealTr0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        \\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                       set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                        (R \\<diamondsuit>\\<^sub>p b).\n           \\<Sigma>\\<^sub>e R f n\n           \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f\\<in>{j. j \\<le> Suc n} \\<rightarrow>\n  set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b).\n                            \\<Sigma>\\<^sub>e R f Suc n\n                            \\<in> R \\<diamondsuit>\\<^sub>p\n                                  (a \\<cdot>\\<^sub>r b)", "apply (rule ballI,\n       frule func_pre,\n       frule_tac x = f in bspec, assumption,\n       thin_tac \"\\<forall>f\\<in>{j. j \\<le> n} \\<rightarrow> set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b).\n                                       \\<Sigma>\\<^sub>e R f n \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)", "apply (frule ring_tOp_closed[of a b], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b);\n        a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)", "apply (frule principal_ideal[of \"a \\<cdot>\\<^sub>r b\"], simp,\n        rule ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b);\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b))\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)", "apply (cut_tac n = \"Suc n\" in n_in_Nsetn,\n        frule_tac f = f and A = \"{j. j \\<le> Suc n}\" and \n        B = \"set_mult R (R \\<diamondsuit>\\<^sub>p a) (R \\<diamondsuit>\\<^sub>p b)\" in funcset_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        \\<Sigma>\\<^sub>e R f n\n        \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b);\n        a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b));\n        Suc n \\<in> {i. i \\<le> Suc n};\n        f (Suc n)\n        \\<in> set_mult R (R \\<diamondsuit>\\<^sub>p a)\n               (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)", "apply (simp add:prod_principal_idealTr0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_principal_ideal:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow> \n                     (Rxa R a) \\<diamondsuit>\\<^sub>r (Rxa R b) = Rxa R (a \\<cdot>\\<^sub>r b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r\n                      R \\<diamondsuit>\\<^sub>p b =\n                      R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)", "apply (frule principal_ideal[of \"a\"], \n       frule principal_ideal[of \"b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r\n                      R \\<diamondsuit>\\<^sub>p b =\n                      R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)", "apply (subst sum_mult_is_ideal_prod[THEN sym, of \"Rxa R a\" \"Rxa R b\"], \n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                       (R \\<diamondsuit>\\<^sub>p b) =\n                      R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                       (R \\<diamondsuit>\\<^sub>p b)\n                      \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                  (a \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        x \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> R \\<diamondsuit>\\<^sub>p\n                                 (a \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                           (R \\<diamondsuit>\\<^sub>p b).\n              \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> R \\<diamondsuit>\\<^sub>p\n                                 (a \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b);\n        \\<Sigma>\\<^sub>e R f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> R \\<diamondsuit>\\<^sub>p\n                                 (a \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (frule sym, thin_tac \"\\<Sigma>\\<^sub>e R f n = x\", simp, thin_tac \"x = \\<Sigma>\\<^sub>e R f n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n f.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        f \\<in> {j. j \\<le> n} \\<rightarrow>\n                set_mult R (R \\<diamondsuit>\\<^sub>p a)\n                 (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               (a \\<cdot>\\<^sub>r b)\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (simp add:prod_principal_idealTr1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                   (R \\<diamondsuit>\\<^sub>p b)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        x \\<in> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                  (R \\<diamondsuit>\\<^sub>p b)", "apply (simp add:Rxa_def, fold Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b);\n        \\<exists>r\\<in>carrier R.\n           x = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                  (R \\<diamondsuit>\\<^sub>p b)", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                  (R \\<diamondsuit>\\<^sub>p b)", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b\n                         \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                (R \\<diamondsuit>\\<^sub>p b)", "apply (frule ideal_subset1[of \"R \\<diamondsuit>\\<^sub>p a\"],\n        frule ideal_subset1[of \"R \\<diamondsuit>\\<^sub>p b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p b \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b\n                         \\<in> sum_mult R (R \\<diamondsuit>\\<^sub>p a)\n                                (R \\<diamondsuit>\\<^sub>p b)", "apply (rule_tac a = \"r \\<cdot>\\<^sub>r a\" and b = b in times_mem_sum_mult[of \"R \\<diamondsuit>\\<^sub>p a\" \n         \"R \\<diamondsuit>\\<^sub>p b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p b \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a\n                         \\<in> R \\<diamondsuit>\\<^sub>p a\n 2. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p b \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> b \\<in> R \\<diamondsuit>\\<^sub>p b", "apply (simp add:Rxa_def, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x r.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        ideal R (R \\<diamondsuit>\\<^sub>p b); r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p b \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> b \\<in> R \\<diamondsuit>\\<^sub>p b", "apply (simp add:a_in_principal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) principal_ideal_n_pow1:\"a \\<in> carrier R \\<Longrightarrow>  \n                                  (Rxa R a)\\<^bsup>\\<diamondsuit>R n\\<^esup>  = Rxa R (a^\\<^bsup>R n \\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n    R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                         \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                         \\<^bsup>\\<diamondsuit>R 0\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R 0\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> carrier R = R \\<diamondsuit>\\<^sub>p 1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply (cut_tac a_in_principal[of \"1\\<^sub>r\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     1\\<^sub>r \\<in> R \\<diamondsuit>\\<^sub>p 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> carrier R = R \\<diamondsuit>\\<^sub>p 1\\<^sub>r\n 2. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply (frule principal_ideal[of \"1\\<^sub>r\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     1\\<^sub>r \\<in> R \\<diamondsuit>\\<^sub>p 1\\<^sub>r;\n     ideal R (R \\<diamondsuit>\\<^sub>p 1\\<^sub>r)\\<rbrakk>\n    \\<Longrightarrow> carrier R = R \\<diamondsuit>\\<^sub>p 1\\<^sub>r\n 2. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply (frule ideal_inc_one, assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply (simp add:ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                            \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>) =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (frule_tac n = n in npClose[of a],\n        subst prod_principal_ideal, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>);\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         (a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>) =\n                         R \\<diamondsuit>\\<^sub>p\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (simp add:ring_tOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) principal_ideal_n_pow:\"\\<lbrakk>a \\<in> carrier R; I = Rxa R a\\<rbrakk> \\<Longrightarrow>  \n                                  I \\<^bsup>\\<diamondsuit>R n\\<^esup>  = Rxa R (a^\\<^bsup>R n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; I = R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> I \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; I = R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a\n                         \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup>)", "apply (rule principal_ideal_n_pow1[of \"a\" \"n\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>more about \\<open>ideal_n_prod\\<close>\\<close>"], ["", "lemma (in Ring) nprod_eqTr:\" f \\<in> {j. j \\<le> (n::nat)} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and> (\\<forall>j \\<le> n. f j = g j) \\<longrightarrow>\n       nprod R f n = nprod R g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,n\\<^esub> f = e\\<Pi>\\<^bsub>R,n\\<^esub> g", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n    g \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n    (\\<forall>j\\<le>0. f j = g j) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,0\\<^esub> f = e\\<Pi>\\<^bsub>R,0\\<^esub> g\n 2. \\<And>n.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n       e\\<Pi>\\<^bsub>R,n\\<^esub> f =\n       e\\<Pi>\\<^bsub>R,n\\<^esub> g \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>j\\<le>Suc n. f j = g j) \\<longrightarrow>\n       e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f = e\\<Pi>\\<^bsub>R,Suc n\\<^esub> g", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n       e\\<Pi>\\<^bsub>R,n\\<^esub> f =\n       e\\<Pi>\\<^bsub>R,n\\<^esub> g \\<Longrightarrow>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>j\\<le>Suc n. f j = g j) \\<longrightarrow>\n       e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f = e\\<Pi>\\<^bsub>R,Suc n\\<^esub> g", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n                g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n                (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n                e\\<Pi>\\<^bsub>R,n\\<^esub> f = e\\<Pi>\\<^bsub>R,n\\<^esub> g;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        g \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>j\\<le>Suc n. f j = g j\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f =\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> g", "apply (frule func_pre[of f], frule func_pre[of g],\n         cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nprod_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier R; \\<forall>j \\<le> n. g j \\<in> carrier R;\n(\\<forall>j \\<le> (n::nat). f j = g j)\\<rbrakk> \\<Longrightarrow> nprod R f n = nprod R g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier R;\n     \\<forall>j\\<le>n. g j \\<in> carrier R;\n     \\<forall>j\\<le>n. f j = g j\\<rbrakk>\n    \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f =\n                      e\\<Pi>\\<^bsub>R,n\\<^esub> g", "apply (cut_tac nprod_eqTr[of f n g])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier R;\n     \\<forall>j\\<le>n. g j \\<in> carrier R; \\<forall>j\\<le>n. f j = g j;\n     f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n     g \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n     (\\<forall>j\\<le>n. f j = g j) \\<longrightarrow>\n     e\\<Pi>\\<^bsub>R,n\\<^esub> f = e\\<Pi>\\<^bsub>R,n\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f =\n                      e\\<Pi>\\<^bsub>R,n\\<^esub> g", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mprod_expR :: \"[('b, 'm) Ring_scheme, nat \\<Rightarrow> nat, nat \\<Rightarrow> 'b, nat] \\<Rightarrow> 'b\" where\n  \"mprod_expR R e f n = nprod R (\\<lambda>j. ((f j)^\\<^bsup>R (e j)\\<^esup>)) n\""], ["", "(** Note that e j is a natural number for all j in Nset n **)"], ["", "lemma (in Ring) mprodR_Suc:\"\\<lbrakk>e \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> {j. (0::nat) \\<le> j};\n                 f \\<in> {j. j \\<le> (Suc n)} \\<rightarrow> carrier R\\<rbrakk> \\<Longrightarrow> \n       mprod_expR R e f (Suc n) = \n            (mprod_expR R e f n) \\<cdot>\\<^sub>r ((f (Suc n))^\\<^bsup>R (e (Suc n))\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j};\n     f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> mprod_expR R e f (Suc n) =\n                      mprod_expR R e f n \\<cdot>\\<^sub>r\n                      f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>", "apply (simp add:mprod_expR_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mprod_expR_memTr:\"e \\<in> {j. j \\<le> n} \\<rightarrow> {j. (0::nat) \\<le> j} \\<and> \n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R  \\<longrightarrow>  mprod_expR R e f n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n    f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n    mprod_expR R e f n \\<in> carrier R", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. e \\<in> {j. j \\<le> 0} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n    f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<longrightarrow>\n    mprod_expR R e f 0 \\<in> carrier R\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f n \\<in> carrier R \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f (Suc n) \\<in> carrier R", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>e \\<in> {j. j \\<le> 0} \\<rightarrow> {j. 0 \\<le> j};\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> mprod_expR R e f 0 \\<in> carrier R\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f n \\<in> carrier R \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f (Suc n) \\<in> carrier R", "apply (cut_tac n_in_Nsetn[of 0], \n        simp add: mprod_expR_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. f 0 \\<in> carrier R \\<Longrightarrow>\n    f 0^\\<^bsup>R e 0\\<^esup> \\<in> carrier R\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f n \\<in> carrier R \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f (Suc n) \\<in> carrier R", "apply (rule npClose,\n        simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f n \\<in> carrier R \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<longrightarrow>\n       mprod_expR R e f (Suc n) \\<in> carrier R", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n                f \\<in> {j. j \\<le> n} \\<rightarrow>\n                        carrier R \\<longrightarrow>\n                mprod_expR R e f n \\<in> carrier R;\n        e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> mprod_expR R e f (Suc n) \\<in> carrier R", "apply (frule func_pre[of \"e\"], frule func_pre[of \"f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n                f \\<in> {j. j \\<le> n} \\<rightarrow>\n                        carrier R \\<longrightarrow>\n                mprod_expR R e f n \\<in> carrier R;\n        e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> mprod_expR R e f (Suc n) \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>mprod_expR R e f n \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> mprod_expR R e f (Suc n) \\<in> carrier R", "apply (simp add:mprodR_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>mprod_expR R e f n \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> mprod_expR R e f n \\<cdot>\\<^sub>r\n                         f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>\n                         \\<in> carrier R", "apply (rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>mprod_expR R e f n \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>\n                         \\<in> carrier R", "apply (rule npClose, cut_tac n = \"Suc n\" in n_in_Nsetn)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>mprod_expR R e f n \\<in> carrier R;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        Suc n \\<in> {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mprod_expR_mem:\"\\<lbrakk> e \\<in> {j. j \\<le> n} \\<rightarrow> {j. (0::nat) \\<le> j};\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>   \\<Longrightarrow>  mprod_expR R e f n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j};\n     f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> mprod_expR R e f n \\<in> carrier R", "apply (simp add:mprod_expR_memTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_n_principal_idealTr:\"e \\<in> {j. j\\<le>n} \\<rightarrow> {j. (0::nat)\\<le>j} \\<and> \nf \\<in> {j. j\\<le>n} \\<rightarrow> carrier R \\<and> (\\<forall>k \\<le> n. J k = (Rxa R (f k))\\<^bsup>\\<diamondsuit>R (e k)\\<^esup>) \\<longrightarrow>\n                 ideal_n_prod R n J = Rxa R (mprod_expR R e f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n    f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n    (\\<forall>k\\<le>n.\n        J k =\n        R \\<diamondsuit>\\<^sub>p f k\n           \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n    R \\<diamondsuit>\\<^sub>p mprod_expR R e f n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. e \\<in> {j. j \\<le> 0} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n    f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n    (\\<forall>k\\<le>0.\n        J k =\n        R \\<diamondsuit>\\<^sub>p f k\n           \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,0\\<^esub> J =\n    R \\<diamondsuit>\\<^sub>p mprod_expR R e f 0\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. e \\<in> {j. j \\<le> 0} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n    f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R \\<and>\n    (\\<forall>k\\<le>0.\n        J k =\n        R \\<diamondsuit>\\<^sub>p f k\n           \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<Longrightarrow>\n    i\\<Pi>\\<^bsub>R,0\\<^esub> J =\n    R \\<diamondsuit>\\<^sub>p mprod_expR R e f 0\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>e \\<in> {j. j \\<le> 0} \\<rightarrow> {j. 0 \\<le> j};\n     f \\<in> {j. j \\<le> 0} \\<rightarrow> carrier R;\n     \\<forall>k\\<le>0.\n        J k =\n        R \\<diamondsuit>\\<^sub>p f k\n           \\<^bsup>\\<diamondsuit>R e k\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> i\\<Pi>\\<^bsub>R,0\\<^esub> J =\n                      R \\<diamondsuit>\\<^sub>p mprod_expR R e f 0\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (simp add:mprod_expR_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (f 0^\\<^bsup>R e 0\\<^esup>)\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (subgoal_tac \"J 0 = R \\<diamondsuit>\\<^sub>p (f 0) \\<^bsup>\\<diamondsuit>R (e 0)\\<^esup>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 = R \\<diamondsuit>\\<^sub>p f 0 \\<^bsup>\\<diamondsuit>R e 0\\<^esup>;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (f 0^\\<^bsup>R e 0\\<^esup>)\n 2. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> J 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\n 3. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup> =\n                      R \\<diamondsuit>\\<^sub>p (f 0^\\<^bsup>R e 0\\<^esup>)\n 2. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> J 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\n 3. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (rule principal_ideal_n_pow[of \"f 0\" \"R \\<diamondsuit>\\<^sub>p (f 0)\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<in> carrier R\n 2. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n 3. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> J 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\n 4. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (cut_tac n_in_Nsetn[of 0], simp add:Pi_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n 2. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> J 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\n 3. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f 0 \\<in> carrier R;\n     J 0 =\n     R \\<diamondsuit>\\<^sub>p f 0\n        \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> J 0 =\n                      R \\<diamondsuit>\\<^sub>p f 0\n                         \\<^bsup>\\<diamondsuit>R e 0\\<^esup>\n 2. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (cut_tac n_in_Nsetn[of 0], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f n \\<Longrightarrow>\n       e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n       f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R \\<and>\n       (\\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>) \\<longrightarrow>\n       i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n       R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (rule impI, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n                f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n                (\\<forall>k\\<le>n.\n                    J k =\n                    R \\<diamondsuit>\\<^sub>p f k\n                       \\<^bsup>\\<diamondsuit>R e\n          k\\<^esup>) \\<longrightarrow>\n                i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k\n              \\<^bsup>\\<diamondsuit>R e k\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n                         R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (frule func_pre[of \"e\"], frule func_pre[of \"f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j} \\<and>\n                f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R \\<and>\n                (\\<forall>k\\<le>n.\n                    J k =\n                    R \\<diamondsuit>\\<^sub>p f k\n                       \\<^bsup>\\<diamondsuit>R e\n          k\\<^esup>) \\<longrightarrow>\n                i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        e \\<in> {j. j \\<le> Suc n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j};\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J =\n                         R \\<diamondsuit>\\<^sub>p mprod_expR R e f (Suc n)", "apply (cut_tac n = n in Nsetn_sub_mem1,\n        simp add:mprodR_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (mprod_expR R e f n \\<cdot>\\<^sub>r\n                          f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (cut_tac n = \"Suc n\" in n_in_Nsetn, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (mprod_expR R e f n \\<cdot>\\<^sub>r\n                          f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (frule_tac A = \"{j. j \\<le> Suc n}\" and x = \"Suc n\" in funcset_mem[of \"f\" _ \"carrier R\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (mprod_expR R e f n \\<cdot>\\<^sub>r\n                          f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (frule_tac a = \"f (Suc n)\" and I = \"R \\<diamondsuit>\\<^sub>p (f (Suc n))\" and n = \"e (Suc n)\" in  principal_ideal_n_pow)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f (Suc n) =\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (mprod_expR R e f n \\<cdot>\\<^sub>r\n                          f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         (mprod_expR R e f n \\<cdot>\\<^sub>r\n                          f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (subst prod_principal_ideal[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> mprod_expR R e f n \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>\n                         \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p\n                         (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (simp add:mprod_expR_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>\n                         \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p\n                         (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply (rule npClose, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                R \\<diamondsuit>\\<^sub>p mprod_expR R e f n;\n        f \\<in> {j. j \\<le> Suc n} \\<rightarrow> carrier R;\n        \\<forall>k\\<le>Suc n.\n           J k =\n           R \\<diamondsuit>\\<^sub>p f k \\<^bsup>\\<diamondsuit>R e k\\<^esup>;\n        f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n        f (Suc n) \\<in> carrier R;\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n           \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n        R \\<diamondsuit>\\<^sub>p\n        (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p f (Suc n)\n                            \\<^bsup>\\<diamondsuit>R e (Suc n)\\<^esup> =\n                         R \\<diamondsuit>\\<^sub>p\n                         mprod_expR R e f n \\<diamondsuit>\\<^sub>r\n                         R \\<diamondsuit>\\<^sub>p\n                         (f (Suc n)^\\<^bsup>R e (Suc n)\\<^esup>)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(************* used in Valuation2.thy *****************)"], ["", "lemma (in Ring) prod_n_principal_ideal:\"\\<lbrakk>e \\<in> {j. j\\<le>n} \\<rightarrow> {j. (0::nat)\\<le>j};  \nf \\<in> {j. j\\<le>n} \\<rightarrow> carrier R; \\<forall>k\\<le> n. J k = (Rxa R (f k))\\<^bsup>\\<diamondsuit>R (e k)\\<^esup>\\<rbrakk> \\<Longrightarrow>\n                 ideal_n_prod R n J = Rxa R (mprod_expR R e f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>e \\<in> {j. j \\<le> n} \\<rightarrow> {j. 0 \\<le> j};\n     f \\<in> {j. j \\<le> n} \\<rightarrow> carrier R;\n     \\<forall>k\\<le>n.\n        J k =\n        R \\<diamondsuit>\\<^sub>p f k\n           \\<^bsup>\\<diamondsuit>R e k\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> i\\<Pi>\\<^bsub>R,n\\<^esub> J =\n                      R \\<diamondsuit>\\<^sub>p mprod_expR R e f n", "apply (simp add:prod_n_principal_idealTr[of e n f J])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*******************************************************)"], ["", "lemma (in Idomain) a_notin_n_pow1:\"\\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n\\<rbrakk>\n  \\<Longrightarrow>  a \\<notin> (Rxa R a) \\<^bsup>\\<diamondsuit>R  (Suc n)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                                    \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>", "apply (rule contrapos_pp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> ?Q\n 2. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     \\<not> a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                          \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<not> ?Q", "apply (simp del:ipSuc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     \\<not> a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                          \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<not> True", "apply (simp del:ipSuc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\n                \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule principal_ideal[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\n                \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule principal_ideal_n_pow[of \"a\" \"R \\<diamondsuit>\\<^sub>p a\" \"Suc n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\n                \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a =\n                      R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\n                \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\n                \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp del:ipSuc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p\n             (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p\n     (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup> = R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p\n             (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p a)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a \\<in> R \\<diamondsuit>\\<^sub>p\n             (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     \\<exists>r\\<in>carrier R.\n        a =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule npClose[of \"a\" \"n\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule ring_l_one[THEN sym, of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"1\\<^sub>r \\<cdot>\\<^sub>r a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (cut_tac b = \"r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup>)\" in idom_mult_cancel_r[of \"1\\<^sub>r\" _ \"a\"])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\n                         \\<in> carrier R\n 3. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R\n 4. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<zero>\n 5. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a\n 6. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 7. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp add:ring_one)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\n                         \\<in> carrier R\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R\n 3. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<zero>\n 4. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a\n 5. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 6. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> a \\<noteq> \\<zero>\n 3. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a\n 4. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 5. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<cdot>\\<^sub>r a =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (thin_tac \"1\\<^sub>r \\<cdot>\\<^sub>r a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\",\n        thin_tac \"a = 1\\<^sub>r \\<cdot>\\<^sub>r a\",\n        thin_tac \"a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (subgoal_tac \"1\\<^sub>r = r \\<cdot>\\<^sub>r (a^\\<^bsup>R (Suc (n - Suc 0))\\<^esup>)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\n 3. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 3. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp del:ipSuc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (thin_tac \"1\\<^sub>r = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R Suc (n - Suc 0)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp del:Suc_pred)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r\n        (a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (frule npClose[of \"a\" \"n - Suc 0\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r\n        (a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (frule_tac x = r and y = \"a^\\<^bsup>R (n - Suc 0)\\<^esup>\" in ring_tOp_closed, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp add:ring_tOp_commute[of _ a])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        a \\<cdot>\\<^sub>r\n        (r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>);\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply (simp add:Unit_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R;\n        \\<forall>b\\<in>carrier R.\n           a \\<cdot>\\<^sub>r b \\<noteq>\n           a \\<cdot>\\<^sub>r\n           (r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>);\n        a \\<noteq> \\<zero>; 0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r =\n        a \\<cdot>\\<^sub>r\n        (r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>);\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a = r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         a", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) a_notin_n_pow2:\"\\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; \n 0 < n\\<rbrakk> \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<notin> (Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> a^\\<^bsup>R n\\<^esup>\n                      \\<notin> R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>", "apply (rule contrapos_pp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> ?Q\n 2. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     \\<not> a^\\<^bsup>R n\\<^esup>\n            \\<notin> R \\<diamondsuit>\\<^sub>p a\n                        \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<not> ?Q", "apply (simp del:ipSuc, simp del:ipSuc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p a\n              \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule principal_ideal[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule principal_ideal_n_pow[of \"a\" \"R \\<diamondsuit>\\<^sub>p a\" \"Suc n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a =\n                      R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp, simp del:ipSuc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p\n           (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p\n     (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup> = R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p\n           (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p a)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     a^\\<^bsup>R n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p\n           (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>; 0 < n;\n     \\<exists>r\\<in>carrier R.\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule idom_potent_nonzero[of \"a\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule npClose[of \"a\" \"n\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule ring_l_one[THEN sym, of \"a^\\<^bsup>R n\\<^esup> \"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"1\\<^sub>r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup>) =  r \\<cdot>\\<^sub>r ((a^\\<^bsup>R n\\<^esup>) \\<cdot>\\<^sub>r a)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\n 2. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n        a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (thin_tac \"a^\\<^bsup>R n\\<^esup> = 1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\",\n        thin_tac \"a^\\<^bsup>R n\\<^esup> = r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:ring_tOp_commute[of \"a^\\<^bsup>R n\\<^esup>\" a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_one,\n        frule_tac b = \"r \\<cdot>\\<^sub>r a\" in idom_mult_cancel_r[of \"1\\<^sub>r\" _ \"a^\\<^bsup>R n\\<^esup>\"],\n        simp add:ring_tOp_closed,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n        r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>;\n        1\\<^sub>r \\<in> carrier R; 1\\<^sub>r = r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:ring_tOp_commute[of _ a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; a \\<noteq> \\<zero>;\n        0 < n; r \\<in> carrier R; a^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        a \\<cdot>\\<^sub>r r \\<in> carrier R;\n        1\\<^sub>r = a \\<cdot>\\<^sub>r r\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Unit_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) n_pow_not_prime:\"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;  0 < n\\<rbrakk>\n            \\<Longrightarrow>   \\<not> prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (case_tac \"n = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n = 0\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (case_tac \"Unit R a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp del:ipSuc add:prime_ideal_def, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R\n      (R \\<diamondsuit>\\<^sub>p a\n          \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p a\n                               \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p a\n\\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule principal_ideal[of \"a\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p a\n                               \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p a\n\\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule principal_ideal_n_pow[of \"a\" \"R \\<diamondsuit>\\<^sub>p a\" \"Suc n\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a =\n                      R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p a\n                               \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p a\n\\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 3. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p a\n                               \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p a\n\\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p a\n     \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; Unit R a;\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp del:npow_suc add:idom_potent_unit [of \"a\" \"Suc n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     Unit R (a^\\<^bsup>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (thin_tac \"R \\<diamondsuit>\\<^sub>p a \\<diamondsuit>\\<^sub>r R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup> = R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R (Suc n)\\<^esup>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     Unit R (a^\\<^bsup>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule npClose[of \"a\" \"Suc n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     Unit R (a^\\<^bsup>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     a^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule a_in_principal[of \"a^\\<^bsup>R (Suc n)\\<^esup>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n;\n     Unit R (a^\\<^bsup>R Suc n\\<^esup>);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     a^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n     a^\\<^bsup>R Suc n\\<^esup>\n     \\<in> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp add: ideal_inc_unit)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule a_notin_n_pow1[of \"a\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule a_notin_n_pow2[of \"a\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule npClose[of \"a\" \"n\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule principal_ideal[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (frule principal_ideal_n_pow[of \"a\" \"R \\<diamondsuit>\\<^sub>p a\" \"Suc n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a =\n                      R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; n \\<noteq> 0;\n     \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p a\n                   \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>;\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p a\n                                  \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp del:ipSuc npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup> =\n     R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p\n                               (a^\\<^bsup>R Suc n\\<^esup>))", "apply (thin_tac \"R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup> = R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R (Suc n)\\<^esup>)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> \\<not> prime_ideal R\n                              (R \\<diamondsuit>\\<^sub>p\n                               (a^\\<^bsup>R Suc n\\<^esup>))", "apply (subst prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> \\<not> (ideal R\n                               (R \\<diamondsuit>\\<^sub>p\n                                (a^\\<^bsup>R Suc n\\<^esup>)) \\<and>\n                              1\\<^sub>r\n                              \\<notin> R \\<diamondsuit>\\<^sub>p\n (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                              (\\<forall>x\\<in>carrier R.\n                                  \\<forall>y\\<in>carrier R.\n                                     x \\<cdot>\\<^sub>r y\n                                     \\<in> R \\<diamondsuit>\\<^sub>p\n     (a^\\<^bsup>R Suc n\\<^esup>) \\<longrightarrow>\n                                     x \\<in> R \\<diamondsuit>\\<^sub>p\n       (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                                     y \\<in> R \\<diamondsuit>\\<^sub>p\n       (a^\\<^bsup>R Suc n\\<^esup>)))", "apply (simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> ideal R\n                       (R \\<diamondsuit>\\<^sub>p\n                        (a^\\<^bsup>R Suc n\\<^esup>)) \\<longrightarrow>\n                      1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))", "apply (subgoal_tac \"(a^\\<^bsup>R n\\<^esup>) \\<cdot>\\<^sub>r a \\<in> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R (Suc n)\\<^esup>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>));\n     a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\n     \\<in> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>) \\<or>\n                      (\\<exists>x\\<in>carrier R.\n                          \\<exists>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> R \\<diamondsuit>\\<^sub>p\n                                   (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             x \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>) \\<and>\n                             y \\<notin> R \\<diamondsuit>\\<^sub>p\n  (a^\\<^bsup>R Suc n\\<^esup>))\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     a \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup>\n     \\<notin> R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     ideal R (R \\<diamondsuit>\\<^sub>p (a^\\<^bsup>R Suc n\\<^esup>))\\<rbrakk>\n    \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a\n                      \\<in> R \\<diamondsuit>\\<^sub>p\n                            (a^\\<^bsup>R Suc n\\<^esup>)", "apply (simp add:Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     \\<forall>r\\<in>carrier R.\n        a \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     \\<forall>r\\<in>carrier R.\n        a^\\<^bsup>R n\\<^esup> \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n     ideal R\n      {x. \\<exists>r\\<in>carrier R.\n             x =\n             r \\<cdot>\\<^sub>r\n             (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (frule ring_tOp_closed[of \"a\" \"a^\\<^bsup>R n\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     \\<forall>r\\<in>carrier R.\n        a \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     \\<forall>r\\<in>carrier R.\n        a^\\<^bsup>R n\\<^esup> \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n     ideal R\n      {x. \\<exists>r\\<in>carrier R.\n             x =\n             r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)};\n     a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (frule ring_l_one[THEN sym, of \"a \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup>)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     \\<forall>r\\<in>carrier R.\n        a \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     \\<forall>r\\<in>carrier R.\n        a^\\<^bsup>R n\\<^esup> \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n     ideal R\n      {x. \\<exists>r\\<in>carrier R.\n             x =\n             r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)};\n     a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n     1\\<^sub>r \\<cdot>\\<^sub>r\n     (a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; 0 < n; \\<not> Unit R a;\n     \\<forall>r\\<in>carrier R.\n        a \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     \\<forall>r\\<in>carrier R.\n        a^\\<^bsup>R n\\<^esup> \\<noteq>\n        r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a);\n     a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n     ideal R\n      {x. \\<exists>r\\<in>carrier R.\n             x =\n             r \\<cdot>\\<^sub>r (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)};\n     a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n     a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup> =\n     1\\<^sub>r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r a^\\<^bsup>R n\\<^esup>);\n     1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a =\n                         r \\<cdot>\\<^sub>r\n                         (a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r a)", "apply (simp add:ring_tOp_commute[of _ a], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) principal_pow_prime_condTr:\n  \"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup>)\\<rbrakk> \\<Longrightarrow> n = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a\n          \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = 0", "apply (rule contrapos_pp, (simp del:ipSuc)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     0 < n\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule n_pow_not_prime[of  \"a\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>);\n     0 < n;\n     \\<not> prime_ideal R\n             (R \\<diamondsuit>\\<^sub>p a\n                 \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp del:ipSuc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) principal_pow_prime_cond:\n  \"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;  prime_ideal R ((Rxa R a) \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk> \\<Longrightarrow> n = Suc 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a\n          \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply (case_tac \"n = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n = 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R (carrier R); n = 0\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply (simp add:prime_ideal_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     ideal R (carrier R) \\<and> 1\\<^sub>r \\<notin> carrier R; n = 0\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>; n = 0;\n     ideal R (carrier R); 1\\<^sub>r \\<notin> carrier R\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply (cut_tac ring_one, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0", "apply (subgoal_tac \"prime_ideal R (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R (Suc (n - Suc 0))\\<^esup>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a\n          \\<^bsup>\\<diamondsuit>R Suc (n - Suc 0)\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R\n                       (R \\<diamondsuit>\\<^sub>p a\n                           \\<^bsup>\\<diamondsuit>R Suc (n - Suc 0)\\<^esup>)", "apply (frule principal_pow_prime_condTr[of \"a\" \"n - Suc 0\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a\n          \\<^bsup>\\<diamondsuit>R Suc (n - Suc 0)\\<^esup>);\n     n - Suc 0 = 0\\<rbrakk>\n    \\<Longrightarrow> n = Suc 0\n 2. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R\n                       (R \\<diamondsuit>\\<^sub>p a\n                           \\<^bsup>\\<diamondsuit>R Suc (n - Suc 0)\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     prime_ideal R\n      (R \\<diamondsuit>\\<^sub>p a \\<^bsup>\\<diamondsuit>R n\\<^esup>);\n     n \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R\n                       (R \\<diamondsuit>\\<^sub>p a\n                           \\<^bsup>\\<diamondsuit>R Suc (n - Suc 0)\\<^esup>)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Extension and contraction\""], ["", "locale TwoRings = Ring +\n       fixes R' (structure)\n       assumes secondR: \"Ring R'\""], ["", "definition\n  i_contract :: \"['a \\<Rightarrow> 'b, ('a, 'm1) Ring_scheme, ('b, 'm2) Ring_scheme,\n    'b set]  \\<Rightarrow> 'a set\" where\n  \"i_contract f R R' J = invim f (carrier R) J\""], ["", "definition\n  i_extension :: \"['a \\<Rightarrow> 'b, ('a, 'm1) Ring_scheme, ('b, 'm2) Ring_scheme,\n           'a set] \\<Rightarrow> 'b set\" where\n  \"i_extension f R R' I = sum_mult R' (f ` I) (carrier R')\""], ["", "lemma (in TwoRings) i_contract_sub:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                       (i_contract f R R' J) \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R' J \\<subseteq> carrier R", "by (auto simp add:i_contract_def invim_def)"], ["", "lemma (in TwoRings) i_contract_ideal:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                                          ideal R (i_contract f R R' J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J\\<rbrakk>\n    \\<Longrightarrow> ideal R (i_contract f R R' J)", "apply (cut_tac Ring,\n        cut_tac secondR)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R (i_contract f R R' J)", "apply (rule ideal_condition)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R' J \\<subseteq> carrier R\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R' J \\<noteq> {}\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 4. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (simp add:i_contract_sub)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R' J \\<noteq> {}\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (simp add:i_contract_def invim_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> f x \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n     \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> f x \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (cut_tac Ring)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n     \\<zero> \\<in> carrier R; Ring R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> f x \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (frule rHom_0_0[of R R' f], assumption+,\n        cut_tac Ring.ideal_zero[of R' J])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n     \\<zero> \\<in> carrier R; Ring R; f \\<zero> = \\<zero>\\<^bsub>R'\\<^esub>;\n     \\<zero>\\<^bsub>R'\\<^esub> \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> f x \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n     \\<zero> \\<in> carrier R; Ring R;\n     f \\<zero> = \\<zero>\\<^bsub>R'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> Ring R'\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n     \\<zero> \\<in> carrier R; Ring R;\n     f \\<zero> = \\<zero>\\<^bsub>R'\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ideal R' J\n 4. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 5. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (frule sym, thin_tac \"f \\<zero> = \\<zero>\\<^bsub>R'\\<^esub>\", simp, blast,\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>i_contract f R R' J.\n                         \\<forall>y\\<in>i_contract f R R' J.\n                            x \\<plusminus> -\\<^sub>a y\n                            \\<in> i_contract f R R' J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        x \\<in> i_contract f R R' J; y \\<in> i_contract f R R' J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y\n                         \\<in> i_contract f R R' J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (simp add:i_contract_def invim_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        x \\<in> carrier R; f x \\<in> J; y \\<in> carrier R;\n        f y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> carrier R \\<and>\n                         f (x \\<plusminus> -\\<^sub>a y) \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (cut_tac ring_is_ag,\n        frule_tac x = y in aGroup.ag_mOp_closed[of R], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        x \\<in> carrier R; f x \\<in> J; y \\<in> carrier R; f y \\<in> J;\n        aGroup R; -\\<^sub>a y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> carrier R \\<and>\n                         f (x \\<plusminus> -\\<^sub>a y) \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        x \\<in> carrier R; f x \\<in> J; y \\<in> carrier R; f y \\<in> J;\n        aGroup R; -\\<^sub>a y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> f (x \\<plusminus> -\\<^sub>a y) \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (simp add:rHom_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        x \\<in> carrier R; f x \\<in> J; y \\<in> carrier R; f y \\<in> J;\n        aGroup R; -\\<^sub>a y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> f x \\<plusminus>\\<^bsub>R'\\<^esub> f (-\\<^sub>a y)\n                         \\<in> J\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply (frule_tac x = y in rHom_inv_inv[of R R' _ f], assumption+, simp,\n        thin_tac \"f (-\\<^sub>a y) = -\\<^sub>a\\<^bsub>R'\\<^esub> (f y)\",\n        frule_tac x = \"f y\" in Ring.ideal_inv1_closed[of R' J], assumption+,\n        rule Ring.ideal_pOp_closed[of R'], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>i_contract f R R' J.\n                            r \\<cdot>\\<^sub>r x \\<in> i_contract f R R' J", "apply ((rule ballI)+,\n        simp add:i_contract_def invim_def, erule conjE,\n        simp add:ring_tOp_closed,\n        simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; Ring R; Ring R';\n        r \\<in> carrier R; x \\<in> carrier R; f x \\<in> J\\<rbrakk>\n       \\<Longrightarrow> f r \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> f x \\<in> J", "apply (frule_tac a = r in rHom_mem[of f R R'], assumption,\n        simp add:Ring.ideal_ring_multiple[of R' J])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) i_contract_mono:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n J1 \\<subseteq> J2 \\<rbrakk> \\<Longrightarrow> i_contract f R R' J1 \\<subseteq> i_contract f R R' J2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n     J1 \\<subseteq> J2\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R' J1 \\<subseteq> i_contract f R R' J2", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n        J1 \\<subseteq> J2; x \\<in> i_contract f R R' J1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> i_contract f R R' J2", "apply (simp add:i_contract_def invim_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n        J1 \\<subseteq> J2; x \\<in> carrier R \\<and> f x \\<in> J1\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> J2", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J1; ideal R' J2;\n        J1 \\<subseteq> J2; x \\<in> carrier R; f x \\<in> J1\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> J2", "apply (rule subsetD, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) i_contract_prime:\"\\<lbrakk>f \\<in> rHom R R'; prime_ideal R' P\\<rbrakk> \\<Longrightarrow> \n                            prime_ideal R (i_contract f R R' P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; prime_ideal R' P\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R (i_contract f R R' P)", "apply (cut_tac Ring,\n        cut_tac secondR)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; prime_ideal R' P; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R (i_contract f R R' P)", "apply (simp add:prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> ideal R (i_contract f R R' P) \\<and>\n                      1\\<^sub>r \\<notin> i_contract f R R' P \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> i_contract f R R' P \\<longrightarrow>\n                             x \\<in> i_contract f R R' P \\<or>\n                             y \\<in> i_contract f R R' P)", "apply (simp add:i_contract_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> i_contract f R R' P \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> i_contract f R R' P \\<longrightarrow>\n                             x \\<in> i_contract f R R' P \\<or>\n                             y \\<in> i_contract f R R' P)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> i_contract f R R' P\n 2. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> i_contract f R R' P \\<longrightarrow>\n                            x \\<in> i_contract f R R' P \\<or>\n                            y \\<in> i_contract f R R' P", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P;\n     1\\<^sub>r \\<in> i_contract f R R' P\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> i_contract f R R' P \\<longrightarrow>\n                            x \\<in> i_contract f R R' P \\<or>\n                            y \\<in> i_contract f R R' P", "apply (simp add:i_contract_def invim_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P;\n     1\\<^sub>r \\<in> carrier R; f 1\\<^sub>r \\<in> P\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> i_contract f R R' P \\<longrightarrow>\n                            x \\<in> i_contract f R R' P \\<or>\n                            y \\<in> i_contract f R R' P", "apply (simp add:rHom_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n     1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n     \\<forall>x\\<in>carrier R'.\n        \\<forall>y\\<in>carrier R'.\n           x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> i_contract f R R' P \\<longrightarrow>\n                            x \\<in> i_contract f R R' P \\<or>\n                            y \\<in> i_contract f R R' P", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n        \\<forall>x\\<in>carrier R'.\n           \\<forall>y\\<in>carrier R'.\n              x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y\n              \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P;\n        x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y\n                         \\<in> i_contract f R R' P \\<longrightarrow>\n                         x \\<in> i_contract f R R' P \\<or>\n                         y \\<in> i_contract f R R' P", "apply (frule_tac a = x in rHom_mem[of \"f\" \"R\" \"R'\"], assumption+,\n        frule_tac a = y in rHom_mem[of \"f\" \"R\" \"R'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n        \\<forall>x\\<in>carrier R'.\n           \\<forall>y\\<in>carrier R'.\n              x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y\n              \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P;\n        x \\<in> carrier R; y \\<in> carrier R; f x \\<in> carrier R';\n        f y \\<in> carrier R'\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r y\n                         \\<in> i_contract f R R' P \\<longrightarrow>\n                         x \\<in> i_contract f R R' P \\<or>\n                         y \\<in> i_contract f R R' P", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n        \\<forall>x\\<in>carrier R'.\n           \\<forall>y\\<in>carrier R'.\n              x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y\n              \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P;\n        x \\<in> carrier R; y \\<in> carrier R; f x \\<in> carrier R';\n        f y \\<in> carrier R';\n        x \\<cdot>\\<^sub>r y \\<in> i_contract f R R' P\\<rbrakk>\n       \\<Longrightarrow> x \\<in> i_contract f R R' P \\<or>\n                         y \\<in> i_contract f R R' P", "apply (simp add:i_contract_def invim_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>f \\<in> rHom R R'; Ring R; Ring R'; ideal R' P;\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<notin> P;\n        \\<forall>x\\<in>carrier R'.\n           \\<forall>y\\<in>carrier R'.\n              x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y\n              \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P;\n        x \\<in> carrier R; y \\<in> carrier R; f x \\<in> carrier R';\n        f y \\<in> carrier R'; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        f (x \\<cdot>\\<^sub>r y) \\<in> P\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> P \\<or> f y \\<in> P", "apply (simp add:rHom_tOp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) i_extension_ideal:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I \\<rbrakk> \\<Longrightarrow>\n                            ideal R' (i_extension f R R' I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I\\<rbrakk>\n    \\<Longrightarrow> ideal R' (i_extension f R R' I)", "apply (cut_tac Ring, cut_tac secondR)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (i_extension f R R' I)", "apply (simp add:i_extension_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (sum_mult R' (f ` I) (carrier R'))", "apply (rule Ring.ideal_sum_mult [of \"R'\" \"f ` I\" \"carrier R'\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> f ` I \\<subseteq> carrier R'\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> f ` I \\<noteq> {}\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (carrier R')", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R';\n        x \\<in> f ` I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R'\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> f ` I \\<noteq> {}\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (carrier R')", "apply (simp add:image_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R';\n        \\<exists>xa\\<in>I. x = f xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R'\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> f ` I \\<noteq> {}\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (carrier R')", "apply (erule bexE, frule_tac a = xa in rHom_mem[of f R R'],\n          rule ideal_subset, assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> f ` I \\<noteq> {}\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (carrier R')", "apply (frule ideal_zero, simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; Ring R; Ring R'\\<rbrakk>\n    \\<Longrightarrow> ideal R' (carrier R')", "apply (simp add:Ring.whole_ideal[of R'])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) i_extension_mono:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n I1 \\<subseteq> I2 \\<rbrakk> \\<Longrightarrow> (i_extension f R R' I1) \\<subseteq> (i_extension f R R' I2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n     I1 \\<subseteq> I2\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' I1\n                      \\<subseteq> i_extension f R R' I2", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2; x \\<in> i_extension f R R' I1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> i_extension f R R' I2", "apply (simp add:i_extension_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        x \\<in> sum_mult R' (f ` I1) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> x \\<in> sum_mult R' (f ` I2) (carrier R')", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          set_mult R' (f ` I1) (carrier R').\n              \\<Sigma>\\<^sub>e R' f n = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R' (f ` I2) (carrier R').\n                               \\<Sigma>\\<^sub>e R' f n = x", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R' (f ` I2) (carrier R').\n                               \\<Sigma>\\<^sub>e R' f n = x", "apply (cut_tac Ring.set_mult_mono[of R' \"f ` I1\" \"f ` I2\" \"carrier R'\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x;\n        set_mult R' (f ` I1) (carrier R')\n        \\<subseteq> set_mult R' (f ` I2) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R' (f ` I2) (carrier R').\n                               \\<Sigma>\\<^sub>e R' f n = x\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> Ring R'\n 3. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> carrier R'\n 4. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I2 \\<subseteq> carrier R'\n 5. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 6. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply (frule_tac f = fa and A = \"{j. j \\<le> n}\" in extend_fun[of _ _ \n     \"set_mult R' (f ` I1) (carrier R')\" \"set_mult R' (f ` I2) (carrier R')\"],\n     assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x;\n        set_mult R' (f ` I1) (carrier R')\n        \\<subseteq> set_mult R' (f ` I2) (carrier R');\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I2) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n     set_mult R' (f ` I2) (carrier R').\n                               \\<Sigma>\\<^sub>e R' f n = x\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> Ring R'\n 3. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> carrier R'\n 4. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I2 \\<subseteq> carrier R'\n 5. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 6. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply blast"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> Ring R'\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> carrier R'\n 3. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I2 \\<subseteq> carrier R'\n 4. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 5. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply (simp add:secondR)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> carrier R'\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I2 \\<subseteq> carrier R'\n 3. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 4. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply (simp add:image_def, rule subsetI, simp, erule bexE,\n       frule_tac h = xb in ideal_subset[of I1], assumption, simp add:rHom_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I2 \\<subseteq> carrier R'\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 3. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply (simp add:image_def, rule subsetI, simp, erule bexE,\n       frule_tac h = xb in ideal_subset[of I2], assumption, simp add:rHom_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> f ` I1 \\<subseteq> f ` I2\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply (rule subsetI,\n        simp add:image_def, erule bexE,\n        frule_tac c = xb in subsetD[of I1 I2], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I1; ideal R I2;\n        I1 \\<subseteq> I2;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` I1) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> carrier R' \\<subseteq> carrier R'", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) e_c_inc_self:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I\\<rbrakk> \\<Longrightarrow>\n              I \\<subseteq> i_contract f R R' (i_extension f R R' I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> i_contract f R R' (i_extension f R R' I)", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> i_contract f R R' (i_extension f R R' I)", "apply (simp add:i_contract_def i_extension_def invim_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R \\<and>\n                         f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply (simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply (cut_tac secondR,\n        frule Ring.ring_one [of \"R'\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I; Ring R';\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<in> carrier R'\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply (frule_tac h = x in ideal_subset[of I], assumption,\n        frule_tac f = f and A = R and R = R' and a = x in rHom_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I; Ring R';\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<in> carrier R'; x \\<in> carrier R;\n        f x \\<in> carrier R'\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply (frule_tac t = \"f x\" in Ring.ring_r_one[THEN sym, of R'], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I; Ring R';\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<in> carrier R'; x \\<in> carrier R;\n        f x \\<in> carrier R';\n        f x =\n        f x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub>\n        1\\<^sub>r\\<^bsub>R'\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply (frule_tac a = \"f x\" and b = \"1\\<^sub>r\\<^bsub>R'\\<^esub>\" in Ring.times_mem_sum_mult[of R'\n                 \"f ` I\" \"carrier R'\"],\n       rule subsetI,\n       simp add:image_def, erule bexE,\n       frule_tac h = xb in ideal_subset[of I], assumption,\n       simp add:rHom_mem, simp,\n       simp add:image_def, blast, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R I; x \\<in> I; Ring R';\n        1\\<^sub>r\\<^bsub>R'\\<^esub> \\<in> carrier R'; x \\<in> carrier R;\n        f x \\<in> carrier R';\n        f x =\n        f x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> 1\\<^sub>r\\<^bsub>R'\\<^esub>;\n        f x \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> 1\\<^sub>r\\<^bsub>R'\\<^esub>\n        \\<in> sum_mult R' (f ` I) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> sum_mult R' (f ` I) (carrier R')", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) c_e_incd_self:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n                          i_extension f R R' (i_contract f R R' J) \\<subseteq> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' (i_contract f R R' J) \\<subseteq> J", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        x \\<in> i_extension f R R' (i_contract f R R' J)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (simp add:i_extension_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        x \\<in> sum_mult R' (f ` i_contract f R R' J) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (simp add:sum_mult_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        \\<exists>n.\n           \\<exists>f\\<in>{j. j \\<le> n} \\<rightarrow>\n                          set_mult R' (f ` i_contract f R R' J)\n                           (carrier R').\n              \\<Sigma>\\<^sub>e R' f n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (erule exE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (cut_tac secondR,\n        frule_tac n = n and f = fa in Ring.ideal_nsum_closed[of R' J ],\n        assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R'\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n. fa j \\<in> J\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa j.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R'; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> fa j \\<in> J\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (\n        frule_tac f = fa and A = \"{j. j \\<le> n}\" and \n        B = \"set_mult R' (f ` i_contract f R R' J) (carrier R')\" and x = j in\n        funcset_mem, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa j.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R'; j \\<le> n;\n        fa j\n        \\<in> set_mult R' (f ` i_contract f R R' J) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> fa j \\<in> J\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (\n  thin_tac \"fa \\<in> {j. j \\<le> n} \\<rightarrow> set_mult R' (f ` i_contract f R R' J) (carrier R')\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa j.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; \\<Sigma>\\<^sub>e R' fa n = x;\n        Ring R'; j \\<le> n;\n        fa j\n        \\<in> set_mult R' (f ` i_contract f R R' J) (carrier R')\\<rbrakk>\n       \\<Longrightarrow> fa j \\<in> J\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (simp add:set_mult_def, (erule bexE)+,\n         simp add:i_contract_def invim_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n fa j xa y.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J; \\<Sigma>\\<^sub>e R' fa n = x;\n        Ring R'; j \\<le> n; y \\<in> carrier R';\n        f xa \\<cdot>\\<^sub>r\\<^bsub>R'\\<^esub> y = fa j; xa \\<in> carrier R;\n        f xa \\<in> J\\<rbrakk>\n       \\<Longrightarrow> fa j \\<in> J\n 2. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply (frule_tac x = \"f xa\" and r = y in Ring.ideal_ring_multiple1[of R' J],\n         assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n fa.\n       \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n        fa \\<in> {j. j \\<le> n} \\<rightarrow>\n                 set_mult R' (f ` i_contract f R R' J) (carrier R');\n        \\<Sigma>\\<^sub>e R' fa n = x; Ring R';\n        \\<Sigma>\\<^sub>e R' fa n \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<in> J", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) c_e_c_eq_c:\"\\<lbrakk>f \\<in> rHom R R'; ideal R' J \\<rbrakk> \\<Longrightarrow>\n  i_contract f R R' (i_extension f R R' (i_contract f R R' J)) \n                                          = i_contract f R R' J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (frule i_contract_ideal [of \"f\" \"J\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J;\n     ideal R (i_contract f R R' J)\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (frule e_c_inc_self [of \"f\" \"i_contract f R R' J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J))\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (frule c_e_incd_self [of \"f\" \"J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (frule i_contract_mono [of \"f\" \n         \"i_extension f R R' (i_contract f R R' J)\" \"J\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> ideal R' (i_extension f R R' (i_contract f R R' J))\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> ideal R' J\n 3. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' (i_contract f R R' J) \\<subseteq> J\n 4. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J;\n     i_contract f R R' (i_extension f R R' (i_contract f R R' J))\n     \\<subseteq> i_contract f R R' J\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (rule i_extension_ideal, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R' J; ideal R (i_contract f R R' J);\n     i_contract f R R' J\n     \\<subseteq> i_contract f R R'\n                  (i_extension f R R' (i_contract f R R' J));\n     i_extension f R R' (i_contract f R R' J) \\<subseteq> J;\n     i_contract f R R' (i_extension f R R' (i_contract f R R' J))\n     \\<subseteq> i_contract f R R' J\\<rbrakk>\n    \\<Longrightarrow> i_contract f R R'\n                       (i_extension f R R' (i_contract f R R' J)) =\n                      i_contract f R R' J", "apply (rule equalityI, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in TwoRings) e_c_e_eq_e:\"\\<lbrakk>f \\<in> rHom R R'; ideal R I \\<rbrakk> \\<Longrightarrow>\n  i_extension f R R' (i_contract f R R' (i_extension f R R' I)) \n                                          = i_extension f R R' I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R'\n                       (i_contract f R R' (i_extension f R R' I)) =\n                      i_extension f R R' I", "apply (frule i_extension_ideal [of \"f\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I;\n     ideal R' (i_extension f R R' I)\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R'\n                       (i_contract f R R' (i_extension f R R' I)) =\n                      i_extension f R R' I", "apply (frule c_e_incd_self [of \"f\" \"i_extension f R R' I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; ideal R' (i_extension f R R' I);\n     i_extension f R R' (i_contract f R R' (i_extension f R R' I))\n     \\<subseteq> i_extension f R R' I\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R'\n                       (i_contract f R R' (i_extension f R R' I)) =\n                      i_extension f R R' I", "apply (rule equalityI, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; ideal R' (i_extension f R R' I);\n     i_extension f R R' (i_contract f R R' (i_extension f R R' I))\n     \\<subseteq> i_extension f R R' I\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' I\n                      \\<subseteq> i_extension f R R'\n                                   (i_contract f R R'\n                                     (i_extension f R R' I))", "apply (thin_tac \"i_extension f R R' (i_contract f R R' (i_extension f R R' I))\n       \\<subseteq> i_extension f R R' I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I;\n     ideal R' (i_extension f R R' I)\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' I\n                      \\<subseteq> i_extension f R R'\n                                   (i_contract f R R'\n                                     (i_extension f R R' I))", "apply (frule e_c_inc_self [of \"f\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; ideal R' (i_extension f R R' I);\n     I \\<subseteq> i_contract f R R' (i_extension f R R' I)\\<rbrakk>\n    \\<Longrightarrow> i_extension f R R' I\n                      \\<subseteq> i_extension f R R'\n                                   (i_contract f R R'\n                                     (i_extension f R R' I))", "apply (rule i_extension_mono [of \"f\" \"I\" \n               \"i_contract f R R' (i_extension f R R' I)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> rHom R R'; ideal R I; ideal R' (i_extension f R R' I);\n     I \\<subseteq> i_contract f R R' (i_extension f R R' I)\\<rbrakk>\n    \\<Longrightarrow> ideal R (i_contract f R R' (i_extension f R R' I))\n 2. \\<lbrakk>f \\<in> rHom R R'; ideal R I; ideal R' (i_extension f R R' I);\n     I \\<subseteq> i_contract f R R' (i_extension f R R' I)\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> i_contract f R R' (i_extension f R R' I)", "apply (rule i_contract_ideal, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Complete system of representatives\""], ["", "definition\n  csrp_fn :: \"[_, 'a set] \\<Rightarrow> 'a set \\<Rightarrow> 'a\" where\n  \"csrp_fn R I = (\\<lambda>x\\<in>carrier (R /\\<^sub>r I). (if x = I then \\<zero>\\<^bsub>R\\<^esub> else SOME y. y \\<in> x))\""], ["", "definition\n  csrp :: \"[_ , 'a set] \\<Rightarrow> 'a set\" where\n  \"csrp R I == (csrp_fn R I) ` (carrier (R /\\<^sub>r I))\""], ["", "(** complete system of representatives having 1-1 correspondence with\n    carrier  (R /\\<^sub>r I) **)"], ["", "lemma (in Ring) csrp_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                      \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:csrp_fn_def qring_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (case_tac \"a \\<uplus>\\<^bsub>R\\<^esub> I = I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> ((\\<exists>a\\<in>carrier R.\n                           a \\<uplus>\\<^bsub>R\\<^esub> I =\n                           I) \\<longrightarrow>\n                       \\<zero> \\<in> I) \\<and>\n                      ((\\<forall>a\\<in>carrier R.\n                           a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                           I) \\<longrightarrow>\n                       undefined \\<in> I)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (rule conjI, rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I;\n     \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a\\<in>carrier R.\n                          a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                          I) \\<longrightarrow>\n                      undefined \\<in> I\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (simp add:ideal_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a\\<in>carrier R.\n                          a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                          I) \\<longrightarrow>\n                      undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I;\n     \\<forall>a\\<in>carrier R.\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I;\n     \\<forall>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (frule_tac x = \\<zero>  in bspec, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I;\n     \\<forall>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     \\<zero> \\<in> carrier R;\n     \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (thin_tac \"\\<forall>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I; \\<zero> \\<in> carrier R;\n     \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (frule ideal_zero[of \"I\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I; \\<zero> \\<in> carrier R;\n     \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     \\<zero> \\<in> I\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply (frule ar_coset_same4[of \"I\" \"\\<zero>\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I = I \\<longrightarrow>\n                       ((\\<exists>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I) \\<longrightarrow>\n                        \\<zero> \\<in> I) \\<and>\n                       ((\\<forall>a\\<in>carrier R.\n                            a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            I) \\<longrightarrow>\n                        undefined \\<in> I)) \\<and>\n                      (a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                       I \\<longrightarrow>\n                       ((\\<exists>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                       ((\\<forall>aa\\<in>carrier R.\n                            aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                            a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                        undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> ((\\<exists>aa\\<in>carrier R.\n                           aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                           a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                       (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I) \\<and>\n                      ((\\<forall>aa\\<in>carrier R.\n                           aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                           a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                       undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (\\<exists>aa\\<in>carrier R.\n                          aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                          a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                      (SOME y. y \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I)\n                      \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>aa\\<in>carrier R.\n                          aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                          a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                      undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule impI, rule someI2_ex)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     \\<exists>aa\\<in>carrier R.\n        aa \\<uplus>\\<^bsub>R\\<^esub> I =\n        a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa. aa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<And>x.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n        \\<exists>aa\\<in>carrier R.\n           aa \\<uplus>\\<^bsub>R\\<^esub> I = a \\<uplus>\\<^bsub>R\\<^esub> I;\n        x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>aa\\<in>carrier R.\n                          aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                          a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                      undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule a_in_ar_coset[of \"I\" \"a\"], assumption+, blast, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>aa\\<in>carrier R.\n                          aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n                          a \\<uplus>\\<^bsub>R\\<^esub> I) \\<longrightarrow>\n                      undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     \\<forall>aa\\<in>carrier R.\n        aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq>\n        a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> undefined \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule_tac x = a in bspec, assumption+,\n        thin_tac \"\\<forall>aa\\<in>carrier R. aa \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> a \\<uplus>\\<^bsub>R\\<^esub> I\", simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_same:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I = a \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I\n                       (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I =\n                      a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule csrp_mem[of \"I\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n     \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I\n                       (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I =\n                      a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule ar_cos_same[of \"a\" \"I\" \"csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_mem1:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                           csrp_fn R I x \\<in> x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I x \\<in> x", "apply (simp add:qring_carrier, erule bexE, frule sym,\n       thin_tac \"a \\<uplus>\\<^bsub>R\\<^esub> I = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x = a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                         \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:csrp_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_fn_mem:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                              (csrp_fn R I x) \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I x \\<in> carrier R", "apply (simp add:qring_carrier, erule bexE, frule sym,\n       thin_tac \"a \\<uplus>\\<^bsub>R\\<^esub> I = x\", simp,\n       frule_tac a = a in csrp_mem[of \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x = a \\<uplus>\\<^bsub>R\\<^esub> I;\n        csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                         \\<in> carrier R", "apply (rule_tac a = a and x = \"csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\" in \n       ar_coset_subsetD[of  \"I\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_eq_coset:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                           (csrp_fn R I x) \\<uplus>\\<^bsub>R\\<^esub> I = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I x \\<uplus>\\<^bsub>R\\<^esub> I = x", "apply (simp add:qring_carrier, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I = x\\<rbrakk>\n       \\<Longrightarrow> csrp_fn R I x \\<uplus>\\<^bsub>R\\<^esub> I = x", "apply (frule sym, thin_tac \"a \\<uplus>\\<^bsub>R\\<^esub> I = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x = a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> csrp_fn R I\n                          (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I =\n                         a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule_tac a = a in csrp_mem[of  \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x = a \\<uplus>\\<^bsub>R\\<^esub> I;\n        csrp_fn R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n        \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> csrp_fn R I\n                          (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<uplus>\\<^bsub>R\\<^esub> I =\n                         a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule ar_cos_same, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_nz_nz:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I);\n        x \\<noteq> \\<zero>\\<^bsub>(R /\\<^sub>r I)\\<^esub>\\<rbrakk> \\<Longrightarrow> (csrp_fn R I x) \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I);\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> csrp_fn R I x \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I);\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>;\n     csrp_fn R I x = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule csrp_eq_coset[of \"I\" \"x\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I);\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>;\n     csrp_fn R I x = \\<zero>;\n     \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I = x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:qring_zero[of \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I); x \\<noteq> I;\n     csrp_fn R I x = \\<zero>;\n     \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I = x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule ideal_zero[of  \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I); x \\<noteq> I;\n     csrp_fn R I x = \\<zero>; \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I = x;\n     \\<zero> \\<in> I\\<rbrakk>\n    \\<Longrightarrow> False", "apply (\n       cut_tac ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I); x \\<noteq> I;\n     csrp_fn R I x = \\<zero>; \\<zero> \\<uplus>\\<^bsub>R\\<^esub> I = x;\n     \\<zero> \\<in> I; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:Qring_fix1 [of \"\\<zero>\" \"I\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_diff_in_vpr:\"\\<lbrakk>ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n              x \\<plusminus> (-\\<^sub>a (csrp_fn R I (pj R I x))) \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> -\\<^sub>a csrp_fn R I (pj R I x)\n                      \\<in> I", "apply (frule csrp_mem[of \"I\" \"x\"], \n       frule csrp_same[of \"I\" \"x\"], \n       simp add:pj_mem, assumption,\n       frule  ar_coset_subsetD[of I x \"csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier R;\n     csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\n     \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I;\n     csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> -\\<^sub>a csrp_fn R I (pj R I x)\n                      \\<in> I", "apply (frule belong_ar_coset2[of I x \"csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\"], assumption+,\n     frule ideal_inv1_closed[of I \"csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I) \\<plusminus> -\\<^sub>a x\"], assumption+,\n     cut_tac ring_is_ag,\n     frule aGroup.ag_mOp_closed[of R x], assumption,\n     simp add:aGroup.ag_pOp_commute[of R \"csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\" \"-\\<^sub>a x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier R;\n     csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\n     \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I;\n     csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I) \\<in> carrier R;\n     -\\<^sub>a x \\<plusminus> csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\n     \\<in> I;\n     -\\<^sub>a (-\\<^sub>a x \\<plusminus>\n                csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I))\n     \\<in> I;\n     aGroup R; -\\<^sub>a x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> -\\<^sub>a csrp_fn R I (pj R I x)\n                      \\<in> I", "apply (simp add:aGroup.ag_p_inv[of R \"-\\<^sub>a x\" \"csrp_fn R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\"],\n       simp add:aGroup.ag_inv_inv,\n       cut_tac Ring, simp add:pj_mem[of R I x])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) csrp_pj:\"\\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk> \\<Longrightarrow>\n                 (pj R I) (csrp_fn R I x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> pj R I (csrp_fn R I x) = x", "apply(cut_tac Ring,\n      frule csrp_fn_mem[of \"I\" \"x\"], assumption+,\n      simp add:pj_mem[of \"R\" \"I\" \"csrp_fn R I x\"],\n      simp add:csrp_eq_coset)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Polynomial ring\""], ["", "text\\<open>In this section, we treat a ring of polynomials over a ring S.\n       Numbers are of type ant\\<close>"], ["", "definition\n  pol_coeff :: \"[('a, 'more) Ring_scheme, (nat \\<times> (nat \\<Rightarrow> 'a))] \\<Rightarrow> bool\" where\n  \"pol_coeff S c \\<longleftrightarrow> (\\<forall>j \\<le> (fst c). (snd c) j \\<in> carrier S)\""], ["", "definition\n  c_max :: \"[('a, 'more) Ring_scheme, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> nat\" where\n  \"c_max S c = (if {j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} = {} then 0 else\n                   n_max {j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\""], ["", "definition\n  polyn_expr :: \"[('a, 'more) Ring_scheme, 'a, nat, nat \\<times> (nat \\<Rightarrow> 'a)]  \\<Rightarrow> 'a\" where\n  \"polyn_expr R X k c == nsum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (X^\\<^bsup>R j\\<^esup>)) k\""], ["", "definition\n  algfree_cond :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme,\n                                                'a] \\<Rightarrow> bool\" where\n  \"algfree_cond R S X \\<longleftrightarrow> (\\<forall>c. pol_coeff S c \\<and> (\\<forall>k \\<le> (fst c).  \n             (nsum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (X^\\<^bsup>R j\\<^esup>)) k = \\<zero>\\<^bsub>R\\<^esub> \\<longrightarrow> \n             (\\<forall>j \\<le> k. (snd c) j = \\<zero>\\<^bsub>S\\<^esub>))))\""], ["", "locale PolynRg = Ring +\n       fixes S (structure)\n       fixes X (structure)\n       assumes X_mem_R:\"X \\<in> carrier R\"\n       and not_zeroring:\"\\<not> Zero_ring S\"\n       and subring:  \"Subring R S\"\n       and algfree: \"algfree_cond R S X\"\n       and S_X_generate:\"x \\<in> carrier R \\<Longrightarrow>\n           \\<exists>f. pol_coeff S f \\<and> x = polyn_expr R X (fst f) f\""], ["", "(** a polynomial is an element of a polynomial ring **)"], ["", "section \\<open>Addition and multiplication of \\<open>polyn_exprs\\<close>\\<close>"], ["", "subsection \\<open>Simple properties of a \\<open>polyn_ring\\<close>\\<close>"], ["", "lemma Subring_subset:\"Subring R S \\<Longrightarrow> carrier S \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow> carrier S \\<subseteq> carrier R", "by (simp add:Subring_def)"], ["", "lemma (in Ring) subring_Ring:\"Subring R S \\<Longrightarrow> Ring S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow> Ring S", "by (simp add:Subring_def)"], ["", "lemma (in Ring) mem_subring_mem_ring:\"\\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n                      x \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R", "by (simp add:Subring_def, (erule conjE)+, simp add: subsetD)"], ["", "lemma (in Ring) Subring_pOp_ring_pOp:\"\\<lbrakk>Subring R S; a \\<in> carrier S;\n b \\<in> carrier S \\<rbrakk> \\<Longrightarrow> a \\<plusminus>\\<^bsub>S\\<^esub> b = a \\<plusminus> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; a \\<in> carrier S; b \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus>\\<^bsub>S\\<^esub> b = a \\<plusminus> b", "apply (simp add:Subring_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; Ring S;\n     carrier S \\<subseteq> carrier R; ridmap S \\<in> rHom S R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus>\\<^bsub>S\\<^esub> b = a \\<plusminus> b", "apply (frule rHom_add[of \"ridmap S\" S R a b], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; Ring S;\n     carrier S \\<subseteq> carrier R; ridmap S \\<in> rHom S R;\n     ridmap S (a \\<plusminus>\\<^bsub>S\\<^esub> b) =\n     ridmap S a \\<plusminus> ridmap S b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus>\\<^bsub>S\\<^esub> b = a \\<plusminus> b", "apply (cut_tac Ring.ring_is_ag[of S],\n       frule aGroup.ag_pOp_closed[of S a b], assumption+,\n       simp add:ridmap_def, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Subring_tOp_ring_tOp:\"\\<lbrakk>Subring R S; a \\<in> carrier S;\n              b \\<in> carrier S \\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b = a \\<cdot>\\<^sub>r b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; a \\<in> carrier S; b \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b =\n                      a \\<cdot>\\<^sub>r b", "apply (simp add:Subring_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; Ring S;\n     carrier S \\<subseteq> carrier R; ridmap S \\<in> rHom S R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b =\n                      a \\<cdot>\\<^sub>r b", "apply (frule rHom_tOp[of \"S\" \"R\" \"a\" \"b\" \"ridmap S\"], rule Ring_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; b \\<in> carrier S; Ring S;\n     carrier S \\<subseteq> carrier R; ridmap S \\<in> rHom S R;\n     ridmap S (a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b) =\n     ridmap S a \\<cdot>\\<^sub>r ridmap S b\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> b =\n                      a \\<cdot>\\<^sub>r b", "apply (frule Ring.ring_tOp_closed[of \"S\" \"a\" \"b\"], assumption+,\n       simp add:ridmap_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Subring_one_ring_one:\"Subring R S \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r", "apply (simp add:Subring_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring S; carrier S \\<subseteq> carrier R;\n     ridmap S \\<in> rHom S R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r", "apply (frule rHom_one[of \"S\" \"R\" \"ridmap S\"], rule Ring_axioms, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring S; carrier S \\<subseteq> carrier R;\n     ridmap S \\<in> rHom S R;\n     ridmap S 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r", "apply (simp add:ridmap_def, simp add:Ring.ring_one[of S])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Subring_zero_ring_zero:\"Subring R S \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> = \\<zero>", "apply (simp add:Subring_def, (erule conjE)+,\n       frule rHom_0_0[of \"S\" \"R\" \"ridmap S\"], rule Ring_axioms, assumption+,\n       simp add:ridmap_def, simp add:Ring.ring_zero[of \"S\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Subring_minus_ring_minus:\"\\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk>\n      \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x", "apply (simp add:Subring_def, (erule conjE)+, simp add:rHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier S; Ring S; carrier S \\<subseteq> carrier R;\n     ridmap S \\<in> aHom S R;\n     \\<forall>x\\<in>carrier S.\n        \\<forall>y\\<in>carrier S.\n           ridmap S (x \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> y) =\n           ridmap S x \\<cdot>\\<^sub>r ridmap S y;\n     ridmap S 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x", "apply (cut_tac ring_is_ag, frule Ring.ring_is_ag[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier S; Ring S; carrier S \\<subseteq> carrier R;\n     ridmap S \\<in> aHom S R;\n     \\<forall>x\\<in>carrier S.\n        \\<forall>y\\<in>carrier S.\n           ridmap S (x \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> y) =\n           ridmap S x \\<cdot>\\<^sub>r ridmap S y;\n     ridmap S 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r; aGroup R;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x", "apply (frule aHom_inv_inv[of \"S\" \"R\" \"ridmap S\" \"x\"], assumption+,\n       frule aGroup.ag_mOp_closed[of \"S\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier S; Ring S; carrier S \\<subseteq> carrier R;\n     ridmap S \\<in> aHom S R;\n     \\<forall>x\\<in>carrier S.\n        \\<forall>y\\<in>carrier S.\n           ridmap S (x \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> y) =\n           ridmap S x \\<cdot>\\<^sub>r ridmap S y;\n     ridmap S 1\\<^sub>r\\<^bsub>S\\<^esub> = 1\\<^sub>r; aGroup R; aGroup S;\n     ridmap S (-\\<^sub>a\\<^bsub>S\\<^esub> x) = -\\<^sub>a ridmap S x;\n     -\\<^sub>a\\<^bsub>S\\<^esub> x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> x = -\\<^sub>a x", "apply (simp add:ridmap_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) Subring_pow_ring_pow:\"x \\<in> carrier S \\<Longrightarrow>\n                   x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier S \\<Longrightarrow>\n    x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier S; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier S; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>S 0\\<^esup> = x^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier S; Subring R S; Ring S;\n        x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>S Suc n\\<^esup> =\n                         x^\\<^bsup>R Suc n\\<^esup>", "apply (simp, simp add:Subring_one_ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier S; Subring R S; Ring S;\n        x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>S Suc n\\<^esup> =\n                         x^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac n = n in Ring.npClose[of S x], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier S; Subring R S; Ring S;\n        x^\\<^bsup>S n\\<^esup> = x^\\<^bsup>R n\\<^esup>;\n        x^\\<^bsup>S n\\<^esup> \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>S Suc n\\<^esup> =\n                         x^\\<^bsup>R Suc n\\<^esup>", "apply (simp add:Subring_tOp_ring_tOp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) is_Ring: \"Ring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring R", ".."], ["", "lemma (in PolynRg) polyn_ring_nonzero:\"1\\<^sub>r \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r \\<noteq> \\<zero>", "apply (cut_tac Ring, cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; Subring R S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>", "apply (simp add:Subring_zero_ring_zero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; Subring R S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:Subring_one_ring_one[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; Subring R S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:not_zeroring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_ring_S_nonzero:\"1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow>\n    1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>", "apply (simp add:Subring_one_ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Subring R S \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>", "apply (simp add:polyn_ring_nonzero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_ring_X_nonzero:\"X \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X \\<noteq> \\<zero>", "apply (cut_tac algfree,\n       cut_tac subring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>algfree_cond R S X; Subring R S\\<rbrakk>\n    \\<Longrightarrow> X \\<noteq> \\<zero>", "apply (simp add:algfree_cond_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>a b.\n                pol_coeff S (a, b) \\<and>\n                (\\<forall>k\\<le>a.\n                    \\<Sigma>\\<^sub>e R (\\<lambda>j.\n     b j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) k =\n                    \\<zero> \\<longrightarrow>\n                    (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>));\n     Subring R S\\<rbrakk>\n    \\<Longrightarrow> X \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>a b.\n                pol_coeff S (a, b) \\<and>\n                (\\<forall>k\\<le>a.\n                    \\<Sigma>\\<^sub>e R (\\<lambda>j.\n     b j \\<cdot>\\<^sub>r \\<zero>^\\<^bsup>R j\\<^esup>) k =\n                    \\<zero> \\<longrightarrow>\n                    (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>));\n     Subring R S; X = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (drule_tac x = \"Suc 0\" in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> False", "apply (subgoal_tac \"pol_coeff S ((Suc 0), \n          (\\<lambda>j\\<in>{l. l \\<le> (Suc 0)}. if j = 0 then \\<zero>\\<^bsub>S\\<^esub> else 1\\<^sub>r\\<^bsub>S\\<^esub>))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>));\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (drule_tac x = \"\\<lambda>j\\<in>{l. l \\<le> (Suc 0)}. if j = 0 then \\<zero>\\<^bsub>S\\<^esub> else 1\\<^sub>r\\<^bsub>S\\<^esub>\" in \n        spec)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>) \\<and>\n     (\\<forall>k\\<le>Suc 0.\n         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                (\\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                                    if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                                    else 1\\<^sub>r\\<^bsub>S\\<^esub>)\n                                 j \\<cdot>\\<^sub>r\n                                \\<zero>^\\<^bsup>R j\\<^esup>) k =\n         \\<zero> \\<longrightarrow>\n         (\\<forall>j\\<le>k.\n             (\\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                 if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                 else 1\\<^sub>r\\<^bsub>S\\<^esub>)\n              j =\n             \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (erule conjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     \\<forall>k\\<le>Suc 0.\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (if j \\<le> Suc 0\n                                then if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                                     else 1\\<^sub>r\\<^bsub>S\\<^esub>\n                                else undefined) \\<cdot>\\<^sub>r\n                               \\<zero>^\\<^bsup>R j\\<^esup>) k =\n        \\<zero> \\<longrightarrow>\n        (\\<forall>j\\<le>k.\n            (if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n             else 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n            \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (simp only:Nset_1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{0, Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     \\<forall>k\\<le>Suc 0.\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (if j \\<le> Suc 0\n                                then if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                                     else 1\\<^sub>r\\<^bsub>S\\<^esub>\n                                else undefined) \\<cdot>\\<^sub>r\n                               \\<zero>^\\<^bsup>R j\\<^esup>) k =\n        \\<zero> \\<longrightarrow>\n        (\\<forall>j\\<le>k.\n            (if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n             else 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n            \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (drule_tac a = \"Suc 0\" in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{0, Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                            (if j \\<le> Suc 0\n                             then if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                                  else 1\\<^sub>r\\<^bsub>S\\<^esub>\n                             else undefined) \\<cdot>\\<^sub>r\n                            \\<zero>^\\<^bsup>R j\\<^esup>) Suc 0 =\n     \\<zero> \\<longrightarrow>\n     (\\<forall>j\\<le>Suc 0.\n         (if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{0, Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     \\<zero>\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r 1\\<^sub>r \\<plusminus>\n     1\\<^sub>r\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\n     (1\\<^sub>r \\<cdot>\\<^sub>r \\<zero>) =\n     \\<zero> \\<longrightarrow>\n     (\\<forall>j\\<le>Suc 0.\n         (if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>) =\n         \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (cut_tac subring, simp add:Subring_zero_ring_zero,\n        simp add:Subring_one_ring_one, cut_tac ring_zero, cut_tac ring_one,\n        simp add:ring_r_one, simp add:ring_times_x_0, cut_tac ring_is_ag,\n          simp add:aGroup.ag_r_zero,\n        drule_tac a = \"Suc 0\" in forall_spec, simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>X = \\<zero>;\n     pol_coeff S\n      (Suc 0,\n       \\<lambda>j\\<in>{0, Suc 0}.\n          if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n          else 1\\<^sub>r\\<^bsub>S\\<^esub>);\n     Subring R S; \\<zero> \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     aGroup R; 1\\<^sub>r\\<^bsub>S\\<^esub> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (cut_tac polyn_ring_S_nonzero, simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; X = \\<zero>;\n     \\<forall>b.\n        pol_coeff S (Suc 0, b) \\<and>\n        (\\<forall>k\\<le>Suc 0.\n            \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                   b j \\<cdot>\\<^sub>r\n                                   \\<zero>^\\<^bsup>R j\\<^esup>) k =\n            \\<zero> \\<longrightarrow>\n            (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (Suc 0,\n                        \\<lambda>j\\<in>{l. l \\<le> Suc 0}.\n                           if j = 0 then \\<zero>\\<^bsub>S\\<^esub>\n                           else 1\\<^sub>r\\<^bsub>S\\<^esub>)", "apply (thin_tac \"\\<forall>b. pol_coeff S (Suc 0, b) \\<and>\n         (\\<forall>k\\<le>Suc 0. \\<Sigma>\\<^sub>e R (\\<lambda>j. b j \\<cdot>\\<^sub>r \\<zero>^\\<^bsup>R j\\<^esup>) k = \\<zero> \\<longrightarrow> (\\<forall>j\\<le>k. b j = \\<zero>\\<^bsub>S\\<^esub>))\",\n        simp add:pol_coeff_def,\n        rule allI,\n        simp add:Subring_def, simp add:Ring.ring_zero,\n        (rule impI)+,\n        simp add:Ring.ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Coefficients of a polynomial\""], ["", "lemma (in PolynRg) pol_coeff_split:\"pol_coeff S f = pol_coeff S (fst f, snd f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S f = pol_coeff S (fst f, snd f)", "by simp"], ["", "lemma (in PolynRg) pol_coeff_cartesian:\"pol_coeff S c \\<Longrightarrow>\n                   (fst c, snd c) = c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> (fst c, snd c) = c", "by simp"], ["", "lemma (in PolynRg) split_pol_coeff:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n                                               pol_coeff S (k, snd c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (k, snd c)", "by (simp add:pol_coeff_def)"], ["", "lemma (in PolynRg) pol_coeff_pre:\"pol_coeff S ((Suc n), f) \\<Longrightarrow> \n                   pol_coeff S (n, f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (Suc n, f) \\<Longrightarrow> pol_coeff S (n, f)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_coeff_le:\"\\<lbrakk>pol_coeff S c; n \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n                               pol_coeff S (n, (snd c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, snd c)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_coeff_mem:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n                                                   ((snd c) j) \\<in> carrier S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; j \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> snd c j \\<in> carrier S", "by (simp add:pol_coeff_def)"], ["", "lemma (in PolynRg) pol_coeff_mem_R:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c)\\<rbrakk>\n                  \\<Longrightarrow>  ((snd c) j) \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; j \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> snd c j \\<in> carrier R", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; j \\<le> fst c; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> snd c j \\<in> carrier R", "apply (frule pol_coeff_mem[of c \"j\"], assumption+,\n       simp add:mem_subring_mem_ring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) Slide_pol_coeff:\"\\<lbrakk>pol_coeff S c; n < (fst c)\\<rbrakk> \\<Longrightarrow>\n        pol_coeff S (((fst c) - Suc n), (\\<lambda>x. (snd c) (Suc (n + x))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (fst c - Suc n, \\<lambda>x. snd c (Suc (n + x)))", "apply (simp add: pol_coeff_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \\<open>Addition of \\<open>polyn_exprs\\<close>\\<close>"], ["", "lemma (in PolynRg) monomial_mem:\"pol_coeff S c \\<Longrightarrow> \n                        \\<forall>j \\<le> (fst c). (snd c) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    \\<forall>j\\<le>fst c.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> \\<in> carrier R", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R", "apply (rule ring_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<in> carrier R", "apply (simp add:pol_coeff_mem_R[of c],\n       cut_tac X_mem_R, simp add:npClose)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_mem:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n                                        polyn_expr R X k c \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c \\<in> carrier R", "apply (simp add:polyn_expr_def,\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) k\n                      \\<in> carrier R", "apply (rule aGroup.nsum_mem[of R k \"\\<lambda>j. (snd c) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R", "apply (simp add:monomial_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_exprs_eq:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n         k \\<le> (min (fst c) (fst d)); \\<forall>j \\<le> k. (snd c) j = (snd d) j\\<rbrakk> \\<Longrightarrow> \n                     polyn_expr R X k c = polyn_expr R X k d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; k \\<le> min (fst c) (fst d);\n     \\<forall>j\\<le>k. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k d", "apply (cut_tac ring_is_ag,\n       simp add:polyn_expr_def,\n       cut_tac subring,\n       cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     k \\<le> fst c \\<and> k \\<le> fst d;\n     \\<forall>j\\<le>k. snd c j = snd d j; aGroup R; Subring R S;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) k =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) k", "apply (rule aGroup.nsum_eq[of R k \"\\<lambda>j. (snd c) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"\n                                   \"\\<lambda>j. (snd d) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     k \\<le> fst c \\<and> k \\<le> fst d;\n     \\<forall>j\\<le>k. snd c j = snd d j; aGroup R; Subring R S;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     k \\<le> fst c \\<and> k \\<le> fst d;\n     \\<forall>j\\<le>k. snd c j = snd d j; aGroup R; Subring R S;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     k \\<le> fst c \\<and> k \\<le> fst d;\n     \\<forall>j\\<le>k. snd c j = snd d j; aGroup R; Subring R S;\n     X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>", "apply (simp add:monomial_mem)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_expr_restrict:\"pol_coeff S (Suc n, f) \\<Longrightarrow>\n              polyn_expr R X n (Suc n, f) = polyn_expr R X n (n, f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (Suc n, f) \\<Longrightarrow>\n    polyn_expr R X n (Suc n, f) = polyn_expr R X n (n, f)", "apply (cut_tac subring, frule subring_Ring,\n       cut_tac pol_coeff_le[of \"(Suc n, f)\" n])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S (Suc n, f); Subring R S; Ring S;\n     pol_coeff S (n, snd (Suc n, f))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (Suc n, f) = polyn_expr R X n (n, f)\n 2. \\<lbrakk>pol_coeff S (Suc n, f); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (Suc n, f)\n 3. \\<lbrakk>pol_coeff S (Suc n, f); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> n \\<le> fst (Suc n, f)", "apply (cut_tac polyn_exprs_eq[of \"(Suc n, f)\" \"(n, f)\" n],\n       (simp add:pol_coeff_split[THEN sym])+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_expr_short:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n         polyn_expr R X k c = polyn_expr R X k (k, snd c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = polyn_expr R X k (k, snd c)", "apply (rule polyn_exprs_eq[of c \"(k, snd c)\" k], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (k, snd c)\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> k \\<le> min (fst c) (fst (k, snd c))\n 3. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = snd (k, snd c) j", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> k \\<le> min (fst c) (fst (k, snd c))\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = snd (k, snd c) j", "apply (simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = snd (k, snd c) j", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_expr0:\"pol_coeff S c \\<Longrightarrow> \n                                   polyn_expr R X 0 c = (snd c) 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> polyn_expr R X 0 c = snd c 0", "apply (simp add:polyn_expr_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    snd c 0 \\<cdot>\\<^sub>r 1\\<^sub>r = snd c 0", "apply (cut_tac subring,\n       cut_tac subring_Ring[of S])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> snd c 0 \\<cdot>\\<^sub>r 1\\<^sub>r = snd c 0\n 2. \\<lbrakk>pol_coeff S c; Subring R S\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (frule pol_coeff_mem[of c 0], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; Subring R S; Ring S;\n     snd c 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> snd c 0 \\<cdot>\\<^sub>r 1\\<^sub>r = snd c 0\n 2. \\<lbrakk>pol_coeff S c; Subring R S\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (frule mem_subring_mem_ring [of S \"(snd c) 0\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; Subring R S; Ring S; snd c 0 \\<in> carrier S;\n     snd c 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> snd c 0 \\<cdot>\\<^sub>r 1\\<^sub>r = snd c 0\n 2. \\<lbrakk>pol_coeff S c; Subring R S\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (simp add:ring_r_one, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_expr_split:\"\n          polyn_expr R X k f = polyn_expr R X k (fst f, snd f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. polyn_expr R X k f = polyn_expr R X k (fst f, snd f)", "by simp"], ["", "lemma (in PolynRg) polyn_Suc:\"Suc n \\<le> (fst c) \\<Longrightarrow> \n       polyn_expr R X (Suc n) ((Suc n), (snd c)) = \n               polyn_expr R X n c \\<plusminus> ((snd c) (Suc n)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc n)\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc n \\<le> fst c \\<Longrightarrow>\n    polyn_expr R X (Suc n) (Suc n, snd c) =\n    polyn_expr R X n c \\<plusminus>\n    snd c (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>", "by (simp add:polyn_expr_def)"], ["", "lemma (in PolynRg) polyn_Suc_split:\"pol_coeff S (Suc n, f) \\<Longrightarrow> \n       polyn_expr R X (Suc n) ((Suc n), f) = \n          polyn_expr R X n (n, f) \\<plusminus> (f (Suc n)) \\<cdot>\\<^sub>r (X^\\<^bsup>R (Suc n)\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (Suc n, f) \\<Longrightarrow>\n    polyn_expr R X (Suc n) (Suc n, f) =\n    polyn_expr R X n (n, f) \\<plusminus>\n    f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac polyn_Suc[of n \"(Suc n, f)\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (Suc n, f);\n     polyn_expr R X (Suc n) (Suc n, snd (Suc n, f)) =\n     polyn_expr R X n (Suc n, f) \\<plusminus>\n     snd (Suc n, f) (Suc n) \\<cdot>\\<^sub>r\n     X^\\<^bsup>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (Suc n) (Suc n, f) =\n                      polyn_expr R X n (n, f) \\<plusminus>\n                      f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n 2. pol_coeff S (Suc n, f) \\<Longrightarrow> Suc n \\<le> fst (Suc n, f)", "apply (simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (Suc n, f);\n     polyn_expr R X (Suc n) (Suc n, f) =\n     polyn_expr R X n (Suc n, f) \\<plusminus>\n     f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                      f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> =\n                      polyn_expr R X n (n, f) \\<plusminus>\n                      f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n 2. pol_coeff S (Suc n, f) \\<Longrightarrow> Suc n \\<le> fst (Suc n, f)", "apply (subst polyn_expr_short[of \"(Suc n, f)\" n], assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (Suc n, f);\n     polyn_expr R X (Suc n) (Suc n, f) =\n     polyn_expr R X n (Suc n, f) \\<plusminus>\n     f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, snd (Suc n, f)) \\<plusminus>\n                      f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> =\n                      polyn_expr R X n (n, f) \\<plusminus>\n                      f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n 2. pol_coeff S (Suc n, f) \\<Longrightarrow> Suc n \\<le> fst (Suc n, f)", "apply (simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (Suc n, f) \\<Longrightarrow> Suc n \\<le> fst (Suc n, f)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_n_m:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X m (m, (snd c)) = polyn_expr R X n (n, (snd c)) \\<plusminus>  \n                        (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m (m, snd c) =\n                      polyn_expr R X n (n, snd c) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (simp add:polyn_expr_def, cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) m =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (rule aGroup.nsum_split1[of \"R\" m \"\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)\" n], \n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> n < m", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> n < m", "apply (frule_tac monomial_mem[of c],\n       frule_tac i = j and j = m and k = \"(fst c)\" in le_trans, assumption+,\n       simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_n_m1:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n      polyn_expr R X m c = polyn_expr R X n c \\<plusminus>  \n                        (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m c =\n                      polyn_expr R X n c \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (subst polyn_expr_short[of c n], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> n \\<le> fst c\n 2. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m c =\n                      polyn_expr R X n (n, snd c) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (frule_tac x = n and y = m and z = \"fst c\" in less_le_trans, assumption,\n        simp add:less_imp_le)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m c =\n                      polyn_expr R X n (n, snd c) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (subst polyn_expr_short[of c m], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m (m, snd c) =\n                      polyn_expr R X n (n, snd c) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (simp add:polyn_n_m)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_n_m_mem:\"\\<lbrakk>pol_coeff S c; n < m; m \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n            (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m) \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m\n                      \\<in> carrier R", "apply (simp add:fSum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R cmp\n    (\\<lambda>j. snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>)\n    (slide (Suc n)) (m - Suc n)\n                      \\<in> carrier R", "apply (cut_tac ring_is_ag,\n       rule_tac n = \"m - Suc n\" in aGroup.nsum_mem, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m - Suc n.\n                         cmp (\\<lambda>j.\n                                 snd c j \\<cdot>\\<^sub>r\n                                 X^\\<^bsup>R j\\<^esup>)\n                          (slide (Suc n)) j\n                         \\<in> carrier R", "apply (rule allI, rule impI,\n        simp del:npow_suc add:cmp_def slide_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> snd c (Suc (n + j)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup>\n                         \\<in> carrier R", "apply (rule ring_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> snd c (Suc (n + j)) \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R Suc (n + j)\\<^esup> \\<in> carrier R", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S; n < m;\n        m \\<le> fst c; aGroup R; j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> snd c (Suc (n + j)) \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R Suc (n + j)\\<^esup> \\<in> carrier R", "apply (frule_tac a = \"Suc (n + j)\" in forall_spec, arith)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S; n < m;\n        m \\<le> fst c; aGroup R; j \\<le> m - Suc n;\n        snd c (Suc (n + j)) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> snd c (Suc (n + j)) \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R Suc (n + j)\\<^esup> \\<in> carrier R", "apply (cut_tac subring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S; n < m;\n        m \\<le> fst c; aGroup R; j \\<le> m - Suc n;\n        snd c (Suc (n + j)) \\<in> carrier S; Subring R S\\<rbrakk>\n       \\<Longrightarrow> snd c (Suc (n + j)) \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R Suc (n + j)\\<^esup> \\<in> carrier R", "apply (simp add:mem_subring_mem_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R Suc (n + j)\\<^esup> \\<in> carrier R", "apply (rule npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; n < m; m \\<le> fst c; aGroup R;\n        j \\<le> m - Suc n\\<rbrakk>\n       \\<Longrightarrow> X \\<in> carrier R", "apply (cut_tac X_mem_R,\n        simp del:npow_suc add:npClose)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_n_ms_eq:\"\\<lbrakk>pol_coeff S c; pol_coeff S d;\n        m \\<le> min (fst c) (fst d); n < m; \n       \\<forall>j\\<in>nset (Suc n) m. (snd c) j = (snd d) j\\<rbrakk> \\<Longrightarrow> \n            (fSum R (\\<lambda>j. ((snd c) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m) =\n                    (fSum R (\\<lambda>j. ((snd d) j) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) (Suc n) m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m =\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m =\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc n m", "apply (cut_tac aGroup.fSum_eq1[of R \"Suc n\" m \"\\<lambda>j. (snd c) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"\n                                             \"\\<lambda>j. (snd d) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"],\n       assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> Suc n \\<le> m\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>", "apply (rule Suc_leI, assumption,\n          simp add:nset_def, simp add:monomial_mem)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>", "apply (frule Suc_leI,\n              rule ballI, simp add:nset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d;\n        m \\<le> fst c \\<and> m \\<le> fst d;\n        \\<forall>j.\n           Suc n \\<le> j \\<and> j \\<le> m \\<longrightarrow>\n           snd c j = snd d j;\n        aGroup R; Suc n \\<le> j \\<and> j \\<le> m\\<rbrakk>\n       \\<Longrightarrow> snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>", "apply (simp add:monomial_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; m \\<le> min (fst c) (fst d);\n     n < m; \\<forall>j\\<in>nset (Suc n) m. snd c j = snd d j;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) m.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_addTr:\n \"(pol_coeff S (n, f)) \\<and> (pol_coeff S (n, g)) \\<longrightarrow>\n    (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =\n                 nsum R (\\<lambda>j. ((f j) \\<plusminus>\\<^bsub>S\\<^esub> (g j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n    polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n    \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                           (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                            g j) \\<cdot>\\<^sub>r\n                           X^\\<^bsup>R j\\<^esup>) n", "apply (cut_tac subring,\n        frule subring_Ring[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, f) \\<and>\n                      pol_coeff S (n, g) \\<longrightarrow>\n                      polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X n (n, g) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, f) \\<and>\n                      pol_coeff S (0, g) \\<longrightarrow>\n                      polyn_expr R X 0 (0, f) \\<plusminus>\n                      polyn_expr R X 0 (0, g) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) 0\n 2. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (rule impI, simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X 0 (0, f) \\<plusminus>\n                      polyn_expr R X 0 (0, g) =\n                      (f 0 \\<plusminus>\\<^bsub>S\\<^esub>\n                       g 0) \\<cdot>\\<^sub>r\n                      1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (simp add:polyn_expr0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<plusminus> g 0 =\n                      (f 0 \\<plusminus>\\<^bsub>S\\<^esub>\n                       g 0) \\<cdot>\\<^sub>r\n                      1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (cut_tac pol_coeff_mem[of \"(0, f)\" 0], simp,\n        cut_tac pol_coeff_mem[of \"(0, g)\" 0], simp,\n       frule  mem_subring_mem_ring[of S \"f 0\"], assumption+,\n       frule  mem_subring_mem_ring[of S \"g 0\"], assumption+,\n       frule Ring.ring_is_ag[of S],\n       frule aGroup.ag_pOp_closed[of S \"f 0\" \"g 0\"], assumption+,\n       frule mem_subring_mem_ring[of S \"f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0\"], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S; g 0 \\<in> carrier S; f 0 \\<in> carrier R;\n     g 0 \\<in> carrier R; aGroup S;\n     f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0 \\<in> carrier S;\n     f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<plusminus> g 0 =\n                      (f 0 \\<plusminus>\\<^bsub>S\\<^esub>\n                       g 0) \\<cdot>\\<^sub>r\n                      1\\<^sub>r\n 2. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, g)\n 3. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, g)\n 4. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, f)\n 5. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, f)\n 6. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (simp add:ring_r_one)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S; g 0 \\<in> carrier S; f 0 \\<in> carrier R;\n     g 0 \\<in> carrier R; aGroup S;\n     f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0 \\<in> carrier S;\n     f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<plusminus> g 0 =\n                      f 0 \\<plusminus>\\<^bsub>S\\<^esub> g 0\n 2. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, g)\n 3. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, g)\n 4. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, f)\n 5. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, f)\n 6. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (simp add:Subring_pOp_ring_pOp[of S \"f 0\" \"g 0\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, g)\n 2. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f); pol_coeff S (0, g);\n     f 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, g)\n 3. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, f)\n 4. \\<lbrakk>Subring R S; Ring S; pol_coeff S (0, f);\n     pol_coeff S (0, g)\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> fst (0, f)\n 5. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc n", "apply (simp del:npow_suc)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<and>\n                         pol_coeff S (Suc n, g) \\<longrightarrow>\n                         polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        pol_coeff S (n, f) \\<and> pol_coeff S (n, g) \\<longrightarrow>\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac n = n in  pol_coeff_pre[of _ f],\n        frule_tac n = n in  pol_coeff_pre[of _ g], simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc n) (Suc n, f) \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac n = n and c = \"(Suc n, f)\" in polyn_Suc, simp del:npow_suc,\n        simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, f) =\n         polyn_expr R X n (Suc n, f) \\<plusminus> f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                         polyn_expr R X (Suc n) (Suc n, g) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac n = n and c = \"(Suc n, g)\" in polyn_Suc, simp del:npow_suc,\n        simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, g) =\n         polyn_expr R X n (Suc n, g) \\<plusminus> g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                         (polyn_expr R X n (Suc n, g) \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac c = \"(Suc n, f)\" and k = n in polyn_mem, assumption, \n                simp del:npow_suc,\n        cut_tac k = n and c = \"(Suc n, g)\" in polyn_mem, assumption, \n                simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        polyn_expr R X n (Suc n, g) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                         (polyn_expr R X n (Suc n, g) \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac j = \"Suc n\" and c = \"(Suc n, f)\" in pol_coeff_mem_R, simp,\n        frule_tac j = \"Suc n\" and c = \"(Suc n, g)\" in pol_coeff_mem_R, simp,\n        cut_tac  X_mem_R,\n        frule_tac n = \"Suc n\" in npClose[of \"X\"], simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        polyn_expr R X n (Suc n, g) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R; g (Suc n) \\<in> carrier R;\n        X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                         (polyn_expr R X n (Suc n, g) \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac x = \"f (Suc n)\" and y = \"X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_closed,\n         assumption+,\n        frule_tac x = \"g (Suc n)\" and y = \"X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_closed,\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        polyn_expr R X n (Suc n, g) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R; g (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                         (polyn_expr R X n (Suc n, g) \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac ring_is_ag, \n        subst aGroup.pOp_assocTr43, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        polyn_expr R X n (Suc n, g) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R; g (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         (f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                          polyn_expr R X n (Suc n, g)) \\<plusminus>\n                         g (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac x = \"f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\" and \n        y = \"polyn_expr R X n (Suc n, g)\" in aGroup.ag_pOp_commute[of R],\n        assumption+, simp del:npow_suc,\n        thin_tac \"f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup> \\<plusminus> polyn_expr R X n (Suc n, g) =\n         polyn_expr R X n (Suc n, g) \\<plusminus> f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        polyn_expr R X n (Suc n, g) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R; g (Suc n) \\<in> carrier R;\n        X \\<in> carrier R; X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (Suc n, f) \\<plusminus>\n                         (polyn_expr R X n (Suc n, g) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) \\<plusminus>\n                         g (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (subst  aGroup.pOp_assocTr43[THEN sym], assumption+,\n        simp del:npow_suc add:polyn_expr_restrict)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X n (n, g) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem, simp,\n        frule_tac c = \"(Suc n, g)\" and j = \"Suc n\" in pol_coeff_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X n (n, g) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R; snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup> \\<plusminus>\n                          g (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (subst ring_distrib2[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X n (n, g) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R; snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus> g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in  pol_coeff_mem, simp,\n       frule_tac c = \"(Suc n, g)\" and j = \"Suc n\" in  pol_coeff_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X n (n, g) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R; snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S;\n        snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus> g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac a = \"f (Suc n)\" and b = \"g (Suc n)\" in \n                      Subring_pOp_ring_pOp[of S], simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Subring R S; Ring S;\n        polyn_expr R X n (n, f) \\<plusminus> polyn_expr R X n (n, g) =\n        \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                               (f j \\<plusminus>\\<^bsub>S\\<^esub>\n                                g j) \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) n;\n        pol_coeff S (Suc n, f); pol_coeff S (Suc n, g); pol_coeff S (n, f);\n        pol_coeff S (n, g); polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X n (n, g) \\<in> carrier R; f (Suc n) \\<in> carrier R;\n        g (Suc n) \\<in> carrier R; X \\<in> carrier R;\n        X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        g (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        aGroup R; snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S;\n        snd (Suc n, f) (Suc n) \\<in> carrier S;\n        snd (Suc n, g) (Suc n) \\<in> carrier S;\n        f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub> g (Suc n) =\n        f (Suc n) \\<plusminus> g (Suc n)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus> g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) n \\<plusminus>\n                         (f (Suc n) \\<plusminus>\\<^bsub>S\\<^esub>\n                          g (Suc n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_add_n:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk> \\<Longrightarrow> \n      (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =  \n           nsum R (\\<lambda>j. ((f j) \\<plusminus>\\<^bsub>S\\<^esub> (g j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X n (n, g) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) n", "by (simp add:polyn_addTr)"], ["", "definition\n  add_cf :: \"[('a, 'm) Ring_scheme, nat \\<times> (nat \\<Rightarrow> 'a), nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow>\n                     nat \\<times> (nat \\<Rightarrow> 'a)\" where\n  \"add_cf S c d =\n    (if (fst c) < (fst d) then ((fst d),  \\<lambda>j. (if j \\<le> (fst c)\n                                               then (((snd c) j) \\<plusminus>\\<^bsub>S\\<^esub> ((snd d) j)) else ((snd d) j)))\n     else if (fst c) = (fst d) then ((fst c), \\<lambda>j. ((snd c) j \\<plusminus>\\<^bsub>S\\<^esub> (snd d) j))\n     else ((fst c), \\<lambda>j. (if j \\<le> (fst d) then \n                        ((snd c) j \\<plusminus>\\<^bsub>S\\<^esub> (snd d) j) else ((snd c) j))))\""], ["", "lemma (in PolynRg) add_cf_pol_coeff:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n      \\<Longrightarrow>  pol_coeff S (add_cf S c d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c d)", "apply (cut_tac subring,\n       frule subring_Ring[of S], frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c d)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n     \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst (add_cf S c d).\n                         snd (add_cf S c d) j \\<in> carrier S", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d)\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (case_tac \"(fst c) < (fst d)\", simp add:add_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst d; fst c < fst d\\<rbrakk>\n       \\<Longrightarrow> j \\<le> fst c \\<longrightarrow>\n                         snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j\n                         \\<in> carrier S\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); \\<not> fst c < fst d\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (rule impI, rule aGroup.ag_pOp_closed, assumption+, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); \\<not> fst c < fst d\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (drule leI[of \"fst c\" \"fst d\"],\n              drule le_imp_less_or_eq[of \"fst d\" \"fst c\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d);\n        fst d < fst c \\<or> fst d = fst c\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); fst d < fst c\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); fst d = fst c\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (simp add:add_cf_def, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst c; fst d < fst c; j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j\n                         \\<in> carrier S\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); fst d = fst c\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (frule Ring.ring_is_ag[of S], rule aGroup.ag_pOp_closed, assumption,\n       simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst c. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst (add_cf S c d); fst d = fst c\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S c d) j \\<in> carrier S", "apply (simp add:add_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        \\<forall>j\\<le>fst c. snd d j \\<in> carrier S; Subring R S; Ring S;\n        aGroup S; j \\<le> fst c; fst d = fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j\n                         \\<in> carrier S", "apply (frule Ring.ring_is_ag[of S], rule aGroup.ag_pOp_closed, assumption,\n       simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) add_cf_len:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n      \\<Longrightarrow> fst (add_cf S c d) = (max (fst c) (fst d))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c d) = max (fst c) (fst d)", "by (simp add: add_cf_def max.absorb1 max.absorb2)"], ["", "lemma (in PolynRg) polyn_expr_restrict1:\"\\<lbrakk>pol_coeff S (n, f);\n    pol_coeff S (Suc (m + n), g)\\<rbrakk> \\<Longrightarrow> \n    polyn_expr R X (m + n) (add_cf S (n, f) (m + n, g)) = \n    polyn_expr R X (m + n) (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (m + n) (add_cf S (n, f) (m + n, g)) =\n                      polyn_expr R X (m + n)\n                       (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))", "apply (frule pol_coeff_pre[of \"m+n\" g])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (m + n) (add_cf S (n, f) (m + n, g)) =\n                      polyn_expr R X (m + n)\n                       (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))", "apply (frule add_cf_pol_coeff[of \"(n, f)\" \"(Suc (m + n), g)\"], assumption+,\n       frule add_cf_pol_coeff[of \"(n, f)\" \"(m + n, g)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (m + n) (add_cf S (n, f) (m + n, g)) =\n                      polyn_expr R X (m + n)\n                       (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))", "apply (rule polyn_exprs_eq[of \"add_cf S (n, f) (m + n, g)\" \n       \"(m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\" \"m + n\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S\n                       (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\n 2. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> m + n\n                      \\<le> min (fst (add_cf S (n, f) (m + n, g)))\n                             (fst (m + n,\n                                   snd (add_cf S (n, f) (Suc (m + n), g))))\n 3. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m + n.\n                         snd (add_cf S (n, f) (m + n, g)) j =\n                         snd (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\n                          j", "apply (rule split_pol_coeff[of \"add_cf S (n, f) (Suc (m + n), g)\" \"m + n\"],\n         assumption, simp add:add_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> m + n\n                      \\<le> min (fst (add_cf S (n, f) (m + n, g)))\n                             (fst (m + n,\n                                   snd (add_cf S (n, f) (Suc (m + n), g))))\n 2. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m + n.\n                         snd (add_cf S (n, f) (m + n, g)) j =\n                         snd (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\n                          j", "apply (simp add:add_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n     pol_coeff S (m + n, g); pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n     pol_coeff S (add_cf S (n, f) (m + n, g))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>m + n.\n                         snd (add_cf S (n, f) (m + n, g)) j =\n                         snd (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\n                          j", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S (n, f); pol_coeff S (Suc (m + n), g);\n        pol_coeff S (m + n, g);\n        pol_coeff S (add_cf S (n, f) (Suc (m + n), g));\n        pol_coeff S (add_cf S (n, f) (m + n, g)); j \\<le> m + n\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (n, f) (m + n, g)) j =\n                         snd (m + n, snd (add_cf S (n, f) (Suc (m + n), g)))\n                          j", "apply (simp add:add_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_add_n1:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk> \\<Longrightarrow> \n      (polyn_expr R X n (n, f)) \\<plusminus> (polyn_expr R X n (n, g)) =  \n                                polyn_expr R X n (add_cf S (n, f) (n, g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X n (n, g) =\n                      polyn_expr R X n (add_cf S (n, f) (n, g))", "apply (subst polyn_add_n, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (n, g)\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (f j \\<plusminus>\\<^bsub>S\\<^esub> g j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) n =\n                      polyn_expr R X n (add_cf S (n, f) (n, g))", "apply (simp add:polyn_expr_def add_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) add_cf_val_hi:\"(fst c) < (fst d) \\<Longrightarrow>\n                       snd (add_cf S c d) (fst d) = (snd d) (fst d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fst c < fst d \\<Longrightarrow>\n    snd (add_cf S c d) (fst d) = snd d (fst d)", "by (simp add:add_cf_def)"], ["", "lemma (in PolynRg) add_cf_commute:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n  \\<Longrightarrow> \\<forall>j \\<le> (max (fst c) (fst d)). snd (add_cf S c d) j = \n                           snd (add_cf S d c) j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>max (fst c) (fst d).\n                         snd (add_cf S c d) j = snd (add_cf S d c) j", "apply (cut_tac subring, frule subring_Ring,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>max (fst c) (fst d).\n                         snd (add_cf S c d) j = snd (add_cf S d c) j", "apply (simp add: add_cf_def max.absorb1 max.absorb2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S;\n     aGroup S\\<rbrakk>\n    \\<Longrightarrow> (fst d = fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst c.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd c j)) \\<and>\n                      (fst d \\<noteq> fst c \\<longrightarrow>\n                       (fst d < fst c \\<longrightarrow>\n                        (\\<forall>j\\<le>fst d.\n                            snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                            snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                            snd c j)) \\<and>\n                       (\\<not> fst d < fst c \\<longrightarrow>\n                        (\\<forall>j\\<le>fst c.\n                            snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                            snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j)))", "apply (case_tac \"(fst c) = (fst d)\", simp add: pol_coeff_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>fst d. snd c j \\<in> carrier S;\n     \\<forall>j\\<le>fst d. snd d j \\<in> carrier S; Subring R S; Ring S;\n     aGroup S; fst c = fst d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst d.\n                         snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                         snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> (fst d = fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst c.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd c j)) \\<and>\n                      (fst d \\<noteq> fst c \\<longrightarrow>\n                       (fst d < fst c \\<longrightarrow>\n                        (\\<forall>j\\<le>fst d.\n                            snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                            snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                            snd c j)) \\<and>\n                       (\\<not> fst d < fst c \\<longrightarrow>\n                        (\\<forall>j\\<le>fst c.\n                            snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                            snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j)))", "apply (rule allI, rule impI,\n        rule aGroup.ag_pOp_commute[of S], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> (fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst d.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd c j)) \\<and>\n                      (\\<not> fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst c.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j))", "apply (case_tac \"(fst d) < (fst c)\", simp,\n       rule allI, rule impI,\n       rule aGroup.ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n        fst d < fst c; j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<in> carrier S\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n        fst d < fst c; j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd d j \\<in> carrier S\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n     fst c \\<noteq> fst d; \\<not> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> (fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst d.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd c j)) \\<and>\n                      (\\<not> fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst c.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j))", "apply (frule_tac x = j and y = \"fst d\" and z = \"fst c\" in le_less_trans, \n          assumption+, frule_tac x = j and y = \"fst c\" in less_imp_le,\n          thin_tac \"j < fst c\", simp add:pol_coeff_mem, simp add:pol_coeff_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n     fst c \\<noteq> fst d; \\<not> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> (fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst d.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd c j)) \\<and>\n                      (\\<not> fst d < fst c \\<longrightarrow>\n                       (\\<forall>j\\<le>fst c.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                           snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n     fst c \\<noteq> fst d; \\<not> fst d < fst c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c.\n                         snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                         snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j", "apply (frule leI[of \"fst d\" \"fst c\"],\n       frule noteq_le_less[of \"fst c\" \"fst d\"], assumption,\n       rule allI, rule impI,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; Subring R S; Ring S; aGroup S;\n        fst c < fst d; j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd d j =\n                         snd d j \\<plusminus>\\<^bsub>S\\<^esub> snd c j", "apply (rule aGroup.ag_pOp_commute, assumption+,\n       simp add:pol_coeff_mem,\n       frule_tac x = j and y = \"fst c\" and z = \"fst d\" in le_less_trans, \n          assumption+, frule_tac x = j and y = \"fst d\" in less_imp_le,\n           thin_tac \"j < fst d\", simp add:pol_coeff_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_addTr1:\"pol_coeff S (n, f) \\<Longrightarrow>\n  \\<forall>g. pol_coeff S (n + m, g) \\<longrightarrow> \n        (polyn_expr R X n (n, f) \\<plusminus> (polyn_expr R X (n + m) ((n + m), g))\n                   = polyn_expr R X (n + m) (add_cf S (n, f) ((n + m), g)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (n, f) \\<Longrightarrow>\n    \\<forall>g.\n       pol_coeff S (n + m, g) \\<longrightarrow>\n       polyn_expr R X n (n, f) \\<plusminus>\n       polyn_expr R X (n + m) (n + m, g) =\n       polyn_expr R X (n + m) (add_cf S (n, f) (n + m, g))", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (n + m, g) \\<longrightarrow>\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (n + m) (n + m, g) =\n                         polyn_expr R X (n + m) (add_cf S (n, f) (n + m, g))", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (n + 0, g) \\<longrightarrow>\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (n + 0) (n + 0, g) =\n                         polyn_expr R X (n + 0) (add_cf S (n, f) (n + 0, g))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (n + na, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (n + na) (n + na, g) =\n           polyn_expr R X (n + na) (add_cf S (n, f) (n + na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (n + Suc na, g) \\<longrightarrow>\n                            polyn_expr R X n (n, f) \\<plusminus>\n                            polyn_expr R X (n + Suc na) (n + Suc na, g) =\n                            polyn_expr R X (n + Suc na)\n                             (add_cf S (n, f) (n + Suc na, g))", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X n (n, g) =\n                         polyn_expr R X n (add_cf S (n, f) (n, g))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (n + na, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (n + na) (n + na, g) =\n           polyn_expr R X (n + na) (add_cf S (n, f) (n + na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (n + Suc na, g) \\<longrightarrow>\n                            polyn_expr R X n (n, f) \\<plusminus>\n                            polyn_expr R X (n + Suc na) (n + Suc na, g) =\n                            polyn_expr R X (n + Suc na)\n                             (add_cf S (n, f) (n + Suc na, g))", "apply (simp add:polyn_add_n1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (n + na, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (n + na) (n + na, g) =\n           polyn_expr R X (n + na) (add_cf S (n, f) (n + na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (n + Suc na, g) \\<longrightarrow>\n                            polyn_expr R X n (n, f) \\<plusminus>\n                            polyn_expr R X (n + Suc na) (n + Suc na, g) =\n                            polyn_expr R X (n + Suc na)\n                             (add_cf S (n, f) (n + Suc na, g))", "apply (simp add:add.commute[of n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (na + n, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (na + n) (na + n, g) =\n           polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc (na + n), g) \\<longrightarrow>\n                            polyn_expr R X n (n, f) \\<plusminus>\n                            polyn_expr R X (Suc (na + n))\n                             (Suc (na + n), g) =\n                            polyn_expr R X (Suc (na + n))\n                             (add_cf S (n, f) (Suc (na + n), g))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (na + n, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (na + n) (na + n, g) =\n           polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        pol_coeff S (Suc (na + n), g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (Suc (na + n)) (Suc (na + n), g) =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (frule_tac n = \"na + n\" and f = g in pol_coeff_pre)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        \\<forall>g.\n           pol_coeff S (na + n, g) \\<longrightarrow>\n           polyn_expr R X n (n, f) \\<plusminus>\n           polyn_expr R X (na + n) (na + n, g) =\n           polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (Suc (na + n)) (Suc (na + n), g) =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (drule_tac a = g in forall_spec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (Suc (na + n)) (Suc (na + n), g) =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (cut_tac n = \"na + n\" and c = \"(Suc (na + n), g)\" in  polyn_Suc,\n         simp, simp del:npow_suc,\n         thin_tac \"polyn_expr R X (Suc (na + n)) (Suc (na + n), g) =\n        polyn_expr R X (na + n) (Suc (na + n), g) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc (na + n))\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         (polyn_expr R X (na + n)\n                           (Suc (na + n), g) \\<plusminus>\n                          g (Suc (na + n)) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc (na + n)\\<^esup>) =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (frule_tac c = \"(n, f)\" and k = n in polyn_mem, simp,\n         frule_tac c = \"(Suc (na + n), g)\" and k = \"na + n\" in polyn_mem, simp,\n         frule_tac c = \"(Suc (na + n), g)\" in monomial_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (Suc (na + n), g) \\<in> carrier R;\n        \\<forall>j\\<le>fst (Suc (na + n), g).\n           snd (Suc (na + n), g) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n           \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         (polyn_expr R X (na + n)\n                           (Suc (na + n), g) \\<plusminus>\n                          g (Suc (na + n)) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc (na + n)\\<^esup>) =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (drule_tac a = \"Suc (na + n)\" in forall_spec, simp del:npow_suc,\n         cut_tac ring_is_ag, \n         subst aGroup.ag_pOp_assoc[THEN sym], assumption+, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (Suc (na + n), g) \\<in> carrier R;\n        snd (Suc (na + n), g) (Suc (na + n)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                         polyn_expr R X (na + n)\n                          (Suc (na + n), g) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (simp del:npow_suc add:polyn_expr_restrict)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (frule_tac c = \"(n, f)\" and d = \"(Suc (na + n), g)\" in \n         add_cf_pol_coeff, assumption+,\n         frule_tac c = \"(n, f)\" and d = \"(na + n, g)\" in \n         add_cf_pol_coeff, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (frule_tac c = \"add_cf S (n, f) (Suc (na + n), g)\" and \n           n = \"na + n\" and m = \"Suc (na + n)\" in polyn_n_m, simp,\n         subst add_cf_len, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        polyn_expr R X (Suc (na + n))\n         (Suc (na + n), snd (add_cf S (n, f) (Suc (na + n), g))) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n        \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                               snd (add_cf S (n, f) (Suc (na + n), g))\n                                j \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) Suc\n                 (na + n) Suc (na + n)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (cut_tac k = \"Suc (na + n)\" and f = \"add_cf S (n, f) (Suc (na + n), g)\"\n          in polyn_expr_split)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        polyn_expr R X (Suc (na + n))\n         (Suc (na + n), snd (add_cf S (n, f) (Suc (na + n), g))) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n        \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                               snd (add_cf S (n, f) (Suc (na + n), g))\n                                j \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) Suc\n                 (na + n) Suc (na + n);\n        polyn_expr R X (Suc (na + n)) (add_cf S (n, f) (Suc (na + n), g)) =\n        polyn_expr R X (Suc (na + n))\n         (fst (add_cf S (n, f) (Suc (na + n), g)),\n          snd (add_cf S (n, f) (Suc (na + n), g)))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (Suc (na + n))\n                          (add_cf S (n, f) (Suc (na + n), g))", "apply (frule_tac c = \"(n, f)\" and d = \"(Suc (na + n), g)\" in \n          add_cf_len, assumption+, simp del: npow_suc add: max.absorb1 max.absorb2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        polyn_expr R X (Suc (na + n))\n         (Suc (na + n), snd (add_cf S (n, f) (Suc (na + n), g))) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n        \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                               snd (add_cf S (n, f) (Suc (na + n), g))\n                                j \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) Suc\n                 (na + n) Suc (na + n);\n        polyn_expr R X (Suc (na + n)) (add_cf S (n, f) (Suc (na + n), g)) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n        \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                               snd (add_cf S (n, f) (Suc (na + n), g))\n                                j \\<cdot>\\<^sub>r\n                               X^\\<^bsup>R j\\<^esup>) Suc\n                 (na + n) Suc (na + n);\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         \\<Sigma>\\<^sub>f R (\\<lambda>j.\n          snd (add_cf S (n, f) (Suc (na + n), g)) j \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc (na + n) Suc (na + n)", "apply (thin_tac \"polyn_expr R X (Suc (na + n))\n         (Suc (na + n), snd (add_cf S (n, f) (Suc (na + n), g))) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n        \\<Sigma>\\<^sub>f R (\\<lambda>j. snd (add_cf S (n, f) (Suc (na + n), g)) j \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R j\\<^esup>) (Suc (na + n)) (Suc (na + n))\",\n       thin_tac \"polyn_expr R X (Suc (na + n)) (add_cf S (n, f) (Suc (na + n),\n        g)) =\n        polyn_expr R X (na + n)\n         (na + n, snd (add_cf S (n, f) (Suc (na + n), g))) \\<plusminus>\n         \\<Sigma>\\<^sub>f R (\\<lambda>j. snd (add_cf S (n, f) (Suc (na + n), g)) j \\<cdot>\\<^sub>r\n                  X^\\<^bsup>R j\\<^esup>) (Suc (na + n)) (Suc (na + n))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         \\<Sigma>\\<^sub>f R (\\<lambda>j.\n          snd (add_cf S (n, f) (Suc (na + n), g)) j \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) Suc (na + n) Suc (na + n)", "apply (simp del:npow_suc add:fSum_def cmp_def slide_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         snd (add_cf S (n, f) (Suc (na + n), g))\n                          (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (cut_tac d = \"(Suc (na + n), g)\" in add_cf_val_hi[of \"(n, f)\"],\n         simp, simp del:npow_suc,\n         thin_tac \"snd (add_cf S (n, f) (Suc (na + n), g)) (Suc (na + n)) =\n        g (Suc (na + n))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (frule_tac c = \"add_cf S (n, f) (Suc (na + n), g)\" and k = \"na + n\" in\n         polyn_mem, simp,\n         frule_tac c = \"add_cf S (n, f) (na + n, g)\" and k = \"na + n\" in\n         polyn_mem, simp )"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R (na + n)\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> na + n \\<le> fst (add_cf S (n, f) (na + n, g))\n 2. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (subst add_cf_len, assumption+, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (frule_tac a = \"polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\" \n        and b = \"polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\"\n        and c = \"g (Suc (na + n)) \\<cdot>\\<^sub>r  X^\\<^bsup>R (Suc (na + n))\\<^esup>\" in \n        aGroup.ag_pOp_add_r[of R], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) =\n                         polyn_expr R X (na + n)\n                          (add_cf S (n, f) (Suc (na + n), g))\n 2. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup> =\n        polyn_expr R X (na + n)\n         (add_cf S (n, f) (Suc (na + n), g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc (na + n)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (rule_tac c = \"add_cf S (n, f) (na + n, g)\" and \n        d = \"add_cf S (n, f) (Suc (na + n), g)\" and k = \"na + n\" in \n        polyn_exprs_eq, assumption+, simp,\n        subst add_cf_len, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R (na + n)\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> na + n \\<le> max (fst (n, f)) (fst (na + n, g))\n 2. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>na + n.\n                            snd (add_cf S (n, f) (na + n, g)) j =\n                            snd (add_cf S (n, f) (Suc (na + n), g)) j\n 3. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup> =\n        polyn_expr R X (na + n)\n         (add_cf S (n, f) (Suc (na + n), g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc (na + n)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>na + n.\n                            snd (add_cf S (n, f) (na + n, g)) j =\n                            snd (add_cf S (n, f) (Suc (na + n), g)) j\n 2. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; Ring S;\n        pol_coeff S (Suc (na + n), g); pol_coeff S (na + n, g);\n        polyn_expr R X n (n, f) \\<plusminus>\n        polyn_expr R X (na + n) (na + n, g) =\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g));\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X (na + n) (na + n, g) \\<in> carrier R;\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup>\n        \\<in> carrier R;\n        aGroup R; pol_coeff S (add_cf S (n, f) (Suc (na + n), g));\n        pol_coeff S (add_cf S (n, f) (na + n, g));\n        fst (add_cf S (n, f) (Suc (na + n), g)) = Suc (na + n);\n        polyn_expr R X (na + n) (add_cf S (n, f) (Suc (na + n), g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g))\n        \\<in> carrier R;\n        polyn_expr R X (na + n) (add_cf S (n, f) (na + n, g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc (na + n)\\<^esup> =\n        polyn_expr R X (na + n)\n         (add_cf S (n, f) (Suc (na + n), g)) \\<plusminus>\n        g (Suc (na + n)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc (na + n)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (na + n)\n                          (add_cf S (n, f) (na + n, g)) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup> =\n                         polyn_expr R X (na + n)\n                          (na + n,\n                           snd (add_cf S (n, f)\n                                 (Suc (na + n), g))) \\<plusminus>\n                         g (Suc (na + n)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (na + n)\\<^esup>", "apply (rule allI, rule impI,\n        (subst add_cf_def)+, simp,\n        frule_tac m = na and g = g in polyn_expr_restrict1[of n f], assumption,\n        simp del:npow_suc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_add:\"\\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus> (polyn_expr R X m (m, g))\n                   = polyn_expr R X (max n m) (add_cf S (n, f) (m, g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X m (m, g) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (cut_tac less_linear[of n m])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g);\n     n < m \\<or> n = m \\<or> m < n\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X m (m, g) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (erule disjE,\n        frule polyn_addTr1[of n f \"m - n\"],\n        drule_tac a = g in forall_spec, simp, simp add: max.absorb1 max.absorb2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g);\n     n = m \\<or> m < n\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X m (m, g) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (erule disjE,\n        simp add:polyn_add_n1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X m (m, g) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (frule polyn_mem[of \"(n, f)\" n], simp,\n       frule polyn_mem[of \"(m, g)\" m], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X m (m, g) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (n, f) \\<plusminus>\n                      polyn_expr R X m (m, g) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (cut_tac ring_is_ag, simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X m (m, g) \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X m (m, g) \\<plusminus>\n                      polyn_expr R X n (n, f) =\n                      polyn_expr R X (max n m) (add_cf S (n, f) (m, g))", "apply (frule polyn_addTr1[of m g \"n - m\"],\n        drule_tac a = f in forall_spec, simp, simp,\n        frule add_cf_commute[of \"(m, g)\" \"(n, f)\"], assumption+, \n        simp add:max_def,\n        frule add_cf_pol_coeff[of \"(n, f)\" \"(m, g)\"], assumption+,\n        frule add_cf_pol_coeff[of \"(m, g)\" \"(n, f)\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X m (m, g) \\<in> carrier R; aGroup R;\n     polyn_expr R X m (m, g) \\<plusminus> polyn_expr R X n (n, f) =\n     polyn_expr R X n (add_cf S (m, g) (n, f));\n     \\<forall>j\\<le>n.\n        snd (add_cf S (m, g) (n, f)) j = snd (add_cf S (n, f) (m, g)) j;\n     pol_coeff S (add_cf S (n, f) (m, g));\n     pol_coeff S (add_cf S (m, g) (n, f))\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X n (add_cf S (m, g) (n, f)) =\n                      polyn_expr R X n (add_cf S (n, f) (m, g))", "apply (rule polyn_exprs_eq[of \"add_cf S (m, g) (n, f)\" \n                 \"add_cf S (n, f) (m, g)\" n], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X m (m, g) \\<in> carrier R; aGroup R;\n     polyn_expr R X m (m, g) \\<plusminus> polyn_expr R X n (n, f) =\n     polyn_expr R X n (add_cf S (m, g) (n, f));\n     \\<forall>j\\<le>n.\n        snd (add_cf S (m, g) (n, f)) j = snd (add_cf S (n, f) (m, g)) j;\n     pol_coeff S (add_cf S (n, f) (m, g));\n     pol_coeff S (add_cf S (m, g) (n, f))\\<rbrakk>\n    \\<Longrightarrow> n \\<le> min (fst (add_cf S (m, g) (n, f)))\n                               (fst (add_cf S (n, f) (m, g)))\n 2. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g); m < n;\n     polyn_expr R X n (n, f) \\<in> carrier R;\n     polyn_expr R X m (m, g) \\<in> carrier R; aGroup R;\n     polyn_expr R X m (m, g) \\<plusminus> polyn_expr R X n (n, f) =\n     polyn_expr R X n (add_cf S (m, g) (n, f));\n     \\<forall>j\\<le>n.\n        snd (add_cf S (m, g) (n, f)) j = snd (add_cf S (n, f) (m, g)) j;\n     pol_coeff S (add_cf S (n, f) (m, g));\n     pol_coeff S (add_cf S (m, g) (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         snd (add_cf S (m, g) (n, f)) j =\n                         snd (add_cf S (n, f) (m, g)) j", "apply (simp add:add_cf_len, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_add1:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus> (polyn_expr R X (fst d) d)\n                   = polyn_expr R X (max (fst c) (fst d)) (add_cf S c d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus>\n                      polyn_expr R X (fst d) d =\n                      polyn_expr R X (max (fst c) (fst d)) (add_cf S c d)", "apply (cases c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus>\n                         polyn_expr R X (fst d) d =\n                         polyn_expr R X (max (fst c) (fst d)) (add_cf S c d)", "apply (cases d)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b aa ba.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; c = (a, b);\n        d = (aa, ba)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (fst c) c \\<plusminus>\n                         polyn_expr R X (fst d) d =\n                         polyn_expr R X (max (fst c) (fst d)) (add_cf S c d)", "apply (simp add: polyn_add)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_minus_nsum:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (polyn_expr R X k c) = nsum R (\\<lambda>j. ((-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j)) \\<cdot>\\<^sub>r (X^\\<^bsup>R j\\<^esup>))) k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a polyn_expr R X k c =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (-\\<^sub>a\\<^bsub>S\\<^esub> snd c j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) k", "apply (cut_tac subring,\n       frule subring_Ring[of S],\n       frule Ring.ring_is_ag[of S],\n       cut_tac ring_is_ag,\n       cut_tac X_mem_R)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a polyn_expr R X k c =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (-\\<^sub>a\\<^bsub>S\\<^esub> snd c j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) k", "apply (simp add:polyn_expr_def,\n       subst aGroup.nsum_minus[of R], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>x\\<in>{j. j \\<le> k}.\n       -\\<^sub>a snd c x \\<cdot>\\<^sub>r X^\\<^bsup>R x\\<^esup>) k =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (-\\<^sub>a\\<^bsub>S\\<^esub> snd c j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) k", "apply (frule monomial_mem[of c], rule allI, rule impI,\n        frule_tac i = j and j = k and k = \"fst c\" in le_trans, assumption+,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>x\\<in>{j. j \\<le> k}.\n       -\\<^sub>a snd c x \\<cdot>\\<^sub>r X^\\<^bsup>R x\\<^esup>) k =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>j.\n       (-\\<^sub>a\\<^bsub>S\\<^esub> snd c j) \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) k", "apply (rule aGroup.nsum_eq, assumption,\n       rule allI, rule impI, simp,\n       rule aGroup.ag_mOp_closed, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 3. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (\\<lambda>x\\<in>{j. j \\<le> k}.\n                             -\\<^sub>a snd c x \\<cdot>\\<^sub>r\n X^\\<^bsup>R x\\<^esup>)\n                          j =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (frule monomial_mem[of c],\n        frule_tac i = j and j = k and k = \"fst c\" in le_trans, assumption+,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>\n                         \\<in> carrier R\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (\\<lambda>x\\<in>{j. j \\<le> k}.\n                             -\\<^sub>a snd c x \\<cdot>\\<^sub>r\n X^\\<^bsup>R x\\<^esup>)\n                          j =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (rule allI, rule impI,\n       rule ring_tOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<in> carrier R\n 3. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (\\<lambda>x\\<in>{j. j \\<le> k}.\n                             -\\<^sub>a snd c x \\<cdot>\\<^sub>r\n X^\\<^bsup>R x\\<^esup>)\n                          j =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (frule_tac j = j  in pol_coeff_mem[of c])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k\\<rbrakk>\n       \\<Longrightarrow> j \\<le> fst c\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k;\n        snd c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier R\n 3. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<in> carrier R\n 4. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (\\<lambda>x\\<in>{j. j \\<le> k}.\n                             -\\<^sub>a snd c x \\<cdot>\\<^sub>r\n X^\\<^bsup>R x\\<^esup>)\n                          j =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (frule_tac i = j and j = k and k = \"fst c\" in le_trans, assumption+,\n       simp add:Subring_minus_ring_minus,\n       frule_tac x = \"(snd c) j\" in mem_subring_mem_ring[of S], assumption,\n       simp add:aGroup.ag_mOp_closed,\n       simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n     aGroup R; X \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         (\\<lambda>x\\<in>{j. j \\<le> k}.\n                             -\\<^sub>a snd c x \\<cdot>\\<^sub>r\n X^\\<^bsup>R x\\<^esup>)\n                          j =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (rule allI, rule impI, simp,\n       cut_tac j = j in pol_coeff_mem[of c], assumption,\n       rule_tac i = j and j = k and k = \"fst c\" in le_trans, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k;\n        snd c j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a snd c j \\<cdot>\\<^sub>r\n                                   X^\\<^bsup>R j\\<^esup> =\n                         (-\\<^sub>a\\<^bsub>S\\<^esub> snd c\n                j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (simp add:Subring_minus_ring_minus,\n       frule_tac x = \"(snd c) j\" in mem_subring_mem_ring[of S], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k; snd c j \\<in> carrier S;\n        snd c j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a snd c j \\<cdot>\\<^sub>r\n                                   X^\\<^bsup>R j\\<^esup> =\n                         (-\\<^sub>a snd c j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (subst ring_inv1_1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k; snd c j \\<in> carrier S;\n        snd c j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<in> carrier R\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; Subring R S; Ring S; aGroup S;\n        aGroup R; X \\<in> carrier R; j \\<le> k; snd c j \\<in> carrier S;\n        snd c j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a snd c j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup> =\n                         (-\\<^sub>a snd c j) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup>", "apply (simp add:npClose, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) minus_pol_coeff:\"pol_coeff S c \\<Longrightarrow> \n                         pol_coeff S ((fst c), (\\<lambda>j. (-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    pol_coeff S (fst c, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd c j)", "apply (simp add:pol_coeff_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>fst c. snd c j \\<in> carrier S \\<Longrightarrow>\n    \\<forall>j\\<le>fst c. -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier S", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier S", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        j \\<le> fst c; Subring R S; Ring S\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier S", "apply (frule Ring.ring_is_ag[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        j \\<le> fst c; Subring R S; Ring S; aGroup S\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>S\\<^esub> snd c j \\<in> carrier S", "apply (rule aGroup.ag_mOp_closed, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        j \\<le> fst c; Subring R S; Ring S; aGroup S\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<in> carrier S", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_minus:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       -\\<^sub>a (polyn_expr R X k c) = \n                    polyn_expr R X k (fst c, (\\<lambda>j. (-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a polyn_expr R X k c =\n                      polyn_expr R X k\n                       (fst c,\n                        \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd c j)", "apply (cases c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a polyn_expr R X k c =\n                         polyn_expr R X k\n                          (fst c,\n                           \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd c j)", "apply (subst polyn_minus_nsum)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S c\n 2. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> k \\<le> fst c\n 3. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>j.\n          (-\\<^sub>a\\<^bsub>S\\<^esub> snd c j) \\<cdot>\\<^sub>r\n          X^\\<^bsup>R j\\<^esup>) k =\n                         polyn_expr R X k\n                          (fst c,\n                           \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd c j)", "apply (simp_all add: polyn_expr_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  m_cf :: \"[('a, 'm) Ring_scheme, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'a)\" where\n  \"m_cf S c = (fst c, (\\<lambda>j. (-\\<^sub>a\\<^bsub>S\\<^esub> ((snd c) j))))\""], ["", "lemma (in PolynRg) m_cf_pol_coeff:\"pol_coeff S c \\<Longrightarrow>\n                              pol_coeff S (m_cf S c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> pol_coeff S (m_cf S c)", "by (simp add:m_cf_def, simp add:minus_pol_coeff)"], ["", "lemma (in PolynRg) m_cf_len:\"pol_coeff S c \\<Longrightarrow>\n                                         fst (m_cf S c) = fst c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> fst (m_cf S c) = fst c", "by (simp add:m_cf_def)"], ["", "lemma (in PolynRg) polyn_minus_m_cf:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n        -\\<^sub>a (polyn_expr R X k c) =  \n                     polyn_expr R X k (m_cf S c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a polyn_expr R X k c =\n                      polyn_expr R X k (m_cf S c)", "by (simp add:m_cf_def polyn_minus)"], ["", "lemma (in PolynRg) polyn_zero_minus_zero:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       (polyn_expr R X k c = \\<zero>) = (polyn_expr R X k (m_cf S c) = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c = \\<zero>) =\n                      (polyn_expr R X k (m_cf S c) = \\<zero>)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c = \\<zero>) =\n                      (polyn_expr R X k (m_cf S c) = \\<zero>)", "apply (simp add:polyn_minus_m_cf[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c = \\<zero>) =\n                      (-\\<^sub>a polyn_expr R X k c = \\<zero>)", "apply (rule iffI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<zero> = \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R;\n     -\\<^sub>a polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>", "apply (simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R;\n     -\\<^sub>a polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>", "apply (frule polyn_mem[of c k], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R;\n     -\\<^sub>a polyn_expr R X k c = \\<zero>;\n     polyn_expr R X k c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>", "apply (frule aGroup.ag_inv_inv[of \"R\" \"polyn_expr R X k c\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R;\n     -\\<^sub>a polyn_expr R X k c = \\<zero>;\n     polyn_expr R X k c \\<in> carrier R;\n     -\\<^sub>a (-\\<^sub>a polyn_expr R X k c) = polyn_expr R X k c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>", "apply (simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_0_pol_0:\"\\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk> \\<Longrightarrow>\n       (\\<forall>j\\<le> k. (snd c) j = \\<zero>\\<^bsub>S\\<^esub>) = (polyn_expr R X k c = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>k.\n                          snd c j = \\<zero>\\<^bsub>S\\<^esub>) =\n                      (polyn_expr R X k c = \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac ring_is_ag, cut_tac subring,\n       frule subring_Ring)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>; aGroup R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:Subring_zero_ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     \\<forall>j\\<le>k. snd c j = \\<zero>; aGroup R; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X k c = \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:polyn_expr_def,\n       rule aGroup.nsum_zeroA[of R], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     \\<forall>j\\<le>k. snd c j = \\<zero>; aGroup R; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k.\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (rule allI, rule impI,\n       cut_tac X_mem_R)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n        \\<forall>j\\<le>k. snd c j = \\<zero>; aGroup R; Subring R S; Ring S;\n        j \\<le> k; X \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (drule_tac a = j in forall_spec, simp,\n        frule_tac n = j in npClose[of X], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; aGroup R; Subring R S; Ring S;\n        j \\<le> k; X \\<in> carrier R; snd c j = \\<zero>;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         \\<zero>\n 2. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:ring_times_0_x)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (cases c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; polyn_expr R X k c = \\<zero>;\n        c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>k.\n                            snd c j = \\<zero>\\<^bsub>S\\<^esub>", "using algfree [simplified algfree_cond_def]"], ["proof (prove)\nusing this:\n  \\<forall>c.\n     pol_coeff S c \\<and>\n     (\\<forall>k\\<le>fst c.\n         \\<Sigma>\\<^sub>e R (\\<lambda>j.\n                                snd c j \\<cdot>\\<^sub>r\n                                X^\\<^bsup>R j\\<^esup>) k =\n         \\<zero> \\<longrightarrow>\n         (\\<forall>j\\<le>k. snd c j = \\<zero>\\<^bsub>S\\<^esub>))\n\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>pol_coeff S c; k \\<le> fst c; polyn_expr R X k c = \\<zero>;\n        c = (a, b)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>k.\n                            snd c j = \\<zero>\\<^bsub>S\\<^esub>", "by (auto simp add: polyn_expr_def)"], ["", "subsection \\<open>Multiplication of \\<open>pol_exprs\\<close>\\<close>"], ["", "subsection \"Multiplication\""], ["", "definition\n  ext_cf :: \"[('a, 'm) Ring_scheme, nat, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> \n                                                  nat \\<times> (nat \\<Rightarrow> 'a)\" where\n  \"ext_cf S n c = (n + fst c, \\<lambda>i. if n \\<le> i then (snd c) (sliden n i) else \\<zero>\\<^bsub>S\\<^esub>)\""], ["", "(* 0         0 g(0)         g(m) \n     0            n           m+n  , where (m, g) is a pol_coeff  **)"], ["", "definition\n  sp_cf :: \"[('a, 'm) Ring_scheme, 'a, nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'a)\" where\n  \"sp_cf S a c = (fst c, \\<lambda>j. a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((snd c) j))\""], ["", "(* scalar times cf *)"], ["", "definition\n  special_cf :: \"('a, 'm) Ring_scheme \\<Rightarrow> nat \\<times> (nat \\<Rightarrow> 'a)\" (\"C\\<^sub>0\") where\n  \"C\\<^sub>0 S = (0, \\<lambda>j. 1\\<^sub>r\\<^bsub>S\\<^esub>)\""], ["", "lemma (in PolynRg) special_cf_pol_coeff:\"pol_coeff S (C\\<^sub>0 S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S)", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (C\\<^sub>0 S)", "apply (simp add:pol_coeff_def special_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>S\\<^esub> \\<in> carrier S", "apply (simp add:Ring.ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) special_cf_len:\"fst (C\\<^sub>0 S) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fst (C\\<^sub>0 S) = 0", "apply (simp add:special_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_pol_coeff:\"pol_coeff S c \\<Longrightarrow> \n                           pol_coeff S (ext_cf S n c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> pol_coeff S (ext_cf S n c)", "apply (simp add: pol_coeff_def ext_cf_def sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>fst c. snd c j \\<in> carrier S \\<Longrightarrow>\n    (\\<exists>j. \\<not> n \\<le> j) \\<longrightarrow>\n    \\<zero>\\<^bsub>S\\<^esub> \\<in> carrier S", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n     \\<exists>j. \\<not> n \\<le> j\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> \\<in> carrier S", "apply (rule Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n     \\<exists>j. \\<not> n \\<le> j\\<rbrakk>\n    \\<Longrightarrow> Ring S", "apply (rule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n     \\<exists>j. \\<not> n \\<le> j\\<rbrakk>\n    \\<Longrightarrow> Subring R S", "apply (rule subring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_len:\"pol_coeff S c \\<Longrightarrow>\n                   fst (ext_cf S m c) = m + fst c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> fst (ext_cf S m c) = m + fst c", "by (simp add:ext_cf_def)"], ["", "lemma (in PolynRg) ext_special_cf_len:\"fst (ext_cf S m (C\\<^sub>0 S)) = m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. fst (ext_cf S m (C\\<^sub>0 S)) = m", "apply (cut_tac special_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow>\n    fst (ext_cf S m (C\\<^sub>0 S)) = m", "apply (simp add:ext_cf_len special_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_self:\"pol_coeff S c \\<Longrightarrow> \n                   \\<forall>j \\<le> (fst c). snd (ext_cf S 0 c) j = (snd c) j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    \\<forall>j\\<le>fst c. snd (ext_cf S 0 c) j = snd c j", "apply (rule allI, rule impI, simp add:ext_cf_def sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_hi:\"pol_coeff S c \\<Longrightarrow> \n                   (snd c) (fst c)  =\n                      snd (ext_cf S n c) (n + (fst c))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    snd c (fst c) = snd (ext_cf S n c) (n + fst c)", "apply (subst ext_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    snd c (fst c) =\n    snd (n + fst c,\n         \\<lambda>i.\n            if n \\<le> i then snd c (sliden n i)\n            else \\<zero>\\<^bsub>S\\<^esub>)\n     (n + fst c)", "apply (simp add:sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_special_cf_hi:\"snd (ext_cf S n (C\\<^sub>0 S)) n = 1\\<^sub>r\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. snd (ext_cf S n (C\\<^sub>0 S)) n = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac special_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow>\n    snd (ext_cf S n (C\\<^sub>0 S)) n = 1\\<^sub>r\\<^bsub>S\\<^esub>", "apply (cut_tac ext_cf_hi[of \"C\\<^sub>0 S\" n, THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (C\\<^sub>0 S);\n     snd (ext_cf S n (C\\<^sub>0 S)) (n + fst (C\\<^sub>0 S)) =\n     snd (C\\<^sub>0 S) (fst (C\\<^sub>0 S))\\<rbrakk>\n    \\<Longrightarrow> snd (ext_cf S n (C\\<^sub>0 S)) n =\n                      1\\<^sub>r\\<^bsub>S\\<^esub>\n 2. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow> pol_coeff S (C\\<^sub>0 S)", "apply (simp add:special_cf_def, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_lo_zero:\"\\<lbrakk>pol_coeff S c; 0 < n; x \\<le> (n - Suc 0)\\<rbrakk>\n              \\<Longrightarrow> snd (ext_cf S n c) x = \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; 0 < n; x \\<le> n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd (ext_cf S n c) x = \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac Suc_le_mono[THEN sym, of x \"n - Suc 0\"], simp,\n       cut_tac x = x and y = \"Suc x\" and z = n in less_le_trans,\n       simp, assumption,\n       simp add:nat_not_le_less[THEN sym, of x n],\n              thin_tac \"x \\<le> n - Suc 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; \\<not> n \\<le> x\\<rbrakk>\n    \\<Longrightarrow> snd (ext_cf S n c) x = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:ext_cf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_special_cf_lo_zero:\"\\<lbrakk>0 < n; x \\<le> (n - Suc 0)\\<rbrakk>\n              \\<Longrightarrow> snd (ext_cf S n (C\\<^sub>0 S)) x = \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>0 < n; x \\<le> n - Suc 0\\<rbrakk>\n    \\<Longrightarrow> snd (ext_cf S n (C\\<^sub>0 S)) x =\n                      \\<zero>\\<^bsub>S\\<^esub>", "by (cut_tac special_cf_pol_coeff,\n       frule ext_cf_lo_zero[of \"C\\<^sub>0 S\" n], assumption+)"], ["", "lemma (in PolynRg) sp_cf_pol_coeff:\"\\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                   pol_coeff S (sp_cf S a c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (sp_cf S a c)", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; a \\<in> carrier S; Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (sp_cf S a c)", "apply (simp add:pol_coeff_def sp_cf_def,\n       rule allI, rule impI,\n      rule Ring.ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>fst c. snd c j \\<in> carrier S;\n        a \\<in> carrier S; Subring R S; Ring S; j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd c j \\<in> carrier S", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) sp_cf_len:\"\\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                    fst (sp_cf S a c) = fst c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; a \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> fst (sp_cf S a c) = fst c", "by (simp add:sp_cf_def)"], ["", "lemma (in PolynRg) sp_cf_val:\"\\<lbrakk>pol_coeff S c; j \\<le> (fst c); a \\<in> carrier S\\<rbrakk> \\<Longrightarrow> \n                    snd (sp_cf S a c) j =  a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> ((snd c) j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; j \\<le> fst c; a \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> snd (sp_cf S a c) j =\n                      a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> snd c j", "by (simp add:sp_cf_def)"], ["", "lemma (in PolynRg) polyn_ext_cf_lo_zero:\"\\<lbrakk>pol_coeff S c; 0 < j\\<rbrakk> \\<Longrightarrow>  \n                     polyn_expr R X (j - Suc 0) (ext_cf S j c) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; 0 < j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (j - Suc 0) (ext_cf S j c) = \\<zero>", "apply (simp add:polyn_expr_def, cut_tac ring_is_ag,\n       rule aGroup.nsum_zeroA, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; 0 < j; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>j - Suc 0.\n                         snd (ext_cf S j c) ja \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R ja\\<^esup> =\n                         \\<zero>", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ja.\n       \\<lbrakk>pol_coeff S c; 0 < j; aGroup R; ja \\<le> j - Suc 0\\<rbrakk>\n       \\<Longrightarrow> snd (ext_cf S j c) ja \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R ja\\<^esup> =\n                         \\<zero>", "apply (frule_tac x = ja in ext_cf_lo_zero [of c j], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ja.\n       \\<lbrakk>pol_coeff S c; 0 < j; aGroup R; ja \\<le> j - Suc 0;\n        snd (ext_cf S j c) ja = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd (ext_cf S j c) ja \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R ja\\<^esup> =\n                         \\<zero>", "apply (cut_tac X_mem_R, frule_tac n = ja in npClose[of X])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ja.\n       \\<lbrakk>pol_coeff S c; 0 < j; aGroup R; ja \\<le> j - Suc 0;\n        snd (ext_cf S j c) ja = \\<zero>\\<^bsub>S\\<^esub>; X \\<in> carrier R;\n        X^\\<^bsup>R ja\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> snd (ext_cf S j c) ja \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R ja\\<^esup> =\n                         \\<zero>", "apply (cut_tac subring,\n        simp add:Subring_zero_ring_zero,\n        simp add:ring_times_0_x)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) monomial_d:\"pol_coeff S c \\<Longrightarrow>\n                  polyn_expr R X d (ext_cf S d c) = ((snd c) 0) \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    polyn_expr R X d (ext_cf S d c) =\n    snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (cut_tac ring_is_ag,\n       cut_tac subring,\n       cut_tac  X_mem_R,\n       frule subring_Ring[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (frule pol_coeff_mem [of c 0], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (case_tac \"d = 0\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d = 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d = 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X 0 (ext_cf S 0 c) =\n                      snd c 0 \\<cdot>\\<^sub>r 1\\<^sub>r\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (simp add:polyn_expr_def ext_cf_def sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (frule ext_cf_pol_coeff[of c d])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (cut_tac polyn_Suc[of \"d - Suc 0\" \"ext_cf S d c\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c);\n     polyn_expr R X (Suc (d - Suc 0))\n      (Suc (d - Suc 0), snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) (Suc (d - Suc 0)) \\<cdot>\\<^sub>r\n     X^\\<^bsup>R Suc (d - Suc 0)\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> Suc (d - Suc 0) \\<le> fst (ext_cf S d c)", "apply (simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> Suc (d - Suc 0) \\<le> fst (ext_cf S d c)", "apply (cut_tac polyn_ext_cf_lo_zero[of c d], simp,\n       thin_tac \"polyn_expr R X (d - Suc 0) (ext_cf S d c) = \\<zero>\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     \\<zero> \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> 0 < d\n 4. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> Suc (d - Suc 0) \\<le> fst (ext_cf S d c)", "apply (frule monomial_mem[of \"ext_cf S d c\"], simp add:ext_cf_len,\n        drule_tac a = d in forall_spec, simp, simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>;\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (ext_cf S d c) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> 0 < d\n 4. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> Suc (d - Suc 0) \\<le> fst (ext_cf S d c)", "apply (subst polyn_expr_short[of \"ext_cf S d c\" d], assumption,\n        simp add:ext_cf_len)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>;\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n     \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X d (d, snd (ext_cf S d c)) =\n                      snd c 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\n 2. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; 0 < d; pol_coeff S (ext_cf S d c);\n     polyn_expr R X d (d, snd (ext_cf S d c)) =\n     polyn_expr R X (d - Suc 0) (ext_cf S d c) \\<plusminus>\n     snd (ext_cf S d c) d \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> 0 < d\n 4. \\<lbrakk>pol_coeff S c; aGroup R; Subring R S; X \\<in> carrier R;\n     Ring S; snd c 0 \\<in> carrier S; d \\<noteq> 0;\n     pol_coeff S (ext_cf S d c)\\<rbrakk>\n    \\<Longrightarrow> Suc (d - Suc 0) \\<le> fst (ext_cf S d c)", "apply (simp,\n        subst ext_cf_def, simp add:sliden_def , assumption+,\n        simp add:ext_cf_len)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) X_to_d:\" X^\\<^bsup>R d\\<^esup> =  polyn_expr R X d (ext_cf S d (C\\<^sub>0 S))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. X^\\<^bsup>R d\\<^esup> = polyn_expr R X d (ext_cf S d (C\\<^sub>0 S))", "apply (cut_tac special_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow>\n    X^\\<^bsup>R d\\<^esup> = polyn_expr R X d (ext_cf S d (C\\<^sub>0 S))", "apply (subst monomial_d[of \"C\\<^sub>0 S\" d], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow>\n    X^\\<^bsup>R d\\<^esup> =\n    snd (C\\<^sub>0 S) 0 \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (subst special_cf_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (C\\<^sub>0 S) \\<Longrightarrow>\n    X^\\<^bsup>R d\\<^esup> =\n    1\\<^sub>r\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (C\\<^sub>0 S); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R d\\<^esup> =\n                      1\\<^sub>r\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R d\\<^esup>", "apply (simp add:Subring_one_ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (C\\<^sub>0 S); Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R d\\<^esup> =\n                      1\\<^sub>r \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (cut_tac X_mem_R, frule_tac n = d in npClose[of X])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (C\\<^sub>0 S); Subring R S; Ring S;\n     X \\<in> carrier R; X^\\<^bsup>R d\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> X^\\<^bsup>R d\\<^esup> =\n                      1\\<^sub>r \\<cdot>\\<^sub>r X^\\<^bsup>R d\\<^esup>", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) c_max_ext_special_cf:\"c_max S (ext_cf S n (C\\<^sub>0 S)) = n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. c_max S (ext_cf S n (C\\<^sub>0 S)) = n", "apply (cut_tac polyn_ring_S_nonzero,\n       cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> c_max S (ext_cf S n (C\\<^sub>0 S)) = n", "apply (simp add:c_max_def special_cf_def ext_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> n_max\n                       {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                           n \\<le> j} =\n                      n", "apply (cut_tac n_max[of \"{j. (n \\<le> j \\<longrightarrow> j = n) \\<and> n \\<le> j}\" n])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S;\n     n_max {j. (n \\<le> j \\<longrightarrow> j = n) \\<and> n \\<le> j}\n     \\<in> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and> n \\<le> j} \\<and>\n     (\\<forall>x\\<in>{j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                         n \\<le> j}.\n         x \\<le> n_max\n                  {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                      n \\<le> j})\\<rbrakk>\n    \\<Longrightarrow> n_max\n                       {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                           n \\<le> j} =\n                      n\n 2. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j}\n                      \\<subseteq> {i. i \\<le> n}\n 3. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j} \\<noteq>\n                      {}", "apply (erule conjE)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S;\n     n_max {j. (n \\<le> j \\<longrightarrow> j = n) \\<and> n \\<le> j}\n     \\<in> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and> n \\<le> j};\n     \\<forall>x\\<in>{j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                        n \\<le> j}.\n        x \\<le> n_max\n                 {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                     n \\<le> j}\\<rbrakk>\n    \\<Longrightarrow> n_max\n                       {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                           n \\<le> j} =\n                      n\n 2. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j}\n                      \\<subseteq> {i. i \\<le> n}\n 3. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j} \\<noteq>\n                      {}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j}\n                      \\<subseteq> {i. i \\<le> n}\n 2. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j} \\<noteq>\n                      {}", "apply (rule subsetI, simp, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r\\<^bsub>S\\<^esub> \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> {j. (n \\<le> j \\<longrightarrow> j = n) \\<and>\n                          n \\<le> j} \\<noteq>\n                      {}", "apply (cut_tac le_refl[of n], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) scalar_times_polynTr:\"a \\<in> carrier S \\<Longrightarrow> \n       \\<forall>f. pol_coeff S (n, f) \\<longrightarrow> \n        a \\<cdot>\\<^sub>r (polyn_expr R X n (n, f)) = polyn_expr R X n (sp_cf S a (n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier S \\<Longrightarrow>\n    \\<forall>f.\n       pol_coeff S (n, f) \\<longrightarrow>\n       a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n       polyn_expr R X n (sp_cf S a (n, f))", "apply (cut_tac subring,\n       cut_tac X_mem_R,\n       frule_tac x = a in mem_subring_mem_ring, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n     a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>f.\n                         pol_coeff S (n, f) \\<longrightarrow>\n                         a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n                         polyn_expr R X n (sp_cf S a (n, f))", "apply (induct_tac n,\n       rule allI, rule impI, simp add:polyn_expr_def sp_cf_def,\n       cut_tac n_in_Nsetn[of \"0\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (0, f);\n        0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         f 0 \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<longrightarrow>\n           a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n           polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            pol_coeff S (Suc n, f) \\<longrightarrow>\n                            a \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (cut_tac subring_Ring,\n        frule_tac c = \"(0, f)\" in pol_coeff_mem[of _ \"0\"], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (0, f); 0 \\<in> {i. i \\<le> 0};\n        Ring (?S14 f); snd (0, f) 0 \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         f 0 \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n 2. \\<And>f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (0, f);\n        0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> Subring R (?S14 f)\n 3. \\<And>n.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<longrightarrow>\n           a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n           polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            pol_coeff S (Suc n, f) \\<longrightarrow>\n                            a \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (simp,\n       frule_tac x = \"f 0\" in mem_subring_mem_ring, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (0, f); Ring (?S14 f);\n        f 0 \\<in> carrier S; f 0 \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         f 0 \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n 2. \\<And>f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (0, f);\n        0 \\<in> {i. i \\<le> 0}\\<rbrakk>\n       \\<Longrightarrow> Subring R (?S14 f)\n 3. \\<And>n.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<longrightarrow>\n           a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n           polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            pol_coeff S (Suc n, f) \\<longrightarrow>\n                            a \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (       simp add:Subring_tOp_ring_tOp,\n       frule_tac y = \"f 0\" in ring_tOp_closed[of a], assumption+,\n       cut_tac ring_one, simp add:ring_tOp_assoc, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R;\n        \\<forall>f.\n           pol_coeff S (n, f) \\<longrightarrow>\n           a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n           polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            pol_coeff S (Suc n, f) \\<longrightarrow>\n                            a \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc n) (Suc n, f) =\n                            polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (rule allI, rule impI,\n       frule subring_Ring,\n       frule_tac n = n and f = f in pol_coeff_pre,\n       drule_tac x = f in spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f) =\n                         polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (cut_tac n = n and c = \"(Suc n, f)\" in polyn_Suc, simp,\n         simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, f) =\n           polyn_expr R X n (Suc n, f) \\<plusminus> f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f))\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (cut_tac n = n and c = \"sp_cf S a (Suc n, f)\" in polyn_Suc,\n        simp add:sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        polyn_expr R X (Suc n) (Suc n, snd (sp_cf S a (Suc n, f))) =\n        polyn_expr R X n (sp_cf S a (Suc n, f)) \\<plusminus>\n        snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (frule_tac c = \"(Suc n, f)\" and a = a in sp_cf_len, assumption+,\n        simp only:fst_conv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        polyn_expr R X (Suc n) (Suc n, snd (sp_cf S a (Suc n, f))) =\n        polyn_expr R X n (sp_cf S a (Suc n, f)) \\<plusminus>\n        snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc n\\<^esup>;\n        fst (sp_cf S a (Suc n, f)) = Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X (Suc n) (sp_cf S a (Suc n, f))", "apply (cut_tac k = \"Suc n\" and f = \"sp_cf S a (Suc n, f)\" in \n        polyn_expr_split, simp del:npow_suc,\n        thin_tac \"polyn_expr R X (Suc n) (Suc n, snd (sp_cf S a (Suc n, f))) =\n           polyn_expr R X n (sp_cf S a (Suc n, f)) \\<plusminus>\n           snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\",\n        thin_tac \"polyn_expr R X (Suc n) (sp_cf S a (Suc n, f)) =\n           polyn_expr R X n (sp_cf S a (Suc n, f)) \\<plusminus>\n           snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X n\n                          (sp_cf S a (Suc n, f)) \\<plusminus>\n                         snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, f)\" and a = a in sp_cf_pol_coeff, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n;\n        pol_coeff S (sp_cf S a (Suc n, f))\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X n\n                          (sp_cf S a (Suc n, f)) \\<plusminus>\n                         snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (frule_tac c = \"(Suc n, f)\" and k = n in polyn_mem,\n        simp,  \n        frule_tac c = \"(Suc n, f)\" in monomial_mem,\n        drule_tac a = \"Suc n\" in forall_spec, simp,\n        simp only:snd_conv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n;\n        pol_coeff S (sp_cf S a (Suc n, f));\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>) =\n                         polyn_expr R X n\n                          (sp_cf S a (Suc n, f)) \\<plusminus>\n                         snd (sp_cf S a (Suc n, f)) (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (subst ring_distrib1, assumption+,\n        subst polyn_expr_restrict, assumption+, simp del:npow_suc,\n        subst sp_cf_val, assumption, simp, assumption,\n              simp only:snd_conv,\n        frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem,\n              simp, simp only:snd_conv,\n        simp del:npow_suc add:Subring_tOp_ring_tOp,\n        subst ring_tOp_assoc[THEN sym, of a], assumption+,\n        simp add:mem_subring_mem_ring, rule npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n;\n        pol_coeff S (sp_cf S a (Suc n, f));\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (sp_cf S a (n, f)) \\<plusminus>\n                         a \\<cdot>\\<^sub>r f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup> =\n                         polyn_expr R X n\n                          (sp_cf S a (Suc n, f)) \\<plusminus>\n                         a \\<cdot>\\<^sub>r f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc n\\<^esup>", "apply (cut_tac ring_is_ag,\n        rule aGroup.ag_pOp_add_r, assumption+,\n        rule polyn_mem, rule sp_cf_pol_coeff, assumption+,\n        simp add:sp_cf_len,\n        rule polyn_mem, assumption, simp add:sp_cf_len,\n        frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem_R,\n                simp, simp only:snd_conv,\n        (rule ring_tOp_closed)+, assumption+, rule npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n;\n        pol_coeff S (sp_cf S a (Suc n, f));\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<in> carrier S; aGroup R\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (sp_cf S a (n, f)) =\n                         polyn_expr R X n (sp_cf S a (Suc n, f))", "apply (rule_tac c = \"sp_cf S a (n, f)\" and d = \"sp_cf S a (Suc n, f)\" and \n        k = n in polyn_exprs_eq, rule sp_cf_pol_coeff, assumption+,\n        simp add:sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>a \\<in> carrier S; Subring R S; X \\<in> carrier R;\n        a \\<in> carrier R; pol_coeff S (Suc n, f); Ring S;\n        pol_coeff S (n, f);\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, f) =\n        polyn_expr R X n (sp_cf S a (n, f));\n        fst (sp_cf S a (Suc n, f)) = Suc n;\n        pol_coeff S (sp_cf S a (Suc n, f));\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R;\n        f (Suc n) \\<in> carrier S; aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            snd (sp_cf S a (n, f)) j =\n                            snd (sp_cf S a (Suc n, f)) j", "apply (rule allI, rule impI,\n        (subst sp_cf_def)+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) scalar_times_pol_expr:\"\\<lbrakk>a \\<in> carrier S; pol_coeff S c; \n       n \\<le> fst c\\<rbrakk> \\<Longrightarrow> \n           a \\<cdot>\\<^sub>r (polyn_expr R X n c) = polyn_expr R X n (sp_cf S a c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier S; pol_coeff S c; n \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n c =\n                      polyn_expr R X n (sp_cf S a c)", "apply (cases c)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa b.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S c; n \\<le> fst c;\n        c = (aa, b)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n c =\n                         polyn_expr R X n (sp_cf S a c)", "apply (simp only:)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>aa b.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (aa, b); n \\<le> fst (aa, b);\n        c = (aa, b)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n (aa, b) =\n                         polyn_expr R X n (sp_cf S a (aa, b))", "apply (rename_tac m g)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> fst (m, g);\n        c = (m, g)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n (m, g) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (thin_tac \"c = (m, g)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g);\n        n \\<le> fst (m, g)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n (m, g) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (frule_tac c = \"(m, g)\" and k = n in polyn_expr_short, simp,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        polyn_expr R X n (m, g) = polyn_expr R X n (n, g)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n (n, g) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (frule scalar_times_polynTr[of a n],\n       drule_tac x = g in spec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        polyn_expr R X n (m, g) = polyn_expr R X n (n, g);\n        pol_coeff S (n, g) \\<longrightarrow>\n        a \\<cdot>\\<^sub>r polyn_expr R X n (n, g) =\n        polyn_expr R X n (sp_cf S a (n, g))\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r polyn_expr R X n (n, g) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (frule_tac c = \"(m, g)\" and n = n in pol_coeff_le, simp, simp,\n        thin_tac \"polyn_expr R X n (m, g) = polyn_expr R X n (n, g)\",\n        thin_tac \"a \\<cdot>\\<^sub>r polyn_expr R X n (n, g) =\n           polyn_expr R X n (sp_cf S a (n, g))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        pol_coeff S (n, g)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (sp_cf S a (n, g)) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (frule_tac c = \"(m, g)\" and n = n in pol_coeff_le, simp, simp,\n        frule_tac c = \"(n, g)\" and a = a in sp_cf_pol_coeff, assumption,\n        frule_tac c = \"(m, g)\" and a = a in sp_cf_pol_coeff, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        pol_coeff S (n, g); pol_coeff S (sp_cf S a (n, g));\n        pol_coeff S (sp_cf S a (m, g))\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X n (sp_cf S a (n, g)) =\n                         polyn_expr R X n (sp_cf S a (m, g))", "apply (rule_tac c = \"sp_cf S a (n, g)\" and d = \"sp_cf S a (m, g)\" and \n        k = n in polyn_exprs_eq, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        pol_coeff S (n, g); pol_coeff S (sp_cf S a (n, g));\n        pol_coeff S (sp_cf S a (m, g))\\<rbrakk>\n       \\<Longrightarrow> n \\<le> min (fst (sp_cf S a (n, g)))\n                                  (fst (sp_cf S a (m, g)))\n 2. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        pol_coeff S (n, g); pol_coeff S (sp_cf S a (n, g));\n        pol_coeff S (sp_cf S a (m, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            snd (sp_cf S a (n, g)) j =\n                            snd (sp_cf S a (m, g)) j", "apply (simp add:sp_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>m g.\n       \\<lbrakk>a \\<in> carrier S; pol_coeff S (m, g); n \\<le> m;\n        pol_coeff S (n, g); pol_coeff S (sp_cf S a (n, g));\n        pol_coeff S (sp_cf S a (m, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>n.\n                            snd (sp_cf S a (n, g)) j =\n                            snd (sp_cf S a (m, g)) j", "apply (rule allI, (subst sp_cf_def)+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) sp_coeff_nonzero:\"\\<lbrakk>Idomain S; a \\<in> carrier S; a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n       pol_coeff S c; (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; j \\<le> (fst c)\\<rbrakk> \\<Longrightarrow> \n       snd (sp_cf S a c) j \\<noteq>  \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; a \\<in> carrier S;\n     a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S c;\n     snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; j \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> snd (sp_cf S a c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:sp_cf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Idomain S; a \\<in> carrier S;\n     a \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S c;\n     snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; j \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> snd c j \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac y = \"(snd c) j\" in Idomain.idom_tOp_nonzeros[of S a], \n       assumption+,\n       simp add:pol_coeff_def, simp add:Pi_def, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ext_cf_inductTl:\"pol_coeff S (Suc n, f) \\<Longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (Suc n, f)) = \n                      polyn_expr R X (n + j) (ext_cf S j (n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (Suc n, f) \\<Longrightarrow>\n    polyn_expr R X (n + j) (ext_cf S j (Suc n, f)) =\n    polyn_expr R X (n + j) (ext_cf S j (n, f))", "apply (frule pol_coeff_pre[of n f],\n       frule ext_cf_pol_coeff[of \"(Suc n, f)\" j],\n       frule ext_cf_pol_coeff[of \"(n, f)\" j],\n       rule polyn_exprs_eq[of \"ext_cf S j (Suc n, f)\" \"ext_cf S j (n, f)\" \n         \"n + j\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (Suc n, f); pol_coeff S (n, f);\n     pol_coeff S (ext_cf S j (Suc n, f));\n     pol_coeff S (ext_cf S j (n, f))\\<rbrakk>\n    \\<Longrightarrow> n + j\n                      \\<le> min (fst (ext_cf S j (Suc n, f)))\n                             (fst (ext_cf S j (n, f)))\n 2. \\<lbrakk>pol_coeff S (Suc n, f); pol_coeff S (n, f);\n     pol_coeff S (ext_cf S j (Suc n, f));\n     pol_coeff S (ext_cf S j (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>n + j.\n                         snd (ext_cf S j (Suc n, f)) ja =\n                         snd (ext_cf S j (n, f)) ja", "apply (simp add:ext_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (Suc n, f); pol_coeff S (n, f);\n     pol_coeff S (ext_cf S j (Suc n, f));\n     pol_coeff S (ext_cf S j (n, f))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>ja\\<le>n + j.\n                         snd (ext_cf S j (Suc n, f)) ja =\n                         snd (ext_cf S j (n, f)) ja", "apply (rule allI, (subst ext_cf_def)+, simp add:sliden_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) low_deg_terms_zeroTr:\" \n     pol_coeff S (n, f) \\<longrightarrow>\n     polyn_expr R X (n + j) (ext_cf S j (n, f)) = \n                     (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X n (n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (n, f) \\<longrightarrow>\n    polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n    X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f)", "apply (cut_tac ring_is_ag,\n       cut_tac X_mem_R, frule npClose[of \"X\" \"j\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, f) \\<longrightarrow>\n                      polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X n (n, f)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (0, f) \\<longrightarrow>\n                      polyn_expr R X (0 + j) (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X j (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (case_tac \"j = 0\", simp add:ext_cf_def sliden_def polyn_expr_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     pol_coeff S (0, f); j = 0\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<cdot>\\<^sub>r 1\\<^sub>r =\n                      1\\<^sub>r \\<cdot>\\<^sub>r\n                      (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X j (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (frule_tac c = \"(0, f)\" and j = 0 in pol_coeff_mem_R, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     pol_coeff S (0, f); j = 0; f 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> f 0 \\<cdot>\\<^sub>r 1\\<^sub>r =\n                      1\\<^sub>r \\<cdot>\\<^sub>r\n                      (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X j (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (simp add:ring_r_one ring_l_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X j (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (cut_tac polyn_Suc[of \"j - Suc 0\" \"ext_cf S j (0, f)\"],\n        simp del:npow_suc)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f); 0 < j;\n     polyn_expr R X j (j, snd (ext_cf S j (0, f))) =\n     polyn_expr R X (j - Suc 0) (ext_cf S j (0, f)) \\<plusminus>\n     snd (ext_cf S j (0, f)) j \\<cdot>\\<^sub>r\n     X^\\<^bsup>R j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X j (ext_cf S j (0, f)) =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Suc (j - Suc 0) \\<le> fst (ext_cf S j (0, f))\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (frule ext_cf_len[of \"(0, f)\" j],\n        cut_tac polyn_expr_split[of j \"ext_cf S j (0, f)\"], simp,\n        thin_tac \"polyn_expr R X j (ext_cf S j (0, f)) =\n        polyn_expr R X (j - Suc 0) (ext_cf S j (0, f)) \\<plusminus>\n        snd (ext_cf S j (0, f)) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f); 0 < j;\n     polyn_expr R X j (j, snd (ext_cf S j (0, f))) =\n     polyn_expr R X (j - Suc 0) (ext_cf S j (0, f)) \\<plusminus>\n     snd (ext_cf S j (0, f)) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>;\n     fst (ext_cf S j (0, f)) = j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (j - Suc 0)\n                       (ext_cf S j (0, f)) \\<plusminus>\n                      snd (ext_cf S j (0, f)) j \\<cdot>\\<^sub>r\n                      X^\\<^bsup>R j\\<^esup> =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      polyn_expr R X 0 (0, f)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Suc (j - Suc 0) \\<le> fst (ext_cf S j (0, f))\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (simp add:polyn_ext_cf_lo_zero[of \"(0, f)\" j],\n        thin_tac \"polyn_expr R X j (j, snd (ext_cf S j (0, f))) =\n        \\<zero> \\<plusminus> snd (ext_cf S j (0, f)) j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\",\n        frule ext_cf_hi[THEN sym, of \"(0, f)\" j], simp add:polyn_expr_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f); 0 < j;\n     fst (ext_cf S j (0, f)) = j; snd (ext_cf S j (0, f)) j = f 0\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<plusminus>\n                      f 0 \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Suc (j - Suc 0) \\<le> fst (ext_cf S j (0, f))\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (frule_tac c = \"(0, f)\" and j = 0 in pol_coeff_mem_R, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f); 0 < j;\n     fst (ext_cf S j (0, f)) = j; snd (ext_cf S j (0, f)) j = f 0;\n     f 0 \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<plusminus>\n                      f 0 \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                      X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                      (f 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Suc (j - Suc 0) \\<le> fst (ext_cf S j (0, f))\n 3. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (subst aGroup.ag_l_zero, assumption, simp add:ring_tOp_closed,\n         simp add:ring_r_one, subst ring_tOp_commute, assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup R; X \\<in> carrier R;\n     X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (0, f);\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> Suc (j - Suc 0) \\<le> fst (ext_cf S j (0, f))\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (simp add:ext_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n        polyn_expr R X n (n, f)\\<rbrakk>\n       \\<Longrightarrow> pol_coeff S (Suc n, f) \\<longrightarrow>\n                         polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)", "apply (rule impI,\n       cut_tac subring,\n       cut_tac subring_Ring[of S],\n       frule_tac n = n in pol_coeff_pre[of _ \"f\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S; Ring S;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc n + j)\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S; Ring S;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc (n + j))\n                          (ext_cf S j (Suc n, f)) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (subst polyn_expr_split)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S; Ring S;\n        pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc (n + j))\n                          (fst (ext_cf S j (Suc n, f)),\n                           snd (ext_cf S j (Suc n, f))) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (cut_tac n = \"n + j\" and c = \"ext_cf S j (Suc n, f)\" in polyn_Suc,\n        simp add:ext_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S; Ring S; pol_coeff S (n, f);\n        polyn_expr R X (Suc (n + j))\n         (Suc (n + j), snd (ext_cf S j (Suc n, f))) =\n        polyn_expr R X (n + j) (ext_cf S j (Suc n, f)) \\<plusminus>\n        snd (ext_cf S j (Suc n, f)) (Suc (n + j)) \\<cdot>\\<^sub>r\n        X^\\<^bsup>R Suc (n + j)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> polyn_expr R X (Suc (n + j))\n                          (fst (ext_cf S j (Suc n, f)),\n                           snd (ext_cf S j (Suc n, f))) =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (subst ext_cf_len, assumption+, simp del:npow_suc add:add.commute[of j],\n       thin_tac \"polyn_expr R X (Suc (n + j))\n          (Suc (n + j), snd (ext_cf S j (Suc n, f))) =\n         polyn_expr R X (n + j) (ext_cf S j (Suc n, f)) \\<plusminus>\n         snd (ext_cf S j (Suc n, f)) (Suc (n + j)) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc (n + j))\\<^esup>\",\n        subst ext_cf_inductTl, assumption+, simp del:npow_suc,\n        thin_tac \"polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (Suc n, f);\n        Subring R S; Ring S; pol_coeff S (n, f)\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         snd (ext_cf S j (Suc n, f))\n                          (Suc (n + j)) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup> =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (cut_tac c1 = \"(Suc n, f)\" and n1 = j in ext_cf_hi[THEN sym], \n        assumption+, \n        simp del:npow_suc add:add.commute[of j])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (Suc n, f);\n        Subring R S; Ring S; pol_coeff S (n, f);\n        snd (ext_cf S j (Suc n, f)) (Suc (n + j)) = f (Suc n)\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup> =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X (Suc n) (Suc n, f)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (cut_tac n = n and c = \"(Suc n, f)\" in polyn_Suc, simp,\n        simp del:npow_suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (Suc n, f);\n        Subring R S; Ring S; pol_coeff S (n, f);\n        snd (ext_cf S j (Suc n, f)) (Suc (n + j)) = f (Suc n);\n        polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X n (Suc n, f) \\<plusminus>\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup> =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         (polyn_expr R X n (Suc n, f) \\<plusminus>\n                          f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (frule_tac c = \"(Suc n, f)\" and k = n in polyn_mem, simp,\n        frule_tac c = \"(Suc n, f)\" and j = \"Suc n\" in pol_coeff_mem_R, simp,\n        simp del:npow_suc,\n        frule_tac x = \"f (Suc n)\" and y = \"X^\\<^bsup>R (Suc n)\\<^esup>\" in ring_tOp_closed,\n        rule npClose, assumption,\n        subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (Suc n, f);\n        Subring R S; Ring S; pol_coeff S (n, f);\n        snd (ext_cf S j (Suc n, f)) (Suc (n + j)) = f (Suc n);\n        polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X n (Suc n, f) \\<plusminus>\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>;\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup> =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (Suc n, f) \\<plusminus>\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         (f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (subst polyn_expr_restrict, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R; pol_coeff S (Suc n, f);\n        Subring R S; Ring S; pol_coeff S (n, f);\n        snd (ext_cf S j (Suc n, f)) (Suc (n + j)) = f (Suc n);\n        polyn_expr R X (Suc n) (Suc n, f) =\n        polyn_expr R X n (Suc n, f) \\<plusminus>\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>;\n        polyn_expr R X n (Suc n, f) \\<in> carrier R;\n        f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc n\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         f (Suc n) \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R Suc (n + j)\\<^esup> =\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         polyn_expr R X n (n, f) \\<plusminus>\n                         X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r\n                         (f (Suc n) \\<cdot>\\<^sub>r\n                          X^\\<^bsup>R Suc n\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply (rule_tac a = \"f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc (n + j))\\<^esup> \" and \n             b = \"X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r (f (Suc n) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc n)\\<^esup>)\" and \n             c = \"X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f)\" in aGroup.ag_pOp_add_l,\n        assumption+,\n        rule ring_tOp_closed, assumption+, rule npClose, assumption,\n        (rule ring_tOp_closed, assumption+)+,\n        simp add:polyn_mem,\n        frule_tac n = \"Suc n\" in npClose[of X],\n        subst ring_tOp_assoc[THEN sym], assumption+,\n        subst ring_tOp_commute[of \"X^\\<^bsup>R j\\<^esup>\"], assumption,\n               simp add:pol_coeff_mem,\n        subst ring_tOp_assoc, assumption+,\n        subst npMulDistr[of X], assumption, simp add:add.commute[of j])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R; X \\<in> carrier R;\n        X^\\<^bsup>R j\\<^esup> \\<in> carrier R;\n        pol_coeff S (n, f) \\<longrightarrow>\n        polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n        X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f);\n        pol_coeff S (Suc n, f); Subring R S\\<rbrakk>\n       \\<Longrightarrow> Subring R S", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) low_deg_terms_zero:\"pol_coeff S (n, f) \\<Longrightarrow> \n  polyn_expr R X (n + j) (ext_cf S j (n, f)) = \n                            (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X n (n, f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (n, f) \\<Longrightarrow>\n    polyn_expr R X (n + j) (ext_cf S j (n, f)) =\n    X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X n (n, f)", "by (simp add:low_deg_terms_zeroTr)"], ["", "lemma (in PolynRg) low_deg_terms_zero1:\"pol_coeff S c \\<Longrightarrow> \n  polyn_expr R X ((fst c) + j) (ext_cf S j c) = \n                            (X^\\<^bsup>R j\\<^esup>) \\<cdot>\\<^sub>r (polyn_expr R X (fst c) c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    polyn_expr R X (fst c + j) (ext_cf S j c) =\n    X^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r polyn_expr R X (fst c) c", "by (cases c) (simp add: low_deg_terms_zeroTr)"], ["", "lemma (in PolynRg) polyn_expr_tOpTr:\"pol_coeff S (n, f) \\<Longrightarrow> \n      \\<forall>g. (pol_coeff S (m, g) \\<longrightarrow> (\\<exists>h. pol_coeff S ((n + m), h) \\<and>\n           h (n + m) = (f n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (g m) \\<and>\n  (polyn_expr R X (n + m) (n + m, h) = \n          (polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g)))))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S (n, f) \\<Longrightarrow>\n    \\<forall>g.\n       pol_coeff S (m, g) \\<longrightarrow>\n       (\\<exists>h.\n           pol_coeff S (n + m, h) \\<and>\n           h (n + m) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g m \\<and>\n           polyn_expr R X (n + m) (n + m, h) =\n           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X m (m, g))", "apply (cut_tac subring,\n       cut_tac X_mem_R,\n       frule subring_Ring[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (m, g) \\<longrightarrow>\n                         (\\<exists>h.\n                             pol_coeff S (n + m, h) \\<and>\n                             h (n + m) =\n                             f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g m \\<and>\n                             polyn_expr R X (n + m) (n + m, h) =\n                             polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                             polyn_expr R X m (m, g))", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<forall>g.\n                         pol_coeff S (0, g) \\<longrightarrow>\n                         (\\<exists>h.\n                             pol_coeff S (n + 0, h) \\<and>\n                             h (n + 0) =\n                             f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                             polyn_expr R X (n + 0) (n + 0, h) =\n                             polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                             polyn_expr R X 0 (0, g))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (rule allI, rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            polyn_expr R X 0 (0, g)\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (simp add:polyn_expr_def [of R X 0])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (frule_tac c = \"(0,g)\" in pol_coeff_mem[of _ 0], simp, simp,\n        frule_tac c = \"(0,g)\" in pol_coeff_mem_R[of _ 0], simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S;\n        g 0 \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g 0 \\<cdot>\\<^sub>r 1\\<^sub>r)\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (simp add:ring_r_one,\n        frule_tac c = \"(n, f)\" and k = n in polyn_mem, simp,\n        simp only:ring_tOp_commute[of \"polyn_expr R X n (n, f)\"],\n        subst scalar_times_pol_expr, assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S; g 0 \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (sp_cf S (g 0) (n, f))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (cut_tac f = \"sp_cf S (g 0) (n, f)\" in pol_coeff_split)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S; g 0 \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        pol_coeff S (sp_cf S (g 0) (n, f)) =\n        pol_coeff S\n         (fst (sp_cf S (g 0) (n, f)), snd (sp_cf S (g 0) (n, f)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (sp_cf S (g 0) (n, f))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (simp add:sp_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S; g 0 \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        pol_coeff S (sp_cf S (g 0) (n, f)) =\n        pol_coeff S (n, snd (sp_cf S (g 0) (n, f)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n, h) \\<and>\n                            h n =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0 \\<and>\n                            polyn_expr R X n (n, h) =\n                            polyn_expr R X n (sp_cf S (g 0) (n, f))\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (cut_tac f = \"sp_cf S (g 0) (n, f)\" in polyn_expr_split[of n],\n        simp only:sp_cf_len, simp only:fst_conv,\n        frule_tac a = \"g 0\" in sp_cf_pol_coeff[of \"(n, f)\"], assumption+,\n        simp,\n        subgoal_tac \"snd (sp_cf S (g 0) (n, f)) n = (f n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (g 0)\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S; g 0 \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        pol_coeff S (n, snd (sp_cf S (g 0) (n, f)));\n        polyn_expr R X n (sp_cf S (g 0) (n, f)) =\n        polyn_expr R X n (n, snd (sp_cf S (g 0) (n, f)));\n        pol_coeff S (sp_cf S (g 0) (n, f))\\<rbrakk>\n       \\<Longrightarrow> snd (sp_cf S (g 0) (n, f)) n =\n                         f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (thin_tac \"pol_coeff S (n, snd (sp_cf S (g 0) (n, f)))\",\n        thin_tac \"polyn_expr R X n (sp_cf S (g 0) (n, f)) =\n         polyn_expr R X n (n, snd (sp_cf S (g 0) (n, f)))\",\n        thin_tac \"pol_coeff S (sp_cf S (g 0) (n, f))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (0, g); g 0 \\<in> carrier S; g 0 \\<in> carrier R;\n        polyn_expr R X n (n, f) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> snd (sp_cf S (g 0) (n, f)) n =\n                         f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g 0\n 2. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (subst sp_cf_val[of \"(n, f)\" n], assumption+, simp, assumption, simp,\n        frule_tac c = \"(n,f)\" in pol_coeff_mem[of _ n], simp, simp,\n        simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g))\\<rbrakk>\n       \\<Longrightarrow> \\<forall>g.\n                            pol_coeff S (Suc na, g) \\<longrightarrow>\n                            (\\<exists>h.\n                                pol_coeff S (n + Suc na, h) \\<and>\n                                h (n + Suc na) =\n                                f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                                g (Suc na) \\<and>\n                                polyn_expr R X (n + Suc na)\n                                 (n + Suc na, h) =\n                                polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                                polyn_expr R X (Suc na) (Suc na, g))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        \\<forall>g.\n           pol_coeff S (na, g) \\<longrightarrow>\n           (\\<exists>h.\n               pol_coeff S (n + na, h) \\<and>\n               h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n               polyn_expr R X (n + na) (n + na, h) =\n               polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n               polyn_expr R X na (na, g));\n        pol_coeff S (Suc na, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n + Suc na, h) \\<and>\n                            h (n + Suc na) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (n + Suc na) (n + Suc na, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc na) (Suc na, g)", "apply (frule_tac n = na and f = g in pol_coeff_pre, \n       drule_tac a = g in forall_spec, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        \\<exists>h.\n           pol_coeff S (n + na, h) \\<and>\n           h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na \\<and>\n           polyn_expr R X (n + na) (n + na, h) =\n           polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n           polyn_expr R X na (na, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n + Suc na, h) \\<and>\n                            h (n + Suc na) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (n + Suc na) (n + Suc na, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc na) (Suc na, g)", "apply (erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        polyn_expr R X (n + na) (n + na, h) =\n        polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n        polyn_expr R X na (na, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (n + Suc na, h) \\<and>\n                            h (n + Suc na) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (n + Suc na) (n + Suc na, h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            polyn_expr R X (Suc na) (Suc na, g)", "apply (cut_tac n = na and c = \"(Suc na, g)\" in polyn_Suc, (simp del:npow_suc)+,\n       thin_tac \"polyn_expr R X (Suc na) (Suc na, g) =\n        polyn_expr R X na (Suc na, g) \\<plusminus> g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R (Suc na)\\<^esup>\",\n       subst polyn_expr_restrict, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        polyn_expr R X (n + na) (n + na, h) =\n        polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n        polyn_expr R X na (na, g)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (Suc (n + na), h) \\<and>\n                            h (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (polyn_expr R X na (na, g) \\<plusminus>\n                             g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (frule_tac c = \"(n, f)\" and k = n in polyn_mem,simp del:npow_suc,\n       frule_tac c = \"(na, g)\" and k = na in polyn_mem, simp del:npow_suc,\n       frule_tac c = \"(Suc na, g)\" in monomial_mem, simp del:npow_suc,\n       drule_tac a = \"Suc na\" in forall_spec, simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        polyn_expr R X (n + na) (n + na, h) =\n        polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X na (na, g);\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (Suc (n + na), h) \\<and>\n                            h (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (polyn_expr R X na (na, g) \\<plusminus>\n                             g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        polyn_expr R X (n + na) (n + na, h) =\n        polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X na (na, g);\n        polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            pol_coeff S (Suc (n + na), h) \\<and>\n                            h (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), h) =\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            polyn_expr R X na (na, g) \\<plusminus>\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (rotate_tac 8, drule sym,\n       simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X na (na, g) =\n        polyn_expr R X (n + na) (n + na, h)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (thin_tac \"polyn_expr R X n (n, f) \\<cdot>\\<^sub>r polyn_expr R X na (na, g) =\n        polyn_expr R X (n + na) (n + na, h)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (frule_tac c = \"(Suc na, g)\" and j =\"Suc na\" in pol_coeff_mem_R, simp,\n       simp del:npow_suc,\n       frule_tac c = \"(Suc na, g)\" and j =\"Suc na\" in pol_coeff_mem, simp,\n       simp del:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                            (g (Suc na) \\<cdot>\\<^sub>r\n                             X^\\<^bsup>R Suc na\\<^esup>)", "apply (subst ring_tOp_commute, assumption+,\n       subst ring_tOp_assoc, assumption+, rule npClose, assumption+,\n       subst low_deg_terms_zero[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            g (Suc na) \\<cdot>\\<^sub>r\n                            polyn_expr R X (n + Suc na)\n                             (ext_cf S (Suc na) (n, f))", "apply (frule_tac c = \"(n, f)\" and n = \"Suc na\" in ext_cf_pol_coeff)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S;\n        pol_coeff S (ext_cf S (Suc na) (n, f))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            g (Suc na) \\<cdot>\\<^sub>r\n                            polyn_expr R X (n + Suc na)\n                             (ext_cf S (Suc na) (n, f))", "apply (frule_tac c = \"ext_cf S (Suc na) (n, f)\" and a = \"g (Suc na)\" in \n       sp_cf_pol_coeff, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r X^\\<^bsup>R Suc na\\<^esup>\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S;\n        pol_coeff S (ext_cf S (Suc na) (n, f));\n        pol_coeff S\n         (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            g (Suc na) \\<cdot>\\<^sub>r\n                            polyn_expr R X (n + Suc na)\n                             (ext_cf S (Suc na) (n, f))", "apply (subst scalar_times_pol_expr, assumption+,\n       simp add:ext_cf_len,\n       cut_tac k = \"n + Suc na\" and \n        f = \"sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))\" in \n        polyn_expr_split,\n       simp only:sp_cf_len,\n       thin_tac \"polyn_expr R X (n + Suc na)\n         (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))) =\n        polyn_expr R X (n + Suc na)\n         (fst (ext_cf S (Suc na) (n, f)),\n          snd (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))))\",\n       simp only:ext_cf_len, simp only:fst_conv,\n       simp add:add.commute[of _ n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S;\n        pol_coeff S (ext_cf S (Suc na) (n, f));\n        pol_coeff S\n         (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (n + na) (n + na, h) \\<plusminus>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na),\n                              snd (sp_cf S (g (Suc na))\n                                    (ext_cf S (Suc na) (n, f))))", "apply (subst polyn_add, assumption+,\n       cut_tac f = \"sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))\" in \n       pol_coeff_split, simp only:sp_cf_len, simp only:ext_cf_len,\n       simp add:add.commute[of _ n], simp add: max_def,\n       frule_tac c = \"sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))\"\n              in pol_coeff_cartesian,\n       simp only:sp_cf_len, simp only:ext_cf_len, \n               simp add:add.commute[of _ n],\n       thin_tac \"(Suc (n + na),\n         snd (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))) =\n        sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))\",\n       frule_tac c = \"(n + na, h)\" and \n               d = \"sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))\" in \n               add_cf_pol_coeff, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S;\n        pol_coeff S (ext_cf S (Suc na) (n, f));\n        pol_coeff S (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)));\n        pol_coeff S\n         (add_cf S (n + na, h)\n           (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha.\n                            pol_coeff S (Suc (n + na), ha) \\<and>\n                            ha (Suc (n + na)) =\n                            f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                            g (Suc na) \\<and>\n                            polyn_expr R X (Suc (n + na))\n                             (Suc (n + na), ha) =\n                            polyn_expr R X (Suc (n + na))\n                             (add_cf S (n + na, h)\n                               (sp_cf S (g (Suc na))\n                                 (ext_cf S (Suc na) (n, f))))", "apply (cut_tac k = \"Suc (n + na)\" and f = \"add_cf S (n + na, h)\n       (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))\" in polyn_expr_split,\n       simp only:mp,\n       thin_tac \"polyn_expr R X (Suc (n + na))\n         (add_cf S (n + na, h)\n           (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))) =\n        polyn_expr R X (Suc (n + na))\n         (fst (add_cf S (n + na, h)\n                (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))),\n          snd (add_cf S (n + na, h)\n                (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))))\",\n       subst add_cf_len, assumption+,\n       simp add:sp_cf_len, simp add:ext_cf_len max_def,\n       cut_tac f = \"add_cf S (n + na, h)\n           (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))\" in \n            pol_coeff_split,\n       simp only:add_cf_len,\n             simp only:sp_cf_len, simp add:ext_cf_len, simp add:max_def,\n       thin_tac \"pol_coeff S\n         (add_cf S (n + na, h)\n           (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f))))\",\n       subgoal_tac \"snd (add_cf S (n + na, h) (sp_cf S (g (Suc na)) \n       (ext_cf S (Suc na) (n, f)))) (Suc (n + na)) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g (Suc na)\",\n       simp add:add.commute[of _ n], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na g h.\n       \\<lbrakk>polyn_expr R X n (n, f) \\<in> carrier R;\n        polyn_expr R X na (na, g) \\<in> carrier R;\n        g (Suc na) \\<cdot>\\<^sub>r\n        (X^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r X)\n        \\<in> carrier R;\n        pol_coeff S (n, f); Subring R S; X \\<in> carrier R; Ring S;\n        pol_coeff S (Suc na, g); pol_coeff S (na, g);\n        pol_coeff S (n + na, h);\n        h (n + na) = f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g na;\n        g (Suc na) \\<in> carrier R; g (Suc na) \\<in> carrier S;\n        pol_coeff S (ext_cf S (Suc na) (n, f));\n        pol_coeff S (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)));\n        pol_coeff S\n         (Suc (na + n),\n          snd (add_cf S (n + na, h)\n                (sp_cf S (g (Suc na)) (ext_cf S (Suc na) (n, f)))))\\<rbrakk>\n       \\<Longrightarrow> snd (add_cf S (n + na, h)\n                               (sp_cf S (g (Suc na))\n                                 (ext_cf S (Suc na) (n, f))))\n                          (Suc (n + na)) =\n                         f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g (Suc na)", "apply (subst add_cf_def, simp add:sp_cf_len ext_cf_len,\n        subst sp_cf_def, simp add:ext_cf_len,\n        subst ext_cf_def, simp add:sliden_def,\n        frule pol_coeff_mem[of \"(n, f)\" n], simp, \n        simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_expr_tOp:\"\\<lbrakk>\n  pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk> \\<Longrightarrow> \\<exists>e. pol_coeff S ((n + m), e) \\<and>\n  e (n + m) = (f n) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (g m) \\<and>\n  polyn_expr R X (n + m)(n + m, e) = \n           (polyn_expr R X n (n, f)) \\<cdot>\\<^sub>r (polyn_expr R X m (m, g))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S (n, f); pol_coeff S (m, g)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>e.\n                         pol_coeff S (n + m, e) \\<and>\n                         e (n + m) =\n                         f n \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> g m \\<and>\n                         polyn_expr R X (n + m) (n + m, e) =\n                         polyn_expr R X n (n, f) \\<cdot>\\<^sub>r\n                         polyn_expr R X m (m, g)", "by (simp add:polyn_expr_tOpTr)"], ["", "lemma (in PolynRg) polyn_expr_tOp_c:\"\\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk> \\<Longrightarrow>\n      \\<exists>e. pol_coeff S e \\<and> (fst e = fst c + fst d) \\<and>\n          (snd e) (fst e) = (snd c (fst c)) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub> (snd d) (fst d) \\<and>\n          polyn_expr R X (fst e) e =\n                  (polyn_expr R X (fst c) c) \\<cdot>\\<^sub>r (polyn_expr R X (fst d) d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d\\<rbrakk>\n    \\<Longrightarrow> \\<exists>e.\n                         pol_coeff S e \\<and>\n                         fst e = fst c + fst d \\<and>\n                         snd e (fst e) =\n                         snd c (fst c) \\<cdot>\\<^sub>r\\<^bsub>S\\<^esub>\n                         snd d (fst d) \\<and>\n                         polyn_expr R X (fst e) e =\n                         polyn_expr R X (fst c) c \\<cdot>\\<^sub>r\n                         polyn_expr R X (fst d) d", "by (cases c, cases d) (simp add: polyn_expr_tOpTr)"], ["", "section \"The degree of a polynomial\""], ["", "lemma (in PolynRg) polyn_degreeTr:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk> \\<Longrightarrow>\n       (polyn_expr R X k c = \\<zero> ) = ({j. j \\<le> k \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} = {})\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c = \\<zero>) =\n                      ({j. j \\<le> k \\<and>\n                           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                       {})", "apply (subst coeff_0_pol_0[THEN sym, of c k], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>k.\n                          snd c j = \\<zero>\\<^bsub>S\\<^esub>) =\n                      ({j. j \\<le> k \\<and>\n                           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                       {})", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) higher_part_zero:\"\\<lbrakk>pol_coeff S c; k < fst c;\n      \\<forall>j\\<in>nset (Suc k) (fst c). snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>   \n             \\<Sigma>\\<^sub>f R (\\<lambda>j. snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) (Suc k) (fst c) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k < fst c;\n     \\<forall>j\\<in>nset (Suc k) (fst c).\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc k fst c =\n                      \\<zero>", "apply (cut_tac ring_is_ag,\n       rule aGroup.fSum_zero1[of R k \"fst c\" \"\\<lambda>j. snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k < fst c;\n     \\<forall>j\\<in>nset (Suc k) (fst c).\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc k) (fst c).\n                         snd c j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup> =\n                         \\<zero>", "apply (rule ballI, \n       drule_tac x = j in bspec, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; k < fst c; aGroup R;\n        j \\<in> nset (Suc k) (fst c);\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>S\\<^esub> \\<cdot>\\<^sub>r\n                         X^\\<^bsup>R j\\<^esup> =\n                         \\<zero>", "apply (cut_tac subring, \n       simp add:Subring_zero_ring_zero,\n       cut_tac X_mem_R,\n       frule_tac n = j in npClose[of X],\n       simp add:ring_times_0_x)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_nonzero_polyn_nonzero:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c)\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c \\<noteq> \\<zero>) = (\\<exists>j\\<le>k. (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub> )\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X k c \\<noteq> \\<zero>) =\n                      (\\<exists>j\\<le>k.\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>)", "by (simp add:coeff_0_pol_0[THEN sym, of c k])"], ["", "lemma (in PolynRg) pol_expr_unique:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; \n      pol_coeff S c; p = polyn_expr R X (fst c) c; (snd c) (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; \n      pol_coeff S d; p = polyn_expr R X (fst d) d; (snd d) (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n      (fst c) = (fst d) \\<and> (\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     p = polyn_expr R X (fst c) c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     p = polyn_expr R X (fst d) d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (cut_tac ring_is_ag, \n       cut_tac subring, frule subring_Ring,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     p = polyn_expr R X (fst c) c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     p = polyn_expr R X (fst d) d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (frule m_cf_pol_coeff[of d])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     p = polyn_expr R X (fst c) c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     p = polyn_expr R X (fst d) d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (frule polyn_minus_m_cf[of d \"fst d\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     p = polyn_expr R X (fst c) c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     p = polyn_expr R X (fst d) d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     -\\<^sub>a polyn_expr R X (fst d) d =\n     polyn_expr R X (fst d) (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (drule sym, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     -\\<^sub>a p = polyn_expr R X (fst d) (m_cf S d);\n     polyn_expr R X (fst c) c = p; polyn_expr R X (fst d) d = p\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (rotate_tac -2, drule sym, drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     -\\<^sub>a p = polyn_expr R X (fst d) (m_cf S d);\n     p = polyn_expr R X (fst c) c; p = polyn_expr R X (fst d) d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (frule_tac x = p in aGroup.ag_r_inv1[of R], assumption, simp,\n        thin_tac \"p = polyn_expr R X (fst c) c\",\n        thin_tac \"polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\",\n        thin_tac \"-\\<^sub>a (polyn_expr R X (fst c) c) = \n                                    polyn_expr R X (fst d) (m_cf S d)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     polyn_expr R X (fst c) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (frule polyn_add1[of c \"m_cf S d\"], assumption+, simp add:m_cf_len,\n        thin_tac \"polyn_expr R X (fst c) c \\<plusminus> polyn_expr R X (fst d) (m_cf S d)\n           = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d))\",\n        thin_tac \"polyn_expr R X (fst c) c \\<noteq>\n           polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> =\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (frule_tac add_cf_pol_coeff[of c \"m_cf S d\"], simp add:m_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (cut_tac coeff_0_pol_0[THEN sym, of \"add_cf S c (m_cf S d)\" \n                  \"max (fst c) (fst d)\"],\n        drule sym, simp,\n        thin_tac \"polyn_expr R X (max (fst c) (fst d)) \n                                         (add_cf S c (m_cf S d)) = \\<zero>\",\n        thin_tac \"pol_coeff S (add_cf S c (m_cf S d))\",\n        thin_tac \"pol_coeff S (m_cf S d)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"fst c = fst d\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>fst d.\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c = fst d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst d. snd c j = snd d j\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (rule allI, rule impI, \n           drule_tac a = j in forall_spec, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n        snd c (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n        snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R;\n        Subring R S; Ring S; aGroup S; fst c = fst d; j \\<le> fst d;\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:add_cf_def m_cf_def m_cf_len)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n        snd c (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n        snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R;\n        Subring R S; Ring S; aGroup S; fst c = fst d; j \\<le> fst d;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (frule_tac j = j in pol_coeff_mem[of c], simp,\n            frule_tac j = j in  pol_coeff_mem[of d], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n        snd c (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n        snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R;\n        Subring R S; Ring S; aGroup S; fst c = fst d; j \\<le> fst d;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd c j \\<in> carrier S; snd d j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (subst aGroup.ag_eq_diffzero[of S], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> fst c = fst d \\<and>\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:add_cf_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"\\<not> (fst c) \\<le> (fst d)\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d; \\<not> \\<not> fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:m_cf_len)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        (if j \\<le> fst d\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub> snd (m_cf S d) j\n         else snd c j) =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d; \\<not> \\<not> fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (drule_tac a = \"fst c\" in forall_spec, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d; \\<not> \\<not> fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (if fst c < fst (m_cf S d)\n             then (fst (m_cf S d),\n                   \\<lambda>j.\n                      if j \\<le> fst c\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j\n                      else snd (m_cf S d) j)\n             else if fst c = fst (m_cf S d)\n                  then (fst c,\n                        \\<lambda>j.\n                           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (m_cf S d) j)\n                  else (fst c,\n                        \\<lambda>j.\n                           if j \\<le> fst (m_cf S d)\n                           then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                                snd (m_cf S d) j\n                           else snd c j))\n         j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n     fst c \\<noteq> fst d; fst c \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (drule_tac a = \"fst d\" in forall_spec, simp, simp add:m_cf_len)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"fst c \\<noteq> fst d\", \n        frule noteq_le_less[of \"fst c\" \"fst d\"], assumption, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c < fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:m_cf_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd d (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c < fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (frule pol_coeff_mem[of d \"fst d\"], simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd d (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c < fst d; snd d (fst d) \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (frule Ring.ring_is_ag[of S], \n               frule aGroup.ag_inv_inv[of S \"snd d (fst d)\"], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S;\n     -\\<^sub>a\\<^bsub>S\\<^esub> snd d (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     fst c < fst d; snd d (fst d) \\<in> carrier S; aGroup S;\n     -\\<^sub>a\\<^bsub>S\\<^esub> (-\\<^sub>a\\<^bsub>S\\<^esub> snd d (fst d)) =\n     snd d (fst d)\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; fst c \\<noteq> fst d; fst c \\<le> fst d;\n     snd (m_cf S d) (fst d) = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<not> fst c \\<noteq> fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 2. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     snd c (fst c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S d;\n     snd d (fst d) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; aGroup R; Subring R S;\n     Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> max (fst c) (fst d) \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:add_cf_len m_cf_len)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_expr_unique2:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n      fst c = fst d\\<rbrakk> \\<Longrightarrow>\n  (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d ) =\n      (\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X (fst c) c =\n                       polyn_expr R X (fst d) d) =\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (cut_tac ring_is_ag, \n       cut_tac subring, frule subring_Ring,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X (fst c) c =\n                       polyn_expr R X (fst d) d) =\n                      (\\<forall>j\\<le>fst c. snd c j = snd d j)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule m_cf_pol_coeff[of d])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule polyn_mem[of c \"fst c\"], simp,\n        frule polyn_mem[of d \"fst d\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d); polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule aGroup.ag_eq_diffzero[of R \"polyn_expr R X (fst c) c\" \n                   \"polyn_expr R X (fst d) d\"], assumption+,\n        simp,\n        simp only:polyn_minus_m_cf[of d \"fst d\"],\n        drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst c) c = polyn_expr R X (fst c) d;\n     pol_coeff S (m_cf S d); polyn_expr R X (fst c) d \\<in> carrier R;\n     polyn_expr R X (fst c) d \\<plusminus>\n     polyn_expr R X (fst c) (m_cf S d) =\n     \\<zero>;\n     fst d = fst c\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule polyn_add1[of c \"m_cf S d\"], assumption+, simp add:m_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst c) c = polyn_expr R X (fst c) d;\n     pol_coeff S (m_cf S d); polyn_expr R X (fst c) d \\<in> carrier R;\n     polyn_expr R X (fst c) d \\<plusminus>\n     polyn_expr R X (fst c) (m_cf S d) =\n     polyn_expr R X (fst c) (add_cf S c (m_cf S d));\n     fst d = fst c;\n     \\<zero> = polyn_expr R X (fst c) (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (thin_tac \"polyn_expr R X (fst c) d \\<plusminus> polyn_expr R X (fst c) \n         (m_cf S d) =\n         polyn_expr R X (fst c) (add_cf S c (m_cf S d))\",\n        thin_tac \"polyn_expr R X (fst c) c = polyn_expr R X (fst c) d\",\n        thin_tac \"polyn_expr R X (fst c) d \\<in> carrier R\",\n        drule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (fst c) (add_cf S c (m_cf S d));\n     fst c = fst d\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule_tac add_cf_pol_coeff[of c \"m_cf S d\"], simp add:m_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; pol_coeff S (m_cf S d);\n     \\<zero> = polyn_expr R X (fst c) (add_cf S c (m_cf S d));\n     fst c = fst d; pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule coeff_0_pol_0[THEN sym, of \"add_cf S c (m_cf S d)\" \n                \"fst c\"],\n        simp add:add_cf_len, simp add:m_cf_len,\n        thin_tac \"\\<zero> = polyn_expr R X (fst d) (add_cf S c (m_cf S d))\",\n        thin_tac \"pol_coeff S (add_cf S c (m_cf S d))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; pol_coeff S (m_cf S d); fst c = fst d;\n     \\<forall>j\\<le>fst d.\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst d. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (simp add:add_cf_def m_cf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     fst c = fst d;\n     \\<forall>j\\<le>fst d.\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst d. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        fst c = fst d;\n        \\<forall>j\\<le>fst d.\n           snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n           -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n           \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (drule_tac a = j in forall_spec, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        fst c = fst d; j \\<le> fst d;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule_tac j = j in pol_coeff_mem[of c], simp,\n         frule_tac j = j in pol_coeff_mem[of d], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        fst c = fst d; j \\<le> fst d;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd c j \\<in> carrier S; snd d j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (simp add:aGroup.ag_eq_diffzero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst c. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst d. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst d) c = polyn_expr R X (fst d) d", "apply (rule polyn_exprs_eq[of c d \"fst d\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst d. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> min (fst c) (fst d)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c = fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst d. snd c j = snd d j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst d. snd c j = snd d j", "apply (simp, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_expr_unique3:\"\\<lbrakk>pol_coeff S c; pol_coeff S d; \n      fst c < fst d\\<rbrakk> \\<Longrightarrow>\n  (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d ) =\n      ((\\<forall>j \\<le> (fst c). (snd c) j = (snd d) j) \\<and>\n                        (\\<forall>j\\<in>nset (Suc (fst c)) (fst d). (snd d) j = \\<zero>\\<^bsub>S\\<^esub>))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d\\<rbrakk>\n    \\<Longrightarrow> (polyn_expr R X (fst c) c =\n                       polyn_expr R X (fst d) d) =\n                      ((\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                       (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                           snd d j = \\<zero>\\<^bsub>S\\<^esub>))", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (cut_tac ring_is_ag, \n       cut_tac subring, frule subring_Ring,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule m_cf_pol_coeff[of d])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule polyn_mem[of c \"fst c\"], simp,\n        frule polyn_mem[of d \"fst d\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d);\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule aGroup.ag_eq_diffzero[of R \"polyn_expr R X (fst c) c\" \n                   \"polyn_expr R X (fst d) d\"], assumption+,\n        simp,\n        simp only:polyn_minus_m_cf[of d \"fst d\"],\n        drule sym, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     polyn_expr R X (fst c) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) =\n     \\<zero>;\n     aGroup R; Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d);\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule polyn_add1[of c \"m_cf S d\"], assumption+, simp add:m_cf_len,\n        thin_tac \"polyn_expr R X (fst c) c \\<plusminus> polyn_expr R X (fst d) \n         (m_cf S d) =\n         polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d))\",\n        thin_tac \"polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\",\n        thin_tac \"polyn_expr R X (fst c) c \\<in> carrier R\", drule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule_tac add_cf_pol_coeff[of c \"m_cf S d\"], simp add:m_cf_len)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule coeff_0_pol_0[THEN sym, of \"add_cf S c (m_cf S d)\" \n                \"max (fst c) (fst d)\"],\n        simp add:add_cf_len m_cf_len, simp,\n        thin_tac \"polyn_expr R X (max (fst c) (fst d)) \n                                          (add_cf S c (m_cf S d)) = \\<zero>\",\n        thin_tac \"pol_coeff S (add_cf S c (m_cf S d))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S; pol_coeff S (m_cf S d);\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (simp add:add_cf_def m_cf_def max_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n                      (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                          snd d j = \\<zero>\\<^bsub>S\\<^esub>)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                         snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (rule allI, rule impI,\n         frule_tac x = j and y = \"fst c\" and z = \"fst d\" in le_less_trans, \n         assumption+,\n         frule_tac x = j and y = \"fst d\" in less_imp_le)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n        Subring R S; Ring S; aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        \\<forall>j\\<le>fst d.\n           (if j \\<le> fst c\n            then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                 snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j\n            else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j) =\n           \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c; j < fst d; j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                         snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (drule_tac a = j in forall_spec, simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n        Subring R S; Ring S; aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        j \\<le> fst c;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                         snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule_tac j = j in pol_coeff_mem[of c], simp,\n         frule_tac j = j in pol_coeff_mem[of d], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n        Subring R S; Ring S; aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        j \\<le> fst c;\n        snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd c j \\<in> carrier S; snd d j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> snd c j = snd d j\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                         snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (simp add:aGroup.ag_eq_diffzero[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n     \\<forall>j\\<le>fst d.\n        (if j \\<le> fst c\n         then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n              snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j) j\n         else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n               j) =\n        \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n                         snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (rule ballI, simp add:nset_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        \\<forall>j\\<le>fst d.\n           (if j \\<le> fst c\n            then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                 snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j\n            else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j) =\n           \\<zero>\\<^bsub>S\\<^esub>;\n        Suc (fst c) \\<le> j; j \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (cut_tac x = \"fst c\" and y = \"Suc (fst c)\" and z = j in \n         less_le_trans, simp, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        \\<forall>j\\<le>fst d.\n           (if j \\<le> fst c\n            then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                 snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j\n            else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j) =\n           \\<zero>\\<^bsub>S\\<^esub>;\n        Suc (fst c) \\<le> j; j \\<le> fst d; fst c < j\\<rbrakk>\n       \\<Longrightarrow> snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (cut_tac m1 = \"fst c\" and n1 = j in nat_not_le_less[THEN sym], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        \\<forall>j\\<le>fst d.\n           (if j \\<le> fst c\n            then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                 snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j\n            else snd (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                  j) =\n           \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst d; \\<not> j \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (drule_tac a = j in forall_spec, assumption, simp,\n         frule_tac j = j in pol_coeff_mem[of d], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        pol_coeff S (fst d, \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j);\n        j \\<le> fst d; \\<not> j \\<le> fst c;\n        -\\<^sub>a\\<^bsub>S\\<^esub> snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n        snd d j \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> snd d j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (frule_tac x = \"snd d j\" in aGroup.ag_inv_inv[of S], assumption,\n         simp add:aGroup.ag_inv_inv aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d", "apply (cut_tac polyn_n_m[of d \"fst c\" \"fst d\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>);\n     polyn_expr R X (fst d) (fst d, snd d) =\n     polyn_expr R X (fst c) (fst c, snd d) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j.\n                            snd d j \\<cdot>\\<^sub>r\n                            X^\\<^bsup>R j\\<^esup>) Suc\n              (fst c) fst d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst c < fst d\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (subst polyn_expr_split[of \"fst d\" d], simp,\n        thin_tac \"polyn_expr R X (fst d) d =\n     polyn_expr R X (fst c) (fst c, snd d) \\<plusminus>\n     \\<Sigma>\\<^sub>f R (\\<lambda>j. snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) (Suc (fst c)) (fst d)\", erule conjE)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     \\<forall>j\\<le>fst c. snd c j = snd d j;\n     \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n        snd d j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c =\n                      polyn_expr R X (fst c) (fst c, snd d) \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd d j \\<cdot>\\<^sub>r X^\\<^bsup>R j\\<^esup>) Suc (fst c) fst d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst c < fst d\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (subst higher_part_zero[of d \"fst c\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     \\<forall>j\\<le>fst c. snd c j = snd d j;\n     \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n        snd d j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c =\n                      polyn_expr R X (fst c) (fst c, snd d) \\<plusminus>\n                      \\<zero>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst c < fst d\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (frule pol_coeff_le[of d \"fst c\"], simp add:less_imp_le,\n        frule polyn_mem[of \"(fst c, snd d)\" \"fst c\"], simp,\n        cut_tac ring_is_ag,\n        simp add:aGroup.ag_r_zero,\n        subst polyn_expr_short[THEN sym, of d \"fst c\"], assumption+,\n        simp add:less_imp_le)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     \\<forall>j\\<le>fst c. snd c j = snd d j;\n     \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n        snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (fst c, snd d);\n     polyn_expr R X (fst c) (fst c, snd d) \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c = polyn_expr R X (fst c) d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst c < fst d\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (rule polyn_exprs_eq[of c d \"fst c\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     \\<forall>j\\<le>fst c. snd c j = snd d j;\n     \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n        snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (fst c, snd d);\n     polyn_expr R X (fst c) (fst c, snd d) \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> fst c \\<le> min (fst c) (fst d)\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     \\<forall>j\\<le>fst c. snd c j = snd d j;\n     \\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n        snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (fst c, snd d);\n     polyn_expr R X (fst c) (fst c, snd d) \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>fst c. snd c j = snd d j\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst c < fst d\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (simp, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; fst c < fst d;\n     (\\<forall>j\\<le>fst c. snd c j = snd d j) \\<and>\n     (\\<forall>j\\<in>nset (Suc (fst c)) (fst d).\n         snd d j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d", "apply (simp add:less_imp_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_degree_unique:\"\\<lbrakk>pol_coeff S c; pol_coeff S d;\n      polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk> \\<Longrightarrow> \n      c_max S c = c_max S d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (cut_tac ring_is_ag,\n       cut_tac subring,\n       frule subring_Ring,\n       frule Ring.ring_is_ag[of S])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (case_tac \"polyn_expr R X (fst d) d = \\<zero>\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (cut_tac coeff_0_pol_0[THEN sym, of d \"fst d\"], simp,\n        cut_tac coeff_0_pol_0[THEN sym, of c \"fst c\"], simp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     \\<forall>j\\<le>fst c. snd c j = \\<zero>\\<^bsub>S\\<^esub>; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     \\<forall>j\\<le>fst d. snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = \\<zero>;\n     polyn_expr R X (fst c) c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = \\<zero>; aGroup R; Subring R S; Ring S;\n     aGroup S; \\<forall>j\\<le>fst d. snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = \\<zero>; aGroup R; Subring R S; Ring S;\n     aGroup S; \\<forall>j\\<le>fst d. snd d j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> fst c \\<le> fst c\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S d\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst d\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (simp add:c_max_def, assumption, simp, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (frule polyn_mem[of c \"fst c\"], simp, frule polyn_mem[of d \"fst d\"], \n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (frule aGroup.ag_eq_diffzero[of \"R\" \"polyn_expr R X (fst c) c\" \n               \"polyn_expr R X (fst d) d\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d; aGroup R;\n     Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d) =\n     (polyn_expr R X (fst c) c \\<plusminus>\n      -\\<^sub>a polyn_expr R X (fst d) d =\n      \\<zero>)\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (simp only:polyn_minus_m_cf[of d \"fst d\"],\n       frule m_cf_pol_coeff [of d])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) =\n     \\<zero>;\n     aGroup R; Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d) =\n     (\\<zero> = \\<zero>);\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (frule polyn_add1[of c \"m_cf S d\"], assumption+,\n       simp only:m_cf_len)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d;\n     polyn_expr R X (fst c) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) =\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     aGroup R; Subring R S; Ring S; aGroup S;\n     polyn_expr R X (fst d) d \\<noteq>\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d));\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     (polyn_expr R X (fst c) c = polyn_expr R X (fst d) d) =\n     (polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) =\n      polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)));\n     pol_coeff S (m_cf S d);\n     \\<zero> =\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (rotate_tac -1, drule sym, simp,\n       thin_tac \"polyn_expr R X (fst d) d \\<plusminus>\n                         polyn_expr R X (fst d) (m_cf S d) = \\<zero>\",\n       frule add_cf_pol_coeff[of c \"m_cf S d\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d", "apply (cut_tac coeff_0_pol_0[THEN sym, of \"add_cf S c (m_cf S d)\" \n                \"fst (add_cf S c (m_cf S d))\"],\n       simp add:add_cf_len m_cf_len,\n       thin_tac \"polyn_expr R X (max (fst c) (fst d)) \n                            (add_cf S c (m_cf S d)) = \\<zero>\",\n       thin_tac \"pol_coeff S (add_cf S c (m_cf S d))\",\n       thin_tac \"pol_coeff S (m_cf S d)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (frule coeff_nonzero_polyn_nonzero[of d \"fst d\"], simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (drule sym, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (frule coeff_nonzero_polyn_nonzero[of c \"fst c\"], simp, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> c_max S c = c_max S d\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:c_max_def, rule conjI, rule impI, blast,\n       rule conjI, rule impI, blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> n_max\n                       {j. j \\<le> fst c \\<and>\n                           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                      n_max\n                       {j. j \\<le> fst d \\<and>\n                           snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (rule n_max_eq_sets)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                      {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (rule equalityI)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst d \\<and>\nsnd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n        x \\<le> fst c \\<and>\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (erule conjE)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"fst c \\<le> fst d\")"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        fst c \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst c \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 7. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (frule_tac i = x in le_trans[of _ \"fst c\" \"fst d\"], assumption+, simp,\n        rule contrapos_pp, simp+, simp add:max_def,\n        frule_tac i = x in le_trans[of _ \"fst c\" \"fst d\"], assumption+,\n        drule_tac a = x in forall_spec, assumption,\n        drule le_imp_less_or_eq[of \"fst c\" \"fst d\"],\n        erule disjE, simp add:add_cf_def m_cf_len m_cf_def,\n        frule_tac j = x in pol_coeff_mem[of c], assumption+,\n        simp add:aGroup.ag_inv_zero aGroup.ag_r_zero[of S])"], ["proof (prove)\ngoal (7 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        snd d x = \\<zero>\\<^bsub>S\\<^esub>; x \\<le> fst d;\n        snd (add_cf S c (m_cf S d)) x = \\<zero>\\<^bsub>S\\<^esub>;\n        fst c = fst d\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst c \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 7. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:add_cf_def m_cf_len m_cf_def,\n               rotate_tac -1, drule sym, simp,\n               frule_tac j = x in pol_coeff_mem[of c], simp,\n               simp add:aGroup.ag_inv_zero aGroup.ag_r_zero[of S])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst c \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:nat_not_le_less)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst d < fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "(* \\<not> fst c \\<le> fst d *)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst d < fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"\\<not> x \\<le> (fst d)\", simp,\n               simp add:nat_not_le_less,\n               frule_tac x = \"fst d\" and y = x and z = \"fst c\" in \n               less_le_trans, assumption+,\n               drule_tac x = x in spec, simp add:max_def,\n               simp add:add_cf_def m_cf_len m_cf_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst c;\n        snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst d < fst c;\n        \\<not> \\<not> x \\<le> fst d\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst d \\<and>\n                         snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp,\n               drule_tac x = x in spec, simp add:max_def,\n               rule contrapos_pp, simp+,\n               simp add:add_cf_def m_cf_len m_cf_def,\n               frule_tac j = x in pol_coeff_mem[of c],\n               frule_tac x = x and y = \"fst d\" and z = \"fst c\" in\n               le_less_trans, assumption+, simp add:less_imp_le,\n               simp add:aGroup.ag_inv_zero aGroup.ag_r_zero[of S])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst d \\<and>\n                          snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c \\<and>\nsnd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (rule subsetI, simp, erule conjE,\n        case_tac \"fst d \\<le> fst c\",\n        frule_tac i = x and j = \"fst d\" and k = \"fst c\" in le_trans,\n        assumption+, simp,\n        drule_tac x = x in spec, simp add:max_def,\n        rule contrapos_pp, simp+,\n        simp add:add_cf_def m_cf_len m_cf_def)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst d \\<le> fst c;\n        snd (if fst c = fst d\n             then (fst c,\n                   \\<lambda>j.\n                      snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                      snd (fst d,\n                           \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                       j)\n             else (fst c,\n                   \\<lambda>j.\n                      if j \\<le> fst (fst d,\n\\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (fst d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                            j\n                      else snd c j))\n         x =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd c x = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst d \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst c \\<and>\n                         snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (case_tac \"fst d = fst c\", simp, rotate_tac -1, drule sym, simp,\n          frule_tac j = x in pol_coeff_mem[of d], assumption,\n          frule_tac x = \"snd d x\" in aGroup.ag_mOp_closed, assumption+,\n          simp add:aGroup.ag_l_zero,\n          frule_tac x = \"snd d x\" in aGroup.ag_inv_inv[of S],\n                 assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst d \\<le> fst c;\n        snd (if fst c = fst d\n             then (fst c,\n                   \\<lambda>j.\n                      snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                      snd (fst d,\n                           \\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                       j)\n             else (fst c,\n                   \\<lambda>j.\n                      if j \\<le> fst (fst d,\n\\<lambda>j. -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                      then snd c j \\<plusminus>\\<^bsub>S\\<^esub>\n                           snd (fst d,\n                                \\<lambda>j.\n                                   -\\<^sub>a\\<^bsub>S\\<^esub> snd d j)\n                            j\n                      else snd c j))\n         x =\n        \\<zero>\\<^bsub>S\\<^esub>;\n        snd c x = \\<zero>\\<^bsub>S\\<^esub>; fst d \\<noteq> fst c\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst d \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst c \\<and>\n                         snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (drule noteq_le_less[of \"fst d\" \"fst c\"], assumption,\n          simp,\n          frule_tac j = x in pol_coeff_mem[of d], assumption,\n          frule_tac x = \"snd d x\" in aGroup.ag_mOp_closed, assumption+,\n          simp add:aGroup.ag_l_zero,\n          frule_tac x = \"snd d x\" in aGroup.ag_inv_inv[of S],\n                 assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        \\<not> fst d \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst c \\<and>\n                         snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:nat_not_le_less,\n          case_tac \"\\<not> x \\<le> fst c\", simp,\n          simp add:nat_not_le_less,\n          drule_tac x = x in spec, simp add:max_def,\n          simp add:add_cf_def m_cf_len m_cf_def,\n          frule_tac j = x in pol_coeff_mem[of d], assumption,\n          frule_tac x = \"snd d x\" in aGroup.ag_mOp_closed, assumption+,\n          simp add:aGroup.ag_l_zero,\n          frule_tac x = \"snd d x\" in aGroup.ag_inv_inv[of S],\n                 assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n        aGroup S;\n        \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst c) c \\<in> carrier R;\n        \\<forall>j\\<le>max (fst c) (fst d).\n           snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c \\<noteq> \\<zero>; x \\<le> fst d;\n        snd d x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; fst c < fst d;\n        \\<not> \\<not> x \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> x \\<le> fst c \\<and>\n                         snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 5. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp,\n          drule_tac x = x in spec, simp add:max_def,\n          rule contrapos_pp, simp+,\n          simp add:add_cf_def m_cf_len m_cf_def,\n          frule_tac x = x and y = \"fst c\" and z = \"fst d\" in le_less_trans,\n           assumption+, frule_tac x = x and y = \"fst d\" in less_imp_le,\n          frule_tac j = x in pol_coeff_mem[of d], assumption,\n          frule_tac x = \"snd d x\" in aGroup.ag_mOp_closed, assumption+,\n          simp add:aGroup.ag_l_zero,\n          frule_tac x = \"snd d x\" in aGroup.ag_inv_inv[of S],\n                 assumption, simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (thin_tac \"\\<forall>j\\<le>max (fst c) (fst d). snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (rotate_tac -1, drule sym, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply (simp add:coeff_0_pol_0[THEN sym, of c \"fst c\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S;\n     \\<exists>j\\<le>fst d. snd d j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst c) c \\<in> carrier R;\n     \\<forall>j\\<le>max (fst c) (fst d).\n        snd (add_cf S c (m_cf S d)) j = \\<zero>\\<^bsub>S\\<^esub>;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     polyn_expr R X (fst d) d = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n.\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> n}\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 2. \\<lbrakk>pol_coeff S c; pol_coeff S d; aGroup R; Subring R S; Ring S;\n     aGroup S; polyn_expr R X (fst d) d \\<noteq> \\<zero>;\n     polyn_expr R X (fst d) d \\<in> carrier R;\n     polyn_expr R X (fst c) c = polyn_expr R X (fst d) d;\n     pol_coeff S (m_cf S d);\n     polyn_expr R X (max (fst c) (fst d)) (add_cf S c (m_cf S d)) = \\<zero>;\n     pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst (add_cf S c (m_cf S d))\n                      \\<le> fst (add_cf S c (m_cf S d))", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) ex_polyn_expr:\"p \\<in> carrier R \\<Longrightarrow>\n         \\<exists>c. pol_coeff S c \\<and> p = polyn_expr R X (fst c) c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    \\<exists>c. pol_coeff S c \\<and> p = polyn_expr R X (fst c) c", "apply (cut_tac S_X_generate[of p], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> p \\<in> carrier R", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) c_max_eqTr0:\"\\<lbrakk>pol_coeff S c; k \\<le> (fst c);\n     polyn_expr R X k c = polyn_expr R X (fst c) c; \\<exists>j\\<le>k. (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n               c_max S (k, snd c) = c_max S c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = polyn_expr R X (fst c) c;\n     \\<exists>j\\<le>k. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> c_max S (k, snd c) = c_max S c", "apply (simp add:polyn_expr_short[of c k],\n       frule pol_coeff_le[of c k], assumption+,\n       rule polyn_degree_unique[of \"(k, snd c)\" c], assumption+,\n       simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  cf_sol :: \"[('a, 'b) Ring_scheme, ('a, 'b1) Ring_scheme, 'a, 'a,\n                nat \\<times> (nat \\<Rightarrow> 'a)] \\<Rightarrow> bool\" where\n \"cf_sol R S X p c \\<longleftrightarrow> pol_coeff S c \\<and> (p = polyn_expr R X (fst c) c)\""], ["", "definition\n  deg_n ::\"[('a, 'b) Ring_scheme, ('a, 'b1) Ring_scheme, 'a, 'a] \\<Rightarrow> nat\" where\n  \"deg_n R S X p = c_max S (SOME c. cf_sol R S X p c)\""], ["", "definition\n  deg ::\"[('a, 'b) Ring_scheme, ('a, 'b1) Ring_scheme, 'a, 'a] \\<Rightarrow> ant\" where\n  \"deg R S X p = (if p = \\<zero>\\<^bsub>R\\<^esub> then -\\<infinity> else (an (deg_n R S X p)))\""], ["", "lemma (in PolynRg) ex_cf_sol:\"p \\<in> carrier R \\<Longrightarrow>\n                                    \\<exists>c. cf_sol R S X p c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> \\<exists>c. cf_sol R S X p c", "apply (unfold cf_sol_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    \\<exists>c. pol_coeff S c \\<and> p = polyn_expr R X (fst c) c", "apply (frule ex_polyn_expr[of p], (erule exE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R;\n        pol_coeff S c \\<and> p = polyn_expr R X (fst c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>c.\n                            pol_coeff S c \\<and>\n                            p = polyn_expr R X (fst c) c", "apply (cut_tac n = \"fst c\" in le_refl, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_in_aug_minf:\"p \\<in> carrier R \\<Longrightarrow>\n                                   deg R S X p \\<in> Z\\<^sub>-\\<^sub>\\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    deg R S X p \\<in> Z\\<^sub>-\\<^sub>\\<infinity>", "apply (simp add:aug_minf_def deg_def an_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_noninf:\"p \\<in> carrier R \\<Longrightarrow>\n                                   deg R S X p \\<noteq> \\<infinity>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> deg R S X p \\<noteq> \\<infinity>", "apply (cut_tac deg_in_aug_minf[of p], simp add:deg_def,\n       simp add:aug_minf_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R;\n     (if p = \\<zero> then - \\<infinity> else an (deg_n R S X p)) \\<noteq>\n     \\<infinity>\\<rbrakk>\n    \\<Longrightarrow> p \\<noteq> \\<zero> \\<longrightarrow>\n                      an (deg_n R S X p) \\<noteq> \\<infinity>\n 2. p \\<in> carrier R \\<Longrightarrow> p \\<in> carrier R", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_ant_int:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n                  \\<Longrightarrow> deg R S X p = ant (int (deg_n R S X p))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X p = ant (int (deg_n R S X p))", "by (simp add:deg_def an_def)"], ["", "lemma (in PolynRg) deg_an:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n        \\<Longrightarrow> deg R S X p = an (deg_n R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg R S X p = an (deg_n R S X p)", "by (simp add:deg_def)"], ["", "lemma (in PolynRg) pol_SOME_1:\"p \\<in> carrier R  \\<Longrightarrow> \n             cf_sol R S X p (SOME f. cf_sol R S X p f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    cf_sol R S X p (SOME f. cf_sol R S X p f)", "apply (frule ex_cf_sol[of p])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; \\<exists>c. cf_sol R S X p c\\<rbrakk>\n    \\<Longrightarrow> cf_sol R S X p (SOME f. cf_sol R S X p f)", "apply (rule_tac P = \"cf_sol R S X p\" in someI_ex, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_SOME_2:\"p \\<in> carrier R \\<Longrightarrow>\n         pol_coeff S (SOME c. cf_sol R S X p c) \\<and>  \n           p = polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n                                      (SOME c. cf_sol R S X p c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow>\n    pol_coeff S (SOME c. cf_sol R S X p c) \\<and>\n    p =\n    polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n     (SOME c. cf_sol R S X p c)", "apply (frule pol_SOME_1[of p])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R;\n     cf_sol R S X p (SOME f. cf_sol R S X p f)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (SOME c. cf_sol R S X p c) \\<and>\n                      p =\n                      polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n                       (SOME c. cf_sol R S X p c)", "apply (simp add:cf_sol_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_max_zeroTr:\"pol_coeff S c \\<Longrightarrow>\n                   \\<forall>j. j \\<le> (fst c) \\<and> (c_max S c) < j \\<longrightarrow> (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    \\<forall>j.\n       j \\<le> fst c \\<and> c_max S c < j \\<longrightarrow>\n       snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (case_tac \"\\<forall>j \\<le> (fst c). (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\", rule allI, rule impI,\n       erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<not> (\\<forall>j\\<le>fst c.\n                snd c j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j.\n                         j \\<le> fst c \\<and>\n                         c_max S c < j \\<longrightarrow>\n                         snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j.\n                         j \\<le> fst c \\<and>\n                         c_max S c < j \\<longrightarrow>\n                         snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (frule coeff_nonzero_polyn_nonzero[THEN sym, of c \"fst c\"], simp,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; polyn_expr R X (fst c) c \\<noteq> \\<zero>;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j.\n                         j \\<le> fst c \\<and>\n                         c_max S c < j \\<longrightarrow>\n                         snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (rule allI, rule impI, erule conjE,\n       simp add:c_max_def,\n       simp add:polyn_degreeTr[of c \"fst c\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (subgoal_tac \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<subseteq> {j. j \\<le> (fst c)}\",\n       frule n_max[of \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\" \"fst c\"], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j;\n        {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        \\<subseteq> {j. j \\<le> fst c};\n        n_max\n         {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        \\<in> {j. j \\<le> fst c \\<and>\n                  snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<and>\n        (\\<forall>x\\<in>{j. j \\<le> fst c \\<and>\n                            snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}.\n            x \\<le> n_max\n                     {j. j \\<le> fst c \\<and>\n                         snd c j \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>})\\<rbrakk>\n       \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> fst c}", "apply (case_tac \"\\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> \", blast, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        n_max\n         {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        < j;\n        {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        \\<subseteq> {j. j \\<le> fst c};\n        snd c\n         (n_max\n           {j. j \\<le> fst c \\<and>\n               snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub> \\<and>\n        (\\<forall>x.\n            x \\<le> fst c \\<and>\n            snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub> \\<longrightarrow>\n            x \\<le> n_max\n                     {j. j \\<le> fst c \\<and>\n                         snd c j \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>})\\<rbrakk>\n       \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> fst c}", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        n_max\n         {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        < j;\n        {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        \\<subseteq> {j. j \\<le> fst c};\n        snd c\n         (n_max\n           {j. j \\<le> fst c \\<and>\n               snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}) \\<noteq>\n        \\<zero>\\<^bsub>S\\<^esub>;\n        \\<forall>x.\n           x \\<le> fst c \\<and>\n           snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub> \\<longrightarrow>\n           x \\<le> n_max\n                    {j. j \\<le> fst c \\<and>\n                        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> fst c}", "apply (rule contrapos_pp, simp+,\n       thin_tac \"\\<exists>x\\<le>fst c. snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n       thin_tac \"{j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<subseteq> {j. j \\<le> fst c}\",\n       thin_tac \"snd c (n_max {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n       drule_tac a = j in forall_spec, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c; j \\<le> fst c;\n        n_max\n         {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n        < j;\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> n_max\n                 {j. j \\<le> fst c \\<and>\n                     snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> fst c}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>pol_coeff S c;\n        \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n        j \\<le> fst c;\n        (if \\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n         else n_max\n               {j. j \\<le> fst c \\<and>\n                   snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\n        < j\\<rbrakk>\n       \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                         \\<subseteq> {j. j \\<le> fst c}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_max_nonzeroTr:\"\\<lbrakk>pol_coeff S c; \n       \\<exists>j \\<le> (fst c). (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow> (snd c) (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:c_max_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> snd c\n                       (n_max\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq>\n                             \\<zero>\\<^bsub>S\\<^esub>}) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>", "apply (subgoal_tac \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<subseteq> {j. j \\<le> (fst c)}\",\n       frule n_max[of \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\" \"fst c\"], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n     \\<subseteq> {j. j \\<le> fst c};\n     n_max\n      {j. j \\<le> fst c \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n     \\<in> {j. j \\<le> fst c \\<and>\n               snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<and>\n     (\\<forall>x\\<in>{j. j \\<le> fst c \\<and>\n                         snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}.\n         x \\<le> n_max\n                  {j. j \\<le> fst c \\<and>\n                      snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\\<rbrakk>\n    \\<Longrightarrow> snd c\n                       (n_max\n                         {j. j \\<le> fst c \\<and>\n                             snd c j \\<noteq>\n                             \\<zero>\\<^bsub>S\\<^esub>}) \\<noteq>\n                      \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c}", "apply (erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c.\n        snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) coeff_max_bddTr:\"pol_coeff S c \\<Longrightarrow> c_max S c \\<le> (fst c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> c_max S c \\<le> fst c", "apply (case_tac \"\\<forall>j\\<le>(fst c). (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\", simp add:c_max_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<not> (\\<forall>j\\<le>fst c.\n                snd c j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> c_max S c \\<le> fst c", "apply (simp add:c_max_def,\n       frule polyn_degreeTr[of c \"fst c\"], simp, simp,\n       subgoal_tac \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} \\<subseteq> {j. j \\<le> (fst c)}\",\n       frule n_max[of \"{j. j \\<le> (fst c) \\<and> (snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\" \"fst c\"],\n       blast, erule conjE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c;\n     \\<exists>j\\<le>fst c. snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     (polyn_expr R X (fst c) c = \\<zero>) =\n     (\\<forall>x\\<le>fst c. snd c x = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> fst c \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {j. j \\<le> fst c}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_coeff_max:\"pol_coeff S c \\<Longrightarrow> \n                             pol_coeff S ((c_max S c), snd c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> pol_coeff S (c_max S c, snd c)", "apply (rule pol_coeff_le[of c \"c_max S c\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow> c_max S c \\<le> fst c", "apply (simp add:coeff_max_bddTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) polyn_c_max:\"pol_coeff S c \\<Longrightarrow>\n       polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. pol_coeff S c \\<Longrightarrow>\n    polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c", "apply (case_tac \"(c_max S c) = (fst c)\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c =\n                      polyn_expr R X (c_max S c) c", "apply (frule coeff_max_bddTr[of c], \n       frule noteq_le_less[of \"c_max S c\" \"fst c\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst c) c =\n                      polyn_expr R X (c_max S c) c", "apply (subst polyn_n_m1[of c \"c_max S c\" \"fst c\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (c_max S c) c \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) Suc (c_max S c) fst c =\n                      polyn_expr R X (c_max S c) c", "apply (frule_tac polyn_mem[of c \"c_max S c\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c;\n     polyn_expr R X (c_max S c) c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (c_max S c) c \\<plusminus>\n                      \\<Sigma>\\<^sub>f R (\\<lambda>j.\n       snd c j \\<cdot>\\<^sub>r\n       X^\\<^bsup>R j\\<^esup>) Suc (c_max S c) fst c =\n                      polyn_expr R X (c_max S c) c", "apply (subst higher_part_zero[of c \"c_max S c\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c;\n     polyn_expr R X (c_max S c) c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc (c_max S c)) (fst c).\n                         snd c j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c;\n     polyn_expr R X (c_max S c) c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (c_max S c) c \\<plusminus> \\<zero> =\n                      polyn_expr R X (c_max S c) c", "apply (frule coeff_max_zeroTr[of c],\n        rule ballI, simp add:nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>pol_coeff S c; c_max S c \\<noteq> fst c; c_max S c \\<le> fst c;\n     c_max S c < fst c;\n     polyn_expr R X (c_max S c) c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (c_max S c) c \\<plusminus> \\<zero> =\n                      polyn_expr R X (c_max S c) c", "apply (cut_tac ring_is_ag, simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_deg_eq_c_max:\"\\<lbrakk>p \\<in> carrier R; \n       pol_coeff S c; p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> \n                   deg_n R S X p = c_max S c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = c_max S c", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = c_max S c", "apply (frule polyn_c_max[of c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     Subring R S; Ring S;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = c_max S c", "apply (frule pol_SOME_2[of p])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     Subring R S; Ring S;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     pol_coeff S (SOME c. cf_sol R S X p c) \\<and>\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = c_max S c", "apply (subst deg_n_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     Subring R S; Ring S;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (Eps (cf_sol R S X p)) = c_max S c", "apply (rule polyn_degree_unique[of \"Eps (cf_sol R S X p)\" \"c\"], simp,\n       assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     Subring R S; Ring S;\n     polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst (Eps (cf_sol R S X p)))\n                       (Eps (cf_sol R S X p)) =\n                      polyn_expr R X (fst c) c", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_deg_le_n:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       p = polyn_expr R X (fst c) c\\<rbrakk> \\<Longrightarrow> deg_n R S X p \\<le> (fst c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p \\<le> fst c", "apply (frule  pol_deg_eq_c_max[of p c], assumption+,\n       frule  coeff_max_bddTr[of c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     deg_n R S X p = c_max S c; c_max S c \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p \\<le> fst c", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_deg_le_n1:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> (fst c); \n       p = polyn_expr R X k c\\<rbrakk> \\<Longrightarrow> deg_n R S X p \\<le> k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     p = polyn_expr R X k c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p \\<le> k", "apply (simp add:deg_n_def, drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = p\\<rbrakk>\n    \\<Longrightarrow> c_max S (SOME c. cf_sol R S X p c) \\<le> k", "apply (frule pol_SOME_2[of p], erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = p; pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (SOME c. cf_sol R S X p c) \\<le> k", "apply (frule pol_coeff_le[of c k], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k c = p; pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     pol_coeff S (k, snd c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (SOME c. cf_sol R S X p c) \\<le> k", "apply (simp only:polyn_expr_short[of c k])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     polyn_expr R X k (k, snd c) = p;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     pol_coeff S (k, snd c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (SOME c. cf_sol R S X p c) \\<le> k", "apply (drule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     pol_coeff S (k, snd c); p = polyn_expr R X k (k, snd c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (SOME c. cf_sol R S X p c) \\<le> k", "apply (subst polyn_degree_unique[of \"SOME c. cf_sol R S X p c\" \"(k, snd c)\"],\n       assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; k \\<le> fst c;\n     pol_coeff S (SOME c. cf_sol R S X p c);\n     p =\n     polyn_expr R X (fst (SOME c. cf_sol R S X p c))\n      (SOME c. cf_sol R S X p c);\n     pol_coeff S (k, snd c); p = polyn_expr R X k (k, snd c)\\<rbrakk>\n    \\<Longrightarrow> c_max S (k, snd c) \\<le> k", "apply (frule coeff_max_bddTr[of \"(k, snd c)\"], simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_len_gt_deg:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       p = polyn_expr R X (fst c) c; deg R S X p < (an j); j \\<le> (fst c)\\<rbrakk>\n       \\<Longrightarrow>  (snd c) j = \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     deg R S X p < an j; j \\<le> fst c\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\", simp, drule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     deg R S X (polyn_expr R X (fst c) c) < an j; j \\<le> fst c;\n     p = polyn_expr R X (fst c) c;\n     polyn_expr R X (fst c) c = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>\n 2. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     deg R S X p < an j; j \\<le> fst c; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:coeff_0_pol_0[THEN sym, of c \"fst c\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     deg R S X p < an j; j \\<le> fst c; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:deg_def, simp add:aless_natless)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst c) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst c) c;\n     deg_n R S X (polyn_expr R X (fst c) c) < j; j \\<le> fst c;\n     polyn_expr R X (fst c) c \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (drule sym, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p < j;\n     j \\<le> fst c; p \\<noteq> \\<zero>;\n     polyn_expr R X (fst c) c = p\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (frule coeff_max_zeroTr[of c])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p < j;\n     j \\<le> fst c; p \\<noteq> \\<zero>; polyn_expr R X (fst c) c = p;\n     \\<forall>j.\n        j \\<le> fst c \\<and> c_max S c < j \\<longrightarrow>\n        snd c j = \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> snd c j = \\<zero>\\<^bsub>S\\<^esub>", "apply (simp add:pol_deg_eq_c_max)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_diff_deg_less:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n      p = polyn_expr R X (fst c) c; pol_coeff S d;\n      fst c = fst d; (snd c) (fst c) = (snd d) (fst d)\\<rbrakk> \\<Longrightarrow>\n      p \\<plusminus> (-\\<^sub>a (polyn_expr R X (fst d) d)) = \\<zero> \\<or> \n     deg_n R S X (p \\<plusminus> (-\\<^sub>a (polyn_expr R X (fst d) d))) < (fst c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     pol_coeff S d; fst c = fst d; snd c (fst c) = snd d (fst d)\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d)\n                      < fst c", "apply (cut_tac ring_is_ag, \n       cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     pol_coeff S d; fst c = fst d; snd c (fst c) = snd d (fst d); aGroup R;\n     Subring R S; Ring S\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d)\n                      < fst c", "apply (case_tac \"p \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> (polyn_expr R X (fst d) d)) = \\<zero>\\<^bsub>R\\<^esub>\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; p = polyn_expr R X (fst c) c;\n     pol_coeff S d; fst c = fst d; snd c (fst c) = snd d (fst d); aGroup R;\n     Subring R S; Ring S;\n     p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d =\n                      \\<zero> \\<or>\n                      deg_n R S X\n                       (p \\<plusminus> -\\<^sub>a polyn_expr R X (fst d) d)\n                      < fst c", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     -\\<^sub>a polyn_expr R X (fst d) d \\<noteq>\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d) c \\<plusminus>\n                        -\\<^sub>a polyn_expr R X (fst d) d)\n                      < fst d", "apply (simp add:polyn_minus_m_cf[of d \"fst d\"],\n        frule m_cf_pol_coeff[of d])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d) c \\<plusminus>\n                        polyn_expr R X (fst d) (m_cf S d))\n                      < fst d", "apply (cut_tac  polyn_add1[of c \"m_cf S d\"], simp add:m_cf_len,\n        thin_tac \"polyn_expr R X (fst d) c \\<plusminus> polyn_expr R X (fst d) (m_cf S d)\n        = polyn_expr R X (fst d) (add_cf S c (m_cf S d))\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n                      < fst d\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (frule add_cf_pol_coeff[of c \"m_cf S d\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n                      < fst d\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (cut_tac polyn_mem[of \"add_cf S c (m_cf S d)\" \"fst d\"],\n        frule pol_deg_le_n[of \"polyn_expr R X (fst d) (add_cf S c (m_cf S d))\"\n        \"add_cf S c (m_cf S d)\"], assumption+,\n        simp add:add_cf_len m_cf_len,\n        simp add:add_cf_len m_cf_len)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n     \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n                      < fst d\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 5. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (rule noteq_le_less[of \"deg_n R S X (polyn_expr R X (fst d) \n         (add_cf S c (m_cf S d)))\" \"fst d\"], assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n     \\<le> fst d\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X\n                       (polyn_expr R X (fst d)\n                         (add_cf S c (m_cf S d))) \\<noteq>\n                      fst d\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 5. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 5. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (cut_tac pol_deg_eq_c_max[of \"polyn_expr R X (fst d) \n             (add_cf S c (m_cf S d))\" \"add_cf S c (m_cf S d)\"],\n        simp,\n        thin_tac \"deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d)))\n                 = fst d\")"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     c_max S (add_cf S c (m_cf S d)) = fst d\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst d) (add_cf S c (m_cf S d))\n                      \\<in> carrier R\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst d) (add_cf S c (m_cf S d)) =\n                      polyn_expr R X (fst (add_cf S c (m_cf S d)))\n                       (add_cf S c (m_cf S d))\n 5. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst (add_cf S c (m_cf S d))\n 7. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 8. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (frule coeff_nonzero_polyn_nonzero[of \"add_cf S c (m_cf S d)\" \"fst d\"],\n        simp add:add_cf_len m_cf_len, simp,\n              thin_tac \"polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>\",\n        frule coeff_max_nonzeroTr[of \"add_cf S c (m_cf S d)\"],\n        simp add:add_cf_len m_cf_len,\n               thin_tac \"\\<exists>j\\<le>fst d. snd (add_cf S c (m_cf S d)) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\",\n               thin_tac \"pol_coeff S (m_cf S d)\",\n               thin_tac \"pol_coeff S (add_cf S c (m_cf S d))\",\n               thin_tac \"polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> \n                         carrier R\", simp,\n               thin_tac \"c_max S (add_cf S c (m_cf S d)) = fst d\")"], ["proof (prove)\ngoal (8 subgoals):\n 1. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     snd (add_cf S c (m_cf S d)) (fst d) \\<noteq>\n     \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst d) (add_cf S c (m_cf S d))\n                      \\<in> carrier R\n 3. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 4. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d));\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<in> carrier R;\n     deg_n R S X (polyn_expr R X (fst d) (add_cf S c (m_cf S d))) =\n     fst d\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (fst d) (add_cf S c (m_cf S d)) =\n                      polyn_expr R X (fst (add_cf S c (m_cf S d)))\n                       (add_cf S c (m_cf S d))\n 5. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (add_cf S c (m_cf S d))\n 6. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) (add_cf S c (m_cf S d)) \\<noteq> \\<zero>;\n     pol_coeff S (m_cf S d); pol_coeff S (add_cf S c (m_cf S d))\\<rbrakk>\n    \\<Longrightarrow> fst d \\<le> fst (add_cf S c (m_cf S d))\n 7. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S c\n 8. \\<lbrakk>polyn_expr R X (fst d) c \\<in> carrier R; pol_coeff S c;\n     p = polyn_expr R X (fst d) c; pol_coeff S d; fst c = fst d;\n     snd c (fst d) = snd d (fst d); aGroup R; Subring R S; Ring S;\n     polyn_expr R X (fst d) c \\<plusminus>\n     polyn_expr R X (fst d) (m_cf S d) \\<noteq>\n     \\<zero>;\n     pol_coeff S (m_cf S d)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (m_cf S d)", "apply (simp add:add_cf_def m_cf_def,\n          frule pol_coeff_mem[of d \"fst d\"], simp,\n          frule Ring.ring_is_ag[of S], \n               simp add:aGroup.ag_r_inv1, assumption+,\n          simp add:add_cf_len m_cf_len, assumption,\n          simp add:add_cf_len m_cf_len, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_pre_lt_deg:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c;\n      deg_n R S X p \\<le> (fst c); (deg_n R S X p) \\<noteq> 0;\n      p = polyn_expr R X (deg_n R S X p) c \\<rbrakk> \\<Longrightarrow> \n (deg_n R S X (polyn_expr R X ((deg_n R S X p) - Suc 0) c)) < (deg_n R S X p)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     deg_n R S X p \\<noteq> 0; p = polyn_expr R X (deg_n R S X p) c\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (polyn_expr R X (deg_n R S X p - Suc 0) c)\n                      < deg_n R S X p", "apply (frule polyn_expr_short[of c \"deg_n R S X p\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     deg_n R S X p \\<noteq> 0; p = polyn_expr R X (deg_n R S X p) c;\n     polyn_expr R X (deg_n R S X p) c =\n     polyn_expr R X (deg_n R S X p) (deg_n R S X p, snd c)\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (polyn_expr R X (deg_n R S X p - Suc 0) c)\n                      < deg_n R S X p", "apply (cut_tac pol_deg_le_n[of \"polyn_expr R X (deg_n R S X p - Suc 0) c\"\n           \"(deg_n R S X p - Suc 0, snd c)\"], simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     deg_n R S X p \\<noteq> 0; p = polyn_expr R X (deg_n R S X p) c;\n     polyn_expr R X (deg_n R S X p) c =\n     polyn_expr R X (deg_n R S X p) (deg_n R S X p, snd c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R S X p - Suc 0) c\n                      \\<in> carrier R\n 2. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     deg_n R S X p \\<noteq> 0; p = polyn_expr R X (deg_n R S X p) c;\n     polyn_expr R X (deg_n R S X p) c =\n     polyn_expr R X (deg_n R S X p) (deg_n R S X p, snd c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (deg_n R S X p - Suc 0, snd c)\n 3. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     deg_n R S X p \\<noteq> 0; p = polyn_expr R X (deg_n R S X p) c;\n     polyn_expr R X (deg_n R S X p) c =\n     polyn_expr R X (deg_n R S X p) (deg_n R S X p, snd c)\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R S X p - Suc 0) c =\n                      polyn_expr R X (fst (deg_n R S X p - Suc 0, snd c))\n                       (deg_n R S X p - Suc 0, snd c)", "apply (rule polyn_mem[of c \"deg_n R S X p - Suc 0\"], assumption+,\n        arith,\n        rule pol_coeff_le[of c \"deg_n R S X p - Suc 0\"], assumption,\n        arith, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; deg_n R S X p \\<le> fst c;\n     0 < deg_n R S X p;\n     p = polyn_expr R X (deg_n R S X p) (deg_n R S X p, snd c);\n     polyn_expr R X (deg_n R S X p) c = p\\<rbrakk>\n    \\<Longrightarrow> polyn_expr R X (deg_n R S X p - Suc 0) c =\n                      polyn_expr R X (deg_n R S X p - Suc 0)\n                       (deg_n R S X p - Suc 0, snd c)", "apply (subst polyn_expr_short[of c \"deg_n R S X p - Suc 0\"],\n         assumption+, arith, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_deg_n:\"\\<lbrakk>p \\<in> carrier R; pol_coeff S c; \n       n \\<le> fst c; p = polyn_expr R X n c; (snd c) n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk> \\<Longrightarrow>\n                   deg_n R S X p = n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     p = polyn_expr R X n c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X p = n", "apply (simp add:polyn_expr_short[of c n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> deg_n R S X (polyn_expr R X n (n, snd c)) = n", "apply (frule pol_coeff_le[of c n], assumption+,\n        cut_tac pol_deg_eq_c_max[of p \"(n, snd c)\"],\n        drule sym, simp, simp add:c_max_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S (n, snd c);\n     deg_n R S X p =\n     (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n      else n_max\n            {j. j \\<le> fst (n, snd c) \\<and>\n                snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>});\n     polyn_expr R X n (n, snd c) = p\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>x\\<le>n.\n                           snd c x =\n                           \\<zero>\\<^bsub>S\\<^esub>) \\<longrightarrow>\n                       n = 0) \\<and>\n                      ((\\<exists>x\\<le>n.\n                           snd c x \\<noteq>\n                           \\<zero>\\<^bsub>S\\<^esub>) \\<longrightarrow>\n                       n_max\n                        {j. j \\<le> n \\<and>\n                            snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                       n)\n 2. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, snd c)\n 4. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X (fst (n, snd c)) (n, snd c)", "apply (rule conjI, rule impI, cut_tac le_refl[of n],\n        thin_tac \"deg_n R S X p =\n        (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n        else n_max {j. j \\<le> fst (n, snd c) \\<and> snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>})\",\n        drule_tac a = n in forall_spec, assumption, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S (n, snd c);\n     deg_n R S X p =\n     (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n      else n_max\n            {j. j \\<le> fst (n, snd c) \\<and>\n                snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>});\n     polyn_expr R X n (n, snd c) = p\\<rbrakk>\n    \\<Longrightarrow> (\\<exists>x\\<le>n.\n                          snd c x \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>) \\<longrightarrow>\n                      n_max\n                       {j. j \\<le> n \\<and>\n                           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                      n\n 2. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, snd c)\n 4. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X (fst (n, snd c)) (n, snd c)", "apply (rule impI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S (n, snd c);\n     deg_n R S X p =\n     (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n      else n_max\n            {j. j \\<le> fst (n, snd c) \\<and>\n                snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>});\n     polyn_expr R X n (n, snd c) = p;\n     \\<exists>x\\<le>n. snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> n_max\n                       {j. j \\<le> n \\<and>\n                           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>} =\n                      n\n 2. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 3. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, snd c)\n 4. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X (fst (n, snd c)) (n, snd c)", "apply (cut_tac n_max[of \"{j. j \\<le> n \\<and> snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\" n], erule conjE,\n        drule_tac x = n in bspec, simp, simp)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S (n, snd c);\n     deg_n R S X p =\n     (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n      else n_max\n            {j. j \\<le> fst (n, snd c) \\<and>\n                snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>});\n     polyn_expr R X n (n, snd c) = p;\n     \\<exists>x\\<le>n. snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> n \\<and>\n                          snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>}\n                      \\<subseteq> {i. i \\<le> n}\n 2. \\<lbrakk>p \\<in> carrier R; pol_coeff S c; n \\<le> fst c;\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>; pol_coeff S (n, snd c);\n     deg_n R S X p =\n     (if \\<forall>x\\<le>n. snd c x = \\<zero>\\<^bsub>S\\<^esub> then 0\n      else n_max\n            {j. j \\<le> fst (n, snd c) \\<and>\n                snd (n, snd c) j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>});\n     polyn_expr R X n (n, snd c) = p;\n     \\<exists>x\\<le>n. snd c x \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {j. j \\<le> n \\<and>\n                          snd c j \\<noteq>\n                          \\<zero>\\<^bsub>S\\<^esub>} \\<noteq>\n                      {}\n 3. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p \\<in> carrier R\n 4. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> pol_coeff S (n, snd c)\n 5. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X (fst (n, snd c)) (n, snd c)", "apply (rule subsetI, simp, blast,\n        drule sym, simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>polyn_expr R X n (n, snd c) \\<in> carrier R; pol_coeff S c;\n     n \\<le> fst c; p = polyn_expr R X n (n, snd c);\n     snd c n \\<noteq> \\<zero>\\<^bsub>S\\<^esub>;\n     pol_coeff S (n, snd c)\\<rbrakk>\n    \\<Longrightarrow> p = polyn_expr R X (fst (n, snd c)) (n, snd c)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) pol_expr_deg:\"\\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk> \n       \\<Longrightarrow> \\<exists>c. pol_coeff S c \\<and> deg_n R S X p \\<le> (fst c) \\<and> \n                p = polyn_expr R X (deg_n R S X p) c \\<and> \n               (snd c) (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>c.\n                         pol_coeff S c \\<and>\n                         deg_n R S X p \\<le> fst c \\<and>\n                         p = polyn_expr R X (deg_n R S X p) c \\<and>\n                         snd c (deg_n R S X p) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac subring,\n       frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>c.\n                         pol_coeff S c \\<and>\n                         deg_n R S X p \\<le> fst c \\<and>\n                         p = polyn_expr R X (deg_n R S X p) c \\<and>\n                         snd c (deg_n R S X p) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (frule ex_polyn_expr[of p], erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>c.\n                            pol_coeff S c \\<and>\n                            deg_n R S X p \\<le> fst c \\<and>\n                            p = polyn_expr R X (deg_n R S X p) c \\<and>\n                            snd c (deg_n R S X p) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c = c in polyn_c_max)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>c.\n                            pol_coeff S c \\<and>\n                            deg_n R S X p \\<le> fst c \\<and>\n                            p = polyn_expr R X (deg_n R S X p) c \\<and>\n                            snd c (deg_n R S X p) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c = c in pol_deg_le_n[of p], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n        deg_n R S X p \\<le> fst c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>c.\n                            pol_coeff S c \\<and>\n                            deg_n R S X p \\<le> fst c \\<and>\n                            p = polyn_expr R X (deg_n R S X p) c \\<and>\n                            snd c (deg_n R S X p) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>", "apply (frule_tac c1 = c and k1 =\"fst c\" in coeff_0_pol_0[THEN sym], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n        deg_n R S X p \\<le> fst c;\n        (polyn_expr R X (fst c) c = \\<zero>) =\n        (\\<forall>j\\<le>fst c. snd c j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>c.\n                            pol_coeff S c \\<and>\n                            deg_n R S X p \\<le> fst c \\<and>\n                            p = polyn_expr R X (deg_n R S X p) c \\<and>\n                            snd c (deg_n R S X p) \\<noteq>\n                            \\<zero>\\<^bsub>S\\<^esub>", "apply (subgoal_tac \"p = polyn_expr R X (deg_n R S X p) c \\<and>\n               snd c (deg_n R S X p) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n        deg_n R S X p \\<le> fst c;\n        (polyn_expr R X (fst c) c = \\<zero>) =\n        (\\<forall>j\\<le>fst c. snd c j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> p = polyn_expr R X (deg_n R S X p) c \\<and>\n                         snd c (deg_n R S X p) \\<noteq>\n                         \\<zero>\\<^bsub>S\\<^esub>", "apply (subst pol_deg_eq_c_max, assumption+)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>p \\<in> carrier R; p \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (fst c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n        deg_n R S X p \\<le> fst c;\n        (polyn_expr R X (fst c) c = \\<zero>) =\n        (\\<forall>j\\<le>fst c. snd c j = \\<zero>\\<^bsub>S\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> p = polyn_expr R X (c_max S c) c \\<and>\n                         snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>c.\n       \\<lbrakk>polyn_expr R X (c_max S c) c \\<in> carrier R;\n        polyn_expr R X (c_max S c) c \\<noteq> \\<zero>; Subring R S; Ring S;\n        pol_coeff S c; p = polyn_expr R X (c_max S c) c;\n        polyn_expr R X (fst c) c = polyn_expr R X (c_max S c) c;\n        deg_n R S X (polyn_expr R X (c_max S c) c) \\<le> fst c;\n        \\<exists>j\\<le>fst c.\n           snd c j \\<noteq> \\<zero>\\<^bsub>S\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> snd c (c_max S c) \\<noteq> \\<zero>\\<^bsub>S\\<^esub>", "apply (cut_tac c = c in coeff_max_nonzeroTr, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in PolynRg) deg_n_pos:\"p \\<in> carrier R \\<Longrightarrow> 0 \\<le> deg_n R S X p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. p \\<in> carrier R \\<Longrightarrow> 0 \\<le> deg_n R S X p", "by simp"], ["", "lemma (in PolynRg) pol_expr_deg1:\"\\<lbrakk>p \\<in> carrier R; d = na (deg R S X p)\\<rbrakk> \\<Longrightarrow> \n                \\<exists>c. (pol_coeff S c \\<and> p = polyn_expr R X d c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; d = na (deg R S X p)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>c.\n                         pol_coeff S c \\<and> p = polyn_expr R X d c", "apply (cut_tac subring, frule subring_Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; d = na (deg R S X p); Subring R S;\n     Ring S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>c.\n                         pol_coeff S c \\<and> p = polyn_expr R X d c", "apply (case_tac \"p = \\<zero>\\<^bsub>R\\<^esub>\",\n       simp add:deg_def na_minf,\n       subgoal_tac \"pol_coeff S (0, (\\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>))\", \n       subgoal_tac \"\\<zero> = polyn_expr R X d (0, (\\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>))\", blast,\n       cut_tac coeff_0_pol_0[of \"(d, \\<lambda>j. \\<zero>\\<^bsub>S\\<^esub>)\" d], simp+,\n       simp add:pol_coeff_def,\n       simp add:Ring.ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>p \\<in> carrier R; d = na (deg R S X p); Subring R S; Ring S;\n     p \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>c.\n                         pol_coeff S c \\<and> p = polyn_expr R X d c", "apply (simp add:deg_def na_an,\n       frule pol_expr_deg[of p], assumption,\n       erule exE, (erule conjE)+,\n       unfold split_paired_all, simp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}