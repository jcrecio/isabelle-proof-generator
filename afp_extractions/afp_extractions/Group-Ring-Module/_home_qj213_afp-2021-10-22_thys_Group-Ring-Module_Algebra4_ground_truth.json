{"file_name": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module/Algebra4.thy", "working_directory": "/home/qj213/afp-2021-10-22/thys/Group-Ring-Module", "problem_names": ["lemma (in aGroup) ag_carrier_carrier:\"carrier (b_ag A) = carrier A\"", "lemma (in aGroup) ag_pOp_closed:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                     pop A x y \\<in> carrier A\"", "lemma (in aGroup) ag_mOp_closed:\"x \\<in> carrier A \\<Longrightarrow> (-\\<^sub>a x)  \\<in> carrier A\"", "lemma (in aGroup) asubg_subset:\"A +> H \\<Longrightarrow> H \\<subseteq> carrier A\"", "lemma (in aGroup) ag_pOp_commute:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>  \\<Longrightarrow>\n           pop A x y = pop A y x\"", "lemma (in aGroup) b_ag_group:\"Group (b_ag A)\"", "lemma (in aGroup) agop_gop:\"top (b_ag A) = pop A\"", "lemma (in aGroup) agiop_giop:\"iop (b_ag A) = mop A\"", "lemma (in aGroup) agunit_gone:\"one (b_ag A) = \\<zero>\"", "lemma (in aGroup) ag_pOp_add_r:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                 a = b\\<rbrakk>  \\<Longrightarrow> a \\<plusminus> c =  b \\<plusminus> c\"", "lemma (in aGroup) ag_add_commute:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                                  a \\<plusminus> b = b \\<plusminus> a\"", "lemma (in aGroup) ag_pOp_add_l:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                 a = b\\<rbrakk>  \\<Longrightarrow> c \\<plusminus> a =  c \\<plusminus> b\"", "lemma (in aGroup) asubg_pOp_closed:\"\\<lbrakk>asubGroup A H; x \\<in> H; y \\<in> H\\<rbrakk>\n                                   \\<Longrightarrow> pop A x y \\<in> H\"", "lemma (in aGroup) asubg_mOp_closed:\"\\<lbrakk>asubGroup A H; x \\<in> H\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> H\"", "lemma (in aGroup) asubg_subset1:\"\\<lbrakk>asubGroup A H; x \\<in> H\\<rbrakk> \\<Longrightarrow> x \\<in> carrier A\"", "lemma (in aGroup) asubg_inc_zero:\"asubGroup A H \\<Longrightarrow> \\<zero> \\<in> H\"", "lemma (in aGroup) ag_inc_zero:\"\\<zero> \\<in> carrier A\"", "lemma (in aGroup) ag_l_zero:\"x \\<in> carrier A \\<Longrightarrow> \\<zero> \\<plusminus> x = x\"", "lemma (in aGroup) ag_r_zero:\"x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> \\<zero> = x\"", "lemma (in aGroup) ag_l_inv1:\"x \\<in> carrier A \\<Longrightarrow> (-\\<^sub>a x) \\<plusminus> x = \\<zero>\"", "lemma (in aGroup) ag_r_inv1:\"x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> (-\\<^sub>a x) = \\<zero>\"", "lemma (in aGroup) ag_pOp_assoc:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; z \\<in> carrier A\\<rbrakk>\n                \\<Longrightarrow> (x \\<plusminus> y) \\<plusminus> z = x \\<plusminus> (y \\<plusminus> z)\"", "lemma (in aGroup) ag_inv_unique:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<plusminus> y = \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                     y = -\\<^sub>a x\"", "lemma (in aGroup) ag_inv_inj:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y\\<rbrakk> \\<Longrightarrow>\n                                          (-\\<^sub>a x) \\<noteq> (-\\<^sub>a y)\"", "lemma (in aGroup) pOp_assocTr41:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d = a \\<plusminus> b \\<plusminus> (c \\<plusminus> d)\"", "lemma (in aGroup) pOp_assocTr42:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A; d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d = a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d\"", "lemma (in aGroup) pOp_assocTr43:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A; d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) = a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d\"", "lemma (in aGroup) pOp_assoc_cancel:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<plusminus> (b \\<plusminus> -\\<^sub>a c) = a \\<plusminus> -\\<^sub>a c\"", "lemma (in aGroup) ag_p_inv:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                     (-\\<^sub>a (x \\<plusminus> y)) = (-\\<^sub>a x) \\<plusminus> (-\\<^sub>a y)\"", "lemma (in aGroup) gEQAddcross: \"\\<lbrakk>l1 \\<in> carrier A; l2 \\<in> carrier A;\n      r1 \\<in> carrier A; r1 \\<in> carrier A; l1 = r2; l2 = r1\\<rbrakk> \\<Longrightarrow>\n                          l1 \\<plusminus> l2 = r1 \\<plusminus> r2\"", "lemma (in aGroup) ag_eq_sol1:\"\\<lbrakk>a \\<in> carrier A; x\\<in> carrier A; b\\<in> carrier A;\n                               a \\<plusminus> x = b\\<rbrakk> \\<Longrightarrow> x = (-\\<^sub>a a) \\<plusminus> b\"", "lemma (in aGroup) ag_eq_sol2:\"\\<lbrakk>a \\<in> carrier A; x\\<in> carrier A; b\\<in> carrier A;\n                                x \\<plusminus> a = b\\<rbrakk> \\<Longrightarrow> x = b \\<plusminus> (-\\<^sub>a a)\"", "lemma (in aGroup) ag_add4_rel:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n d \\<in> carrier A \\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) =  a \\<plusminus> c \\<plusminus> (b \\<plusminus> d)\"", "lemma (in aGroup) ag_inv_inv:\"x \\<in> carrier A \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x) = x\"", "lemma (in aGroup) ag_inv_zero:\"-\\<^sub>a \\<zero> = \\<zero>\"", "lemma (in aGroup) ag_diff_minus:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                   a \\<plusminus> (-\\<^sub>a b) = c\\<rbrakk> \\<Longrightarrow> b \\<plusminus> (-\\<^sub>a a) = (-\\<^sub>a c)\"", "lemma (in aGroup) pOp_cancel_l:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;                    c \\<plusminus> a =  c \\<plusminus> b \\<rbrakk> \\<Longrightarrow> a = b\"", "lemma (in aGroup) pOp_cancel_r:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;               a \\<plusminus> c =  b \\<plusminus> c \\<rbrakk> \\<Longrightarrow> a = b\"", "lemma (in aGroup) ag_eq_diffzero:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                       (a = b) = (a \\<plusminus> (-\\<^sub>a b) = \\<zero>)\"", "lemma (in aGroup) ag_eq_diffzero1:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                       (a = b) = ((-\\<^sub>a a) \\<plusminus> b = \\<zero>)\"", "lemma (in aGroup) ag_neq_diffnonzero:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n         (a \\<noteq> b) = (a \\<plusminus> (-\\<^sub>a b) \\<noteq>  \\<zero>)\"", "lemma (in aGroup) ag_plus_zero:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                     (x = -\\<^sub>a y)  = (x \\<plusminus> y = \\<zero>)\"", "lemma (in aGroup) asubg_nsubg:\"A +> H \\<Longrightarrow>  (b_ag A) \\<triangleright> H\"", "lemma (in aGroup) subg_asubg:\"b_ag G \\<guillemotright> H \\<Longrightarrow> G +> H\"", "lemma (in aGroup) asubg_test:\"\\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n               \\<forall>a\\<in>H. \\<forall>b\\<in>H. (a \\<plusminus> (-\\<^sub>a b) \\<in> H)\\<rbrakk> \\<Longrightarrow> A +> H\"", "lemma (in aGroup) asubg_zero:\"A +> {\\<zero>}\"", "lemma (in aGroup) asubg_whole:\"A +> carrier A\"", "lemma (in aGroup) Ag_ind_carrier:\"bij_to f (carrier A) (D::'d set) \\<Longrightarrow>\n               carrier (Ag_ind A f) = f ` (carrier A)\"", "lemma (in aGroup) Ag_ind_aGroup:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> aGroup (Ag_ind A f)\"", "lemma aHom_mem:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F\\<rbrakk> \\<Longrightarrow>\n                       f a \\<in> carrier G\"", "lemma aHom_func:\"f \\<in> aHom F G \\<Longrightarrow> f \\<in> carrier F \\<rightarrow> carrier G\"", "lemma aHom_add:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n b \\<in> carrier F\\<rbrakk> \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>F\\<^esub> b) = (f a) \\<plusminus>\\<^bsub>G\\<^esub> (f b)\"", "lemma aHom_0_0:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk> \\<Longrightarrow> f (\\<zero>\\<^bsub>F\\<^esub>) = \\<zero>\\<^bsub>G\\<^esub>\"", "lemma ker_inc_zero:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk> \\<Longrightarrow> \\<zero>\\<^bsub>F\\<^esub> \\<in> ker\\<^bsub>F,G\\<^esub> f\"", "lemma aHom_inv_inv:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F\\<rbrakk> \\<Longrightarrow>\n                         f (-\\<^sub>a\\<^bsub>F\\<^esub> a) = -\\<^sub>a\\<^bsub>G\\<^esub> (f a)\"", "lemma aHom_compos:\"\\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M; g \\<in> aHom M N \\<rbrakk>\n  \\<Longrightarrow> compos L g f \\<in> aHom L N\"", "lemma aHom_compos_assoc:\"\\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n      g \\<in> aHom L M; h \\<in> aHom M N \\<rbrakk>  \\<Longrightarrow>\n      compos K h (compos K g f) = compos K (compos L h g) f\"", "lemma injec_inj_on:\"\\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow> inj_on f (carrier F)\"", "lemma surjec_surj_to:\"surjec\\<^bsub>R,S\\<^esub> f \\<Longrightarrow> surj_to f (carrier R) (carrier S)\"", "lemma compos_bijec:\"\\<lbrakk>aGroup E; aGroup F; aGroup G; bijec\\<^bsub>E,F\\<^esub> f; bijec\\<^bsub>F,G\\<^esub> g\\<rbrakk> \\<Longrightarrow>\n                     bijec\\<^bsub>E,G\\<^esub> (compos E g f)\"", "lemma ainvf_aHom:\"\\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                      ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F\"", "lemma ainvf_bijec:\"\\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow> bijec\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\"", "lemma ainvf_l:\"\\<lbrakk>aGroup E; aGroup F; bijec\\<^bsub>E,F\\<^esub> f; x \\<in> carrier E\\<rbrakk> \\<Longrightarrow>\n                      (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x\"", "lemma (in aGroup) aI_aHom:\"aI\\<^bsub>A\\<^esub> \\<in> aHom A A\"", "lemma compos_aI_l:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk> \\<Longrightarrow> compos A aI\\<^bsub>B\\<^esub> f = f\"", "lemma compos_aI_r:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk> \\<Longrightarrow> compos A f aI\\<^bsub>A\\<^esub> = f\"", "lemma compos_aI_surj:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n                      compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> surjec\\<^bsub>B,A\\<^esub> g\"", "lemma compos_aI_inj:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n                      compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> injec\\<^bsub>A,B\\<^esub> f\"", "lemma (in aGroup) Ag_ind_aHom:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> Agii A f \\<in> aHom A (Ag_ind A f)\"", "lemma (in aGroup) Agii_mem:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D; x \\<in> carrier A;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> Agii A f x \\<in> carrier (Ag_ind A f)\"", "lemma Ag_ind_bijec:\"\\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> bijec\\<^bsub>A, (Ag_ind A f)\\<^esub> (Agii A f)\"", "lemma ker_subg:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G \\<rbrakk> \\<Longrightarrow> F +> ker\\<^bsub>F,G\\<^esub> f\"", "lemma (in aGroup) ag_a_in_ar_cos:\"\\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> H\"", "lemma (in aGroup) r_cos_subset:\"\\<lbrakk>A +> H; X \\<in> set_rcs (b_ag A) H\\<rbrakk> \\<Longrightarrow>\n                   X \\<subseteq> carrier A\"", "lemma (in aGroup) asubg_costOp_commute:\"\\<lbrakk>A +> H; x \\<in> set_rcs (b_ag A) H;\n       y \\<in> set_rcs (b_ag A) H\\<rbrakk> \\<Longrightarrow>\n             c_top (b_ag A) H x y = c_top (b_ag A) H y x\"", "lemma (in aGroup) Subg_Qgroup:\"A +> H \\<Longrightarrow> aGroup (aqgrp A H)\"", "lemma (in aGroup) plus_subgs:\"\\<lbrakk>A +> H1; A +> H2\\<rbrakk> \\<Longrightarrow> A +> H1 \\<minusplus> H2\"", "lemma (in aGroup) set_sum:\"\\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A\\<rbrakk> \\<Longrightarrow>\n                    H \\<minusplus> K = {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k}\"", "lemma (in aGroup) mem_set_sum:\"\\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n                  x \\<in> H \\<minusplus> K \\<rbrakk> \\<Longrightarrow> \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k\"", "lemma (in aGroup) mem_sum_subgs:\"\\<lbrakk>A +> H; A +> K; h \\<in> H; k \\<in> K\\<rbrakk> \\<Longrightarrow>\n                    h \\<plusminus> k \\<in> H \\<minusplus> K\"", "lemma (in aGroup) aqgrp_carrier:\"A +> H \\<Longrightarrow>\n                   set_rcs (b_ag A ) H = set_ar_cos A H\"", "lemma (in aGroup) unit_in_set_ar_cos:\"A +> H \\<Longrightarrow> H \\<in> set_ar_cos A H\"", "lemma (in aGroup) aqgrp_pOp_maps:\"\\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n      pop (aqgrp A H) (a \\<uplus>\\<^bsub>A\\<^esub> H) (b \\<uplus>\\<^bsub>A\\<^esub> H) = (a \\<plusminus> b) \\<uplus>\\<^bsub>A\\<^esub> H\"", "lemma (in aGroup) aqgrp_mOp_maps:\"\\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                   mop (aqgrp A H) (a \\<uplus>\\<^bsub>A\\<^esub> H) = (-\\<^sub>a a) \\<uplus>\\<^bsub>A\\<^esub> H\"", "lemma (in aGroup) aqgrp_zero:\"A +> H \\<Longrightarrow> zero (aqgrp A H) = H\"", "lemma (in aGroup) arcos_fixed:\"\\<lbrakk>A +> H; a \\<in> carrier A; h \\<in> H \\<rbrakk> \\<Longrightarrow>\n                              a \\<uplus>\\<^bsub>A\\<^esub> H = (h \\<plusminus> a) \\<uplus>\\<^bsub>A\\<^esub> H\"", "lemma prodag_comp_i:\"\\<lbrakk>a \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow> (a i) \\<in> carrier (A i)\"", "lemma prod_pOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<rightarrow> carr_prodag I A\"", "lemma prod_pOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_prodag I A\"", "lemma prod_pOp_mem_i:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y i = (X i) \\<plusminus>\\<^bsub>(A i)\\<^esub> (Y i)\"", "lemma prod_mOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  prod_mOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A\"", "lemma prod_mOp_mem:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X \\<in> carr_prodag I A\"", "lemma prod_mOp_mem_i:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X i = -\\<^sub>a\\<^bsub>(A i)\\<^esub> (X i)\"", "lemma prod_zero_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                           prod_zero I A \\<in> carr_prodag I A\"", "lemma prod_zero_i:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                           prod_zero I A i = \\<zero>\\<^bsub>(A i)\\<^esub> \"", "lemma carr_prodag_mem_eq:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\nY \\<in> carr_prodag I A; \\<forall>l\\<in>I. (X l) = (Y l) \\<rbrakk> \\<Longrightarrow> X = Y\"", "lemma prod_pOp_assoc:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n      b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n      prod_pOp I A (prod_pOp I A a b) c =\n                               prod_pOp I A a (prod_pOp I A b c)\"", "lemma prod_pOp_commute:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n                           b \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n                           prod_pOp I A a b = prod_pOp I A b a\"", "lemma prodag_aGroup:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> aGroup (prodag I A)\"", "lemma prodag_carrier:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n            carrier (prodag I A) = carr_prodag I A\"", "lemma prodag_elemfun:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> carrier (prodag I A)\\<rbrakk> \\<Longrightarrow>\n         f \\<in> extensional I\"", "lemma prodag_component:\"\\<lbrakk>f \\<in> carrier (prodag I A); i \\<in> I \\<rbrakk> \\<Longrightarrow>\n                              f i \\<in> carrier (A i)\"", "lemma prodag_pOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  pop (prodag I A) = prod_pOp I A\"", "lemma prodag_iOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  mop (prodag I A) = prod_mOp I A\"", "lemma prodag_zero:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  zero (prodag I A) = prod_zero I A\"", "lemma prodag_sameTr0:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> Un_carrier I A = Un_carrier I B\"", "lemma prodag_sameTr1:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> carr_prodag I A = carr_prodag I B\"", "lemma prodag_sameTr2:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_pOp I A = prod_pOp I B\"", "lemma prodag_sameTr3:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_mOp I A = prod_mOp I B\"", "lemma prodag_sameTr4:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_zero I A = prod_zero I B\"", "lemma prodag_same:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prodag I A = prodag I B\"", "lemma project_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I; x \\<in> carrier (prodag I A)\\<rbrakk> \\<Longrightarrow>\n                         (PRoject I A j) x  \\<in> carrier (A j)\"", "lemma project_aHom:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         PRoject I A j \\<in> aHom (prodag I A) (A j)\"", "lemma project_aHom1:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                      \\<forall>j \\<in> I. PRoject I A j \\<in> aHom (prodag I A) (A j)\"", "lemma A_to_prodag_mem:\"\\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);  \\<forall>k\\<in>I. (S k) \\<in>\n aHom A (B k); x \\<in> carrier A \\<rbrakk> \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B\"", "lemma A_to_prodag_aHom:\"\\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. (S k) \\<in>\n aHom A (B k) \\<rbrakk>  \\<Longrightarrow> A_to_prodag A I S B \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)\"", "lemma dsum_pOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A \\<rightarrow> carr_dsumag I A\"", "lemma dsum_pOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_dsumag I A;\n Y \\<in> carr_dsumag I A\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_dsumag I A\"", "lemma dsum_iOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  prod_mOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A\"", "lemma dsum_iOp_mem:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_dsumag I A\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X \\<in> carr_dsumag I A\"", "lemma dsum_zero_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                           prod_zero I A \\<in> carr_dsumag I A\"", "lemma dsumag_sub_prodag:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                              carr_dsumag I A \\<subseteq> carr_prodag I A\"", "lemma carrier_dsumag:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n         carrier (dsumag I A) = carr_dsumag I A\"", "lemma dsumag_elemfun:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> carrier (dsumag I A)\\<rbrakk> \\<Longrightarrow>\n         f \\<in> extensional I\"", "lemma dsumag_aGroup:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> aGroup (dsumag I A)\"", "lemma dsumag_pOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  pop (dsumag I A) = prod_pOp I A\"", "lemma dsumag_mOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  mop (dsumag I A) = prod_mOp I A\"", "lemma dsumag_zero:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  zero (dsumag I A) = prod_zero I A\"", "lemma direct_prod_mem_eq:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n       g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); \\<forall>j\\<in>I. (PRoject I A j) f = (PRoject I A j) g\\<rbrakk> \\<Longrightarrow>\n       f = g\"", "lemma map_family_fun:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n      \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j)); x \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n         (\\<lambda>y \\<in> carrier S. (\\<lambda>j\\<in>I. (g j) y)) x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\"", "lemma map_family_aHom:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n      \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow>\n         (\\<lambda>y \\<in> carrier S. (\\<lambda>j\\<in>I. (g j) y)) \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\"", "lemma map_family_triangle:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n         \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow> \\<exists>!f. f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                  (\\<forall>j\\<in>I. compos S (PRoject I A j) f =  (g j))\"", "lemma Ag_ind_triangle:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I; f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\ncompos (a\\<Pi>\\<^bsub>I\\<^esub> A) (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)(PRoject I A j) (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),\n (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<^esub> (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))) (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                                       PRoject I A j\"", "lemma ProjInd_aHom:\"\\<lbrakk>\\<forall>j\\<in> I. aGroup (A j); j \\<in> I; f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n        (ProjInd I A f j) \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (A j)\"", "lemma ProjInd_aHom1:\"\\<lbrakk>\\<forall>j\\<in> I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set)\\<rbrakk> \\<Longrightarrow>\n        \\<forall>j\\<in>I. (ProjInd I A f j) \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (A j)\"", "lemma ProjInd_mem_eq:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S; x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      \\<forall>j\\<in>I. (ProjInd I A f j x = ProjInd I A f j y)\\<rbrakk> \\<Longrightarrow> x = y\"", "lemma ProjInd_mem_eq1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n      h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h = ProjInd I A f j\\<rbrakk>       \\<Longrightarrow> h = ag_idmap (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\"", "lemma Ag_ind_triangle1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n      compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j) (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =  PRoject I A j\"", "lemma map_family_triangle1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); aGroup S;\n     \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow> \\<exists>!h. h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n                  (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h =  (g j))\"", "lemma  map_family_triangle2:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n       \\<forall>j\\<in>I. g j \\<in> aHom S (A j); ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 = ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n                 (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n                ProjInd I A ff j\"", "lemma  map_family_triangle3:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n       \\<forall>j\\<in>I. f j \\<in> aHom S (A j); \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j);\n        h1 \\<in> aHom S1 S; h2 \\<in> aHom S S1;\n        \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I. compos S (f j) (compos S h1 h2) = f j\"", "lemma map_family_triangle4:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n                \\<forall>j\\<in>I. f j \\<in> aHom S (A j)\\<rbrakk> \\<Longrightarrow>\n               \\<forall>j\\<in>I. compos S (f j) (ag_idmap S) = f j\"", "lemma  prod_triangle:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n       \\<forall>j\\<in>I. g j \\<in> aHom S (A j); ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 = ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n       \\<Longrightarrow> (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) = ag_idmap (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\"", "lemma characterization_prodag:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>(I::'i set). aGroup ((A j)::\n    ('a, 'm) aGroup_scheme); aGroup (S::'d aGroup);\n    \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j)); \\<exists>ff. ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> (B::'d set) \\<and>\n          bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n    \\<forall>(S':: 'd aGroup). aGroup S' \\<longrightarrow>\n        (\\<forall>g'. (\\<forall>j\\<in>I. (g' j) \\<in> aHom S' (A j) \\<longrightarrow>\n         (\\<exists>! f. f \\<in> aHom S' S \\<and> (\\<forall>j\\<in>I. compos S' (g j) f =  (g' j)))))\\<rbrakk> \\<Longrightarrow>\n     \\<exists>h. bijec\\<^bsub>(prodag I A),S\\<^esub> h\"", "lemma (in aGroup) nsum_zeroGTr:\"(\\<forall>j \\<le> n. f j = \\<zero>) \\<longrightarrow> nsum A f n = \\<zero>\"", "lemma (in aGroup) nsum_zeroA:\"\\<forall>j \\<le> n. f j = \\<zero> \\<Longrightarrow>   nsum A f n = \\<zero>\"", "lemma (in Ring) Ring: \"Ring R\"", "lemma (in Ring) ring_is_ag:\"aGroup R\"", "lemma (in Ring) ring_zero:\"\\<zero> \\<in> carrier R\"", "lemma (in Ring) ring_one:\"1\\<^sub>r \\<in> carrier R\"", "lemma (in Ring) ring_tOp_closed:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                     x \\<cdot>\\<^sub>r y \\<in> carrier R\"", "lemma (in Ring) ring_tOp_commute:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                x \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r x\"", "lemma (in Ring) ring_distrib1:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n                 \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) = x \\<cdot>\\<^sub>r y \\<plusminus> x \\<cdot>\\<^sub>r z\"", "lemma (in Ring) ring_distrib2:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n                \\<Longrightarrow> (y \\<plusminus> z) \\<cdot>\\<^sub>r x = y \\<cdot>\\<^sub>r x \\<plusminus>  z \\<cdot>\\<^sub>r x\"", "lemma (in Ring) ring_distrib3:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n      y \\<in> carrier R \\<rbrakk> \\<Longrightarrow> (a \\<plusminus> b) \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                                          a \\<cdot>\\<^sub>r x \\<plusminus> a \\<cdot>\\<^sub>r y \\<plusminus> b \\<cdot>\\<^sub>r x \\<plusminus> b \\<cdot>\\<^sub>r y\"", "lemma (in Ring) rEQMulR:\n  \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R; x = y \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r z = y \\<cdot>\\<^sub>r z\"", "lemma (in Ring) ring_tOp_assoc:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n \\<Longrightarrow> (x \\<cdot>\\<^sub>r y) \\<cdot>\\<^sub>r z = x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)\"", "lemma (in Ring) ring_l_one:\"x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x = x\"", "lemma (in Ring) ring_r_one:\"x \\<in> carrier R  \\<Longrightarrow> x \\<cdot>\\<^sub>r 1\\<^sub>r = x\"", "lemma (in Ring) ring_times_0_x:\"x \\<in> carrier R \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>\"", "lemma (in Ring) ring_times_x_0:\"x \\<in> carrier R \\<Longrightarrow>  x \\<cdot>\\<^sub>r \\<zero> = \\<zero>\"", "lemma (in Ring) rMulZeroDiv:\n     \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R; x = \\<zero> \\<or> y = \\<zero> \\<rbrakk> \\<Longrightarrow> x  \\<cdot>\\<^sub>r  y = \\<zero>\"", "lemma (in Ring) ring_inv1:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      -\\<^sub>a (a \\<cdot>\\<^sub>r b) = (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and> -\\<^sub>a (a \\<cdot>\\<^sub>r b) = a \\<cdot>\\<^sub>r (-\\<^sub>a b)\"", "lemma (in Ring) ring_inv1_1:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      -\\<^sub>a (a \\<cdot>\\<^sub>r b) = (-\\<^sub>a a) \\<cdot>\\<^sub>r b\"", "lemma (in Ring) ring_inv1_2:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n                                -\\<^sub>a (a \\<cdot>\\<^sub>r b) = a \\<cdot>\\<^sub>r (-\\<^sub>a b)\"", "lemma (in Ring) ring_times_minusl:\"a \\<in> carrier R \\<Longrightarrow>  -\\<^sub>a a = (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a\"", "lemma (in Ring) ring_times_minusr:\"a \\<in> carrier R \\<Longrightarrow>  -\\<^sub>a a = a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)\"", "lemma (in Ring) ring_inv1_3:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           a \\<cdot>\\<^sub>r b = (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)\"", "lemma (in Ring) ring_distrib4:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n                                x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a x \\<cdot>\\<^sub>r y) = a \\<cdot>\\<^sub>r (b \\<plusminus> (-\\<^sub>a y)) \\<plusminus> (a \\<plusminus> (-\\<^sub>a x)) \\<cdot>\\<^sub>r y\"", "lemma (in Ring) rMulLC:\n     \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R\\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z) = y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)\"", "lemma (in Ring) Zero_ring:\"1\\<^sub>r = \\<zero> \\<Longrightarrow> zeroring R\"", "lemma (in Ring) Zero_ring1:\"\\<not> (zeroring R) \\<Longrightarrow>  1\\<^sub>r \\<noteq> \\<zero>\"", "lemma (in Ring) Sr_one:\"sr R S \\<Longrightarrow> 1\\<^sub>r \\<in> S\"", "lemma (in Ring) Sr_zero:\"sr R S \\<Longrightarrow> \\<zero> \\<in> S\"", "lemma (in Ring) Sr_mOp_closed:\"\\<lbrakk>sr R S; x \\<in> S\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> S\"", "lemma (in Ring) Sr_pOp_closed:\"\\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk> \\<Longrightarrow> x \\<plusminus> y \\<in> S\"", "lemma (in Ring) Sr_tOp_closed:\"\\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> S\"", "lemma (in Ring) Sr_ring:\"sr R S \\<Longrightarrow> Ring (Sr R S)\"", "lemma (in Ring) ring_tOp_rel:\"\\<lbrakk>x\\<in>carrier R; xa\\<in>carrier R; y\\<in>carrier R;\nya \\<in> carrier R \\<rbrakk> \\<Longrightarrow> (x \\<cdot>\\<^sub>r xa) \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r ya) = (x \\<cdot>\\<^sub>r y) \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r ya)\"", "lemma (in Ring) nsClose:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R \\<rbrakk>  \\<Longrightarrow> nscal R x n \\<in> carrier R\"", "lemma (in Ring) nsZero:\n             \"nscal R \\<zero> n = \\<zero>\"", "lemma (in Ring) nsZeroI: \"\\<And> n.  x = \\<zero>  \\<Longrightarrow> nscal R x n = \\<zero>\"", "lemma (in Ring) nsEqElm:  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R; x = y \\<rbrakk>\n        \\<Longrightarrow> (nscal R x n) = (nscal R y n)\"", "lemma (in Ring) nsDistr:  \"x \\<in> carrier R\n        \\<Longrightarrow> (nscal R x n) \\<plusminus> (nscal R x m) = nscal R x (n + m)\"", "lemma (in Ring) nsDistrL:  \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> (nscal R x n) \\<plusminus> (nscal R y n) = nscal R (x \\<plusminus> y) n\"", "lemma (in Ring) nsMulDistrL:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nscal R y n) = nscal R (x \\<cdot>\\<^sub>r y) n\"", "lemma (in Ring) nsMulDistrR:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n        \\<Longrightarrow> (nscal R y n) \\<cdot>\\<^sub>r x = nscal R (y \\<cdot>\\<^sub>r x) n\"", "lemma (in Ring) npClose:\"x \\<in> carrier R \\<Longrightarrow> npow R x n \\<in> carrier R\"", "lemma (in Ring) npMulDistr:\"\\<And> n m. x \\<in> carrier R  \\<Longrightarrow>\n                 (npow R x n) \\<cdot>\\<^sub>r (npow R x m) = npow R x (n + m)\"", "lemma (in Ring) npMulExp:\"\\<And>n m. x \\<in> carrier R\n        \\<Longrightarrow>  npow R (npow R x n) m = npow R x (n * m)\"", "lemma (in Ring) npGTPowZero_sub:\n  \" \\<And> n. \\<lbrakk> x \\<in> carrier R; npow R x m = \\<zero> \\<rbrakk>\n        \\<Longrightarrow>(m \\<le> n) \\<longrightarrow> (npow R x n = \\<zero> )\"", "lemma (in Ring) npGTPowZero:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; npow R x m = \\<zero>; m \\<le> n \\<rbrakk>\n        \\<Longrightarrow> npow R x n = \\<zero>\"", "lemma (in Ring) npOne: \" npow R (1\\<^sub>r) n = 1\\<^sub>r\"", "lemma (in Ring) npZero_sub: \"0 < n \\<longrightarrow> npow R \\<zero> n = \\<zero>\"", "lemma (in Ring) npZero: \"0 < n  \\<Longrightarrow> npow R \\<zero> n = \\<zero>\"", "lemma (in Ring) npMulElmL: \"\\<And> n. \\<lbrakk> x \\<in> carrier R; 0 \\<le> n\\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (npow R x n) = npow R x (Suc n)\"", "lemma (in Ring) npMulEleL: \"\\<And> n. x \\<in> carrier R\n        \\<Longrightarrow> (npow R x n) \\<cdot>\\<^sub>r x =  npow R x (Suc n)\"", "lemma (in Ring) npMulElmR: \"\\<And> n. x \\<in> carrier R\n        \\<Longrightarrow> (npow R x n) \\<cdot>\\<^sub>r x =  npow R x (Suc n)\"", "lemma (in Ring) np_1:\"a \\<in> carrier R \\<Longrightarrow> npow R a (Suc 0) = a\"", "lemma (in aGroup) nsum_memTr: \"(\\<forall>j \\<le> n. f j \\<in> carrier A) \\<longrightarrow>\n                                 nsum A f n \\<in> carrier A\"", "lemma (in aGroup) nsum_mem:\"\\<forall>j \\<le> n. f j \\<in> carrier A \\<Longrightarrow>\n                                 nsum A f n \\<in> carrier A\"", "lemma (in aGroup) nsum_eqTr:\"(\\<forall>j \\<le> n. f j \\<in> carrier A \\<and>\n                                      g j \\<in> carrier A \\<and>\n                                      f j = g j)\n                           \\<longrightarrow>  nsum A f n = nsum A g n\"", "lemma (in aGroup) nsum_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> n. g j \\<in> carrier A;\n                           \\<forall>j \\<le> n. f j = g j\\<rbrakk> \\<Longrightarrow>  nsum A f n = nsum A g n\"", "lemma (in aGroup) nsum_cmp_assoc:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A;\n       g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow>\n       nsum A (cmp (cmp f h) g) n = nsum A (cmp f (cmp h g)) n\"", "lemma (in aGroup) fSum_Suc:\"\\<forall>j \\<in> nset n (n + Suc m). f j \\<in> carrier A \\<Longrightarrow>\n              fSum A f n (n + Suc m) = fSum A f n (n + m) \\<plusminus> f (n + Suc m)\"", "lemma (in aGroup) fSum_eqTr:\"(\\<forall>j \\<in> nset n (n + m). f j \\<in> carrier A \\<and>\n         g j \\<in> carrier A \\<and>  f j = g j)  \\<longrightarrow>\n                       fSum A f  n (n + m) = fSum A g n (n + m)\"", "lemma (in aGroup) fSum_eq:\"\\<lbrakk> \\<forall>j \\<in> nset n (n + m). f j \\<in> carrier A;\n      \\<forall>j \\<in> nset n (n + m). g j \\<in> carrier A; (\\<forall>j\\<in> nset n (n + m). f j = g j)\\<rbrakk>\n       \\<Longrightarrow>\n         fSum A f n (n + m) = fSum A g n (n + m)\"", "lemma (in aGroup) fSum_eq1:\"\\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n       \\<forall>j\\<in>nset n m. g j \\<in> carrier A;  \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk> \\<Longrightarrow>\n         fSum A f n m = fSum A g n m\"", "lemma (in aGroup) fSum_zeroTr:\"(\\<forall>j \\<in> nset n (n + m). f j = \\<zero>)  \\<longrightarrow>\n                       fSum A f  n (n + m) = \\<zero>\"", "lemma (in aGroup) fSum_zero:\"\\<forall>j \\<in> nset n (n + m). f j = \\<zero>  \\<Longrightarrow>\n                       fSum A f  n (n + m) = \\<zero>\"", "lemma (in aGroup) fSum_zero1:\"\\<lbrakk>n < m; \\<forall>j \\<in> nset (Suc n) m. f j = \\<zero>\\<rbrakk>  \\<Longrightarrow>\n                       fSum A f  (Suc n) m = \\<zero>\"", "lemma (in Ring) nsumMulEleL: \"\\<And> n. \\<lbrakk> \\<forall> i. f i \\<in> carrier R; x \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nsum R f n) = nsum R (\\<lambda> i. x \\<cdot>\\<^sub>r (f i)) n\"", "lemma (in Ring) nsumMulElmL:\n  \"\\<And> n. \\<lbrakk> \\<forall> i. f i \\<in> carrier R; x \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nsum R f n) = nsum R (\\<lambda> i. x \\<cdot>\\<^sub>r (f i)) n\"", "lemma (in aGroup) nsumTailTr:\n         \"(\\<forall>j\\<le>(Suc n). f j \\<in> carrier A) \\<longrightarrow>\n          nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\"", "lemma (in aGroup) nsumTail:\n      \"\\<forall>j \\<le> (Suc n). f j \\<in> carrier A \\<Longrightarrow>\n            nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\"", "lemma (in aGroup) nsumElmTail:\n  \"\\<forall>i. f i \\<in> carrier A\n        \\<Longrightarrow> nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\"", "lemma (in aGroup) nsum_addTr:\n  \"(\\<forall>j \\<le> n. f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n   nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\"", "lemma (in aGroup) nsum_add:\n  \"\\<lbrakk> \\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> n. g j \\<in> carrier A\\<rbrakk>  \\<Longrightarrow>\n   nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\"", "lemma (in aGroup) nsumElmAdd:\n  \"\\<lbrakk> \\<forall> i. f i \\<in> carrier A; \\<forall> i. g i \\<in> carrier A\\<rbrakk>\n        \\<Longrightarrow> nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\"", "lemma (in aGroup) nsum_add_nmTr:\n  \"(\\<forall>j \\<le> n. f j \\<in> carrier A) \\<and> (\\<forall>j \\<le> m. g j \\<in> carrier A) \\<longrightarrow>\n   nsum A (jointfun n f m g) (Suc (n + m)) = (nsum A f n) \\<plusminus> (nsum A g m)\"", "lemma (in aGroup) nsum_add_nm:\n\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> m. g j \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n   nsum A (jointfun n f m g) (Suc (n + m)) = (nsum A f n) \\<plusminus> (nsum A g m)\"", "lemma (in Ring) npeSum2_sub_muly:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n        y \\<cdot>\\<^sub>r(nsum R (\\<lambda>i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                (n choose i)) n)\n        = nsum R (\\<lambda>i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y (i+1)))\n                                (n choose i)) n\"", "lemma binomial_n0: \"(Suc n choose 0) = (n choose 0)\"", "lemma binomial_ngt_diff:\n  \"(n choose Suc n) = (Suc n choose Suc n) - (n choose n)\"", "lemma binomial_ngt_0: \"(n choose Suc n) = 0\"", "lemma diffLessSuc: \"m \\<le> n \\<Longrightarrow> Suc (n-m) = Suc n - m\"", "lemma (in Ring) npow_suc_i:\n  \"\\<lbrakk> x \\<in> carrier R; i \\<le> n \\<rbrakk>\n        \\<Longrightarrow> npow R x (Suc n - i) =  x \\<cdot>\\<^sub>r (npow R x (n-i))\"", "lemma (in Ring) npeSum2_sub_mulx: \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n  x \\<cdot>\\<^sub>r (nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                                        (n choose i)) n)\n   = (nsum R (\\<lambda>i. nscal R\n                          ((npow R x (Suc n - Suc i)) \\<cdot>\\<^sub>r (npow R y (Suc i)))\n                          (n choose Suc i)) n) \\<plusminus>\n                (nscal R ((npow R x (Suc n - 0)) \\<cdot>\\<^sub>r (npow R y 0))\n                        (Suc n choose 0))\"", "lemma (in Ring) npeSum2_sub_mulx2:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n        x \\<cdot>\\<^sub>r (nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                (n choose i)) n)\n        = (nsum R  (\\<lambda>i. nscal R\n                          ((npow R x (n - i)) \\<cdot>\\<^sub>r ((npow R y i) \\<cdot>\\<^sub>r y ))\n                          (n choose Suc i)) n) \\<plusminus>\n                (\\<zero> \\<plusminus> ((x \\<cdot>\\<^sub>r (npow R x n)) \\<cdot>\\<^sub>r (1\\<^sub>r)))\"", "lemma (in Ring) npeSum2:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<plusminus> y) n =\n                nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                       ( n choose i) ) n\"", "lemma (in aGroup) nsum_zeroTr:\n  \"\\<And> n. (\\<forall> i. i \\<le> n \\<longrightarrow>  f i = \\<zero>) \\<longrightarrow> (nsum A f n = \\<zero>)\"", "lemma (in Ring) npAdd:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R;\n     npow R x m = \\<zero>; npow R y n = \\<zero> \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<plusminus> y) (m + n) = \\<zero>\"", "lemma (in Ring) npInverse:\n  \"\\<And>n. x \\<in> carrier R\n        \\<Longrightarrow> npow R (-\\<^sub>a x) n = npow R x n\n            \\<or> npow R (-\\<^sub>a x) n = -\\<^sub>a (npow R x n)\"", "lemma (in Ring) npMul:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<cdot>\\<^sub>r y) n = (npow R x n) \\<cdot>\\<^sub>r (npow R y n)\"", "lemma ridmap_surjec:\"Ring A \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> (ridmap A)\"", "lemma rHom_aHom:\"f \\<in> rHom A R \\<Longrightarrow> f \\<in> aHom A R\"", "lemma rimg_carrier:\"f \\<in> rHom A R \\<Longrightarrow> carrier (rimg A R f) = f ` (carrier A)\"", "lemma rHom_mem:\"\\<lbrakk> f \\<in> rHom A R; a \\<in> carrier A \\<rbrakk> \\<Longrightarrow> f a \\<in> carrier R\"", "lemma rHom_func:\"f \\<in> rHom A R \\<Longrightarrow> f \\<in> carrier A \\<rightarrow> carrier R\"", "lemma ringhom1:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n                    f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) = (f x) \\<plusminus>\\<^bsub>R\\<^esub> (f y)\"", "lemma rHom_inv_inv:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R \\<rbrakk>\n \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x) = -\\<^sub>a\\<^bsub>R\\<^esub> (f x)\"", "lemma rHom_0_0:\"\\<lbrakk> Ring A; Ring R; f \\<in> rHom A R \\<rbrakk>  \\<Longrightarrow> f (\\<zero>\\<^bsub>A\\<^esub>) = \\<zero>\\<^bsub>R\\<^esub>\"", "lemma rHom_tOp:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) = (f x) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (f y)\"", "lemma rHom_add:\"\\<lbrakk>f \\<in> rHom A R; x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                   f (x \\<plusminus>\\<^bsub>A\\<^esub> y) = (f x) \\<plusminus>\\<^bsub>R\\<^esub> (f y)\"", "lemma rHom_one:\"\\<lbrakk> Ring A; Ring R;f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (1\\<^sub>r\\<^bsub>A\\<^esub>) = (1\\<^sub>r\\<^bsub>R\\<^esub>)\"", "lemma rHom_npow:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                    f (x^\\<^bsup>A n\\<^esup>) = (f x)^\\<^bsup>R n\\<^esup>\"", "lemma rHom_compos:\"\\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C\\<rbrakk> \\<Longrightarrow>\n                   compos A g f \\<in> rHom A C\"", "lemma rimg_ag:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> aGroup (rimg A R f)\"", "lemma rimg_ring:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> Ring (rimg A R f)\"", "lemma (in Ring) ideal_asubg:\"ideal R I \\<Longrightarrow> R +> I\"", "lemma (in Ring) ideal_pOp_closed:\"\\<lbrakk>ideal R I; x \\<in> I; y \\<in> I \\<rbrakk>\n                                                   \\<Longrightarrow> x \\<plusminus> y \\<in> I\"", "lemma (in Ring) ideal_nsum_closedTr:\"ideal R I \\<Longrightarrow>\n                                      (\\<forall>j \\<le> n. f j \\<in> I) \\<longrightarrow>  nsum R f n \\<in> I\"", "lemma (in Ring) ideal_nsum_closed:\"\\<lbrakk>ideal R I; \\<forall>j \\<le> n. f j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                             nsum R f n \\<in> I\"", "lemma (in Ring) ideal_subset1:\"ideal R I \\<Longrightarrow> I \\<subseteq> carrier R\"", "lemma (in Ring) ideal_subset:\"\\<lbrakk>ideal R I; h \\<in> I\\<rbrakk> \\<Longrightarrow> h \\<in> carrier R\"", "lemma (in Ring) ideal_ring_multiple:\"\\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n       r \\<cdot>\\<^sub>r x \\<in> I\"", "lemma (in Ring) ideal_ring_multiple1:\"\\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n       x \\<cdot>\\<^sub>r r \\<in> I\"", "lemma (in Ring) ideal_npow_closedTr:\"\\<lbrakk>ideal R I; x \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\"", "lemma (in Ring) ideal_npow_closed:\"\\<lbrakk>ideal R I; x \\<in> I; 0 < n\\<rbrakk> \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\"", "lemma (in Ring) times_modTr:\"\\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n b' \\<in> carrier R; ideal R I; a \\<plusminus> (-\\<^sub>a b) \\<in> I; a' \\<plusminus> (-\\<^sub>a b') \\<in> I\\<rbrakk> \\<Longrightarrow>\n                           a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a (b \\<cdot>\\<^sub>r b')) \\<in> I\"", "lemma (in Ring) ideal_inv1_closed:\"\\<lbrakk> ideal R I; x \\<in> I \\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> I\"", "lemma (in Ring) ideal_zero:\"ideal R I  \\<Longrightarrow> \\<zero> \\<in> I\"", "lemma (in Ring) ideal_zero_forall:\"\\<forall>I. ideal R I \\<longrightarrow>  \\<zero> \\<in> I\"", "lemma (in Ring) ideal_ele_sumTr1:\"\\<lbrakk> ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n          a \\<plusminus> b \\<in> I; a \\<in> I \\<rbrakk> \\<Longrightarrow> b \\<in> I\"", "lemma (in Ring) ideal_ele_sumTr2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n                a \\<plusminus> b \\<in> I; b \\<in> I\\<rbrakk> \\<Longrightarrow> a \\<in> I\"", "lemma (in Ring) ideal_condition:\"\\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n       \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> (-\\<^sub>a y) \\<in> I; \\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I \\<rbrakk> \\<Longrightarrow>\n                                   ideal R I\"", "lemma (in Ring) ideal_condition1:\"\\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n  \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I; \\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I \\<rbrakk> \\<Longrightarrow> ideal R I\"", "lemma (in Ring) zero_ideal:\"ideal R {\\<zero>}\"", "lemma (in Ring) whole_ideal:\"ideal R (carrier R)\"", "lemma (in Ring) ideal_inc_one:\"\\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I \\<rbrakk> \\<Longrightarrow> I = carrier R\"", "lemma (in Ring) ideal_inc_one1:\"ideal R I \\<Longrightarrow>\n                              (1\\<^sub>r \\<in> I) = (I = carrier R)\"", "lemma (in Ring) ideal_inc_unit:\"\\<lbrakk>ideal R I; a \\<in> I; Unit R a\\<rbrakk> \\<Longrightarrow> 1\\<^sub>r \\<in> I\"", "lemma (in Ring) proper_ideal:\"\\<lbrakk>ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk> \\<Longrightarrow> I \\<noteq> carrier R\"", "lemma (in Ring) ideal_inc_unit1:\"\\<lbrakk>a \\<in> carrier R; Unit R a; ideal R I; a \\<in> I\\<rbrakk>\n                        \\<Longrightarrow> I = carrier R\"", "lemma (in Ring) int_ideal:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow> ideal R (I \\<inter> J)\"", "lemma (in Ring) set_sum_mem:\"\\<lbrakk>a \\<in> I; b \\<in> J; I \\<subseteq> carrier R; J \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n             a \\<plusminus> b \\<in> I \\<minusplus> J\"", "lemma (in Ring) sum_ideals:\"\\<lbrakk>ideal R I1; ideal R I2\\<rbrakk> \\<Longrightarrow> ideal R (I1 \\<minusplus> I2)\"", "lemma (in Ring) sum_ideals_la1:\"\\<lbrakk>ideal R I1; ideal R I2\\<rbrakk> \\<Longrightarrow> I1 \\<subseteq> (I1 \\<minusplus> I2)\"", "lemma (in Ring) sum_ideals_la2:\"\\<lbrakk>ideal R I1; ideal R I2 \\<rbrakk> \\<Longrightarrow> I2 \\<subseteq> (I1 \\<minusplus> I2)\"", "lemma (in Ring) sum_ideals_cont:\"\\<lbrakk>ideal R I;  A \\<subseteq> I; B \\<subseteq> I \\<rbrakk> \\<Longrightarrow> A \\<minusplus> B \\<subseteq> I\"", "lemma (in Ring) ideals_set_sum:\"\\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<minusplus> B\\<rbrakk> \\<Longrightarrow>\n             \\<exists>h\\<in>A. \\<exists>k\\<in>B. x = h \\<plusminus> k\"", "lemma (in Ring) a_in_principal:\"a \\<in> carrier R \\<Longrightarrow> a \\<in> Rxa R a\"", "lemma (in Ring) principal_ideal:\"a \\<in> carrier R \\<Longrightarrow> ideal R (Rxa R a)\"", "lemma (in Ring) rxa_in_Rxa:\"\\<lbrakk>a \\<in> carrier R; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                     r \\<cdot>\\<^sub>r a \\<in> Rxa R a\"", "lemma (in Ring) Rxa_one:\"Rxa R 1\\<^sub>r = carrier R\"", "lemma (in Ring) Rxa_zero:\"Rxa R \\<zero> = {\\<zero>}\"", "lemma (in Ring) Rxa_nonzero:\"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> Rxa R a \\<noteq> {\\<zero>}\"", "lemma (in Ring) ideal_cont_Rxa:\"\\<lbrakk>ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow> Rxa R a \\<subseteq> I\"", "lemma (in Ring) Rxa_mult_smaller:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                    Rxa R (a \\<cdot>\\<^sub>r b) \\<subseteq> Rxa R b\"", "lemma (in Ring) id_ideal_psub_sum:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                                             I \\<subset> I \\<minusplus> Rxa R a\"", "lemma (in Ring) mul_two_principal_idealsTr:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n         x \\<in> Rxa R a; y \\<in> Rxa R b\\<rbrakk> \\<Longrightarrow> \\<exists>r\\<in>carrier R. x \\<cdot>\\<^sub>r y = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)\"", "lemma (in Ring) sum_of_prideals0:\n      \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow> ideal R (sum_pr_ideals R f n)\"", "lemma (in Ring) sum_of_prideals:\"\\<lbrakk>\\<forall>l \\<le> n. f l \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                      ideal R (sum_pr_ideals R f n)\"", "lemma (in Ring) sum_of_prideals1:\"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow>\n                                    f ` {i. i \\<le> n} \\<subseteq> (sum_pr_ideals R f n)\"", "lemma (in Ring) sum_of_prideals2:\"\\<forall>l \\<le> n. f l \\<in> carrier R\n               \\<Longrightarrow>  f ` {i. i \\<le> n} \\<subseteq> (sum_pr_ideals R f n)\"", "lemma (in Ring) sum_of_prideals3:\"ideal R I \\<Longrightarrow>\n      \\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<and> (f ` {i. i \\<le> n} \\<subseteq> I) \\<longrightarrow>\n          (sum_pr_ideals R f n \\<subseteq> I)\"", "lemma (in Ring) sum_of_prideals4:\"\\<lbrakk>ideal R I; \\<forall>l \\<le> n. f l \\<in> carrier R;\n       (f ` {i. i \\<le> n} \\<subseteq> I)\\<rbrakk> \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> I\"", "lemma ker_ideal:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> ideal A (ker\\<^bsub>A,R\\<^esub> f)\"", "lemma ring_of_integers:\"Ring Zr\"", "lemma Zr_zero:\"\\<zero>\\<^bsub>Zr\\<^esub> = 0\"", "lemma Zr_one:\"1\\<^sub>r\\<^bsub>Zr\\<^esub> = 1\"", "lemma Zr_minus:\"-\\<^sub>a\\<^bsub>Zr\\<^esub> n = - n\"", "lemma Zr_add:\"n \\<plusminus>\\<^bsub>Zr\\<^esub> m = n + m\"", "lemma Zr_times:\"n \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> m = n * m\"", "lemma Zr_gen_Zleast:\"\\<lbrakk>ideal Zr I; I \\<noteq> {0::int}\\<rbrakk> \\<Longrightarrow>\n                       Rxa Zr (lev I) = I\"", "lemma Zr_pir:\"ideal Zr I \\<Longrightarrow> \\<exists>n. Rxa Zr n = I\"", "lemma (in Ring) mem_set_ar_cos:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                         a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_ar_cos R I\"", "lemma (in Ring) I_in_set_ar_cos:\"ideal R I \\<Longrightarrow> I \\<in> set_ar_cos R I\"", "lemma (in Ring) ar_coset_same1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n       b \\<plusminus> (-\\<^sub>a a) \\<in> I \\<rbrakk> \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) ar_coset_same2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n                                  a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>  b \\<plusminus> (-\\<^sub>a a) \\<in> I\"", "lemma (in Ring) ar_coset_same3:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk> \\<Longrightarrow>\n                               a\\<in>I\"", "lemma (in Ring) ar_coset_same3_1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                                                    a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\"", "lemma (in Ring) ar_coset_same4:\"\\<lbrakk>ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                     a \\<uplus>\\<^bsub>R\\<^esub> I = I\"", "lemma (in Ring) ar_coset_same4_1:\"\\<lbrakk>ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk> \\<Longrightarrow> a \\<notin> I\"", "lemma (in Ring) belong_ar_coset1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n                 x \\<plusminus> (-\\<^sub>a a) \\<in> I\\<rbrakk> \\<Longrightarrow>  x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) a_in_ar_coset:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) ar_coset_subsetD:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I \\<rbrakk> \\<Longrightarrow>\n                           x \\<in> carrier R\"", "lemma (in Ring) ar_cos_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                 a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\"", "lemma (in Ring) mem_ar_coset1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                                 \\<exists>h\\<in>I. h \\<plusminus> a = x\"", "lemma (in Ring) ar_coset_mem2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                           \\<exists>h\\<in>I. x = a \\<plusminus> h\"", "lemma (in Ring) belong_ar_coset2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I \\<rbrakk>\n                                    \\<Longrightarrow> x \\<plusminus> (-\\<^sub>a a) \\<in> I\"", "lemma (in Ring) ar_c_top: \"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (c_top (b_ag R) I (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I)) = (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) quotient_ring_tr1:\"\\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n                b1 \\<in> carrier R; b2 \\<in> carrier R;\n                a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I; b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                             (a1 \\<cdot>\\<^sub>r b1) \\<uplus>\\<^bsub>R\\<^esub> I = (a2 \\<cdot>\\<^sub>r b2) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) rcostOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                    rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) carrier_qring:\"ideal R I \\<Longrightarrow>\n                               carrier (qring R I) = set_rcs (b_ag R) I\"", "lemma (in Ring) carrier_qring1:\"ideal R I \\<Longrightarrow>\n                                carrier (qring R I) = set_ar_cos R I\"", "lemma (in Ring) qring_ring:\"ideal R I \\<Longrightarrow> Ring (qring R I)\"", "lemma (in Ring) qring_carrier:\"ideal R I \\<Longrightarrow>\n              carrier (qring R I)  = {X. \\<exists>a\\<in> carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}\"", "lemma (in Ring) qring_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                 a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> carrier (qring R I)\"", "lemma (in Ring) qring_pOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R \\<rbrakk>\n \\<Longrightarrow> pop (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) qring_zero:\"ideal R I \\<Longrightarrow> zero (qring R I) = I\"", "lemma (in Ring) qring_zero_1:\"\\<lbrakk>a \\<in> carrier R; ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk> \\<Longrightarrow>\n                                    a \\<in> I\"", "lemma (in Ring) Qring_fix1:\"\\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I\"", "lemma (in Ring) ar_cos_same:\"\\<lbrakk>a \\<in> carrier R; ideal R I; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                                x \\<uplus>\\<^bsub>R\\<^esub> I = a \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) qring_tOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                tp (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma rind_hom_well_def:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A \\<rbrakk> \\<Longrightarrow>\n                                   f a = (f\\<degree>\\<^bsub>A,R\\<^esub>) (a \\<uplus>\\<^bsub>A\\<^esub> (ker\\<^bsub>A,R\\<^esub> f))\"", "lemma (in Ring) set_r_ar_cos:\"ideal R I \\<Longrightarrow>\n                 set_rcs (b_ag R) I = set_ar_cos R I\"", "lemma set_r_ar_cos_ker:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                     set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) = set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\"", "lemma ind_hom_rhom:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                                    (f\\<degree>\\<^bsub>A,R\\<^esub>) \\<in> rHom (qring A (ker\\<^bsub>A,R\\<^esub> f)) R\"", "lemma ind_hom_injec:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                              injec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\"", "lemma rhom_to_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                                   f \\<in> rHom A (rimg A R f)\"", "lemma ker_to_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                         ker\\<^bsub>A,R\\<^esub> f = ker\\<^bsub>A,(rimg A R f)\\<^esub> f\"", "lemma indhom_eq:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> f\\<degree>\\<^bsub>A,(rimg A R f)\\<^esub> = f\\<degree>\\<^bsub>A,R\\<^esub>\"", "lemma indhom_bijec2_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                    bijec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),(rimg A R f)\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\"", "lemma surjec_ind_bijec:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; surjec\\<^bsub>A,R\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n     bijec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\"", "lemma ridmap_ind_bijec:\"Ring A \\<Longrightarrow>\n     bijec\\<^bsub>(qring A (ker\\<^bsub>A,A\\<^esub> (ridmap A))),A\\<^esub> ((ridmap A)\\<degree>\\<^bsub>A,A\\<^esub>)\"", "lemma ker_of_idmap:\"Ring A \\<Longrightarrow> ker\\<^bsub>A,A\\<^esub> (ridmap A) = {\\<zero>\\<^bsub>A\\<^esub>}\"", "lemma ring_natural_isom:\"Ring A \\<Longrightarrow>\n         bijec\\<^bsub>(qring A {\\<zero>\\<^bsub>A\\<^esub>}),A\\<^esub> ((ridmap A)\\<degree>\\<^bsub>A,A\\<^esub>)\"", "lemma pj_Hom:\"\\<lbrakk>Ring R; ideal R I\\<rbrakk> \\<Longrightarrow> (pj R I) \\<in> rHom R (qring R I)\"", "lemma pj_mem:\"\\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow> pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma pj_zero:\"\\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                         (pj R I x = \\<zero>\\<^bsub>(R /\\<^sub>r I)\\<^esub>) = (x \\<in> I)\"", "lemma pj_surj_to:\"\\<lbrakk>Ring R; ideal R J; X \\<in> carrier (R /\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                   \\<exists>r\\<in> carrier R. pj R J r = X\"", "lemma invim_of_ideal:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J \\<rbrakk> \\<Longrightarrow>\n  ideal R (rInvim R (qring R I) (pj R I) J)\"", "lemma pj_invim_cont_I:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J\\<rbrakk> \\<Longrightarrow>\n                         I \\<subseteq> (rInvim R (qring R I) (pj R I) J)\"", "lemma pj_invim_mono1:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J1;\n      ideal (qring R I) J2; J1 \\<subseteq> J2 \\<rbrakk> \\<Longrightarrow>\n      (rInvim R (qring R I) (pj R I) J1) \\<subseteq> (rInvim R (qring R I) (pj R I) J2)\"", "lemma pj_img_ideal:\"\\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk> \\<Longrightarrow>\n                                  ideal (qring R I) ((pj R I)`J)\"", "lemma npQring:\"\\<lbrakk>Ring R; ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      npow (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) n = (npow R a n) \\<uplus>\\<^bsub>R\\<^esub> I\"", "lemma (in Ring) maximal_ideal_ideal:\"\\<lbrakk>maximal_ideal R mx\\<rbrakk> \\<Longrightarrow> ideal R mx\"", "lemma (in Ring) maximal_ideal_proper:\"maximal_ideal R mx \\<Longrightarrow> 1\\<^sub>r \\<notin> mx\"", "lemma (in Ring) prime_ideal_ideal:\"prime_ideal R I \\<Longrightarrow> ideal R I\"", "lemma (in Ring) prime_ideal_proper:\"prime_ideal R I \\<Longrightarrow> I \\<noteq> carrier R\"", "lemma (in Ring) prime_ideal_proper1:\"prime_ideal R p \\<Longrightarrow> 1\\<^sub>r \\<notin> p\"", "lemma (in Ring) primary_ideal_ideal:\"primary_ideal R q \\<Longrightarrow> ideal R q\"", "lemma (in Ring)  primary_ideal_proper1:\"primary_ideal R q \\<Longrightarrow> 1\\<^sub>r \\<notin> q\"", "lemma (in Ring) prime_elems_mult_not:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n                y \\<in> carrier R; x \\<notin> P; y \\<notin> P \\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<notin> P\"", "lemma (in Ring) prime_is_primary:\"prime_ideal R p \\<Longrightarrow> primary_ideal R p\"", "lemma (in Ring) maximal_prime_Tr0:\"\\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx\\<rbrakk>\n              \\<Longrightarrow>  mx \\<minusplus> (Rxa R x) = carrier R\"", "lemma (in Ring) maximal_prime:\"maximal_ideal R mx \\<Longrightarrow> prime_ideal R mx\"", "lemma (in Ring) chains_un:\"\\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}; c \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> ideal R (\\<Union>c)\"", "lemma (in Ring) zeroring_no_maximal:\"zeroring R \\<Longrightarrow> \\<not> (\\<exists>I. maximal_ideal R I)\"", "lemma (in Ring) id_maximal_Exist:\"\\<not>(zeroring R) \\<Longrightarrow> \\<exists>I. maximal_ideal R I\"", "lemma (in Ring) ideal_Int_ideal:\"\\<lbrakk>S \\<subseteq> {I. ideal R I}; S\\<noteq>{}\\<rbrakk> \\<Longrightarrow>\n                                                 ideal R (\\<Inter> S)\"", "lemma (in Ring) sum_prideals_Int:\"\\<lbrakk>\\<forall>l \\<le> n. f l \\<in> carrier R;\n                S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk> \\<Longrightarrow>\n                                  (sum_pr_ideals R f n) = \\<Inter> S\"", "lemma (in Ring) prod_mem_prod_ideals:\"\\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J\\<rbrakk> \\<Longrightarrow>\n                            i \\<cdot>\\<^sub>r j \\<in> (I \\<diamondsuit>\\<^sub>r J)\"", "lemma (in Ring) ideal_prod_ideal:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow>\n                                        ideal R (I \\<diamondsuit>\\<^sub>r J)\"", "lemma (in Ring) ideal_prod_commute:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow>\n                                              I \\<diamondsuit>\\<^sub>r J = J \\<diamondsuit>\\<^sub>r I\"", "lemma (in Ring) ideal_prod_subTr:\"\\<lbrakk>ideal R I; ideal R J; ideal R C;\n                        \\<forall>i\\<in>I. \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk> \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> C\"", "lemma (in Ring) n_prod_idealTr:\n     \"(\\<forall>k \\<le> n. ideal R (J k)) \\<longrightarrow> ideal R (ideal_n_prod R n J)\"", "lemma (in Ring) n_prod_ideal:\"\\<lbrakk>\\<forall>k \\<le> n. ideal R (J k)\\<rbrakk>\n                               \\<Longrightarrow>  ideal R (ideal_n_prod R n J)\"", "lemma (in Ring) ideal_prod_la1:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow> (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> I\"", "lemma (in Ring) ideal_prod_el1:\"\\<lbrakk>ideal R I; ideal R J; a \\<in> (I \\<diamondsuit>\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                           a \\<in> I\"", "lemma (in Ring) ideal_prod_la2:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow> (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> J\"", "lemma (in Ring) ideal_prod_sub_Int:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow>\n                     (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> I \\<inter> J\"", "lemma (in Ring) ideal_prod_el2:\"\\<lbrakk>ideal R I; ideal R J; a \\<in> (I \\<diamondsuit>\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                                 a \\<in> J\"", "lemma (in Ring) ele_n_prodTr0:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). ideal R (J k);\n             a \\<in> i\\<Pi>\\<^bsub>R,(Suc n)\\<^esub> J \\<rbrakk> \\<Longrightarrow> a \\<in> (i\\<Pi>\\<^bsub>R,n\\<^esub> J) \\<and> a \\<in> (J (Suc n))\"", "lemma (in Ring) ele_n_prodTr1:\n      \"(\\<forall>k \\<le> n. ideal R (J k)) \\<and> a \\<in> ideal_n_prod R n J \\<longrightarrow>\n                                             (\\<forall>k \\<le> n. a \\<in> (J k))\"", "lemma (in Ring) ele_n_prod:\"\\<lbrakk>\\<forall>k \\<le> n. ideal R (J k);\n                       a \\<in> ideal_n_prod R n J \\<rbrakk> \\<Longrightarrow>  \\<forall>k \\<le> n. a \\<in> (J k)\"", "lemma (in Ring) idealprod_whole_l:\"ideal R I \\<Longrightarrow> (carrier R) \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> I = I\"", "lemma (in Ring) idealprod_whole_r:\"ideal R I \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r (carrier R) = I\"", "lemma (in Ring) idealpow_1_self:\"ideal R I \\<Longrightarrow> I \\<^bsup>\\<diamondsuit>R (Suc 0)\\<^esup> = I\"", "lemma (in Ring) ideal_pow_ideal:\"ideal R I \\<Longrightarrow> ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\"", "lemma (in Ring) ideal_prod_prime:\"\\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n                          I \\<diamondsuit>\\<^sub>r J \\<subseteq> P \\<rbrakk> \\<Longrightarrow> I \\<subseteq> P \\<or> J \\<subseteq> P\"", "lemma (in Ring) ideal_n_prod_primeTr:\"prime_ideal R P \\<Longrightarrow>\n       (\\<forall>k \\<le> n. ideal R (J k)) \\<longrightarrow> (ideal_n_prod R n J \\<subseteq> P) \\<longrightarrow>\n                                               (\\<exists>i \\<le> n. (J i) \\<subseteq> P)\"", "lemma (in Ring) ideal_n_prod_prime:\"\\<lbrakk>prime_ideal R P;\n            \\<forall>k \\<le> n. ideal R (J k); ideal_n_prod R n J \\<subseteq> P\\<rbrakk> \\<Longrightarrow>\n                                            \\<exists>i \\<le> n. (J i) \\<subseteq> P\"", "lemma (in Ring) prod_primeTr:\"\\<lbrakk>prime_ideal R P; ideal R A; \\<not> A \\<subseteq> P;\n                ideal R B; \\<not> B \\<subseteq> P \\<rbrakk> \\<Longrightarrow> \\<exists>x. x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P\"", "lemma (in Ring) prod_primeTr1:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). prime_ideal R (P k);\n       ideal R A; \\<forall>l \\<le> (Suc n). \\<not> (A \\<subseteq> P l);\n       \\<forall>k \\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l); i \\<le> (Suc n)\\<rbrakk> \\<Longrightarrow>\n       \\<forall>l \\<le> n. ppa R P A i l \\<in> A \\<and>\n                  ppa R P A i l \\<in> (P (skip i l)) \\<and> ppa R P A i l \\<notin> (P i)\"", "lemma (in Ring) ppa_mem:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). prime_ideal R (P k); ideal R A;\n      \\<forall>l \\<le> (Suc n). \\<not> (A \\<subseteq> P l);\n      \\<forall>k \\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l);\n      i  \\<le> (Suc n); l \\<le> n\\<rbrakk> \\<Longrightarrow> ppa R P A i l \\<in> carrier R\"", "lemma (in Ring) nsum_memrTr:\"(\\<forall>i \\<le> n. f i \\<in> carrier R) \\<longrightarrow>\n                             (\\<forall>l \\<le> n. nsum R f l \\<in> carrier R)\"", "lemma (in Ring) nsum_memr:\"\\<forall>i \\<le> n. f i \\<in> carrier R \\<Longrightarrow>\n                          \\<forall>l \\<le> n. nsum R f l \\<in> carrier R\"", "lemma (in Ring) nsum_ideal_incTr:\"ideal R A \\<Longrightarrow>\n               (\\<forall>i \\<le> n. f i \\<in> A) \\<longrightarrow>  nsum R f n \\<in> A\"", "lemma (in Ring) nsum_ideal_inc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> A\\<rbrakk> \\<Longrightarrow>\n                    nsum R f n \\<in> A\"", "lemma (in Ring) nsum_ideal_excTr:\"ideal R A \\<Longrightarrow>\n      (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and> (\\<exists>j \\<le> n. (\\<forall>l \\<in> {i. i \\<le> n} -{j}. f l \\<in> A)\n       \\<and> (f j \\<notin> A)) \\<longrightarrow> nsum R f n \\<notin> A\"", "lemma (in Ring) nsum_ideal_exc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> carrier R;\n      \\<exists>j \\<le> n. (\\<forall>l\\<in>{i. i \\<le> n} -{j}. f l \\<in> A) \\<and> (f j \\<notin> A) \\<rbrakk> \\<Longrightarrow> nsum R f n \\<notin> A\"", "lemma (in Ring) nprod_memTr:\"(\\<forall>i \\<le> n. f i \\<in> carrier R) \\<longrightarrow>\n                             (\\<forall>l. l \\<le> n \\<longrightarrow>  nprod R f l \\<in> carrier R)\"", "lemma (in Ring) nprod_mem:\"\\<lbrakk>\\<forall>i \\<le> n. f i \\<in> carrier R; l \\<le> n\\<rbrakk> \\<Longrightarrow>\n                              nprod R f l \\<in> carrier R\"", "lemma (in Ring) ideal_nprod_incTr:\"ideal R A \\<Longrightarrow>\n                (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and>\n                             (\\<exists>l \\<le> n. f l \\<in> A) \\<longrightarrow> nprod R f n \\<in> A\"", "lemma (in Ring) ideal_nprod_inc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> carrier R;\n                \\<exists>l \\<le> n. f l \\<in> A\\<rbrakk> \\<Longrightarrow> nprod R f n \\<in> A\"", "lemma (in Ring) nprod_excTr:\"prime_ideal R P \\<Longrightarrow>\n          (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and> (\\<forall>l \\<le> n. f l \\<notin> P) \\<longrightarrow>\n                                                     nprod R f n \\<notin> P\"", "lemma (in Ring) prime_nprod_exc:\"\\<lbrakk>prime_ideal R P; \\<forall>i \\<le> n. f i \\<in> carrier R;\n                \\<forall>l \\<le> n. f l \\<notin> P\\<rbrakk> \\<Longrightarrow> nprod R f n \\<notin> P\"", "lemma (in Ring) id_nilrad_ideal:\"ideal R (nilrad R)\"", "lemma (in Ring) id_rad_invim:\"ideal R I \\<Longrightarrow>\n       rad_ideal R I = (rInvim R (qring R I) (pj R I ) (nilrad (qring R I)))\"", "lemma (in Ring) id_rad_ideal:\"ideal R I \\<Longrightarrow> ideal R (rad_ideal R I)\"", "lemma (in Ring) id_rad_cont_I:\"ideal R I \\<Longrightarrow> I \\<subseteq> (rad_ideal R I)\"", "lemma (in Ring) id_rad_set:\"ideal R I \\<Longrightarrow>\n       rad_ideal R I = {x. x \\<in> carrier R \\<and> (\\<exists>n. npow R x n \\<in> I)}\"", "lemma (in Ring) rad_primary_prime:\"primary_ideal R q \\<Longrightarrow>\n                                    prime_ideal R (rad_ideal R q)\"", "lemma (in Ring) npow_notin_prime:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n                                \\<Longrightarrow> \\<forall>n. npow R x n \\<notin> P\"", "lemma (in Ring) npow_in_prime:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n                               \\<exists>n. npow R x n \\<in> P \\<rbrakk> \\<Longrightarrow> x \\<in> P\"", "lemma (in Ring) mul_closed_set_sub:\"mul_closed_set R S \\<Longrightarrow> S \\<subseteq> carrier R\"", "lemma (in Ring) mul_closed_set_tOp_closed:\"\\<lbrakk>mul_closed_set R S; s \\<in> S;\n                            t \\<in> S\\<rbrakk> \\<Longrightarrow> s \\<cdot>\\<^sub>r t \\<in> S\"", "lemma (in Corps) f_inv_unique:\"\\<lbrakk> x \\<in> carrier K - {\\<zero>}; x' \\<in> carrier K;\n      x'' \\<in> carrier K; x' \\<cdot>\\<^sub>r  x = 1\\<^sub>r; x'' \\<cdot>\\<^sub>r x = 1\\<^sub>r \\<rbrakk> \\<Longrightarrow> x' = x''\"", "lemma (in Corps) invf_inv:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n                (invf K x) \\<in> carrier K \\<and> (invf K x) \\<cdot>\\<^sub>r x = 1\\<^sub>r \"", "lemma (in Idomain) idom_is_ring: \"Ring R\"", "lemma (in Idomain) idom_tOp_nonzeros:\"\\<lbrakk>x \\<in> carrier R;\n       y \\<in> carrier R; x \\<noteq> \\<zero>;  y \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>\"", "lemma (in Idomain) idom_potent_nonzero:\n       \"\\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> npow R x n \\<noteq> \\<zero> \"", "lemma (in Idomain) idom_potent_unit:\"\\<lbrakk>a \\<in> carrier R; 0 < n\\<rbrakk>\n                 \\<Longrightarrow> (Unit R a) = (Unit R (npow R a n))\"", "lemma (in Idomain) idom_mult_cancel_r:\"\\<lbrakk>a \\<in> carrier R;\n       b \\<in> carrier R; c \\<in> carrier R; c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c\\<rbrakk> \\<Longrightarrow> a = b\"", "lemma (in Idomain) idom_mult_cancel_l:\"\\<lbrakk>a \\<in> carrier R;\n      b \\<in> carrier R; c \\<in> carrier R; c \\<noteq> \\<zero>; c \\<cdot>\\<^sub>r a = c \\<cdot>\\<^sub>r b\\<rbrakk> \\<Longrightarrow> a = b\"", "lemma (in Corps) invf_closed1:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n                               invf K x \\<in> (carrier K) - {\\<zero>}\"", "lemma (in Corps) linvf:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow> (invf K x) \\<cdot>\\<^sub>r x = 1\\<^sub>r\"", "lemma (in Corps) field_is_ring:\"Ring K\"", "lemma (in Corps) invf_one:\"1\\<^sub>r \\<noteq> \\<zero>  \\<Longrightarrow> invf K (1\\<^sub>r) = 1\\<^sub>r\"", "lemma (in Corps) field_tOp_assoc:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; z \\<in> carrier K\\<rbrakk>\n                                \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =  x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)\"", "lemma (in Corps) field_tOp_commute:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                                \\<Longrightarrow> x \\<cdot>\\<^sub>r y  =  y \\<cdot>\\<^sub>r x\"", "lemma (in Corps) field_inv_inv:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup> = x\"", "lemma (in Corps) field_is_idom:\"Idomain K\"", "lemma (in Corps) field_potent_nonzero:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                       x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\"", "lemma (in Corps) field_potent_nonzero1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup>  \\<noteq> \\<zero>\"", "lemma (in Corps) field_nilp_zero:\"\\<lbrakk>x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> = \\<zero>\\<rbrakk> \\<Longrightarrow> x = \\<zero>\"", "lemma (in Corps) npowf_mem:\"\\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                    npowf K a n \\<in> carrier K\"", "lemma (in Corps) field_npowf_exp_zero:\"\\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                    npowf K a 0 = 1\\<^sub>r\"", "lemma (in Corps) npow_exp_minusTr1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i\\<rbrakk>  \\<Longrightarrow>\n       0 \\<le> i - (int j) \\<longrightarrow>  x\\<^bsub>K\\<^esub>\\<^bsup>(i - (int j))\\<^esup> = x^\\<^bsup>K (nat i)\\<^esup> \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)^\\<^bsup>K j\\<^esup>\"", "lemma (in Corps) npow_exp_minusTr2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n                 0 \\<le> i - j\\<rbrakk>  \\<Longrightarrow>  x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> = x^\\<^bsup>K (nat i)\\<^esup> \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)^\\<^bsup>K (nat j)\\<^esup>\"", "lemma (in Corps) npowf_inv:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\"", "lemma (in Corps) npowf_inv1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; \\<not> 0 \\<le> j\\<rbrakk> \\<Longrightarrow>\n                                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\"", "lemma (in Corps) npowf_inverse:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\"", "lemma (in Corps) npowf_expTr1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n                 0 \\<le> i - j\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>(- j)\\<^esup>\"", "lemma (in Corps) npowf_expTr2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j\\<rbrakk> \\<Longrightarrow>\n                          x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\"", "lemma (in Corps) npowf_exp_add:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                          x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\"", "lemma (in Corps) npowf_exp_1_add:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                        x\\<^bsub>K\\<^esub>\\<^bsup>(1 + j)\\<^esup> = x \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\"", "lemma (in Corps) npowf_minus:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>(- j)\\<^esup>\"", "lemma (in Ring) residue_fieldTr:\"\\<lbrakk>maximal_ideal R mx; x \\<in> carrier(qring R mx);\n x \\<noteq> \\<zero>\\<^bsub>(qring R mx)\\<^esub>\\<rbrakk> \\<Longrightarrow>\\<exists>y\\<in>carrier (qring R mx). y \\<cdot>\\<^sub>r\\<^bsub>(qring R mx)\\<^esub> x = 1\\<^sub>r\\<^bsub>(qring R mx)\\<^esub>\"", "lemma (in Ring) residue_field_cd:\"maximal_ideal R mx \\<Longrightarrow>\n                                           Corps (qring R mx)\"", "lemma (in Ring) maximal_set_idealTr:\n       \"maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx \\<Longrightarrow> ideal R mx\"", "lemma (in Ring) maximal_setTr:\"\\<lbrakk>maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n                                         ideal R J; mx \\<subset> J \\<rbrakk> \\<Longrightarrow> S \\<inter> J \\<noteq> {}\"", "lemma (in Ring) mulDisj:\"\\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n    T = {I. ideal R I \\<and> S \\<inter> I = {}}; maximal_set T mx \\<rbrakk> \\<Longrightarrow> prime_ideal R mx\"", "lemma (in Ring) ex_mulDisj_maximal:\"\\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n       T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk> \\<Longrightarrow>  \\<exists>mx. maximal_set T mx\"", "lemma (in Ring) ex_mulDisj_prime:\"\\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S\\<rbrakk> \\<Longrightarrow>\n                            \\<exists>mx. prime_ideal R mx \\<and> S \\<inter> mx = {}\"", "lemma (in Ring) nilradTr1:\"\\<not> zeroring R \\<Longrightarrow> nilrad R = \\<Inter> {p. prime_ideal R p}\"", "lemma (in Ring) nonilp_residue_nilrad:\"\\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        nilpotent (qring R (nilrad R)) (x \\<uplus>\\<^bsub>R\\<^esub> (nilrad R))\\<rbrakk> \\<Longrightarrow>\n                   x \\<uplus>\\<^bsub>R\\<^esub> (nilrad R) = \\<zero>\\<^bsub>(qring R (nilrad R))\\<^esub>\"", "lemma (in Ring) ex_contid_maximal:\"\\<lbrakk> S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I; I \\<inter> S = {};\nT = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}\\<rbrakk> \\<Longrightarrow> \\<exists>mx. maximal_set T mx\"", "lemma (in Ring) contid_maximal:\"\\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I; I \\<inter> S = {};\n             T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}; maximal_set T mx\\<rbrakk> \\<Longrightarrow>\n                                                maximal_ideal R mx\"", "lemma (in Ring) ideal_contained_maxid:\"\\<lbrakk>\\<not>(zeroring R); ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                    \\<exists>mx. maximal_ideal R mx \\<and> I \\<subseteq> mx\"", "lemma (in Ring) nonunit_principal_id:\"\\<lbrakk>a \\<in> carrier R; \\<not> (Unit R a)\\<rbrakk> \\<Longrightarrow>\n                                             (R \\<diamondsuit>\\<^sub>p a) \\<noteq> (carrier R)\"", "lemma (in Ring) nonunit_contained_maxid:\"\\<lbrakk>\\<not>(zeroring R); a \\<in> carrier R;\n                \\<not> Unit R a \\<rbrakk>  \\<Longrightarrow>  \\<exists>mx. maximal_ideal R mx \\<and> a \\<in>  mx\"", "lemma (in Ring) local_ring_diff:\"\\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n  \\<forall>a\\<in> (carrier R - mx). Unit R a \\<rbrakk> \\<Longrightarrow> local_ring R \\<and> maximal_ideal R mx\"", "lemma (in Ring) localring_unit:\"\\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n                \\<forall>x. x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r) \\<rbrakk> \\<Longrightarrow> local_ring R\"", "lemma (in Ring) zeroring_J_rad_empty:\"zeroring R \\<Longrightarrow> J_rad R = carrier R\"", "lemma (in Ring) J_rad_mem:\"x \\<in> J_rad R \\<Longrightarrow> x \\<in> carrier R\"", "lemma (in Ring) J_rad_unit:\"\\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R\\<rbrakk> \\<Longrightarrow>\n            \\<forall>y. (y\\<in> carrier R \\<longrightarrow> Unit R (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y))\""], "translations": [["", "lemma (in aGroup) ag_carrier_carrier:\"carrier (b_ag A) = carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier (b_ag A) = carrier A", "by (simp add:b_ag_def)"], ["", "lemma (in aGroup) ag_pOp_closed:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                     pop A x y \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> carrier A", "apply (cut_tac pop_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     (\\<plusminus>)\n     \\<in> carrier A \\<rightarrow>\n           carrier A \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> carrier A", "apply (frule funcset_mem[of \"(\\<plusminus>) \" \"carrier A\" \"carrier A \\<rightarrow> carrier A\" \"x\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     (\\<plusminus>)\n     \\<in> carrier A \\<rightarrow> carrier A \\<rightarrow> carrier A;\n     (\\<plusminus>) x \\<in> carrier A \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> carrier A", "apply (rule funcset_mem[of \"(\\<plusminus>) x\" \"carrier A\" \"carrier A\" \"y\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_mOp_closed:\"x \\<in> carrier A \\<Longrightarrow> (-\\<^sub>a x)  \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> -\\<^sub>a x \\<in> carrier A", "apply (cut_tac mop_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A;\n     mop A \\<in> carrier A \\<rightarrow> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> carrier A", "apply (rule funcset_mem[of \"mop A\" \"carrier A\" \"carrier A\" \"x\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_subset:\"A +> H \\<Longrightarrow> H \\<subseteq> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> H \\<subseteq> carrier A", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. b_ag A \\<guillemotright> H  \\<Longrightarrow> H \\<subseteq> carrier A", "apply (simp add:sg_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<noteq> {}; H \\<subseteq> carrier (b_ag A);\n     \\<forall>a\\<in>H.\n        \\<forall>b\\<in>H.\n           a \\<cdot>\\<^bsub>b_ag A\\<^esub> \\<rho>\\<^bsub>b_ag A\\<^esub> b\n           \\<in> H\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier A", "apply (simp add:ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_pOp_commute:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>  \\<Longrightarrow>\n           pop A x y = pop A y x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y = y \\<plusminus> x", "by (simp add:pop_commute)"], ["", "lemma (in aGroup) b_ag_group:\"Group (b_ag A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Group (b_ag A)", "apply (unfold Group_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ((\\<cdot>\\<^bsub>b_ag A\\<^esub>)\n     \\<in> carrier (b_ag A) \\<rightarrow>\n           carrier (b_ag A) \\<rightarrow> carrier (b_ag A) \\<and>\n     (\\<forall>a b c.\n         a \\<in> carrier (b_ag A) \\<longrightarrow>\n         b \\<in> carrier (b_ag A) \\<longrightarrow>\n         c \\<in> carrier (b_ag A) \\<longrightarrow>\n         a \\<cdot>\\<^bsub>b_ag A\\<^esub> b \\<cdot>\\<^bsub>b_ag A\\<^esub> c =\n         a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n         (b \\<cdot>\\<^bsub>b_ag A\\<^esub> c)) \\<and>\n     iop (b_ag A)\n     \\<in> carrier (b_ag A) \\<rightarrow> carrier (b_ag A)) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (b_ag A) \\<longrightarrow>\n        \\<rho>\\<^bsub>b_ag A\\<^esub> a \\<cdot>\\<^bsub>b_ag A\\<^esub> a =\n        \\<one>\\<^bsub>b_ag A\\<^esub>) \\<and>\n    \\<one>\\<^bsub>b_ag A\\<^esub> \\<in> carrier (b_ag A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (b_ag A) \\<longrightarrow>\n        \\<one>\\<^bsub>b_ag A\\<^esub> \\<cdot>\\<^bsub>b_ag A\\<^esub> a = a)", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<plusminus>)\n    \\<in> carrier A \\<rightarrow> carrier A \\<rightarrow> carrier A \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier A \\<longrightarrow>\n                a \\<plusminus> b \\<plusminus> c =\n                a \\<plusminus> (b \\<plusminus> c)))) \\<and>\n    mop A \\<in> carrier A \\<rightarrow> carrier A \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        -\\<^sub>a a \\<plusminus> a = \\<zero>) \\<and>\n    \\<zero> \\<in> carrier A \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a)", "apply (simp add:pop_closed mop_closed ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier A \\<longrightarrow>\n                a \\<plusminus> b \\<plusminus> c =\n                a \\<plusminus> (b \\<plusminus> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        -\\<^sub>a a \\<plusminus> a = \\<zero>) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a \\<in> carrier A \\<longrightarrow>\n       (\\<forall>b.\n           b \\<in> carrier A \\<longrightarrow>\n           (\\<forall>c.\n               c \\<in> carrier A \\<longrightarrow>\n               a \\<plusminus> b \\<plusminus> c =\n               a \\<plusminus> (b \\<plusminus> c)))\n 2. (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        -\\<^sub>a a \\<plusminus> a = \\<zero>) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n        c \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c =\n                         a \\<plusminus> (b \\<plusminus> c)\n 2. (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        -\\<^sub>a a \\<plusminus> a = \\<zero>) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a)", "apply (simp add:aassoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow>\n        -\\<^sub>a a \\<plusminus> a = \\<zero>) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a \\<in> carrier A \\<longrightarrow>\n       -\\<^sub>a a \\<plusminus> a = \\<zero>\n 2. \\<forall>a.\n       a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       a \\<in> carrier A \\<Longrightarrow>\n       -\\<^sub>a a \\<plusminus> a = \\<zero>\n 2. \\<forall>a.\n       a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a", "apply (simp add:l_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a \\<in> carrier A \\<longrightarrow> \\<zero> \\<plusminus> a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a. a \\<in> carrier A \\<Longrightarrow> \\<zero> \\<plusminus> a = a", "apply (simp add:l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) agop_gop:\"top (b_ag A) = pop A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<cdot>\\<^bsub>b_ag A\\<^esub>) = (\\<plusminus>)", "(*agpop_gtop*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<cdot>\\<^bsub>b_ag A\\<^esub>) = (\\<plusminus>)", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) agiop_giop:\"iop (b_ag A) = mop A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. iop (b_ag A) = mop A", "(*agmop_giop*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. iop (b_ag A) = mop A", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) agunit_gone:\"one (b_ag A) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<one>\\<^bsub>b_ag A\\<^esub> = \\<zero>", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_pOp_add_r:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                 a = b\\<rbrakk>  \\<Longrightarrow> a \\<plusminus> c =  b \\<plusminus> c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     a = b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> c = b \\<plusminus> c", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_add_commute:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                                  a \\<plusminus> b = b \\<plusminus> a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b = b \\<plusminus> a", "by (simp add:pop_commute)"], ["", "lemma (in aGroup) ag_pOp_add_l:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                 a = b\\<rbrakk>  \\<Longrightarrow> c \\<plusminus> a =  c \\<plusminus> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     a = b\\<rbrakk>\n    \\<Longrightarrow> c \\<plusminus> a = c \\<plusminus> b", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_pOp_closed:\"\\<lbrakk>asubGroup A H; x \\<in> H; y \\<in> H\\<rbrakk>\n                                   \\<Longrightarrow> pop A x y \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; x \\<in> H; y \\<in> H\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; y \\<in> H\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; y \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> H", "apply (frule Group.sg_mult_closed [of \"b_ag A\" \"H\" \"x\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; y \\<in> H;\n     Group (b_ag A); x \\<cdot>\\<^bsub>b_ag A\\<^esub> y \\<in> H\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> H", "apply (simp only:agop_gop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_mOp_closed:\"\\<lbrakk>asubGroup A H; x \\<in> H\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; x \\<in> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> H", "apply (frule Group.sg_i_closed[of \"b_ag A\" \"H\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; Group (b_ag A);\n     \\<rho>\\<^bsub>b_ag A\\<^esub> x \\<in> H\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> H", "apply (simp add:agiop_giop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_subset1:\"\\<lbrakk>asubGroup A H; x \\<in> H\\<rbrakk> \\<Longrightarrow> x \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; x \\<in> H\\<rbrakk> \\<Longrightarrow> x \\<in> carrier A", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier A", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier A", "apply (frule Group.sg_subset_elem[of \"b_ag A\" \"H\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; x \\<in> H; Group (b_ag A);\n     x \\<in> carrier (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier A", "apply (simp add:ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_inc_zero:\"asubGroup A H \\<Longrightarrow> \\<zero> \\<in> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> \\<zero> \\<in> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. b_ag A \\<guillemotright> H  \\<Longrightarrow> \\<zero> \\<in> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> H", "apply (frule Group.sg_unit_closed[of \"b_ag A\" \"H\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n     \\<one>\\<^bsub>b_ag A\\<^esub> \\<in> H\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> H", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_inc_zero:\"\\<zero> \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<in> carrier A", "by (simp add:ex_zero)"], ["", "lemma (in aGroup) ag_l_zero:\"x \\<in> carrier A \\<Longrightarrow> \\<zero> \\<plusminus> x = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> \\<zero> \\<plusminus> x = x", "by (simp add:l_zero)"], ["", "lemma (in aGroup) ag_r_zero:\"x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> \\<zero> = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> \\<zero> = x", "apply (cut_tac ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; \\<zero> \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> \\<zero> = x", "apply (subst pop_commute, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; \\<zero> \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<plusminus> x = x", "apply (rule ag_l_zero, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_l_inv1:\"x \\<in> carrier A \\<Longrightarrow> (-\\<^sub>a x) \\<plusminus> x = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> -\\<^sub>a x \\<plusminus> x = \\<zero>", "by (simp add:l_m)"], ["", "lemma (in aGroup) ag_r_inv1:\"x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> (-\\<^sub>a x) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> x \\<plusminus> -\\<^sub>a x = \\<zero>", "by (frule ag_mOp_closed[of \"x\"],\n       subst ag_pOp_commute, assumption+,\n       simp add:ag_l_inv1)"], ["", "lemma (in aGroup) ag_pOp_assoc:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; z \\<in> carrier A\\<rbrakk>\n                \\<Longrightarrow> (x \\<plusminus> y) \\<plusminus> z = x \\<plusminus> (y \\<plusminus> z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     z \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<plusminus> z =\n                      x \\<plusminus> (y \\<plusminus> z)", "by (simp add:aassoc)"], ["", "lemma (in aGroup) ag_inv_unique:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<plusminus> y = \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                     y = -\\<^sub>a x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     x \\<plusminus> y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> y = -\\<^sub>a x", "apply (frule ag_mOp_closed[of \"x\"],\n       frule aassoc[of \"-\\<^sub>a x\" \"x\" \"y\"], assumption+,\n       simp add:l_m l_zero ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_inv_inj:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y\\<rbrakk> \\<Longrightarrow>\n                                          (-\\<^sub>a x) \\<noteq> (-\\<^sub>a y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<noteq> -\\<^sub>a y", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y;\n     -\\<^sub>a x = -\\<^sub>a y\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule ag_mOp_closed[of \"y\"],\n       frule aassoc[of \"y\" \"-\\<^sub>a y\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y;\n     -\\<^sub>a x = -\\<^sub>a y; -\\<^sub>a y \\<in> carrier A;\n     y \\<plusminus> -\\<^sub>a y \\<plusminus> x =\n     y \\<plusminus> (-\\<^sub>a y \\<plusminus> x)\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp only:ag_r_inv1,\n       frule sym, thin_tac \"-\\<^sub>a x = -\\<^sub>a y\", simp add:l_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x \\<noteq> y;\n     -\\<^sub>a x \\<in> carrier A;\n     \\<zero> \\<plusminus> x = y \\<plusminus> \\<zero>;\n     -\\<^sub>a y = -\\<^sub>a x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:l_zero ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) pOp_assocTr41:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d = a \\<plusminus> b \\<plusminus> (c \\<plusminus> d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     d \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d =\n                      a \\<plusminus> b \\<plusminus> (c \\<plusminus> d)", "by (frule ag_pOp_closed[of \"a\" \"b\"], assumption+,\n    rule aassoc[of \"a \\<plusminus> b\" \"c\" \"d\"], assumption+)"], ["", "lemma (in aGroup) pOp_assocTr42:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A; d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d = a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     d \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c \\<plusminus> d =\n                      a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d", "by (simp add:aassoc[THEN sym, of \"a\" \"b\" \"c\"])"], ["", "lemma (in aGroup) pOp_assocTr43:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A; d \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) = a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     d \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) =\n                      a \\<plusminus> (b \\<plusminus> c) \\<plusminus> d", "by (subst  pOp_assocTr41[THEN sym], assumption+,\n       rule pOp_assocTr42, assumption+)"], ["", "lemma (in aGroup) pOp_assoc_cancel:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n c \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<plusminus> (b \\<plusminus> -\\<^sub>a c) = a \\<plusminus> -\\<^sub>a c\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<plusminus>\n                      (b \\<plusminus> -\\<^sub>a c) =\n                      a \\<plusminus> -\\<^sub>a c", "apply (subst pOp_assocTr43, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a b \\<in> carrier A\n 2. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier A\n 3. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a c \\<in> carrier A\n 4. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus>\n                      (-\\<^sub>a b \\<plusminus> b) \\<plusminus>\n                      -\\<^sub>a c =\n                      a \\<plusminus> -\\<^sub>a c", "apply (simp add:ag_l_inv1 ag_mOp_closed)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     c \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> \\<zero> \\<plusminus> -\\<^sub>a c =\n                      a \\<plusminus> -\\<^sub>a c", "apply (simp add:ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_p_inv:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                                     (-\\<^sub>a (x \\<plusminus> y)) = (-\\<^sub>a x) \\<plusminus> (-\\<^sub>a y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a (x \\<plusminus> y) =\n                      -\\<^sub>a x \\<plusminus> -\\<^sub>a y", "apply (frule ag_mOp_closed[of \"x\"], frule ag_mOp_closed[of \"y\"],\n       frule ag_pOp_closed[of \"x\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     -\\<^sub>a x \\<in> carrier A; -\\<^sub>a y \\<in> carrier A;\n     x \\<plusminus> y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a (x \\<plusminus> y) =\n                      -\\<^sub>a x \\<plusminus> -\\<^sub>a y", "apply (frule aassoc[of \"x \\<plusminus> y\" \"-\\<^sub>a x\" \"-\\<^sub>a y\"], assumption+,\n       simp add:pOp_assocTr43, simp add:pop_commute[of \"y\" \"-\\<^sub>a x\"],\n       simp add:aassoc[THEN sym, of \"x\" \"-\\<^sub>a x\" \"y\"],\n       simp add:ag_r_inv1 l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     -\\<^sub>a x \\<in> carrier A; -\\<^sub>a y \\<in> carrier A;\n     x \\<plusminus> y \\<in> carrier A;\n     x \\<plusminus> y \\<plusminus> -\\<^sub>a x \\<plusminus> -\\<^sub>a y =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a (x \\<plusminus> y) =\n                      -\\<^sub>a x \\<plusminus> -\\<^sub>a y", "apply (frule ag_pOp_closed[of \"-\\<^sub>a x\" \"-\\<^sub>a y\"], assumption+,\n       simp add:pOp_assocTr41,\n       rule ag_inv_unique[THEN sym, of \"x \\<plusminus> y\" \"-\\<^sub>a x \\<plusminus> -\\<^sub>a y\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) gEQAddcross: \"\\<lbrakk>l1 \\<in> carrier A; l2 \\<in> carrier A;\n      r1 \\<in> carrier A; r1 \\<in> carrier A; l1 = r2; l2 = r1\\<rbrakk> \\<Longrightarrow>\n                          l1 \\<plusminus> l2 = r1 \\<plusminus> r2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>l1 \\<in> carrier A; l2 \\<in> carrier A; r1 \\<in> carrier A;\n     r1 \\<in> carrier A; l1 = r2; l2 = r1\\<rbrakk>\n    \\<Longrightarrow> l1 \\<plusminus> l2 = r1 \\<plusminus> r2", "apply (simp add:ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_eq_sol1:\"\\<lbrakk>a \\<in> carrier A; x\\<in> carrier A; b\\<in> carrier A;\n                               a \\<plusminus> x = b\\<rbrakk> \\<Longrightarrow> x = (-\\<^sub>a a) \\<plusminus> b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; x \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> x = b\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a a \\<plusminus> b", "apply (frule ag_mOp_closed[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; x \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> x = b; -\\<^sub>a a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a a \\<plusminus> b", "apply (frule aassoc[of \"-\\<^sub>a a\" \"a\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; x \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> x = b; -\\<^sub>a a \\<in> carrier A;\n     -\\<^sub>a a \\<plusminus> a \\<plusminus> x =\n     -\\<^sub>a a \\<plusminus> (a \\<plusminus> x)\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a a \\<plusminus> b", "apply (simp add:l_m l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_eq_sol2:\"\\<lbrakk>a \\<in> carrier A; x\\<in> carrier A; b\\<in> carrier A;\n                                x \\<plusminus> a = b\\<rbrakk> \\<Longrightarrow> x = b \\<plusminus> (-\\<^sub>a a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; x \\<in> carrier A; b \\<in> carrier A;\n     x \\<plusminus> a = b\\<rbrakk>\n    \\<Longrightarrow> x = b \\<plusminus> -\\<^sub>a a", "apply (frule ag_mOp_closed[of \"a\"],\n       frule aassoc[of \"x\" \"a\" \"-\\<^sub>a a\"], assumption+,\n       simp add:ag_r_inv1 ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_add4_rel:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n d \\<in> carrier A \\<rbrakk> \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) =  a \\<plusminus> c \\<plusminus> (b \\<plusminus> d)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     d \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<plusminus> (c \\<plusminus> d) =\n                      a \\<plusminus> c \\<plusminus> (b \\<plusminus> d)", "apply (simp add:pOp_assocTr43[of \"a\" \"b\" \"c\" \"d\"],\n       simp add:ag_pOp_commute[of \"b\" \"c\"],\n       simp add:pOp_assocTr43[THEN sym, of \"a\" \"c\" \"b\" \"d\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_inv_inv:\"x \\<in> carrier A \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier A \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x) = x", "by (frule ag_l_inv1[of \"x\"], frule ag_mOp_closed[of \"x\"],\n       rule  ag_inv_unique[THEN sym, of \"-\\<^sub>a x\" \"x\"], assumption+)"], ["", "lemma (in aGroup) ag_inv_zero:\"-\\<^sub>a \\<zero> = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. -\\<^sub>a \\<zero> = \\<zero>", "apply (cut_tac ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<in> carrier A \\<Longrightarrow> -\\<^sub>a \\<zero> = \\<zero>", "apply (frule l_zero[of \"\\<zero>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<zero> \\<in> carrier A;\n     \\<zero> \\<plusminus> \\<zero> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a \\<zero> = \\<zero>", "apply (rule ag_inv_unique[THEN sym], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_diff_minus:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n                   a \\<plusminus> (-\\<^sub>a b) = c\\<rbrakk> \\<Longrightarrow> b \\<plusminus> (-\\<^sub>a a) = (-\\<^sub>a c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b = c\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a = -\\<^sub>a c", "apply (frule sym, thin_tac \"a \\<plusminus> -\\<^sub>a b = c\", simp, thin_tac \"c = a \\<plusminus> -\\<^sub>a b\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a =\n                      -\\<^sub>a (a \\<plusminus> -\\<^sub>a b)", "apply (frule ag_mOp_closed[of \"b\"], frule ag_mOp_closed[of \"a\"],\n       subst ag_p_inv, assumption+, subst ag_inv_inv, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b \\<in> carrier A;\n     -\\<^sub>a b \\<in> carrier A; -\\<^sub>a a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a =\n                      -\\<^sub>a a \\<plusminus> b", "apply (simp add:ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) pOp_cancel_l:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;                    c \\<plusminus> a =  c \\<plusminus> b \\<rbrakk> \\<Longrightarrow> a = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     c \\<plusminus> a = c \\<plusminus> b\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (frule ag_mOp_closed[of \"c\"],\n       frule aassoc[of \"-\\<^sub>a c\" \"c\" \"a\"], assumption+,\n       simp only:l_m l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>-\\<^sub>a c \\<plusminus> (c \\<plusminus> b) \\<in> carrier A;\n     b \\<in> carrier A; c \\<in> carrier A;\n     c \\<plusminus> (-\\<^sub>a c \\<plusminus> (c \\<plusminus> b)) =\n     c \\<plusminus> b;\n     -\\<^sub>a c \\<in> carrier A;\n     a = -\\<^sub>a c \\<plusminus> (c \\<plusminus> b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a c \\<plusminus> (c \\<plusminus> b) = b", "apply (simp only:aassoc[THEN sym, of \"-\\<^sub>a c\" \"c\" \"b\"],\n        simp only:l_m l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) pOp_cancel_r:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;               a \\<plusminus> c =  b \\<plusminus> c \\<rbrakk> \\<Longrightarrow> a = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; c \\<in> carrier A;\n     a \\<plusminus> c = b \\<plusminus> c\\<rbrakk>\n    \\<Longrightarrow> a = b", "by (simp add:ag_pOp_commute pOp_cancel_l)"], ["", "lemma (in aGroup) ag_eq_diffzero:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                       (a = b) = (a \\<plusminus> (-\\<^sub>a b) = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (a = b) = (a \\<plusminus> -\\<^sub>a b = \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; a = b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b = \\<zero>\n 2. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (simp add:ag_r_inv1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (frule ag_mOp_closed[of \"b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b = \\<zero>;\n     -\\<^sub>a b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (simp add:ag_pOp_commute[of \"a\" \"-\\<^sub>a b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     -\\<^sub>a b \\<plusminus> a = \\<zero>;\n     -\\<^sub>a b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (subst ag_inv_unique[of \"-\\<^sub>a b\" \"a\"], assumption+,\n        simp add:ag_inv_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_eq_diffzero1:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                       (a = b) = ((-\\<^sub>a a) \\<plusminus> b = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (a = b) = (-\\<^sub>a a \\<plusminus> b = \\<zero>)", "apply (frule ag_mOp_closed[of a],\n       simp add:ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     -\\<^sub>a a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (a = b) = (b \\<plusminus> -\\<^sub>a a = \\<zero>)", "apply (subst ag_eq_diffzero[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     -\\<^sub>a a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (a = b) = (b = a)", "apply (rule iffI, rule sym, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     -\\<^sub>a a \\<in> carrier A; b = a\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (rule sym, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_neq_diffnonzero:\"\\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n         (a \\<noteq> b) = (a \\<plusminus> (-\\<^sub>a b) \\<noteq>  \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (a \\<noteq> b) =\n                      (a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; a \\<noteq> b\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>\n 2. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a \\<noteq> b", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A; a \\<noteq> b;\n     a \\<plusminus> -\\<^sub>a b = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a \\<noteq> b", "apply (simp add:ag_eq_diffzero[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n     a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a \\<noteq> b", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b \\<in> carrier A; b \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>;\n     a = b\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:ag_r_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) ag_plus_zero:\"\\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                     (x = -\\<^sub>a y)  = (x \\<plusminus> y = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (x = -\\<^sub>a y) = (x \\<plusminus> y = \\<zero>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A; x = -\\<^sub>a y\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y = \\<zero>\n 2. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     x \\<plusminus> y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a y", "apply (simp add:ag_l_inv1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     x \\<plusminus> y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a y", "apply (simp add:ag_pOp_commute[of \"x\" \"y\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier A; y \\<in> carrier A;\n     y \\<plusminus> x = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x = -\\<^sub>a y", "apply (rule ag_inv_unique[of \"y\" \"x\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_nsubg:\"A +> H \\<Longrightarrow>  (b_ag A) \\<triangleright> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> b_ag A \\<triangleright> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> b_ag A \\<triangleright> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> b_ag A \\<triangleright> H", "apply (rule Group.cond_nsg[of \"b_ag A\" \"H\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (b_ag A).\n                         \\<forall>h\\<in>H.\n                            a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                            h \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                            \\<rho>\\<^bsub>b_ag A\\<^esub> a\n                            \\<in> H", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier (b_ag A); h \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         h \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> a\n                         \\<in> H", "apply(simp add:agop_gop agiop_giop)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier (b_ag A); h \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h \\<plusminus> -\\<^sub>a a \\<in> H", "apply (frule Group.sg_subset[of \"b_ag A\" \"H\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier (b_ag A); h \\<in> H;\n        H \\<subseteq> carrier (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h \\<plusminus> -\\<^sub>a a \\<in> H", "apply (simp add:ag_carrier_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier A; h \\<in> H; H \\<subseteq> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h \\<plusminus> -\\<^sub>a a \\<in> H", "apply (frule_tac c = h in subsetD[of \"H\" \"carrier A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier A; h \\<in> H; H \\<subseteq> carrier A;\n        h \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> h \\<plusminus> -\\<^sub>a a \\<in> H", "apply (subst ag_pOp_commute, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier A; h \\<in> H; H \\<subseteq> carrier A;\n        h \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<plusminus> -\\<^sub>a a \\<in> H", "apply (frule_tac x = a in ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A);\n        a \\<in> carrier A; h \\<in> H; H \\<subseteq> carrier A;\n        h \\<in> carrier A; -\\<^sub>a a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<plusminus> -\\<^sub>a a \\<in> H", "apply (subst aassoc, assumption+, simp add:ag_r_inv1 ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) subg_asubg:\"b_ag G \\<guillemotright> H \\<Longrightarrow> G +> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. b_ag G \\<guillemotright> H  \\<Longrightarrow> G +> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_test:\"\\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n               \\<forall>a\\<in>H. \\<forall>b\\<in>H. (a \\<plusminus> (-\\<^sub>a b) \\<in> H)\\<rbrakk> \\<Longrightarrow> A +> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H.\n        \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H\\<rbrakk>\n    \\<Longrightarrow> A +> H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H.\n        \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H\\<rbrakk>\n    \\<Longrightarrow> b_ag A \\<guillemotright> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> b_ag A \\<guillemotright> H", "apply (rule Group.sg_condition [of \"b_ag A\" \"H\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<subseteq> carrier (b_ag A)\n 2. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<noteq> {}\n 3. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b.\n                         a \\<in> H \\<and> b \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> b\n                         \\<in> H", "apply (simp add:ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<noteq> {}\n 2. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b.\n                         a \\<in> H \\<and> b \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> b\n                         \\<in> H", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n     \\<forall>a\\<in>H. \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b.\n                         a \\<in> H \\<and> b \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> b\n                         \\<in> H", "apply (rule allI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n        \\<forall>a\\<in>H.\n           \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n        Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> H \\<and> b \\<in> H \\<longrightarrow>\n                         a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> b\n                         \\<in> H", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>H \\<subseteq> carrier A; H \\<noteq> {};\n        \\<forall>a\\<in>H.\n           \\<forall>b\\<in>H. a \\<plusminus> -\\<^sub>a b \\<in> H;\n        Group (b_ag A); a \\<in> H \\<and> b \\<in> H\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                         \\<rho>\\<^bsub>b_ag A\\<^esub> b\n                         \\<in> H", "apply (simp add:agop_gop agiop_giop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_zero:\"A +> {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> {\\<zero>}", "apply (rule asubg_test[of \"{\\<zero>}\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. {\\<zero>} \\<subseteq> carrier A\n 2. {\\<zero>} \\<noteq> {}\n 3. \\<forall>a\\<in>{\\<zero>}.\n       \\<forall>b\\<in>{\\<zero>}. a \\<plusminus> -\\<^sub>a b \\<in> {\\<zero>}", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. {\\<zero>} \\<noteq> {}\n 2. \\<forall>a\\<in>{\\<zero>}.\n       \\<forall>b\\<in>{\\<zero>}. a \\<plusminus> -\\<^sub>a b \\<in> {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>{\\<zero>}.\n       \\<forall>b\\<in>{\\<zero>}. a \\<plusminus> -\\<^sub>a b \\<in> {\\<zero>}", "apply (simp, cut_tac ag_inc_zero, simp add:ag_r_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_whole:\"A +> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> carrier A", "apply (rule asubg_test[of \"carrier A\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. carrier A \\<subseteq> carrier A\n 2. carrier A \\<noteq> {}\n 3. \\<forall>a\\<in>carrier A.\n       \\<forall>b\\<in>carrier A. a \\<plusminus> -\\<^sub>a b \\<in> carrier A", "apply (simp,\n       cut_tac ag_inc_zero, simp add:nonempty)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a\\<in>carrier A.\n       \\<forall>b\\<in>carrier A. a \\<plusminus> -\\<^sub>a b \\<in> carrier A", "apply ((rule ballI)+,\n       rule ag_pOp_closed, assumption,\n       rule_tac x = b in ag_mOp_closed, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) Ag_ind_carrier:\"bij_to f (carrier A) (D::'d set) \\<Longrightarrow>\n               carrier (Ag_ind A f) = f ` (carrier A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. bij_to f (carrier A) D \\<Longrightarrow>\n    carrier (Ag_ind A f) = f ` carrier A", "by (simp add:Ag_ind_def)"], ["", "lemma (in aGroup) Ag_ind_aGroup:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> aGroup (Ag_ind A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> aGroup (Ag_ind A f)", "apply (simp add:bij_to_def, frule conjunct1, frule conjunct2, fold bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> aGroup (Ag_ind A f)", "apply (simp add:aGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        x \\<in> carrier (Ag_ind A f); xa \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> xa\n                         \\<in> carrier (Ag_ind A f)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_carrier surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D;\n        xa \\<in> D\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> xa \\<in> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = x in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = xa in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D; xa \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) x \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) xa \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> xa \\<in> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D; xa \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) x \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) xa \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             x \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) xa)\n                         \\<in> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule funcset_mem[of \"f\" \"carrier A\" \"D\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D; xa \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) x \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) xa \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          x \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) xa\n                         \\<in> carrier A\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (Ag_ind A f) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier\n    (Ag_ind A f) \\<longrightarrow>\n                                 a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                 b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                 c =\n                                 a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                                  c)))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> carrier (Ag_ind A f); b \\<in> carrier (Ag_ind A f);\n        c \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> c)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add: Ag_ind_carrier surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        c \\<in> D\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> c)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = b in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = c in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         (b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> c)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              a \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b)\n                          \\<in> D \\<longrightarrow>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<in> D \\<longrightarrow>\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    a \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b)) \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               a \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    c)))) \\<and>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<notin> D \\<longrightarrow>\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    a \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b)) \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                           undefined)) \\<and>\n                         (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              a \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b)\n                          \\<notin> D \\<longrightarrow>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<in> D \\<longrightarrow>\n                           undefined c =\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               a \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    c)))) \\<and>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<notin> D \\<longrightarrow>\n                           undefined c = undefined))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac x = \"invfun (carrier A) D f a\" and\n                  y = \"invfun (carrier A) D f b\" in ag_pOp_closed, assumption+,\n        frule_tac x = \"invfun (carrier A) D f b\" and\n                  y = \"invfun (carrier A) D f c\" in ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              a \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b)\n                          \\<in> D \\<longrightarrow>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<in> D \\<longrightarrow>\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    a \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b)) \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               a \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    c)))) \\<and>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<notin> D \\<longrightarrow>\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    a \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b)) \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                           undefined)) \\<and>\n                         (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              a \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b)\n                          \\<notin> D \\<longrightarrow>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<in> D \\<longrightarrow>\n                           undefined c =\n                           f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               a \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    b \\<plusminus>\n                                   (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    c)))) \\<and>\n                          (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                               b \\<plusminus>\n                              (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                           \\<notin> D \\<longrightarrow>\n                           undefined c = undefined))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  a \\<plusminus>\n                                 (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  b)) \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                         f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             a \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  b \\<plusminus>\n                                 (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  c)))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  a \\<plusminus>\n                                 (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  b)) \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                         f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             a \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  b \\<plusminus>\n                                 (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                  c)))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:invfun_l)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             a \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             b \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c) =\n                         f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             a \\<plusminus>\n                            ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              b \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c))\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (subst injective_iff[of \"f\" \"carrier A\", THEN sym], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n                         \\<in> carrier A\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                           b \\<plusminus>\n                          (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n                         \\<in> carrier A\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n        \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<plusminus>\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c =\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                           b \\<plusminus>\n                          (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_closed)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D; b \\<in> D; c \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c =\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                           b \\<plusminus>\n                          (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) c)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                              a)) \\<and>\n                      mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                             a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                             b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> a)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> carrier (Ag_ind A f); b \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> a\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>f `\n          carrier A,carrier A\\<^esub>)\n                             a \\<plusminus>\n                            (f\\<inverse>\\<^bsub>f `\n          carrier A,carrier A\\<^esub>)\n                             b) =\n                         f ((f\\<inverse>\\<^bsub>f `\n          carrier A,carrier A\\<^esub>)\n                             b \\<plusminus>\n                            (f\\<inverse>\\<^bsub>f `\n          carrier A,carrier A\\<^esub>)\n                             a)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (subst injective_iff[of \"f\" \"carrier A\", THEN sym], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = b in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> b \\<in> D\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<in> D\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b\n                         \\<in> carrier A\n 4. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 5. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 6. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<in> D\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b\n                         \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 4. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 5. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = b in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 3. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        b \\<in> D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 3. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = b in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n                         \\<in> carrier A\n 2. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 3. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> f ` carrier A; b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b =\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>f `\n       carrier A,carrier A\\<^esub>)\n                          a\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        b \\<in> D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b =\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+,\n        frule_tac b = b in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D; b \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) b =\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          b \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> mop (Ag_ind A f)\n                      \\<in> carrier (Ag_ind A f) \\<rightarrow>\n                            carrier (Ag_ind A f)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        x \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> x\n                         \\<in> carrier (Ag_ind A f)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_def surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D\\<rbrakk>\n       \\<Longrightarrow> f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                       A\\<^esub>)\n x)\n                         \\<in> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule funcset_mem[of \"f\" \"carrier A\" \"D\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    x\n                         \\<in> carrier A\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = x in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); x \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    x\n                         \\<in> carrier A\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>Ag_ind A f\\<^esub> a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Ag_ind_def surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D\\<rbrakk>\n       \\<Longrightarrow> (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<in> D \\<longrightarrow>\n                          f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                             A\\<^esub>)\n       a)) \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                          f \\<zero>) \\<and>\n                         (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<notin> D \\<longrightarrow>\n                          undefined a = f \\<zero>)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<in> D \\<longrightarrow>\n                          f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                             A\\<^esub>)\n       a)) \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                          f \\<zero>) \\<and>\n                         (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<notin> D \\<longrightarrow>\n                          undefined a = f \\<zero>)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac x = \"invfun (carrier A) D f a\" in ag_mOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<in> D \\<longrightarrow>\n                          f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                             A\\<^esub>)\n       a)) \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                          f \\<zero>) \\<and>\n                         (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                        A\\<^esub>)\n  a)\n                          \\<notin> D \\<longrightarrow>\n                          undefined a = f \\<zero>)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                            A\\<^esub>)\n      a)) \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                         f \\<zero>\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (subst injective_iff[of \"f\" \"carrier A\", THEN sym], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n                         \\<in> carrier A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier A\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n                         \\<in> carrier A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier A\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:invfun_l)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                    a \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n                         \\<in> carrier A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier A\n 3. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 4. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 3. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n        bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n        a \\<in> D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A;\n        -\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a\n        \\<in> carrier A;\n        surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                          (f (-\\<^sub>a (f\\<inverse>\\<^bsub>D,carrier\n                         A\\<^esub>)\n   a)) \\<plusminus>\n                         (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a =\n                         \\<zero>\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (simp add:invfun_l l_m)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n                      \\<in> carrier (Ag_ind A f)\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         a", "apply (simp add:Ag_ind_def surj_to_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero> \\<in> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         a", "apply (rule funcset_mem[of \"f\" \"carrier A\" \"D\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> carrier A\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         a", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Ag_ind A f) \\<longrightarrow>\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        surj_to f (carrier A) D; inj_on f (carrier A);\n        a \\<in> carrier (Ag_ind A f)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>Ag_ind A f\\<^esub> \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                         a =\n                         a", "apply (simp add:Ag_ind_def surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D\\<rbrakk>\n       \\<Longrightarrow> (f \\<zero> \\<in> D \\<longrightarrow>\n                          f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                              (f \\<zero>) \\<plusminus>\n                             (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                          a) \\<and>\n                         (f \\<zero> \\<notin> D \\<longrightarrow>\n                          undefined a = a)", "apply (cut_tac ag_inc_zero, simp add:funcset_mem del:Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        \\<zero> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f \\<zero>) \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                         a", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        \\<zero> \\<in> carrier A; surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                             (f \\<zero>) \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                         a", "apply (simp add:invfun_l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        \\<zero> \\<in> carrier A; surj_to f (carrier A) D\\<rbrakk>\n       \\<Longrightarrow> f (\\<zero> \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                         a", "apply (frule_tac b = a in invfun_mem1[of \"f\" \"carrier A\" \"D\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        \\<zero> \\<in> carrier A; surj_to f (carrier A) D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (\\<zero> \\<plusminus>\n                            (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) =\n                         a", "apply (simp add:l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        f ` carrier A = D; inj_on f (carrier A); a \\<in> D;\n        \\<zero> \\<in> carrier A; surj_to f (carrier A) D;\n        (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>) a) = a", "apply (simp add:invfun_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Homomorphism of abelian groups\""], ["", "definition\n  aHom :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme] \\<Rightarrow> ('a \\<Rightarrow> 'b) set\" where\n  \"aHom A B = {f. f \\<in> carrier A \\<rightarrow> carrier B \\<and> f \\<in> extensional (carrier A) \\<and>\n               (\\<forall>a\\<in>carrier A. \\<forall>b\\<in>carrier A. f (a \\<plusminus>\\<^bsub>A\\<^esub> b) = (f a) \\<plusminus>\\<^bsub>B\\<^esub> (f b))}\""], ["", "definition\n  compos :: \"[('a, 'm) aGroup_scheme, 'b \\<Rightarrow> 'c, 'a \\<Rightarrow> 'b] \\<Rightarrow> 'a \\<Rightarrow> 'c\" where\n  \"compos A g f = compose (carrier A) g f\""], ["", "definition\n  ker :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme] \\<Rightarrow> ('a \\<Rightarrow> 'b)\n        \\<Rightarrow> 'a set\" (\"(3ker\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"ker\\<^bsub>F,G\\<^esub> f = {a. a \\<in> carrier F \\<and> f a = (\\<zero>\\<^bsub>G\\<^esub>)}\""], ["", "definition\n injec :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme, 'a \\<Rightarrow> 'b]\n            \\<Rightarrow> bool\"             (\"(3injec\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"injec\\<^bsub>F,G\\<^esub> f \\<longleftrightarrow> f \\<in> aHom F G \\<and> ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>}\""], ["", "definition\n  surjec :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme, 'a \\<Rightarrow> 'b]\n            \\<Rightarrow> bool\"             (\"(3surjec\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"surjec\\<^bsub>F,G\\<^esub> f \\<longleftrightarrow> f \\<in> aHom F G \\<and> surj_to f (carrier F) (carrier G)\""], ["", "definition\n  bijec :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme, 'a \\<Rightarrow> 'b]\n            \\<Rightarrow> bool\"             (\"(3bijec\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"bijec\\<^bsub>F,G\\<^esub> f \\<longleftrightarrow> injec\\<^bsub>F,G\\<^esub> f \\<and> surjec\\<^bsub>F,G\\<^esub> f\""], ["", "definition\n  ainvf :: \"[('a, 'm) aGroup_scheme, ('b, 'm1) aGroup_scheme, 'a \\<Rightarrow> 'b]\n            \\<Rightarrow> ('b \\<Rightarrow> 'a)\"             (\"(3ainvf\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"ainvf\\<^bsub>F,G\\<^esub> f = invfun (carrier F) (carrier G) f\""], ["", "lemma aHom_mem:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F\\<rbrakk> \\<Longrightarrow>\n                       f a \\<in> carrier G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     a \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier G", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G;\n     f \\<in> carrier F \\<rightarrow> carrier G \\<and>\n     f \\<in> extensional (carrier F) \\<and>\n     (\\<forall>a\\<in>carrier F.\n         \\<forall>b\\<in>carrier F.\n            f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n            f a \\<plusminus>\\<^bsub>G\\<^esub> f b);\n     a \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier G", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; a \\<in> carrier F;\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier G", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma aHom_func:\"f \\<in> aHom F G \\<Longrightarrow> f \\<in> carrier F \\<rightarrow> carrier G\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> aHom F G \\<Longrightarrow>\n    f \\<in> carrier F \\<rightarrow> carrier G", "by (simp add:aHom_def)"], ["", "lemma aHom_add:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n b \\<in> carrier F\\<rbrakk> \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>F\\<^esub> b) = (f a) \\<plusminus>\\<^bsub>G\\<^esub> (f b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n     b \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n                      f a \\<plusminus>\\<^bsub>G\\<^esub> f b", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma aHom_0_0:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk> \\<Longrightarrow> f (\\<zero>\\<^bsub>F\\<^esub>) = \\<zero>\\<^bsub>G\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (frule aGroup.ag_inc_zero [of \"F\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (subst aGroup.ag_l_zero [THEN sym, of \"F\" \"\\<zero>\\<^bsub>F\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n                         \\<zero>\\<^bsub>F\\<^esub>) =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply (frule aGroup.ag_l_zero [THEN sym, of \"F\" \"\\<zero>\\<^bsub>F\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply (subgoal_tac \"f (\\<zero>\\<^bsub>F\\<^esub>) = f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub> \\<zero>\\<^bsub>F\\<^esub>)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n        \\<zero>\\<^bsub>F\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> =\n                      f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n                         \\<zero>\\<^bsub>F\\<^esub>)", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> =\n                      f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n                         \\<zero>\\<^bsub>F\\<^esub>)\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n        \\<zero>\\<^bsub>F\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n     \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n        \\<zero>\\<^bsub>F\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply (thin_tac \"\\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub> \\<zero>\\<^bsub>F\\<^esub>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f (\\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>F\\<^esub>\n        \\<zero>\\<^bsub>F\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                      f \\<zero>\\<^bsub>F\\<^esub> =\n                      \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (frule sym)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (thin_tac \"f \\<zero>\\<^bsub>F\\<^esub> = f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub> f \\<zero>\\<^bsub>F\\<^esub>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (frule aHom_mem[of \"F\" \"G\" \"f\" \"\\<zero>\\<^bsub>F\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier G\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (frule aGroup.ag_mOp_closed[of \"G\" \"f \\<zero>\\<^bsub>F\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier G;\n     -\\<^sub>a\\<^bsub>G\\<^esub> f \\<zero>\\<^bsub>F\\<^esub>\n     \\<in> carrier G\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (frule aGroup.aassoc[of \"G\" \"-\\<^sub>a\\<^bsub>G\\<^esub> (f \\<zero>\\<^bsub>F\\<^esub>)\" \"f \\<zero>\\<^bsub>F\\<^esub>\" \"f \\<zero>\\<^bsub>F\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     f \\<zero>\\<^bsub>F\\<^esub>;\n     f \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier G;\n     -\\<^sub>a\\<^bsub>G\\<^esub> f \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier G;\n     -\\<^sub>a\\<^bsub>G\\<^esub> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     f \\<zero>\\<^bsub>F\\<^esub> =\n     -\\<^sub>a\\<^bsub>G\\<^esub> f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n     (f \\<zero>\\<^bsub>F\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n      f \\<zero>\\<^bsub>F\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aGroup.l_m aGroup.l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ker_inc_zero:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk> \\<Longrightarrow> \\<zero>\\<^bsub>F\\<^esub> \\<in> ker\\<^bsub>F,G\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>F\\<^esub>\n                      \\<in> ker\\<^bsub>F,G\\<^esub> f", "by (frule aHom_0_0[of \"F\" \"G\" \"f\"], assumption+,\n       simp add:ker_def, simp add:aGroup.ag_inc_zero [of \"F\"])"], ["", "lemma aHom_inv_inv:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F\\<rbrakk> \\<Longrightarrow>\n                         f (-\\<^sub>a\\<^bsub>F\\<^esub> a) = -\\<^sub>a\\<^bsub>G\\<^esub> (f a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     a \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>F\\<^esub> a) =\n                      -\\<^sub>a\\<^bsub>G\\<^esub> f a", "apply (frule aGroup.ag_l_inv1 [of \"F\" \"a\"], assumption+,\n       frule sym, thin_tac \"-\\<^sub>a\\<^bsub>F\\<^esub> a \\<plusminus>\\<^bsub>F\\<^esub> a = \\<zero>\\<^bsub>F\\<^esub>\",\n       frule aHom_0_0[of \"F\" \"G\" \"f\"], assumption+,\n       frule aGroup.ag_mOp_closed[of \"F\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n     \\<zero>\\<^bsub>F\\<^esub> =\n     -\\<^sub>a\\<^bsub>F\\<^esub> a \\<plusminus>\\<^bsub>F\\<^esub> a;\n     f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>;\n     -\\<^sub>a\\<^bsub>F\\<^esub> a \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>F\\<^esub> a) =\n                      -\\<^sub>a\\<^bsub>G\\<^esub> f a", "apply (simp add:aHom_add, thin_tac \"\\<zero>\\<^bsub>F\\<^esub> = -\\<^sub>a\\<^bsub>F\\<^esub> a \\<plusminus>\\<^bsub>F\\<^esub> a\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n     f (-\\<^sub>a\\<^bsub>F\\<^esub> a) \\<plusminus>\\<^bsub>G\\<^esub> f a =\n     \\<zero>\\<^bsub>G\\<^esub>;\n     -\\<^sub>a\\<^bsub>F\\<^esub> a \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>F\\<^esub> a) =\n                      -\\<^sub>a\\<^bsub>G\\<^esub> f a", "apply (frule aHom_mem[of \"F\" \"G\" \"f\" \"-\\<^sub>a\\<^bsub>F\\<^esub> a\"], assumption+,\n        frule aHom_mem[of \"F\" \"G\" \"f\" \"a\"], assumption+,\n        simp only:aGroup.ag_pOp_commute[of \"G\" \"f (-\\<^sub>a\\<^bsub>F\\<^esub> a)\" \"f a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n     f a \\<plusminus>\\<^bsub>G\\<^esub> f (-\\<^sub>a\\<^bsub>F\\<^esub> a) =\n     \\<zero>\\<^bsub>G\\<^esub>;\n     -\\<^sub>a\\<^bsub>F\\<^esub> a \\<in> carrier F;\n     f (-\\<^sub>a\\<^bsub>F\\<^esub> a) \\<in> carrier G;\n     f a \\<in> carrier G\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>F\\<^esub> a) =\n                      -\\<^sub>a\\<^bsub>G\\<^esub> f a", "apply (rule aGroup.ag_inv_unique[of \"G\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma aHom_compos:\"\\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M; g \\<in> aHom M N \\<rbrakk>\n  \\<Longrightarrow> compos L g f \\<in> aHom L N\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> aHom L N", "apply (simp add:aHom_def [of \"L\" \"N\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f\n                      \\<in> carrier L \\<rightarrow> carrier N \\<and>\n                      compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> carrier L \\<rightarrow> carrier N\n 2. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; x \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> compos L g f x \\<in> carrier N\n 2. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; x \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (f x) \\<in> carrier N\n 2. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (rule aHom_mem [of \"M\" \"N\" \"g\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; x \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> f x \\<in> carrier M\n 2. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (simp add:aHom_mem [of \"L\" \"M\" \"f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L) \\<and>\n                      (\\<forall>a\\<in>carrier L.\n                          \\<forall>b\\<in>carrier L.\n                             compos L g f\n                              (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                             compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                             compos L g f b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos L g f \\<in> extensional (carrier L)\n 2. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier L.\n                         \\<forall>b\\<in>carrier L.\n                            compos L g f\n                             (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                            compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                            compos L g f b", "apply (simp add:compos_def compose_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n     g \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier L.\n                         \\<forall>b\\<in>carrier L.\n                            compos L g f\n                             (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                            compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                            compos L g f b", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> compos L g f (a \\<plusminus>\\<^bsub>L\\<^esub> b) =\n                         compos L g f a \\<plusminus>\\<^bsub>N\\<^esub>\n                         compos L g f b", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus>\\<^bsub>L\\<^esub> b\n                          \\<in> carrier L \\<longrightarrow>\n                          g (f (a \\<plusminus>\\<^bsub>L\\<^esub> b)) =\n                          g (f a) \\<plusminus>\\<^bsub>N\\<^esub>\n                          g (f b)) \\<and>\n                         (a \\<plusminus>\\<^bsub>L\\<^esub> b\n                          \\<notin> carrier L \\<longrightarrow>\n                          undefined =\n                          g (f a) \\<plusminus>\\<^bsub>N\\<^esub> g (f b))", "apply (simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (f (a \\<plusminus>\\<^bsub>L\\<^esub> b)) =\n                         g (f a) \\<plusminus>\\<^bsub>N\\<^esub> g (f b)", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> g (f a \\<plusminus>\\<^bsub>M\\<^esub> f b) =\n                         g (f a) \\<plusminus>\\<^bsub>N\\<^esub> g (f b)", "apply (rule aHom_add, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> f a \\<in> carrier M\n 2. \\<And>a b.\n       \\<lbrakk>aGroup L; aGroup M; aGroup N; f \\<in> aHom L M;\n        g \\<in> aHom M N; a \\<in> carrier L; b \\<in> carrier L\\<rbrakk>\n       \\<Longrightarrow> f b \\<in> carrier M", "apply (simp add:aHom_mem)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma aHom_compos_assoc:\"\\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n      g \\<in> aHom L M; h \\<in> aHom M N \\<rbrakk>  \\<Longrightarrow>\n      compos K h (compos K g f) = compos K (compos L h g) f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> compos K h (compos K g f) = compos K (compos L h g) f", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>carrier K.\n                          h (if x \\<in> carrier K then g (f x)\n                             else undefined)) =\n                      (\\<lambda>x\\<in>carrier K.\n                          if f x \\<in> carrier L then h (g (f x))\n                          else undefined)", "apply (rule funcset_eq[of _ \"carrier K\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>carrier K.\n                          h (if x \\<in> carrier K then g (f x)\n                             else undefined))\n                      \\<in> extensional (carrier K)\n 2. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>carrier K.\n                          if f x \\<in> carrier L then h (g (f x))\n                          else undefined)\n                      \\<in> extensional (carrier K)\n 3. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier K.\n                         (\\<lambda>x\\<in>carrier K.\n                             h (if x \\<in> carrier K then g (f x)\n                                else undefined))\n                          x =\n                         (\\<lambda>x\\<in>carrier K.\n                             if f x \\<in> carrier L then h (g (f x))\n                             else undefined)\n                          x", "apply (simp add:restrict_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>carrier K.\n                          if f x \\<in> carrier L then h (g (f x))\n                          else undefined)\n                      \\<in> extensional (carrier K)\n 2. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier K.\n                         (\\<lambda>x\\<in>carrier K.\n                             h (if x \\<in> carrier K then g (f x)\n                                else undefined))\n                          x =\n                         (\\<lambda>x\\<in>carrier K.\n                             if f x \\<in> carrier L then h (g (f x))\n                             else undefined)\n                          x", "apply (simp add:restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n     g \\<in> aHom L M; h \\<in> aHom M N\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier K.\n                         (\\<lambda>x\\<in>carrier K.\n                             h (if x \\<in> carrier K then g (f x)\n                                else undefined))\n                          x =\n                         (\\<lambda>x\\<in>carrier K.\n                             if f x \\<in> carrier L then h (g (f x))\n                             else undefined)\n                          x", "apply (rule ballI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>aGroup K; aGroup L; aGroup M; aGroup N; f \\<in> aHom K L;\n        g \\<in> aHom L M; h \\<in> aHom M N; x \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> f x \\<notin> carrier L \\<longrightarrow>\n                         h (g (f x)) = undefined", "apply (simp add:aHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma injec_inj_on:\"\\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow> inj_on f (carrier F)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> inj_on f (carrier F)", "apply (simp add:inj_on_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier F.\n                         \\<forall>y\\<in>carrier F.\n                            f x = f y \\<longrightarrow> x = y", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        x \\<in> carrier F; y \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f x = f y \\<longrightarrow> x = y", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        x \\<in> carrier F; y \\<in> carrier F; f x = f y\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:injec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f x = f y; f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule_tac a = x in aHom_mem[of \"F\" \"G\" \"f\"], assumption+,\n        frule_tac a = x in aHom_mem[of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f x = f y; f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G; f x \\<in> carrier G\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule_tac x = \"f x\" in aGroup.ag_r_inv1[of \"G\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f x = f y; f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G; f x \\<in> carrier G;\n        f x \\<plusminus>\\<^bsub>G\\<^esub> -\\<^sub>a\\<^bsub>G\\<^esub> f x =\n        \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp only:aHom_inv_inv[THEN sym, of \"F\" \"G\" \"f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f x = f y; f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>};\n        f y \\<in> carrier G; True;\n        f y \\<plusminus>\\<^bsub>G\\<^esub> f (-\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule sym, thin_tac \"f x = f y\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f x \\<plusminus>\\<^bsub>G\\<^esub> f (-\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (frule_tac x = y in aGroup.ag_mOp_closed[of \"F\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> f = {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f x \\<plusminus>\\<^bsub>G\\<^esub> f (-\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (simp add:aHom_add[THEN sym], simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f (x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x = y", "apply (subgoal_tac \"x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>}\",\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>; f y = f x;\n        -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F;\n        x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y =\n        \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = y\n 2. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f (x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> y\n                         \\<in> {a \\<in> carrier F.\n                                f a = \\<zero>\\<^bsub>G\\<^esub>}", "apply (subst aGroup.ag_eq_diffzero[of \"F\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f (x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> y\n                         \\<in> {a \\<in> carrier F.\n                                f a = \\<zero>\\<^bsub>G\\<^esub>}", "apply (frule_tac x = x and y = \"-\\<^sub>a\\<^bsub>F\\<^esub> y\" in aGroup.ag_pOp_closed[of \"F\"],\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f (x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F;\n        x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y\n        \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> y\n                         \\<in> {a \\<in> carrier F.\n                                f a = \\<zero>\\<^bsub>G\\<^esub>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier F; y \\<in> carrier F;\n        f \\<in> aHom F G;\n        {a \\<in> carrier F. f a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        f x \\<in> carrier G;\n        f (x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y) =\n        \\<zero>\\<^bsub>G\\<^esub>;\n        f y = f x; -\\<^sub>a\\<^bsub>F\\<^esub> y \\<in> carrier F;\n        x \\<plusminus>\\<^bsub>F\\<^esub> -\\<^sub>a\\<^bsub>F\\<^esub> y\n        \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> y =\n                         \\<zero>\\<^bsub>F\\<^esub>", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma surjec_surj_to:\"surjec\\<^bsub>R,S\\<^esub> f \\<Longrightarrow> surj_to f (carrier R) (carrier S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. surjec\\<^bsub>R,S\\<^esub> f \\<Longrightarrow>\n    surj_to f (carrier R) (carrier S)", "by (simp add:surjec_def)"], ["", "lemma compos_bijec:\"\\<lbrakk>aGroup E; aGroup F; aGroup G; bijec\\<^bsub>E,F\\<^esub> f; bijec\\<^bsub>F,G\\<^esub> g\\<rbrakk> \\<Longrightarrow>\n                     bijec\\<^bsub>E,G\\<^esub> (compos E g f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; bijec\\<^bsub>E,F\\<^esub> f;\n     bijec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:bijec_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>E,G\\<^esub> compos E g f \\<and>\n                      surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>E,G\\<^esub> compos E g f\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:injec_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> compos E g f \\<in> aHom E G \\<and>\n                      ker\\<^bsub>E,G\\<^esub> compos E g f =\n                      {\\<zero>\\<^bsub>E\\<^esub>}\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:aHom_compos[of \"E\" \"F\" \"G\" \"f\" \"g\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>E,G\\<^esub> compos E g f =\n                      {\\<zero>\\<^bsub>E\\<^esub>}\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (rule equalityI, rule subsetI, simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E;\n        compos E g f x = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>E\\<^esub>\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E; g (f x) = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>E\\<^esub>\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (frule_tac a = x in aHom_mem[of \"E\" \"F\" \"f\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E; g (f x) = \\<zero>\\<^bsub>G\\<^esub>;\n        f x \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>E\\<^esub>\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (subgoal_tac \"(f x) \\<in> {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>}\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E;\n        g \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>;\n        \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n        f x = \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>E\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E; g (f x) = \\<zero>\\<^bsub>G\\<^esub>;\n        f x \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier F.\n                                g a = \\<zero>\\<^bsub>G\\<^esub>}\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 4. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (subgoal_tac \"x \\<in> {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>}\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E;\n        g \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>;\n        \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F;\n        f x = \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {a \\<in> carrier E.\n                                  f a = \\<zero>\\<^bsub>F\\<^esub>}\n 2. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E; g (f x) = \\<zero>\\<^bsub>G\\<^esub>;\n        f x \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier F.\n                                g a = \\<zero>\\<^bsub>G\\<^esub>}\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 4. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x \\<in> carrier E; g (f x) = \\<zero>\\<^bsub>G\\<^esub>;\n        f x \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f x\n                         \\<in> {a \\<in> carrier F.\n                                g a = \\<zero>\\<^bsub>G\\<^esub>}\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 3. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n     g \\<in> aHom F G;\n     ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>E\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>E,G\\<^esub> compos E g f\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        ker\\<^bsub>E,F\\<^esub> f = {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        ker\\<^bsub>F,G\\<^esub> g = {\\<zero>\\<^bsub>F\\<^esub>};\n        x = \\<zero>\\<^bsub>E\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>E\\<^esub>\n                         \\<in> ker\\<^bsub>E,G\\<^esub> compos E g f\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:ker_def compos_def compose_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x = \\<zero>\\<^bsub>E\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (\\<zero>\\<^bsub>E\\<^esub>\n                          \\<in> carrier E \\<longrightarrow>\n                          g (f \\<zero>\\<^bsub>E\\<^esub>) =\n                          \\<zero>\\<^bsub>G\\<^esub>) \\<and>\n                         \\<zero>\\<^bsub>E\\<^esub> \\<in> carrier E\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:aGroup.ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup E; aGroup F; aGroup G; surjec\\<^bsub>E,F\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n        {a \\<in> carrier E. f a = \\<zero>\\<^bsub>F\\<^esub>} =\n        {\\<zero>\\<^bsub>E\\<^esub>};\n        g \\<in> aHom F G;\n        {a \\<in> carrier F. g a = \\<zero>\\<^bsub>G\\<^esub>} =\n        {\\<zero>\\<^bsub>F\\<^esub>};\n        x = \\<zero>\\<^bsub>E\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> g (f \\<zero>\\<^bsub>E\\<^esub>) =\n                         \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:aHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     surjec\\<^bsub>E,F\\<^esub> f; injec\\<^bsub>F,G\\<^esub> g;\n     surjec\\<^bsub>F,G\\<^esub> g\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>E,G\\<^esub> compos E g f", "apply (simp add:surjec_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     injec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     surj_to f (carrier E) (carrier F); g \\<in> aHom F G;\n     surj_to g (carrier F) (carrier G)\\<rbrakk>\n    \\<Longrightarrow> compos E g f \\<in> aHom E G \\<and>\n                      surj_to (compos E g f) (carrier E) (carrier G)", "apply (simp add:aHom_compos)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     injec\\<^bsub>F,G\\<^esub> g; f \\<in> aHom E F;\n     surj_to f (carrier E) (carrier F); g \\<in> aHom F G;\n     surj_to g (carrier F) (carrier G)\\<rbrakk>\n    \\<Longrightarrow> surj_to (compos E g f) (carrier E) (carrier G)", "apply (simp add:aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     injec\\<^bsub>F,G\\<^esub> g; surj_to f (carrier E) (carrier F);\n     surj_to g (carrier F) (carrier G);\n     f \\<in> carrier E \\<rightarrow> carrier F;\n     g \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier E);\n     \\<forall>a\\<in>carrier E.\n        \\<forall>b\\<in>carrier E.\n           f (a \\<plusminus>\\<^bsub>E\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>F\\<^esub> f b;\n     g \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           g (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           g a \\<plusminus>\\<^bsub>G\\<^esub> g b\\<rbrakk>\n    \\<Longrightarrow> surj_to (compos E g f) (carrier E) (carrier G)", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; aGroup G; injec\\<^bsub>E,F\\<^esub> f;\n     injec\\<^bsub>F,G\\<^esub> g; surj_to f (carrier E) (carrier F);\n     surj_to g (carrier F) (carrier G);\n     f \\<in> carrier E \\<rightarrow> carrier F;\n     g \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier E);\n     \\<forall>a\\<in>carrier E.\n        \\<forall>b\\<in>carrier E.\n           f (a \\<plusminus>\\<^bsub>E\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>F\\<^esub> f b;\n     g \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           g (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           g a \\<plusminus>\\<^bsub>G\\<^esub> g b\\<rbrakk>\n    \\<Longrightarrow> surj_to (compose (carrier E) g f) (carrier E)\n                       (carrier G)", "apply (rule compose_surj[of \"f\" \"carrier E\" \"carrier F\" \"g\" \"carrier G\"],\n            assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ainvf_aHom:\"\\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n                      ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F", "apply (subst aHom_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ainvf\\<^bsub>F,G\\<^esub> f\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      ainvf\\<^bsub>F,G\\<^esub> f\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (ainvf\\<^bsub>F,G\\<^esub> f)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (ainvf\\<^bsub>F,G\\<^esub> f)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (ainvf\\<^bsub>F,G\\<^esub> f) b)", "apply (simp add:ainvf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (simp add:bijec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (frule injec_inj_on[of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     surjec\\<^bsub>F,G\\<^esub> f; inj_on f (carrier F)\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (simp add:surjec_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); f \\<in> aHom F G;\n     surj_to f (carrier F) (carrier G)\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (simp add:aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> carrier G \\<rightarrow> carrier F \\<and>\n                      f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (frule inv_func[of \"f\" \"carrier F\" \"carrier G\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n     f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n     \\<in> carrier G \\<rightarrow> carrier F\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G) \\<and>\n                      (\\<forall>a\\<in>carrier G.\n                          \\<forall>b\\<in>carrier G.\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              a \\<plusminus>\\<^bsub>F\\<^esub>\n                             (f\\<inverse>\\<^bsub>carrier\n            G,carrier F\\<^esub>)\n                              b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n     f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n     \\<in> carrier G \\<rightarrow> carrier F\\<rbrakk>\n    \\<Longrightarrow> f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n                      \\<in> extensional (carrier G)\n 2. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n     f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n     \\<in> carrier G \\<rightarrow> carrier F\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier G.\n                         \\<forall>b\\<in>carrier G.\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             a \\<plusminus>\\<^bsub>F\\<^esub>\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             b", "apply (simp add:invfun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n     inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n     f \\<in> carrier F \\<rightarrow> carrier G;\n     f \\<in> extensional (carrier F);\n     \\<forall>a\\<in>carrier F.\n        \\<forall>b\\<in>carrier F.\n           f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n     f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n     \\<in> carrier G \\<rightarrow> carrier F\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier G.\n                         \\<forall>b\\<in>carrier G.\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             a \\<plusminus>\\<^bsub>F\\<^esub>\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             b", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac x = a in funcset_mem[of \"Ifn F G f\" \"carrier G\" \"carrier F\"],\n      assumption+,\n      frule_tac x = b in funcset_mem[of \"Ifn F G f\" \"carrier G\" \"carrier F\"],\n      assumption+,\n      frule_tac x = a and y = b in aGroup.ag_pOp_closed[of \"G\"], assumption+,\n      frule_tac x = \"a \\<plusminus>\\<^bsub>G\\<^esub> b\" in funcset_mem[of \"Ifn F G f\" \"carrier G\"\n       \"carrier F\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac a = \"(Ifn F G f) a\" and b = \"(Ifn F G f) b\" in\n           aHom_add[of \"F\" \"G\" \"f\"], assumption+, simp add:injec_def,\n           assumption+,\n           thin_tac \"\\<forall>a\\<in>carrier F. \\<forall>b\\<in>carrier F. f (a \\<plusminus>\\<^bsub>F\\<^esub> b) = f a \\<plusminus>\\<^bsub>G\\<^esub> f b\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a) \\<plusminus>\\<^bsub>G\\<^esub>\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b)\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (simp add:invfun_r[of \"f\" \"carrier F\" \"carrier G\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac x = a and y = b in aGroup.ag_pOp_closed[of \"G\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac b = \"a \\<plusminus>\\<^bsub>G\\<^esub> b\" in invfun_r[of \"f\" \"carrier F\" \"carrier G\"],\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        inj_on f (carrier F); surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (simp add:inj_on_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        \\<forall>x\\<in>carrier F.\n           \\<forall>y\\<in>carrier F. f x = f y \\<longrightarrow> x = y;\n        surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac x = \"(Ifn F G f) a\" and y = \"(Ifn F G f) b\" in\n          aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        \\<forall>x\\<in>carrier F.\n           \\<forall>y\\<in>carrier F. f x = f y \\<longrightarrow> x = y;\n        surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         a \\<plusminus>\\<^bsub>F\\<^esub>\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b\n        \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac x = \"(Ifn F G f) (a \\<plusminus>\\<^bsub>G\\<^esub> b)\" in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier F. \\<forall>y\\<in>carrier F. f x = f y \\<longrightarrow> x = y\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         a \\<plusminus>\\<^bsub>F\\<^esub>\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b\n        \\<in> carrier F;\n        \\<forall>y\\<in>carrier F.\n           f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n               (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n           f y \\<longrightarrow>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n           y\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply (frule_tac x = \"(Ifn F G f) a \\<plusminus>\\<^bsub>F\\<^esub> (Ifn F G f) b\" in bspec,\n            assumption,\n        thin_tac \"\\<forall>y\\<in>carrier F.\n              f ((Ifn F G f) (a \\<plusminus>\\<^bsub>G\\<^esub> b)) = f y \\<longrightarrow> (Ifn F G f) (a \\<plusminus>\\<^bsub>G\\<^esub> b) = y\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; injec\\<^bsub>F,G\\<^esub> f;\n        surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>\n        \\<in> carrier G \\<rightarrow> carrier F;\n        a \\<in> carrier G; b \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) a \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b \\<in> carrier F;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b)\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        a \\<plusminus>\\<^bsub>G\\<^esub> b \\<in> carrier G;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        a \\<plusminus>\\<^bsub>G\\<^esub> b;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         a \\<plusminus>\\<^bsub>F\\<^esub>\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b\n        \\<in> carrier F;\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b)) =\n        f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            a \\<plusminus>\\<^bsub>F\\<^esub>\n           (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n            b) \\<longrightarrow>\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n         a \\<plusminus>\\<^bsub>F\\<^esub>\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b\\<rbrakk>\n       \\<Longrightarrow> (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                          a \\<plusminus>\\<^bsub>F\\<^esub>\n                         (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) b", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ainvf_bijec:\"\\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk> \\<Longrightarrow> bijec\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)", "apply (subst bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f) \\<and>\n                      surjec\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)", "apply (simp add:injec_def surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F \\<and>\n                      ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f) =\n                      {\\<zero>\\<^bsub>G\\<^esub>} \\<and>\n                      ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F \\<and>\n                      surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:ainvf_aHom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f) =\n                      {\\<zero>\\<^bsub>G\\<^esub>} \\<and>\n                      surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f) =\n                      {\\<zero>\\<^bsub>G\\<^esub>}\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n                      \\<subseteq> {\\<zero>\\<^bsub>G\\<^esub>}\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (rule subsetI, simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        x \\<in> carrier G;\n        (ainvf\\<^bsub>F,G\\<^esub> f) x = \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:ainvf_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        x \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) x =\n        \\<zero>\\<^bsub>F\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:bijec_def,(erule conjE)+, simp add:surjec_def,\n         (erule conjE)+, simp add:aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) x =\n        \\<zero>\\<^bsub>F\\<^esub>;\n        injec\\<^bsub>F,G\\<^esub> f; surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (frule injec_inj_on[of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) x =\n        \\<zero>\\<^bsub>F\\<^esub>;\n        injec\\<^bsub>F,G\\<^esub> f; surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        inj_on f (carrier F)\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (subst invfun_r[THEN sym, of \"f\" \"carrier F\" \"carrier G\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; x \\<in> carrier G;\n        (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>) x =\n        \\<zero>\\<^bsub>F\\<^esub>;\n        injec\\<^bsub>F,G\\<^esub> f; surj_to f (carrier F) (carrier G);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        inj_on f (carrier F)\\<rbrakk>\n       \\<Longrightarrow> f ((f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             x) =\n                         \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 3. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:injec_def, (erule conjE)+, simp add:aHom_0_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>G\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>G,F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f)\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (rule subsetI, simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        x = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>G\\<^esub> \\<in> carrier G \\<and>\n                         (ainvf\\<^bsub>F,G\\<^esub> f)\n                          \\<zero>\\<^bsub>G\\<^esub> =\n                         \\<zero>\\<^bsub>F\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:aGroup.ex_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        x = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (ainvf\\<^bsub>F,G\\<^esub> f)\n                          \\<zero>\\<^bsub>G\\<^esub> =\n                         \\<zero>\\<^bsub>F\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (frule ainvf_aHom[of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        x = \\<zero>\\<^bsub>G\\<^esub>;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> aHom G F\\<rbrakk>\n       \\<Longrightarrow> (ainvf\\<^bsub>F,G\\<^esub> f)\n                          \\<zero>\\<^bsub>G\\<^esub> =\n                         \\<zero>\\<^bsub>F\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (simp add:aHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> surj_to (ainvf\\<^bsub>F,G\\<^esub> f) (carrier G)\n                       (carrier F)", "apply (frule ainvf_aHom[of \"F\" \"G\" \"f\"], assumption+,\n        simp add:aHom_def, (erule conjE)+,\n       rule surj_to_test[of \"ainvf\\<^bsub>F,G\\<^esub> f\" \"carrier G\" \"carrier F\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n     ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n     ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n     \\<forall>a\\<in>carrier G.\n        \\<forall>b\\<in>carrier G.\n           (ainvf\\<^bsub>F,G\\<^esub> f)\n            (a \\<plusminus>\\<^bsub>G\\<^esub> b) =\n           (ainvf\\<^bsub>F,G\\<^esub> f) a \\<plusminus>\\<^bsub>F\\<^esub>\n           (ainvf\\<^bsub>F,G\\<^esub> f) b\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier F.\n                         \\<exists>a\\<in>carrier G.\n                            (ainvf\\<^bsub>F,G\\<^esub> f) a = b", "apply (rule ballI,\n        thin_tac \"\\<forall>a\\<in>carrier G. \\<forall>b\\<in>carrier G.\n               (ainvf\\<^bsub>F,G\\<^esub> f) (a \\<plusminus>\\<^bsub>G\\<^esub> b) = (ainvf\\<^bsub>F,G\\<^esub> f) a \\<plusminus>\\<^bsub>F\\<^esub> (ainvf\\<^bsub>F,G\\<^esub> f) b\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup F; aGroup G; bijec\\<^bsub>F,G\\<^esub> f;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n        b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier G.\n                            (ainvf\\<^bsub>F,G\\<^esub> f) a = b", "apply (simp add:bijec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup F; aGroup G;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n        b \\<in> carrier F; injec\\<^bsub>F,G\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier G.\n                            (ainvf\\<^bsub>F,G\\<^esub> f) a = b", "apply (frule injec_inj_on[of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup F; aGroup G;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n        b \\<in> carrier F; injec\\<^bsub>F,G\\<^esub> f;\n        surjec\\<^bsub>F,G\\<^esub> f; inj_on f (carrier F)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier G.\n                            (ainvf\\<^bsub>F,G\\<^esub> f) a = b", "apply (simp add:surjec_def aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup F; aGroup G;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n        b \\<in> carrier F; injec\\<^bsub>F,G\\<^esub> f; inj_on f (carrier F);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        surj_to f (carrier F) (carrier G)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier G.\n                            (ainvf\\<^bsub>F,G\\<^esub> f) a = b", "apply (subst ainvf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup F; aGroup G;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> carrier G \\<rightarrow> carrier F;\n        ainvf\\<^bsub>F,G\\<^esub> f \\<in> extensional (carrier G);\n        b \\<in> carrier F; injec\\<^bsub>F,G\\<^esub> f; inj_on f (carrier F);\n        f \\<in> carrier F \\<rightarrow> carrier G;\n        f \\<in> extensional (carrier F);\n        \\<forall>a\\<in>carrier F.\n           \\<forall>b\\<in>carrier F.\n              f (a \\<plusminus>\\<^bsub>F\\<^esub> b) =\n              f a \\<plusminus>\\<^bsub>G\\<^esub> f b;\n        surj_to f (carrier F) (carrier G)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier G.\n                            (f\\<inverse>\\<^bsub>carrier G,carrier F\\<^esub>)\n                             a =\n                            b", "apply (frule_tac a = b in invfun_l[of \"f\" \"carrier F\" \"carrier G\"],\n                  assumption+,\n        frule_tac x = b in funcset_mem[of \"f\" \"carrier F\" \"carrier G\"],\n                  assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ainvf_l:\"\\<lbrakk>aGroup E; aGroup F; bijec\\<^bsub>E,F\\<^esub> f; x \\<in> carrier E\\<rbrakk> \\<Longrightarrow>\n                      (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; bijec\\<^bsub>E,F\\<^esub> f;\n     x \\<in> carrier E\\<rbrakk>\n    \\<Longrightarrow> (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x", "apply (simp add:bijec_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; x \\<in> carrier E;\n     injec\\<^bsub>E,F\\<^esub> f; surjec\\<^bsub>E,F\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x", "apply (frule injec_inj_on[of \"E\" \"F\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; x \\<in> carrier E;\n     injec\\<^bsub>E,F\\<^esub> f; surjec\\<^bsub>E,F\\<^esub> f;\n     inj_on f (carrier E)\\<rbrakk>\n    \\<Longrightarrow> (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x", "apply (simp add:surjec_def aHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; x \\<in> carrier E;\n     injec\\<^bsub>E,F\\<^esub> f; inj_on f (carrier E);\n     f \\<in> carrier E \\<rightarrow> carrier F;\n     f \\<in> extensional (carrier E);\n     \\<forall>a\\<in>carrier E.\n        \\<forall>b\\<in>carrier E.\n           f (a \\<plusminus>\\<^bsub>E\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>F\\<^esub> f b;\n     surj_to f (carrier E) (carrier F)\\<rbrakk>\n    \\<Longrightarrow> (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x", "apply (frule invfun_l[of \"f\" \"carrier E\" \"carrier F\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup E; aGroup F; x \\<in> carrier E;\n     injec\\<^bsub>E,F\\<^esub> f; inj_on f (carrier E);\n     f \\<in> carrier E \\<rightarrow> carrier F;\n     f \\<in> extensional (carrier E);\n     \\<forall>a\\<in>carrier E.\n        \\<forall>b\\<in>carrier E.\n           f (a \\<plusminus>\\<^bsub>E\\<^esub> b) =\n           f a \\<plusminus>\\<^bsub>F\\<^esub> f b;\n     surj_to f (carrier E) (carrier F);\n     (f\\<inverse>\\<^bsub>carrier F,carrier E\\<^esub>) (f x) = x\\<rbrakk>\n    \\<Longrightarrow> (ainvf\\<^bsub>E,F\\<^esub> f) (f x) = x", "apply (simp add:ainvf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) aI_aHom:\"aI\\<^bsub>A\\<^esub> \\<in> aHom A A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. aI\\<^bsub>A\\<^esub> \\<in> aHom A A", "by (simp add:aHom_def ag_idmap_def ag_idmap_def ag_pOp_closed)"], ["", "lemma compos_aI_l:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk> \\<Longrightarrow> compos A aI\\<^bsub>B\\<^esub> f = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compos A aI\\<^bsub>B\\<^esub> f = f", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compose (carrier A) aI\\<^bsub>B\\<^esub> f = f", "apply (rule funcset_eq[of _ \"carrier A\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compose (carrier A) aI\\<^bsub>B\\<^esub> f\n                      \\<in> extensional (carrier A)\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A)\n 3. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) aI\\<^bsub>B\\<^esub> f x = f x", "apply (simp add:compose_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A)\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) aI\\<^bsub>B\\<^esub> f x = f x", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) aI\\<^bsub>B\\<^esub> f x = f x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> compose (carrier A) aI\\<^bsub>B\\<^esub> f x = f x", "apply (frule_tac a = x in aHom_mem[of \"A\" \"B\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; x \\<in> carrier A;\n        f x \\<in> carrier B\\<rbrakk>\n       \\<Longrightarrow> compose (carrier A) aI\\<^bsub>B\\<^esub> f x = f x", "apply (simp add:compose_def ag_idmap_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma compos_aI_r:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk> \\<Longrightarrow> compos A f aI\\<^bsub>A\\<^esub> = f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compos A f aI\\<^bsub>A\\<^esub> = f", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compose (carrier A) f aI\\<^bsub>A\\<^esub> = f", "apply (rule funcset_eq[of _ \"carrier A\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> compose (carrier A) f aI\\<^bsub>A\\<^esub>\n                      \\<in> extensional (carrier A)\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A)\n 3. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) f aI\\<^bsub>A\\<^esub> x = f x", "apply (simp add:compose_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A)\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) f aI\\<^bsub>A\\<^esub> x = f x", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         compose (carrier A) f aI\\<^bsub>A\\<^esub> x = f x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B;\n        x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> compose (carrier A) f aI\\<^bsub>A\\<^esub> x = f x", "apply (simp add:compose_def ag_idmap_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma compos_aI_surj:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n                      compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> surjec\\<^bsub>B,A\\<^esub> g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>B,A\\<^esub> g", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surj_to g (carrier B) (carrier A)", "apply (rule surj_to_test[of \"g\" \"carrier B\" \"carrier A\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> g \\<in> carrier B \\<rightarrow> carrier A\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier A.\n                         \\<exists>a\\<in>carrier B. g a = b", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier A.\n                         \\<exists>a\\<in>carrier B. g a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier B. g a = b", "apply (subgoal_tac \"compos A g f b = aI\\<^bsub>A\\<^esub> b\",\n        thin_tac \"compos A g f = aI\\<^bsub>A\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        b \\<in> carrier A; compos A g f b = aI\\<^bsub>A\\<^esub> b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier B. g a = b\n 2. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> compos A g f b = aI\\<^bsub>A\\<^esub> b", "apply (simp add:compos_def compose_def ag_idmap_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        b \\<in> carrier A; g (f b) = b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier B. g a = b\n 2. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> compos A g f b = aI\\<^bsub>A\\<^esub> b", "apply (frule_tac a = b in aHom_mem[of \"A\" \"B\" \"f\"], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> compos A g f b = aI\\<^bsub>A\\<^esub> b", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma compos_aI_inj:\"\\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n                      compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk> \\<Longrightarrow> injec\\<^bsub>A,B\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A,B\\<^esub> f", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,B\\<^esub> f = {\\<zero>\\<^bsub>A\\<^esub>}", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier A. f a = \\<zero>\\<^bsub>B\\<^esub>} =\n                      {\\<zero>\\<^bsub>A\\<^esub>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier A. f a = \\<zero>\\<^bsub>B\\<^esub>}\n                      \\<subseteq> {\\<zero>\\<^bsub>A\\<^esub>}\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply (rule subsetI, simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply (subgoal_tac \"compos A g f x = aI\\<^bsub>A\\<^esub> x\",\n        thin_tac \"compos A g f = aI\\<^bsub>A\\<^esub>\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        x \\<in> carrier A; f x = \\<zero>\\<^bsub>B\\<^esub>;\n        compos A g f x = aI\\<^bsub>A\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> compos A g f x = aI\\<^bsub>A\\<^esub> x\n 3. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        x \\<in> carrier A; f x = \\<zero>\\<^bsub>B\\<^esub>;\n        g \\<zero>\\<^bsub>B\\<^esub> = aI\\<^bsub>A\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> compos A g f x = aI\\<^bsub>A\\<^esub> x\n 3. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply (simp add:aHom_0_0 ag_idmap_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>B\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> compos A g f x = aI\\<^bsub>A\\<^esub> x\n 2. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n     compos A g f = aI\\<^bsub>A\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> {a \\<in> carrier A.\n                                   f a = \\<zero>\\<^bsub>B\\<^esub>}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; aGroup B; f \\<in> aHom A B; g \\<in> aHom B A;\n        compos A g f = aI\\<^bsub>A\\<^esub>;\n        x = \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A \\<and>\n                         f \\<zero>\\<^bsub>A\\<^esub> =\n                         \\<zero>\\<^bsub>B\\<^esub>", "apply (simp add:aGroup.ag_inc_zero aHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) Ag_ind_aHom:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> Agii A f \\<in> aHom A (Ag_ind A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> aHom A (Ag_ind A f)", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> Agii A f\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      Agii A f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             Agii A f (a \\<plusminus> b) =\n                             Agii A f\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             Agii A f b)", "apply (unfold bij_to_def, frule conjunct1, frule conjunct2, fold bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     surj_to f (carrier A) D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> Agii A f\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (Ag_ind A f) \\<and>\n                      Agii A f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             Agii A f (a \\<plusminus> b) =\n                             Agii A f\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             Agii A f b)", "apply (simp add:Ag_ind_carrier surj_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> carrier A \\<rightarrow> D \\<and>\n                      Agii A f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             Agii A f (a \\<plusminus> b) =\n                             Agii A f\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             Agii A f b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> carrier A \\<rightarrow> D\n 2. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             Agii A f (a \\<plusminus> b) =\n                             Agii A f\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             Agii A f b)", "apply (simp add:Agii_def Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             Agii A f (a \\<plusminus> b) =\n                             Agii A f\n                              a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             Agii A f b)", "apply (simp add:Agii_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n     f ` carrier A = D; inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            (a \\<plusminus> b\n                             \\<in> carrier A \\<longrightarrow>\n                             f (a \\<plusminus> b) =\n                             f a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub>\n                             f b) \\<and>\n                            (a \\<plusminus> b\n                             \\<notin> carrier A \\<longrightarrow>\n                             undefined =\n                             f a \\<plusminus>\\<^bsub>Ag_ind A f\\<^esub> f b)", "apply (simp add:Ag_ind_def Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n     bij_to f (carrier A) D; f ` carrier A = D;\n     inj_on f (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            (a \\<plusminus> b\n                             \\<in> carrier A \\<longrightarrow>\n                             f (a \\<plusminus> b) =\n                             f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f a) \\<plusminus>\n                                (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f b))) \\<and>\n                            (a \\<plusminus> b\n                             \\<notin> carrier A \\<longrightarrow>\n                             undefined =\n                             f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f a) \\<plusminus>\n                                (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f b)))", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n     bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n     surj_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            (a \\<plusminus> b\n                             \\<in> carrier A \\<longrightarrow>\n                             f (a \\<plusminus> b) =\n                             f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f a) \\<plusminus>\n                                (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f b))) \\<and>\n                            (a \\<plusminus> b\n                             \\<notin> carrier A \\<longrightarrow>\n                             undefined =\n                             f ((f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f a) \\<plusminus>\n                                (f\\<inverse>\\<^bsub>D,carrier A\\<^esub>)\n                                 (f b)))", "apply (simp add:invfun_l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>x. x \\<in> carrier A \\<longrightarrow> f x \\<in> D;\n     bij_to f (carrier A) D; f ` carrier A = D; inj_on f (carrier A);\n     surj_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            a \\<plusminus> b\n                            \\<notin> carrier A \\<longrightarrow>\n                            undefined = f (a \\<plusminus> b)", "apply (simp add:ag_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) Agii_mem:\"\\<lbrakk>f \\<in> carrier A \\<rightarrow> D; x \\<in> carrier A;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> Agii A f x \\<in> carrier (Ag_ind A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier A \\<rightarrow> D; x \\<in> carrier A;\n     bij_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> Agii A f x \\<in> carrier (Ag_ind A f)", "apply (simp add:Agii_def Ag_ind_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Ag_ind_bijec:\"\\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n      bij_to f (carrier A) (D::'d set)\\<rbrakk> \\<Longrightarrow> bijec\\<^bsub>A, (Ag_ind A f)\\<^esub> (Agii A f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (frule aGroup.Ag_ind_aHom[of \"A\" \"f\" \"D\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (frule aGroup.Ag_ind_aGroup[of \"A\" \"f\" \"D\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f \\<and>\n                      surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f =\n                      {\\<zero>\\<^bsub>A\\<^esub>}\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n                      \\<subseteq> {\\<zero>\\<^bsub>A\\<^esub>}\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n        bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f);\n        x \\<in> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {\\<zero>\\<^bsub>A\\<^esub>}\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (simp add:ker_def, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n        bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x \\<in> carrier A;\n        Agii A f x = \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (frule aHom_0_0[of \"A\" \"Ag_ind A f\" \"Agii A f\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n        bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x \\<in> carrier A;\n        Agii A f x = \\<zero>\\<^bsub>Ag_ind A f\\<^esub>;\n        Agii A f \\<zero>\\<^bsub>A\\<^esub> =\n        \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (rotate_tac -2, frule sym, thin_tac \"Agii A f x = \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Agii A f \\<zero>\\<^bsub>A\\<^esub> = Agii A f x; aGroup A;\n        f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        Agii A f \\<in> aHom A (Ag_ind A f); aGroup (Ag_ind A f);\n        x \\<in> carrier A;\n        \\<zero>\\<^bsub>Ag_ind A f\\<^esub> = Agii A f x\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (frule aGroup.ag_inc_zero[of \"A\"], simp add:Agii_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<zero>\\<^bsub>A\\<^esub> = f x; aGroup A;\n        f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        restrict f (carrier A) \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x \\<in> carrier A;\n        \\<zero>\\<^bsub>Ag_ind A f\\<^esub> = f x;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (unfold bij_to_def, frule conjunct2, fold bij_to_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<zero>\\<^bsub>A\\<^esub> = f x; aGroup A;\n        f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        restrict f (carrier A) \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x \\<in> carrier A;\n        \\<zero>\\<^bsub>Ag_ind A f\\<^esub> = f x;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A;\n        inj_on f (carrier A)\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (frule aGroup.ag_inc_zero[of \"A\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>f \\<zero>\\<^bsub>A\\<^esub> = f x; aGroup A;\n        f \\<in> carrier A \\<rightarrow> D; bij_to f (carrier A) D;\n        restrict f (carrier A) \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x \\<in> carrier A;\n        \\<zero>\\<^bsub>Ag_ind A f\\<^esub> = f x;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A; inj_on f (carrier A);\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> x = \\<zero>\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 3. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (simp add:injective_iff[THEN sym, of \"f\" \"carrier A\" \"\\<zero>\\<^bsub>A\\<^esub>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> {\\<zero>\\<^bsub>A\\<^esub>}\n                      \\<subseteq> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n        bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x = \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub>\n                         \\<in> ker\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (subst ker_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n        bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n        aGroup (Ag_ind A f); x = \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A \\<and>\n                         Agii A f \\<zero>\\<^bsub>A\\<^esub> =\n                         \\<zero>\\<^bsub>Ag_ind A f\\<^esub>\n 2. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (simp add:aGroup.ag_inc_zero, simp add:aHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,Ag_ind A f\\<^esub> Agii A f", "apply (subst surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f)\\<rbrakk>\n    \\<Longrightarrow> Agii A f \\<in> aHom A (Ag_ind A f) \\<and>\n                      surj_to (Agii A f) (carrier A) (carrier (Ag_ind A f))", "apply (unfold bij_to_def, frule conjunct1, fold bij_to_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; f \\<in> carrier A \\<rightarrow> D;\n     bij_to f (carrier A) D; Agii A f \\<in> aHom A (Ag_ind A f);\n     aGroup (Ag_ind A f); surj_to f (carrier A) D\\<rbrakk>\n    \\<Longrightarrow> surj_to (Agii A f) (carrier A) (carrier (Ag_ind A f))", "apply (simp add:aGroup.Ag_ind_carrier surj_to_def Agii_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  aimg :: \"[('b, 'm1) aGroup_scheme, _, 'b \\<Rightarrow> 'a]\n            \\<Rightarrow> 'a aGroup\"  (\"(3aimg\\<^bsub>_,_\\<^esub> _)\" [82,82,83]82) where\n  \"aimg\\<^bsub>F,A\\<^esub> f = A \\<lparr> carrier := f ` (carrier F), pop := pop A, mop := mop A,\n                  zero := zero A\\<rparr>\""], ["", "lemma ker_subg:\"\\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G \\<rbrakk> \\<Longrightarrow> F +> ker\\<^bsub>F,G\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> F +> ker\\<^bsub>F,G\\<^esub> f", "apply (rule aGroup.asubg_test, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>F,G\\<^esub> f \\<subseteq> carrier F\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>F,G\\<^esub> f \\<noteq> {}\n 3. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n        x \\<in> ker\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier F\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>F,G\\<^esub> f \\<noteq> {}\n 3. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>F,G\\<^esub> f \\<noteq> {}\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier F \\<and>\n                         f x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (frule aHom_0_0 [of \"F\" \"G\" \"f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier F \\<and>\n                         f x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (frule aGroup.ex_zero [of \"F\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n     f \\<zero>\\<^bsub>F\\<^esub> = \\<zero>\\<^bsub>G\\<^esub>;\n     \\<zero>\\<^bsub>F\\<^esub> \\<in> carrier F\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> carrier F \\<and>\n                         f x = \\<zero>\\<^bsub>G\\<^esub>\n 2. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                         \\<forall>b\\<in>ker\\<^bsub>F,G\\<^esub> f.\n                            a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b\n                            \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n        a \\<in> ker\\<^bsub>F,G\\<^esub> f;\n        b \\<in> ker\\<^bsub>F,G\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> b\n                         \\<in> ker\\<^bsub>F,G\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G;\n        a \\<in> carrier F \\<and> f a = \\<zero>\\<^bsub>G\\<^esub>;\n        b \\<in> carrier F \\<and> f b = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> b\n                         \\<in> carrier F \\<and>\n                         f (a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> b\n                         \\<in> carrier F \\<and>\n                         f (a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (frule_tac x = b in aGroup.ag_mOp_closed[of \"F\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> b\n                         \\<in> carrier F \\<and>\n                         f (a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>F\\<^esub>\n                         -\\<^sub>a\\<^bsub>F\\<^esub> b\n                         \\<in> carrier F\n 2. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>F\\<^esub>\n                            -\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>G\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                         f (-\\<^sub>a\\<^bsub>F\\<^esub> b) =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aHom_inv_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>G\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                         -\\<^sub>a\\<^bsub>G\\<^esub> \\<zero>\\<^bsub>G\\<^esub> =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (simp add:aGroup.ag_inv_zero[of \"G\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>G\\<^esub> \\<plusminus>\\<^bsub>G\\<^esub>\n                         \\<zero>\\<^bsub>G\\<^esub> =\n                         \\<zero>\\<^bsub>G\\<^esub>", "apply (cut_tac aGroup.ex_zero[of \"G\"], simp add:aGroup.l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup F; aGroup G; f \\<in> aHom F G; a \\<in> carrier F;\n        f a = \\<zero>\\<^bsub>G\\<^esub>; b \\<in> carrier F;\n        f b = \\<zero>\\<^bsub>G\\<^esub>;\n        -\\<^sub>a\\<^bsub>F\\<^esub> b \\<in> carrier F\\<rbrakk>\n       \\<Longrightarrow> aGroup G", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Quotient abelian group\""], ["", "definition\n  ar_coset :: \"['a, _ , 'a set] \\<Rightarrow> 'a set\" (** a_rcs **)\n     (\"(3_ \\<uplus>\\<^bsub>_\\<^esub> _)\" [66,66,67]66) where\n  \"ar_coset a A H = H \\<bullet>\\<^bsub>(b_ag A)\\<^esub> a\""], ["", "definition\n  set_ar_cos :: \"[_ , 'a set] \\<Rightarrow> 'a set set\" where\n  \"set_ar_cos A I = {X. \\<exists>a\\<in>carrier A. X = ar_coset a A I}\""], ["", "definition\n  aset_sum :: \"[_ , 'a set, 'a set] \\<Rightarrow> 'a set\" where\n  \"aset_sum A H K = s_top (b_ag A) H K\""], ["", "abbreviation\n  ASBOP1  (infix \"\\<minusplus>\\<index>\" 60) where\n  \"H \\<minusplus>\\<^bsub>A\\<^esub> K == aset_sum A H K\""], ["", "lemma (in aGroup) ag_a_in_ar_cos:\"\\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk> \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<in> H \\<bullet>\\<^bsub>b_ag A\\<^esub> a", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<in> H \\<bullet>\\<^bsub>b_ag A\\<^esub> a", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> H \\<bullet>\\<^bsub>b_ag A\\<^esub> a", "apply (rule Group.a_in_rcs[of \"b_ag A\" \"H\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag A)", "apply (simp add:ag_carrier_carrier[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) r_cos_subset:\"\\<lbrakk>A +> H; X \\<in> set_rcs (b_ag A) H\\<rbrakk> \\<Longrightarrow>\n                   X \\<subseteq> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; X \\<in> set_rcs (b_ag A) H\\<rbrakk>\n    \\<Longrightarrow> X \\<subseteq> carrier A", "apply (simp add:asubGroup_def set_rcs_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ;\n     \\<exists>a\\<in>carrier (b_ag A).\n        X = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a\\<rbrakk>\n    \\<Longrightarrow> X \\<subseteq> carrier A", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier (b_ag A);\n        X = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a\\<rbrakk>\n       \\<Longrightarrow> X \\<subseteq> carrier A", "apply (cut_tac  b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier (b_ag A);\n        X = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> X \\<subseteq> carrier A", "apply (frule_tac a = a in Group.rcs_subset[of \"b_ag A\" \"H\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier (b_ag A);\n        X = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; Group (b_ag A);\n        H \\<bullet>\\<^bsub>b_ag A\\<^esub> a\n        \\<subseteq> carrier (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> X \\<subseteq> carrier A", "apply (simp add:ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) asubg_costOp_commute:\"\\<lbrakk>A +> H; x \\<in> set_rcs (b_ag A) H;\n       y \\<in> set_rcs (b_ag A) H\\<rbrakk> \\<Longrightarrow>\n             c_top (b_ag A) H x y = c_top (b_ag A) H y x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; x \\<in> set_rcs (b_ag A) H;\n     y \\<in> set_rcs (b_ag A) H\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H x y = c_top (b_ag A) H y x", "apply (simp add:set_rcs_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>A +> H; a \\<in> carrier (b_ag A);\n        x = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; aa \\<in> carrier (b_ag A);\n        y = H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag A) H\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa) =\n                         c_top (b_ag A) H\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa)\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>A +> H; a \\<in> carrier (b_ag A);\n        x = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; aa \\<in> carrier (b_ag A);\n        y = H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa; Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag A) H\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa) =\n                         c_top (b_ag A) H\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa)\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)", "apply (subst Group.c_top_welldef[THEN sym], assumption+,\n       simp add:asubg_nsubg,\n       (simp add:ag_carrier_carrier)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>A +> H; a \\<in> carrier A;\n        x = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; aa \\<in> carrier A;\n        y = H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa; Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                         (a \\<cdot>\\<^bsub>b_ag A\\<^esub> aa) =\n                         c_top (b_ag A) H\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa)\n                          (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)", "apply (subst Group.c_top_welldef[THEN sym], assumption+,\n       simp add:asubg_nsubg,\n       (simp add:ag_carrier_carrier)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>A +> H; a \\<in> carrier A;\n        x = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; aa \\<in> carrier A;\n        y = H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa; Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                         (a \\<cdot>\\<^bsub>b_ag A\\<^esub> aa) =\n                         H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                         (aa \\<cdot>\\<^bsub>b_ag A\\<^esub> a)", "apply (simp add:agop_gop)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>A +> H; a \\<in> carrier A;\n        x = H \\<bullet>\\<^bsub>b_ag A\\<^esub> a; aa \\<in> carrier A;\n        y = H \\<bullet>\\<^bsub>b_ag A\\<^esub> aa; Group (b_ag A)\\<rbrakk>\n       \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                         (a \\<plusminus> aa) =\n                         H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                         (aa \\<plusminus> a)", "apply (simp add:ag_pOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) Subg_Qgroup:\"A +> H \\<Longrightarrow> aGroup (aqgrp A H)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> aGroup (aqgrp A H)", "apply (frule asubg_nsubg[of \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> aGroup (aqgrp A H)", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> aGroup (aqgrp A H)", "apply (simp add:aGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>aqgrp A H\\<^esub>)\n                      \\<in> carrier (aqgrp A H) \\<rightarrow>\n                            carrier (aqgrp A H) \\<rightarrow>\n                            carrier (aqgrp A H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (aqgrp A H) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                                  b \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>aqgrp A H\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                              a)) \\<and>\n                      mop (aqgrp A H)\n                      \\<in> carrier (aqgrp A H) \\<rightarrow>\n                            carrier (aqgrp A H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>aqgrp A H\\<^esub> a \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>aqgrp A H\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>aqgrp A H\\<^esub>\n                      \\<in> carrier (aqgrp A H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (aqgrp A H) \\<longrightarrow>\n                          \\<zero>\\<^bsub>aqgrp A H\\<^esub> \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                          a =\n                          a)", "apply (simp add:aqgrp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H\n                      \\<in> set_rcs (b_ag A) H \\<rightarrow>\n                            set_rcs (b_ag A) H \\<rightarrow>\n                            set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> set_rcs (b_ag A)\n     H \\<longrightarrow>\n                                  c_top (b_ag A) H (c_top (b_ag A) H a b)\n                                   c =\n                                  c_top (b_ag A) H a\n                                   (c_top (b_ag A) H b c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              c_top (b_ag A) H a b =\n                              c_top (b_ag A) H b a)) \\<and>\n                      c_iop (b_ag A) H\n                      \\<in> set_rcs (b_ag A) H \\<rightarrow>\n                            set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      H \\<in> set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (simp add:Group.Qg_top [of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> set_rcs (b_ag A)\n     H \\<longrightarrow>\n                                  c_top (b_ag A) H (c_top (b_ag A) H a b)\n                                   c =\n                                  c_top (b_ag A) H a\n                                   (c_top (b_ag A) H b c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              c_top (b_ag A) H a b =\n                              c_top (b_ag A) H b a)) \\<and>\n                      c_iop (b_ag A) H\n                      \\<in> set_rcs (b_ag A) H \\<rightarrow>\n                            set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      H \\<in> set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (simp add:Group.Qg_iop [of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> set_rcs (b_ag A)\n     H \\<longrightarrow>\n                                  c_top (b_ag A) H (c_top (b_ag A) H a b)\n                                   c =\n                                  c_top (b_ag A) H a\n                                   (c_top (b_ag A) H b c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              c_top (b_ag A) H a b =\n                              c_top (b_ag A) H b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      H \\<in> set_rcs (b_ag A) H \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (frule Group.nsg_sg[of \"b_ag A\" \"H\"], assumption+,\n        simp add:Group.unit_rcs_in_set_rcs[of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A);\n     b_ag A \\<guillemotright> H \\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> set_rcs (b_ag A)\n     H \\<longrightarrow>\n                                  c_top (b_ag A) H (c_top (b_ag A) H a b)\n                                   c =\n                                  c_top (b_ag A) H a\n                                   (c_top (b_ag A) H b c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              c_top (b_ag A) H a b =\n                              c_top (b_ag A) H b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (simp add:Group.Qg_tassoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A);\n     b_ag A \\<guillemotright> H \\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                              c_top (b_ag A) H a b =\n                              c_top (b_ag A) H b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (simp add:asubg_costOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A);\n     b_ag A \\<guillemotright> H \\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H (c_iop (b_ag A) H a) a =\n                          H) \\<and>\n                      (\\<forall>a.\n                          a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                          c_top (b_ag A) H H a = a)", "apply (simp add:Group.Qg_i[of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; b_ag A \\<triangleright> H; Group (b_ag A);\n     b_ag A \\<guillemotright> H \\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> set_rcs (b_ag A) H \\<longrightarrow>\n                         c_top (b_ag A) H H a = a", "apply (simp add:Group.Qg_unit[of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) plus_subgs:\"\\<lbrakk>A +> H1; A +> H2\\<rbrakk> \\<Longrightarrow> A +> H1 \\<minusplus> H2\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H1; A +> H2\\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<minusplus> H2", "apply (simp add:aset_sum_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H1; A +> H2\\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2", "apply (frule asubg_nsubg[of \"H2\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H1; A +> H2; b_ag A \\<triangleright> H2\\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2", "apply (simp add:asubGroup_def[of _ \"H1\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H1 ; A +> H2;\n     b_ag A \\<triangleright> H2\\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2", "apply (cut_tac \"b_ag_group\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H1 ; A +> H2;\n     b_ag A \\<triangleright> H2; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2", "apply (frule Group.smult_sg_nsg[of \"b_ag A\" \"H1\" \"H2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H1 ; A +> H2;\n     b_ag A \\<triangleright> H2; Group (b_ag A);\n     b_ag\n      A \\<guillemotright> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2 \\<rbrakk>\n    \\<Longrightarrow> A +> H1 \\<diamondop>\\<^bsub>b_ag A\\<^esub> H2", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) set_sum:\"\\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A\\<rbrakk> \\<Longrightarrow>\n                    H \\<minusplus> K = {x. \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K =\n                      {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K =\n                      {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<minusplus> K\n                      \\<subseteq> {x. \\<exists>h\\<in>H.\n   \\<exists>k\\<in>K. x = h \\<plusminus> k}\n 2. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}\n                      \\<subseteq> H \\<minusplus> K", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n        Group (b_ag A); x \\<in> H \\<minusplus> K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x. \\<exists>h\\<in>H.\n  \\<exists>k\\<in>K. x = h \\<plusminus> k}\n 2. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}\n                      \\<subseteq> H \\<minusplus> K", "apply (simp add:aset_sum_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n        Group (b_ag A);\n        x \\<in> H \\<diamondop>\\<^bsub>b_ag A\\<^esub> K\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>H.\n                            \\<exists>k\\<in>K. x = h \\<plusminus> k\n 2. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}\n                      \\<subseteq> H \\<minusplus> K", "apply (simp add:agop_gop[THEN sym] s_top_def, (erule bexE)+,\n        frule sym, thin_tac \"xa \\<cdot>\\<^bsub>b_ag A\\<^esub> y = x\", simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>h\\<in>H.\n                             \\<exists>k\\<in>K. x = h \\<plusminus> k}\n                      \\<subseteq> H \\<minusplus> K", "apply (rule subsetI, simp add:aset_sum_def, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n        Group (b_ag A); h \\<in> H; k \\<in> K; x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<diamondop>\\<^bsub>b_ag A\\<^esub> K", "apply (frule_tac c = h in subsetD[of H \"carrier A\"], assumption+,\n        frule_tac c = k in subsetD[of K \"carrier A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n        Group (b_ag A); h \\<in> H; k \\<in> K; x = h \\<plusminus> k;\n        h \\<in> carrier A; k \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> H \\<diamondop>\\<^bsub>b_ag A\\<^esub> K", "apply (simp add:agop_gop[THEN sym], simp add:s_top_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) mem_set_sum:\"\\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n                  x \\<in> H \\<minusplus> K \\<rbrakk> \\<Longrightarrow> \\<exists>h\\<in>H. \\<exists>k\\<in>K. x = h \\<plusminus> k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>H \\<subseteq> carrier A; K \\<subseteq> carrier A;\n     x \\<in> H \\<minusplus> K\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>H.\n                         \\<exists>k\\<in>K. x = h \\<plusminus> k", "by (simp add:set_sum)"], ["", "lemma (in aGroup) mem_sum_subgs:\"\\<lbrakk>A +> H; A +> K; h \\<in> H; k \\<in> K\\<rbrakk> \\<Longrightarrow>\n                    h \\<plusminus> k \\<in> H \\<minusplus> K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; A +> K; h \\<in> H; k \\<in> K\\<rbrakk>\n    \\<Longrightarrow> h \\<plusminus> k \\<in> H \\<minusplus> K", "apply (frule asubg_subset[of H],\n       frule asubg_subset[of K],\n       simp add:set_sum, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) aqgrp_carrier:\"A +> H \\<Longrightarrow>\n                   set_rcs (b_ag A ) H = set_ar_cos A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> set_rcs (b_ag A) H = set_ar_cos A H", "apply (simp add:set_ar_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow>\n    set_rcs (b_ag A) H =\n    {X. \\<exists>a\\<in>carrier A. X = a \\<uplus>\\<^bsub>A\\<^esub> H}", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow>\n    set_rcs (b_ag A) H =\n    {X. \\<exists>a\\<in>carrier (b_ag A). X = a \\<uplus>\\<^bsub>A\\<^esub> H}", "apply (simp add:ar_coset_def set_rcs_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) unit_in_set_ar_cos:\"A +> H \\<Longrightarrow> H \\<in> set_ar_cos A H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> H \\<in> set_ar_cos A H", "apply (simp add:aqgrp_carrier[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> H \\<in> set_rcs (b_ag A) H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<in> set_rcs (b_ag A) H", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<in> set_rcs (b_ag A) H", "apply (simp add:Group.unit_rcs_in_set_rcs[of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) aqgrp_pOp_maps:\"\\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n      pop (aqgrp A H) (a \\<uplus>\\<^bsub>A\\<^esub> H) (b \\<uplus>\\<^bsub>A\\<^esub> H) = (a \\<plusminus> b) \\<uplus>\\<^bsub>A\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> H \\<plusminus>\\<^bsub>aqgrp A H\\<^esub>\n                      b \\<uplus>\\<^bsub>A\\<^esub> H =\n                      (a \\<plusminus> b) \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:aqgrp_def ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> b) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (a \\<plusminus> b)", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> b) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (a \\<plusminus> b)", "apply (frule asubg_nsubg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; b \\<in> carrier A; Group (b_ag A);\n     b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> b) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (a \\<plusminus> b)", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); b \\<in> carrier (b_ag A);\n     Group (b_ag A); b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag A) H (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a)\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> b) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (a \\<plusminus> b)", "apply (subst Group.c_top_welldef [THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); b \\<in> carrier (b_ag A);\n     Group (b_ag A); b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                      (a \\<cdot>\\<^bsub>b_ag A\\<^esub> b) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (a \\<plusminus> b)", "apply (simp add:agop_gop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) aqgrp_mOp_maps:\"\\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                   mop (aqgrp A H) (a \\<uplus>\\<^bsub>A\\<^esub> H) = (-\\<^sub>a a) \\<uplus>\\<^bsub>A\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a\\<^bsub>aqgrp A H\\<^esub> a \\<uplus>\\<^bsub>A\\<^esub> H =\n                      (-\\<^sub>a a) \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:aqgrp_def ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag A) H\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (-\\<^sub>a a)", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag A) H\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (-\\<^sub>a a)", "apply (frule asubg_nsubg)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; Group (b_ag A);\n     b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag A) H\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (-\\<^sub>a a)", "apply (simp add:ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); Group (b_ag A);\n     b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> c_iop (b_ag A) H\n                       (H \\<bullet>\\<^bsub>b_ag A\\<^esub> a) =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (-\\<^sub>a a)", "apply (subst Group.c_iop_welldef, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); Group (b_ag A);\n     b_ag A \\<triangleright> H\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                      \\<rho>\\<^bsub>b_ag A\\<^esub> a =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub> (-\\<^sub>a a)", "apply (simp add:agiop_giop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) aqgrp_zero:\"A +> H \\<Longrightarrow> zero (aqgrp A H) = H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. A +> H \\<Longrightarrow> \\<zero>\\<^bsub>aqgrp A H\\<^esub> = H", "apply (simp add:aqgrp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) arcos_fixed:\"\\<lbrakk>A +> H; a \\<in> carrier A; h \\<in> H \\<rbrakk> \\<Longrightarrow>\n                              a \\<uplus>\\<^bsub>A\\<^esub> H = (h \\<plusminus> a) \\<uplus>\\<^bsub>A\\<^esub> H\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; h \\<in> H\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> H =\n                      (h \\<plusminus> a) \\<uplus>\\<^bsub>A\\<^esub> H", "apply (cut_tac b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; h \\<in> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> H =\n                      (h \\<plusminus> a) \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:agop_gop[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier A; h \\<in> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> H =\n                      h \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                      a \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:ag_carrier_carrier[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); h \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> H =\n                      h \\<cdot>\\<^bsub>b_ag A\\<^esub>\n                      a \\<uplus>\\<^bsub>A\\<^esub> H", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>A +> H; a \\<in> carrier (b_ag A); h \\<in> H;\n     Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub> a =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                      (h \\<cdot>\\<^bsub>b_ag A\\<^esub> a)", "apply (simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag A \\<guillemotright> H ; a \\<in> carrier (b_ag A);\n     h \\<in> H; Group (b_ag A)\\<rbrakk>\n    \\<Longrightarrow> H \\<bullet>\\<^bsub>b_ag A\\<^esub> a =\n                      H \\<bullet>\\<^bsub>b_ag A\\<^esub>\n                      (h \\<cdot>\\<^bsub>b_ag A\\<^esub> a)", "apply (simp add:Group.rcs_fixed1[of \"b_ag A\" \"H\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  rind_hom :: \"[('a, 'more) aGroup_scheme, ('b, 'more1) aGroup_scheme,\n                ('a  \\<Rightarrow> 'b)] \\<Rightarrow> ('a set  \\<Rightarrow> 'b )\" where\n  \"rind_hom A B f = (\\<lambda>X\\<in>(set_ar_cos A (ker\\<^bsub>A,B\\<^esub> f)). f (SOME x. x \\<in> X))\""], ["", "abbreviation\n  RIND_HOM  (\"(3_\\<degree>\\<^bsub>_,_\\<^esub>)\" [82,82,83]82)  where\n  \"f\\<degree>\\<^bsub>F,G\\<^esub> == rind_hom F G f\""], ["", "(* tOp \\<rightarrow> pOp *)"], ["", "section \"Direct product and direct sum of abelian groups, in general case\""], ["", "definition\n  Un_carrier :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> 'a set\" where\n  \"Un_carrier I A = \\<Union>{X. \\<exists>i\\<in>I. X = carrier (A i)}\""], ["", "definition\n  carr_prodag :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> ('i  \\<Rightarrow> 'a ) set\" where\n  \"carr_prodag I A = {f. f \\<in> extensional I \\<and> f \\<in> I \\<rightarrow> (Un_carrier I A) \\<and>\n                                               (\\<forall>i\\<in>I. f i \\<in> carrier (A i))}\""], ["", "definition\n  prod_pOp :: \"['i set,  'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow>\n                                 ('i \\<Rightarrow> 'a) \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow>  ('i \\<Rightarrow> 'a)\" where\n  \"prod_pOp I A = (\\<lambda>f\\<in>carr_prodag I A. \\<lambda>g\\<in>carr_prodag I A.\n                                        \\<lambda>x\\<in>I. (f x) \\<plusminus>\\<^bsub>(A x)\\<^esub> (g x))\""], ["", "definition\n  prod_mOp :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow>\n                                  ('i \\<Rightarrow> 'a) \\<Rightarrow> ('i \\<Rightarrow> 'a)\" where\n  \"prod_mOp I A = (\\<lambda>f\\<in>carr_prodag I A. \\<lambda>x\\<in>I. (-\\<^sub>a\\<^bsub>(A x)\\<^esub> (f x)))\""], ["", "definition\n  prod_zero :: \"['i set,  'i  \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> ('i \\<Rightarrow> 'a)\" where\n  \"prod_zero I A = (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>(A x)\\<^esub>)\""], ["", "definition\n  prodag :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> ('i \\<Rightarrow> 'a) aGroup\" where\n  \"prodag I A = \\<lparr> carrier = carr_prodag I A,\n    pop = prod_pOp I A, mop = prod_mOp I A,\n    zero = prod_zero I A\\<rparr>\""], ["", "definition\n  PRoject :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme, 'i]\n                   \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow> 'a\" (\"(3\\<pi>\\<^bsub>_,_,_\\<^esub>)\" [82,82,83]82) where\n  \"PRoject I A x = (\\<lambda>f \\<in> carr_prodag I A. f x)\""], ["", "abbreviation\n  PRODag  (\"(a\\<Pi>\\<^bsub>_\\<^esub> _)\" [72,73]72) where\n  \"a\\<Pi>\\<^bsub>I\\<^esub> A == prodag I A\""], ["", "lemma prodag_comp_i:\"\\<lbrakk>a \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow> (a i) \\<in> carrier (A i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a i \\<in> carrier (A i)", "by (simp add:carr_prodag_def)"], ["", "lemma prod_pOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<rightarrow> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A\n    \\<in> carr_prodag I A \\<rightarrow>\n          carr_prodag I A \\<rightarrow> carr_prodag I A", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A", "apply(rename_tac a b)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b \\<in> carr_prodag I A", "apply (subst carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b\n                         \\<in> {f \\<in> extensional I.\n                                f \\<in> I \\<rightarrow>\n  Un_carrier I A \\<and>\n                                (\\<forall>i\\<in>I. f i \\<in> carrier (A i))}", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b \\<in> extensional I \\<and>\n                         prod_pOp I A a b\n                         \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                         (\\<forall>i\\<in>I.\n                             prod_pOp I A a b i \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b \\<in> extensional I\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b\n                         \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                         (\\<forall>i\\<in>I.\n                             prod_pOp I A a b i \\<in> carrier (A i))", "apply (simp add:prod_pOp_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b\n                         \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                         (\\<forall>i\\<in>I.\n                             prod_pOp I A a b i \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b\n                         \\<in> I \\<rightarrow> Un_carrier I A\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b x \\<in> Un_carrier I A\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a x \\<plusminus>\\<^bsub>A x\\<^esub> b x\n                         \\<in> Un_carrier I A\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (subst Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a x \\<plusminus>\\<^bsub>A x\\<^esub> b x\n                         \\<in> \\<Union>\n                                {X. \\<exists>i\\<in>I. X = carrier (A i)}\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A; x \\<in> I;\n        aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>a \\<in> extensional I \\<and>\n                a \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                (\\<forall>i\\<in>I. a i \\<in> carrier (A i));\n        b \\<in> extensional I \\<and>\n        b \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n        (\\<forall>i\\<in>I. b i \\<in> carrier (A i));\n        x \\<in> I; aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>x \\<in> I; aGroup (A x); a \\<in> extensional I;\n        b \\<in> extensional I; a \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. a i \\<in> carrier (A i);\n        b \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. b i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (thin_tac \"a \\<in> I \\<rightarrow> Un_carrier I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>x \\<in> I; aGroup (A x); a \\<in> extensional I;\n        b \\<in> extensional I; \\<forall>i\\<in>I. a i \\<in> carrier (A i);\n        b \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. b i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (thin_tac \"b \\<in> I \\<rightarrow> Un_carrier I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>x \\<in> I; aGroup (A x); a \\<in> extensional I;\n        b \\<in> extensional I; \\<forall>i\\<in>I. a i \\<in> carrier (A i);\n        \\<forall>i\\<in>I. b i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. a i \\<in> carrier (A i)\",\n        frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. b i \\<in> carrier (A i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>x \\<in> I; aGroup (A x); a \\<in> extensional I;\n        b \\<in> extensional I; a x \\<in> carrier (A x);\n        b x \\<in> carrier (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (frule_tac x = \"a x\" and y = \"b x\" in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x.\n       \\<lbrakk>x \\<in> I; aGroup (A x); a \\<in> extensional I;\n        b \\<in> extensional I; a x \\<in> carrier (A x);\n        b x \\<in> carrier (A x);\n        a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> carrier (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            a x \\<plusminus>\\<^bsub>A x\\<^esub> b x \\<in> xa\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            prod_pOp I A a b i \\<in> carrier (A i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b i \\<in> carrier (A i)", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a i \\<plusminus>\\<^bsub>A i\\<^esub> b i\n                         \\<in> carrier (A i)", "apply (rule_tac A = \"A i\" and x = \"a i\" and y = \"b i\" in aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A i)\n 2. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a i \\<in> carrier (A i)\n 3. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> b i \\<in> carrier (A i)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a i \\<in> carrier (A i)\n 2. \\<And>a b i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> b i \\<in> carrier (A i)", "apply (simp add:carr_prodag_def)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_pOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_prodag I A", "apply (frule prod_pOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A;\n     prod_pOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_prodag I A", "apply (frule funcset_mem[of \"prod_pOp I A\"\n                        \"carr_prodag I A\" \"carr_prodag I A \\<rightarrow> carr_prodag I A\"\n                         \"X\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A;\n     prod_pOp I A\n     \\<in> carr_prodag I A \\<rightarrow>\n           carr_prodag I A \\<rightarrow> carr_prodag I A;\n     prod_pOp I A X\n     \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_prodag I A", "apply (rule funcset_mem[of \"prod_pOp I A X\" \"carr_prodag I A\"\n                           \"carr_prodag I A\" \"Y\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_pOp_mem_i:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n Y \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y i = (X i) \\<plusminus>\\<^bsub>(A i)\\<^esub> (Y i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A; i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y i =\n                      X i \\<plusminus>\\<^bsub>A i\\<^esub> Y i", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_mOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  prod_mOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_mOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A x \\<in> carr_prodag I A", "apply (simp add:prod_mOp_def carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> extensional I \\<and>\n        x \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n        (\\<forall>i\\<in>I. x i \\<in> carrier (A i))\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>xa\\<in>I.\n                             -\\<^sub>a\\<^bsub>A xa\\<^esub> x xa)\n                         \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                         (\\<forall>i\\<in>I.\n                             -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                             \\<in> carrier (A i))", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>xa\\<in>I.\n                             -\\<^sub>a\\<^bsub>A xa\\<^esub> x xa)\n                         \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                         (\\<forall>i\\<in>I.\n                             -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                             \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>xa\\<in>I.\n                             -\\<^sub>a\\<^bsub>A xa\\<^esub> x xa)\n                         \\<in> I \\<rightarrow> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i); xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>xa\\<in>I.\n                             -\\<^sub>a\\<^bsub>A xa\\<^esub> x xa)\n                          xa\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i); xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A xa\\<^esub> x xa\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (rename_tac f j)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> extensional I;\n        f \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. f i \\<in> carrier (A i); j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> f j\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (frule_tac f = f and x = j in funcset_mem [of _ \"I\" \"Un_carrier I A\"],\n                             assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> extensional I;\n        f \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. f i \\<in> carrier (A i); j \\<in> I;\n        f j \\<in> Un_carrier I A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> f j\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (thin_tac \"f \\<in> I \\<rightarrow> Un_carrier I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> extensional I;\n        \\<forall>i\\<in>I. f i \\<in> carrier (A i); j \\<in> I;\n        f j \\<in> Un_carrier I A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> f j\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (frule_tac x = j in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        frule_tac x = j in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. f i \\<in> carrier (A i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>f \\<in> extensional I; j \\<in> I; f j \\<in> Un_carrier I A;\n        aGroup (A j); f j \\<in> carrier (A j)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> f j\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (thin_tac \"f j \\<in> Un_carrier I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>f \\<in> extensional I; j \\<in> I; aGroup (A j);\n        f j \\<in> carrier (A j)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> f j\n                         \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>f \\<in> extensional I; j \\<in> I; aGroup (A j);\n        f j \\<in> carrier (A j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i\\<in>I. x = carrier (A i)) \\<and>\n                            -\\<^sub>a\\<^bsub>A j\\<^esub> f j \\<in> x\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (frule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f j.\n       \\<lbrakk>f \\<in> extensional I; j \\<in> I; aGroup (A j);\n        f j \\<in> carrier (A j);\n        -\\<^sub>a\\<^bsub>A j\\<^esub> f j \\<in> carrier (A j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            (\\<exists>i\\<in>I. x = carrier (A i)) \\<and>\n                            -\\<^sub>a\\<^bsub>A j\\<^esub> f j \\<in> x\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i\\<in>I.\n                            -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                            \\<in> carrier (A i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i); i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A i\\<^esub> x i\n                         \\<in> carrier (A i)", "apply (rule_tac A = \"A i\" and x = \"x i\" in aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i); i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A i)\n 2. \\<And>x i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> extensional I;\n        x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (A i); i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x i \\<in> carrier (A i)", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_mOp_mem:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X \\<in> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     X \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A X \\<in> carr_prodag I A", "apply (frule prod_mOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A;\n     prod_mOp I A\n     \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A X \\<in> carr_prodag I A", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_mOp_mem_i:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A; i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X i = -\\<^sub>a\\<^bsub>(A i)\\<^esub> (X i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_prodag I A;\n     i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A X i = -\\<^sub>a\\<^bsub>A i\\<^esub> X i", "apply (simp add:prod_mOp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_zero_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                           prod_zero I A \\<in> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_zero I A \\<in> carr_prodag I A", "apply (simp add:prod_zero_def prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>) \\<in> carr_prodag I A", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>)\n    \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n    (\\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>)\n    \\<in> I \\<rightarrow> Un_carrier I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>) x\n                         \\<in> Un_carrier I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A x\\<^esub> \\<in> Un_carrier I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (subgoal_tac \"aGroup (A x)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I;\n        aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A x\\<^esub> \\<in> Un_carrier I A\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A x)\n 3. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "prefer 2"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A x)\n 2. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I;\n        aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A x\\<^esub> \\<in> Un_carrier I A\n 3. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> I;\n        aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A x\\<^esub> \\<in> Un_carrier I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> I; aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A x\\<^esub> \\<in> Un_carrier I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> I; aGroup (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            \\<zero>\\<^bsub>A x\\<^esub> \\<in> xa\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (frule aGroup.ex_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>x \\<in> I; aGroup (A x);\n        \\<zero>\\<^bsub>A x\\<^esub> \\<in> carrier (A x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa.\n                            (\\<exists>i\\<in>I. xa = carrier (A i)) \\<and>\n                            \\<zero>\\<^bsub>A x\\<^esub> \\<in> xa\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>i\\<in>I. \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply auto"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (frule_tac x = i in bspec, assumption,\n       thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>i \\<in> I; aGroup (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A i\\<^esub> \\<in> carrier (A i)", "apply (simp add:aGroup.ex_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_zero_i:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); i \\<in> I\\<rbrakk> \\<Longrightarrow>\n                           prod_zero I A i = \\<zero>\\<^bsub>(A i)\\<^esub> \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> prod_zero I A i = \\<zero>\\<^bsub>A i\\<^esub>", "by (simp add:prod_zero_def)"], ["", "lemma carr_prodag_mem_eq:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\nY \\<in> carr_prodag I A; \\<forall>l\\<in>I. (X l) = (Y l) \\<rbrakk> \\<Longrightarrow> X = Y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_prodag I A;\n     Y \\<in> carr_prodag I A; \\<forall>l\\<in>I. X l = Y l\\<rbrakk>\n    \\<Longrightarrow> X = Y", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     X \\<in> extensional I \\<and>\n     X \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n     (\\<forall>i\\<in>I. Y i \\<in> carrier (A i));\n     Y \\<in> extensional I \\<and> Y \\<in> I \\<rightarrow> Un_carrier I A;\n     \\<forall>l\\<in>I. X l = Y l\\<rbrakk>\n    \\<Longrightarrow> X = Y", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>l\\<in>I. X l = Y l;\n     X \\<in> extensional I; Y \\<in> extensional I;\n     Y \\<in> I \\<rightarrow> Un_carrier I A;\n     X \\<in> I \\<rightarrow> Un_carrier I A;\n     \\<forall>i\\<in>I. Y i \\<in> carrier (A i)\\<rbrakk>\n    \\<Longrightarrow> X = Y", "apply (simp add:funcset_eq)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_pOp_assoc:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n      b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n      prod_pOp I A (prod_pOp I A a b) c =\n                               prod_pOp I A a (prod_pOp I A b c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n     b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                      prod_pOp I A a (prod_pOp I A b c)", "apply (frule_tac X = a and Y = b in prod_pOp_mem[of \"I\" \"A\"], assumption+,\n        frule_tac X = b and Y = c in prod_pOp_mem[of \"I\" \"A\"], assumption+,\n        frule_tac X = \"prod_pOp I A a b\" and Y = c in prod_pOp_mem[of \"I\"\n            \"A\"], assumption+,\n        frule_tac X = a and Y = \"prod_pOp I A b c\" in prod_pOp_mem[of \"I\"\n            \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n     b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n     prod_pOp I A a b \\<in> carr_prodag I A;\n     prod_pOp I A b c \\<in> carr_prodag I A;\n     prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n     prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                      prod_pOp I A a (prod_pOp I A b c)", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"], assumption+,\n       rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c l =\n                         prod_pOp I A a (prod_pOp I A b c) l", "apply (simp add:prod_pOp_mem_i)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A;\n        prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        c \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)", "apply (rule aGroup.ag_pOp_assoc, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        c \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> a l \\<in> carrier (A l)\n 2. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        c \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> b l \\<in> carrier (A l)\n 3. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        c \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b c \\<in> carr_prodag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_prodag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> c l \\<in> carrier (A l)", "apply (simp add:prodag_comp_i)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prod_pOp_commute:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n                           b \\<in> carr_prodag I A\\<rbrakk> \\<Longrightarrow>\n                           prod_pOp I A a b = prod_pOp I A b a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n     b \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A a b = prod_pOp I A b a", "apply (frule_tac X = a and Y = b in prod_pOp_mem[of \"I\" \"A\"], assumption+,\n         frule_tac X = b and Y = a in prod_pOp_mem[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n     b \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n     prod_pOp I A b a \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A a b = prod_pOp I A b a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"], assumption+,\n        rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b a \\<in> carr_prodag I A; l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b l = prod_pOp I A b a l", "apply (simp add:prod_pOp_mem_i)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b a \\<in> carr_prodag I A; l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub> b l =\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub> a l", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        rule aGroup.ag_pOp_commute, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b a \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> a l \\<in> carrier (A l)\n 2. \\<And>l.\n       \\<lbrakk>a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        prod_pOp I A a b \\<in> carr_prodag I A;\n        prod_pOp I A b a \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> b l \\<in> carrier (A l)", "apply (simp add:prodag_comp_i)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_aGroup:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> aGroup (prodag I A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)", "apply (simp add:aGroup_def [of \"(prodag I A)\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier\n                         (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n                a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                b \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                c =\n                a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                (b \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                 c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> b =\n            b \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n            a)) \\<and>\n    mop (a\\<Pi>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        a =\n        \\<zero>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        \\<zero>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        a =\n        a)", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A\n    \\<in> carr_prodag I A \\<rightarrow>\n          carr_prodag I A \\<rightarrow> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    prod_mOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:prod_pOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    prod_mOp I A \\<in> carr_prodag I A \\<rightarrow> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:prod_mOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_prodag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:prod_zero_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_prodag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       (\\<forall>b.\n           b \\<in> carr_prodag I A \\<longrightarrow>\n           (\\<forall>c.\n               c \\<in> carr_prodag I A \\<longrightarrow>\n               prod_pOp I A (prod_pOp I A a b) c =\n               prod_pOp I A a (prod_pOp I A b c)))\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A; c \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:prod_pOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_prodag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       (\\<forall>b.\n           b \\<in> carr_prodag I A \\<longrightarrow>\n           prod_pOp I A a b = prod_pOp I A b a)\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b = prod_pOp I A b a\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:prod_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_prodag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac X = a in prod_mOp_mem [of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac X = \"prod_mOp I A a\" and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_zero I A \\<in> carr_prodag I A\n 2. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_mOp I A a) a l =\n                            prod_zero I A l\n 3. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (simp add:prod_zero_func)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_mOp I A a) a l =\n                            prod_zero I A l\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a l = prod_zero I A l\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (simp add:prod_pOp_mem_i,\n         simp add:prod_zero_i)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         \\<zero>\\<^bsub>A l\\<^esub>\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (\n         simp add:prod_mOp_mem_i)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A l\\<^esub> a\n                 l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         \\<zero>\\<^bsub>A l\\<^esub>\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac x = l in bspec, assumption,\n         thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n         rule aGroup.l_m, assumption+, simp add:prodag_comp_i)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>a.\n       a \\<in> carr_prodag I A \\<longrightarrow>\n       prod_pOp I A (prod_zero I A) a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac prod_zero_func[of \"I\" \"A\"],\n         frule_tac Y = a in prod_pOp_mem[of \"I\" \"A\" \"prod_zero I A\"],\n          assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a = a", "apply (rule carr_prodag_mem_eq[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_zero I A) a l = a l", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a l = a l", "apply (subst prod_pOp_mem_i[of \"I\" \"A\"], assumption+,\n         subst prod_zero_i[of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_prodag I A;\n        prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A l\\<^esub> \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l", "apply (frule_tac x = l in bspec, assumption,\n         rule aGroup.l_zero, assumption+,\n         simp add:prodag_comp_i)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_carrier:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n            carrier (prodag I A) = carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A", "by (simp add:prodag_def)"], ["", "lemma prodag_elemfun:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> carrier (prodag I A)\\<rbrakk> \\<Longrightarrow>\n         f \\<in> extensional I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:prodag_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     f \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_component:\"\\<lbrakk>f \\<in> carrier (prodag I A); i \\<in> I \\<rbrakk> \\<Longrightarrow>\n                              f i \\<in> carrier (A i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); i \\<in> I\\<rbrakk>\n    \\<Longrightarrow> f i \\<in> carrier (A i)", "by (simp add:prodag_def carr_prodag_def)"], ["", "lemma prodag_pOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  pop (prodag I A) = prod_pOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>) = prod_pOp I A", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_iOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  mop (prodag I A) = prod_mOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    mop (a\\<Pi>\\<^bsub>I\\<^esub> A) = prod_mOp I A", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_zero:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  zero (prodag I A) = prod_zero I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub> = prod_zero I A", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_sameTr0:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> Un_carrier I A = Un_carrier I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> Un_carrier I A = Un_carrier I B", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_sameTr1:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> carr_prodag I A = carr_prodag I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A = carr_prodag I B", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I A \\<subseteq> carr_prodag I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I B \\<subseteq> carr_prodag I A", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I B \\<subseteq> carr_prodag I A", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I \\<rightarrow> Un_carrier I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I B \\<subseteq> carr_prodag I A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. x i \\<in> carrier (B i); xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x xa \\<in> Un_carrier I B\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I B \\<subseteq> carr_prodag I A", "apply (subst Un_carrier_def, simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> carr_prodag I B \\<subseteq> carr_prodag I A", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carr_prodag I A", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I B;\n        \\<forall>i\\<in>I. x i \\<in> carrier (B i)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I \\<rightarrow> Un_carrier I A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I B;\n        \\<forall>i\\<in>I. x i \\<in> carrier (B i); xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x xa \\<in> Un_carrier I A", "apply (subst Un_carrier_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        x \\<in> extensional I; x \\<in> I \\<rightarrow> Un_carrier I B;\n        \\<forall>i\\<in>I. x i \\<in> carrier (B i); xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            x xa \\<in> xb", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_sameTr2:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_pOp I A = prod_pOp I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A = prod_pOp I B", "apply (frule prodag_sameTr1 [of \"I\" \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A = prod_pOp I B", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>g\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                f x \\<plusminus>\\<^bsub>A x\\<^esub> g x) =\n                      (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>g\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                f x \\<plusminus>\\<^bsub>B x\\<^esub> g x)", "apply (rule bivar_func_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carr_prodag I B.\n                         \\<forall>b\\<in>carr_prodag I B.\n                            (\\<lambda>x\\<in>I.\n                                a x \\<plusminus>\\<^bsub>A x\\<^esub> b x) =\n                            (\\<lambda>x\\<in>I.\n                                a x \\<plusminus>\\<^bsub>B x\\<^esub> b x)", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; a \\<in> carr_prodag I B;\n        b \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             a x \\<plusminus>\\<^bsub>A x\\<^esub> b x) =\n                         (\\<lambda>x\\<in>I.\n                             a x \\<plusminus>\\<^bsub>B x\\<^esub> b x)", "apply (rule funcset_eq [of _ \"I\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; a \\<in> carr_prodag I B;\n        b \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             a x \\<plusminus>\\<^bsub>A x\\<^esub> b x)\n                         \\<in> extensional I\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; a \\<in> carr_prodag I B;\n        b \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             a x \\<plusminus>\\<^bsub>B x\\<^esub> b x)\n                         \\<in> extensional I\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; a \\<in> carr_prodag I B;\n        b \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>I.\n                            (\\<lambda>x\\<in>I.\n                                a x \\<plusminus>\\<^bsub>A x\\<^esub> b x)\n                             x =\n                            (\\<lambda>x\\<in>I.\n                                a x \\<plusminus>\\<^bsub>B x\\<^esub> b x)\n                             x", "apply (simp add:restrict_def extensional_def)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_sameTr3:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_mOp I A = prod_mOp I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A = prod_mOp I B", "apply (frule prodag_sameTr1 [of \"I\" \"A\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A = prod_mOp I B", "apply (simp add:prod_mOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>A x\\<^esub> f x) =\n                      (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>B x\\<^esub> f x)", "apply (rule funcset_eq [of _ \"carr_prodag I B\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                      \\<in> extensional (carr_prodag I B)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                      \\<in> extensional (carr_prodag I B)\n 3. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                          x =\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                          x", "apply (simp add:restrict_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                          \\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                      \\<in> extensional (carr_prodag I B)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                          x =\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                          x", "apply (simp add:restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carr_prodag I B.\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                          x =\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                          x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; x \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                          x =\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                          x", "apply (rename_tac g)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; g \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> f x)\n                          g =\n                         (\\<lambda>f\\<in>carr_prodag I B.\n                             \\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> f x)\n                          g", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>g.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; g \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>A x\\<^esub> g x) =\n                         (\\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>B x\\<^esub> g x)", "apply (rule funcset_eq [of _ \"I\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>g.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; g \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>A x\\<^esub> g x)\n                         \\<in> extensional I\n 2. \\<And>g.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; g \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>I.\n                             -\\<^sub>a\\<^bsub>B x\\<^esub> g x)\n                         \\<in> extensional I\n 3. \\<And>g.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. A k = B k;\n        carr_prodag I A = carr_prodag I B; g \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>I.\n                            (\\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>A x\\<^esub> g x)\n                             x =\n                            (\\<lambda>x\\<in>I.\n                                -\\<^sub>a\\<^bsub>B x\\<^esub> g x)\n                             x", "apply (simp add:restrict_def extensional_def)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_sameTr4:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prod_zero I A = prod_zero I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> prod_zero I A = prod_zero I B", "apply (simp add:prod_zero_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>) =\n                      (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>B x\\<^esub>)", "apply (rule funcset_eq [of _ \"I\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>)\n                      \\<in> extensional I\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>B x\\<^esub>)\n                      \\<in> extensional I\n 3. \\<lbrakk>\\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I.\n                         (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>A x\\<^esub>) x =\n                         (\\<lambda>x\\<in>I. \\<zero>\\<^bsub>B x\\<^esub>) x", "apply (simp add:restrict_def extensional_def)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma prodag_same:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n                               \\<Longrightarrow> prodag I A = prodag I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     \\<forall>k\\<in>I. A k = B k\\<rbrakk>\n    \\<Longrightarrow> a\\<Pi>\\<^bsub>I\\<^esub> A = a\\<Pi>\\<^bsub>I\\<^esub> B", "apply (frule prodag_sameTr1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B\\<rbrakk>\n    \\<Longrightarrow> a\\<Pi>\\<^bsub>I\\<^esub> A = a\\<Pi>\\<^bsub>I\\<^esub> B", "apply (frule prodag_sameTr2, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B; prod_pOp I A = prod_pOp I B\\<rbrakk>\n    \\<Longrightarrow> a\\<Pi>\\<^bsub>I\\<^esub> A = a\\<Pi>\\<^bsub>I\\<^esub> B", "apply (frule prodag_sameTr3, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B; prod_pOp I A = prod_pOp I B;\n     prod_mOp I A = prod_mOp I B\\<rbrakk>\n    \\<Longrightarrow> a\\<Pi>\\<^bsub>I\\<^esub> A = a\\<Pi>\\<^bsub>I\\<^esub> B", "apply (frule prodag_sameTr4, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); \\<forall>k\\<in>I. A k = B k;\n     carr_prodag I A = carr_prodag I B; prod_pOp I A = prod_pOp I B;\n     prod_mOp I A = prod_mOp I B; prod_zero I A = prod_zero I B\\<rbrakk>\n    \\<Longrightarrow> a\\<Pi>\\<^bsub>I\\<^esub> A = a\\<Pi>\\<^bsub>I\\<^esub> B", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma project_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I; x \\<in> carrier (prodag I A)\\<rbrakk> \\<Longrightarrow>\n                         (PRoject I A j) x  \\<in> carrier (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n     x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) x \\<in> carrier (A j)", "apply (simp add:PRoject_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n     x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> (x \\<in> carr_prodag I A \\<longrightarrow>\n                       x j \\<in> carrier (A j)) \\<and>\n                      (x \\<notin> carr_prodag I A \\<longrightarrow>\n                       undefined \\<in> carrier (A j))", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n     x \\<in> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> x j \\<in> carrier (A j)", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma project_aHom:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                         PRoject I A j \\<in> aHom (prodag I A) (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> carrier\n                             (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n                            carrier (A j) \\<and>\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> carrier\n                             (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n                            carrier (A j)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)", "apply (simp add:project_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) \\<and>\n                      (\\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                          \\<forall>b\\<in>carrier\n    (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                               b) =\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                              a \\<plusminus>\\<^bsub>A j\\<^esub>\n                             (\\<pi>\\<^bsub>I,A,j\\<^esub>) b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (simp add:PRoject_def restrict_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carr_prodag I A \\<longrightarrow>\n                         x \\<notin> carrier\n                                     (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n                         x j = undefined\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (rule allI, rule impI, simp add:prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         \\<forall>b\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              b) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             a \\<plusminus>\\<^bsub>A j\\<^esub>\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n        a \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        b \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                           b) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          a \\<plusminus>\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (simp add:prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n        a \\<in> carr_prodag I A; b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) (prod_pOp I A a b) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          a \\<plusminus>\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n        a \\<in> carr_prodag I A; b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>x\\<in>I.\n                              a x \\<plusminus>\\<^bsub>A x\\<^esub> b x) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          a \\<plusminus>\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (frule_tac X = a and Y = b in prod_pOp_mem[of I A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n        a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        prod_pOp I A a b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>x\\<in>I.\n                              a x \\<plusminus>\\<^bsub>A x\\<^esub> b x) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          a \\<plusminus>\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I;\n        a \\<in> carr_prodag I A; b \\<in> carr_prodag I A;\n        (\\<lambda>x\\<in>I. a x \\<plusminus>\\<^bsub>A x\\<^esub> b x)\n        \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>x\\<in>I.\n                              a x \\<plusminus>\\<^bsub>A x\\<^esub> b x) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          a \\<plusminus>\\<^bsub>A j\\<^esub>\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) b", "apply (simp add:PRoject_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma project_aHom1:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                      \\<forall>j \\<in> I. PRoject I A j \\<in> aHom (prodag I A) (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<forall>j\\<in>I.\n       \\<pi>\\<^bsub>I,A,j\\<^esub>\n       \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                         \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)", "apply (rule project_aHom, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  A_to_prodag :: \"[('a, 'm) aGroup_scheme, 'i set, 'i \\<Rightarrow>('a \\<Rightarrow> 'b),\n   'i  \\<Rightarrow> ('b, 'm1) aGroup_scheme] \\<Rightarrow> ('a \\<Rightarrow> ('i \\<Rightarrow>'b))\" where\n \"A_to_prodag A I S B = (\\<lambda>a\\<in>carrier A. \\<lambda>k\\<in>I. S k a)\""], ["", "(* I is an index set, A is an abelian group, S: I \\<rightarrow> carrier A \\<rightarrow>\n  carrier (prodag I B),   s i \\<in> carrier A \\<rightarrow> B i  *)"], ["", "lemma A_to_prodag_mem:\"\\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);  \\<forall>k\\<in>I. (S k) \\<in>\n aHom A (B k); x \\<in> carrier A \\<rbrakk> \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> carr_prodag I B", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> extensional I \\<and>\n                      A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x \\<in> extensional I\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (simp add:A_to_prodag_def extensional_def restrict_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B x\n                      \\<in> I \\<rightarrow> Un_carrier I B \\<and>\n                      (\\<forall>i\\<in>I.\n                          A_to_prodag A I S B x i \\<in> carrier (B i))", "apply (simp add:Pi_def restrict_def A_to_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>xa.\n                          xa \\<in> I \\<longrightarrow>\n                          S xa x \\<in> Un_carrier I B) \\<and>\n                      (\\<forall>i\\<in>I. S i x \\<in> carrier (B i))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>xa.\n                         xa \\<in> I \\<longrightarrow>\n                         S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> I \\<longrightarrow>\n                         S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S xa x \\<in> Un_carrier I B\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (simp add:Un_carrier_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (rotate_tac 2,\n        frule_tac x = xa in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. S k \\<in> aHom A (B k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<in> carrier A; xa \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k); S xa \\<in> aHom A (B xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<in> carrier A; xa \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k);\n        S xa \\<in> carrier A \\<rightarrow> carrier (B xa) \\<and>\n        S xa \\<in> extensional (carrier A) \\<and>\n        (\\<forall>a\\<in>carrier A.\n            \\<forall>b\\<in>carrier A.\n               S xa (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n               S xa a \\<plusminus>\\<^bsub>B xa\\<^esub> S xa b)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<in> carrier A; xa \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k);\n        S xa \\<in> carrier A \\<rightarrow> carrier (B xa);\n        S xa \\<in> extensional (carrier A);\n        \\<forall>a\\<in>carrier A.\n           \\<forall>b\\<in>carrier A.\n              S xa (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n              S xa a \\<plusminus>\\<^bsub>B xa\\<^esub> S xa b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (frule_tac f = \"S xa\" and A = \"carrier A\" and B = \"carrier (B xa)\"\n           and x = x in funcset_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>x \\<in> carrier A; xa \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k);\n        S xa \\<in> carrier A \\<rightarrow> carrier (B xa);\n        S xa \\<in> extensional (carrier A);\n        \\<forall>a\\<in>carrier A.\n           \\<forall>b\\<in>carrier A.\n              S xa (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n              S xa a \\<plusminus>\\<^bsub>B xa\\<^esub> S xa b;\n        S xa x \\<in> carrier (B xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (B i)) \\<and>\n                            S xa x \\<in> xb\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<in>I. S i x \\<in> carrier (B i)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); x \\<in> carrier A;\n        i \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S i x \\<in> carrier (B i)", "apply (rotate_tac 2,\n        frule_tac x = i in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. S k \\<in> aHom A (B k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier A; i \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k); S i \\<in> aHom A (B i)\\<rbrakk>\n       \\<Longrightarrow> S i x \\<in> carrier (B i)", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier A; i \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k);\n        S i \\<in> carrier A \\<rightarrow> carrier (B i) \\<and>\n        S i \\<in> extensional (carrier A) \\<and>\n        (\\<forall>a\\<in>carrier A.\n            \\<forall>b\\<in>carrier A.\n               S i (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n               S i a \\<plusminus>\\<^bsub>B i\\<^esub> S i b)\\<rbrakk>\n       \\<Longrightarrow> S i x \\<in> carrier (B i)", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier A; i \\<in> I; aGroup A;\n        \\<forall>k\\<in>I. aGroup (B k);\n        S i \\<in> carrier A \\<rightarrow> carrier (B i);\n        S i \\<in> extensional (carrier A);\n        \\<forall>a\\<in>carrier A.\n           \\<forall>b\\<in>carrier A.\n              S i (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n              S i a \\<plusminus>\\<^bsub>B i\\<^esub> S i b\\<rbrakk>\n       \\<Longrightarrow> S i x \\<in> carrier (B i)", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma A_to_prodag_aHom:\"\\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k); \\<forall>k\\<in>I. (S k) \\<in>\n aHom A (B k) \\<rbrakk>  \\<Longrightarrow> A_to_prodag A I S B \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> aHom A (a\\<Pi>\\<^bsub>I\\<^esub> B)", "apply (simp add:aHom_def [of \"A\" \"a\\<Pi>\\<^bsub>I\\<^esub> B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> B) \\<and>\n                      A_to_prodag A I S B\n                      \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> carrier A \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)", "apply (simp add:prodag_def A_to_prodag_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B\n                      \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             A_to_prodag A I S B\n                              (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> A_to_prodag A I S B \\<in> extensional (carrier A)\n 2. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            A_to_prodag A I S B\n                             (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                            A_to_prodag A I S B\n                             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B b", "apply (simp add:A_to_prodag_def restrict_def extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n     \\<forall>k\\<in>I. S k \\<in> aHom A (B k)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            A_to_prodag A I S B\n                             (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                            A_to_prodag A I S B\n                             a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                            A_to_prodag A I S B b", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule_tac x = a and y = b in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule_tac x = \"a \\<plusminus>\\<^bsub>A\\<^esub> b\" in A_to_prodag_mem [of \"A\" \"I\" \"B\" \"S\"],\n                                                       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule_tac x = a in A_to_prodag_mem [of \"A\" \"I\" \"B\" \"S\"],\n                                                       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule_tac x = b in A_to_prodag_mem [of \"A\" \"I\" \"B\" \"S\"],\n                                                       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule prodag_aGroup [of \"I\" \"B\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule_tac x = a in A_to_prodag_mem[of \"A\" \"I\" \"B\" \"S\"], assumption+,\n        frule_tac x = b in A_to_prodag_mem[of \"A\" \"I\" \"B\" \"S\"], assumption+,\n        frule_tac x = \"a \\<plusminus>\\<^bsub>A\\<^esub> b\" in A_to_prodag_mem[of \"A\" \"I\" \"B\" \"S\"],\n                                                 assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (frule prodag_aGroup[of \"I\" \"B\"],\n        frule_tac x = \"A_to_prodag A I S B a\" and\n y = \"A_to_prodag A I S B b\" in aGroup.ag_pOp_closed [of \"a\\<Pi>\\<^bsub>I\\<^esub> B\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B a\n                         \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\n 2. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B b\n                         \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\n 3. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (simp add:prodag_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B b\n                         \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\n 2. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (simp add:prodag_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b", "apply (rule carr_prodag_mem_eq, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                         A_to_prodag A I S B b\n                         \\<in> carr_prodag I B\n 2. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            A_to_prodag A I S B\n                             (a \\<plusminus>\\<^bsub>A\\<^esub> b) l =\n                            (A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)\n                             l", "apply (simp add:prodag_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            A_to_prodag A I S B\n                             (a \\<plusminus>\\<^bsub>A\\<^esub> b) l =\n                            (A_to_prodag A I S B\n                              a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                             A_to_prodag A I S B b)\n                             l", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B a \\<in> carr_prodag I B;\n        A_to_prodag A I S B b \\<in> carr_prodag I B;\n        A_to_prodag A I S B (a \\<plusminus>\\<^bsub>A\\<^esub> b)\n        \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        A_to_prodag A I S B\n         a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        A_to_prodag A I S B b\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> A_to_prodag A I S B\n                          (a \\<plusminus>\\<^bsub>A\\<^esub> b) l =\n                         (A_to_prodag A I S B\n                           a \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                          A_to_prodag A I S B b)\n                          l", "apply (simp add:A_to_prodag_def prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        \\<forall>k\\<in>I. S k \\<in> aHom A (B k); a \\<in> carrier A;\n        b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (a \\<plusminus>\\<^bsub>A\\<^esub> b))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k a) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k b) \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        (\\<lambda>k\\<in>I.\n            S k a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        (\\<lambda>k\\<in>I. S k b)\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> S l (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         ((\\<lambda>k\\<in>I.\n                              S k a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                          (\\<lambda>k\\<in>I. S k b))\n                          l", "apply (rotate_tac 2,\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. S k \\<in> aHom A (B k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (a \\<plusminus>\\<^bsub>A\\<^esub> b))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k a) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k b) \\<in> carr_prodag I B;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        (\\<lambda>k\\<in>I.\n            S k a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n        (\\<lambda>k\\<in>I. S k b)\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> B);\n        l \\<in> I; aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        S l \\<in> aHom A (B l)\\<rbrakk>\n       \\<Longrightarrow> S l (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         ((\\<lambda>k\\<in>I.\n                              S k a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> B\\<^esub>\n                          (\\<lambda>k\\<in>I. S k b))\n                          l", "apply (simp add:prodag_def prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (a \\<plusminus>\\<^bsub>A\\<^esub> b))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k a) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k b) \\<in> carr_prodag I B;\n        aGroup\n         \\<lparr>carrier = carr_prodag I B,\n            pop =\n              \\<lambda>f\\<in>carr_prodag I B.\n                 \\<lambda>g\\<in>carr_prodag I B.\n                    \\<lambda>x\\<in>I.\n                       f x \\<plusminus>\\<^bsub>B x\\<^esub> g x,\n            mop = prod_mOp I B, zero = prod_zero I B\\<rparr>;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x a\n             else undefined) \\<plusminus>\\<^bsub>B x\\<^esub>\n            (if x \\<in> I then S x b else undefined))\n        \\<in> carr_prodag I B;\n        l \\<in> I; aGroup A; \\<forall>k\\<in>I. aGroup (B k);\n        S l \\<in> aHom A (B l)\\<rbrakk>\n       \\<Longrightarrow> S l (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         S l a \\<plusminus>\\<^bsub>B l\\<^esub> S l b", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (B k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>a \\<in> carrier A; b \\<in> carrier A;\n        a \\<plusminus>\\<^bsub>A\\<^esub> b \\<in> carrier A;\n        (\\<lambda>k\\<in>I. S k (a \\<plusminus>\\<^bsub>A\\<^esub> b))\n        \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k a) \\<in> carr_prodag I B;\n        (\\<lambda>k\\<in>I. S k b) \\<in> carr_prodag I B;\n        aGroup\n         \\<lparr>carrier = carr_prodag I B,\n            pop =\n              \\<lambda>f\\<in>carr_prodag I B.\n                 \\<lambda>g\\<in>carr_prodag I B.\n                    \\<lambda>x\\<in>I.\n                       f x \\<plusminus>\\<^bsub>B x\\<^esub> g x,\n            mop = prod_mOp I B, zero = prod_zero I B\\<rparr>;\n        (\\<lambda>x\\<in>I.\n            (if x \\<in> I then S x a\n             else undefined) \\<plusminus>\\<^bsub>B x\\<^esub>\n            (if x \\<in> I then S x b else undefined))\n        \\<in> carr_prodag I B;\n        l \\<in> I; aGroup A; S l \\<in> aHom A (B l); aGroup (B l)\\<rbrakk>\n       \\<Longrightarrow> S l (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         S l a \\<plusminus>\\<^bsub>B l\\<^esub> S l b", "apply (simp add: aHom_add)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  finiteHom :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme, 'i \\<Rightarrow> 'a] \\<Rightarrow> bool\" where\n  \"finiteHom I A f \\<longleftrightarrow> f \\<in> carr_prodag I A \\<and> (\\<exists>H. H \\<subseteq> I \\<and> finite H \\<and> (\n    \\<forall>j \\<in> (I - H). (f j) = \\<zero>\\<^bsub>(A j)\\<^esub>))\""], ["", "definition\n  carr_dsumag :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> ('i  \\<Rightarrow> 'a ) set\" where\n  \"carr_dsumag I A = {f. finiteHom I A f}\""], ["", "definition\n  dsumag :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme] \\<Rightarrow> ('i \\<Rightarrow> 'a) aGroup\" where\n  \"dsumag I A = \\<lparr> carrier = carr_dsumag I A,\n     pop = prod_pOp I A, mop = prod_mOp I A,\n     zero = prod_zero I A\\<rparr>\""], ["", "definition\n  dProj :: \"['i set, 'i \\<Rightarrow> ('a, 'more) aGroup_scheme, 'i]\n                   \\<Rightarrow> ('i \\<Rightarrow> 'a) \\<Rightarrow> 'a\" where\n  \"dProj I A x = (\\<lambda>f\\<in>carr_dsumag I A. f x)\""], ["", "abbreviation\n  DSUMag  (\"(a\\<Oplus>\\<^bsub>_\\<^esub> _)\" [72,73]72) where\n  \"a\\<Oplus>\\<^bsub>I\\<^esub> A == dsumag I A\""], ["", "lemma dsum_pOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A \\<rightarrow> carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A\n    \\<in> carr_dsumag I A \\<rightarrow>\n          carr_dsumag I A \\<rightarrow> carr_dsumag I A", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_dsumag I A", "apply (subst carr_dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> Collect (finiteHom I A)", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> finiteHom I A (prod_pOp I A x xa)", "apply (simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A \\<and>\n                         (\\<exists>H\\<subseteq>I.\n                             finite H \\<and>\n                             (\\<forall>j\\<in>I - H.\n                                 prod_pOp I A x xa j =\n                                 \\<zero>\\<^bsub>A j\\<^esub>))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:carr_dsumag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); finiteHom I A x;\n        finiteHom I A xa\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:finiteHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> carr_prodag I A \\<and>\n        (\\<exists>H\\<subseteq>I.\n            finite H \\<and>\n            (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>));\n        xa \\<in> carr_prodag I A \\<and>\n        (\\<exists>H\\<subseteq>I.\n            finite H \\<and>\n            (\\<forall>j\\<in>I - H.\n                xa j = \\<zero>\\<^bsub>A j\\<^esub>))\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>);\n        xa \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H.\n               xa j = \\<zero>\\<^bsub>A j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa \\<in> carr_prodag I A\n 2. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:prod_pOp_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_dsumag I A;\n        xa \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:carr_dsumag_def finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> carr_prodag I A \\<and>\n        (\\<exists>H\\<subseteq>I.\n            finite H \\<and>\n            (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>));\n        xa \\<in> carr_prodag I A \\<and>\n        (\\<exists>H\\<subseteq>I.\n            finite H \\<and>\n            (\\<forall>j\\<in>I - H.\n                xa j = \\<zero>\\<^bsub>A j\\<^esub>))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>);\n        xa \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H.\n               xa j = \\<zero>\\<^bsub>A j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply ((erule exE)+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha;\n        \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (frule_tac F = H and G = Ha in finite_UnI, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (subgoal_tac \"\\<forall>j\\<in>I - (H \\<union> Ha). prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha);\n        \\<forall>j\\<in>I - (H \\<union> Ha).\n           prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - (H \\<union> Ha).\n                            prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (frule_tac A = H and B = Ha in Un_least[of _ \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha);\n        \\<forall>j\\<in>I - (H \\<union> Ha).\n           prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        H \\<union> Ha \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_pOp I A x xa j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - (H \\<union> Ha).\n                            prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - (H \\<union> Ha).\n                            prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite (H \\<union> Ha); j \\<in> I - (H \\<union> Ha)\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (simp, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        xa \\<in> carr_prodag I A; H \\<subseteq> I; Ha \\<subseteq> I;\n        finite H; \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        finite Ha; \\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>;\n        j \\<in> I; j \\<notin> H; j \\<notin> Ha\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (frule_tac x = j in bspec, assumption,\n         thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        frule_tac x = j in bspec, simp,\n         thin_tac \"\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\",\n        frule_tac x = j in bspec, simp,\n         thin_tac \"\\<forall>j\\<in>I - Ha. xa j = \\<zero>\\<^bsub>A j\\<^esub>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A x xa j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A j\\<^esub> \\<plusminus>\\<^bsub>A j\\<^esub>\n                         \\<zero>\\<^bsub>A j\\<^esub> =\n                         \\<zero>\\<^bsub>A j\\<^esub>", "apply (rule aGroup.ag_l_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> aGroup (A j)\n 2. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A j\\<^esub> \\<in> carrier (A j)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A j\\<^esub> \\<in> carrier (A j)", "apply (rule aGroup.ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa H Ha j.\n       \\<lbrakk>x \\<in> carr_prodag I A; xa \\<in> carr_prodag I A;\n        H \\<subseteq> I; Ha \\<subseteq> I; finite H; finite Ha; j \\<in> I;\n        j \\<notin> H; j \\<notin> Ha; aGroup (A j);\n        x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        xa j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> aGroup (A j)", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsum_pOp_mem:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_dsumag I A;\n Y \\<in> carr_dsumag I A\\<rbrakk> \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_dsumag I A;\n     Y \\<in> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_dsumag I A", "apply (frule dsum_pOp_func[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_dsumag I A;\n     Y \\<in> carr_dsumag I A;\n     prod_pOp I A\n     \\<in> carr_dsumag I A \\<rightarrow>\n           carr_dsumag I A \\<rightarrow> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_dsumag I A", "apply (frule funcset_mem[of \"prod_pOp I A\" \"carr_dsumag I A\"\n              \"carr_dsumag I A \\<rightarrow> carr_dsumag I A\" \"X\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); X \\<in> carr_dsumag I A;\n     Y \\<in> carr_dsumag I A;\n     prod_pOp I A\n     \\<in> carr_dsumag I A \\<rightarrow>\n           carr_dsumag I A \\<rightarrow> carr_dsumag I A;\n     prod_pOp I A X\n     \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> prod_pOp I A X Y \\<in> carr_dsumag I A", "apply (rule funcset_mem[of \"prod_pOp I A X\" \"carr_dsumag I A\"\n            \"carr_dsumag I A\" \"Y\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsum_iOp_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  prod_mOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_mOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A", "apply (rule Pi_I)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A x \\<in> carr_dsumag I A", "apply (simp add:carr_dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); finiteHom I A x\\<rbrakk>\n       \\<Longrightarrow> finiteHom I A (prod_mOp I A x)", "apply (simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        x \\<in> carr_prodag I A \\<and>\n        (\\<exists>H\\<subseteq>I.\n            finite H \\<and>\n            (\\<forall>j\\<in>I - H.\n                x j = \\<zero>\\<^bsub>A j\\<^esub>))\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A x \\<in> carr_prodag I A \\<and>\n                         (\\<exists>H\\<subseteq>I.\n                             finite H \\<and>\n                             (\\<forall>j\\<in>I - H.\n                                 prod_mOp I A x j =\n                                 \\<zero>\\<^bsub>A j\\<^esub>))", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A x \\<in> carr_prodag I A \\<and>\n                         (\\<exists>H\\<subseteq>I.\n                             finite H \\<and>\n                             (\\<forall>j\\<in>I - H.\n                                 prod_mOp I A x j =\n                                 \\<zero>\\<^bsub>A j\\<^esub>))", "apply (simp add:prod_mOp_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_mOp I A x j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (erule exE, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x H.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                prod_mOp I A x j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:prod_mOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x H.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)", "apply (subgoal_tac \"\\<forall>j\\<in>I - H. -\\<^sub>a\\<^bsub>A j\\<^esub> (x j) = \\<zero>\\<^bsub>A j\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x H.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        \\<forall>j\\<in>I - H.\n           -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n           \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                            finite H \\<and>\n                            (\\<forall>j\\<in>I - H.\n                                -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n                                \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<And>x H.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - H.\n                            -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n                            \\<zero>\\<^bsub>A j\\<^esub>", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x H.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I - H.\n                            -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n                            \\<zero>\\<^bsub>A j\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x H j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); x \\<in> carr_prodag I A;\n        H \\<subseteq> I; finite H;\n        \\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>;\n        j \\<in> I - H\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A j\\<^esub> x j =\n                         \\<zero>\\<^bsub>A j\\<^esub>", "apply (frule_tac x = j in bspec, simp,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        frule_tac x = j in bspec, simp,\n        thin_tac \"\\<forall>j\\<in>I - H. x j = \\<zero>\\<^bsub>A j\\<^esub>\", simp add:aGroup.ag_inv_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsum_iOp_mem:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_dsumag I A\\<rbrakk> \\<Longrightarrow>\n                         prod_mOp I A X \\<in> carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     X \\<in> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A X \\<in> carr_dsumag I A", "apply (frule dsum_iOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); X \\<in> carr_dsumag I A;\n     prod_mOp I A\n     \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> prod_mOp I A X \\<in> carr_dsumag I A", "apply (simp add:Pi_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsum_zero_func:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                           prod_zero I A \\<in> carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_zero I A \\<in> carr_dsumag I A", "apply (simp add:carr_dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    finiteHom I A (prod_zero I A)", "apply (simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_zero I A \\<in> carr_prodag I A \\<and>\n    (\\<exists>H\\<subseteq>I.\n        finite H \\<and>\n        (\\<forall>j\\<in>I - H.\n            prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_zero I A \\<in> carr_prodag I A\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<exists>H\\<subseteq>I.\n       finite H \\<and>\n       (\\<forall>j\\<in>I - H. prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply (simp add:prod_zero_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<exists>H\\<subseteq>I.\n       finite H \\<and>\n       (\\<forall>j\\<in>I - H. prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply (subgoal_tac \"{} \\<subseteq> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> {} \\<subseteq> I", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> {} \\<subseteq> I\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply (subgoal_tac \"finite {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I;\n     finite {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> finite {}", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> finite {}\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I;\n     finite {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I;\n     finite {}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)", "apply (subgoal_tac \"\\<forall>j\\<in>I - {}. prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I; finite {};\n     \\<forall>j\\<in>I - {}.\n        prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>H\\<subseteq>I.\n                         finite H \\<and>\n                         (\\<forall>j\\<in>I - H.\n                             prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I;\n     finite {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I - {}.\n                         prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I;\n     finite {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I - {}.\n                         prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); {} \\<subseteq> I; finite {};\n        j \\<in> I - {}\\<rbrakk>\n       \\<Longrightarrow> prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_zero I A j = \\<zero>\\<^bsub>A j\\<^esub>", "apply (simp add:prod_zero_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_sub_prodag:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                              carr_dsumag I A \\<subseteq> carr_prodag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    carr_dsumag I A \\<subseteq> carr_prodag I A", "by (rule subsetI,\n       simp add:carr_dsumag_def finiteHom_def)"], ["", "lemma carrier_dsumag:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n         carrier (dsumag I A) = carr_dsumag I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) = carr_dsumag I A", "apply (simp add:dsumag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_elemfun:\"\\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> carrier (dsumag I A)\\<rbrakk> \\<Longrightarrow>\n         f \\<in> extensional I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     f \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:carrier_dsumag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     f \\<in> carr_dsumag I A\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:carr_dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); finiteHom I A f\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:finiteHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     f \\<in> carr_prodag I A \\<and>\n     (\\<exists>H\\<subseteq>I.\n         finite H \\<and>\n         (\\<forall>j\\<in>I - H. f j = \\<zero>\\<^bsub>A j\\<^esub>))\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); f \\<in> carr_prodag I A;\n     \\<exists>H\\<subseteq>I.\n        finite H \\<and>\n        (\\<forall>j\\<in>I - H. f j = \\<zero>\\<^bsub>A j\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I", "apply (simp add:carr_prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_aGroup:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow> aGroup (dsumag I A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    aGroup (a\\<Oplus>\\<^bsub>I\\<^esub> A)", "apply (simp add:aGroup_def [of \"dsumag I A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>)\n    \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier\n                         (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n                a \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n                b \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n                c =\n                a \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n                (b \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n                 c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub> b =\n            b \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n            a)) \\<and>\n    mop (a\\<Oplus>\\<^bsub>I\\<^esub> A)\n    \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<rightarrow>\n          carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub> a \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n        a =\n        \\<zero>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n    \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier (a\\<Oplus>\\<^bsub>I\\<^esub> A) \\<longrightarrow>\n        \\<zero>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub> \\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>\n        a =\n        a)", "apply (simp add:dsumag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    prod_pOp I A\n    \\<in> carr_dsumag I A \\<rightarrow>\n          carr_dsumag I A \\<rightarrow> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_dsumag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    prod_mOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:dsum_pOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_dsumag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    prod_mOp I A \\<in> carr_dsumag I A \\<rightarrow> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:dsum_iOp_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_dsumag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    prod_zero I A \\<in> carr_dsumag I A \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:dsum_zero_func)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carr_dsumag I A \\<longrightarrow>\n                prod_pOp I A (prod_pOp I A a b) c =\n                prod_pOp I A a (prod_pOp I A b c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carr_dsumag I A \\<longrightarrow>\n            prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_mOp I A a) a = prod_zero I A) \\<and>\n    (\\<forall>a.\n        a \\<in> carr_dsumag I A \\<longrightarrow>\n        prod_pOp I A (prod_zero I A) a = a)", "apply (frule dsumag_sub_prodag[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carr_dsumag I A \\<longrightarrow>\n                                  prod_pOp I A (prod_pOp I A a b) c =\n                                  prod_pOp I A a\n                                   (prod_pOp I A b c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carr_dsumag I A \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carr_dsumag I A \\<longrightarrow>\n                                 prod_pOp I A (prod_pOp I A a b) c =\n                                 prod_pOp I A a (prod_pOp I A b c)))\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac X = a and Y = b in dsum_pOp_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A;\n        prod_pOp I A a b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac X = b and Y = c in dsum_pOp_mem, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac X = \"prod_pOp I A a b\" and Y = c in dsum_pOp_mem,\n                    assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac Y = \"prod_pOp I A b c\" and X = a in dsum_pOp_mem,\n                    assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c =\n                         prod_pOp I A a (prod_pOp I A b c)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule carr_prodag_mem_eq [of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c\n                         \\<in> carr_prodag I A\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a (prod_pOp I A b c)\n                         \\<in> carr_prodag I A\n 3. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_pOp I A a b) c l =\n                            prod_pOp I A a (prod_pOp I A b c) l\n 4. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:subsetD)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a (prod_pOp I A b c)\n                         \\<in> carr_prodag I A\n 2. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_pOp I A a b) c l =\n                            prod_pOp I A a (prod_pOp I A b c) l\n 3. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_pOp I A a b) c l =\n                            prod_pOp I A a (prod_pOp I A b c) l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_pOp I A a b) c l =\n                         prod_pOp I A a (prod_pOp I A b c) l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (subst prod_pOp_mem_i, assumption+, (simp add:subsetD)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         prod_pOp I A a (prod_pOp I A b c) l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (subst prod_pOp_mem_i, assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carr_prodag I A\n 2. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag I A\n 3. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> l \\<in> I\n 4. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         prod_pOp I A a (prod_pOp I A b c) l\n 5. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:subsetD)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         prod_pOp I A a (prod_pOp I A b c) l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (subst prod_pOp_mem_i, assumption+, (simp add:subsetD)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         prod_pOp I A b c l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (subst prod_pOp_mem_i, assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carr_prodag I A\n 2. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> c \\<in> carr_prodag I A\n 3. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> l \\<in> I\n 4. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)\n 5. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:subsetD)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A;\n        c \\<in> carr_dsumag I A; prod_pOp I A a b \\<in> carr_dsumag I A;\n        prod_pOp I A b c \\<in> carr_dsumag I A;\n        prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A;\n        prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (thin_tac \"prod_pOp I A a b \\<in> carr_dsumag I A\",\n        thin_tac \"prod_pOp I A b c \\<in> carr_dsumag I A\",\n        thin_tac \"prod_pOp I A (prod_pOp I A a b) c \\<in> carr_dsumag I A\",\n        thin_tac \"prod_pOp I A a (prod_pOp I A b c) \\<in> carr_dsumag I A\",\n        thin_tac \"carr_dsumag I A \\<subseteq> carr_prodag I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k); a \\<in> carr_dsumag I A;\n        b \\<in> carr_dsumag I A; c \\<in> carr_dsumag I A; l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        simp add:carr_dsumag_def finiteHom_def, (erule conjE)+,\n        simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>l \\<in> I; aGroup (A l);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. a j = \\<zero>\\<^bsub>A j\\<^esub>);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. b j = \\<zero>\\<^bsub>A j\\<^esub>);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. c j = \\<zero>\\<^bsub>A j\\<^esub>);\n        a \\<in> extensional I; b \\<in> extensional I; c \\<in> extensional I;\n        a \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. a i \\<in> carrier (A i);\n        b \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. b i \\<in> carrier (A i);\n        c \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. c i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. a i \\<in> carrier (A i)\",\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. b i \\<in> carrier (A i)\",\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>i\\<in>I. c i \\<in> carrier (A i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c l.\n       \\<lbrakk>l \\<in> I; aGroup (A l);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. a j = \\<zero>\\<^bsub>A j\\<^esub>);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. b j = \\<zero>\\<^bsub>A j\\<^esub>);\n        \\<exists>H\\<subseteq>I.\n           finite H \\<and>\n           (\\<forall>j\\<in>I - H. c j = \\<zero>\\<^bsub>A j\\<^esub>);\n        a \\<in> extensional I; b \\<in> extensional I; c \\<in> extensional I;\n        a \\<in> I \\<rightarrow> Un_carrier I A;\n        b \\<in> I \\<rightarrow> Un_carrier I A;\n        c \\<in> I \\<rightarrow> Un_carrier I A; a l \\<in> carrier (A l);\n        b l \\<in> carrier (A l); c l \\<in> carrier (A l)\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         c l =\n                         a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         (b l \\<plusminus>\\<^bsub>A l\\<^esub> c l)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:aGroup.aassoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carr_dsumag I A \\<longrightarrow>\n                              prod_pOp I A a b = prod_pOp I A b a)) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carr_dsumag I A \\<longrightarrow>\n                             prod_pOp I A a b = prod_pOp I A b a)\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b = prod_pOp I A b a\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule carr_prodag_mem_eq [of \"I\" \"A\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A a b \\<in> carr_prodag I A\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A b a \\<in> carr_prodag I A\n 3. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A a b l = prod_pOp I A b a l\n 4. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac X = a and Y = b in prod_pOp_mem[of \"I\" \"A\"],\n         (simp add:subsetD)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A b a \\<in> carr_prodag I A\n 2. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A a b l = prod_pOp I A b a l\n 3. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac X = b and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n         (simp add:subsetD)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A a b l = prod_pOp I A b a l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule ballI,\n         subst prod_pOp_mem_i, assumption+, (simp add:subsetD)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A; l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub> b l =\n                         prod_pOp I A b a l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (subst prod_pOp_mem_i, assumption+, (simp add:subsetD)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A; l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub> b l =\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub> a l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac x = l in bspec, assumption,\n         thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b l.\n       \\<lbrakk>carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; b \\<in> carr_dsumag I A; l \\<in> I;\n        aGroup (A l)\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub> b l =\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub> a l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (frule_tac c = a in subsetD[of \"carr_dsumag I A\" \"carr_prodag I A\"],\n          assumption+, thin_tac \"a \\<in> carr_dsumag I A\",\n         frule_tac c = b in subsetD[of \"carr_dsumag I A\" \"carr_prodag I A\"],\n          assumption+, thin_tac \"b \\<in> carr_dsumag I A\",\n          thin_tac \"carr_dsumag I A \\<subseteq> carr_prodag I A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b l.\n       \\<lbrakk>l \\<in> I; aGroup (A l); a \\<in> carr_prodag I A;\n        b \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> a l \\<plusminus>\\<^bsub>A l\\<^esub> b l =\n                         b l \\<plusminus>\\<^bsub>A l\\<^esub> a l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (simp add:carr_prodag_def, (erule conjE)+,\n         simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_mOp I A a) a =\n                          prod_zero I A) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carr_dsumag I A \\<longrightarrow>\n                          prod_pOp I A (prod_zero I A) a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac X = a in prod_mOp_mem[of \"I\" \"A\"],\n        simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A;\n        prod_mOp I A a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac X = \"prod_mOp I A a\" and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n        simp add:subsetD, simp add:subsetD)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a = prod_zero I A\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (rule carr_prodag_mem_eq [of \"I\" \"A\"], assumption+,\n        simp add:prod_zero_func)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_mOp I A a) a l =\n                            prod_zero I A l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_mOp I A a) a l = prod_zero I A l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (subst prod_pOp_mem_i, assumption+,\n        simp add:subsetD, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_mOp I A a l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         prod_zero I A l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (subst prod_mOp_mem_i, assumption+, simp add:subsetD, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A l\\<^esub> a\n                 l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         prod_zero I A l\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (simp add:prod_zero_i)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_mOp I A a \\<in> carr_prodag I A;\n        prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A l\\<^esub> a\n                 l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         \\<zero>\\<^bsub>A l\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac x = l in bspec, assumption,\n         thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n         thin_tac \"prod_mOp I A a \\<in> carr_prodag I A\",\n         thin_tac \"prod_pOp I A (prod_mOp I A a) a \\<in> carr_prodag I A\",\n        frule_tac c = a in subsetD[of \"carr_dsumag I A\" \"carr_prodag I A\"],\n         assumption,\n        thin_tac \"carr_dsumag I A \\<subseteq> carr_prodag I A\",\n        simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>a \\<in> carr_dsumag I A; l \\<in> I; aGroup (A l);\n        a \\<in> extensional I; a \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. a i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A l\\<^esub> a\n                 l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         \\<zero>\\<^bsub>A l\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac x = l in bspec, assumption,\n         thin_tac \"\\<forall>i\\<in>I. a i \\<in> carrier (A i)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>a \\<in> carr_dsumag I A; l \\<in> I; aGroup (A l);\n        a \\<in> extensional I; a \\<in> I \\<rightarrow> Un_carrier I A;\n        a l \\<in> carrier (A l)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>A l\\<^esub> a\n                 l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         \\<zero>\\<^bsub>A l\\<^esub>\n 2. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (rule aGroup.l_m, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n     carr_dsumag I A \\<subseteq> carr_prodag I A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carr_dsumag I A \\<longrightarrow>\n                         prod_pOp I A (prod_zero I A) a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a = a", "apply (frule prod_zero_func[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A;\n        prod_zero I A \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a = a", "apply (frule_tac X = \"prod_zero I A\" and Y = a in prod_pOp_mem[of \"I\" \"A\"],\n            assumption+, simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a = a", "apply (rule carr_prodag_mem_eq [of \"I\" \"A\"], assumption+,\n        simp add:subsetD)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            prod_pOp I A (prod_zero I A) a l = a l", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_pOp I A (prod_zero I A) a l = a l", "apply (subst prod_pOp_mem_i, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carr_prodag I A\n 2. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> l \\<in> I\n 3. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_zero I A l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l", "apply (simp add:subsetD, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>\\<forall>k\\<in>I. aGroup (A k);\n        carr_dsumag I A \\<subseteq> carr_prodag I A;\n        a \\<in> carr_dsumag I A; prod_zero I A \\<in> carr_prodag I A;\n        prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> prod_zero I A l \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l", "apply (simp add:prod_zero_i,\n        frule_tac x = l in bspec, assumption,\n        thin_tac \"\\<forall>k\\<in>I. aGroup (A k)\",\n        frule_tac c = a in subsetD[of \"carr_dsumag I A\" \"carr_prodag I A\"],\n                  assumption+,\n        thin_tac \"carr_dsumag I A \\<subseteq> carr_prodag I A\",\n        thin_tac \"a \\<in> carr_dsumag I A\",\n        thin_tac \"prod_pOp I A (prod_zero I A) a \\<in> carr_prodag I A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>prod_zero I A \\<in> carr_prodag I A; l \\<in> I;\n        aGroup (A l); a \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A l\\<^esub> \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l", "apply (simp add:carr_prodag_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>l \\<in> I; aGroup (A l); prod_zero I A \\<in> extensional I;\n        a \\<in> extensional I;\n        prod_zero I A \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. prod_zero I A i \\<in> carrier (A i);\n        a \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. a i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A l\\<^esub> \\<plusminus>\\<^bsub>A l\\<^esub>\n                         a l =\n                         a l", "apply (rule aGroup.l_zero, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a l.\n       \\<lbrakk>l \\<in> I; aGroup (A l); prod_zero I A \\<in> extensional I;\n        a \\<in> extensional I;\n        prod_zero I A \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. prod_zero I A i \\<in> carrier (A i);\n        a \\<in> I \\<rightarrow> Un_carrier I A;\n        \\<forall>i\\<in>I. a i \\<in> carrier (A i)\\<rbrakk>\n       \\<Longrightarrow> a l \\<in> carrier (A l)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_pOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  pop (dsumag I A) = prod_pOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    (\\<plusminus>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub>) =\n    prod_pOp I A", "apply (simp add:dsumag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_mOp:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  mop (dsumag I A) = prod_mOp I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    mop (a\\<Oplus>\\<^bsub>I\\<^esub> A) = prod_mOp I A", "apply (simp add:dsumag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma dsumag_zero:\"\\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n                  zero (dsumag I A) = prod_zero I A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<in>I. aGroup (A k) \\<Longrightarrow>\n    \\<zero>\\<^bsub>a\\<Oplus>\\<^bsub>I\\<^esub> A\\<^esub> = prod_zero I A", "apply (simp add:dsumag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Characterization of a direct product\""], ["", "lemma direct_prod_mem_eq:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n       g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); \\<forall>j\\<in>I. (PRoject I A j) f = (PRoject I A j) g\\<rbrakk> \\<Longrightarrow>\n       f = g\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> f = g", "apply (rule funcset_eq[of \"f\" \"I\" \"g\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional I\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> g \\<in> extensional I\n 3. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I. f x = g x", "apply (thin_tac \"\\<forall>j\\<in>I. aGroup (A j)\",\n        thin_tac \"g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\",\n        thin_tac \"\\<forall>j\\<in>I. (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\",\n        simp add:prodag_def carr_prodag_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> g \\<in> extensional I\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I. f x = g x", "apply (thin_tac \"\\<forall>j\\<in>I. aGroup (A j)\",\n        thin_tac \"f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\",\n        thin_tac \"\\<forall>j\\<in>I. (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\",\n        simp add:prodag_def carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     g \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) f =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>) g\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I. f x = g x", "apply (simp add:PRoject_def prodag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma map_family_fun:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n      \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j)); x \\<in> carrier S\\<rbrakk> \\<Longrightarrow>\n         (\\<lambda>y \\<in> carrier S. (\\<lambda>j\\<in>I. (g j) y)) x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j); x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y) x\n                      \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)", "apply (simp add:prodag_def carr_prodag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j); x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>I. g j x)\n                      \\<in> I \\<rightarrow> Un_carrier I A \\<and>\n                      (\\<forall>i\\<in>I. g i x \\<in> carrier (A i))", "apply (simp add:aHom_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j); x \\<in> carrier S\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>j\\<in>I. g j x)\n                      \\<in> I \\<rightarrow> Un_carrier I A", "apply (rule Pi_I, simp add:Un_carrier_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); x \\<in> carrier S;\n        xa \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (A i)) \\<and>\n                            g xa x \\<in> xb", "apply (frule_tac x = xa in bspec, assumption,\n        thin_tac \"\\<forall>j\\<in>I. aGroup (A j)\",\n        frule_tac x = xa in bspec, assumption,\n        thin_tac \"\\<forall>j\\<in>I. g j \\<in> aHom S (A j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa.\n       \\<lbrakk>aGroup S; x \\<in> carrier S; xa \\<in> I; aGroup (A xa);\n        g xa \\<in> aHom S (A xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb.\n                            (\\<exists>i\\<in>I. xb = carrier (A i)) \\<and>\n                            g xa x \\<in> xb", "apply (frule_tac G = \"A xa\" and f = \"g xa\" and a = x in aHom_mem[of \"S\"],\n        assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma map_family_aHom:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n      \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow>\n         (\\<lambda>y \\<in> carrier S. (\\<lambda>j\\<in>I. (g j) y)) \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n                      \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)", "apply (subst aHom_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n                      \\<in> carrier S \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                      (\\<forall>a\\<in>carrier S.\n                          \\<forall>b\\<in>carrier S.\n                             (a \\<plusminus>\\<^bsub>S\\<^esub> b\n                              \\<in> carrier S \\<longrightarrow>\n                              (\\<lambda>j\\<in>I.\n                                  g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                              (\\<lambda>j\\<in>I.\n                                  g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              (\\<lambda>j\\<in>I. g j b)) \\<and>\n                             (a \\<plusminus>\\<^bsub>S\\<^esub> b\n                              \\<notin> carrier S \\<longrightarrow>\n                              undefined =\n                              (\\<lambda>j\\<in>I.\n                                  g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                              (\\<lambda>j\\<in>I. g j b)))", "apply (simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n                      \\<in> carrier S \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                      (\\<forall>a\\<in>carrier S.\n                          \\<forall>b\\<in>carrier S.\n                             (\\<lambda>j\\<in>I.\n                                 g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                             (\\<lambda>j\\<in>I.\n                                 g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                             (\\<lambda>j\\<in>I. g j b))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n                      \\<in> carrier S \\<rightarrow>\n                            carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier S.\n                         \\<forall>b\\<in>carrier S.\n                            (\\<lambda>j\\<in>I.\n                                g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                            (\\<lambda>j\\<in>I.\n                                g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                            (\\<lambda>j\\<in>I. g j b)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); x \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n                          x\n                         \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier S.\n                         \\<forall>b\\<in>carrier S.\n                            (\\<lambda>j\\<in>I.\n                                g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                            (\\<lambda>j\\<in>I.\n                                g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                            (\\<lambda>j\\<in>I. g j b)", "apply (rule map_family_fun[of \"I\" \"A\" \"S\" \"g\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier S.\n                         \\<forall>b\\<in>carrier S.\n                            (\\<lambda>j\\<in>I.\n                                g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                            (\\<lambda>j\\<in>I.\n                                g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                            (\\<lambda>j\\<in>I. g j b)", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (frule_tac x = a and y = b in aGroup.ag_pOp_closed[of \"S\"],\n                   assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (frule_tac x = \"a \\<plusminus>\\<^bsub>S\\<^esub> b\" in map_family_fun[of \"I\" \"A\" \"S\" \"g\"],\n          assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (frule_tac x = a in map_family_fun[of \"I\" \"A\" \"S\" \"g\"],\n          assumption+, simp,\n         frule_tac x = b in map_family_fun[of \"I\" \"A\" \"S\" \"g\"],\n          assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j a) \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j a) \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j b) \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (frule_tac x = \"(\\<lambda>j\\<in>I. g j a)\" and y = \"(\\<lambda>j\\<in>I. g j b)\" in\n        aGroup.ag_pOp_closed[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j a) \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I. g j b) \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I.\n            g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (simp only:prodag_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j a) \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j b) \\<in> carr_prodag I A;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I.\n            g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b)) =\n                         (\\<lambda>j\\<in>I.\n                             g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                         (\\<lambda>j\\<in>I. g j b)", "apply (rule carr_prodag_mem_eq, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j a) \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j b) \\<in> carr_prodag I A;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I.\n            g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>I.\n                            (\\<lambda>j\\<in>I.\n                                g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n                             l =\n                            ((\\<lambda>j\\<in>I.\n                                 g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                             (\\<lambda>j\\<in>I. g j b))\n                             l", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j a) \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j b) \\<in> carr_prodag I A;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I.\n            g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>j\\<in>I.\n                             g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n                          l =\n                         ((\\<lambda>j\\<in>I.\n                              g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n                          (\\<lambda>j\\<in>I. g j b))\n                          l", "apply (subst prodag_def, simp add:prod_pOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b l.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j); a \\<in> carrier S;\n        b \\<in> carrier S;\n        a \\<plusminus>\\<^bsub>S\\<^esub> b \\<in> carrier S;\n        (\\<lambda>j\\<in>I. g j (a \\<plusminus>\\<^bsub>S\\<^esub> b))\n        \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j a) \\<in> carr_prodag I A;\n        (\\<lambda>j\\<in>I. g j b) \\<in> carr_prodag I A;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>j\\<in>I.\n            g j a) \\<plusminus>\\<^bsub>a\\<Pi>\\<^bsub>I\\<^esub> A\\<^esub>\n        (\\<lambda>j\\<in>I. g j b)\n        \\<in> carr_prodag I A;\n        l \\<in> I\\<rbrakk>\n       \\<Longrightarrow> g l (a \\<plusminus>\\<^bsub>S\\<^esub> b) =\n                         g l a \\<plusminus>\\<^bsub>A l\\<^esub> g l b", "apply (simp add:aHom_add)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma map_family_triangle:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n         \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow> \\<exists>!f. f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                  (\\<forall>j\\<in>I. compos S (PRoject I A j) f =  (g j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!f.\n                         f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j)", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j)\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (frule map_family_aHom[of \"I\" \"A\" \"S\" \"g\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n     \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j)\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (subgoal_tac \"\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y) = g j\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n     \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<forall>j\\<in>I.\n        compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y) =\n        g j\\<rbrakk>\n    \\<Longrightarrow> \\<exists>f.\n                         f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j)\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n     \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y) =\n                         g j\n 3. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n     \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y) =\n                         g j\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y) =\n                         g j\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y) =\n                         g j\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (rule funcset_eq[of _ \"carrier S\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y)\n                         \\<in> extensional (carrier S)\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> g j \\<in> extensional (carrier S)\n 3. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S.\n                            compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (\\<lambda>y\\<in>carrier S.\n                                 \\<lambda>j\\<in>I. g j y)\n                             x =\n                            g j x\n 4. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (simp add:compose_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> g j \\<in> extensional (carrier S)\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S.\n                            compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (\\<lambda>y\\<in>carrier S.\n                                 \\<lambda>j\\<in>I. g j y)\n                             x =\n                            g j x\n 3. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S.\n                            compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                             (\\<lambda>y\\<in>carrier S.\n                                 \\<lambda>j\\<in>I. g j y)\n                             x =\n                            g j x\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I; x \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y)\n                          x =\n                         g j x\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I; x \\<in> carrier S;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y)\n                          x =\n                         g j x\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (frule prodag_carrier[of \"I\" \"A\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I; x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y)\n                          x =\n                         g j x\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (frule_tac f = \"\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y\" and a = x in\n        aHom_mem[of \"S\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y)\n        \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        j \\<in> I; x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) = carr_prodag I A;\n        (\\<lambda>y\\<in>carrier S. \\<lambda>j\\<in>I. g j y) x\n        \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> compose (carrier S) (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          (\\<lambda>y\\<in>carrier S.\n                              \\<lambda>j\\<in>I. g j y)\n                          x =\n                         g j x\n 2. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (simp add:compose_def, simp add:PRoject_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        y \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) y = g j)\\<rbrakk>\n       \\<Longrightarrow> f = y", "apply (rename_tac f f1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j)\\<rbrakk>\n       \\<Longrightarrow> f = f1", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\\<rbrakk>\n       \\<Longrightarrow> f = f1", "apply (rule funcset_eq[of _ \"carrier S\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\\<rbrakk>\n       \\<Longrightarrow> f \\<in> extensional (carrier S)\n 2. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\\<rbrakk>\n       \\<Longrightarrow> f1 \\<in> extensional (carrier S)\n 3. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S. f x = f1 x", "apply (simp add:aHom_def, simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S. f x = f1 x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j;\n        x \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> f x = f1 x", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j;\n        x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> f x = f1 x", "apply (frule_tac f = f and a = x in aHom_mem[of \"S\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\"], assumption+,\n        frule_tac f = f1 and a = x in aHom_mem[of \"S\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j;\n        x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f1 x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> f x = f1 x", "apply (rule_tac f = \"f x\" and g = \"f1 x\" in direct_prod_mem_eq[of \"I\" \"A\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j;\n        x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f1 x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x) =\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j;\n        f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j;\n        x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f1 x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)", "apply (rotate_tac 4,\n        frule_tac x = j in bspec, assumption,\n        thin_tac \"\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j\",\n         frule_tac x = j in bspec, assumption,\n        thin_tac \"\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f1 = g j\",\n        simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>f f1 x j.\n       \\<lbrakk>f1 \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        x \\<in> carrier S; aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        f1 x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A); j \\<in> I;\n        \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        (\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x)) =\n        g j;\n        (\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)) =\n        g j\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)", "apply (subgoal_tac \"(\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x)) x = g j x\",\n        subgoal_tac \"(\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)) x = g j x\",\n        thin_tac \"(\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f x)) = g j\",\n        thin_tac \"(\\<lambda>x\\<in>carrier S. (\\<pi>\\<^bsub>I,A,j\\<^esub>) (f1 x)) = g j\",\nsimp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Ag_ind_triangle:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I; f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\ncompos (a\\<Pi>\\<^bsub>I\\<^esub> A) (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)(PRoject I A j) (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),\n (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<^esub> (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))) (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                                       PRoject I A j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                       (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                       (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                       (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                       (compose\n                         (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (rule funcset_eq[of _ \"carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                       (compose\n                         (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n 3. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                          (compose\n                            (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                            (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                 (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n      f))\n                          (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) x =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<pi>\\<^bsub>I,A,j\\<^esub>\n                      \\<in> extensional\n                             (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                          (compose\n                            (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                            (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                 (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n      f))\n                          (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) x =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply (simp add:PRoject_def  prodag_carrier extensional_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier (a\\<Pi>\\<^bsub>I\\<^esub> A).\n                         compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                          (compose\n                            (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                            (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                 (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n      f))\n                          (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) x =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> compose (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A))\n                          (compose\n                            (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                            (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                            (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                 (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n      f))\n                          (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) x =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply (simp add:compose_def invfun_l)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x\n                          \\<in> carrier\n                                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                   f) \\<longrightarrow>\n                          (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                           ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                 (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n      f)\n                             (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x)) =\n                          (\\<pi>\\<^bsub>I,A,j\\<^esub>) x) \\<and>\n                         (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x\n                          \\<notin> carrier\n                                    (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\nf) \\<longrightarrow>\n                          undefined = (\\<pi>\\<^bsub>I,A,j\\<^esub>) x)", "apply (simp add:aGroup.Agii_mem)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n     f)\n                            (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x)) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply (frule Ag_ind_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n     f)\n                            (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x)) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply (frule_tac x = x in ainvf_l[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"\n                                     \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n         (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x) =\n        x\\<rbrakk>\n       \\<Longrightarrow> (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                          ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                                (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n     f)\n                            (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f x)) =\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>) x", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(** Note               f'\n                 a\\<Pi>\\<^bsub>I\\<^esub> A \\<rightarrow> Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n                     \\     |\n                      \\    |\n        PRoject I A j  \\   | (PRoject I A j) o (f'\\<inverse>\\<^sup>1)\n                        \\  |\n                          A j             , where f' = Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f **)"], ["", "definition\n  ProjInd :: \"['i set, 'i \\<Rightarrow> ('a, 'm) aGroup_scheme, ('i \\<Rightarrow> 'a) \\<Rightarrow> 'd, 'i] \\<Rightarrow>\n                       ('d \\<Rightarrow> 'a)\" where\n  \"ProjInd I A f j = compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)(PRoject I A j) (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A), (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<^esub> (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\""], ["", "(** Note               f'\n                 a\\<Pi>\\<^bsub>I\\<^esub> A \\<rightarrow> Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n                     \\     |\n                      \\    |\n        PRoject I A j  \\   | PRojInd I A f j\n                        \\  |\n                          A j              **)"], ["", "lemma ProjInd_aHom:\"\\<lbrakk>\\<forall>j\\<in> I. aGroup (A j); j \\<in> I; f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n        (ProjInd I A f j) \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> ProjInd I A f j\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> ProjInd I A f j\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> ProjInd I A f j\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule_tac x = j in bspec, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f); aGroup (A j)\\<rbrakk>\n    \\<Longrightarrow> ProjInd I A f j\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule aGroup.Ag_ind_aHom[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f); aGroup (A j);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> ProjInd I A f j\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (simp add:ProjInd_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                       (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule Ag_ind_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                       (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule ainvf_aHom[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n             assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                       (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (frule project_aHom[of \"I\" \"A\" \"j\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n            (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     \\<pi>\\<^bsub>I,A,j\\<^esub>\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A) (A j)\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                       (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                       (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                      \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                             (A j)", "apply (simp add:aHom_compos)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ProjInd_aHom1:\"\\<lbrakk>\\<forall>j\\<in> I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set)\\<rbrakk> \\<Longrightarrow>\n        \\<forall>j\\<in>I. (ProjInd I A f j) \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (A j)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         ProjInd I A f j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                                (A j)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                                (A j)", "apply (simp add:ProjInd_aHom)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ProjInd_mem_eq:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S; x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      \\<forall>j\\<in>I. (ProjInd I A f j x = ProjInd I A f j y)\\<rbrakk> \\<Longrightarrow> x = y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I. ProjInd I A f j x = ProjInd I A f j y\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (simp add:ProjInd_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n         x =\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n         y\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule aGroup.Ag_ind_aHom[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule Ag_ind_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule ainvf_aHom[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule aHom_mem[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"x\"], assumption+,\n       frule aHom_mem[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n            (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule direct_prod_mem_eq[of \"I\" \"A\" \"(ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) x\" \"(ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n            (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (thin_tac \"ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (a\\<Pi>\\<^bsub>I\\<^esub> A)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule ainvf_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n                   assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y;\n     bijec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                   f)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (thin_tac \"bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y;\n     bijec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                   f)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (unfold bijec_def, frule conjunct1, fold bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y;\n     bijec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                   f)\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (frule injec_inj_on[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     y \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           x) =\n        (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n         ((ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n               (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n           y);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n     \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y\n     \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      x =\n     (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n          (a\\<Pi>\\<^bsub>I\\<^esub> A)\n          f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      y;\n     bijec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                   f,(a\\<Pi>\\<^bsub>I\\<^esub> A)\\<^esub> (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                        (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                        f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     inj_on\n      (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n           (a\\<Pi>\\<^bsub>I\\<^esub> A)\n           f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n      (carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\\<rbrakk>\n    \\<Longrightarrow> x = y", "apply (simp add:injective_iff[THEN sym, of \"ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\" \"x\" \"y\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ProjInd_mem_eq1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n      h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n      \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h = ProjInd I A f j\\<rbrakk>       \\<Longrightarrow> h = ag_idmap (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> h =\n                      aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub>", "apply (rule funcset_eq[of _ \"carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> h \\<in> extensional\n                               (carrier\n                                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n 3. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n                         h x =\n                         aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f\\<^esub>\n                          x", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n 2. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n                         h x =\n                         aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f\\<^esub>\n                          x", "apply (simp add:ag_idmap_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n              (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n                         h x =\n                         aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f\\<^esub>\n                          x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j)\n            h =\n           ProjInd I A f j;\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> h x =\n                         aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f\\<^esub>\n                          x", "apply (simp add:ag_idmap_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j)\n            h =\n           ProjInd I A f j;\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> h x = x", "apply (frule prodag_aGroup[of \"I\" \"A\"],\n        frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j)\n            h =\n           ProjInd I A f j;\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> h x = x", "apply (frule_tac a = x in aHom_mem[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"\n        \"h\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j)\n            h =\n           ProjInd I A f j;\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> h x = x", "apply (rule_tac x = \"h x\" and y = x in ProjInd_mem_eq[of \"I\" \"A\" \"f\" \"B\" \"S\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j)\n            h =\n           ProjInd I A f j;\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            ProjInd I A f j (h x) = ProjInd I A f j x", "apply (rotate_tac 1,\n        rule ballI,\n        frule_tac x = j in bspec, assumption,\n        thin_tac \"\\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n               ProjInd I A f j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x j.\n       \\<lbrakk>f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) (ProjInd I A f j) h =\n        ProjInd I A f j\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j (h x) = ProjInd I A f j x", "apply (simp add:compos_def compose_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x j.\n       \\<lbrakk>f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n        (\\<lambda>x\\<in>carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n            ProjInd I A f j (h x)) =\n        ProjInd I A f j\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j (h x) = ProjInd I A f j x", "apply (subgoal_tac \"(\\<lambda>x\\<in>carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f). ProjInd I A f j (h x)) x\n                    = ProjInd I A f j x\",\n        thin_tac \"(\\<lambda>x\\<in>carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f). ProjInd I A f j (h x)) =\n           ProjInd I A f j\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x j.\n       \\<lbrakk>f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n        (\\<lambda>x\\<in>carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n            ProjInd I A f j (h x))\n         x =\n        ProjInd I A f j x\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j (h x) = ProjInd I A f j x\n 2. \\<And>x j.\n       \\<lbrakk>f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        h \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                 (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. aGroup (A j); j \\<in> I;\n        (\\<lambda>x\\<in>carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n            ProjInd I A f j (h x)) =\n        ProjInd I A f j\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>x\\<in>carrier\n    (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f).\n                             ProjInd I A f j (h x))\n                          x =\n                         ProjInd I A f j x", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Ag_ind_triangle1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); j \\<in> I\\<rbrakk> \\<Longrightarrow>\n      compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j) (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =  PRoject I A j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (simp add:ProjInd_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                       (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                         (\\<pi>\\<^bsub>I,A,j\\<^esub>)\n                         (ainvf\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n                              (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                              f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                       (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) =\n                      \\<pi>\\<^bsub>I,A,j\\<^esub>", "apply (simp add:Ag_ind_triangle)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma map_family_triangle1:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n      bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) (B::'d set); aGroup S;\n     \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j))\\<rbrakk> \\<Longrightarrow> \\<exists>!h. h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n                  (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h =  (g j))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)", "apply (frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)", "apply (frule Ag_ind_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"f\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>!h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (frule map_family_triangle[of \"I\" \"A\" \"S\" \"g\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     \\<exists>!f.\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (frule ex1_implies_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n     f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n     bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n         (a\\<Pi>\\<^bsub>I\\<^esub> A)\n         f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n     \\<exists>!f.\n        f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n     \\<exists>x.\n        x \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) x = g j)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         h \\<in> aHom S\n                                  (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                    f) \\<and>\n                         (\\<forall>j\\<in>I.\n                             compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        x \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) x = g j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        x \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I.\n           compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) x = g j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (unfold bijec_def, frule conjunct2, fold bijec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        x \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) x = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (unfold surjec_def, frule conjunct1, fold surjec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        x \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) x = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (rename_tac fa,\n       frule_tac f = fa in aHom_compos[of \"S\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" _\n                 \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (subgoal_tac \"\\<forall>j\\<in>I. compos S (ProjInd I A f j)\n                           (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) = g j\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>fa.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I.\n           compos S (ProjInd I A f j)\n            (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n           g j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            h \\<in> aHom S\n                                     (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n f) \\<and>\n                            (\\<forall>j\\<in>I.\n                                compos S (ProjInd I A f j) h = g j)\n 2. \\<And>fa.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            compos S (ProjInd I A f j)\n                             (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                               fa) =\n                            g j\n 3. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            compos S (ProjInd I A f j)\n                             (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                               fa) =\n                            g j\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos S (ProjInd I A f j)\n                          (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                            fa) =\n                         g j\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (frule_tac N = \"A j\" and f = fa and g = \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\" and\n h = \"ProjInd I A f j\" in aHom_compos_assoc[of \"S\" \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A j)\n 2. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\n 3. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n                         \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n 4. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                                (A j)\n 5. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I;\n        compos S (ProjInd I A f j)\n         (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S\n         (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n           (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n         fa\\<rbrakk>\n       \\<Longrightarrow> compos S (ProjInd I A f j)\n                          (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                            fa) =\n                         g j\n 6. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply simp"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A)\n 2. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n                         \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n 3. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                                (A j)\n 4. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I;\n        compos S (ProjInd I A f j)\n         (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S\n         (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n           (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n         fa\\<rbrakk>\n       \\<Longrightarrow> compos S (ProjInd I A f j)\n                          (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                            fa) =\n                         g j\n 5. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply assumption+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                                (A j)\n 2. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I;\n        compos S (ProjInd I A f j)\n         (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S\n         (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n           (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n         fa\\<rbrakk>\n       \\<Longrightarrow> compos S (ProjInd I A f j)\n                          (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                            fa) =\n                         g j\n 3. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (simp add:ProjInd_aHom)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I;\n        compos S (ProjInd I A f j)\n         (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S\n         (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n           (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n         fa\\<rbrakk>\n       \\<Longrightarrow> compos S (ProjInd I A f j)\n                          (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\n                            fa) =\n                         g j\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I;\n        compos S (ProjInd I A f j)\n         (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S\n         (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j)\n           (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n         fa\\<rbrakk>\n       \\<Longrightarrow> compos S\n                          (compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            (ProjInd I A f j)\n                            (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                          fa =\n                         g j\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (thin_tac \"compos S (ProjInd I A f j) (compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa) =\n        compos S (compos (a\\<Pi>\\<^bsub>I\\<^esub> A) (ProjInd I A f j) (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f)) fa\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>fa j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        \\<exists>!f.\n           f \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<and>\n           (\\<forall>j\\<in>I.\n               compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) f = g j);\n        fa \\<in> aHom S (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        \\<forall>j\\<in>I. compos S (\\<pi>\\<^bsub>I,A,j\\<^esub>) fa = g j;\n        surjec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n             (a\\<Pi>\\<^bsub>I\\<^esub> A)\n             f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f\n        \\<in> aHom (a\\<Pi>\\<^bsub>I\\<^esub> A)\n               (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        compos S (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f) fa\n        \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos S\n                          (compos (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                            (ProjInd I A f j)\n                            (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f))\n                          fa =\n                         g j\n 2. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (simp add:Ag_ind_triangle1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h y.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        y \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) y = g j)\\<rbrakk>\n       \\<Longrightarrow> h = y", "apply (rename_tac h h1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j);\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f) \\<and>\n        (\\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j)\\<rbrakk>\n       \\<Longrightarrow> h = h1", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> h = h1", "apply (rule funcset_eq[of _ \"carrier S\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> h \\<in> extensional (carrier S)\n 2. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> h1 \\<in> extensional (carrier S)\n 3. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S. h x = h1 x", "apply (simp add:aHom_def, simp add:aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>carrier S. h x = h1 x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compos S (ProjInd I A f j) h1 = g j;\n        x \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h x = h1 x", "apply (simp add:compos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h1 = g j;\n        x \\<in> carrier S\\<rbrakk>\n       \\<Longrightarrow> h x = h1 x", "apply (frule_tac f = h and a = x in aHom_mem[of \"S\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n          assumption+,\n       frule_tac f = h1 and a = x in aHom_mem[of \"S\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f\"],\n          assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h1 = g j;\n        x \\<in> carrier S;\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h1 x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> h x = h1 x", "apply (rule_tac x = \"h x\" and y = \"h1 x\" in ProjInd_mem_eq[of \"I\" \"A\" \"f\"\n       \"B\" \"S\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h1 = g j;\n        x \\<in> carrier S;\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h1 x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I.\n                            ProjInd I A f j (h x) = ProjInd I A f j (h1 x)", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h = g j;\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        \\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h1 = g j;\n        x \\<in> carrier S;\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h1 x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j (h x) = ProjInd I A f j (h1 x)", "apply (rotate_tac 5,\n       frule_tac x = j in bspec, assumption,\n       thin_tac \"\\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h = g j\",\n       frule_tac x = j in bspec, assumption,\n       thin_tac \"\\<forall>j\\<in>I. compose (carrier S) (ProjInd I A f j) h1 = g j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h h1 x j.\n       \\<lbrakk>aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            f\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) f;\n        h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h1 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        x \\<in> carrier S;\n        h x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        h1 x \\<in> carrier (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) f);\n        j \\<in> I; \\<forall>j\\<in>I. aGroup (A j);\n        f \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to f (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B; aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        compose (carrier S) (ProjInd I A f j) h = g j;\n        compose (carrier S) (ProjInd I A f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A f j (h x) = ProjInd I A f j (h1 x)", "apply (simp add:compose_def,\n       subgoal_tac \"(\\<lambda>x\\<in>carrier S. ProjInd I A f j (h x)) x = g j x\",\n       thin_tac \"(\\<lambda>x\\<in>carrier S. ProjInd I A f j (h x)) = g j\",\n       subgoal_tac \"(\\<lambda>x\\<in>carrier S. ProjInd I A f j (h1 x)) x = g j x\",\n       thin_tac \"(\\<lambda>x\\<in>carrier S. ProjInd I A f j (h1 x)) = g j\", simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  map_family_triangle2:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n       \\<forall>j\\<in>I. g j \\<in> aHom S (A j); ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 = ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n                 (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n                ProjInd I A ff j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n        ProjInd I A ff j;\n     h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n        j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply (frule_tac f = ff in aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" _ \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply (frule_tac N = \"A j\" and h = \"ProjInd I A ff j\" in aHom_compos_assoc[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" \"S\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" _ \"h1\" \"h2\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> aGroup (A j)\n 2. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> h1 \\<in> aHom\n                                   (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S\n 3. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> h2 \\<in> aHom S\n                                   (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n 4. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A ff j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                                (A j)\n 5. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n         (compos S (ProjInd I A ff j) h2) h1\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> h1 \\<in> aHom\n                                   (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S\n 2. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> h2 \\<in> aHom S\n                                   (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n 3. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A ff j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                                (A j)\n 4. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n         (compos S (ProjInd I A ff j) h2) h1\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> ProjInd I A ff j\n                         \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                                (A j)\n 2. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n         (compos S (ProjInd I A ff j) h2) h1\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply (simp add:ProjInd_aHom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j; j \\<in> I;\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n         (compos S (ProjInd I A ff j) h2) h1\\<rbrakk>\n       \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                          (ProjInd I A ff j)\n                          (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2\n                            h1) =\n                         ProjInd I A ff j", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  map_family_triangle3:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n       \\<forall>j\\<in>I. f j \\<in> aHom S (A j); \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j);\n        h1 \\<in> aHom S1 S; h2 \\<in> aHom S S1;\n        \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>I. compos S (f j) (compos S h1 h2) = f j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n     \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n     \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n     h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n     \\<forall>j\\<in>I. compos S1 (f j) h1 = g j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         compos S (f j) (compos S h1 h2) = f j", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) (compos S h1 h2) = f j", "apply (frule_tac h = \"f j\" and N = \"A j\" in aHom_compos_assoc[of \"S\" \"S1\"\n                              \"S\" _ \"h2\" \"h1\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> aGroup (A j)\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> h2 \\<in> aHom S S1\n 3. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> h1 \\<in> aHom S1 S\n 4. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> aHom S (A j)\n 5. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I;\n        compos S (f j) (compos S h1 h2) =\n        compos S (compos S1 (f j) h1) h2\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) (compos S h1 h2) = f j", "apply simp"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> h2 \\<in> aHom S S1\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> h1 \\<in> aHom S1 S\n 3. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> aHom S (A j)\n 4. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I;\n        compos S (f j) (compos S h1 h2) =\n        compos S (compos S1 (f j) h1) h2\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) (compos S h1 h2) = f j", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> f j \\<in> aHom S (A j)\n 2. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I;\n        compos S (f j) (compos S h1 h2) =\n        compos S (compos S1 (f j) h1) h2\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) (compos S h1 h2) = f j", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S; aGroup S1;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j);\n        \\<forall>j\\<in>I. g j \\<in> aHom S1 (A j); h1 \\<in> aHom S1 S;\n        h2 \\<in> aHom S S1; \\<forall>j\\<in>I. compos S (g j) h2 = f j;\n        \\<forall>j\\<in>I. compos S1 (f j) h1 = g j; j \\<in> I;\n        compos S (f j) (compos S h1 h2) =\n        compos S (compos S1 (f j) h1) h2\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) (compos S h1 h2) = f j", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma map_family_triangle4:\"\\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n                \\<forall>j\\<in>I. f j \\<in> aHom S (A j)\\<rbrakk> \\<Longrightarrow>\n               \\<forall>j\\<in>I. compos S (f j) (ag_idmap S) = f j\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. f j \\<in> aHom S (A j)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>I.\n                         compos S (f j) aI\\<^bsub>S\\<^esub> = f j", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. f j \\<in> aHom S (A j); j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) aI\\<^bsub>S\\<^esub> = f j", "apply (frule_tac x = j in bspec, assumption,\n       thin_tac \"\\<forall>j\\<in>I. aGroup (A j)\",\n       frule_tac x = j in bspec, assumption,\n       thin_tac \"\\<forall>j\\<in>I. f j \\<in> aHom S (A j)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>aGroup S; j \\<in> I; aGroup (A j);\n        f j \\<in> aHom S (A j)\\<rbrakk>\n       \\<Longrightarrow> compos S (f j) aI\\<^bsub>S\\<^esub> = f j", "apply (simp add:compos_aI_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma  prod_triangle:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n       \\<forall>j\\<in>I. g j \\<in> aHom S (A j); ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 = ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n       \\<Longrightarrow> (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) = ag_idmap (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n        ProjInd I A ff j;\n     h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n                      aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 ff\\<^esub>", "apply (frule map_family_triangle2[of \"I\" \"A\" \"S\" \"g\" \"ff\" \"B\" \"h1\" \"h2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n        ProjInd I A ff j;\n     h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        ProjInd I A ff j\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n                      aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 ff\\<^esub>", "apply (frule prodag_aGroup[of \"I\" \"A\"],\n       frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" \"ff\" \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n        ProjInd I A ff j;\n     h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        ProjInd I A ff j;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n                      aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 ff\\<^esub>", "apply (frule aHom_compos[of \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" \"S\" \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" \"h1\"\n                            \"h2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n     bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n        ProjInd I A ff j;\n     h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n     \\<forall>j\\<in>I.\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (ProjInd I A ff j)\n         (compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1) =\n        ProjInd I A ff j;\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n     aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n     compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1\n     \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n            (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n    \\<Longrightarrow> compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n                      aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                                 ff\\<^esub>", "apply (rule ProjInd_mem_eq1[of \"I\" \"A\" \"ff\" \"B\" \"S\"\n                            \"compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma characterization_prodag:\"\\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>(I::'i set). aGroup ((A j)::\n    ('a, 'm) aGroup_scheme); aGroup (S::'d aGroup);\n    \\<forall>j\\<in>I. ((g j) \\<in> aHom S (A j)); \\<exists>ff. ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> (B::'d set) \\<and>\n          bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n    \\<forall>(S':: 'd aGroup). aGroup S' \\<longrightarrow>\n        (\\<forall>g'. (\\<forall>j\\<in>I. (g' j) \\<in> aHom S' (A j) \\<longrightarrow>\n         (\\<exists>! f. f \\<in> aHom S' S \\<and> (\\<forall>j\\<in>I. compos S' (g j) f =  (g' j)))))\\<rbrakk> \\<Longrightarrow>\n     \\<exists>h. bijec\\<^bsub>(prodag I A),S\\<^esub> h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     \\<exists>ff.\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B \\<and>\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     \\<forall>S'.\n        aGroup S' \\<longrightarrow>\n        (\\<forall>g'.\n            \\<forall>j\\<in>I.\n               g' j \\<in> aHom S' (A j) \\<longrightarrow>\n               (\\<exists>!f.\n                   f \\<in> aHom S' S \\<and>\n                   (\\<forall>j\\<in>I. compos S' (g j) f = g' j)))\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule prodag_aGroup[of \"I\" \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n     \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n     \\<exists>ff.\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B \\<and>\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n     \\<forall>S'.\n        aGroup S' \\<longrightarrow>\n        (\\<forall>g'.\n            \\<forall>j\\<in>I.\n               g' j \\<in> aHom S' (A j) \\<longrightarrow>\n               (\\<exists>!f.\n                   f \\<in> aHom S' S \\<and>\n                   (\\<forall>j\\<in>I. compos S' (g j) f = g' j)));\n     aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h.\n                         bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        \\<forall>S'.\n           aGroup S' \\<longrightarrow>\n           (\\<forall>g'.\n               \\<forall>j\\<in>I.\n                  g' j \\<in> aHom S' (A j) \\<longrightarrow>\n                  (\\<exists>!f.\n                      f \\<in> aHom S' S \\<and>\n                      (\\<forall>j\\<in>I. compos S' (g j) f = g' j)));\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B \\<and>\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule_tac f = ff in aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" _ \"B\"], erule conjE,\n       assumption, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        \\<forall>S'.\n           aGroup S' \\<longrightarrow>\n           (\\<forall>g'.\n               \\<forall>j\\<in>I.\n                  g' j \\<in> aHom S' (A j) \\<longrightarrow>\n                  (\\<exists>!f.\n                      f \\<in> aHom S' S \\<and>\n                      (\\<forall>j\\<in>I. compos S' (g j) f = g' j)));\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule aGroup.Ag_ind_aGroup[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" _ \"B\"], assumption+,\n       frule_tac a = S in forall_spec, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        \\<forall>S'.\n           aGroup S' \\<longrightarrow>\n           (\\<forall>g'.\n               \\<forall>j\\<in>I.\n                  g' j \\<in> aHom S' (A j) \\<longrightarrow>\n                  (\\<exists>!f.\n                      f \\<in> aHom S' S \\<and>\n                      (\\<forall>j\\<in>I. compos S' (g j) f = g' j)));\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>g'.\n           \\<forall>j\\<in>I.\n              g' j \\<in> aHom S (A j) \\<longrightarrow>\n              (\\<exists>!f.\n                  f \\<in> aHom S S \\<and>\n                  (\\<forall>j\\<in>I. compos S (g j) f = g' j))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (rotate_tac -1,\n       frule_tac x = g in spec,\n       thin_tac \"\\<forall>g'. \\<forall>j\\<in>I. g' j \\<in> aHom S (A j) \\<longrightarrow>\n              (\\<exists>!f. f \\<in> aHom S S \\<and> (\\<forall>j\\<in>I. compos S (g j) f = g' j))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        \\<forall>S'.\n           aGroup S' \\<longrightarrow>\n           (\\<forall>g'.\n               \\<forall>j\\<in>I.\n                  g' j \\<in> aHom S' (A j) \\<longrightarrow>\n                  (\\<exists>!f.\n                      f \\<in> aHom S' S \\<and>\n                      (\\<forall>j\\<in>I. compos S' (g j) f = g' j)));\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I.\n           g j \\<in> aHom S (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom S S \\<and>\n               (\\<forall>j\\<in>I. compos S (g j) f = g j))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule_tac a = \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" in forall_spec, assumption+,\n       thin_tac \"\\<forall>S'. aGroup S' \\<longrightarrow> (\\<forall>g'. \\<forall>j\\<in>I. g' j \\<in> aHom S' (A j) \\<longrightarrow>\n                (\\<exists>!f. f \\<in> aHom S' S \\<and> (\\<forall>j\\<in>I. compos S' (g j) f = g' j)))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I.\n           g j \\<in> aHom S (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom S S \\<and>\n               (\\<forall>j\\<in>I. compos S (g j) f = g j));\n        \\<forall>g'.\n           \\<forall>j\\<in>I.\n              g' j\n              \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                     (A j) \\<longrightarrow>\n              (\\<exists>!f.\n                  f \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                           S \\<and>\n                  (\\<forall>j\\<in>I.\n                      compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j)\n                       f =\n                      g' j))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule_tac x = \"ProjInd I A ff\" in spec,\n       thin_tac \"\\<forall>g'. \\<forall>j\\<in>I. g' j \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j) \\<longrightarrow>\n                     (\\<exists>!f. f \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S \\<and>\n                          (\\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) f =\n                                 g' j))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I.\n           g j \\<in> aHom S (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom S S \\<and>\n               (\\<forall>j\\<in>I. compos S (g j) f = g j));\n        \\<forall>j\\<in>I.\n           ProjInd I A ff j\n           \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                  (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S \\<and>\n               (\\<forall>j\\<in>I.\n                   compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) f =\n                   ProjInd I A ff j))\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (frule_tac f = ff in ProjInd_aHom1[of \"I\" \"A\" _ \"B\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff.\n       \\<lbrakk>I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I.\n           g j \\<in> aHom S (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom S S \\<and>\n               (\\<forall>j\\<in>I. compos S (g j) f = g j));\n        \\<forall>j\\<in>I.\n           ProjInd I A ff j\n           \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\n                  (A j) \\<longrightarrow>\n           (\\<exists>!f.\n               f \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S \\<and>\n               (\\<forall>j\\<in>I.\n                   compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) f =\n                   ProjInd I A ff j));\n        \\<forall>j\\<in>I.\n           ProjInd I A ff j\n           \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h.\n                            bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> h", "apply (simp add:nonempty_ex[of \"I\"],\n       rotate_tac -2,\n       frule ex1_implies_ex,\n       thin_tac \"\\<exists>!f. f \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S \\<and>\n         (\\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) f = ProjInd I A ff j)\",\n       rotate_tac -1, erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff x.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<exists>!f.\n           f \\<in> aHom S S \\<and>\n           (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        x \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) x =\n           ProjInd I A ff j\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (rename_tac ff h1,\n       frule_tac f = ff in map_family_triangle1[of \"I\" \"A\" _  \"B\" \"S\" \"g\"],\n           assumption+,\n       rotate_tac -1,\n       frule ex1_implies_ex,\n       thin_tac \"\\<exists>!h. h \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) \\<and>\n             (\\<forall>j\\<in>I. compos S (ProjInd I A ff j) h = g j)\",\n       rotate_tac -1,\n       erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 x.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<exists>!f.\n           f \\<in> aHom S S \\<and>\n           (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        x \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) x = g j\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (rename_tac ff h1 h2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<exists>!f.\n           f \\<in> aHom S S \\<and>\n           (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (frule_tac ff = ff and ?h1.0 = h1 and ?h2.0 = h2 in prod_triangle[of \"I\"\n        \"A\" \"S\" \"g\" _ \"B\"], assumption+,\n       frule_tac ?S1.0 = \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" in map_family_triangle3[of \"I\"\n                \"A\" \"S\" _ \"g\"],\n        assumption+,\n       frule_tac f = h2 and g = h1 and M =  \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" in\n                aHom_compos[of \"S\" _ \"S\" ], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<exists>!f.\n           f \\<in> aHom S S \\<and>\n           (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        \\<forall>j\\<in>I. compos S (g j) (compos S h1 h2) = g j;\n        compos S h1 h2 \\<in> aHom S S\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (erule ex1E)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        \\<forall>j\\<in>I. compos S (g j) (compos S h1 h2) = g j;\n        compos S h1 h2 \\<in> aHom S S;\n        f \\<in> aHom S S \\<and> (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        \\<forall>y.\n           y \\<in> aHom S S \\<and>\n           (\\<forall>j\\<in>I. compos S (g j) y = g j) \\<longrightarrow>\n           y = f\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (rotate_tac -1,\n        frule_tac x = \"compos S h1 h2\" in spec,\n        frule map_family_triangle4[of \"I\" \"A\" \"S\" \"g\"], assumption+,\n        frule aGroup.aI_aHom[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>y.\n                   y \\<in> aHom S S \\<and>\n                   (\\<forall>j\\<in>I.\n                       compos S (g j) y = g j) \\<longrightarrow>\n                   y = f;\n        \\<forall>j\\<in>I.\n           ProjInd I A ff j\n           \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        \\<forall>j\\<in>I.\n           compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 =\n           ProjInd I A ff j;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        \\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j;\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        \\<forall>j\\<in>I. compos S (g j) (compos S h1 h2) = g j;\n        compos S h1 h2 \\<in> aHom S S;\n        f \\<in> aHom S S \\<and> (\\<forall>j\\<in>I. compos S (g j) f = g j);\n        compos S h1 h2 \\<in> aHom S S \\<and>\n        (\\<forall>j\\<in>I.\n            compos S (g j) (compos S h1 h2) = g j) \\<longrightarrow>\n        compos S h1 h2 = f;\n        \\<forall>j\\<in>I. compos S (g j) aI\\<^bsub>S\\<^esub> = g j;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (frule_tac x = \"aI\\<^bsub>S\\<^esub>\" in spec,\n   thin_tac \"\\<forall>y. y \\<in> aHom S S \\<and> (\\<forall>j\\<in>I. compos S (g j) y = g j) \\<longrightarrow> y = f\",\n   simp,\n   thin_tac \"\\<forall>j\\<in>I. compos S (ProjInd I A ff j) h2 = g j\",\n   thin_tac \"\\<forall>j\\<in>I. compos S (g j) f = g j\",\n   thin_tac \"\\<forall>j\\<in>I. compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (g j) h1 = ProjInd I A ff j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        f \\<in> aHom S S; compos S h1 h2 = f;\n        aI\\<^bsub>S\\<^esub> = f\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (rotate_tac -1, frule sym, thin_tac \"aI\\<^bsub>S\\<^esub> = f\", simp,\n        frule_tac A = \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" and f = h1 and g = h2 in\n         compos_aI_inj[of _ \"S\"], assumption+,\n        frule_tac B = \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" and f = h2 and g = h1 in\n         compos_aI_surj[of \"S\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S;\n        compos S h1 h2 = aI\\<^bsub>S\\<^esub>; f = aI\\<^bsub>S\\<^esub>;\n        injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        surjec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n                       ff,S\\<^esub> h1\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (frule_tac f = ff in Ag_ind_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" _ \"B\"], assumption+,\n        frule_tac F = \"Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" and f = \"Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\" and g = h1\n           in compos_bijec[of \"a\\<Pi>\\<^bsub>I\\<^esub> A\" _ \"S\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S;\n        compos S h1 h2 = aI\\<^bsub>S\\<^esub>; f = aI\\<^bsub>S\\<^esub>;\n        injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        surjec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            ff\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<rbrakk>\n       \\<Longrightarrow> bijec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A)\n ff,S\\<^esub> h1\n 2. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S;\n        compos S h1 h2 = aI\\<^bsub>S\\<^esub>; f = aI\\<^bsub>S\\<^esub>;\n        injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        surjec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            ff\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> compos\n                      (a\\<Pi>\\<^bsub>I\\<^esub> A) h1\n                      (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (subst bijec_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S;\n        compos S h1 h2 = aI\\<^bsub>S\\<^esub>; f = aI\\<^bsub>S\\<^esub>;\n        injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        surjec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind\n            (a\\<Pi>\\<^bsub>I\\<^esub> A)\n            ff\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> compos\n                      (a\\<Pi>\\<^bsub>I\\<^esub> A) h1\n                      (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (thin_tac \"bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub> Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\",\n        thin_tac \"injec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1\",\n        thin_tac \"surjec\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff,S\\<^esub> h1\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>ff h1 h2 f.\n       \\<lbrakk>\\<forall>j\\<in>I.\n                   ProjInd I A ff j\n                   \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) (A j);\n        I \\<noteq> {}; \\<forall>j\\<in>I. aGroup (A j); aGroup S;\n        \\<forall>j\\<in>I. g j \\<in> aHom S (A j);\n        aGroup (a\\<Pi>\\<^bsub>I\\<^esub> A);\n        ff \\<in> carrier (a\\<Pi>\\<^bsub>I\\<^esub> A) \\<rightarrow> B;\n        bij_to ff (carrier (a\\<Pi>\\<^bsub>I\\<^esub> A)) B;\n        aGroup (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        h1 \\<in> aHom (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) S;\n        h2 \\<in> aHom S (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff);\n        compos (Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff) h2 h1 =\n        aI\\<^bsub>Ag_ind (a\\<Pi>\\<^bsub>I\\<^esub> A) ff\\<^esub>;\n        aI\\<^bsub>S\\<^esub> \\<in> aHom S S;\n        compos S h1 h2 = aI\\<^bsub>S\\<^esub>; f = aI\\<^bsub>S\\<^esub>;\n        bijec\\<^bsub>(a\\<Pi>\\<^bsub>I\\<^esub> A),S\\<^esub> compos\n                      (a\\<Pi>\\<^bsub>I\\<^esub> A) h1\n                      (Agii (a\\<Pi>\\<^bsub>I\\<^esub> A) ff)\\<rbrakk>\n       \\<Longrightarrow> Ex (bijec (a\\<Pi>\\<^bsub>I\\<^esub> A) S)", "apply (rule exI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(***  Note.\n                                     f\n                                  S' \\<rightarrow> S\n                                    \\   |\n                                 g' j\\  | g j\n                                      \\ |\n                                        A j\n\n       ***)"], ["", "chapter \"Ring theory\""], ["", "section \"Definition of a ring and an ideal\""], ["", "record 'a Ring = \"'a aGroup\" +\n  tp ::  \"['a, 'a ] \\<Rightarrow> 'a\" (infixl \"\\<cdot>\\<^sub>r\\<index>\" 70)\n  un :: \"'a\"   (\"1\\<^sub>r\\<index>\")"], ["", "locale Ring =\n fixes R (structure)\n\n assumes\n         pop_closed: \"pop R \\<in> carrier R \\<rightarrow> carrier R \\<rightarrow> carrier R\"\n and     pop_aassoc : \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n         (a \\<plusminus> b) \\<plusminus> c = a \\<plusminus> (b \\<plusminus> c)\"\n and     pop_commute:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow> a \\<plusminus> b = b \\<plusminus> a\"\n and     mop_closed:\"mop R \\<in> carrier R \\<rightarrow> carrier R\"\n and     l_m :\"a \\<in> carrier R \\<Longrightarrow>  (-\\<^sub>a a) \\<plusminus> a = \\<zero>\"\n and     ex_zero: \"\\<zero> \\<in> carrier R\"\n and     l_zero:\"a \\<in> carrier R \\<Longrightarrow> \\<zero> \\<plusminus> a = a\"\n and     tp_closed: \"tp R \\<in> carrier R \\<rightarrow> carrier R \\<rightarrow> carrier R\"\n and     tp_assoc : \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                  (a \\<cdot>\\<^sub>r b) \\<cdot>\\<^sub>r c = a \\<cdot>\\<^sub>r (b \\<cdot>\\<^sub>r c)\"\n and     tp_commute: \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow> a \\<cdot>\\<^sub>r b = b  \\<cdot>\\<^sub>r a\"\n and     un_closed: \"(1\\<^sub>r) \\<in> carrier R\"\n and     rg_distrib: \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                     a \\<cdot>\\<^sub>r (b \\<plusminus> c) = a \\<cdot>\\<^sub>r b  \\<plusminus>  a \\<cdot>\\<^sub>r c\"\n and     rg_l_unit: \"a \\<in> carrier R \\<Longrightarrow> (1\\<^sub>r) \\<cdot>\\<^sub>r a = a\""], ["", "definition\n  zeroring :: \"('a, 'more) Ring_scheme \\<Rightarrow> bool\" where\n  \"zeroring R \\<longleftrightarrow> Ring R \\<and> carrier R = {\\<zero>\\<^bsub>R\\<^esub>}\""], ["", "primrec nscal ::  \"('a, 'more) Ring_scheme  => 'a => nat  => 'a\"\nwhere\n  nscal_0:  \"nscal R x 0 = \\<zero>\\<^bsub>R\\<^esub>\"\n| nscal_suc:  \"nscal R x (Suc n) = (nscal R x n) \\<plusminus>\\<^bsub>R\\<^esub> x\""], ["", "primrec npow ::  \"('a, 'more) Ring_scheme  => 'a => nat  => 'a\"\nwhere\n  npow_0: \"npow R x 0 = 1\\<^sub>r\\<^bsub>R\\<^esub>\"\n| npow_suc: \"npow R x (Suc n) = (npow R x n) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\""], ["", "primrec nprod  :: \"('a, 'more) Ring_scheme => (nat => 'a) => nat => 'a\"\nwhere\n  nprod_0: \"nprod R f 0 = f 0\"\n| nprod_suc: \"nprod R f (Suc n) = (nprod R f n) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (f (Suc n))\""], ["", "primrec nsum :: \"('a, 'more) aGroup_scheme => (nat => 'a) => nat => 'a\"\nwhere\n  nsum_0: \"nsum R f 0 = f 0\"\n| nsum_suc: \"nsum R f (Suc n) = (nsum R f n) \\<plusminus>\\<^bsub>R\\<^esub> (f (Suc n))\""], ["", "abbreviation\n  NSCAL :: \"[nat, ('a, 'more) Ring_scheme, 'a] \\<Rightarrow> 'a\"\n    (\"(3 _ \\<times>\\<^bsub>_\\<^esub> _)\" [75,75,76]75) where\n  \"n \\<times>\\<^bsub>R\\<^esub> x == nscal R x n\""], ["", "abbreviation\n  NPOW :: \"['a, ('a, 'more) Ring_scheme, nat] \\<Rightarrow>  'a\"\n    (\"(3_^\\<^bsup>_ _\\<^esup>)\" [77,77,78]77) where\n  \"a^\\<^bsup>R n\\<^esup> == npow R a n\""], ["", "abbreviation\n  SUM :: \"('a, 'more) aGroup_scheme => (nat => 'a) => nat => 'a\"\n    (\"(3\\<Sigma>\\<^sub>e _ _ _)\" [85,85,86]85) where\n  \"\\<Sigma>\\<^sub>e G f n == nsum G f n\""], ["", "abbreviation\n  NPROD :: \"[('a, 'm) Ring_scheme, nat, nat \\<Rightarrow> 'a] \\<Rightarrow> 'a\"\n    (\"(3e\\<Pi>\\<^bsub>_,_\\<^esub> _)\" [98,98,99]98) where\n  \"e\\<Pi>\\<^bsub>R,n\\<^esub> f == nprod R f n\""], ["", "definition\n  fSum :: \"[_, (nat => 'a), nat, nat] \\<Rightarrow> 'a\" where\n  \"fSum A f n m = (if n \\<le> m then nsum A (cmp f (slide n))(m - n)\n                       else \\<zero>\\<^bsub>A\\<^esub>)\""], ["", "abbreviation\n  FSUM :: \"[('a, 'more) aGroup_scheme, (nat \\<Rightarrow> 'a), nat, nat] \\<Rightarrow> 'a\"\n    (\"(4\\<Sigma>\\<^sub>f _ _ _ _)\" [85,85,85,86]85) where\n  \"\\<Sigma>\\<^sub>f G f n m == fSum G f n m\""], ["", "lemma (in aGroup) nsum_zeroGTr:\"(\\<forall>j \\<le> n. f j = \\<zero>) \\<longrightarrow> nsum A f n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 = \\<zero>\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f n = \\<zero>;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n = \\<zero>", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n = \\<zero>;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (cut_tac ex_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n = \\<zero>;\n        \\<forall>j\\<le>Suc n. f j = \\<zero>;\n        \\<zero> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (simp add:l_zero[of \\<zero>])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_zeroA:\"\\<forall>j \\<le> n. f j = \\<zero> \\<Longrightarrow>   nsum A f n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. f j = \\<zero> \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (simp add:nsum_zeroGTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  sr :: \"[_ , 'a set] \\<Rightarrow> bool\" where\n  \"sr R S == S \\<subseteq> carrier R \\<and> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> S \\<and> (\\<forall>x\\<in>S. \\<forall>y \\<in> S. x  \\<plusminus>\\<^bsub>R\\<^esub> (-\\<^sub>a\\<^bsub>R\\<^esub> y) \\<in> S \\<and>\n               x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> S)\""], ["", "definition\n  Sr :: \"[_ , 'a set] \\<Rightarrow> _\" where\n  \"Sr R S = R \\<lparr>carrier := S, pop := \\<lambda>x\\<in>S. \\<lambda>y\\<in>S. x \\<plusminus>\\<^bsub>R\\<^esub> y, mop := \\<lambda>x\\<in>S. (-\\<^sub>a\\<^bsub>R\\<^esub> x),\n    zero := \\<zero>\\<^bsub>R\\<^esub>, tp := \\<lambda>x\\<in>S. \\<lambda>y\\<in>S. x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y, un := 1\\<^sub>r\\<^bsub>R\\<^esub> \\<rparr>\""], ["", "(** sr is a subring without ring structure, Sr is a subring with Ring structure\n     **)"], ["", "lemma (in Ring) Ring: \"Ring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring R", ".."], ["", "lemma (in Ring) ring_is_ag:\"aGroup R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R", "apply (rule aGroup.intro,\n       rule pop_closed,\n       rule pop_aassoc, assumption+,\n       rule pop_commute, assumption+,\n       rule mop_closed,\n       rule l_m, assumption,\n       rule ex_zero,\n       rule l_zero, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_zero:\"\\<zero> \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero> \\<in> carrier R", "by (simp add: ex_zero)"], ["", "lemma (in Ring) ring_one:\"1\\<^sub>r \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r \\<in> carrier R", "by (simp add:un_closed)"], ["", "lemma (in Ring) ring_tOp_closed:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                     x \\<cdot>\\<^sub>r y \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (cut_tac tp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     (\\<cdot>\\<^sub>r)\n     \\<in> carrier R \\<rightarrow>\n           carrier R \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (frule funcset_mem[of \"(\\<cdot>\\<^sub>r)\" \"carrier R\" \"carrier R \\<rightarrow> carrier R\"\n            \"x\"], assumption+,\n        thin_tac \"(\\<cdot>\\<^sub>r) \\<in> carrier R \\<rightarrow> carrier R \\<rightarrow> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     (\\<cdot>\\<^sub>r) x \\<in> carrier R \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (rule funcset_mem[of \"(\\<cdot>\\<^sub>r) x\" \"carrier R\" \"carrier R\" \"y\"],\n              assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_tOp_commute:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                x \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r x", "by (simp add:tp_commute)"], ["", "lemma (in Ring) ring_distrib1:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n                 \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) = x \\<cdot>\\<^sub>r y \\<plusminus> x \\<cdot>\\<^sub>r z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) =\n                      x \\<cdot>\\<^sub>r y \\<plusminus> x \\<cdot>\\<^sub>r z", "by (simp add:rg_distrib)"], ["", "lemma (in Ring) ring_distrib2:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n                \\<Longrightarrow> (y \\<plusminus> z) \\<cdot>\\<^sub>r x = y \\<cdot>\\<^sub>r x \\<plusminus>  z \\<cdot>\\<^sub>r x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (y \\<plusminus> z) \\<cdot>\\<^sub>r x =\n                      y \\<cdot>\\<^sub>r x \\<plusminus> z \\<cdot>\\<^sub>r x", "apply (subst tp_commute[of \"y \\<plusminus> z\" \"x\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> y \\<plusminus> z \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) =\n                      y \\<cdot>\\<^sub>r x \\<plusminus> z \\<cdot>\\<^sub>r x", "apply (cut_tac ring_is_ag, simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) =\n                      y \\<cdot>\\<^sub>r x \\<plusminus> z \\<cdot>\\<^sub>r x", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<plusminus> z) =\n                      y \\<cdot>\\<^sub>r x \\<plusminus> z \\<cdot>\\<^sub>r x", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<plusminus> x \\<cdot>\\<^sub>r z =\n                      y \\<cdot>\\<^sub>r x \\<plusminus> z \\<cdot>\\<^sub>r x", "apply (simp add:tp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_distrib3:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n      y \\<in> carrier R \\<rbrakk> \\<Longrightarrow> (a \\<plusminus> b) \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                                          a \\<cdot>\\<^sub>r x \\<plusminus> a \\<cdot>\\<^sub>r y \\<plusminus> b \\<cdot>\\<^sub>r x \\<plusminus> b \\<cdot>\\<^sub>r y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<plusminus> b) \\<cdot>\\<^sub>r\n                      (x \\<plusminus> y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply (subst ring_distrib2)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier R\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r (x \\<plusminus> y) \\<plusminus>\n                      b \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier R\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r (x \\<plusminus> y) \\<plusminus>\n                      b \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r (x \\<plusminus> y) \\<plusminus>\n                      b \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply ((subst ring_distrib1)+, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r (x \\<plusminus> y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      (b \\<cdot>\\<^sub>r x \\<plusminus>\n                       b \\<cdot>\\<^sub>r y) =\n                      a \\<cdot>\\<^sub>r x \\<plusminus>\n                      a \\<cdot>\\<^sub>r y \\<plusminus>\n                      b \\<cdot>\\<^sub>r x \\<plusminus>\n                      b \\<cdot>\\<^sub>r y", "apply (rule pop_aassoc [THEN sym, of \"a \\<cdot>\\<^sub>r x \\<plusminus> a \\<cdot>\\<^sub>r y\" \"b \\<cdot>\\<^sub>r x\" \"b \\<cdot>\\<^sub>r y\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r x \\<plusminus> a \\<cdot>\\<^sub>r y\n                      \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<cdot>\\<^sub>r x \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (cut_tac ring_is_ag, rule aGroup.ag_pOp_closed, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r x \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r y \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<cdot>\\<^sub>r x \\<in> carrier R\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<cdot>\\<^sub>r y \\<in> carrier R", "apply (simp add:ring_tOp_closed)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) rEQMulR:\n  \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R; x = y \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r z = y \\<cdot>\\<^sub>r z\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R;\n     x = y\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r z = y \\<cdot>\\<^sub>r z", "by simp"], ["", "lemma (in Ring) ring_tOp_assoc:\"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R \\<rbrakk>\n \\<Longrightarrow> (x \\<cdot>\\<^sub>r y) \\<cdot>\\<^sub>r z = x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =\n                      x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)", "by (simp add:tp_assoc)"], ["", "lemma (in Ring) ring_l_one:\"x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x = x", "by (simp add:rg_l_unit)"], ["", "lemma (in Ring) ring_r_one:\"x \\<in> carrier R  \\<Longrightarrow> x \\<cdot>\\<^sub>r 1\\<^sub>r = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> x \\<cdot>\\<^sub>r 1\\<^sub>r = x", "apply (subst ring_tOp_commute, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x = x", "apply (simp add:un_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x = x", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_times_0_x:\"x \\<in> carrier R \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (frule ring_distrib2 [of \"x\" \"\\<zero>\" \"\\<zero>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     (\\<zero> \\<plusminus> \\<zero>) \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus>\n     \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (simp add:aGroup.ag_l_zero [of \"R\" \"\\<zero>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus>\n     \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (frule ring_tOp_closed [of \"\\<zero>\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus> \\<zero> \\<cdot>\\<^sub>r x;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (frule sym, thin_tac \"\\<zero> \\<cdot>\\<^sub>r x = \\<zero> \\<cdot>\\<^sub>r x \\<plusminus> \\<zero> \\<cdot>\\<^sub>r x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus> \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (frule aGroup.ag_eq_sol2 [of \"R\" \"\\<zero> \\<cdot>\\<^sub>r x\" \"\\<zero> \\<cdot>\\<^sub>r x\" \"\\<zero> \\<cdot>\\<^sub>r x\"],\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus> \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x;\n     \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus>\n     -\\<^sub>a \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (thin_tac \"\\<zero> \\<cdot>\\<^sub>r x \\<plusminus> \\<zero> \\<cdot>\\<^sub>r x = \\<zero> \\<cdot>\\<^sub>r x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R; \\<zero> \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> carrier R;\n     \\<zero> \\<cdot>\\<^sub>r x =\n     \\<zero> \\<cdot>\\<^sub>r x \\<plusminus>\n     -\\<^sub>a \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_times_x_0:\"x \\<in> carrier R \\<Longrightarrow>  x \\<cdot>\\<^sub>r \\<zero> = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<zero> = \\<zero>", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<zero> = \\<zero>", "apply (subst ring_tOp_commute, assumption+, simp add:ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r x = \\<zero>", "apply (simp add:ring_times_0_x)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) rMulZeroDiv:\n     \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R; x = \\<zero> \\<or> y = \\<zero> \\<rbrakk> \\<Longrightarrow> x  \\<cdot>\\<^sub>r  y = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x = \\<zero> \\<or> y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = \\<zero>", "apply (erule disjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<zero> \\<in> carrier R; y \\<in> carrier R;\n     x = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<cdot>\\<^sub>r y = \\<zero>\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = \\<zero>", "apply (rule ring_times_0_x, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = \\<zero>", "apply (simp, rule ring_times_x_0, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_inv1:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      -\\<^sub>a (a \\<cdot>\\<^sub>r b) = (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and> -\\<^sub>a (a \\<cdot>\\<^sub>r b) = a \\<cdot>\\<^sub>r (-\\<^sub>a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_distrib2 [THEN sym, of \"b\" \"a\" \"-\\<^sub>a a\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     (a \\<plusminus> -\\<^sub>a a) \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed [of \"R\" \"a\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     (a \\<plusminus> -\\<^sub>a a) \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:aGroup.ag_r_inv1 [of \"R\" \"a\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero> \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:ring_times_0_x)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed [of \"R\" \"a\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_tOp_closed [of \"a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_tOp_closed [of \"-\\<^sub>a a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_eq_sol1 [of \"R\" \"a \\<cdot>\\<^sub>r b\" \"(-\\<^sub>a a) \\<cdot>\\<^sub>r b\" \"\\<zero>\"],\n           assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n                      \\<zero>\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (rule ring_zero, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     \\<zero>;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (thin_tac \"a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a a) \\<cdot>\\<^sub>r b = \\<zero>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule sym)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero>;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (thin_tac \"(-\\<^sub>a a) \\<cdot>\\<^sub>r b = -\\<^sub>a (a \\<cdot>\\<^sub>r b) \\<plusminus> \\<zero>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed [of \"R\" \" a \\<cdot>\\<^sub>r b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     (-\\<^sub>a a) \\<cdot>\\<^sub>r b;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_distrib1 [THEN sym, of \"a\" \"b\" \"-\\<^sub>a b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a b \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     a \\<cdot>\\<^sub>r (b \\<plusminus> -\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:aGroup.ag_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     a \\<cdot>\\<^sub>r (b \\<plusminus> -\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:aGroup.ag_r_inv1 [of \"R\" \"b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     a \\<cdot>\\<^sub>r \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed [of \"R\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_tOp_closed [of \"a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_tOp_closed [of \"a\" \"-\\<^sub>a b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_eq_sol1 [THEN sym, of \"R\" \"a \\<cdot>\\<^sub>r b\" \"a \\<cdot>\\<^sub>r (-\\<^sub>a b)\" \"\\<zero>\"],\n                                                      assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n                      \\<zero>\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:ring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n                      \\<zero>\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed [of \"R\" \" a \\<cdot>\\<^sub>r b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<cdot>\\<^sub>r b \\<plusminus> a \\<cdot>\\<^sub>r (-\\<^sub>a b) =\n     \\<zero>;\n     -\\<^sub>a b \\<in> carrier R; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b) \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b);\n     -\\<^sub>a a \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_inv1_1:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      -\\<^sub>a (a \\<cdot>\\<^sub>r b) = (-\\<^sub>a a) \\<cdot>\\<^sub>r b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r b", "apply (simp add:ring_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_inv1_2:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n                                -\\<^sub>a (a \\<cdot>\\<^sub>r b) = a \\<cdot>\\<^sub>r (-\\<^sub>a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule ring_inv1 [of \"a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b = (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and>\n     -\\<^sub>a a \\<cdot>\\<^sub>r b =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule conjunct2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b = (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and>\n     -\\<^sub>a a \\<cdot>\\<^sub>r b = a \\<cdot>\\<^sub>r (-\\<^sub>a b);\n     -\\<^sub>a a \\<cdot>\\<^sub>r b =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (thin_tac \"-\\<^sub>a a \\<cdot>\\<^sub>r b = (-\\<^sub>a a) \\<cdot>\\<^sub>r b \\<and> -\\<^sub>a (a \\<cdot>\\<^sub>r b) = a \\<cdot>\\<^sub>r (-\\<^sub>a b)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a \\<cdot>\\<^sub>r b =\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_times_minusl:\"a \\<in> carrier R \\<Longrightarrow>  -\\<^sub>a a = (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    -\\<^sub>a a = (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a = (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a", "apply (frule ring_inv1_1[of \"1\\<^sub>r\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     -\\<^sub>a 1\\<^sub>r \\<cdot>\\<^sub>r a =\n     (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a = (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r a", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_times_minusr:\"a \\<in> carrier R \\<Longrightarrow>  -\\<^sub>a a = a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    -\\<^sub>a a = a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a = a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)", "apply (frule ring_inv1_2[of \"a\" \"1\\<^sub>r\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r 1\\<^sub>r =\n     a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a a = a \\<cdot>\\<^sub>r (-\\<^sub>a 1\\<^sub>r)", "apply (simp add:ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_inv1_3:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                           a \\<cdot>\\<^sub>r b = (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (subst  aGroup.ag_inv_inv[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a (-\\<^sub>a a)) \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (frule aGroup.ag_mOp_closed[of \"R\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a (-\\<^sub>a a)) \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (subst ring_inv1_1[THEN sym, of \"-\\<^sub>a a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     -\\<^sub>a a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a a) \\<cdot>\\<^sub>r b =\n                      (-\\<^sub>a a) \\<cdot>\\<^sub>r (-\\<^sub>a b)", "apply (subst ring_inv1_2[of \"-\\<^sub>a a\" \"b\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ring_distrib4:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n                                x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n      a \\<cdot>\\<^sub>r b \\<plusminus> (-\\<^sub>a x \\<cdot>\\<^sub>r y) = a \\<cdot>\\<^sub>r (b \\<plusminus> (-\\<^sub>a y)) \\<plusminus> (a \\<plusminus> (-\\<^sub>a x)) \\<cdot>\\<^sub>r y\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r\n                      (b \\<plusminus> -\\<^sub>a y) \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r\n                      (b \\<plusminus> -\\<^sub>a y) \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (subst ring_distrib2, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                      (a \\<cdot>\\<^sub>r y \\<plusminus>\n                       (-\\<^sub>a x) \\<cdot>\\<^sub>r y)", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                      (a \\<cdot>\\<^sub>r y \\<plusminus>\n                       (-\\<^sub>a x) \\<cdot>\\<^sub>r y)", "apply (subst aGroup.pOp_assocTr43, assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r y \\<in> carrier R\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a x) \\<cdot>\\<^sub>r y \\<in> carrier R\n 5. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule ring_tOp_closed, assumption+)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r y \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a x) \\<cdot>\\<^sub>r y \\<in> carrier R\n 4. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a x) \\<cdot>\\<^sub>r y \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (-\\<^sub>a x) \\<cdot>\\<^sub>r y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule ring_tOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (simp add:aGroup.ag_mOp_closed)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (a \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<plusminus>\n                       a \\<cdot>\\<^sub>r y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (subst ring_distrib1 [THEN sym, of \"a\" _], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a y \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r\n                      (-\\<^sub>a y \\<plusminus> y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r\n                      (-\\<^sub>a y \\<plusminus> y) \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (simp add:aGroup.ag_l_inv1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      a \\<cdot>\\<^sub>r \\<zero> \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus> \\<zero> \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (subst aGroup.ag_r_zero, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; x \\<in> carrier R;\n     y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<plusminus>\n                      -\\<^sub>a x \\<cdot>\\<^sub>r y =\n                      a \\<cdot>\\<^sub>r b \\<plusminus>\n                      (-\\<^sub>a x) \\<cdot>\\<^sub>r y", "apply (simp add: ring_inv1_1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) rMulLC:\n     \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; z \\<in> carrier R\\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z) = y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z) =\n                      y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)", "apply (subst ring_tOp_assoc [THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =\n                      y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)", "apply (subst ring_tOp_commute [of \"x\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> y \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r z =\n                      y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)", "apply (subst ring_tOp_assoc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     z \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z) =\n                      y \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r z)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Zero_ring:\"1\\<^sub>r = \\<zero> \\<Longrightarrow> zeroring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow> zeroring R", "apply (simp add:zeroring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow>\n    Ring R \\<and> carrier R = {\\<zero>}", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow> Ring R\n 2. 1\\<^sub>r = \\<zero> \\<Longrightarrow> carrier R = {\\<zero>}", "apply (rule Ring_axioms)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow> carrier R = {\\<zero>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow> carrier R \\<subseteq> {\\<zero>}\n 2. 1\\<^sub>r = \\<zero> \\<Longrightarrow> {\\<zero>} \\<subseteq> carrier R", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>1\\<^sub>r = \\<zero>; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {\\<zero>}\n 2. 1\\<^sub>r = \\<zero> \\<Longrightarrow> {\\<zero>} \\<subseteq> carrier R", "apply (frule_tac x = x in ring_r_one, simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r = \\<zero> \\<Longrightarrow> {\\<zero>} \\<subseteq> carrier R", "apply (simp add:ring_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Zero_ring1:\"\\<not> (zeroring R) \\<Longrightarrow>  1\\<^sub>r \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> zeroring R \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+,\n       cut_tac Zero_ring, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Sr_one:\"sr R S \\<Longrightarrow> 1\\<^sub>r \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sr R S \\<Longrightarrow> 1\\<^sub>r \\<in> S", "apply (simp add:sr_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Sr_zero:\"sr R S \\<Longrightarrow> \\<zero> \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sr R S \\<Longrightarrow> \\<zero> \\<in> S", "apply (cut_tac ring_is_ag, frule Sr_one[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R; 1\\<^sub>r \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> S", "apply (simp add:sr_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S \\<subseteq> carrier R \\<and>\n             (\\<forall>x\\<in>S.\n                 \\<forall>y\\<in>S.\n                    x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n                    x \\<cdot>\\<^sub>r y \\<in> S);\n     aGroup R; 1\\<^sub>r \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> S", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup R; 1\\<^sub>r \\<in> S; S \\<subseteq> carrier R;\n     \\<forall>x\\<in>S.\n        \\<forall>y\\<in>S.\n           x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n           x \\<cdot>\\<^sub>r y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> S", "apply (frule_tac x = \"1\\<^sub>r\" in bspec, assumption,\n       thin_tac \"\\<forall>x\\<in>S. \\<forall>y\\<in>S. x \\<plusminus> -\\<^sub>a y \\<in> S \\<and> x \\<cdot>\\<^sub>r y \\<in> S\",\n       frule_tac x = \"1\\<^sub>r\" in bspec, assumption,\n       thin_tac \"\\<forall>y\\<in>S. 1\\<^sub>r \\<plusminus> -\\<^sub>a y \\<in> S \\<and> 1\\<^sub>r \\<cdot>\\<^sub>r y \\<in> S\",\n       erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>aGroup R; 1\\<^sub>r \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<plusminus> -\\<^sub>a 1\\<^sub>r \\<in> S;\n     1\\<^sub>r \\<cdot>\\<^sub>r 1\\<^sub>r \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> S", "apply (cut_tac ring_one,\n       simp add:aGroup.ag_r_inv1[of \"R\" \"1\\<^sub>r\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Sr_mOp_closed:\"\\<lbrakk>sr R S; x \\<in> S\\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; x \\<in> S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (frule Sr_zero[of \"S\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; x \\<in> S; \\<zero> \\<in> S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (simp add:sr_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; \\<zero> \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<in> S;\n     \\<forall>x\\<in>S.\n        \\<forall>y\\<in>S.\n           x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n           x \\<cdot>\\<^sub>r y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; \\<zero> \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<in> S;\n     \\<forall>x\\<in>S.\n        \\<forall>y\\<in>S.\n           x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n           x \\<cdot>\\<^sub>r y \\<in> S;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (frule_tac x = \"\\<zero>\" in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>S. \\<forall>y\\<in>S. x \\<plusminus> -\\<^sub>a y \\<in> S \\<and> x \\<cdot>\\<^sub>r y \\<in> S\",\n        frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>S. \\<zero> \\<plusminus> -\\<^sub>a y \\<in> S \\<and> \\<zero> \\<cdot>\\<^sub>r y \\<in> S\", erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; \\<zero> \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<in> S; aGroup R; \\<zero> \\<plusminus> -\\<^sub>a x \\<in> S;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> S\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (frule subsetD[of \"S\" \"carrier R\" \"\\<zero>\"], assumption+,\n        frule subsetD[of \"S\" \"carrier R\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; \\<zero> \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<in> S; aGroup R; \\<zero> \\<plusminus> -\\<^sub>a x \\<in> S;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> S; \\<zero> \\<in> carrier R;\n     x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (frule aGroup.ag_mOp_closed [of \"R\" \"x\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; \\<zero> \\<in> S; S \\<subseteq> carrier R;\n     1\\<^sub>r \\<in> S; aGroup R; \\<zero> \\<plusminus> -\\<^sub>a x \\<in> S;\n     \\<zero> \\<cdot>\\<^sub>r x \\<in> S; \\<zero> \\<in> carrier R;\n     x \\<in> carrier R; -\\<^sub>a x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> S", "apply (simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Sr_pOp_closed:\"\\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk> \\<Longrightarrow> x \\<plusminus> y \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (frule Sr_mOp_closed[of \"S\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; x \\<in> S; y \\<in> S; -\\<^sub>a y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (unfold sr_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; y \\<in> S; -\\<^sub>a y \\<in> S;\n     S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n     \\<forall>x\\<in>S.\n        \\<forall>y\\<in>S.\n           x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n           x \\<cdot>\\<^sub>r y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>S. \\<forall>y\\<in>S. x \\<plusminus> -\\<^sub>a y \\<in> S \\<and> x \\<cdot>\\<^sub>r y \\<in> S\",\n        frule_tac x = \"-\\<^sub>a y\" in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>S. x \\<plusminus> -\\<^sub>a y \\<in> S \\<and> x \\<cdot>\\<^sub>r y \\<in> S\", erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; y \\<in> S; -\\<^sub>a y \\<in> S;\n     S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n     x \\<plusminus> -\\<^sub>a (-\\<^sub>a y) \\<in> S;\n     x \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<in> S\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (cut_tac ring_is_ag )"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; y \\<in> S; -\\<^sub>a y \\<in> S;\n     S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n     x \\<plusminus> -\\<^sub>a (-\\<^sub>a y) \\<in> S;\n     x \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<in> S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (frule subsetD[of \"S\" \"carrier R\" \"y\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> S; y \\<in> S; -\\<^sub>a y \\<in> S;\n     S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n     x \\<plusminus> -\\<^sub>a (-\\<^sub>a y) \\<in> S;\n     x \\<cdot>\\<^sub>r (-\\<^sub>a y) \\<in> S; aGroup R;\n     y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> S", "apply (simp add:aGroup.ag_inv_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Sr_tOp_closed:\"\\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; x \\<in> S; y \\<in> S\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<in> S", "by (simp add:sr_def)"], ["", "lemma (in Ring) Sr_ring:\"sr R S \\<Longrightarrow> Ring (Sr R S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. sr R S \\<Longrightarrow> Ring (Sr R S)", "apply (simp add:Ring_def [of \"Sr R S\"],\n       cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow> carrier (Sr R S)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def Sr_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Sr R S) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                 a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                 b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                 c =\n                                 a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c)))\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> carrier (Sr R S);\n        b \\<in> carrier (Sr R S); c \\<in> carrier (Sr R S)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def,\n        frule_tac x = a and y = b in Sr_pOp_closed, assumption+,\n        frule_tac x = b and y = c in Sr_pOp_closed, assumption+,\n        simp add:Sr_def sr_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>aGroup R; a \\<in> S; b \\<in> S; c \\<in> S;\n        a \\<plusminus> b \\<in> S; b \\<plusminus> c \\<in> S;\n        S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n        \\<forall>x\\<in>S.\n           \\<forall>y\\<in>S.\n              x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n              x \\<cdot>\\<^sub>r y \\<in> S\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c =\n                         a \\<plusminus> (b \\<plusminus> c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n        frule_tac c = b in subsetD[of \"S\" \"carrier R\"], assumption+,\n        frule_tac c = c in subsetD[of \"S\" \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>aGroup R; a \\<in> S; b \\<in> S; c \\<in> S;\n        a \\<plusminus> b \\<in> S; b \\<plusminus> c \\<in> S;\n        S \\<subseteq> carrier R; 1\\<^sub>r \\<in> S;\n        \\<forall>x\\<in>S.\n           \\<forall>y\\<in>S.\n              x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n              x \\<cdot>\\<^sub>r y \\<in> S;\n        a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b \\<plusminus> c =\n                         a \\<plusminus> (b \\<plusminus> c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.ag_pOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Sr R S) \\<longrightarrow>\n                             a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                             b \\<plusminus>\\<^bsub>Sr R S\\<^esub> a)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> carrier (Sr R S);\n        b \\<in> carrier (Sr R S)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Sr R S\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>Sr R S\\<^esub> a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def sr_def, (erule conjE)+,\n        frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n        frule_tac c = b in subsetD[of \"S\" \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>aGroup R; a \\<in> S; b \\<in> S; S \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> S;\n        \\<forall>x\\<in>S.\n           \\<forall>y\\<in>S.\n              x \\<plusminus> -\\<^sub>a y \\<in> S \\<and>\n              x \\<cdot>\\<^sub>r y \\<in> S;\n        a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> b = b \\<plusminus> a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> mop (Sr R S)\n                      \\<in> carrier (Sr R S) \\<rightarrow> carrier (Sr R S)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply ((subst Sr_def)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> restrict (mop R) S \\<in> S \\<rightarrow> S\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_mOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>Sr R S\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>Sr R S\\<^esub>\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         -\\<^sub>a\\<^bsub>Sr R S\\<^esub> a \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>Sr R S\\<^esub>\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply ((subst Sr_def)+, simp add:Sr_mOp_closed, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a a \\<plusminus> a = \\<zero>\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n         simp add:aGroup.ag_l_inv1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>Sr R S\\<^esub> \\<in> carrier (Sr R S)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def Sr_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         \\<zero>\\<^bsub>Sr R S\\<^esub> \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule allI, simp add:Sr_def Sr_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n       \\<Longrightarrow> a \\<in> S \\<longrightarrow>\n                         \\<zero> \\<plusminus> a = a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> a = a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n         simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>)\n                      \\<in> carrier (Sr R S) \\<rightarrow>\n                            carrier (Sr R S) \\<rightarrow> carrier (Sr R S)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def Sr_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Sr R S) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                 b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                 c =\n                                 a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                 (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c)))\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> carrier (Sr R S);\n        b \\<in> carrier (Sr R S); c \\<in> carrier (Sr R S)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def Sr_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; b \\<in> S; c \\<in> S\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<cdot>\\<^sub>r c =\n                         a \\<cdot>\\<^sub>r (b \\<cdot>\\<^sub>r c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n         frule_tac c = b in subsetD[of \"S\" \"carrier R\"], assumption+,\n         frule_tac c = c in subsetD[of \"S\" \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; b \\<in> S; c \\<in> S;\n        S \\<subseteq> carrier R; a \\<in> carrier R; b \\<in> carrier R;\n        c \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<cdot>\\<^sub>r c =\n                         a \\<cdot>\\<^sub>r (b \\<cdot>\\<^sub>r c)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Sr R S) \\<longrightarrow>\n                             a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> b =\n                             b \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> a)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply ((rule allI, rule impI)+, simp add:Sr_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; b \\<in> S\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r b = b \\<cdot>\\<^sub>r a\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n         frule_tac c = b in subsetD[of \"S\" \"carrier R\"], assumption+,\n         simp add:ring_tOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                      \\<in> carrier (Sr R S) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<in> carrier (Sr R S)\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (simp add:Sr_def Sr_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier (Sr R S) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (Sr R S) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier (Sr R S) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier (Sr R S) \\<longrightarrow>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>Sr R S\\<^esub> c) =\n                                 a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                                 b \\<plusminus>\\<^bsub>Sr R S\\<^esub>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub> c))\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a", "apply (simp add:Sr_def Sr_pOp_closed Sr_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> S \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> S \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> S \\<longrightarrow>\n                                 a \\<cdot>\\<^sub>r (b \\<plusminus> c) =\n                                 a \\<cdot>\\<^sub>r b \\<plusminus>\n                                 a \\<cdot>\\<^sub>r c))\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; b \\<in> S; c \\<in> S\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r (b \\<plusminus> c) =\n                         a \\<cdot>\\<^sub>r b \\<plusminus>\n                         a \\<cdot>\\<^sub>r c\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+,\n         frule_tac c = b in subsetD[of \"S\" \"carrier R\"], assumption+,\n         frule_tac c = c in subsetD[of \"S\" \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; b \\<in> S; c \\<in> S;\n        S \\<subseteq> carrier R; a \\<in> carrier R; b \\<in> carrier R;\n        c \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r (b \\<plusminus> c) =\n                         a \\<cdot>\\<^sub>r b \\<plusminus>\n                         a \\<cdot>\\<^sub>r c\n 2. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a", "apply (simp add:ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (Sr R S) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>Sr R S\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Sr R S\\<^esub>\n                         a =\n                         a", "apply (simp add:Sr_def Sr_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>sr R S; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> S \\<longrightarrow>\n                         1\\<^sub>r \\<cdot>\\<^sub>r a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a = a", "apply (unfold sr_def, frule conjunct1, fold sr_def,\n         frule_tac c = a in subsetD[of \"S\" \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>sr R S; aGroup R; a \\<in> S; S \\<subseteq> carrier R;\n        a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a = a", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Calculation of elements\""], ["", "(** The author of this part is L. Chen, revised by H. Murao and Y.\n     Santo  **)"], ["", "subsection \"nscale\""], ["", "lemma (in Ring) ring_tOp_rel:\"\\<lbrakk>x\\<in>carrier R; xa\\<in>carrier R; y\\<in>carrier R;\nya \\<in> carrier R \\<rbrakk> \\<Longrightarrow> (x \\<cdot>\\<^sub>r xa) \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r ya) = (x \\<cdot>\\<^sub>r y) \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r ya)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; xa \\<in> carrier R; y \\<in> carrier R;\n     ya \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<cdot>\\<^sub>r\n                      (y \\<cdot>\\<^sub>r ya) =\n                      x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r\n                      (xa \\<cdot>\\<^sub>r ya)", "apply (frule ring_tOp_closed[of \"y\" \"ya\"], assumption+,\n       simp add:ring_tOp_assoc[of \"x\" \"xa\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; xa \\<in> carrier R; y \\<in> carrier R;\n     ya \\<in> carrier R; y \\<cdot>\\<^sub>r ya \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      (xa \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r ya)) =\n                      x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r\n                      (xa \\<cdot>\\<^sub>r ya)", "apply (simp add:ring_tOp_assoc[THEN sym, of \"xa\" \"y\" \"ya\"],\n       simp add:ring_tOp_commute[of \"xa\" \"y\"],\n       simp add:ring_tOp_assoc[of \"y\" \"xa\" \"ya\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; xa \\<in> carrier R; y \\<in> carrier R;\n     ya \\<in> carrier R; y \\<cdot>\\<^sub>r ya \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      (y \\<cdot>\\<^sub>r (xa \\<cdot>\\<^sub>r ya)) =\n                      x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r\n                      (xa \\<cdot>\\<^sub>r ya)", "apply (frule ring_tOp_closed[of \"xa\" \"ya\"], assumption+,\n       simp add:ring_tOp_assoc[THEN sym, of \"x\" \"y\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsClose:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R \\<rbrakk>  \\<Longrightarrow> nscal R x n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n        n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n        0 \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n         na \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  Suc na \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R", "apply (simp add:ring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n         na \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  Suc na \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R", "apply (cut_tac ring_is_ag, simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsZero:\n             \"nscal R \\<zero> n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1.  n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow>\n     n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow>\n     0 \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow>  Suc n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow>  Suc n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> \\<zero> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (cut_tac ring_zero, simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsZeroI: \"\\<And> n.  x = \\<zero>  \\<Longrightarrow> nscal R x n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       x = \\<zero> \\<Longrightarrow>\n        n \\<times>\\<^bsub>R\\<^esub> x = \\<zero>", "by (simp only:nsZero)"], ["", "lemma (in Ring) nsEqElm:  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R; x = y \\<rbrakk>\n        \\<Longrightarrow> (nscal R x n) = (nscal R y n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x = y\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x =\n                       n \\<times>\\<^bsub>R\\<^esub> y", "by simp"], ["", "lemma (in Ring) nsDistr:  \"x \\<in> carrier R\n        \\<Longrightarrow> (nscal R x n) \\<plusminus> (nscal R x m) = nscal R x (n + m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow>\n     n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n     m \\<times>\\<^bsub>R\\<^esub> x =\n     (n + m) \\<times>\\<^bsub>R\\<^esub> x", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                       m \\<times>\\<^bsub>R\\<^esub> x =\n                       (n + m) \\<times>\\<^bsub>R\\<^esub> x", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                       0 \\<times>\\<^bsub>R\\<^esub> x =\n                       (n + 0) \\<times>\\<^bsub>R\\<^esub> x\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc na \\<times>\\<^bsub>R\\<^esub> x =\n                          (n + Suc na) \\<times>\\<^bsub>R\\<^esub> x", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus> \\<zero> =\n                       n \\<times>\\<^bsub>R\\<^esub> x\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc na \\<times>\\<^bsub>R\\<^esub> x =\n                          (n + Suc na) \\<times>\\<^bsub>R\\<^esub> x", "apply (frule nsClose[of \"x\" \"n\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; aGroup R;\n      n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus> \\<zero> =\n                       n \\<times>\\<^bsub>R\\<^esub> x\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc na \\<times>\\<^bsub>R\\<^esub> x =\n                          (n + Suc na) \\<times>\\<^bsub>R\\<^esub> x", "apply ( simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc na \\<times>\\<^bsub>R\\<^esub> x =\n                          (n + Suc na) \\<times>\\<^bsub>R\\<^esub> x", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         ( na \\<times>\\<^bsub>R\\<^esub> x \\<plusminus> x) =\n                          (n + na) \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         x", "apply (frule_tac x = x and n = n in nsClose,\n         frule_tac x = x and n = na in nsClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         na \\<times>\\<^bsub>R\\<^esub> x =\n         (n + na) \\<times>\\<^bsub>R\\<^esub> x;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         na \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         ( na \\<times>\\<^bsub>R\\<^esub> x \\<plusminus> x) =\n                          (n + na) \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         x", "apply (subst aGroup.ag_pOp_assoc[THEN sym], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsDistrL:  \"\\<lbrakk>x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> (nscal R x n) \\<plusminus> (nscal R y n) = nscal R (x \\<plusminus> y) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                       n \\<times>\\<^bsub>R\\<^esub> y =\n                       n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                       n \\<times>\\<^bsub>R\\<^esub> y =\n                       n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow>  0 \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                       0 \\<times>\\<^bsub>R\\<^esub> y =\n                       0 \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)\\<rbrakk>\n       \\<Longrightarrow>  Suc n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)\\<rbrakk>\n       \\<Longrightarrow>  Suc n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)", "apply (cut_tac ring_zero,\n         simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)\\<rbrakk>\n       \\<Longrightarrow>  Suc n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y)\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         x \\<plusminus>\n                         ( n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> y) =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply (frule_tac x = x and n = n in nsClose,\n         frule_tac x = y and n = n in nsClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y);\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         x \\<plusminus>\n                         ( n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> y) =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply (subst aGroup.pOp_assocTr43[of R _ x _ y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y);\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         (x \\<plusminus>\n                           n \\<times>\\<^bsub>R\\<^esub> y) \\<plusminus>\n                         y =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply (frule_tac x = x and y = \"n \\<times>\\<^bsub>R\\<^esub> y\" in aGroup.ag_pOp_commute[of \"R\"],\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y);\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         (x \\<plusminus>\n                           n \\<times>\\<^bsub>R\\<^esub> y) \\<plusminus>\n                         y =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y);\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                         ( n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus>\n                          x) \\<plusminus>\n                         y =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply (subst aGroup.pOp_assocTr43[THEN sym, of R _ _ x y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n         n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n         n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus> y);\n         n \\<times>\\<^bsub>R\\<^esub> x \\<in> carrier R;\n         n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        x \\<plusminus>  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> x\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> x \\<plusminus>\n                          n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus>\n                         (x \\<plusminus> y) =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<plusminus>\n                 y) \\<plusminus>\n                         (x \\<plusminus> y)", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsMulDistrL:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nscal R y n) = nscal R (x \\<cdot>\\<^sub>r y) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n                       n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r  0 \\<times>\\<^bsub>R\\<^esub> y =\n                       0 \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                     y)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<zero> = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                     y)", "apply (simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                          Suc n \\<times>\\<^bsub>R\\<^esub> y =\n                          Suc n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                     y)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         ( n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus> y) =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                 y) \\<plusminus>\n                         x \\<cdot>\\<^sub>r y", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> y \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier R\n 3. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                          n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus>\n                         x \\<cdot>\\<^sub>r y =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                 y) \\<plusminus>\n                         x \\<cdot>\\<^sub>r y", "apply (rule nsClose, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r  n \\<times>\\<^bsub>R\\<^esub> y =\n         n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                          n \\<times>\\<^bsub>R\\<^esub> y \\<plusminus>\n                         x \\<cdot>\\<^sub>r y =\n                          n \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                 y) \\<plusminus>\n                         x \\<cdot>\\<^sub>r y", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsMulDistrR:\"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n        \\<Longrightarrow> (nscal R y n) \\<cdot>\\<^sub>r x = nscal R (y \\<cdot>\\<^sub>r x) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow>  n \\<times>\\<^bsub>R\\<^esub> y \\<cdot>\\<^sub>r x =\n                       n \\<times>\\<^bsub>R\\<^esub> (y \\<cdot>\\<^sub>r x)", "apply (frule_tac x = y and n = n in nsClose,\n         simp add:ring_tOp_commute[of \"n \\<times>\\<^bsub>R\\<^esub> y\" \"x\"],\n         simp add:nsMulDistrL,\n         simp add:ring_tOp_commute[of \"y\" \"x\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"npow\""], ["", "lemma (in Ring) npClose:\"x \\<in> carrier R \\<Longrightarrow> npow R x n \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier R \\<Longrightarrow>\n    x^\\<^bsup>R n\\<^esup> \\<in> carrier R", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. x \\<in> carrier R \\<Longrightarrow>\n    x^\\<^bsup>R 0\\<^esup> \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. x \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R", "apply (simp add:ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x\n                         \\<in> carrier R", "apply (rule ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npMulDistr:\"\\<And> n m. x \\<in> carrier R  \\<Longrightarrow>\n                 (npow R x n) \\<cdot>\\<^sub>r (npow R x m) = npow R x (n + m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R m\\<^esup> =\n       x^\\<^bsup>R (n + m)\\<^esup>", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R 0\\<^esup> =\n       x^\\<^bsup>R (n + 0)\\<^esup>\n 2. \\<And>n m na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n + na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R (n + Suc na)\\<^esup>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r 1\\<^sub>r =\n       x^\\<^bsup>R n\\<^esup>\n 2. \\<And>n m na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n + na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R (n + Suc na)\\<^esup>", "apply (rule ring_r_one, simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n + na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R (n + Suc na)\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n + na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         (x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x) =\n                         x^\\<^bsup>R (n + na)\\<^esup> \\<cdot>\\<^sub>r x", "apply (frule_tac x = x and n = n in npClose,\n         frule_tac x = x and n = na in npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n + na)\\<^esup>;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        x^\\<^bsup>R na\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         (x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x) =\n                         x^\\<^bsup>R (n + na)\\<^esup> \\<cdot>\\<^sub>r x", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npMulExp:\"\\<And>n m. x \\<in> carrier R\n        \\<Longrightarrow>  npow R (npow R x n) m = npow R x (n * m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup>^\\<^bsup>R m\\<^esup> =\n       x^\\<^bsup>R (n * m)\\<^esup>", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n m.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup>^\\<^bsup>R 0\\<^esup> =\n       x^\\<^bsup>R (n * 0)\\<^esup>\n 2. \\<And>n m na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n * na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup>^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R (n * Suc na)\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n m na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n * na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup>^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R (n * Suc na)\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n * na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (n * na)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n + n * na)\\<^esup>", "apply (simp add:npMulDistr)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R (n * na)\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (n * na + n)\\<^esup> =\n                         x^\\<^bsup>R (n + n * na)\\<^esup>", "apply (simp add:add.commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npGTPowZero_sub:\n  \" \\<And> n. \\<lbrakk> x \\<in> carrier R; npow R x m = \\<zero> \\<rbrakk>\n        \\<Longrightarrow>(m \\<le> n) \\<longrightarrow> (npow R x n = \\<zero> )\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> m \\<le> n \\<longrightarrow>\n                         x^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (subgoal_tac \"npow R x n = (npow R x (n-m)) \\<cdot>\\<^sub>r (npow R x m)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n;\n        x^\\<^bsup>R n\\<^esup> =\n        x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n        x^\\<^bsup>R m\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> = \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R m\\<^esup>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n;\n        x^\\<^bsup>R n\\<^esup> =\n        x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         \\<zero> =\n                         \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R m\\<^esup>", "apply (rule ring_times_x_0)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n;\n        x^\\<^bsup>R n\\<^esup> =\n        x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (n - m)\\<^esup> \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R m\\<^esup>", "apply (simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R m\\<^esup>", "apply (thin_tac \"x^\\<^bsup>R m\\<^esup> = \\<zero>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m)\\<^esup> \\<cdot>\\<^sub>r\n                         x^\\<^bsup>R m\\<^esup>", "apply (subst npMulDistr, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R (n - m + m)\\<^esup>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npGTPowZero:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; npow R x m = \\<zero>; m \\<le> n \\<rbrakk>\n        \\<Longrightarrow> npow R x n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (cut_tac x = x and m = m and n = n in npGTPowZero_sub, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x^\\<^bsup>R m\\<^esup> = \\<zero>;\n        m \\<le> n;\n        m \\<le> n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> = \\<zero>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npOne: \" npow R (1\\<^sub>r) n = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r^\\<^bsup>R n\\<^esup> = 1\\<^sub>r", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 1\\<^sub>r^\\<^bsup>R 0\\<^esup> = 1\\<^sub>r\n 2. \\<And>n.\n       1\\<^sub>r^\\<^bsup>R n\\<^esup> = 1\\<^sub>r \\<Longrightarrow>\n       1\\<^sub>r^\\<^bsup>R Suc n\\<^esup> = 1\\<^sub>r", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       1\\<^sub>r^\\<^bsup>R n\\<^esup> = 1\\<^sub>r \\<Longrightarrow>\n       1\\<^sub>r^\\<^bsup>R Suc n\\<^esup> = 1\\<^sub>r", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       1\\<^sub>r^\\<^bsup>R n\\<^esup> = 1\\<^sub>r \\<Longrightarrow>\n       1\\<^sub>r \\<cdot>\\<^sub>r 1\\<^sub>r = 1\\<^sub>r", "apply (rule ring_r_one, simp add:ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npZero_sub: \"0 < n \\<longrightarrow> npow R \\<zero> n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<longrightarrow> \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. 0 < 0 \\<longrightarrow> \\<zero>^\\<^bsup>R 0\\<^esup> = \\<zero>\n 2. \\<And>n.\n       0 < n \\<longrightarrow>\n       \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero> \\<Longrightarrow>\n       0 < Suc n \\<longrightarrow> \\<zero>^\\<^bsup>R Suc n\\<^esup> = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       0 < n \\<longrightarrow>\n       \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero> \\<Longrightarrow>\n       0 < Suc n \\<longrightarrow> \\<zero>^\\<^bsup>R Suc n\\<^esup> = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       0 < n \\<longrightarrow>\n       \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero> \\<Longrightarrow>\n       \\<zero>^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r \\<zero> = \\<zero>", "apply (cut_tac ring_zero,\n           frule_tac n = n in npClose[of \"\\<zero>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>0 < n \\<longrightarrow>\n                \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero>;\n        \\<zero> \\<in> carrier R;\n        \\<zero>^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         \\<zero> =\n                         \\<zero>", "apply (simp add:ring_times_x_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npZero: \"0 < n  \\<Longrightarrow> npow R \\<zero> n = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 0 < n \\<Longrightarrow> \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (simp add:npZero_sub)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npMulElmL: \"\\<And> n. \\<lbrakk> x \\<in> carrier R; 0 \\<le> n\\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (npow R x n) = npow R x (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; 0 \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r x^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R Suc n\\<^esup>", "apply (simp only:npow_suc,\n       frule_tac n = n and x = x in npClose,\n       simp add:ring_tOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npMulEleL: \"\\<And> n. x \\<in> carrier R\n        \\<Longrightarrow> (npow R x n) \\<cdot>\\<^sub>r x =  npow R x (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x = x^\\<^bsup>R Suc n\\<^esup>", "by (simp add:npMulElmL[THEN sym])"], ["", "lemma (in Ring) npMulElmR: \"\\<And> n. x \\<in> carrier R\n        \\<Longrightarrow> (npow R x n) \\<cdot>\\<^sub>r x =  npow R x (Suc n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x = x^\\<^bsup>R Suc n\\<^esup>", "apply ( frule_tac n = n in npClose[of \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x =\n                         x^\\<^bsup>R Suc n\\<^esup>", "apply (simp only:ring_tOp_commute,\n          subst npMulElmL, assumption, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) np_1:\"a \\<in> carrier R \\<Longrightarrow> npow R a (Suc 0) = a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> a^\\<^bsup>R Suc 0\\<^esup> = a", "(* Y. Santo*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> a^\\<^bsup>R Suc 0\\<^esup> = a", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r a = a", "apply (simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection  \"nsum and fSum\""], ["", "lemma (in aGroup) nsum_memTr: \"(\\<forall>j \\<le> n. f j \\<in> carrier A) \\<longrightarrow>\n                                 nsum A f n \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f n \\<in> carrier A", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0. f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 \\<in> carrier A\n 2. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n \\<in> carrier A \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n \\<in> carrier A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n \\<in> carrier A \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n \\<in> carrier A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n. f j \\<in> carrier A) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f n \\<in> carrier A;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n \\<in> carrier A", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<in> carrier A;\n        \\<forall>j\\<le>Suc n. f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n)\n                         \\<in> carrier A", "apply (frule_tac a = \"Suc n\" in forall_spec, simp,\n         thin_tac \"\\<forall>j\\<le>Suc n. f j \\<in> carrier A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<in> carrier A;\n        f (Suc n) \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n)\n                         \\<in> carrier A", "apply (rule ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_mem:\"\\<forall>j \\<le> n. f j \\<in> carrier A \\<Longrightarrow>\n                                 nsum A f n \\<in> carrier A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>n. f j \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f n \\<in> carrier A", "apply (simp add:nsum_memTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_eqTr:\"(\\<forall>j \\<le> n. f j \\<in> carrier A \\<and>\n                                      g j \\<in> carrier A \\<and>\n                                      f j = g j)\n                           \\<longrightarrow>  nsum A f n = nsum A g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n.\n        f j \\<in> carrier A \\<and>\n        g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A g n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0.\n        f j \\<in> carrier A \\<and>\n        g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f 0 = \\<Sigma>\\<^sub>e A g 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>n.\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<Sigma>\\<^sub>e A g Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n.\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n = \\<Sigma>\\<^sub>e A g Suc n", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    f j \\<in> carrier A \\<and>\n                    g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A g n;\n        \\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc n =\n                         \\<Sigma>\\<^sub>e A g Suc n", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_eq:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> n. g j \\<in> carrier A;\n                           \\<forall>j \\<le> n. f j = g j\\<rbrakk> \\<Longrightarrow>  nsum A f n = nsum A g n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A;\n     \\<forall>j\\<le>n. f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n = \\<Sigma>\\<^sub>e A g n", "by (simp add:nsum_eqTr)"], ["", "lemma (in aGroup) nsum_cmp_assoc:\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A;\n       g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}; h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk> \\<Longrightarrow>\n       nsum A (cmp (cmp f h) g) n = nsum A (cmp f (cmp h g)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A cmp (cmp f h) g n =\n                      \\<Sigma>\\<^sub>e A cmp f (cmp h g) n", "apply (rule nsum_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp (cmp f h) g j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp f (cmp h g) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (cmp f h) g j = cmp f (cmp h g) j", "apply (rule allI, rule impI, simp add:cmp_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>j.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (h (g j)) \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp f (cmp h g) j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (cmp f h) g j = cmp f (cmp h g) j", "apply (frule_tac x = j in funcset_mem[of g \"{j. j \\<le> n}\" \"{j. j \\<le> n}\"], simp,\n       frule_tac x = \"g j\" in funcset_mem[of h \"{j. j \\<le> n}\" \"{j. j \\<le> n}\"],\n       assumption, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. cmp f (cmp h g) j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (cmp f h) g j = cmp f (cmp h g) j", "apply (rule allI, rule impI, simp add:cmp_def,\n       frule_tac x = j in funcset_mem[of g \"{j. j \\<le> n}\" \"{j. j \\<le> n}\"], simp,\n       frule_tac x = \"g j\" in funcset_mem[of h \"{j. j \\<le> n}\" \"{j. j \\<le> n}\"],\n       assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     g \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n};\n     h \\<in> {j. j \\<le> n} \\<rightarrow> {j. j \\<le> n}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                         cmp (cmp f h) g j = cmp f (cmp h g) j", "apply (rule allI, simp add:cmp_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) fSum_Suc:\"\\<forall>j \\<in> nset n (n + Suc m). f j \\<in> carrier A \\<Longrightarrow>\n              fSum A f n (n + Suc m) = fSum A f n (n + m) \\<plusminus> f (n + Suc m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<in>nset n (n + Suc m). f j \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + Suc m) =\n    \\<Sigma>\\<^sub>f A f n (n + m) \\<plusminus> f (n + Suc m)", "by (simp add:fSum_def, simp add:cmp_def slide_def)"], ["", "lemma (in aGroup) fSum_eqTr:\"(\\<forall>j \\<in> nset n (n + m). f j \\<in> carrier A \\<and>\n         g j \\<in> carrier A \\<and>  f j = g j)  \\<longrightarrow>\n                       fSum A f  n (n + m) = fSum A g n (n + m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<in>nset n (n + m).\n        f j \\<in> carrier A \\<and>\n        g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + m) = \\<Sigma>\\<^sub>f A g n (n + m)", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<in>nset n (n + 0).\n        f j \\<in> carrier A \\<and>\n        g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + 0) = \\<Sigma>\\<^sub>f A g n (n + 0)\n 2. \\<And>na.\n       (\\<forall>j\\<in>nset n (n + na).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + na) =\n       \\<Sigma>\\<^sub>f A g n (n + na) \\<Longrightarrow>\n       (\\<forall>j\\<in>nset n (n + Suc na).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + Suc na) =\n       \\<Sigma>\\<^sub>f A g n (n + Suc na)", "apply (simp add:fSum_def,\n        simp add:cmp_def slide_def,\n        simp add:nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       (\\<forall>j\\<in>nset n (n + na).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + na) =\n       \\<Sigma>\\<^sub>f A g n (n + na) \\<Longrightarrow>\n       (\\<forall>j\\<in>nset n (n + Suc na).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + Suc na) =\n       \\<Sigma>\\<^sub>f A g n (n + Suc na)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j \\<in> carrier A \\<and>\n                    g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) =\n                \\<Sigma>\\<^sub>f A g n (n + na);\n        \\<forall>j\\<in>nset n (n + Suc na).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + Suc na) =\n                         \\<Sigma>\\<^sub>f A g n (n + Suc na)", "apply (subst fSum_Suc,\n        rule ballI, simp, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j \\<in> carrier A \\<and>\n                    g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) =\n                \\<Sigma>\\<^sub>f A g n (n + na);\n        \\<forall>j\\<in>nset n (Suc (n + na)).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + na) \\<plusminus>\n                         f (Suc (n + na)) =\n                         \\<Sigma>\\<^sub>f A g n Suc (n + na)", "apply (cut_tac n = n and m = na and f = g in fSum_Suc,\n        rule ballI, simp, simp,\n        thin_tac \"\\<Sigma>\\<^sub>f A g n (Suc (n + na)) =\n                                   \\<Sigma>\\<^sub>f A g n (n + na) \\<plusminus> g (Suc (n + na))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j \\<in> carrier A \\<and>\n                    g j \\<in> carrier A \\<and> f j = g j) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) =\n                \\<Sigma>\\<^sub>f A g n (n + na);\n        \\<forall>j\\<in>nset n (Suc (n + na)).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + na) \\<plusminus>\n                         f (Suc (n + na)) =\n                         \\<Sigma>\\<^sub>f A g n (n + na) \\<plusminus>\n                         g (Suc (n + na))", "apply (cut_tac n = n and m = na in nsetnm_sub_mem, simp,\n        thin_tac \"\\<forall>j. j \\<in> nset n (n + na) \\<longrightarrow> j \\<in> nset n (Suc (n + na))\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>f A f n (n + na) =\n                \\<Sigma>\\<^sub>f A g n (n + na);\n        \\<forall>j\\<in>nset n (Suc (n + na)).\n           f j \\<in> carrier A \\<and>\n           g j \\<in> carrier A \\<and> f j = g j\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A g n (n + na) \\<plusminus>\n                         f (Suc (n + na)) =\n                         \\<Sigma>\\<^sub>f A g n (n + na) \\<plusminus>\n                         g (Suc (n + na))", "apply (frule_tac x = \"Suc (n + na)\" in bspec,\n       simp add:nset_def, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) fSum_eq:\"\\<lbrakk> \\<forall>j \\<in> nset n (n + m). f j \\<in> carrier A;\n      \\<forall>j \\<in> nset n (n + m). g j \\<in> carrier A; (\\<forall>j\\<in> nset n (n + m). f j = g j)\\<rbrakk>\n       \\<Longrightarrow>\n         fSum A f n (n + m) = fSum A g n (n + m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<in>nset n (n + m). f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n (n + m). g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n (n + m). f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + m) =\n                      \\<Sigma>\\<^sub>f A g n (n + m)", "by (simp add:fSum_eqTr)"], ["", "lemma (in aGroup) fSum_eq1:\"\\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n       \\<forall>j\\<in>nset n m. g j \\<in> carrier A;  \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk> \\<Longrightarrow>\n         fSum A f n m = fSum A g n m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n m = \\<Sigma>\\<^sub>f A g n m", "apply (cut_tac fSum_eq[of n \"m - n\" f g])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. f j = g j;\n     \\<Sigma>\\<^sub>f A f n (n + (m - n)) =\n     \\<Sigma>\\<^sub>f A g n (n + (m - n))\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n m = \\<Sigma>\\<^sub>f A g n m\n 2. \\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset n (n + (m - n)).\n                         f j \\<in> carrier A\n 3. \\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset n (n + (m - n)).\n                         g j \\<in> carrier A\n 4. \\<lbrakk>n \\<le> m; \\<forall>j\\<in>nset n m. f j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. g j \\<in> carrier A;\n     \\<forall>j\\<in>nset n m. f j = g j\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset n (n + (m - n)). f j = g j", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) fSum_zeroTr:\"(\\<forall>j \\<in> nset n (n + m). f j = \\<zero>)  \\<longrightarrow>\n                       fSum A f  n (n + m) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<in>nset n (n + m). f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + m) = \\<zero>", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<in>nset n (n + 0). f j = \\<zero>) \\<longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + 0) = \\<zero>\n 2. \\<And>na.\n       (\\<forall>j\\<in>nset n (n + na). f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + Suc na) = \\<zero>", "apply (simp add:fSum_def cmp_def slide_def nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       (\\<forall>j\\<in>nset n (n + na). f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero> \\<Longrightarrow>\n       (\\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>f A f n (n + Suc na) = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + Suc na) = \\<zero>", "apply (subst fSum_Suc)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<in>nset n (n + Suc na).\n                            f j \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + na) \\<plusminus>\n                         f (n + Suc na) =\n                         \\<zero>", "apply (rule ballI, simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j\\<in>nset n (n + Suc na). f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + na) \\<plusminus>\n                         f (n + Suc na) =\n                         \\<zero>", "apply (frule_tac x = \"n + Suc na\" in bspec, simp add:nset_def,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>(\\<forall>j\\<in>nset n (n + na).\n                    f j = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j\\<in>nset n (Suc (n + na)). f j = \\<zero>;\n        f (Suc (n + na)) = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>f A f n (n + na) \\<plusminus>\n                         \\<zero> =\n                         \\<zero>", "apply (simp add:nset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>f A f n (n + na) = \\<zero>;\n        \\<forall>j.\n           n \\<le> j \\<and> j \\<le> Suc (n + na) \\<longrightarrow>\n           f j = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (cut_tac ag_inc_zero, simp add:ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) fSum_zero:\"\\<forall>j \\<in> nset n (n + m). f j = \\<zero>  \\<Longrightarrow>\n                       fSum A f  n (n + m) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<in>nset n (n + m). f j = \\<zero> \\<Longrightarrow>\n    \\<Sigma>\\<^sub>f A f n (n + m) = \\<zero>", "by (simp add:fSum_zeroTr)"], ["", "lemma (in aGroup) fSum_zero1:\"\\<lbrakk>n < m; \\<forall>j \\<in> nset (Suc n) m. f j = \\<zero>\\<rbrakk>  \\<Longrightarrow>\n                       fSum A f  (Suc n) m = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>n < m; \\<forall>j\\<in>nset (Suc n) m. f j = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f Suc n m = \\<zero>", "apply (cut_tac fSum_zero[of \"Suc n\" \"m - Suc n\" f])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>n < m; \\<forall>j\\<in>nset (Suc n) m. f j = \\<zero>;\n     \\<Sigma>\\<^sub>f A f Suc n (Suc n + (m - Suc n)) = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>f A f Suc n m = \\<zero>\n 2. \\<lbrakk>n < m; \\<forall>j\\<in>nset (Suc n) m. f j = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<in>nset (Suc n) (Suc n + (m - Suc n)).\n                         f j = \\<zero>", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsumMulEleL: \"\\<And> n. \\<lbrakk> \\<forall> i. f i \\<in> carrier R; x \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nsum R f n) = nsum R (\\<lambda> i. x \\<cdot>\\<^sub>r (f i)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) n", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) n", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) 0\n 2. \\<And>n na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) Suc na", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) Suc na", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f na \\<plusminus> f (Suc na)) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na)", "apply (subst ring_distrib1, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f na \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> f (Suc na) \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R f na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na)", "apply (rule aGroup.nsum_mem, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>na. f j \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> f (Suc na) \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R f na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na)", "apply (rule allI, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsumMulElmL:\n  \"\\<And> n. \\<lbrakk> \\<forall> i. f i \\<in> carrier R; x \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> x \\<cdot>\\<^sub>r (nsum R f n) = nsum R (\\<lambda> i. x \\<cdot>\\<^sub>r (f i)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) n", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f n =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) n", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f 0 =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) 0\n 2. \\<And>n na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) Suc na", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f Suc na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) Suc na", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         (\\<Sigma>\\<^sub>e R f na \\<plusminus> f (Suc na)) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na)", "apply (subst ring_distrib1, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f na \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> f (Suc na) \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>\\<forall>i. f i \\<in> carrier R; x \\<in> carrier R;\n        aGroup R;\n        x \\<cdot>\\<^sub>r \\<Sigma>\\<^sub>e R f na =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i. x \\<cdot>\\<^sub>r f i) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R f na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n          x \\<cdot>\\<^sub>r f i) na \\<plusminus>\n                         x \\<cdot>\\<^sub>r f (Suc na)", "apply (simp add:aGroup.nsum_mem)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsumTailTr:\n         \"(\\<forall>j\\<le>(Suc n). f j \\<in> carrier A) \\<longrightarrow>\n          nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc n =\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus> f 0", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>Suc 0. f j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc 0 =\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) 0 \\<plusminus> f 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n       f 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (Suc n) =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) Suc n \\<plusminus> f 0", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>Suc 0. f j \\<in> carrier A) \\<longrightarrow>\n    f 0 \\<plusminus> f (Suc 0) = f (Suc 0) \\<plusminus> f 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n       f 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (Suc n) =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) Suc n \\<plusminus> f 0", "apply (rule impI,\n         rule ag_pOp_commute)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<forall>j\\<le>Suc 0. f j \\<in> carrier A \\<Longrightarrow>\n    f 0 \\<in> carrier A\n 2. \\<forall>j\\<le>Suc 0. f j \\<in> carrier A \\<Longrightarrow>\n    f (Suc 0) \\<in> carrier A\n 3. \\<And>n.\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n       f 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (Suc n) =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) Suc n \\<plusminus> f 0", "apply (cut_tac Nset_inc_0[of \"Suc 0\"],\n         simp add:Pi_def,\n         cut_tac n_in_Nsetn[of \"Suc 0\"],\n         simp add:Pi_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>Suc n. f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc n =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n       f 0 \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc (Suc n) =\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) Suc n \\<plusminus> f 0", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>Suc n.\n                    f j \\<in> carrier A) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f Suc n =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        \\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc (Suc n) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) Suc n \\<plusminus>\n                         f 0", "apply (cut_tac n = \"Suc n\" in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        \\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f 0 \\<plusminus>\n                         f (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply (frule_tac a = 0 in forall_spec, simp,\n          frule_tac a = \"Suc (Suc n)\" in forall_spec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        \\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A;\n        f 0 \\<in> carrier A; f (Suc (Suc n)) \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f 0 \\<plusminus>\n                         f (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply (cut_tac n = n in nsum_mem[of  _  \"\\<lambda>i. f (Suc i)\"],\n          rule allI, rule impI,\n          frule_tac a = \"Suc j\" in forall_spec, simp, simp,\n          thin_tac \"\\<forall>j\\<le>Suc (Suc n). f j \\<in> carrier A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        f 0 \\<in> carrier A; f (Suc (Suc n)) \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f 0 \\<plusminus>\n                         f (Suc (Suc n)) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply (subst ag_pOp_assoc, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        f 0 \\<in> carrier A; f (Suc (Suc n)) \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         (f 0 \\<plusminus> f (Suc (Suc n))) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply (simp add:ag_pOp_commute[of  \"f 0\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        f 0 \\<in> carrier A; f (Suc (Suc n)) \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         (f (Suc (Suc n)) \\<plusminus> f 0) =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply (subst ag_pOp_assoc[THEN sym], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) =\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus>\n                f 0;\n        f 0 \\<in> carrier A; f (Suc (Suc n)) \\<in> carrier A;\n        \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n\n        \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0 =\n                         \\<Sigma>\\<^sub>e A (\\<lambda>i.\n          f (Suc i)) n \\<plusminus>\n                         f (Suc (Suc n)) \\<plusminus>\n                         f 0", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsumTail:\n      \"\\<forall>j \\<le> (Suc n). f j \\<in> carrier A \\<Longrightarrow>\n            nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>j\\<le>Suc n. f j \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc n =\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus> f 0", "by (cut_tac nsumTailTr[of n f], simp)"], ["", "lemma (in aGroup) nsumElmTail:\n  \"\\<forall>i. f i \\<in> carrier A\n        \\<Longrightarrow> nsum A f (Suc n) = (nsum A (\\<lambda> i. (f (Suc i))) n) \\<plusminus> (f 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i. f i \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f Suc n =\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f (Suc i)) n \\<plusminus> f 0", "apply (cut_tac n = n and f = f in nsumTail,\n         rule allI, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_addTr:\n  \"(\\<forall>j \\<le> n. f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n   nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n.\n        f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g n", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>0.\n        f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) 0 =\n    \\<Sigma>\\<^sub>e A f 0 \\<plusminus> \\<Sigma>\\<^sub>e A g 0\n 2. \\<And>n.\n       (\\<forall>j\\<le>n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) Suc n =\n       \\<Sigma>\\<^sub>e A f Suc n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc n", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>j\\<le>n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g n \\<Longrightarrow>\n       (\\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) Suc n =\n       \\<Sigma>\\<^sub>e A f Suc n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc n", "apply (simp, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>j\\<le>n.\n                    f j \\<in> carrier A \\<and>\n                    g j \\<in> carrier A) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g n;\n        \\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A g n \\<plusminus>\n                         (f (Suc n) \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g n \\<plusminus> g (Suc n))", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g n;\n        \\<forall>j\\<le>Suc n.\n           f j \\<in> carrier A \\<and> g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A g n \\<plusminus>\n                         (f (Suc n) \\<plusminus> g (Suc n)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         f (Suc n) \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g n \\<plusminus> g (Suc n))", "apply (thin_tac \"\\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n = \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g n \\<plusminus>\n       (f (Suc n) \\<plusminus> g (Suc n)) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> f (Suc n) \\<plusminus>\n       (\\<Sigma>\\<^sub>e A g n \\<plusminus> g (Suc n))", "apply (rule aGroup.ag_add4_rel, rule aGroup_axioms)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 2. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       \\<Sigma>\\<^sub>e A g n \\<in> carrier A\n 3. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       f (Suc n) \\<in> carrier A\n 4. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       g (Suc n) \\<in> carrier A", "apply (rule aGroup.nsum_mem, rule aGroup_axioms, rule allI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       \\<Sigma>\\<^sub>e A g n \\<in> carrier A\n 2. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       f (Suc n) \\<in> carrier A\n 3. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       g (Suc n) \\<in> carrier A", "apply (rule aGroup.nsum_mem, rule aGroup_axioms, rule allI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       f (Suc n) \\<in> carrier A\n 2. \\<And>n.\n       \\<forall>j\\<le>Suc n.\n          f j \\<in> carrier A \\<and> g j \\<in> carrier A \\<Longrightarrow>\n       g (Suc n) \\<in> carrier A", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_add:\n  \"\\<lbrakk> \\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> n. g j \\<in> carrier A\\<rbrakk>  \\<Longrightarrow>\n   nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>n. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n       f i \\<plusminus> g i) n =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g n", "by (cut_tac nsum_addTr[of n f g], simp)"], ["", "lemma (in aGroup) nsumElmAdd:\n  \"\\<lbrakk> \\<forall> i. f i \\<in> carrier A; \\<forall> i. g i \\<in> carrier A\\<rbrakk>\n        \\<Longrightarrow> nsum A (\\<lambda> i. (f i) \\<plusminus> (g i)) n = (nsum A f n) \\<plusminus> (nsum A g n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n       f i \\<plusminus> g i) n =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g n", "apply (cut_tac nsum_add[of n f g])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A;\n     \\<Sigma>\\<^sub>e A (\\<lambda>i. f i \\<plusminus> g i) n =\n     \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A (\\<lambda>i.\n       f i \\<plusminus> g i) n =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g n\n 2. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 3. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. g j \\<in> carrier A", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. f j \\<in> carrier A\n 2. \\<lbrakk>\\<forall>i. f i \\<in> carrier A;\n     \\<forall>i. g i \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n. g j \\<in> carrier A", "apply (rule allI, simp)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_add_nmTr:\n  \"(\\<forall>j \\<le> n. f j \\<in> carrier A) \\<and> (\\<forall>j \\<le> m. g j \\<in> carrier A) \\<longrightarrow>\n   nsum A (jointfun n f m g) (Suc (n + m)) = (nsum A f n) \\<plusminus> (nsum A g m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    (\\<forall>j\\<le>m. g j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A jointfun n f m g Suc (n + m) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g m", "apply (induct_tac m)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    (\\<forall>j\\<le>0. g j \\<in> carrier A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A jointfun n f 0 g Suc (n + 0) =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g 0\n 2. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (simp add:jointfun_def sliden_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n \\<plusminus>\n    g 0 =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus> g 0\n 2. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n \\<plusminus>\n    g 0 =\n    \\<Sigma>\\<^sub>e A f n \\<plusminus> g 0\n 2. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (rule ag_pOp_add_r)"], ["proof (prove)\ngoal (5 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n\n    \\<in> carrier A\n 2. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 3. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    g 0 \\<in> carrier A\n 4. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n =\n    \\<Sigma>\\<^sub>e A f n\n 5. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (rule nsum_mem, rule allI, erule conjE, rule impI, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 2. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    g 0 \\<in> carrier A\n 3. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n =\n    \\<Sigma>\\<^sub>e A f n\n 4. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (erule conjE, simp add:nsum_mem, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n    g 0 \\<in> carrier A \\<Longrightarrow>\n    \\<Sigma>\\<^sub>e A (\\<lambda>a.\n                           if a \\<le> n then f a\n                           else g (sliden (Suc n) a)) n =\n    \\<Sigma>\\<^sub>e A f n\n 2. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g Suc (n + na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g Suc (n + Suc na) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g Suc na", "apply (rule nsum_eq[of n], simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f na g (n + na) \\<plusminus>\n       jointfun n f na g (Suc (n + na)) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A jointfun n f (Suc na) g (n + na) \\<plusminus>\n       jointfun n f (Suc na) g (Suc (n + na)) \\<plusminus>\n       jointfun n f (Suc na) g (Suc (Suc (n + na))) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (simp add:jointfun_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A (\\<lambda>i.\n                              if i \\<le> n then f i\n                              else g (sliden (Suc n)\n i)) (n + na) \\<plusminus>\n       g (sliden (Suc n) (Suc (n + na))) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<Longrightarrow>\n       (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n       (\\<forall>j\\<le>Suc na. g j \\<in> carrier A) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       \\<Sigma>\\<^sub>e A g na \\<plusminus>\n       g (sliden (Suc n) (Suc (Suc (n + na)))) =\n       \\<Sigma>\\<^sub>e A f n \\<plusminus>\n       (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A (\\<lambda>i.\n if i \\<le> n then f i else g (sliden (Suc n) i)) (n + na) \\<plusminus>\n                g (sliden (Suc n) (Suc (n + na))) =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g na;\n        (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n        (\\<forall>j\\<le>Suc na. g j \\<in> carrier A)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A g na \\<plusminus>\n                         g (sliden (Suc n) (Suc (Suc (n + na)))) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (erule conjE, simp add:sliden_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A (\\<lambda>i.\n if i \\<le> n then f i else g (sliden (Suc n) i)) (n + na) \\<plusminus>\n                g na =\n                \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g na;\n        \\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A g na \\<plusminus>\n                         g (Suc na) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (thin_tac \"\\<Sigma>\\<^sub>e A (\\<lambda>i. if i \\<le> n then f i else g (sliden (Suc n) i))\n        (n + na) \\<plusminus> g na = \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g na\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         \\<Sigma>\\<^sub>e A g na \\<plusminus>\n                         g (Suc na) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (subst ag_pOp_assoc)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A g na \\<in> carrier A\n 3. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<in> carrier A\n 4. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (simp add:nsum_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A g na \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> g (Suc na) \\<in> carrier A\n 3. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply (simp add:nsum_mem, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n        \\<forall>j\\<le>Suc na. g j \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na)) =\n                         \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                         (\\<Sigma>\\<^sub>e A g na \\<plusminus> g (Suc na))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_add_nm:\n\"\\<lbrakk>\\<forall>j \\<le> n. f j \\<in> carrier A; \\<forall>j \\<le> m. g j \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n   nsum A (jointfun n f m g) (Suc (n + m)) = (nsum A f n) \\<plusminus> (nsum A g m)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g Suc (n + m) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply (cut_tac nsum_add_nmTr[of n f m g])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>j\\<le>n. f j \\<in> carrier A;\n     \\<forall>j\\<le>m. g j \\<in> carrier A;\n     (\\<forall>j\\<le>n. f j \\<in> carrier A) \\<and>\n     (\\<forall>j\\<le>m. g j \\<in> carrier A) \\<longrightarrow>\n     \\<Sigma>\\<^sub>e A jointfun n f m g Suc (n + m) =\n     \\<Sigma>\\<^sub>e A f n \\<plusminus> \\<Sigma>\\<^sub>e A g m\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e A jointfun n f m g Suc (n + m) =\n                      \\<Sigma>\\<^sub>e A f n \\<plusminus>\n                      \\<Sigma>\\<^sub>e A g m", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npeSum2_sub_muly:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n        y \\<cdot>\\<^sub>r(nsum R (\\<lambda>i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                (n choose i)) n)\n        = nsum R (\\<lambda>i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y (i+1)))\n                                (n choose i)) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> y \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (subst nsumMulElmL)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                          (n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       y \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (rule allI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       y \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (simp only:nsClose add:ring_tOp_closed\n             add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       y \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply assumption"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       y \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (simp only:nsMulDistrL add:nsClose add:ring_tOp_closed\n         add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (y \\<cdot>\\<^sub>r\n (x^\\<^bsup>R (n - i)\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R i\\<^esup>))) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (simp only: rMulLC [of \"y\"] add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n (y \\<cdot>\\<^sub>r y^\\<^bsup>R i\\<^esup>))) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R (i + 1)\\<^esup>)) n", "apply (simp del:npow_suc add:ring_tOp_commute[of y])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n (y \\<cdot>\\<^sub>r y^\\<^bsup>R i\\<^esup>))) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R Suc i\\<^esup>)) n", "apply (rule aGroup.nsum_eq, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>))\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)\n                         \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>)) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)", "apply (rule allI, rule impI, rule nsClose,\n         rule ring_tOp_closed, simp add:npClose,\n         rule ring_tOp_closed, assumption, simp add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>)) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)", "apply (rule allI, rule impI, rule nsClose,\n         rule ring_tOp_closed, simp add:npClose,\n         rule npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>)) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>)) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)", "apply (frule_tac n = j in npClose[of y])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R; j \\<le> n;\n        y^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   (y \\<cdot>\\<^sub>r y^\\<^bsup>R j\\<^esup>)) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R Suc j\\<^esup>)", "apply (simp add:ring_tOp_commute[of y])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(********)(********)(********)(********)"], ["", "lemma binomial_n0: \"(Suc n choose 0) = (n choose 0)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Suc n choose 0 = n choose 0", "by simp"], ["", "lemma binomial_ngt_diff:\n  \"(n choose Suc n) = (Suc n choose Suc n) - (n choose n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n choose Suc n = Suc n choose Suc n - (n choose n)", "by (subst binomial_Suc_Suc, arith)"], ["", "lemma binomial_ngt_0: \"(n choose Suc n) = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n choose Suc n = 0", "apply (subst binomial_ngt_diff,\n         (subst binomial_n_n)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1 - 1 = 0", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma diffLessSuc: \"m \\<le> n \\<Longrightarrow> Suc (n-m) = Suc n - m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. m \\<le> n \\<Longrightarrow> Suc (n - m) = Suc n - m", "by arith"], ["", "lemma (in Ring) npow_suc_i:\n  \"\\<lbrakk> x \\<in> carrier R; i \\<le> n \\<rbrakk>\n        \\<Longrightarrow> npow R x (Suc n - i) =  x \\<cdot>\\<^sub>r (npow R x (n-i))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>R (Suc n - i)\\<^esup> =\n                      x \\<cdot>\\<^sub>r x^\\<^bsup>R (n - i)\\<^esup>", "apply (subst diffLessSuc [THEN sym, of \"i\" \"n\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; i \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>R Suc (n - i)\\<^esup> =\n                      x \\<cdot>\\<^sub>r x^\\<^bsup>R (n - i)\\<^esup>", "apply (frule_tac n = \"n - i\" in npClose,\n         simp add:ring_tOp_commute[of x])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(**\nlemma (in Ring) nsumEqFunc_sub:\n  \"\\<lbrakk>  \\<And> i. f i \\<in> carrier R; \\<And> i. g i \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> ( \\<forall> i. i \\<le> n \\<longrightarrow> f i = g i) \\<longrightarrow> (nsum0 R f n = nsum0 R g n)\";\n  apply (induct_tac \"n\")\n  apply simp+\n  done\n\nlemma (in Ring) nsumEqFunc:\n  \"\\<lbrakk> \\<And> i. f i \\<in> carrier R; \\<And> i. g i \\<in> carrier R;\n     \\<And> i. i \\<le> n \\<longrightarrow> f i = g i \\<rbrakk> \\<Longrightarrow>  nsum0 R f n = nsum0 R g n\"\n  apply (cut_tac nsumEqFunc_sub [of \"f\" \"g\" \"n\"])\n  apply simp+\n  done          nsumEqFunc \\<longrightarrow> nsum_eq       **)\n(********)(********)"], ["", "lemma (in Ring) npeSum2_sub_mulx: \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n  x \\<cdot>\\<^sub>r (nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                                        (n choose i)) n)\n   = (nsum R (\\<lambda>i. nscal R\n                          ((npow R x (Suc n - Suc i)) \\<cdot>\\<^sub>r (npow R y (Suc i)))\n                          (n choose Suc i)) n) \\<plusminus>\n                (nscal R ((npow R x (Suc n - 0)) \\<cdot>\\<^sub>r (npow R y 0))\n                        (Suc n choose 0))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                  Suc i)\\<^esup> \\<cdot>\\<^sub>r\n     y^\\<^bsup>R Suc i\\<^esup>)) n \\<plusminus>\n                       (Suc n choose\n                        0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                             0)\\<^esup> \\<cdot>\\<^sub>r\n                y^\\<^bsup>R 0\\<^esup>)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                  Suc i)\\<^esup> \\<cdot>\\<^sub>r\n     y^\\<^bsup>R Suc i\\<^esup>)) n \\<plusminus>\n                       (Suc n choose\n                        0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                             0)\\<^esup> \\<cdot>\\<^sub>r\n                y^\\<^bsup>R 0\\<^esup>)", "apply (simp only: binomial_n0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                  Suc i)\\<^esup> \\<cdot>\\<^sub>r\n     y^\\<^bsup>R Suc i\\<^esup>)) n \\<plusminus>\n                       (n choose\n                        0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                             0)\\<^esup> \\<cdot>\\<^sub>r\n                y^\\<^bsup>R 0\\<^esup>)", "apply (subst aGroup.nsumElmTail [THEN sym, of R \"\\<lambda> i. nscal R ((npow R x (Suc n - i)) \\<cdot>\\<^sub>r (npow R y i)) (n choose i)\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                          (n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) Suc n", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) Suc n", "apply (simp only:nsClose add:ring_tOp_closed add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) Suc n", "apply (simp only:nsum_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n \\<plusminus>\n                       (n choose\n                        Suc n) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  n -\n                                 Suc n)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R Suc n\\<^esup>)", "apply (subst binomial_ngt_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n \\<plusminus>\n                       0 \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n                           Suc n)\\<^esup> \\<cdot>\\<^sub>r\n              y^\\<^bsup>R Suc n\\<^esup>)", "apply (simp only:nscal_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n \\<plusminus>\n                      \\<zero>", "apply (subst aGroup.ag_r_zero, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n\n                      \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (simp add:aGroup.nsum_mem nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (subst nsumMulElmL [of  _ \"x\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i.\n                          (n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       x \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (rule allI, rule nsClose, rule ring_tOp_closed, simp add:npClose,\n           simp add:npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n       x \\<cdot>\\<^sub>r\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (simp add: nsMulDistrL [of \"x\"] ring_tOp_closed npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n (x^\\<^bsup>R (n - i)\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R i\\<^esup>))) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (simp add:ring_tOp_assoc [THEN sym, of \"x\"] npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n x^\\<^bsup>R (n - i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n", "apply (rule aGroup.nsum_eq, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                   x^\\<^bsup>R (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)\n                         \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                   x^\\<^bsup>R (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)", "apply (rule allI, rule impI,\n          rule nsClose, (rule ring_tOp_closed)+, assumption,\n          simp add:npClose, simp add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                   x^\\<^bsup>R (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)", "apply (rule allI, rule impI,\n          rule nsClose, rule ring_tOp_closed,\n          simp add:npClose, simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                   x^\\<^bsup>R (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x \\<cdot>\\<^sub>r\n                   x^\\<^bsup>R (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)", "apply (frule_tac n = \"n - j\" in npClose[of x],\n        simp add:ring_tOp_commute[of x],\n        subst npow_suc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R; j \\<le> n;\n        x^\\<^bsup>R (n - j)\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R Suc\n                                (n - j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>) =\n                          (n choose\n                           j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 n -\n                                j)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R j\\<^esup>)", "apply (simp add:Suc_diff_le)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npeSum2_sub_mulx2:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n        x \\<cdot>\\<^sub>r (nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                (n choose i)) n)\n        = (nsum R  (\\<lambda>i. nscal R\n                          ((npow R x (n - i)) \\<cdot>\\<^sub>r ((npow R y i) \\<cdot>\\<^sub>r y ))\n                          (n choose Suc i)) n) \\<plusminus>\n                (\\<zero> \\<plusminus> ((x \\<cdot>\\<^sub>r (npow R x n)) \\<cdot>\\<^sub>r (1\\<^sub>r)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) n =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       1\\<^sub>r)", "apply (subst  npeSum2_sub_mulx, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       1\\<^sub>r)", "apply (frule npClose[of x n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x \\<cdot>\\<^sub>r\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       1\\<^sub>r)", "apply (subst ring_tOp_commute[of x], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r)", "apply (cut_tac aGroup.nsum_eq[of R n\n        \"\\<lambda>i.  (n choose Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n - i)\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R (Suc i)\\<^esup>)\"\n        \"\\<lambda>i.  (n choose Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n - i)\\<^esup> \\<cdot>\\<^sub>r (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R;\n     \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                             (n choose\n                              Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n i)\\<^esup> \\<cdot>\\<^sub>r\n                          y^\\<^bsup>R Suc i\\<^esup>)) n =\n     \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                             (n choose\n                              Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n i)\\<^esup> \\<cdot>\\<^sub>r\n                          (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r\n                           y))) n\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r) =\n                      \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (n choose\n         Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                  i)\\<^esup> \\<cdot>\\<^sub>r\n     (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) n \\<plusminus>\n                      (\\<zero> \\<plusminus>\n                       x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                       x \\<cdot>\\<^sub>r\n                       1\\<^sub>r)\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> aGroup R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>)\n                         \\<in> carrier R\n 4. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))\n                         \\<in> carrier R\n 5. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply (simp del:npow_suc)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>)\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))\n                         \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply (rule allI, rule impI,\n         rule nsClose, rule ring_tOp_closed, simp add:npClose,\n         simp only:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))\n                         \\<in> carrier R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply (rule allI, rule impI,\n         rule nsClose, rule ring_tOp_closed, simp add:npClose,\n         rule ring_tOp_closed, simp add:npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>j\\<le>n.\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R; j \\<le> n\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply (frule_tac n = j in npClose[of y])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>j.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R; aGroup R; j \\<le> n;\n        y^\\<^bsup>R j\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow>  (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       y^\\<^bsup>R Suc j\\<^esup>) =\n                          (n choose\n                           Suc j) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                                    j)\\<^esup> \\<cdot>\\<^sub>r\n                       (y^\\<^bsup>R j\\<^esup> \\<cdot>\\<^sub>r y))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npeSum2:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<plusminus> y) n =\n                nsum R (\\<lambda> i. nscal R ((npow R x (n-i)) \\<cdot>\\<^sub>r (npow R y i))\n                                       ( n choose i) ) n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (n choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) n", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R n\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (n choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (n -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) n", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R 0\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (0 choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (0 -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) 0\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) Suc na", "(*1*)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R 0\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (0 choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (0 -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) 0\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) Suc na", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r =\n                      \\<zero> \\<plusminus>\n                      1\\<^sub>r \\<cdot>\\<^sub>r 1\\<^sub>r\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) Suc na", "apply (cut_tac ring_one, simp add:ring_r_one, simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) Suc na", "(*1:done*)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) Suc na", "apply (subst aGroup.nsumElmTail, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i.\n                             (Suc na choose\n                              i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                    na -\n                                   i)\\<^esup> \\<cdot>\\<^sub>r\n                      y^\\<^bsup>R i\\<^esup>)\n                            \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow>  (Suc na choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>)\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (simp add:nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "(**\nthm binomial_Suc_Suc\n**)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (Suc na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (simp only:binomial_Suc_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose i +\n            (na choose\n             Suc i)) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                       Suc i)\\<^esup> \\<cdot>\\<^sub>r\n          y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (simp only: nsDistr [THEN sym] add:npClose ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>) \\<plusminus>\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (subst aGroup.nsumElmAdd, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i.\n                             (na choose\n                              i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                    na -\n                                   Suc i)\\<^esup> \\<cdot>\\<^sub>r\n                      y^\\<^bsup>R Suc i\\<^esup>)\n                            \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i.\n                             (na choose\n                              Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n  na -\n Suc i)\\<^esup> \\<cdot>\\<^sub>r\n                          y^\\<^bsup>R Suc i\\<^esup>)\n                            \\<in> carrier R\n 3. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (rule allI,\n           simp add:nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<forall>i.\n                             (na choose\n                              Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n  na -\n Suc i)\\<^esup> \\<cdot>\\<^sub>r\n                          y^\\<^bsup>R Suc i\\<^esup>)\n                            \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (rule allI,\n           simp add:nsClose add:ring_tOp_closed npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                          (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)", "apply (subst aGroup.ag_pOp_assoc, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na\n                         \\<in> carrier R\n 3. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow>  (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)\n                         \\<in> carrier R\n 4. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (rule aGroup.nsum_mem, assumption,\n           rule allI, rule impI,  simp add:nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                     Suc i)\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R Suc i\\<^esup>)) na\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow>  (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)\n                         \\<in> carrier R\n 3. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (rule aGroup.nsum_mem, assumption,\n           rule allI, rule impI,  simp add:nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow>  (Suc na choose\n                           0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                 na -\n                                0)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R 0\\<^esup>)\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (simp add:nsClose ring_tOp_closed npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (rule aGroup.ag_pOp_closed, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 3. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (simp add:aGroup.ag_inc_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (rule ring_tOp_closed)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 4. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (simp add:npClose, assumption, simp add:ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R Suc na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply (subst npMulElmL [THEN sym, of \"x \\<plusminus> y\"],\n         simp add:aGroup.ag_pOp_closed, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y) \\<cdot>\\<^sub>r\n                         (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                 Suc i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc na -\n                      Suc i)\\<^esup> \\<cdot>\\<^sub>r\n         y^\\<^bsup>R Suc i\\<^esup>)) na \\<plusminus>\n                           (Suc na choose\n                            0) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (Suc\n                                  na -\n                                 0)\\<^esup> \\<cdot>\\<^sub>r\n                    y^\\<^bsup>R 0\\<^esup>))", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> (x \\<plusminus> y) \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                      i)\\<^esup> \\<cdot>\\<^sub>r\n         (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                          (\\<zero> \\<plusminus>\n                           x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                           x \\<cdot>\\<^sub>r\n                           1\\<^sub>r))", "apply (subst ring_distrib2 [of _ \"x\" \"y\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier R\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na \\<plusminus>\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                      i)\\<^esup> \\<cdot>\\<^sub>r\n         (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                          (\\<zero> \\<plusminus>\n                           x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                           x \\<cdot>\\<^sub>r\n                           1\\<^sub>r))", "apply (rule aGroup.nsum_mem,assumption,\n         rule allI, rule impI, rule nsClose, rule ring_tOp_closed,\n         simp add:npClose, simp add:npClose, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na \\<plusminus>\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<Sigma>\\<^sub>e R (\\<lambda>i.\n            (na choose\n             Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                      i)\\<^esup> \\<cdot>\\<^sub>r\n         (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                          (\\<zero> \\<plusminus>\n                           x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                           x \\<cdot>\\<^sub>r\n                           1\\<^sub>r))", "apply (rule aGroup.gEQAddcross [THEN sym], assumption+,\n         rule aGroup.nsum_mem, assumption, rule allI, rule impI, rule nsClose,\n         (rule ring_tOp_closed)+, simp add:npClose,\n         rule ring_tOp_closed, simp add:npClose, assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r)\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 5. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (rule aGroup.ag_pOp_closed, assumption)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 5. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 6. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (rule aGroup.nsum_mem, assumption,\n           rule allI, rule impI, rule nsClose, rule ring_tOp_closed,\n          simp add:npClose, rule ring_tOp_closed, simp add:npClose, assumption)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus>\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 5. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (rule aGroup.ag_pOp_closed, assumption, simp add:ring_zero)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 5. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply ((rule ring_tOp_closed)+,\n           simp add:npClose,assumption, simp add:ring_one)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 4. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (rule ring_tOp_closed, assumption,\n           rule aGroup.nsum_mem, assumption, rule allI, rule impI,\n           rule nsClose, rule ring_tOp_closed,\n           (simp add:npClose)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n                         \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (rule ring_tOp_closed, assumption+,\n           rule aGroup.nsum_mem, assumption, rule allI, rule impI,\n           rule nsClose,\n           rule ring_tOp_closed,\n           simp add:npClose, simp add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na =\n                         y \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (subst npeSum2_sub_muly [of \"x\" \"y\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "(* final part *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         x \\<cdot>\\<^sub>r\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                 i)\\<^esup> \\<cdot>\\<^sub>r\n    y^\\<^bsup>R i\\<^esup>)) na", "apply (subst npeSum2_sub_mulx2 [of x y], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; aGroup R;\n        (x \\<plusminus> y)^\\<^bsup>R na\\<^esup> =\n        \\<Sigma>\\<^sub>e R (\\<lambda>i.\n                                (na choose\n                                 i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\ni)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup>)) na\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          x \\<cdot>\\<^sub>r\n                          1\\<^sub>r) =\n                         \\<Sigma>\\<^sub>e R (\\<lambda>i.\n           (na choose\n            Suc i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (na -\n                     i)\\<^esup> \\<cdot>\\<^sub>r\n        (y^\\<^bsup>R i\\<^esup> \\<cdot>\\<^sub>r y))) na \\<plusminus>\n                         (\\<zero> \\<plusminus>\n                          x \\<cdot>\\<^sub>r\n                          x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                          1\\<^sub>r)", "apply (frule_tac n = na in npClose[of x],\n         simp add:ring_tOp_commute[of _ x])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in aGroup) nsum_zeroTr:\n  \"\\<And> n. (\\<forall> i. i \\<le> n \\<longrightarrow>  f i = \\<zero>) \\<longrightarrow> (nsum A f n = \\<zero>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>i\\<le>n. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f n = \\<zero>", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       (\\<forall>i\\<le>0. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f 0 = \\<zero>\n 2. \\<And>n na.\n       (\\<forall>i\\<le>na. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f na = \\<zero> \\<Longrightarrow>\n       (\\<forall>i\\<le>Suc na. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc na = \\<zero>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       (\\<forall>i\\<le>na. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f na = \\<zero> \\<Longrightarrow>\n       (\\<forall>i\\<le>Suc na. f i = \\<zero>) \\<longrightarrow>\n       \\<Sigma>\\<^sub>e A f Suc na = \\<zero>", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>(\\<forall>i\\<le>na. f i = \\<zero>) \\<longrightarrow>\n                \\<Sigma>\\<^sub>e A f na = \\<zero>;\n        \\<forall>i\\<le>Suc na. f i = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e A f Suc na = \\<zero>", "apply (cut_tac n = na in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f na = \\<zero>;\n        \\<forall>i\\<le>Suc na. f i = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>", "apply (subst aGroup.ag_l_zero, rule aGroup_axioms)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f na = \\<zero>;\n        \\<forall>i\\<le>Suc na. f i = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> carrier A\n 2. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f na = \\<zero>;\n        \\<forall>i\\<le>Suc na. f i = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> = \\<zero>", "apply (simp add:ag_inc_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>\\<Sigma>\\<^sub>e A f na = \\<zero>;\n        \\<forall>i\\<le>Suc na. f i = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<zero> = \\<zero>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npAdd:\n  \"\\<lbrakk> x \\<in> carrier R; y \\<in> carrier R;\n     npow R x m = \\<zero>; npow R y n = \\<zero> \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<plusminus> y) (m + n) = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R m\\<^esup> = \\<zero>;\n     y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (x \\<plusminus> y)^\\<^bsup>R (m + n)\\<^esup> = \\<zero>", "apply (subst npeSum2, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R m\\<^esup> = \\<zero>;\n     y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R (\\<lambda>i.\n        (m + n choose\n         i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (m + n -\n              i)\\<^esup> \\<cdot>\\<^sub>r\n y^\\<^bsup>R i\\<^esup>)) (m + n) =\n                      \\<zero>", "apply (rule aGroup.nsum_zeroTr [THEN mp])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R m\\<^esup> = \\<zero>;\n     y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> aGroup R\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R m\\<^esup> = \\<zero>;\n     y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>m + n.\n                          (m + n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (m +\n                                n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>) =\n                         \\<zero>", "apply (simp add:ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n     x^\\<^bsup>R m\\<^esup> = \\<zero>;\n     y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>i\\<le>m + n.\n                          (m + n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (m +\n                                n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>) =\n                         \\<zero>", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n\\<rbrakk>\n       \\<Longrightarrow>  (m + n choose\n                           i) \\<times>\\<^bsub>R\\<^esub> (x^\\<^bsup>R (m +\n                                n -\n                                i)\\<^esup> \\<cdot>\\<^sub>r\n                   y^\\<^bsup>R i\\<^esup>) =\n                         \\<zero>", "apply (rule nsZeroI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R i\\<^esup> =\n                         \\<zero>", "apply (rule rMulZeroDiv, simp add:npClose, simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply (case_tac \"i \\<le> n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>\n 2. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply (rule disjI1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero>\n 2. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply (rule npGTPowZero [of \"x\" \"m\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> m \\<le> m + n - i\n 2. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply arith"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R (m + n - i)\\<^esup> = \\<zero> \\<or>\n                         y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply (rule disjI2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> y^\\<^bsup>R i\\<^esup> = \\<zero>", "apply (rule npGTPowZero [of \"y\" \"n\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>i.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R m\\<^esup> = \\<zero>; y^\\<^bsup>R n\\<^esup> = \\<zero>;\n        i \\<le> m + n; \\<not> i \\<le> n\\<rbrakk>\n       \\<Longrightarrow> n \\<le> i", "apply (arith)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npInverse:\n  \"\\<And>n. x \\<in> carrier R\n        \\<Longrightarrow> npow R (-\\<^sub>a x) n = npow R x n\n            \\<or> npow R (-\\<^sub>a x) n = -\\<^sub>a (npow R x n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       (-\\<^sub>a x)^\\<^bsup>R n\\<^esup> = x^\\<^bsup>R n\\<^esup> \\<or>\n       (-\\<^sub>a x)^\\<^bsup>R n\\<^esup> = -\\<^sub>a x^\\<^bsup>R n\\<^esup>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       (-\\<^sub>a x)^\\<^bsup>R 0\\<^esup> = x^\\<^bsup>R 0\\<^esup> \\<or>\n       (-\\<^sub>a x)^\\<^bsup>R 0\\<^esup> = -\\<^sub>a x^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = x^\\<^bsup>R na\\<^esup> \\<or>\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "(* n=0 *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       x \\<in> carrier R \\<Longrightarrow>\n       (-\\<^sub>a x)^\\<^bsup>R 0\\<^esup> = x^\\<^bsup>R 0\\<^esup> \\<or>\n       (-\\<^sub>a x)^\\<^bsup>R 0\\<^esup> = -\\<^sub>a x^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = x^\\<^bsup>R na\\<^esup> \\<or>\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = x^\\<^bsup>R na\\<^esup> \\<or>\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply (subst ring_inv1_2,\n        simp add:npClose, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<or>\n                         (-\\<^sub>a x)^\\<^bsup>R Suc na\\<^esup> =\n                         -\\<^sub>a x^\\<^bsup>R Suc na\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x", "apply (subst ring_inv1_2[THEN sym, of _ x])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<in> carrier R\n 2. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                                   x =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x", "apply (rule aGroup.ag_mOp_closed, assumption+,\n        simp add:npClose, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R;\n        (-\\<^sub>a x)^\\<^bsup>R na\\<^esup> =\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                                   x =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x", "apply (thin_tac \"(-\\<^sub>a x)^\\<^bsup>R na\\<^esup> = -\\<^sub>a (x^\\<^bsup>R na\\<^esup>)\",\n        frule_tac n = na in npClose[of x],\n        frule_tac x = \"x^\\<^bsup>R na\\<^esup>\" in aGroup.ag_mOp_closed[of R], simp add:npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n        x^\\<^bsup>R na\\<^esup> \\<in> carrier R;\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                                   x =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x", "apply (simp add: ring_inv1_1[of _ x])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>x \\<in> carrier R; aGroup R;\n        x^\\<^bsup>R na\\<^esup> \\<in> carrier R;\n        -\\<^sub>a x^\\<^bsup>R na\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (-\\<^sub>a (-\\<^sub>a x^\\<^bsup>R na\\<^esup>)) \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<or>\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         (-\\<^sub>a x) =\n                         (-\\<^sub>a x^\\<^bsup>R na\\<^esup>) \\<cdot>\\<^sub>r\n                         x", "apply (simp add:aGroup.ag_inv_inv[of R])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npMul:\n  \"\\<And> n. \\<lbrakk> x \\<in> carrier R; y \\<in> carrier R \\<rbrakk>\n        \\<Longrightarrow> npow R (x \\<cdot>\\<^sub>r y) n = (npow R x n) \\<cdot>\\<^sub>r (npow R y n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R n\\<^esup> =\n                         x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R n\\<^esup>", "apply (induct_tac \"n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R 0\\<^esup> =\n                         x^\\<^bsup>R 0\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "(* n=0 *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R 0\\<^esup> =\n                         x^\\<^bsup>R 0\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r = 1\\<^sub>r \\<cdot>\\<^sub>r 1\\<^sub>r\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "apply (rule ring_r_one [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "apply (simp add:ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "(* n>0 *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (x \\<cdot>\\<^sub>r y)^\\<^bsup>R Suc na\\<^esup> =\n                         x^\\<^bsup>R Suc na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R Suc na\\<^esup>", "apply (simp only:npow_suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         y^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         (x \\<cdot>\\<^sub>r y) =\n                         x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n                         x \\<cdot>\\<^sub>r\n                         (y^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r y)", "apply (rule ring_tOp_rel[THEN sym])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<in> carrier R\n 2. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> y^\\<^bsup>R na\\<^esup> \\<in> carrier R\n 4. \\<And>n na.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R na\\<^esup> =\n        x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r\n        y^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier R", "apply (rule npClose, assumption+)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Ring homomorphisms\""], ["", "definition\n  rHom :: \"[('a, 'm) Ring_scheme, ('b, 'm1) Ring_scheme]\n                      \\<Rightarrow> ('a  \\<Rightarrow> 'b) set\" where\n  \"rHom A R = {f. f \\<in> aHom A R \\<and>\n    (\\<forall>x\\<in>carrier A. \\<forall>y\\<in>carrier A. f ( x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =  (f x) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (f y))\n    \\<and> f (1\\<^sub>r\\<^bsub>A\\<^esub>) = (1\\<^sub>r\\<^bsub>R\\<^esub>)}\""], ["", "definition\n  rInvim :: \"[('a, 'm) Ring_scheme, ('b, 'm1) Ring_scheme, 'a \\<Rightarrow> 'b, 'b set]\n               \\<Rightarrow> 'a set\" where\n  \"rInvim A R f K = {a. a \\<in> carrier A \\<and> f a \\<in> K}\""], ["", "definition\n  rimg :: \"[('a, 'm) Ring_scheme, ('b, 'm1) Ring_scheme, 'a \\<Rightarrow> 'b] \\<Rightarrow>\n            'b Ring\" where\n  \"rimg A R f = \\<lparr>carrier= f `(carrier A), pop = pop R, mop = mop R,\n    zero = zero R, tp = tp R, un = un R \\<rparr>\""], ["", "definition\n  ridmap :: \"('a, 'm) Ring_scheme \\<Rightarrow> ('a \\<Rightarrow> 'a)\" where\n  \"ridmap R = (\\<lambda>x\\<in>carrier R. x)\""], ["", "definition\n  r_isom :: \"[('a, 'm) Ring_scheme, ('b, 'm1) Ring_scheme] \\<Rightarrow> bool\"\n                       (infixr \"\\<cong>\\<^sub>r\" 100) where\n  \"r_isom R R' \\<longleftrightarrow> (\\<exists>f\\<in>rHom R R'. bijec\\<^bsub>R,R'\\<^esub> f)\""], ["", "definition\n  Subring :: \"[('a, 'm) Ring_scheme, ('a, 'm1) Ring_scheme] \\<Rightarrow> bool\" where\n  \"Subring R S == Ring S \\<and> (carrier S \\<subseteq> carrier R) \\<and> (ridmap S) \\<in> rHom S R\""], ["", "lemma ridmap_surjec:\"Ring A \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> (ridmap A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "by(simp add:surjec_def aHom_def ridmap_def Ring.ring_is_ag aGroup.ag_pOp_closed surj_to_def)"], ["", "lemma rHom_aHom:\"f \\<in> rHom A R \\<Longrightarrow> f \\<in> aHom A R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> rHom A R \\<Longrightarrow> f \\<in> aHom A R", "by (simp add:rHom_def)"], ["", "lemma rimg_carrier:\"f \\<in> rHom A R \\<Longrightarrow> carrier (rimg A R f) = f ` (carrier A)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> rHom A R \\<Longrightarrow> carrier (rimg A R f) = f ` carrier A", "by (simp add:rimg_def)"], ["", "lemma rHom_mem:\"\\<lbrakk> f \\<in> rHom A R; a \\<in> carrier A \\<rbrakk> \\<Longrightarrow> f a \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom A R; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier R", "apply (simp add:rHom_def, frule conjunct1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> aHom A R \\<and>\n             (\\<forall>x\\<in>carrier A.\n                 \\<forall>y\\<in>carrier A.\n                    f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                    f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n             f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n     a \\<in> carrier A; f \\<in> aHom A R\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier R", "apply (thin_tac \"f \\<in> aHom A R \\<and>\n     (\\<forall>x\\<in>carrier A. \\<forall>y\\<in>carrier A. f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) = f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and> f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A; f \\<in> aHom A R\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier R", "apply (simp add:aHom_def, frule conjunct1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A;\n     f \\<in> carrier A \\<rightarrow> carrier R \\<and>\n     f \\<in> extensional (carrier A) \\<and>\n     (\\<forall>a\\<in>carrier A.\n         \\<forall>b\\<in>carrier A.\n            f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n            f a \\<plusminus>\\<^bsub>R\\<^esub> f b);\n     f \\<in> carrier A \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier R", "apply (thin_tac \"f \\<in> carrier A \\<rightarrow> carrier R \\<and>\n     f \\<in> extensional (carrier A) \\<and>\n     (\\<forall>a\\<in>carrier A. \\<forall>b\\<in>carrier A. f (a \\<plusminus>\\<^bsub>A\\<^esub> b) = f a \\<plusminus>\\<^bsub>R\\<^esub> f b)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier A;\n     f \\<in> carrier A \\<rightarrow> carrier R\\<rbrakk>\n    \\<Longrightarrow> f a \\<in> carrier R", "apply (simp add:funcset_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rHom_func:\"f \\<in> rHom A R \\<Longrightarrow> f \\<in> carrier A \\<rightarrow> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. f \\<in> rHom A R \\<Longrightarrow>\n    f \\<in> carrier A \\<rightarrow> carrier R", "by (simp add:rHom_def aHom_def)"], ["", "lemma ringhom1:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n                    f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) = (f x) \\<plusminus>\\<^bsub>R\\<^esub> (f y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> aHom A R \\<and>\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> aHom A R;\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "apply (frule Ring.ring_is_ag [of \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> aHom A R;\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n     aGroup A\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "apply (frule Ring.ring_is_ag [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> aHom A R;\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n     aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "apply (rule aHom_add, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rHom_inv_inv:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R \\<rbrakk>\n \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x) = -\\<^sub>a\\<^bsub>R\\<^esub> (f x)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x) =\n                      -\\<^sub>a\\<^bsub>R\\<^esub> f x", "apply (frule Ring.ring_is_ag [of \"A\"],\n       frule Ring.ring_is_ag [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R; aGroup A;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x) =\n                      -\\<^sub>a\\<^bsub>R\\<^esub> f x", "apply (simp add:rHom_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; aGroup A; aGroup R;\n     f \\<in> aHom A R;\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x) =\n                      -\\<^sub>a\\<^bsub>R\\<^esub> f x", "apply (simp add:aHom_inv_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rHom_0_0:\"\\<lbrakk> Ring A; Ring R; f \\<in> rHom A R \\<rbrakk>  \\<Longrightarrow> f (\\<zero>\\<^bsub>A\\<^esub>) = \\<zero>\\<^bsub>R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>A\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>", "apply (frule Ring.ring_is_ag [of \"A\"], frule Ring.ring_is_ag [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<zero>\\<^bsub>A\\<^esub> = \\<zero>\\<^bsub>R\\<^esub>", "apply (simp add:rHom_def, (erule conjE)+, simp add:aHom_0_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rHom_tOp:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) = (f x) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> (f y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; y \\<in> carrier A;\n     f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                      f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y", "by (simp add:rHom_def)"], ["", "lemma rHom_add:\"\\<lbrakk>f \\<in> rHom A R; x \\<in> carrier A; y \\<in> carrier A\\<rbrakk> \\<Longrightarrow>\n                   f (x \\<plusminus>\\<^bsub>A\\<^esub> y) = (f x) \\<plusminus>\\<^bsub>R\\<^esub> (f y)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>f \\<in> rHom A R; x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                      f x \\<plusminus>\\<^bsub>R\\<^esub> f y", "by (simp add:rHom_def aHom_def)"], ["", "lemma rHom_one:\"\\<lbrakk> Ring A; Ring R;f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> f (1\\<^sub>r\\<^bsub>A\\<^esub>) = (1\\<^sub>r\\<^bsub>R\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "by (simp add:rHom_def)"], ["", "lemma rHom_npow:\"\\<lbrakk> Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                    f (x^\\<^bsup>A n\\<^esup>) = (f x)^\\<^bsup>R n\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f (x^\\<^bsup>A n\\<^esup>) = f x^\\<^bsup>R n\\<^esup>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f (x^\\<^bsup>A 0\\<^esup>) = f x^\\<^bsup>R 0\\<^esup>\n 2. \\<And>n.\n       \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R;\n        f (x^\\<^bsup>A n\\<^esup>) = f x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> f (x^\\<^bsup>A Suc n\\<^esup>) =\n                         f x^\\<^bsup>R Suc n\\<^esup>", "apply (simp add:rHom_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring A; Ring R; x \\<in> carrier A; f \\<in> rHom A R;\n        f (x^\\<^bsup>A n\\<^esup>) = f x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> f (x^\\<^bsup>A Suc n\\<^esup>) =\n                         f x^\\<^bsup>R Suc n\\<^esup>", "apply (simp,\n      frule_tac n = n in Ring.npClose[of \"A\" \"x\"], assumption+,\n      subst rHom_tOp[of \"A\" \"R\" _ \"x\" \"f\"], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rHom_compos:\"\\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C\\<rbrakk> \\<Longrightarrow>\n                   compos A g f \\<in> rHom A C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B;\n     g \\<in> rHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f \\<in> rHom A C", "apply (subst rHom_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B;\n     g \\<in> rHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f \\<in> aHom A C \\<and>\n                      (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             compos A g f\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             compos A g f x \\<cdot>\\<^sub>r\\<^bsub>C\\<^esub>\n                             compos A g f y) \\<and>\n                      compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply (frule Ring.ring_is_ag[of \"A\"], frule Ring.ring_is_ag[of \"B\"],\n       frule Ring.ring_is_ag[of \"C\"],\n       frule rHom_aHom[of \"f\" \"A\" \"B\"], frule rHom_aHom[of \"g\" \"B\" \"C\"],\n       simp add:aHom_compos)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             compos A g f\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             compos A g f x \\<cdot>\\<^sub>r\\<^bsub>C\\<^esub>\n                             compos A g f y) \\<and>\n                      compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         \\<forall>y\\<in>carrier A.\n                            compos A g f\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                            compos A g f x \\<cdot>\\<^sub>r\\<^bsub>C\\<^esub>\n                            compos A g f y\n 2. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply ((rule ballI)+, simp add:compos_def compose_def,\n        frule_tac x = x and y = y in Ring.ring_tOp_closed[of \"A\"], assumption+,\n        simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n        aGroup A; aGroup B; aGroup C; f \\<in> aHom A B; g \\<in> aHom B C;\n        x \\<in> carrier A; y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> g (f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y)) =\n                         g (f x) \\<cdot>\\<^sub>r\\<^bsub>C\\<^esub> g (f y)\n 2. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply (simp add:rHom_tOp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n        aGroup A; aGroup B; aGroup C; f \\<in> aHom A B; g \\<in> aHom B C;\n        x \\<in> carrier A; y \\<in> carrier A;\n        x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> g (f x \\<cdot>\\<^sub>r\\<^bsub>B\\<^esub> f y) =\n                         g (f x) \\<cdot>\\<^sub>r\\<^bsub>C\\<^esub> g (f y)\n 2. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply (frule_tac a = x in rHom_mem[of \"f\" \"A\" \"B\"], assumption+,\n        frule_tac a = y in rHom_mem[of \"f\" \"A\" \"B\"], assumption+,\n         simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring B; Ring C; f \\<in> rHom A B; g \\<in> rHom B C;\n     aGroup A; aGroup B; aGroup C; f \\<in> aHom A B;\n     g \\<in> aHom B C\\<rbrakk>\n    \\<Longrightarrow> compos A g f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>C\\<^esub>", "apply (frule Ring.ring_one[of \"A\"], frule Ring.ring_one[of \"B\"],\n        simp add:compos_def compose_def, simp add:rHom_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rimg_ag:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> aGroup (rimg A R f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> aGroup (rimg A R f)", "apply (frule Ring.ring_is_ag [of \"A\"],\n       frule Ring.ring_is_ag [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> aGroup (rimg A R f)", "apply (simp add:rHom_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> aGroup (rimg A R f)", "apply (subst aGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ((\\<plusminus>\\<^bsub>rimg A R f\\<^esub>)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a b c.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           c =\n                           a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            c)) \\<and>\n                       (\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a)) \\<and>\n                      (mop (rimg A R f)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           -\\<^sub>a\\<^bsub>rimg A R f\\<^esub> a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub>)) \\<and>\n                      \\<zero>\\<^bsub>rimg A R f\\<^esub>\n                      \\<in> carrier (rimg A R f) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (simp add:rimg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>R\\<^esub>)\n                      \\<in> f ` carrier A \\<rightarrow>\n                            f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>R\\<^esub>)\n                      \\<in> f ` carrier A \\<rightarrow>\n                            f ` carrier A \\<rightarrow> f ` carrier A\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> f ` carrier A; xa \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub> xa\n                         \\<in> f ` carrier A\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        \\<exists>xa\\<in>carrier A. x = f xa;\n        \\<exists>x\\<in>carrier A. xa = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb\\<in>carrier A.\n                            x \\<plusminus>\\<^bsub>R\\<^esub> xa = f xb\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb xc.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        xb \\<in> carrier A; x = f xb; xc \\<in> carrier A; xa = f xc\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xb\\<in>carrier A.\n                            x \\<plusminus>\\<^bsub>R\\<^esub> xa = f xb\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb xc.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        xb \\<in> carrier A; x = f xb; xc \\<in> carrier A; xa = f xc\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                            f xb \\<plusminus>\\<^bsub>R\\<^esub> f xc = f x\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (subst aHom_add [THEN sym, of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa xb xc.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        xb \\<in> carrier A; x = f xb; xc \\<in> carrier A; xa = f xc\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                            f (xb \\<plusminus>\\<^bsub>A\\<^esub> xc) = f x\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (blast dest: aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> f ` carrier A \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> f ` carrier A \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> f ` carrier A \\<longrightarrow>\n                                 a \\<plusminus>\\<^bsub>R\\<^esub>\n                                 b \\<plusminus>\\<^bsub>R\\<^esub>\n                                 c =\n                                 a \\<plusminus>\\<^bsub>R\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>R\\<^esub> c)))\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply ((rule allI, rule impI)+, simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c x xa xb.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x; xa \\<in> carrier A; b = f xa;\n        xb \\<in> carrier A; c = f xb\\<rbrakk>\n       \\<Longrightarrow> f x \\<plusminus>\\<^bsub>R\\<^esub>\n                         f xa \\<plusminus>\\<^bsub>R\\<^esub>\n                         f xb =\n                         f x \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f xa \\<plusminus>\\<^bsub>R\\<^esub> f xb)\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (frule_tac x = x and y = xa in aGroup.ag_pOp_closed, assumption+,\n        frule_tac x = xa and y = xb in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c x xa xb.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x; xa \\<in> carrier A; b = f xa;\n        xb \\<in> carrier A; c = f xb;\n        x \\<plusminus>\\<^bsub>A\\<^esub> xa \\<in> carrier A;\n        xa \\<plusminus>\\<^bsub>A\\<^esub> xb \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f x \\<plusminus>\\<^bsub>R\\<^esub>\n                         f xa \\<plusminus>\\<^bsub>R\\<^esub>\n                         f xb =\n                         f x \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f xa \\<plusminus>\\<^bsub>R\\<^esub> f xb)\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:aHom_add[of \"A\" \"R\" \"f\", THEN sym] aGroup.ag_pOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> f ` carrier A \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                              b \\<plusminus>\\<^bsub>R\\<^esub> a)) \\<and>\n                      mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> f ` carrier A \\<longrightarrow>\n                             a \\<plusminus>\\<^bsub>R\\<^esub> b =\n                             b \\<plusminus>\\<^bsub>R\\<^esub> a)\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply ((rule allI, rule impI)+, simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b x xa.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x; xa \\<in> carrier A; b = f xa\\<rbrakk>\n       \\<Longrightarrow> f x \\<plusminus>\\<^bsub>R\\<^esub> f xa =\n                         f xa \\<plusminus>\\<^bsub>R\\<^esub> f x\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:aHom_add[of \"A\" \"R\" \"f\", THEN sym] aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> mop R\n                      \\<in> f ` carrier A \\<rightarrow> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> mop R \\<in> f ` carrier A \\<rightarrow> f ` carrier A\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> x \\<in> f ` carrier A\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:image_def, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        xa \\<in> carrier A; x = f xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                            -\\<^sub>a\\<^bsub>R\\<^esub> f xa = f x\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:aHom_inv_inv[THEN sym],\n        frule_tac x = xa in aGroup.ag_mOp_closed[of \"A\"], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> a \\<plusminus>\\<^bsub>R\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI, simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a x.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> f\n               x \\<plusminus>\\<^bsub>R\\<^esub>\n                         f x =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:aHom_inv_inv[THEN sym],\n        frule_tac x = x in aGroup.ag_mOp_closed[of \"A\"], assumption+,\n        simp add:aHom_add[of \"A\" \"R\" \"f\", THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a x.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x;\n        -\\<^sub>a\\<^bsub>A\\<^esub> x \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (-\\<^sub>a\\<^bsub>A\\<^esub> x \\<plusminus>\\<^bsub>A\\<^esub>\n                            x) =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.ag_l_inv1 aHom_0_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A \\<and>\n                      (\\<forall>a.\n                          a \\<in> f ` carrier A \\<longrightarrow>\n                          \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> f ` carrier A\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                         a =\n                         a", "apply (simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                         \\<zero>\\<^bsub>R\\<^esub> = f x\n 2. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                         a =\n                         a", "apply (frule aHom_0_0[THEN sym, of \"A\" \"R\" \"f\"], assumption+,\n        frule Ring.ring_zero[of \"A\"], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n     \\<forall>x\\<in>carrier A.\n        \\<forall>y\\<in>carrier A.\n           f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n           f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> f ` carrier A \\<longrightarrow>\n                         \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI,\n       simp add:image_def, erule bexE,\n       frule_tac a = x in aHom_mem[of \"A\" \"R\" \"f\"], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a x.\n       \\<lbrakk>Ring A; Ring R; aGroup A; aGroup R; f \\<in> aHom A R;\n        \\<forall>x\\<in>carrier A.\n           \\<forall>y\\<in>carrier A.\n              f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n              f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y;\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        x \\<in> carrier A; a = f x; f x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<plusminus>\\<^bsub>R\\<^esub>\n                         f x =\n                         f x", "apply (simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rimg_ring:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow> Ring (rimg A R f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> Ring (rimg A R f)", "apply (unfold Ring_def [of \"rimg A R f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (((\\<plusminus>\\<^bsub>rimg A R f\\<^esub>)\n                        \\<in> carrier (rimg A R f) \\<rightarrow>\n                              carrier (rimg A R f) \\<rightarrow>\n                              carrier (rimg A R f) \\<and>\n                        (\\<forall>a b c.\n                            a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            c =\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                             c)) \\<and>\n                        (\\<forall>a b.\n                            a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> b =\n                            b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            a)) \\<and>\n                       mop (rimg A R f)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           -\\<^sub>a\\<^bsub>rimg A R f\\<^esub> a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub>) \\<and>\n                       \\<zero>\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      ((\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           a) \\<and>\n                       (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a b c.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           c =\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                            c))) \\<and>\n                      ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (frule rimg_ag[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (((\\<plusminus>\\<^bsub>rimg A R f\\<^esub>)\n                        \\<in> carrier (rimg A R f) \\<rightarrow>\n                              carrier (rimg A R f) \\<rightarrow>\n                              carrier (rimg A R f) \\<and>\n                        (\\<forall>a b c.\n                            a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            c =\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                             c)) \\<and>\n                        (\\<forall>a b.\n                            a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                            a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> b =\n                            b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                            a)) \\<and>\n                       mop (rimg A R f)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           -\\<^sub>a\\<^bsub>rimg A R f\\<^esub> a \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub>) \\<and>\n                       \\<zero>\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      ((\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           a) \\<and>\n                       (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a b c.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           c =\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                            c))) \\<and>\n                      ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI, simp add:aGroup_def[of \"rimg A R f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                           a =\n                           a) \\<and>\n                       (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                       \\<in> carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<rightarrow>\n                             carrier (rimg A R f) \\<and>\n                       (\\<forall>a b c.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           c =\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                            c))) \\<and>\n                      ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply(rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                      \\<in> carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI, rule allI, rule impI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        a \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>rimg A R f\\<^esub> \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                      \\<in> carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c))\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (frule aGroup.ag_inc_zero[of \"rimg A R f\"],\n        subst aGroup.ag_pOp_commute, assumption+,\n        simp add:aGroup.ag_r_zero[of \"rimg A R f\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                      \\<in> carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>)\n                      \\<in> carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f) \\<rightarrow>\n                            carrier (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b c.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        x \\<in> carrier (rimg A R f); xa \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> xa\n                         \\<in> carrier (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b c.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (thin_tac \"aGroup (rimg A R f)\",\n       simp add:rimg_def, simp add:image_def, (erule bexE)+,\n       simp add:rHom_tOp[THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa xb xc.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; xb \\<in> carrier A;\n        x = f xb; xc \\<in> carrier A; xa = f xc\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                            f (xb \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> xc) = f x\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b c.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (blast dest:Ring.ring_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a b c.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply ((rule allI)+, (rule impI)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        a \\<in> carrier (rimg A R f); b \\<in> carrier (rimg A R f);\n        c \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (thin_tac \"aGroup (rimg A R f)\", simp add:rimg_def,\n        simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c x xa xb.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; x \\<in> carrier A;\n        a = f x; xa \\<in> carrier A; b = f xa; xb \\<in> carrier A;\n        c = f xb\\<rbrakk>\n       \\<Longrightarrow> f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         f xa \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         f xb =\n                         f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         (f xa \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f xb)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (frule_tac x = x and y = xa in Ring.ring_tOp_closed, assumption+,\n        frule_tac x = xa and y = xb in Ring.ring_tOp_closed, assumption+,\n        simp add:rHom_tOp[THEN sym],\n        simp add:Ring.ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ((\\<forall>a b.\n                           a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                           a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                           b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                           a) \\<and>\n                       1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                       \\<in> carrier (rimg A R f)) \\<and>\n                      (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI, rule conjI, (rule allI)+, (rule impI)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        a \\<in> carrier (rimg A R f); b \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> a\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                      \\<in> carrier (rimg A R f)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (thin_tac \"aGroup (rimg A R f)\", simp add:rimg_def,\n        simp add:image_def, (erule bexE)+, simp,\n        simp add:rHom_tOp[THEN sym],\n        simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                      \\<in> carrier (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (thin_tac \"aGroup (rimg A R f)\", simp add:rimg_def,\n         simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>carrier A.\n                         1\\<^sub>r\\<^bsub>R\\<^esub> = f x\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (subst rHom_one [THEN sym, of \"A\" \"R\" \"f\"], assumption+,\n         frule Ring.ring_one[of \"A\"], blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a b c.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          b \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          c \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                          a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          c) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                          a =\n                          a)", "apply (rule conjI, (rule allI)+, (rule impI)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        a \\<in> carrier (rimg A R f); b \\<in> carrier (rimg A R f);\n        c \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         (b \\<plusminus>\\<^bsub>rimg A R f\\<^esub> c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         b \\<plusminus>\\<^bsub>rimg A R f\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub> c\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a", "apply (simp add:rimg_def, fold rimg_def,\n       simp add:image_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c x xa xb.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        x \\<in> carrier A; a = f x; xa \\<in> carrier A; b = f xa;\n        xb \\<in> carrier A; c = f xb\\<rbrakk>\n       \\<Longrightarrow> f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         (f xa \\<plusminus>\\<^bsub>R\\<^esub> f xb) =\n                         f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         f xa \\<plusminus>\\<^bsub>R\\<^esub>\n                         f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f xb\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a", "apply (frule rHom_aHom[of \"f\" \"A\" \"R\"],\n        frule Ring.ring_is_ag [of \"A\"],\n        frule Ring.ring_is_ag [of \"R\"],\n        simp add:aHom_add[THEN sym],\n        simp add:rHom_tOp[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c x xa xb.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f);\n        x \\<in> carrier A; a = f x; xa \\<in> carrier A; b = f xa;\n        xb \\<in> carrier A; c = f xb; f \\<in> aHom A R; aGroup A;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         f (xa \\<plusminus>\\<^bsub>A\\<^esub> xb) =\n                         f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            xa) \\<plusminus>\\<^bsub>R\\<^esub>\n                         f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> xb)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a", "apply (frule_tac x = xa and y = xb in aGroup.ag_pOp_closed[of \"A\"],\n          assumption+,\n        frule_tac x = x and y = xa in Ring.ring_tOp_closed[of \"A\"],\n          assumption+,\n        frule_tac x = x and y = xb in Ring.ring_tOp_closed[of \"A\"],\n          assumption+,\n        simp add:aHom_add[THEN sym],\n        simp add:rHom_tOp[THEN sym],\n        simp add:Ring.ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (rimg A R f) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI,\n        thin_tac \"aGroup (rimg A R f)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>rimg A R f\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                         a =\n                         a", "apply (simp add:rimg_def,\n        simp add:image_def, erule bexE, simp add:rHom_tOp[THEN sym],\n        frule_tac a = x in rHom_mem[of \"f\" \"A\" \"R\"], assumption+,\n         simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ideal :: \"[_ , 'a set] \\<Rightarrow> bool\" where\n  \"ideal R I \\<longleftrightarrow> (R +> I) \\<and> (\\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x \\<in> I))\""], ["", "lemma (in Ring) ideal_asubg:\"ideal R I \\<Longrightarrow> R +> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> R +> I", "by (simp add:ideal_def)"], ["", "lemma (in Ring) ideal_pOp_closed:\"\\<lbrakk>ideal R I; x \\<in> I; y \\<in> I \\<rbrakk>\n                                                   \\<Longrightarrow> x \\<plusminus> y \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; y \\<in> I\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> I", "apply (unfold ideal_def, frule conjunct1, fold ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; y \\<in> I; R +> I\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> y \\<in> I", "apply (cut_tac ring_is_ag,\n       simp add:aGroup.asubg_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_nsum_closedTr:\"ideal R I \\<Longrightarrow>\n                                      (\\<forall>j \\<le> n. f j \\<in> I) \\<longrightarrow>  nsum R f n \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    (\\<forall>j\\<le>n. f j \\<in> I) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f n \\<in> I", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    (\\<forall>j\\<le>0. f j \\<in> I) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f 0 \\<in> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        (\\<forall>j\\<le>n. f j \\<in> I) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> I) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> I", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; \\<forall>j\\<le>0. f j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f 0 \\<in> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        (\\<forall>j\\<le>n. f j \\<in> I) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> I) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I;\n        (\\<forall>j\\<le>n. f j \\<in> I) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> I\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>j\\<le>Suc n.\n                             f j \\<in> I) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> I", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I;\n        (\\<forall>j\\<le>n. f j \\<in> I) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> I;\n        \\<forall>j\\<le>Suc n. f j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<in> I", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; \\<Sigma>\\<^sub>e R f n \\<in> I;\n        \\<forall>j\\<le>Suc n. f j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> I", "apply (rule ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; \\<Sigma>\\<^sub>e R f n \\<in> I;\n        \\<forall>j\\<le>Suc n. f j \\<in> I\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> I", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_nsum_closed:\"\\<lbrakk>ideal R I; \\<forall>j \\<le> n. f j \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                             nsum R f n \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; \\<forall>j\\<le>n. f j \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> I", "by (simp add:ideal_nsum_closedTr)"], ["", "lemma (in Ring) ideal_subset1:\"ideal R I \\<Longrightarrow> I \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<subseteq> carrier R", "apply (unfold ideal_def, frule conjunct1, fold ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; R +> I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> carrier R", "apply (simp add:asubGroup_def sg_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; I \\<noteq> {}; I \\<subseteq> carrier (b_ag R);\n     \\<forall>a\\<in>I.\n        \\<forall>b\\<in>I.\n           a \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> b\n           \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> carrier R", "apply (cut_tac ring_is_ag,\n         simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_subset:\"\\<lbrakk>ideal R I; h \\<in> I\\<rbrakk> \\<Longrightarrow> h \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; h \\<in> I\\<rbrakk>\n    \\<Longrightarrow> h \\<in> carrier R", "by (frule ideal_subset1[of \"I\"],\n       simp add:subsetD)"], ["", "lemma (in Ring) ideal_ring_multiple:\"\\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n       r \\<cdot>\\<^sub>r x \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> I", "by (simp add:ideal_def)"], ["", "lemma (in Ring) ideal_ring_multiple1:\"\\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R \\<rbrakk> \\<Longrightarrow>\n       x \\<cdot>\\<^sub>r r \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r r \\<in> I", "apply (frule ideal_subset[of \"I\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; r \\<in> carrier R;\n     x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r r \\<in> I", "apply (simp add:ring_tOp_commute ideal_ring_multiple)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_npow_closedTr:\"\\<lbrakk>ideal R I; x \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> 0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I", "apply (induct_tac n,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\\<rbrakk>\n       \\<Longrightarrow> 0 < Suc n \\<longrightarrow>\n                         x^\\<^bsup>R Suc n\\<^esup> \\<in> I", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I;\n        0 < Suc n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x \\<in> I", "apply (case_tac \"n = 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I; n = 0\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r x \\<in> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I;\n        n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x \\<in> I", "apply (frule ideal_subset[of \"I\" \"x\"], assumption+,\n        simp add:ring_l_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        0 < n \\<longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I;\n        n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I; x \\<in> I; x^\\<^bsup>R n\\<^esup> \\<in> I;\n        0 < n\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x \\<in> I", "apply (frule ideal_subset[of \"I\" \"x\"], assumption+,\n       rule ideal_ring_multiple, assumption+,\n       simp add:ideal_subset)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_npow_closed:\"\\<lbrakk>ideal R I; x \\<in> I; 0 < n\\<rbrakk> \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; 0 < n\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<in> I", "by (simp add:ideal_npow_closedTr)"], ["", "lemma (in Ring) times_modTr:\"\\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n b' \\<in> carrier R; ideal R I; a \\<plusminus> (-\\<^sub>a b) \\<in> I; a' \\<plusminus> (-\\<^sub>a b') \\<in> I\\<rbrakk> \\<Longrightarrow>\n                           a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a (b \\<cdot>\\<^sub>r b')) \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b'\n                      \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b'\n                      \\<in> I", "apply (subgoal_tac \"a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a (b \\<cdot>\\<^sub>r b')) = a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a (a \\<cdot>\\<^sub>r b'))\n                       \\<plusminus> (a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a (b \\<cdot>\\<^sub>r b')))\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r a' \\<plusminus>\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus>\n      -\\<^sub>a b \\<cdot>\\<^sub>r b')\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b'\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r a' \\<plusminus>\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus>\n      -\\<^sub>a b \\<cdot>\\<^sub>r b')\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (simp add:ring_inv1_2[of \"a\" \"b'\"], simp add:ring_inv1_1[of \"b\" \"b'\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r a' \\<plusminus>\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b') \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus>\n      (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b') \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (frule aGroup.ag_mOp_closed[of \"R\" \"b'\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r a' \\<plusminus>\n     a \\<cdot>\\<^sub>r (-\\<^sub>a b') \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b');\n     -\\<^sub>a b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      a \\<cdot>\\<^sub>r (-\\<^sub>a b') \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (simp add:ring_distrib1[THEN sym, of \"a\" \"a'\" \"-\\<^sub>a b'\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b');\n     -\\<^sub>a b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (frule aGroup.ag_mOp_closed[of \"R\" \"b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b');\n     -\\<^sub>a b' \\<in> carrier R; -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (frule ring_distrib2[THEN sym, of \"b'\" \"a\" \"-\\<^sub>a b\" ], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n     (a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b');\n     -\\<^sub>a b' \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (-\\<^sub>a b) \\<cdot>\\<^sub>r b')\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b';\n     -\\<^sub>a b' \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' =\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (thin_tac \"a \\<cdot>\\<^sub>r a' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' = a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<plusminus> (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\",\n       thin_tac \"a \\<cdot>\\<^sub>r b' \\<plusminus> (-\\<^sub>a b) \\<cdot>\\<^sub>r b' = (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     -\\<^sub>a b' \\<in> carrier R; -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (frule ideal_ring_multiple[of \"I\" \"a' \\<plusminus> (-\\<^sub>a b')\" \"a\"], assumption+,\n        frule ideal_ring_multiple1[of \"I\" \"a \\<plusminus> (-\\<^sub>a b)\" \"b'\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     -\\<^sub>a b' \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r (a' \\<plusminus> -\\<^sub>a b') \\<in> I;\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b' \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r\n                      (a' \\<plusminus> -\\<^sub>a b') \\<plusminus>\n                      (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r b'\n                      \\<in> I\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (simp add:ideal_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (frule ring_tOp_closed[of \"a\" \"a'\"], assumption+,\n       frule ring_tOp_closed[of \"a\" \"b'\"], assumption+,\n       frule ring_tOp_closed[of \"b\" \"b'\"], assumption+,\n       frule aGroup.ag_mOp_closed[of \"R\" \"b \\<cdot>\\<^sub>r b'\"], assumption+,\n       frule aGroup.ag_mOp_closed[of \"R\" \"a \\<cdot>\\<^sub>r b'\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       -\\<^sub>a b \\<cdot>\\<^sub>r b')", "apply (subst aGroup.ag_pOp_assoc[of \"R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b'\n                      \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      (-\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                        -\\<^sub>a b \\<cdot>\\<^sub>r b'))", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a' \\<in> carrier R; b \\<in> carrier R;\n     b' \\<in> carrier R; ideal R I; a \\<plusminus> -\\<^sub>a b \\<in> I;\n     a' \\<plusminus> -\\<^sub>a b' \\<in> I; aGroup R;\n     a \\<cdot>\\<^sub>r a' \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a b \\<cdot>\\<^sub>r b' \\<in> carrier R;\n     -\\<^sub>a a \\<cdot>\\<^sub>r b' \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      -\\<^sub>a b \\<cdot>\\<^sub>r b' =\n                      a \\<cdot>\\<^sub>r a' \\<plusminus>\n                      (-\\<^sub>a a \\<cdot>\\<^sub>r b' \\<plusminus>\n                       (a \\<cdot>\\<^sub>r b' \\<plusminus>\n                        -\\<^sub>a b \\<cdot>\\<^sub>r b'))", "apply (simp add:aGroup.ag_pOp_assoc[THEN sym, of \"R\" \"-\\<^sub>a (a \\<cdot>\\<^sub>r b')\" \"a \\<cdot>\\<^sub>r b'\"\n                          \"-\\<^sub>a (b \\<cdot>\\<^sub>r b')\"],\n        simp add:aGroup.ag_l_inv1 aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inv1_closed:\"\\<lbrakk> ideal R I; x \\<in> I \\<rbrakk> \\<Longrightarrow> -\\<^sub>a x \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> I", "apply (unfold ideal_def, frule conjunct1, fold ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; x \\<in> I; aGroup R; R +> I\\<rbrakk>\n    \\<Longrightarrow> -\\<^sub>a x \\<in> I", "apply (simp add:aGroup.asubg_mOp_closed[of \"R\" \"I\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_zero:\"ideal R I  \\<Longrightarrow> \\<zero> \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> \\<zero> \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk> \\<Longrightarrow> \\<zero> \\<in> I", "apply (unfold ideal_def, frule conjunct1, fold ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> I", "apply (simp add:aGroup.asubg_inc_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_zero_forall:\"\\<forall>I. ideal R I \\<longrightarrow>  \\<zero> \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>I. ideal R I \\<longrightarrow> \\<zero> \\<in> I", "by (simp add:ideal_zero)"], ["", "lemma (in Ring) ideal_ele_sumTr1:\"\\<lbrakk> ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n          a \\<plusminus> b \\<in> I; a \\<in> I \\<rbrakk> \\<Longrightarrow> b \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<plusminus> b \\<in> I; a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> b \\<in> I", "apply (frule ideal_inv1_closed[of \"I\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<plusminus> b \\<in> I; a \\<in> I; -\\<^sub>a a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> b \\<in> I", "apply (frule ideal_pOp_closed[of \"I\" \"-\\<^sub>a a\" \"a \\<plusminus> b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<plusminus> b \\<in> I; a \\<in> I; -\\<^sub>a a \\<in> I;\n     -\\<^sub>a a \\<plusminus> (a \\<plusminus> b) \\<in> I\\<rbrakk>\n    \\<Longrightarrow> b \\<in> I", "apply (frule ideal_subset[of \"I\" \"-\\<^sub>a a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<plusminus> b \\<in> I; a \\<in> I; -\\<^sub>a a \\<in> I;\n     -\\<^sub>a a \\<plusminus> (a \\<plusminus> b) \\<in> I;\n     -\\<^sub>a a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b \\<in> I", "apply (cut_tac ring_is_ag,\n       simp add:aGroup.ag_pOp_assoc[THEN sym],\n       simp add:aGroup.ag_l_inv1,\n       simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_ele_sumTr2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n                a \\<plusminus> b \\<in> I; b \\<in> I\\<rbrakk> \\<Longrightarrow> a \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<plusminus> b \\<in> I; b \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (cut_tac ring_is_ag,\n       simp add:aGroup.ag_pOp_commute[of \"R\" \"a\" \"b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> a \\<in> I; b \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (simp add:ideal_ele_sumTr1[of \"I\" \"b\" \"a\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_condition:\"\\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n       \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> (-\\<^sub>a y) \\<in> I; \\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I \\<rbrakk> \\<Longrightarrow>\n                                   ideal R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> -\\<^sub>a y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> ideal R I", "apply (simp add:ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> -\\<^sub>a y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> R +> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> -\\<^sub>a y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> R +> I", "apply (rule aGroup.asubg_test[of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_condition1:\"\\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n  \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I; \\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I \\<rbrakk> \\<Longrightarrow> ideal R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> ideal R I", "apply (rule ideal_condition[of \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I.\n                         \\<forall>y\\<in>I.\n                            x \\<plusminus> -\\<^sub>a y \\<in> I\n 2. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n        \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n        \\<forall>r\\<in>carrier R.\n           \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n        x \\<in> I; y \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> I\n 2. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I", "apply (cut_tac ring_is_ag,\n       cut_tac ring_one,\n       frule aGroup.ag_mOp_closed[of \"R\" \"1\\<^sub>r\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n        \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n        \\<forall>r\\<in>carrier R.\n           \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n        x \\<in> I; y \\<in> I; aGroup R; 1\\<^sub>r \\<in> carrier R;\n        -\\<^sub>a 1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> I\n 2. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I", "apply (frule_tac x = \"-\\<^sub>a 1\\<^sub>r \" in bspec, assumption+,\n        thin_tac \"\\<forall>r\\<in>carrier R. \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\",\n        rotate_tac -1,\n        frule_tac x = y in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>I. (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r x \\<in> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n        \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n        x \\<in> I; y \\<in> I; aGroup R; 1\\<^sub>r \\<in> carrier R;\n        -\\<^sub>a 1\\<^sub>r \\<in> carrier R;\n        (-\\<^sub>a 1\\<^sub>r) \\<cdot>\\<^sub>r y \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a y \\<in> I\n 2. \\<lbrakk>I \\<subseteq> carrier R; I \\<noteq> {};\n     \\<forall>x\\<in>I. \\<forall>y\\<in>I. x \\<plusminus> y \\<in> I;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I", "apply (frule_tac c = y in subsetD[of \"I\" \"carrier R\"], assumption+,\n        simp add:ring_times_minusl[THEN sym], simp add:ideal_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) zero_ideal:\"ideal R {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R {\\<zero>}", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow> ideal R {\\<zero>}", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. aGroup R \\<Longrightarrow> {\\<zero>} \\<subseteq> carrier R\n 2. aGroup R \\<Longrightarrow> {\\<zero>} \\<noteq> {}\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>{\\<zero>}.\n       \\<forall>y\\<in>{\\<zero>}. x \\<plusminus> y \\<in> {\\<zero>}\n 4. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>{\\<zero>}. r \\<cdot>\\<^sub>r x \\<in> {\\<zero>}", "apply (simp add:ring_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. aGroup R \\<Longrightarrow> {\\<zero>} \\<noteq> {}\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>{\\<zero>}.\n       \\<forall>y\\<in>{\\<zero>}. x \\<plusminus> y \\<in> {\\<zero>}\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>{\\<zero>}. r \\<cdot>\\<^sub>r x \\<in> {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>{\\<zero>}.\n       \\<forall>y\\<in>{\\<zero>}. x \\<plusminus> y \\<in> {\\<zero>}\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>{\\<zero>}. r \\<cdot>\\<^sub>r x \\<in> {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow> \\<zero> \\<plusminus> \\<zero> = \\<zero>\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>{\\<zero>}. r \\<cdot>\\<^sub>r x \\<in> {\\<zero>}", "apply (cut_tac ring_zero, simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>{\\<zero>}. r \\<cdot>\\<^sub>r x \\<in> {\\<zero>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R. r \\<cdot>\\<^sub>r \\<zero> = \\<zero>", "apply (rule ballI, simp add:ring_times_x_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) whole_ideal:\"ideal R (carrier R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R (carrier R)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. carrier R \\<subseteq> carrier R\n 2. carrier R \\<noteq> {}\n 3. \\<forall>x\\<in>carrier R.\n       \\<forall>y\\<in>carrier R. x \\<plusminus> y \\<in> carrier R\n 4. \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>carrier R. r \\<cdot>\\<^sub>r x \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. carrier R \\<noteq> {}\n 2. \\<forall>x\\<in>carrier R.\n       \\<forall>y\\<in>carrier R. x \\<plusminus> y \\<in> carrier R\n 3. \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>carrier R. r \\<cdot>\\<^sub>r x \\<in> carrier R", "apply (cut_tac ring_zero, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>x\\<in>carrier R.\n       \\<forall>y\\<in>carrier R. x \\<plusminus> y \\<in> carrier R\n 2. \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>carrier R. r \\<cdot>\\<^sub>r x \\<in> carrier R", "apply (cut_tac ring_is_ag,\n        simp add:aGroup.ag_pOp_closed,\n        simp add:ring_tOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inc_one:\"\\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I \\<rbrakk> \\<Longrightarrow> I = carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I = carrier R", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> carrier R \\<subseteq> I", "apply (simp add:ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> carrier R \\<subseteq> I", "apply (rule subsetI,\n       frule_tac r = x in ideal_ring_multiple[of \"I\" \"1\\<^sub>r\"], assumption+,\n       simp add:ring_r_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inc_one1:\"ideal R I \\<Longrightarrow>\n                              (1\\<^sub>r \\<in> I) = (I = carrier R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> (1\\<^sub>r \\<in> I) = (I = carrier R)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I = carrier R\n 2. \\<lbrakk>ideal R I; I = carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> I", "apply (simp add:ideal_inc_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; I = carrier R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> I", "apply (frule sym, thin_tac \"I = carrier R\",\n        cut_tac ring_one, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  Unit :: \"_ \\<Rightarrow> 'a \\<Rightarrow> bool\" where\n  \"Unit R a \\<longleftrightarrow> a \\<in> carrier R \\<and> (\\<exists>b\\<in>carrier R. a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> b = 1\\<^sub>r\\<^bsub>R\\<^esub>)\""], ["", "lemma (in Ring) ideal_inc_unit:\"\\<lbrakk>ideal R I; a \\<in> I; Unit R a\\<rbrakk> \\<Longrightarrow> 1\\<^sub>r \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I; Unit R a\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> I", "by (simp add:Unit_def, erule conjE, erule bexE,\n       frule_tac r = b in ideal_ring_multiple1[of \"I\" \"a\"], assumption+,\n       simp)"], ["", "lemma (in Ring) proper_ideal:\"\\<lbrakk>ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk> \\<Longrightarrow> I \\<noteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> carrier R", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R (carrier R); 1\\<^sub>r \\<notin> carrier R;\n     I = carrier R\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add: ring_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_inc_unit1:\"\\<lbrakk>a \\<in> carrier R; Unit R a; ideal R I; a \\<in> I\\<rbrakk>\n                        \\<Longrightarrow> I = carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; Unit R a; ideal R I; a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I = carrier R", "apply (frule ideal_inc_unit[of \"I\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; Unit R a; ideal R I; a \\<in> I;\n     1\\<^sub>r \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I = carrier R", "apply (rule ideal_inc_one[of \"I\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) int_ideal:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow> ideal R (I \\<inter> J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> ideal R (I \\<inter> J)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> J \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<inter> J.\n                         \\<forall>y\\<in>I \\<inter> J.\n                            x \\<plusminus> y \\<in> I \\<inter> J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<inter> J.\n                            r \\<cdot>\\<^sub>r x \\<in> I \\<inter> J", "apply (frule ideal_subset1[of \"I\"], frule ideal_subset1[of \"J\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J; I \\<subseteq> carrier R;\n     J \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> J \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<inter> J.\n                         \\<forall>y\\<in>I \\<inter> J.\n                            x \\<plusminus> y \\<in> I \\<inter> J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<inter> J.\n                            r \\<cdot>\\<^sub>r x \\<in> I \\<inter> J", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> J \\<noteq> {}\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<inter> J.\n                         \\<forall>y\\<in>I \\<inter> J.\n                            x \\<plusminus> y \\<in> I \\<inter> J\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<inter> J.\n                            r \\<cdot>\\<^sub>r x \\<in> I \\<inter> J", "apply (frule ideal_zero[of \"I\"], frule ideal_zero[of \"J\"], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<inter> J.\n                         \\<forall>y\\<in>I \\<inter> J.\n                            x \\<plusminus> y \\<in> I \\<inter> J\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<inter> J.\n                            r \\<cdot>\\<^sub>r x \\<in> I \\<inter> J", "apply ((rule ballI)+, simp, (erule conjE)+,\n         simp add:ideal_pOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<inter> J.\n                            r \\<cdot>\\<^sub>r x \\<in> I \\<inter> J", "apply ((rule ballI)+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R I; ideal R J; r \\<in> carrier R; x \\<in> I;\n        x \\<in> J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> I \\<and>\n                         r \\<cdot>\\<^sub>r x \\<in> J", "apply (simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ideal_prod::\"[_, 'a set, 'a set] \\<Rightarrow> 'a set\" (infix \"\\<diamondsuit>\\<^sub>r\\<index>\" 90 ) where\n  \"ideal_prod R I J == \\<Inter> {L. ideal R L \\<and>\n                              {x.(\\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> j)} \\<subseteq> L}\""], ["", "lemma (in Ring) set_sum_mem:\"\\<lbrakk>a \\<in> I; b \\<in> J; I \\<subseteq> carrier R; J \\<subseteq> carrier R\\<rbrakk> \\<Longrightarrow>\n             a \\<plusminus> b \\<in> I \\<minusplus> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> I; b \\<in> J; I \\<subseteq> carrier R;\n     J \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> I \\<minusplus> J", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> I; b \\<in> J; I \\<subseteq> carrier R;\n     J \\<subseteq> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> b \\<in> I \\<minusplus> J", "apply (simp add:aGroup.set_sum, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_ideals:\"\\<lbrakk>ideal R I1; ideal R I2\\<rbrakk> \\<Longrightarrow> ideal R (I1 \\<minusplus> I2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2\\<rbrakk>\n    \\<Longrightarrow> ideal R (I1 \\<minusplus> I2)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ideal R (I1 \\<minusplus> I2)", "apply (frule ideal_subset1[of \"I1\"], frule ideal_subset1[of \"I2\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> ideal R (I1 \\<minusplus> I2)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> I1 \\<minusplus> I2 \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> I1 \\<minusplus> I2 \\<noteq> {}\n 3. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I1 \\<minusplus> I2.\n                         \\<forall>y\\<in>I1 \\<minusplus> I2.\n                            x \\<plusminus> y \\<in> I1 \\<minusplus> I2\n 4. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (rule subsetI, simp add:aGroup.set_sum, (erule bexE)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x h k.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; h \\<in> I1; k \\<in> I2;\n        x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> I1 \\<minusplus> I2 \\<noteq> {}\n 3. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I1 \\<minusplus> I2.\n                         \\<forall>y\\<in>I1 \\<minusplus> I2.\n                            x \\<plusminus> y \\<in> I1 \\<minusplus> I2\n 4. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (frule_tac h = h in ideal_subset[of \"I1\"], assumption+,\n        frule_tac h = k in ideal_subset[of \"I2\"], assumption+,\n        cut_tac ring_is_ag,\n        simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> I1 \\<minusplus> I2 \\<noteq> {}\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I1 \\<minusplus> I2.\n                         \\<forall>y\\<in>I1 \\<minusplus> I2.\n                            x \\<plusminus> y \\<in> I1 \\<minusplus> I2\n 3. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (frule ideal_zero[of \"I1\"], frule ideal_zero[of \"I2\"],\n        frule set_sum_mem[of \"\\<zero>\" \"I1\" \"\\<zero>\" \"I2\"], assumption+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I1 \\<minusplus> I2.\n                         \\<forall>y\\<in>I1 \\<minusplus> I2.\n                            x \\<plusminus> y \\<in> I1 \\<minusplus> I2\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; x \\<in> I1 \\<minusplus> I2;\n        y \\<in> I1 \\<minusplus> I2\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> I1 \\<minusplus> I2\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (simp add:aGroup.set_sum, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y h ha k ka.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; h \\<in> I1; ha \\<in> I1; k \\<in> I2;\n        x = h \\<plusminus> k; ka \\<in> I2; y = ha \\<plusminus> ka\\<rbrakk>\n       \\<Longrightarrow> \\<exists>hb\\<in>I1.\n                            \\<exists>kb\\<in>I2.\n                               h \\<plusminus> k \\<plusminus>\n                               (ha \\<plusminus> ka) =\n                               hb \\<plusminus> kb\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (rename_tac x y i ia j ja)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i ia j ja.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; i \\<in> I1; ia \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; ja \\<in> I2; y = ia \\<plusminus> ja\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               i \\<plusminus> j \\<plusminus>\n                               (ia \\<plusminus> ja) =\n                               h \\<plusminus> k\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (frule_tac h = i in ideal_subset[of \"I1\"], assumption+,\n        frule_tac h = ia in ideal_subset[of \"I1\"], assumption+,\n        frule_tac h = j in ideal_subset[of \"I2\"], assumption+,\n        frule_tac h = ja in ideal_subset[of \"I2\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i ia j ja.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; i \\<in> I1; ia \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; ja \\<in> I2; y = ia \\<plusminus> ja;\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               i \\<plusminus> j \\<plusminus>\n                               (ia \\<plusminus> ja) =\n                               h \\<plusminus> k\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (subst aGroup.pOp_assocTr43, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i ia j ja.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; i \\<in> I1; ia \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; ja \\<in> I2; y = ia \\<plusminus> ja;\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               i \\<plusminus>\n                               (j \\<plusminus> ia) \\<plusminus>\n                               ja =\n                               h \\<plusminus> k\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (frule_tac x = j and y = ia in aGroup.ag_pOp_commute[of \"R\"],\n          assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i ia j ja.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; i \\<in> I1; ia \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; ja \\<in> I2; y = ia \\<plusminus> ja;\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R; j \\<plusminus> ia = ia \\<plusminus> j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               i \\<plusminus>\n                               (ia \\<plusminus> j) \\<plusminus>\n                               ja =\n                               h \\<plusminus> k\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (subst aGroup.pOp_assocTr43[THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i ia j ja.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; i \\<in> I1; ia \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; ja \\<in> I2; y = ia \\<plusminus> ja;\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R; j \\<plusminus> ia = ia \\<plusminus> j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               i \\<plusminus> ia \\<plusminus>\n                               (j \\<plusminus> ja) =\n                               h \\<plusminus> k\n 2. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (frule_tac x = i and y = ia in ideal_pOp_closed[of \"I1\"], assumption+,\n        frule_tac x = j and y = ja in ideal_pOp_closed[of \"I2\"], assumption+,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n     I2 \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I1 \\<minusplus> I2.\n                            r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; r \\<in> carrier R;\n        x \\<in> I1 \\<minusplus> I2\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> I1 \\<minusplus> I2", "apply (simp add:aGroup.set_sum, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x h k.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; r \\<in> carrier R; h \\<in> I1; k \\<in> I2;\n        x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ha\\<in>I1.\n                            \\<exists>ka\\<in>I2.\n                               r \\<cdot>\\<^sub>r (h \\<plusminus> k) =\n                               ha \\<plusminus> ka", "apply (rename_tac r x i j)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x i j.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; r \\<in> carrier R; i \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               r \\<cdot>\\<^sub>r (i \\<plusminus> j) =\n                               h \\<plusminus> k", "apply (frule_tac h = i in ideal_subset[of \"I1\"], assumption+,\n        frule_tac h = j in ideal_subset[of \"I2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x i j.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; r \\<in> carrier R; i \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; i \\<in> carrier R; j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               r \\<cdot>\\<^sub>r (i \\<plusminus> j) =\n                               h \\<plusminus> k", "apply (simp add:ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x i j.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; I1 \\<subseteq> carrier R;\n        I2 \\<subseteq> carrier R; r \\<in> carrier R; i \\<in> I1; j \\<in> I2;\n        x = i \\<plusminus> j; i \\<in> carrier R; j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I1.\n                            \\<exists>k\\<in>I2.\n                               r \\<cdot>\\<^sub>r i \\<plusminus>\n                               r \\<cdot>\\<^sub>r j =\n                               h \\<plusminus> k", "apply (frule_tac x = i and r = r in ideal_ring_multiple[of \"I1\"], assumption+,\n        frule_tac x = j and r = r in ideal_ring_multiple[of \"I2\"], assumption+,\n        blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_ideals_la1:\"\\<lbrakk>ideal R I1; ideal R I2\\<rbrakk> \\<Longrightarrow> I1 \\<subseteq> (I1 \\<minusplus> I2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2\\<rbrakk>\n    \\<Longrightarrow> I1 \\<subseteq> I1 \\<minusplus> I2", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I1 \\<subseteq> I1 \\<minusplus> I2", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; x \\<in> I1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I1 \\<minusplus> I2", "apply (frule ideal_zero[of \"I2\"],\n       frule_tac h = x in ideal_subset[of \"I1\"], assumption+,\n       frule_tac x = x in aGroup.ag_r_zero[of \"R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; x \\<in> I1;\n        \\<zero> \\<in> I2; x \\<in> carrier R;\n        x \\<plusminus> \\<zero> = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I1 \\<minusplus> I2", "apply (subst aGroup.set_sum, assumption,\n       simp add:ideal_subset1, simp add:ideal_subset1, simp,\n       frule sym, thin_tac \"x \\<plusminus> \\<zero> = x\", blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_ideals_la2:\"\\<lbrakk>ideal R I1; ideal R I2 \\<rbrakk> \\<Longrightarrow> I2 \\<subseteq> (I1 \\<minusplus> I2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2\\<rbrakk>\n    \\<Longrightarrow> I2 \\<subseteq> I1 \\<minusplus> I2", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I1; ideal R I2; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I2 \\<subseteq> I1 \\<minusplus> I2", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; x \\<in> I2\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I1 \\<minusplus> I2", "apply (frule ideal_zero[of \"I1\"],\n       frule_tac h = x in ideal_subset[of \"I2\"], assumption+,\n       frule_tac x = x in aGroup.ag_l_zero[of \"R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I1; ideal R I2; aGroup R; x \\<in> I2;\n        \\<zero> \\<in> I1; x \\<in> carrier R;\n        \\<zero> \\<plusminus> x = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I1 \\<minusplus> I2", "apply (subst aGroup.set_sum, assumption,\n       simp add:ideal_subset1, simp add:ideal_subset1, simp,\n       frule sym, thin_tac \"\\<zero> \\<plusminus> x = x\", blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_ideals_cont:\"\\<lbrakk>ideal R I;  A \\<subseteq> I; B \\<subseteq> I \\<rbrakk> \\<Longrightarrow> A \\<minusplus> B \\<subseteq> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B \\<subseteq> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> A \\<minusplus> B \\<subseteq> I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I; aGroup R;\n        x \\<in> A \\<minusplus> B\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I", "apply (frule ideal_subset1[of I],\n        frule subset_trans[of A I \"carrier R\"], assumption+,\n        frule subset_trans[of B I \"carrier R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I; aGroup R;\n        x \\<in> A \\<minusplus> B; I \\<subseteq> carrier R;\n        A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I", "apply (simp add:aGroup.set_sum[of R], (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I; aGroup R;\n        I \\<subseteq> carrier R; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R; h \\<in> A; k \\<in> B;\n        x = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> k \\<in> I", "apply (frule_tac c = h in subsetD[of \"A\" \"I\"], assumption+,\n        frule_tac c = k in subsetD[of \"B\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h k.\n       \\<lbrakk>ideal R I; A \\<subseteq> I; B \\<subseteq> I; aGroup R;\n        I \\<subseteq> carrier R; A \\<subseteq> carrier R;\n        B \\<subseteq> carrier R; h \\<in> A; k \\<in> B; x = h \\<plusminus> k;\n        h \\<in> I; k \\<in> I\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> k \\<in> I", "apply (simp add:ideal_pOp_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideals_set_sum:\"\\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<minusplus> B\\<rbrakk> \\<Longrightarrow>\n             \\<exists>h\\<in>A. \\<exists>k\\<in>B. x = h \\<plusminus> k\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<minusplus> B\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>A.\n                         \\<exists>k\\<in>B. x = h \\<plusminus> k", "apply (frule ideal_subset1[of A],\n       frule ideal_subset1[of B])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; ideal R B; x \\<in> A \\<minusplus> B;\n     A \\<subseteq> carrier R; B \\<subseteq> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>A.\n                         \\<exists>k\\<in>B. x = h \\<plusminus> k", "apply (cut_tac ring_is_ag,\n       simp add:aGroup.set_sum)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  Rxa :: \"[_, 'a ] \\<Rightarrow> 'a set\" (infixl \"\\<diamondsuit>\\<^sub>p\" 200)  where\n  \"Rxa R a = {x. \\<exists>r\\<in>carrier R. x = (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> a)}\""], ["", "lemma (in Ring) a_in_principal:\"a \\<in> carrier R \\<Longrightarrow> a \\<in> Rxa R a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> a \\<in> R \\<diamondsuit>\\<^sub>p a", "apply (cut_tac ring_one,\n       frule ring_l_one[THEN sym, of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 1\\<^sub>r \\<in> carrier R;\n     a = 1\\<^sub>r \\<cdot>\\<^sub>r a\\<rbrakk>\n    \\<Longrightarrow> a \\<in> R \\<diamondsuit>\\<^sub>p a", "apply (simp add:Rxa_def, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) principal_ideal:\"a \\<in> carrier R \\<Longrightarrow> ideal R (Rxa R a)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow> ideal R (R \\<diamondsuit>\\<^sub>p a)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R\n 2. a \\<in> carrier R \\<Longrightarrow>\n    R \\<diamondsuit>\\<^sub>p a \\<noteq> {}\n 3. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n       \\<forall>y\\<in>R \\<diamondsuit>\\<^sub>p a.\n          x \\<plusminus> y \\<in> R \\<diamondsuit>\\<^sub>p a\n 4. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n          r \\<cdot>\\<^sub>r x \\<in> R \\<diamondsuit>\\<^sub>p a", "apply (rule subsetI,\n         simp add:Rxa_def, erule bexE, simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    R \\<diamondsuit>\\<^sub>p a \\<noteq> {}\n 2. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n       \\<forall>y\\<in>R \\<diamondsuit>\\<^sub>p a.\n          x \\<plusminus> y \\<in> R \\<diamondsuit>\\<^sub>p a\n 3. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n          r \\<cdot>\\<^sub>r x \\<in> R \\<diamondsuit>\\<^sub>p a", "apply (frule a_in_principal[of \"a\"], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n       \\<forall>y\\<in>R \\<diamondsuit>\\<^sub>p a.\n          x \\<plusminus> y \\<in> R \\<diamondsuit>\\<^sub>p a\n 2. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n          r \\<cdot>\\<^sub>r x \\<in> R \\<diamondsuit>\\<^sub>p a", "apply ((rule ballI)+,\n        simp add:Rxa_def, (erule bexE)+, simp,\n        subst ring_distrib2[THEN sym], assumption+,\n        cut_tac ring_is_ag,\n        frule_tac x = r and y = ra in aGroup.ag_pOp_closed, assumption+,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. a \\<in> carrier R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>R \\<diamondsuit>\\<^sub>p a.\n          r \\<cdot>\\<^sub>r x \\<in> R \\<diamondsuit>\\<^sub>p a", "apply ((rule ballI)+,\n        simp add:Rxa_def, (erule bexE)+, simp,\n        simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x ra.\n       \\<lbrakk>a \\<in> carrier R; r \\<in> carrier R; ra \\<in> carrier R;\n        x = ra \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r a =\n                            rb \\<cdot>\\<^sub>r a", "apply (frule_tac x = r and y = ra in ring_tOp_closed, assumption, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) rxa_in_Rxa:\"\\<lbrakk>a \\<in> carrier R; r \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                     r \\<cdot>\\<^sub>r a \\<in> Rxa R a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> R \\<diamondsuit>\\<^sub>p a", "by (simp add:Rxa_def, blast)"], ["", "lemma (in Ring) Rxa_one:\"Rxa R 1\\<^sub>r = carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R \\<diamondsuit>\\<^sub>p 1\\<^sub>r = carrier R", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R \\<diamondsuit>\\<^sub>p 1\\<^sub>r \\<subseteq> carrier R\n 2. carrier R \\<subseteq> R \\<diamondsuit>\\<^sub>p 1\\<^sub>r", "apply (rule subsetI, simp add:Rxa_def, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x r.\n       \\<lbrakk>r \\<in> carrier R; x = r \\<cdot>\\<^sub>r 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. carrier R \\<subseteq> R \\<diamondsuit>\\<^sub>p 1\\<^sub>r", "apply (simp add:ring_r_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. carrier R \\<subseteq> R \\<diamondsuit>\\<^sub>p 1\\<^sub>r", "apply (rule subsetI, simp add:Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> carrier R \\<Longrightarrow>\n       \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r 1\\<^sub>r", "apply (frule_tac t = x in ring_r_one[THEN sym], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Rxa_zero:\"Rxa R \\<zero> = {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. R \\<diamondsuit>\\<^sub>p \\<zero> = {\\<zero>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. R \\<diamondsuit>\\<^sub>p \\<zero> \\<subseteq> {\\<zero>}\n 2. {\\<zero>} \\<subseteq> R \\<diamondsuit>\\<^sub>p \\<zero>", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       x \\<in> R \\<diamondsuit>\\<^sub>p \\<zero> \\<Longrightarrow>\n       x \\<in> {\\<zero>}\n 2. {\\<zero>} \\<subseteq> R \\<diamondsuit>\\<^sub>p \\<zero>", "apply (simp add:Rxa_def, erule bexE, simp add:ring_times_x_0)"], ["proof (prove)\ngoal (1 subgoal):\n 1. {\\<zero>} \\<subseteq> R \\<diamondsuit>\\<^sub>p \\<zero>", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       x \\<in> {\\<zero>} \\<Longrightarrow>\n       x \\<in> R \\<diamondsuit>\\<^sub>p \\<zero>", "apply (simp add:Rxa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<exists>r\\<in>carrier R. \\<zero> = r \\<cdot>\\<^sub>r \\<zero>", "apply (cut_tac ring_zero,\n        frule ring_times_x_0[THEN sym, of \"\\<zero>\"], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Rxa_nonzero:\"\\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> Rxa R a \\<noteq> {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<noteq> {\\<zero>}", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     R \\<diamondsuit>\\<^sub>p a = {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule a_in_principal[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; a \\<noteq> \\<zero>;\n     R \\<diamondsuit>\\<^sub>p a = {\\<zero>};\n     a \\<in> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_cont_Rxa:\"\\<lbrakk>ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow> Rxa R a \\<subseteq> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<subseteq> I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; a \\<in> I;\n        x \\<in> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I", "apply (simp add:Rxa_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x r.\n       \\<lbrakk>ideal R I; a \\<in> I; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r a \\<in> I", "apply (simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) Rxa_mult_smaller:\"\\<lbrakk> a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                    Rxa R (a \\<cdot>\\<^sub>r b) \\<subseteq> Rxa R b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> R \\<diamondsuit>\\<^sub>p b", "apply (frule rxa_in_Rxa[of b a], assumption,\n       frule principal_ideal[of b])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     a \\<cdot>\\<^sub>r b \\<in> R \\<diamondsuit>\\<^sub>p b;\n     ideal R (R \\<diamondsuit>\\<^sub>p b)\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p (a \\<cdot>\\<^sub>r b)\n                      \\<subseteq> R \\<diamondsuit>\\<^sub>p b", "apply (rule ideal_cont_Rxa[of \"R \\<diamondsuit>\\<^sub>p b\" \"a \\<cdot>\\<^sub>r b\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) id_ideal_psub_sum:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                                             I \\<subset> I \\<minusplus> Rxa R a\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> I \\<subset> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<subset> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (simp add:psubset_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> I \\<minusplus>\n                                    R \\<diamondsuit>\\<^sub>p a \\<and>\n                      I \\<noteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (frule principal_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> I \\<minusplus>\n                                    R \\<diamondsuit>\\<^sub>p a \\<and>\n                      I \\<noteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> I \\<minusplus>\n                                    R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (rule sum_ideals_la1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a", "apply (rule contrapos_pp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> ?Q9\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     \\<not> I \\<noteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> \\<not> ?Q9", "apply simp+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     I = I \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule sum_ideals_la2[of \"I\" \"Rxa R a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     I = I \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n     R \\<diamondsuit>\\<^sub>p a\n     \\<subseteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule a_in_principal[of \"a\"],\n       frule subsetD[of \"Rxa R a\" \"I \\<minusplus> Rxa R a\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I; aGroup R;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     I = I \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n     R \\<diamondsuit>\\<^sub>p a\n     \\<subseteq> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n     a \\<in> R \\<diamondsuit>\\<^sub>p a;\n     a \\<in> I \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mul_two_principal_idealsTr:\"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n         x \\<in> Rxa R a; y \\<in> Rxa R b\\<rbrakk> \\<Longrightarrow> \\<exists>r\\<in>carrier R. x \\<cdot>\\<^sub>r y = r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     x \\<in> R \\<diamondsuit>\\<^sub>p a;\n     y \\<in> R \\<diamondsuit>\\<^sub>p b\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                         x \\<cdot>\\<^sub>r y =\n                         r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:Rxa_def, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y =\n                            r \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r\n                            (ra \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (frule_tac x = ra and y = b in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        ra \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r\n                            (ra \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        ra \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r\n                            (a \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r b)) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_assoc[THEN sym, of a _ b])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        ra \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r\n                            (a \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply (simp add:ring_tOp_commute[of a], simp add:ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b;\n        ra \\<cdot>\\<^sub>r b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r\n                            (ra \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)) =\n                            rb \\<cdot>\\<^sub>r (b \\<cdot>\\<^sub>r a)", "apply (frule_tac x = a and y = b in ring_tOp_closed, assumption+,\n       thin_tac \"ra \\<cdot>\\<^sub>r b \\<in> carrier R\",\n       simp add:ring_tOp_assoc[THEN sym, of _ _ \"a \\<cdot>\\<^sub>r b\"],\n       frule_tac x = r and y = ra in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r ra \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r\n                            (a \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (b \\<cdot>\\<^sub>r a)", "apply (simp add:ring_tOp_commute[of b a])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r ra.\n       \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; r \\<in> carrier R;\n        x = r \\<cdot>\\<^sub>r a; ra \\<in> carrier R;\n        y = ra \\<cdot>\\<^sub>r b; a \\<cdot>\\<^sub>r b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r ra \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>rb\\<in>carrier R.\n                            r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r\n                            (a \\<cdot>\\<^sub>r b) =\n                            rb \\<cdot>\\<^sub>r (a \\<cdot>\\<^sub>r b)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "primrec sum_pr_ideals::\"[('a, 'm) Ring_scheme, nat \\<Rightarrow> 'a, nat] \\<Rightarrow> 'a set\"\nwhere\n  sum_pr0: \"sum_pr_ideals R f 0 = Rxa R (f 0)\"\n| sum_prn: \"sum_pr_ideals R f (Suc n) =\n                  (Rxa R (f (Suc n))) \\<minusplus>\\<^bsub>R\\<^esub> (sum_pr_ideals R f n)\""], ["", "lemma (in Ring) sum_of_prideals0:\n      \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow> ideal R (sum_pr_ideals R f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n       ideal R (sum_pr_ideals R f n)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>f.\n       (\\<forall>l\\<le>0. f l \\<in> carrier R) \\<longrightarrow>\n       ideal R (sum_pr_ideals R f 0)\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "apply (rule allI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       (\\<forall>l\\<le>0. f l \\<in> carrier R) \\<longrightarrow>\n       ideal R (sum_pr_ideals R f 0)\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<forall>l\\<le>0. f l \\<in> carrier R \\<Longrightarrow>\n       ideal R (sum_pr_ideals R f 0)\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       f 0 \\<in> carrier R \\<Longrightarrow>\n       ideal R (R \\<diamondsuit>\\<^sub>p f 0)\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "apply (rule Ring.principal_ideal, rule Ring_axioms, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "(** case n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f n) \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          ideal R (sum_pr_ideals R f (Suc n))", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   ideal R (sum_pr_ideals R f n);\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R (sum_pr_ideals R f (Suc n))", "apply (frule_tac x = f in spec,\n        thin_tac \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow>\n               ideal R (sum_pr_ideals R f n)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n        ideal R (sum_pr_ideals R f n)\\<rbrakk>\n       \\<Longrightarrow> ideal R (sum_pr_ideals R f (Suc n))", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        ideal R (sum_pr_ideals R f n)\\<rbrakk>\n       \\<Longrightarrow> ideal R\n                          (R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                           sum_pr_ideals R f n)", "apply (cut_tac a = \"f (Suc n)\" in  principal_ideal,\n       simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        ideal R (sum_pr_ideals R f n);\n        ideal R (R \\<diamondsuit>\\<^sub>p f (Suc n))\\<rbrakk>\n       \\<Longrightarrow> ideal R\n                          (R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                           sum_pr_ideals R f n)", "apply (rule_tac ?I1.0 = \"Rxa R (f (Suc n))\" and\n        ?I2.0 = \"sum_pr_ideals R f n\" in Ring.sum_ideals, rule Ring_axioms, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_of_prideals:\"\\<lbrakk>\\<forall>l \\<le> n. f l \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                      ideal R (sum_pr_ideals R f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l\\<le>n. f l \\<in> carrier R \\<Longrightarrow>\n    ideal R (sum_pr_ideals R f n)", "apply (simp add:sum_of_prideals0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text \\<open>later, we show \\<open>sum_pr_ideals\\<close> is the least ideal containing\n        \\<open>{f 0, f 1,\\<dots>, f n}\\<close>\\<close>"], ["", "lemma (in Ring) sum_of_prideals1:\"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow>\n                                    f ` {i. i \\<le> n} \\<subseteq> (sum_pr_ideals R f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>f.\n       (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n       f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>f.\n       (\\<forall>l\\<le>0. f l \\<in> carrier R) \\<longrightarrow>\n       f ` {i. i \\<le> 0} \\<subseteq> sum_pr_ideals R f 0\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> n}\n          \\<subseteq> sum_pr_ideals R f n \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> Suc n} \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<forall>l\\<le>0. f l \\<in> carrier R \\<Longrightarrow>\n       f ` {i. i \\<le> 0} \\<subseteq> sum_pr_ideals R f 0\n 2. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> n}\n          \\<subseteq> sum_pr_ideals R f n \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> Suc n} \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (simp, simp add:a_in_principal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<forall>f.\n          (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> n}\n          \\<subseteq> sum_pr_ideals R f n \\<Longrightarrow>\n       \\<forall>f.\n          (\\<forall>l\\<le>Suc n. f l \\<in> carrier R) \\<longrightarrow>\n          f ` {i. i \\<le> Suc n} \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> f ` {i. i \\<le> Suc n}\n                         \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (frule_tac a = f in forall_spec,\n        thin_tac \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<longrightarrow>\n               f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<forall>l\\<le>Suc n. f l \\<in> carrier R \\<Longrightarrow>\n       \\<forall>l\\<le>n. f l \\<in> carrier R\n 2. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f ` {i. i \\<le> Suc n}\n                         \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (rule allI, cut_tac n = n in Nset_un, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f ` {i. i \\<le> Suc n}\n                         \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (subst Nset_un)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f ` ({j. j \\<le> n} \\<union> {Suc n})\n                         \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (cut_tac A = \"{i. i \\<le> (Suc n)}\" and f = f and B = \"carrier R\" and\n        ?A1.0 = \"{i. i \\<le> n}\" and ?A2.0 = \"{Suc n}\" in im_set_un1,\n        simp, rule Nset_un)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>f.\n                   (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n                   f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        f ` ({i. i \\<le> n} \\<union> {Suc n}) =\n        f ` {i. i \\<le> n} \\<union> f ` {Suc n}\\<rbrakk>\n       \\<Longrightarrow> f ` ({j. j \\<le> n} \\<union> {Suc n})\n                         \\<subseteq> sum_pr_ideals R f (Suc n)", "apply (thin_tac \"\\<forall>f. (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<longrightarrow>\n               f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\",\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               f (Suc n) \\<minusplus>\n                               sum_pr_ideals R f n \\<and>\n                         f ` {j. j \\<le> n}\n                         \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                     f (Suc n) \\<minusplus>\n                                     sum_pr_ideals R f n", "apply (cut_tac n = n and f = f in sum_of_prideals,\n        cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        ideal R (sum_pr_ideals R f n)\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               f (Suc n) \\<minusplus>\n                               sum_pr_ideals R f n \\<and>\n                         f ` {j. j \\<le> n}\n                         \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                     f (Suc n) \\<minusplus>\n                                     sum_pr_ideals R f n", "apply (cut_tac a = \"f (Suc n)\" in principal_ideal, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        ideal R (sum_pr_ideals R f n);\n        ideal R (R \\<diamondsuit>\\<^sub>p f (Suc n))\\<rbrakk>\n       \\<Longrightarrow> f (Suc n)\n                         \\<in> R \\<diamondsuit>\\<^sub>p\n                               f (Suc n) \\<minusplus>\n                               sum_pr_ideals R f n \\<and>\n                         f ` {j. j \\<le> n}\n                         \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                     f (Suc n) \\<minusplus>\n                                     sum_pr_ideals R f n", "apply (frule_tac ?I1.0 = \"Rxa R (f (Suc n))\" and ?I2.0 = \"sum_pr_ideals R f n\"\n                 in sum_ideals_la1, assumption+,\n        cut_tac a = \"f (Suc n)\" in a_in_principal, simp,\n        frule_tac A = \"R \\<diamondsuit>\\<^sub>p f (Suc n)\" and\n         B = \"R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus> sum_pr_ideals R f n\" and c = \"f (Suc n)\" in\n         subsetD, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        ideal R (sum_pr_ideals R f n);\n        ideal R (R \\<diamondsuit>\\<^sub>p f (Suc n));\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n        \\<subseteq> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                    sum_pr_ideals R f n;\n        f (Suc n) \\<in> R \\<diamondsuit>\\<^sub>p f (Suc n);\n        f (Suc n)\n        \\<in> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n              sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> n}\n                         \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                     f (Suc n) \\<minusplus>\n                                     sum_pr_ideals R f n", "apply (frule_tac ?I1.0 = \"Rxa R (f (Suc n))\" and\n         ?I2.0 = \"sum_pr_ideals R f n\" in sum_ideals_la2, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n;\n        ideal R (sum_pr_ideals R f n);\n        ideal R (R \\<diamondsuit>\\<^sub>p f (Suc n));\n        R \\<diamondsuit>\\<^sub>p f (Suc n)\n        \\<subseteq> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                    sum_pr_ideals R f n;\n        f (Suc n) \\<in> R \\<diamondsuit>\\<^sub>p f (Suc n);\n        f (Suc n)\n        \\<in> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n              sum_pr_ideals R f n;\n        sum_pr_ideals R f n\n        \\<subseteq> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                    sum_pr_ideals R f n\\<rbrakk>\n       \\<Longrightarrow> f ` {j. j \\<le> n}\n                         \\<subseteq> R \\<diamondsuit>\\<^sub>p\n                                     f (Suc n) \\<minusplus>\n                                     sum_pr_ideals R f n", "apply (rule_tac A = \"f ` {j. j \\<le> n}\" and B = \"sum_pr_ideals R f n\" and\n         C = \"Rxa R (f (Suc n)) \\<minusplus> sum_pr_ideals R f n\" in subset_trans,\n         assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_of_prideals2:\"\\<forall>l \\<le> n. f l \\<in> carrier R\n               \\<Longrightarrow>  f ` {i. i \\<le> n} \\<subseteq> (sum_pr_ideals R f n)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>l\\<le>n. f l \\<in> carrier R \\<Longrightarrow>\n    f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n", "apply (simp add:sum_of_prideals1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_of_prideals3:\"ideal R I \\<Longrightarrow>\n      \\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<and> (f ` {i. i \\<le> n} \\<subseteq> I) \\<longrightarrow>\n          (sum_pr_ideals R f n \\<subseteq> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    \\<forall>f.\n       (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n       f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n       sum_pr_ideals R f n \\<subseteq> I", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    \\<forall>f.\n       (\\<forall>l\\<le>0. f l \\<in> carrier R) \\<and>\n       f ` {i. i \\<le> 0} \\<subseteq> I \\<longrightarrow>\n       sum_pr_ideals R f 0 \\<subseteq> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>l\\<le>Suc n.\n                                f l \\<in> carrier R) \\<and>\n                            f ` {i. i \\<le> Suc n}\n                            \\<subseteq> I \\<longrightarrow>\n                            sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R I; \\<forall>l\\<le>0. f l \\<in> carrier R;\n        f ` {i. i \\<le> 0} \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f 0 \\<subseteq> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>l\\<le>Suc n.\n                                f l \\<in> carrier R) \\<and>\n                            f ` {i. i \\<le> Suc n}\n                            \\<subseteq> I \\<longrightarrow>\n                            sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>f.\n       \\<lbrakk>ideal R I; f 0 \\<in> carrier R; f 0 \\<in> I\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f 0 \\<subseteq> I\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>l\\<le>Suc n.\n                                f l \\<in> carrier R) \\<and>\n                            f ` {i. i \\<le> Suc n}\n                            \\<subseteq> I \\<longrightarrow>\n                            sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (rule ideal_cont_Rxa[of I], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>f.\n                            (\\<forall>l\\<le>Suc n.\n                                f l \\<in> carrier R) \\<and>\n                            f ` {i. i \\<le> Suc n}\n                            \\<subseteq> I \\<longrightarrow>\n                            sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> Suc n} \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (frule_tac a = f in forall_spec,\n        thin_tac \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<and> f `{i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n               sum_pr_ideals R f n \\<subseteq> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> Suc n} \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n                         f ` {i. i \\<le> n} \\<subseteq> I\n 2. \\<And>n f.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (simp add:Nset_un)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I;\n        \\<forall>f.\n           (\\<forall>l\\<le>n. f l \\<in> carrier R) \\<and>\n           f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n           sum_pr_ideals R f n \\<subseteq> I;\n        \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (thin_tac \"\\<forall>f. (\\<forall>l \\<le> n. f l \\<in> carrier R) \\<and> f ` {i. i \\<le> n} \\<subseteq> I \\<longrightarrow>\n               sum_pr_ideals R f n \\<subseteq> I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; \\<forall>l\\<le>Suc n. f l \\<in> carrier R;\n        f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f (Suc n) \\<subseteq> I", "apply (frule_tac x = \"Suc n\" in spec,\n        thin_tac \"\\<forall>l \\<le> (Suc n). f l \\<in> carrier R\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I;\n        f (Suc n) \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                         sum_pr_ideals R f n\n                         \\<subseteq> I", "apply (cut_tac a = \"Suc n\" and A = \"{i. i \\<le> Suc n}\" and\n          f = f in mem_in_image2, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I; f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> f ` {i. i \\<le> Suc n}\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                         sum_pr_ideals R f n\n                         \\<subseteq> I", "apply (frule_tac A = \"f ` {i. i \\<le> Suc n}\" and B = I and c = \"f (Suc n)\" in\n          subsetD,  assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I; f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> f ` {i. i \\<le> Suc n}; f (Suc n) \\<in> I\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<minusplus>\n                         sum_pr_ideals R f n\n                         \\<subseteq> I", "apply (rule_tac A = \"Rxa R  (f (Suc n))\" and B = \"sum_pr_ideals R f n\" in\n        sum_ideals_cont[of I], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n f.\n       \\<lbrakk>ideal R I; f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I; f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> f ` {i. i \\<le> Suc n}; f (Suc n) \\<in> I\\<rbrakk>\n       \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p f (Suc n) \\<subseteq> I\n 2. \\<And>n f.\n       \\<lbrakk>ideal R I; f ` {i. i \\<le> Suc n} \\<subseteq> I;\n        sum_pr_ideals R f n \\<subseteq> I; f (Suc n) \\<in> carrier R;\n        f (Suc n) \\<in> f ` {i. i \\<le> Suc n}; f (Suc n) \\<in> I\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> I", "apply (rule ideal_cont_Rxa[of I], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_of_prideals4:\"\\<lbrakk>ideal R I; \\<forall>l \\<le> n. f l \\<in> carrier R;\n       (f ` {i. i \\<le> n} \\<subseteq> I)\\<rbrakk> \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; \\<forall>l\\<le>n. f l \\<in> carrier R;\n     f ` {i. i \\<le> n} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> I", "apply (simp add:sum_of_prideals3)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ker_ideal:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> ideal A (ker\\<^bsub>A,R\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> ideal A (ker\\<^bsub>A,R\\<^esub> f)", "apply (frule Ring.ring_is_ag[of \"A\"], frule Ring.ring_is_ag[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ideal A (ker\\<^bsub>A,R\\<^esub> f)", "apply (rule Ring.ideal_condition1, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f \\<subseteq> carrier A\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f \\<noteq> {}\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                         \\<forall>y\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            x \\<plusminus>\\<^bsub>A\\<^esub> y\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (rule subsetI,\n       simp add:ker_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f \\<noteq> {}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                         \\<forall>y\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            x \\<plusminus>\\<^bsub>A\\<^esub> y\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (simp add:rHom_def, frule conjunct1)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R;\n     f \\<in> aHom A R \\<and>\n     (\\<forall>x\\<in>carrier A.\n         \\<forall>y\\<in>carrier A.\n            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n            f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n     f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n     aGroup A; aGroup R; f \\<in> aHom A R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f \\<noteq> {}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                         \\<forall>y\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            x \\<plusminus>\\<^bsub>A\\<^esub> y\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (frule ker_inc_zero[of \"A\" \"R\" \"f\"], assumption+, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                         \\<forall>y\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            x \\<plusminus>\\<^bsub>A\\<^esub> y\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        x \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        y \\<in> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>A\\<^esub> y\n                         \\<in> ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (simp add:ker_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        x \\<in> carrier A; f x = \\<zero>\\<^bsub>R\\<^esub>;\n        y \\<in> carrier A; f y = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>A\\<^esub> y\n                         \\<in> carrier A \\<and>\n                         f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (simp add:aGroup.ag_pOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        x \\<in> carrier A; f x = \\<zero>\\<^bsub>R\\<^esub>;\n        y \\<in> carrier A; f y = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f (x \\<plusminus>\\<^bsub>A\\<^esub> y) =\n                         \\<zero>\\<^bsub>R\\<^esub>\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (simp add:rHom_def, frule conjunct1,\n        simp add:aHom_add,\n        frule Ring.ring_zero[of \"R\"],\n        simp add:aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier A.\n                         \\<forall>x\\<in>ker\\<^bsub>A,R\\<^esub> f.\n                            r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                            \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        r \\<in> carrier A; x \\<in> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                         \\<in> ker\\<^bsub>A,R\\<^esub> f", "apply (simp add:ker_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        r \\<in> carrier A; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x\n                         \\<in> carrier A \\<and>\n                         f (r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (simp add:Ring.ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        r \\<in> carrier A; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f (r \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> x) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        r \\<in> carrier A; x \\<in> carrier A;\n        f x = \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         \\<zero>\\<^bsub>R\\<^esub> =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (frule_tac a = r in rHom_mem[of \"f\" \"A\" \"R\"], assumption+,\n        simp add:Ring.ring_times_x_0)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "subsection \"Ring of integers\""], ["", "definition\n  Zr :: \"int Ring\" where\n  \"Zr = \\<lparr> carrier = Zset, pop = \\<lambda>n\\<in>Zset. \\<lambda>m\\<in>Zset. (m + n),\n    mop = \\<lambda>l\\<in>Zset. -l, zero = 0, tp = \\<lambda>m\\<in>Zset. \\<lambda>n\\<in>Zset. m * n, un = 1\\<rparr>\""], ["", "lemma ring_of_integers:\"Ring Zr\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring Zr", "apply (simp add:Ring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<plusminus>\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n            b \\<plusminus>\\<^bsub>Zr\\<^esub> a)) \\<and>\n    mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<plusminus>\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow> carrier Zr \\<rightarrow> carrier Zr\n 2. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n            b \\<plusminus>\\<^bsub>Zr\\<^esub> a)) \\<and>\n    mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<plusminus>\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n            b \\<plusminus>\\<^bsub>Zr\\<^esub> a)) \\<and>\n    mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a \\<in> carrier Zr \\<longrightarrow>\n       (\\<forall>b.\n           b \\<in> carrier Zr \\<longrightarrow>\n           (\\<forall>c.\n               c \\<in> carrier Zr \\<longrightarrow>\n               a \\<plusminus>\\<^bsub>Zr\\<^esub>\n               b \\<plusminus>\\<^bsub>Zr\\<^esub>\n               c =\n               a \\<plusminus>\\<^bsub>Zr\\<^esub>\n               (b \\<plusminus>\\<^bsub>Zr\\<^esub> c)))\n 2. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n            b \\<plusminus>\\<^bsub>Zr\\<^esub> a)) \\<and>\n    mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n            b \\<plusminus>\\<^bsub>Zr\\<^esub> a)) \\<and>\n    mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>a.\n       a \\<in> carrier Zr \\<longrightarrow>\n       (\\<forall>b.\n           b \\<in> carrier Zr \\<longrightarrow>\n           a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n           b \\<plusminus>\\<^bsub>Zr\\<^esub> a)\n 2. mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>a \\<in> carrier Zr; b \\<in> carrier Zr\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>Zr\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>Zr\\<^esub> a\n 2. mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. mop Zr \\<in> carrier Zr \\<rightarrow> carrier Zr\n 2. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> a \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        \\<zero>\\<^bsub>Zr\\<^esub>) \\<and>\n    \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI,\n       rule allI, rule impI, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero>\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        \\<zero>\\<^bsub>Zr\\<^esub> \\<plusminus>\\<^bsub>Zr\\<^esub> a =\n        a) \\<and>\n    (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI,\n       rule allI, rule impI, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow>\n          carrier Zr \\<rightarrow> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>)\n    \\<in> carrier Zr \\<rightarrow> carrier Zr \\<rightarrow> carrier Zr\n 2. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                c =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c)))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI,\n       (rule allI, rule impI)+, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> b =\n            b \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a)) \\<and>\n    1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI,\n       (rule allI, rule impI)+, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. 1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr\n 2. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        (\\<forall>b.\n            b \\<in> carrier Zr \\<longrightarrow>\n            (\\<forall>c.\n                c \\<in> carrier Zr \\<longrightarrow>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                (b \\<plusminus>\\<^bsub>Zr\\<^esub> c) =\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n                b \\<plusminus>\\<^bsub>Zr\\<^esub>\n                a \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> c))) \\<and>\n    (\\<forall>a.\n        a \\<in> carrier Zr \\<longrightarrow>\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a)", "apply (rule conjI,\n       (rule allI, rule impI)+, simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c. a * (c + b) = a * c + a * b\n 2. \\<forall>a.\n       a \\<in> carrier Zr \\<longrightarrow>\n       1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a", "apply (simp add: distrib_left)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>a.\n       a \\<in> carrier Zr \\<longrightarrow>\n       1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       a \\<in> carrier Zr \\<Longrightarrow>\n       1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a = a", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Zr_zero:\"\\<zero>\\<^bsub>Zr\\<^esub> = 0\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<zero>\\<^bsub>Zr\\<^esub> = 0", "by (simp add:Zr_def)"], ["", "lemma Zr_one:\"1\\<^sub>r\\<^bsub>Zr\\<^esub> = 1\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r\\<^bsub>Zr\\<^esub> = 1", "by (simp add:Zr_def)"], ["", "lemma Zr_minus:\"-\\<^sub>a\\<^bsub>Zr\\<^esub> n = - n\""], ["proof (prove)\ngoal (1 subgoal):\n 1. -\\<^sub>a\\<^bsub>Zr\\<^esub> n = - n", "by (simp add:Zr_def Zset_def)"], ["", "lemma Zr_add:\"n \\<plusminus>\\<^bsub>Zr\\<^esub> m = n + m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<plusminus>\\<^bsub>Zr\\<^esub> m = n + m", "by (simp add:Zr_def Zset_def)"], ["", "lemma Zr_times:\"n \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> m = n * m\""], ["proof (prove)\ngoal (1 subgoal):\n 1. n \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> m = n * m", "by (simp add:Zr_def Zset_def)"], ["", "definition\n  lev :: \"int set \\<Rightarrow> int\" where\n  \"lev I = Zleast {n. n \\<in> I \\<and> 0 < n}\""], ["", "lemma Zr_gen_Zleast:\"\\<lbrakk>ideal Zr I; I \\<noteq> {0::int}\\<rbrakk> \\<Longrightarrow>\n                       Rxa Zr (lev I) = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (cut_tac ring_of_integers)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (simp add:lev_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I", "apply (subgoal_tac \"{n. n \\<in> I \\<and> 0 < n} \\<noteq> {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "apply (subgoal_tac \"{n. n \\<in> I \\<and> 0 < n} \\<subseteq> Zset\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "apply (subgoal_tac \"LB {n. n \\<in> I \\<and> 0 < n} 0\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> LB {n \\<in> I. 0 < n} 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 4. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "apply (frule_tac A = \"{n. n \\<in> I \\<and> 0 < n}\" and n = 0 in Zleast, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0;\n     Zleast {n \\<in> I. 0 < n} \\<in> {n \\<in> I. 0 < n} \\<and>\n     (\\<forall>x\\<in>{n \\<in> I. 0 < n}.\n         Zleast {n \\<in> I. 0 < n} \\<le> x)\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> LB {n \\<in> I. 0 < n} 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 4. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "apply (erule conjE)+"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0;\n     Zleast {n \\<in> I. 0 < n} \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}.\n        Zleast {n \\<in> I. 0 < n} \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p Zleast {n \\<in> I. 0 < n} =\n                      I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> LB {n \\<in> I. 0 < n} 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 4. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "apply (fold lev_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> LB {n \\<in> I. 0 < n} 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 4. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}", "defer"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {};\n     {n \\<in> I. 0 < n} \\<subseteq> Zset\\<rbrakk>\n    \\<Longrightarrow> LB {n \\<in> I. 0 < n} 0\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}\n 4. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (simp add:LB_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<subseteq> Zset\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (simp add:Zset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr\\<rbrakk>\n    \\<Longrightarrow> {n \\<in> I. 0 < n} \\<noteq> {}\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule Ring.ideal_zero[of \"Zr\" \"I\"], assumption+, simp add:Zr_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule singleton_sub[of \"0\" \"I\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I;\n     {0} \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule sets_not_eq[of \"I\" \"{0}\"], assumption+, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I; a \\<in> I;\n        a \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (case_tac \"0 < a\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I; a \\<in> I;\n        a \\<noteq> 0; \\<not> 0 < a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule Ring.ring_one[of \"Zr\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I; a \\<in> I;\n        a \\<noteq> 0; \\<not> 0 < a;\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule Ring.ring_is_ag[of \"Zr\"],\n         frule aGroup.ag_mOp_closed[of \"Zr\" \"1\\<^sub>r\\<^bsub>Zr\\<^esub>\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I; a \\<in> I;\n        a \\<noteq> 0; \\<not> 0 < a;\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr; aGroup Zr;\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> 1\\<^sub>r\\<^bsub>Zr\\<^esub>\n        \\<in> carrier Zr\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule_tac x = a in Ring.ideal_ring_multiple[of \"Zr\" \"I\" _ \"-\\<^sub>a\\<^bsub>Zr\\<^esub> 1\\<^sub>r\\<^bsub>Zr\\<^esub>\"],\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr; 0 \\<in> I; a \\<in> I;\n        a \\<noteq> 0; \\<not> 0 < a;\n        1\\<^sub>r\\<^bsub>Zr\\<^esub> \\<in> carrier Zr; aGroup Zr;\n        -\\<^sub>a\\<^bsub>Zr\\<^esub> 1\\<^sub>r\\<^bsub>Zr\\<^esub>\n        \\<in> carrier Zr;\n        (-\\<^sub>a\\<^bsub>Zr\\<^esub> 1\\<^sub>r\\<^bsub>Zr\\<^esub>) \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub>\n        a\n        \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (simp add:Zr_one Zr_minus,\n        thin_tac \"ideal Zr I\", thin_tac \"Ring Zr\", thin_tac \"1 \\<in> carrier Zr\",\n        thin_tac \"-1 \\<in> carrier Zr\", thin_tac \"aGroup Zr\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>I \\<noteq> {0}; 0 \\<in> I; a \\<in> I; a \\<noteq> 0;\n        \\<not> 0 < a;\n        - 1 \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> a \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>I \\<noteq> {0}; 0 \\<in> I; a \\<in> I; a \\<noteq> 0;\n        \\<not> 0 < a; - a \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x. x \\<in> I \\<and> 0 < x\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (subgoal_tac \"0 < - a\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>I \\<noteq> {0}; 0 \\<in> I; a \\<in> I; a \\<noteq> 0;\n        \\<not> 0 < a; - a \\<in> I\\<rbrakk>\n       \\<Longrightarrow> 0 < - a\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply arith"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     {n \\<in> I. 0 < n} \\<noteq> {}; {n \\<in> I. 0 < n} \\<subseteq> Zset;\n     LB {n \\<in> I. 0 < n} 0; lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (thin_tac \"{n \\<in> I. 0 < n} \\<noteq> {}\", thin_tac \"{n \\<in> I. 0 < n} \\<subseteq> Zset\",\n        thin_tac \"LB {n \\<in> I. 0 < n} 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     lev I \\<in> {n \\<in> I. 0 < n};\n     \\<forall>x\\<in>{n \\<in> I. 0 < n}. lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     lev I \\<in> I \\<and> 0 < lev I;\n     \\<forall>x.\n        x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n     lev I \\<in> I; 0 < lev I\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (frule Ring.ideal_cont_Rxa[of \"Zr\" \"I\" \"lev I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n     lev I \\<in> I; 0 < lev I;\n     Zr \\<diamondsuit>\\<^sub>p lev I \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p lev I = I", "apply (rule equalityI, assumption,\n        thin_tac \"Rxa Zr (lev I) \\<subseteq> I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n     \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n     lev I \\<in> I; 0 < lev I\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Zr \\<diamondsuit>\\<^sub>p lev I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> Zr \\<diamondsuit>\\<^sub>p lev I", "apply (simp add:Rxa_def, simp add:Zr_times)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier Zr. x = r * lev I", "apply (cut_tac t = x and b = \"lev I\" in mult_div_mod_eq [symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier Zr. x = r * lev I", "apply (subgoal_tac \"x = (x div lev I) * (lev I)\",\n        subgoal_tac \"x div lev I \\<in> carrier Zr\", blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I;\n        x = x div lev I * lev I\\<rbrakk>\n       \\<Longrightarrow> x div lev I \\<in> carrier Zr\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x = x div lev I * lev I", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x = x div lev I * lev I", "apply (subgoal_tac \"x mod lev I = 0\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I; x = lev I * (x div lev I);\n        x mod lev I = 0\\<rbrakk>\n       \\<Longrightarrow> x = x div lev I * lev I\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I = 0", "apply (subst mult.commute, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I = 0", "apply (subgoal_tac \"x mod lev I \\<in> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I;\n        x mod lev I \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I = 0\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (thin_tac \"x = lev I * (x div lev I) + x mod lev I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I; x mod lev I \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I = 0\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (frule_tac a = x in pos_mod_conj[of \"lev I\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I; x mod lev I \\<in> I;\n        0 \\<le> x mod lev I \\<and> x mod lev I < lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I = 0\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; x \\<in> I; x mod lev I \\<in> I;\n        0 \\<le> x mod lev I \\<and> x mod lev I < lev I;\n        x mod lev I \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; x \\<in> I; x mod lev I \\<in> I;\n        x mod lev I \\<noteq> 0; 0 \\<le> x mod lev I;\n        x mod lev I < lev I\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (frule_tac a = \"x mod (lev I)\" in forall_spec)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; x \\<in> I; x mod lev I \\<in> I;\n        x mod lev I \\<noteq> 0; 0 \\<le> x mod lev I;\n        x mod lev I < lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I \\<and> 0 < x mod lev I\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; x \\<in> I; x mod lev I \\<in> I;\n        x mod lev I \\<noteq> 0; 0 \\<le> x mod lev I; x mod lev I < lev I;\n        lev I \\<le> x mod lev I\\<rbrakk>\n       \\<Longrightarrow> False\n 3. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; x \\<in> I; x mod lev I \\<in> I;\n        x mod lev I \\<noteq> 0; 0 \\<le> x mod lev I; x mod lev I < lev I;\n        lev I \\<le> x mod lev I\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply arith"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (frule_tac r = \"x div (lev I)\" in\n          Ring.ideal_ring_multiple1[of \"Zr\" \"I\" \"lev I\"], assumption+,\n          simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        x = lev I * (x div lev I) + x mod lev I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I)\n        \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (frule sym, thin_tac \"x = lev I * (x div lev I) + x mod lev I\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> I", "apply (rule_tac a = \"lev I * (x div lev I)\" and b = \"x mod lev I \" in\n         Ring.ideal_ele_sumTr1[of \"Zr\" \"I\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> carrier Zr\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> carrier Zr\n 3. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I *\n                         (x div lev I) \\<plusminus>\\<^bsub>Zr\\<^esub>\n                         x mod lev I\n                         \\<in> I\n 4. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> I", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> x mod lev I \\<in> carrier Zr\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I *\n                         (x div lev I) \\<plusminus>\\<^bsub>Zr\\<^esub>\n                         x mod lev I\n                         \\<in> I\n 3. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> I", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I *\n                         (x div lev I) \\<plusminus>\\<^bsub>Zr\\<^esub>\n                         x mod lev I\n                         \\<in> I\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> I", "apply (subst Zr_add)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) + x mod lev I \\<in> I\n 2. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I \\<noteq> {0}; Ring Zr;\n        \\<forall>x. x \\<in> I \\<and> 0 < x \\<longrightarrow> lev I \\<le> x;\n        lev I \\<in> I; 0 < lev I; x \\<in> I;\n        lev I \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> (x div lev I) \\<in> I;\n        lev I * (x div lev I) + x mod lev I = x\\<rbrakk>\n       \\<Longrightarrow> lev I * (x div lev I) \\<in> I", "apply (simp add:Zr_times)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma Zr_pir:\"ideal Zr I \\<Longrightarrow> \\<exists>n. Rxa Zr n = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal Zr I \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "(** principal ideal ring *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal Zr I \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (case_tac \"I = {(0::int)}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (subgoal_tac \"Rxa Zr 0 = I\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal Zr I; I = {0}; Zr \\<diamondsuit>\\<^sub>p 0 = I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I\n 2. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p 0 = I\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p 0 = I\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> Zr \\<diamondsuit>\\<^sub>p 0 \\<subseteq> I\n 2. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Zr \\<diamondsuit>\\<^sub>p 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (rule subsetI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I = {0};\n        x \\<in> Zr \\<diamondsuit>\\<^sub>p 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I\n 2. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Zr \\<diamondsuit>\\<^sub>p 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (simp add:Rxa_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr {0}; I = {0};\n        \\<exists>r\\<in>carrier Zr.\n           x = r \\<cdot>\\<^sub>r\\<^bsub>Zr\\<^esub> 0\\<rbrakk>\n       \\<Longrightarrow> x = 0\n 2. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Zr \\<diamondsuit>\\<^sub>p 0\n 3. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (simp add:Zr_def Zset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal Zr I; I = {0}\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> Zr \\<diamondsuit>\\<^sub>p 0\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal Zr I; I = {0}; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> Zr \\<diamondsuit>\\<^sub>p 0\n 2. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (simp add:Rxa_def Zr_def Zset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply (frule Zr_gen_Zleast [of \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal Zr I; I \\<noteq> {0};\n     Zr \\<diamondsuit>\\<^sub>p lev I = I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. Zr \\<diamondsuit>\\<^sub>p n = I", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Quotient rings\""], ["", "lemma (in Ring) mem_set_ar_cos:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                         a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_ar_cos R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_ar_cos R I", "by (simp add:set_ar_cos_def, blast)"], ["", "lemma (in Ring) I_in_set_ar_cos:\"ideal R I \\<Longrightarrow> I \\<in> set_ar_cos R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<in> set_ar_cos R I", "apply (cut_tac ring_is_ag,\n       frule ideal_asubg[of \"I\"],\n       rule aGroup.unit_in_set_ar_cos, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n       b \\<plusminus> (-\\<^sub>a a) \\<in> I \\<rbrakk> \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule aGroup.b_ag_group[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier R.\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule aGroup.ag_carrier_carrier[THEN sym, of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R;\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier R.\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier (b_ag R).\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule Group.rcs_eq[of \"b_ag R\" \"I\" \"a\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier (b_ag R).\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R);\n     (b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a\n      \\<in> I) =\n     (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n      I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule aGroup.agop_gop [of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier (b_ag R).\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R);\n     (b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a\n      \\<in> I) =\n     (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n      I \\<bullet>\\<^bsub>b_ag R\\<^esub> b);\n     (\\<cdot>\\<^bsub>b_ag R\\<^esub>) = (\\<plusminus>)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule aGroup.agiop_giop[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier (b_ag R).\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R);\n     (b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a\n      \\<in> I) =\n     (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n      I \\<bullet>\\<^bsub>b_ag R\\<^esub> b);\n     (\\<cdot>\\<^bsub>b_ag R\\<^esub>) = (\\<plusminus>);\n     iop (b_ag R) = mop R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     b \\<plusminus> -\\<^sub>a a \\<in> I; aGroup R; Group (b_ag R);\n     b_ag R \\<guillemotright> I ;\n     \\<forall>r\\<in>carrier (b_ag R).\n        \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I;\n     carrier R = carrier (b_ag R);\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     (\\<cdot>\\<^bsub>b_ag R\\<^esub>) = (\\<plusminus>);\n     iop (b_ag R) = mop R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I =\n                      b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:ar_coset_def rcs_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n                                  a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>  b \\<plusminus> (-\\<^sub>a a) \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = b \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I", "apply (frule aGroup.b_ag_group[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I", "apply (simp add:ideal_def asubGroup_def, frule conjunct1, fold asubGroup_def,\n        fold ideal_def, simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I", "apply (subgoal_tac \"a \\<in> carrier (b_ag R)\",\n         subgoal_tac \"b \\<in> carrier (b_ag R)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)", "apply (simp add:Group.rcs_eq[THEN sym, of \"b_ag R\" \"I\" \"a\" \"b\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)", "apply (frule aGroup.agop_gop [of \"R\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     (\\<cdot>\\<^bsub>b_ag R\\<^esub>) = (\\<plusminus>)\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)", "apply (frule aGroup.agiop_giop[of \"R\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     b \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R); b \\<in> carrier (b_ag R);\n     (\\<cdot>\\<^bsub>b_ag R\\<^esub>) = (\\<plusminus>);\n     iop (b_ag R) = mop R\\<rbrakk>\n    \\<Longrightarrow> b \\<plusminus> -\\<^sub>a a \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I ;\n     a \\<in> carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> b;\n     aGroup R; Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)", "apply (simp add:b_ag_def)+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same3:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk> \\<Longrightarrow>\n                               a\\<in>I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (rule Group.rcs_fixed [of \"b_ag R\" \"I\" \"a\" ])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> Group (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 3. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (rule aGroup.b_ag_group, assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same3_1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                                                    a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; a \\<notin> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:ar_coset_same3)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same4:\"\\<lbrakk>ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow>\n                                     a \\<uplus>\\<^bsub>R\\<^esub> I = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I", "apply (frule ideal_subset[of \"I\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (rule Group.rcs_Unit2 [of \"b_ag R\" \"I\"\"a\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> Group (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 3. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (rule aGroup.b_ag_group, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 2. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> I; aGroup R; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_same4_1:\"\\<lbrakk>ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk> \\<Longrightarrow> a \\<notin> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I\\<rbrakk>\n    \\<Longrightarrow> a \\<notin> I", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I \\<noteq> I;\n     a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:ar_coset_same4)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) belong_ar_coset1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n                 x \\<plusminus> (-\\<^sub>a a) \\<in> I\\<rbrakk> \\<Longrightarrow>  x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule ar_coset_same1 [of \"I\" \"a\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (subgoal_tac \"x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (subgoal_tac \"carrier R = carrier (b_ag R)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R; carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (frule aGroup.agop_gop[THEN sym, of \"R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (frule aGroup.agiop_giop [THEN sym, of \"R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> x \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> x\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> x\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (rule Group.a_in_rcs [of \"b_ag R\" \"I\" \"x\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> Group (b_ag R)\n 2. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 3. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (b_ag R)\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add: aGroup.b_ag_group)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 2. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> carrier (b_ag R);\n     x \\<cdot>\\<^bsub>b_ag R\\<^esub> \\<rho>\\<^bsub>b_ag R\\<^esub> a \\<in> I;\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n     I \\<bullet>\\<^bsub>b_ag R\\<^esub> x;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> carrier R;\n     x \\<plusminus> -\\<^sub>a a \\<in> I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = x \\<uplus>\\<^bsub>R\\<^esub> I;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) a_in_ar_coset:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule belong_ar_coset1, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a a \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a a \\<in> I", "apply (simp add:aGroup.ag_r_inv1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> I", "apply (simp add:ideal_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_subsetD:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I \\<rbrakk> \\<Longrightarrow>\n                           x \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R", "apply (subgoal_tac \"carrier R = carrier (b_ag R)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; carrier R = carrier (b_ag R);\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (frule aGroup.agop_gop [THEN sym, of \"R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; carrier R = carrier (b_ag R);\n     aGroup R; (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (frule aGroup.agiop_giop [THEN sym, of \"R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; carrier R = carrier (b_ag R);\n     aGroup R; (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier (b_ag R);\n     x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (rule Group.rcs_subset_elem[of \"b_ag R\" \"I\" \"a\" \"x\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> Group (b_ag R)\n 2. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 3. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 4. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 5. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:aGroup.b_ag_group)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b_ag R \\<guillemotright> I \n 2. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 3. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 2. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     carrier R = carrier (b_ag R); aGroup R;\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> carrier R = carrier (b_ag R)", "apply (simp add:b_ag_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_cos_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                 a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I", "apply (simp add:set_rcs_def ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa\\<in>carrier (b_ag R).\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa", "apply (frule aGroup.ag_carrier_carrier[THEN sym, of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; aGroup R;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa\\<in>carrier (b_ag R).\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier (b_ag R); aGroup R;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa\\<in>carrier (b_ag R).\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> a =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) mem_ar_coset1:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                                 \\<exists>h\\<in>I. h \\<plusminus> a = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. h \\<plusminus> a = x", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. h \\<plusminus> a = x", "apply (frule aGroup.ag_carrier_carrier[THEN sym, of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n     carrier R = carrier (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. h \\<plusminus> a = x", "apply (frule aGroup.agop_gop [THEN sym, of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n     carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. h \\<plusminus> a = x", "apply (frule aGroup.agiop_giop [THEN sym, of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n     carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. h \\<plusminus> a = x", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier (b_ag R);\n     x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a; aGroup R;\n     carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I.\n                         h \\<cdot>\\<^bsub>b_ag R\\<^esub> a = x", "apply (simp add:ideal_def asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>b_ag R \\<guillemotright> I  \\<and>\n             (\\<forall>r\\<in>carrier (b_ag R).\n                 \\<forall>x\\<in>I. r \\<cdot>\\<^sub>r x \\<in> I);\n     a \\<in> carrier (b_ag R); x \\<in> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a;\n     aGroup R; carrier R = carrier (b_ag R);\n     (\\<plusminus>) = (\\<cdot>\\<^bsub>b_ag R\\<^esub>);\n     mop R = iop (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I.\n                         h \\<cdot>\\<^bsub>b_ag R\\<^esub> a = x", "apply (simp add:rcs_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_coset_mem2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                           \\<exists>h\\<in>I. x = a \\<plusminus> h\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. x = a \\<plusminus> h", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. x = a \\<plusminus> h", "apply (frule mem_ar_coset1 [of \"I\" \"a\" \"x\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n     \\<exists>h\\<in>I. h \\<plusminus> a = x\\<rbrakk>\n    \\<Longrightarrow> \\<exists>h\\<in>I. x = a \\<plusminus> h", "apply (erule bexE,\n       frule_tac h = h in ideal_subset[of \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R; h \\<in> I;\n        h \\<plusminus> a = x; h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>h\\<in>I. x = a \\<plusminus> h", "apply (simp add:aGroup.ag_pOp_commute[of \"R\" _ \"a\"],\n       frule sym, thin_tac \"a \\<plusminus> h = x\", blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) belong_ar_coset2:\"\\<lbrakk>ideal R I; a \\<in> carrier R; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I \\<rbrakk>\n                                    \\<Longrightarrow> x \\<plusminus> (-\\<^sub>a a) \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<in> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<in> I", "apply (frule mem_ar_coset1, assumption+, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R; h \\<in> I;\n        h \\<plusminus> a = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<in> I", "apply (frule sym, thin_tac \"h \\<plusminus> a = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        h \\<plusminus> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = h \\<plusminus> a\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<plusminus> -\\<^sub>a a \\<in> I", "apply (frule_tac h = h in ideal_subset[of \"I\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        h \\<plusminus> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = h \\<plusminus> a; h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<plusminus> -\\<^sub>a a \\<in> I", "apply (frule aGroup.ag_mOp_closed[of \"R\" \"a\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R;\n        h \\<plusminus> a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = h \\<plusminus> a; h \\<in> carrier R;\n        -\\<^sub>a a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> a \\<plusminus> -\\<^sub>a a \\<in> I", "apply (subst aGroup.ag_pOp_assoc, assumption+,\n        simp add:aGroup.ag_r_inv1,\n        simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_c_top: \"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> (c_top (b_ag R) I (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I)) = (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag R) I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_is_ag, frule ideal_asubg,\n       frule aGroup.asubg_nsubg[of \"R\" \"I\"], assumption,\n       frule aGroup.b_ag_group[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag R) I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> c_top (b_ag R) I (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                       (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b) =\n                      I \\<bullet>\\<^bsub>b_ag R\\<^esub> (a \\<plusminus> b)", "apply (subst Group.c_top_welldef[THEN sym], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                      (a \\<cdot>\\<^bsub>b_ag R\\<^esub> b) =\n                      I \\<bullet>\\<^bsub>b_ag R\\<^esub> (a \\<plusminus> b)", "apply (simp add:aGroup.ag_carrier_carrier)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     R +> I; b_ag R \\<triangleright> I; Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                      (a \\<cdot>\\<^bsub>b_ag R\\<^esub> b) =\n                      I \\<bullet>\\<^bsub>b_ag R\\<^esub> (a \\<plusminus> b)", "apply (simp add:aGroup.agop_gop)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>Following lemma is not necessary to define a quotient ring. But\nit makes clear that the binary operation2 of the quotient ring is well\ndefined.\\<close>"], ["", "lemma (in Ring) quotient_ring_tr1:\"\\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n                b1 \\<in> carrier R; b2 \\<in> carrier R;\n                a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I; b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                             (a1 \\<cdot>\\<^sub>r b1) \\<uplus>\\<^bsub>R\\<^esub> I = (a2 \\<cdot>\\<^sub>r b2) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n     b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> a1 \\<cdot>\\<^sub>r b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n                      a2 \\<cdot>\\<^sub>r b2 \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule ar_coset_same1, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n     b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> a1 \\<cdot>\\<^sub>r b1 \\<in> carrier R\n 2. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n     b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<in> carrier R\n 3. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n     b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<plusminus>\n                      -\\<^sub>a a1 \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (simp add: ring_tOp_closed)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I =\n     b2 \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<plusminus>\n                      -\\<^sub>a a1 \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (frule ar_coset_same2 [of \"I\" \"a1\" \"a2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<plusminus>\n                      -\\<^sub>a a1 \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (frule ar_coset_same2 [of \"I\" \"b1\" \"b2\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I;\n     b2 \\<plusminus> -\\<^sub>a b1 \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<plusminus>\n                      -\\<^sub>a a1 \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (frule ring_distrib4[of \"a2\" \"b2\" \"a1\" \"b1\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I;\n     b2 \\<plusminus> -\\<^sub>a b1 \\<in> I;\n     a2 \\<cdot>\\<^sub>r b2 \\<plusminus> -\\<^sub>a a1 \\<cdot>\\<^sub>r b1 =\n     a2 \\<cdot>\\<^sub>r (b2 \\<plusminus> -\\<^sub>a b1) \\<plusminus>\n     (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r b2 \\<plusminus>\n                      -\\<^sub>a a1 \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I;\n     b2 \\<plusminus> -\\<^sub>a b1 \\<in> I;\n     a2 \\<cdot>\\<^sub>r b2 \\<plusminus> -\\<^sub>a a1 \\<cdot>\\<^sub>r b1 =\n     a2 \\<cdot>\\<^sub>r (b2 \\<plusminus> -\\<^sub>a b1) \\<plusminus>\n     (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r\n                      (b2 \\<plusminus> -\\<^sub>a b1) \\<plusminus>\n                      (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (rule ideal_pOp_closed[of \"I\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I;\n     b2 \\<plusminus> -\\<^sub>a b1 \\<in> I;\n     a2 \\<cdot>\\<^sub>r b2 \\<plusminus> -\\<^sub>a a1 \\<cdot>\\<^sub>r b1 =\n     a2 \\<cdot>\\<^sub>r (b2 \\<plusminus> -\\<^sub>a b1) \\<plusminus>\n     (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\\<rbrakk>\n    \\<Longrightarrow> a2 \\<cdot>\\<^sub>r (b2 \\<plusminus> -\\<^sub>a b1)\n                      \\<in> I\n 2. \\<lbrakk>ideal R I; a1 \\<in> carrier R; a2 \\<in> carrier R;\n     b1 \\<in> carrier R; b2 \\<in> carrier R;\n     a1 \\<uplus>\\<^bsub>R\\<^esub> I = a2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     b1 \\<uplus>\\<^bsub>R\\<^esub> I = b2 \\<uplus>\\<^bsub>R\\<^esub> I;\n     a2 \\<plusminus> -\\<^sub>a a1 \\<in> I;\n     b2 \\<plusminus> -\\<^sub>a b1 \\<in> I;\n     a2 \\<cdot>\\<^sub>r b2 \\<plusminus> -\\<^sub>a a1 \\<cdot>\\<^sub>r b1 =\n     a2 \\<cdot>\\<^sub>r (b2 \\<plusminus> -\\<^sub>a b1) \\<plusminus>\n     (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\\<rbrakk>\n    \\<Longrightarrow> (a2 \\<plusminus> -\\<^sub>a a1) \\<cdot>\\<^sub>r b1\n                      \\<in> I", "apply (simp add:ideal_ring_multiple, simp add:ideal_ring_multiple1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  rcostOp :: \"[_, 'a set] \\<Rightarrow> (['a set, 'a set] \\<Rightarrow> 'a set)\" where\n  \"rcostOp R I = (\\<lambda>X\\<in>(set_rcs (b_ag R) I). \\<lambda>Y\\<in>(set_rcs (b_ag R) I).\n                {z. \\<exists> x \\<in> X. \\<exists> y \\<in> Y. \\<exists>h\\<in>I. (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) \\<plusminus>\\<^bsub>R\\<^esub> h = z})\""], ["", "lemma (in Ring) rcostOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                    rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule ar_cos_mem[of \"I\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule ar_cos_mem[of \"I\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                       (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:rcostOp_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                             \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                                \\<exists>h\\<in>I.\n                                   x \\<cdot>\\<^sub>r y \\<plusminus> h = z} =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> {z. \\<exists>x\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                             \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                                \\<exists>h\\<in>I.\n                                   x \\<cdot>\\<^sub>r y \\<plusminus> h = z}\n                      \\<subseteq> a \\<cdot>\\<^sub>r\n                                  b \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        \\<exists>xa\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n           \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n              \\<exists>h\\<in>I.\n                 xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<cdot>\\<^sub>r\n                                 b \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> a \\<cdot>\\<^sub>r\n                                 b \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule belong_ar_coset1, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<plusminus> h \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 3. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule aGroup.ag_pOp_closed, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> carrier R\n 3. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (frule_tac x = xa in ar_coset_mem2[of \"I\" \"a\"], assumption+,\n        frule_tac x = y in ar_coset_mem2[of \"I\" \"b\"], assumption+,\n        (erule bexE)+, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa y h ha hb.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        a \\<plusminus> ha \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        b \\<plusminus> hb \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x =\n        (a \\<plusminus> ha) \\<cdot>\\<^sub>r (b \\<plusminus> hb) \\<plusminus>\n        h;\n        ha \\<in> I; xa = a \\<plusminus> ha; hb \\<in> I;\n        y = b \\<plusminus> hb\\<rbrakk>\n       \\<Longrightarrow> (a \\<plusminus> ha) \\<cdot>\\<^sub>r\n                         (b \\<plusminus> hb)\n                         \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> carrier R\n 3. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule ring_tOp_closed, rule aGroup.ag_pOp_closed, assumption+,\n        simp add:ideal_subset)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa y h ha hb.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        a \\<plusminus> ha \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        b \\<plusminus> hb \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x =\n        (a \\<plusminus> ha) \\<cdot>\\<^sub>r (b \\<plusminus> hb) \\<plusminus>\n        h;\n        ha \\<in> I; xa = a \\<plusminus> ha; hb \\<in> I;\n        y = b \\<plusminus> hb\\<rbrakk>\n       \\<Longrightarrow> b \\<plusminus> hb \\<in> carrier R\n 2. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> h \\<in> carrier R\n 3. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 4. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule aGroup.ag_pOp_closed, assumption+, simp add:ideal_subset,\n        simp add:ideal_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (frule sym, thin_tac \"xa \\<cdot>\\<^sub>r y \\<plusminus> h = x\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<plusminus> h \\<plusminus>\n                         -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (frule_tac x = xa in belong_ar_coset2[of \"I\" \"a\"], assumption+,\n        frule_tac x = y in belong_ar_coset2[of \"I\" \"b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h;\n        xa \\<plusminus> -\\<^sub>a a \\<in> I;\n        y \\<plusminus> -\\<^sub>a b \\<in> I\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<plusminus> h \\<plusminus>\n                         -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (frule_tac x = xa in ar_coset_subsetD[of \"I\" \"a\"], assumption+,\n        frule_tac x = y in ar_coset_subsetD[of \"I\" \"b\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h;\n        xa \\<plusminus> -\\<^sub>a a \\<in> I;\n        y \\<plusminus> -\\<^sub>a b \\<in> I; xa \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<plusminus> h \\<plusminus>\n                         -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (subst aGroup.ag_pOp_commute, assumption,\n        simp add:ring_tOp_closed, simp add:ideal_subset)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h;\n        xa \\<plusminus> -\\<^sub>a a \\<in> I;\n        y \\<plusminus> -\\<^sub>a b \\<in> I; xa \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> xa \\<cdot>\\<^sub>r y \\<plusminus>\n                         -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (subst aGroup.ag_pOp_assoc, assumption,\n        simp add:ideal_subset, simp add:ring_tOp_closed,\n        rule aGroup.ag_mOp_closed, simp add:ring_tOp_closed,\n        simp add:ring_tOp_closed)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h;\n        xa \\<plusminus> -\\<^sub>a a \\<in> I;\n        y \\<plusminus> -\\<^sub>a b \\<in> I; xa \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus>\n                         (xa \\<cdot>\\<^sub>r y \\<plusminus>\n                          -\\<^sub>a a \\<cdot>\\<^sub>r b)\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa y h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        xa \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        y \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = xa \\<cdot>\\<^sub>r y \\<plusminus> h;\n        xa \\<plusminus> -\\<^sub>a a \\<in> I;\n        y \\<plusminus> -\\<^sub>a b \\<in> I; xa \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r y \\<plusminus>\n                         -\\<^sub>a a \\<cdot>\\<^sub>r b\n                         \\<in> I\n 2. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule_tac a = xa and a' = y and b = a and b' = b in times_modTr,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n     a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n     b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I\\<rbrakk>\n    \\<Longrightarrow> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<subseteq> {z. \\<exists>x\n         \\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n   \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n      \\<exists>h\\<in>I. x \\<cdot>\\<^sub>r y \\<plusminus> h = z}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        x \\<in> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                            \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                               \\<exists>h\\<in>I.\n                                  xa \\<cdot>\\<^sub>r y \\<plusminus> h = x", "apply (frule_tac x = x in ar_coset_mem2[of \"I\" \"a \\<cdot>\\<^sub>r b\"],\n        simp add:ring_tOp_closed, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        x \\<in> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I;\n        \\<exists>h\\<in>I. x = a \\<cdot>\\<^sub>r b \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                            \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                               \\<exists>h\\<in>I.\n                                  xa \\<cdot>\\<^sub>r y \\<plusminus> h = x", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        x \\<in> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I; h \\<in> I;\n        x = a \\<cdot>\\<^sub>r b \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                            \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                               \\<exists>h\\<in>I.\n                                  xa \\<cdot>\\<^sub>r y \\<plusminus> h = x", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        a \\<cdot>\\<^sub>r b \\<plusminus> h\n        \\<in> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I;\n        h \\<in> I; x = a \\<cdot>\\<^sub>r b \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                            \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                               \\<exists>ha\\<in>I.\n                                  x \\<cdot>\\<^sub>r y \\<plusminus> ha =\n                                  a \\<cdot>\\<^sub>r b \\<plusminus> h", "apply (frule a_in_ar_coset[of \"I\" \"a\"], assumption+,\n        frule a_in_ar_coset[of \"I\" \"b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R; aGroup R;\n        a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        b \\<uplus>\\<^bsub>R\\<^esub> I \\<in> set_rcs (b_ag R) I;\n        a \\<cdot>\\<^sub>r b \\<plusminus> h\n        \\<in> a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I;\n        h \\<in> I; x = a \\<cdot>\\<^sub>r b \\<plusminus> h;\n        a \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I;\n        b \\<in> b \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>a \\<uplus>\\<^bsub>R\\<^esub> I.\n                            \\<exists>y\\<in>b \\<uplus>\\<^bsub>R\\<^esub> I.\n                               \\<exists>ha\\<in>I.\n                                  x \\<cdot>\\<^sub>r y \\<plusminus> ha =\n                                  a \\<cdot>\\<^sub>r b \\<plusminus> h", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  qring ::  \"[('a, 'm) Ring_scheme, 'a set] \\<Rightarrow> \\<lparr> carrier :: 'a set set,\n    pop :: ['a  set, 'a set] \\<Rightarrow> 'a set, mop :: 'a set \\<Rightarrow> 'a set,\n    zero :: 'a set, tp :: ['a  set, 'a set] \\<Rightarrow> 'a set, un :: 'a set \\<rparr>\" where\n  \"qring R I = \\<lparr> carrier = set_rcs (b_ag R) I,\n    pop = c_top (b_ag R) I,\n    mop = c_iop (b_ag R) I,\n    zero = I,\n    tp = rcostOp R I,\n    un = 1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I\\<rparr>\""], ["", "abbreviation\n  QRING  (infixl \"'/\\<^sub>r\" 200) where\n  \"R /\\<^sub>r I == qring R I\""], ["", "lemma (in Ring) carrier_qring:\"ideal R I \\<Longrightarrow>\n                               carrier (qring R I) = set_rcs (b_ag R) I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> carrier (R /\\<^sub>r I) = set_rcs (b_ag R) I", "by (simp add:qring_def)"], ["", "lemma (in Ring) carrier_qring1:\"ideal R I \\<Longrightarrow>\n                                carrier (qring R I) = set_ar_cos R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> carrier (R /\\<^sub>r I) = set_ar_cos R I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> carrier (R /\\<^sub>r I) = set_ar_cos R I", "apply (simp add:carrier_qring set_rcs_def set_ar_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> {C. \\<exists>a\\<in>carrier (b_ag R).\n                             C = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a} =\n                      {X. \\<exists>a\\<in>carrier R.\n                             X = a \\<uplus>\\<^bsub>R\\<^esub> I}", "apply (simp add:ar_coset_def aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_ring:\"ideal R I \\<Longrightarrow> Ring (qring R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> Ring (R /\\<^sub>r I)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> Ring (R /\\<^sub>r I)", "apply (frule ideal_asubg[of \"I\"],\n        frule aGroup.asubg_nsubg[of \"R\" \"I\"], assumption,\n        frule aGroup.b_ag_group[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> Ring (R /\\<^sub>r I)", "apply (subst Ring_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule Pi_I)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); x \\<in> carrier (R /\\<^sub>r I);\n        xa \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> xa\n                         \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:carrier_qring, simp add:set_rcs_def, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa a aa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (b_ag R);\n        x = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a; aa \\<in> carrier (b_ag R);\n        xa = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (b_ag R).\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> xa =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (subst qring_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa a aa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (b_ag R);\n        x = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a; aa \\<in> carrier (b_ag R);\n        xa = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ab\\<in>carrier (b_ag R).\n                            c_top (b_ag R) I\n                             (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                             (I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa) =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (subst Group.c_top_welldef[THEN sym, of \"b_ag R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa a aa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (b_ag R);\n        x = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a; aa \\<in> carrier (b_ag R);\n        xa = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ab\\<in>carrier (b_ag R).\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                            (a \\<cdot>\\<^bsub>b_ag R\\<^esub> aa) =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (blast dest: Group.mult_closed[of \"b_ag R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier\n(R /\\<^sub>r I) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier\n    (R /\\<^sub>r I) \\<longrightarrow>\n                                 a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 c =\n                                 a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c)))\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I);\n        b \\<in> carrier (R /\\<^sub>r I);\n        c \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         c =\n                         a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> c)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_rcs (b_ag R) I;\n        b \\<in> set_rcs (b_ag R) I; c \\<in> set_rcs (b_ag R) I\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I (c_top (b_ag R) I a b) c =\n                         c_top (b_ag R) I a (c_top (b_ag R) I b c)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:Group.Qg_tassoc[of \"b_ag R\" \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier\n(R /\\<^sub>r I) \\<longrightarrow>\n                             a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> b =\n                             b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> a)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I);\n        b \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> b =\n                         b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_rcs (b_ag R) I;\n        b \\<in> set_rcs (b_ag R) I\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I a b = c_top (b_ag R) I b a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:set_rcs_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier (b_ag R);\n        a = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa; ab \\<in> carrier (b_ag R);\n        b = I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (subst Group.c_top_welldef[THEN sym, of \"b_ag R\" \"I\"], assumption+)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier (b_ag R);\n        a = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa; ab \\<in> carrier (b_ag R);\n        b = I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (aa \\<cdot>\\<^bsub>b_ag R\\<^esub> ab) =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (ab \\<cdot>\\<^bsub>b_ag R\\<^esub> aa)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.agop_gop)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier (b_ag R);\n        a = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa; ab \\<in> carrier (b_ag R);\n        b = I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (aa \\<plusminus> ab) =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (ab \\<plusminus> aa)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = I \\<bullet>\\<^bsub>b_ag R\\<^esub> aa; ab \\<in> carrier R;\n        b = I \\<bullet>\\<^bsub>b_ag R\\<^esub> ab\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (aa \\<plusminus> ab) =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (ab \\<plusminus> aa)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:aGroup.ag_pOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> mop (R /\\<^sub>r I)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def Group.Qg_iop_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) \\<and>\n                      \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_rcs (b_ag R) I\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I (c_iop (b_ag R) I a) a = I\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:Group.Qg_i[of \"b_ag R\" \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> I \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (frule Group.nsg_sg[of \"b_ag R\" \"I\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> I \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:Group.unit_rcs_in_set_rcs)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a) \\<and>\n                      (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_rcs (b_ag R) I\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I I a = a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:Group.Qg_unit[of \"b_ag R\" \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>)\n                      \\<in> carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<rightarrow>\n                            carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply(rule Pi_I)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); x \\<in> carrier (R /\\<^sub>r I);\n        xa \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> xa\n                         \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); x \\<in> set_ar_cos R I;\n        xa \\<in> set_ar_cos R I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I x xa \\<in> set_ar_cos R I\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:set_ar_cos_def, (erule bexE)+, simp add:rcostOp,\n        blast dest: ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c)))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier\n(R /\\<^sub>r I) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier\n    (R /\\<^sub>r I) \\<longrightarrow>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 c =\n                                 a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c)))\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I);\n        b \\<in> carrier (R /\\<^sub>r I);\n        c \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         c =\n                         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         (b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> c)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_ar_cos R I; b \\<in> set_ar_cos R I;\n        c \\<in> set_ar_cos R I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (rcostOp R I a b) c =\n                         rcostOp R I a (rcostOp R I b c)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:set_ar_cos_def, (erule bexE)+, simp add:rcostOp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c aa ab ac.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I; ab \\<in> carrier R;\n        b = ab \\<uplus>\\<^bsub>R\\<^esub> I; ac \\<in> carrier R;\n        c = ac \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I\n                          (aa \\<cdot>\\<^sub>r\n                           ab \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (ac \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (ab \\<cdot>\\<^sub>r\n                           ac \\<uplus>\\<^bsub>R\\<^esub> I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (frule_tac x = aa and y = ab in ring_tOp_closed, assumption+,\n        frule_tac x = ab and y = ac in ring_tOp_closed, assumption+,\n        simp add:rcostOp, simp add:ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              b =\n                              b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                              a)) \\<and>\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier\n(R /\\<^sub>r I) \\<longrightarrow>\n                             a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             b =\n                             b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             a)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I);\n        b \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> b =\n                         b \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_ar_cos R I;\n        b \\<in> set_ar_cos R I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I a b = rcostOp R I b a\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:set_ar_cos_def, (erule bexE)+, simp add:rcostOp,\n        simp add:ring_tOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<in> set_ar_cos R I\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (cut_tac ring_one, simp add:set_ar_cos_def, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          (\\<forall>b.\n                              b \\<in> carrier\n (R /\\<^sub>r I) \\<longrightarrow>\n                              (\\<forall>c.\n                                  c \\<in> carrier\n     (R /\\<^sub>r I) \\<longrightarrow>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                   c) =\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c))) \\<and>\n                      (\\<forall>a.\n                          a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                          1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                          a =\n                          a)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         (\\<forall>b.\n                             b \\<in> carrier\n(R /\\<^sub>r I) \\<longrightarrow>\n                             (\\<forall>c.\n                                 c \\<in> carrier\n    (R /\\<^sub>r I) \\<longrightarrow>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                  c) =\n                                 a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                                 c))\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I);\n        b \\<in> carrier (R /\\<^sub>r I);\n        c \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         (b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub> c) =\n                         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         b \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> c\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_ar_cos R I; b \\<in> set_ar_cos R I;\n        c \\<in> set_ar_cos R I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I a (c_top (b_ag R) I b c) =\n                         c_top (b_ag R) I (rcostOp R I a b)\n                          (rcostOp R I a c)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (simp add:set_ar_cos_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c aa ab ac.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I; ab \\<in> carrier R;\n        b = ab \\<uplus>\\<^bsub>R\\<^esub> I; ac \\<in> carrier R;\n        c = ac \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (c_top (b_ag R) I (ab \\<uplus>\\<^bsub>R\\<^esub> I)\n                            (ac \\<uplus>\\<^bsub>R\\<^esub> I)) =\n                         c_top (b_ag R) I\n                          (rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                            (ab \\<uplus>\\<^bsub>R\\<^esub> I))\n                          (rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                            (ac \\<uplus>\\<^bsub>R\\<^esub> I))\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (simp add:ar_c_top rcostOp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c aa ab ac.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I; ab \\<in> carrier R;\n        b = ab \\<uplus>\\<^bsub>R\\<^esub> I; ac \\<in> carrier R;\n        c = ac \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                          ((ab \\<plusminus>\n                            ac) \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         c_top (b_ag R) I\n                          (aa \\<cdot>\\<^sub>r\n                           ab \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (aa \\<cdot>\\<^sub>r\n                           ac \\<uplus>\\<^bsub>R\\<^esub> I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (frule_tac x = ab and y = ac in aGroup.ag_pOp_closed,\n                  assumption+,\n        frule_tac x = aa and y = ab in ring_tOp_closed, assumption+ ,\n        frule_tac x = aa and y = ac in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b c aa ab ac.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I; ab \\<in> carrier R;\n        b = ab \\<uplus>\\<^bsub>R\\<^esub> I; ac \\<in> carrier R;\n        c = ac \\<uplus>\\<^bsub>R\\<^esub> I;\n        ab \\<plusminus> ac \\<in> carrier R;\n        aa \\<cdot>\\<^sub>r ab \\<in> carrier R;\n        aa \\<cdot>\\<^sub>r ac \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (aa \\<uplus>\\<^bsub>R\\<^esub> I)\n                          ((ab \\<plusminus>\n                            ac) \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         c_top (b_ag R) I\n                          (aa \\<cdot>\\<^sub>r\n                           ab \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (aa \\<cdot>\\<^sub>r\n                           ac \\<uplus>\\<^bsub>R\\<^esub> I)\n 2. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (simp add:ar_c_top rcostOp, simp add:ring_distrib1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a.\n                         a \\<in> carrier (R /\\<^sub>r I) \\<longrightarrow>\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> carrier (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         a =\n                         a", "apply (simp add:qring_def aGroup.aqgrp_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); a \\<in> set_ar_cos R I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> I)\n                          a =\n                         a", "apply (simp add:set_ar_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (aa \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         aa \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a aa.\n       \\<lbrakk>ideal R I; aGroup R; R +> I; b_ag R \\<triangleright> I;\n        Group (b_ag R); aa \\<in> carrier R;\n        a = aa \\<uplus>\\<^bsub>R\\<^esub> I;\n        1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (aa \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         aa \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:rcostOp, simp add:ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_carrier:\"ideal R I \\<Longrightarrow>\n              carrier (qring R I)  = {X. \\<exists>a\\<in> carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    carrier (R /\\<^sub>r I) =\n    {X. \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}", "apply (simp add:carrier_qring1 set_ar_cos_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    {X. \\<exists>a\\<in>carrier R. X = a \\<uplus>\\<^bsub>R\\<^esub> I} =\n    {X. \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    {X. \\<exists>a\\<in>carrier R. X = a \\<uplus>\\<^bsub>R\\<^esub> I}\n    \\<subseteq> {X. \\<exists>a\\<in>carrier R.\n                       a \\<uplus>\\<^bsub>R\\<^esub> I = X}\n 2. ideal R I \\<Longrightarrow>\n    {X. \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}\n    \\<subseteq> {X. \\<exists>a\\<in>carrier R.\n                       X = a \\<uplus>\\<^bsub>R\\<^esub> I}", "apply (rule subsetI, simp, erule bexE, frule sym, thin_tac \"x = a \\<uplus>\\<^bsub>R\\<^esub> I\",\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    {X. \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> I = X}\n    \\<subseteq> {X. \\<exists>a\\<in>carrier R.\n                       X = a \\<uplus>\\<^bsub>R\\<^esub> I}", "apply (rule subsetI, simp, erule bexE, frule sym, thin_tac \"a \\<uplus>\\<^bsub>R\\<^esub> I = x\",\n       blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_mem:\"\\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                                 a \\<uplus>\\<^bsub>R\\<^esub> I \\<in> carrier (qring R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I\n                      \\<in> carrier (R /\\<^sub>r I)", "apply (simp add:qring_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa\\<in>carrier R.\n                         aa \\<uplus>\\<^bsub>R\\<^esub> I =\n                         a \\<uplus>\\<^bsub>R\\<^esub> I", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_pOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R \\<rbrakk>\n \\<Longrightarrow> pop (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      b \\<uplus>\\<^bsub>R\\<^esub> I =\n                      (a \\<plusminus> b) \\<uplus>\\<^bsub>R\\<^esub> I", "by (simp add:qring_def, simp add:ar_c_top)"], ["", "lemma (in Ring) qring_zero:\"ideal R I \\<Longrightarrow> zero (qring R I) = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> = I", "apply (simp add:qring_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_zero_1:\"\\<lbrakk>a \\<in> carrier R; ideal R I; a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk> \\<Longrightarrow>\n                                    a \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     a \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "by (frule a_in_ar_coset [of \"I\" \"a\"], assumption+, simp)"], ["", "lemma (in Ring) Qring_fix1:\"\\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I\\<rbrakk> \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I", "apply (cut_tac ring_is_ag, frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I; aGroup R;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> a \\<uplus>\\<^bsub>R\\<^esub> I = I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I; aGroup R;\n     Group (b_ag R)\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (frule ideal_asubg[of \"I\"], simp add:asubGroup_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I; a \\<in> I; aGroup R;\n     Group (b_ag R); b_ag R \\<guillemotright> I \\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> a = I", "apply (simp add:Group.rcs_fixed2[of \"b_ag R\" \"I\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ar_cos_same:\"\\<lbrakk>a \\<in> carrier R; ideal R I; x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk> \\<Longrightarrow>\n                                x \\<uplus>\\<^bsub>R\\<^esub> I = a \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n    \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> I =\n                      a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> I =\n                      a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule ar_coset_same1[of \"I\" \"x\" \"a\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<in> carrier R\n 3. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a x \\<in> I", "apply (rule ar_coset_subsetD[of \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; ideal R I;\n     x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a x \\<in> I", "apply (frule ar_coset_mem2[of \"I\" \"a\" \"x\"], assumption+,\n       erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>a \\<in> carrier R; ideal R I;\n        x \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R; h \\<in> I;\n        x = a \\<plusminus> h\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus> -\\<^sub>a x \\<in> I", "apply (frule_tac h = h in ideal_subset[of \"I\"], assumption,\n      simp add:aGroup.ag_p_inv)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>a \\<in> carrier R; ideal R I;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = a \\<plusminus> h; h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\n                         (-\\<^sub>a a \\<plusminus> -\\<^sub>a h)\n                         \\<in> I", "apply (frule_tac x = a in aGroup.ag_mOp_closed[of \"R\"], assumption+,\n       frule_tac x = h in aGroup.ag_mOp_closed[of \"R\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>a \\<in> carrier R; ideal R I;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = a \\<plusminus> h; h \\<in> carrier R;\n        -\\<^sub>a a \\<in> carrier R; -\\<^sub>a h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> a \\<plusminus>\n                         (-\\<^sub>a a \\<plusminus> -\\<^sub>a h)\n                         \\<in> I", "apply (simp add:aGroup.ag_pOp_assoc[THEN sym],\n       simp add:aGroup.ag_r_inv1 aGroup.ag_l_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>h.\n       \\<lbrakk>a \\<in> carrier R; ideal R I;\n        a \\<plusminus> h \\<in> a \\<uplus>\\<^bsub>R\\<^esub> I; aGroup R;\n        h \\<in> I; x = a \\<plusminus> h; h \\<in> carrier R;\n        -\\<^sub>a a \\<in> carrier R; -\\<^sub>a h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a h \\<in> I", "apply (simp add:ideal_inv1_closed)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) qring_tOp:\"\\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                tp (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) (b \\<uplus>\\<^bsub>R\\<^esub> I) = (a \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; a \\<in> carrier R; b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I) \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                      (b \\<uplus>\\<^bsub>R\\<^esub> I) =\n                      a \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> I", "by (simp add:qring_def, simp add:rcostOp)"], ["", "lemma rind_hom_well_def:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A \\<rbrakk> \\<Longrightarrow>\n                                   f a = (f\\<degree>\\<^bsub>A,R\\<^esub>) (a \\<uplus>\\<^bsub>A\\<^esub> (ker\\<^bsub>A,R\\<^esub> f))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A\\<rbrakk>\n    \\<Longrightarrow> f a =\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n     ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> f a =\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)", "apply (frule Ring.mem_set_ar_cos[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\" \"a\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n     ideal A (ker\\<^bsub>A,R\\<^esub> f);\n     a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n     \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> f a =\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)", "apply (simp add:rind_hom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n     ideal A (ker\\<^bsub>A,R\\<^esub> f);\n     a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n     \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> f a =\n                      f (SOME x.\n                            x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)", "apply (rule someI2_ex)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n     ideal A (ker\\<^bsub>A,R\\<^esub> f);\n     a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n     \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>aa.\n                         aa \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f a = f x", "apply (frule Ring.a_in_ar_coset [of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\" \"a\"], assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f a = f x", "apply (frule_tac x = x in Ring.ar_coset_mem2[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\" \"a\"],\n           assumption+, erule bexE, simp,\n        frule_tac h = h in Ring.ideal_subset[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; a \\<in> carrier A;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<plusminus>\\<^bsub>A\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        h \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        x = a \\<plusminus>\\<^bsub>A\\<^esub> h; h \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f a = f (a \\<plusminus>\\<^bsub>A\\<^esub> h)", "apply (frule_tac Ring.ring_is_ag[of \"A\"],\n        frule_tac Ring.ring_is_ag[of \"R\"],\n        simp add:rHom_def, frule conjunct1, simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>Ring A; Ring R;\n        (\\<forall>x\\<in>carrier A.\n            \\<forall>y\\<in>carrier A.\n               f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n               f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        a \\<in> carrier A; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<plusminus>\\<^bsub>A\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        h \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        x = a \\<plusminus>\\<^bsub>A\\<^esub> h; h \\<in> carrier A; aGroup A;\n        aGroup R; f \\<in> aHom A R\\<rbrakk>\n       \\<Longrightarrow> f a = f a \\<plusminus>\\<^bsub>R\\<^esub> f h", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x h.\n       \\<lbrakk>Ring A; Ring R;\n        (\\<forall>x\\<in>carrier A.\n            \\<forall>y\\<in>carrier A.\n               f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n               f x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> f y) \\<and>\n        f 1\\<^sub>r\\<^bsub>A\\<^esub> = 1\\<^sub>r\\<^bsub>R\\<^esub>;\n        a \\<in> carrier A;\n        ideal A {a \\<in> carrier A. f a = \\<zero>\\<^bsub>R\\<^esub>};\n        a \\<uplus>\\<^bsub>A\\<^esub> {a \\<in> carrier A.\n                                     f a = \\<zero>\\<^bsub>R\\<^esub>}\n        \\<in> set_ar_cos A\n               {a \\<in> carrier A. f a = \\<zero>\\<^bsub>R\\<^esub>};\n        a \\<plusminus>\\<^bsub>A\\<^esub> h\n        \\<in> a \\<uplus>\\<^bsub>A\\<^esub> {a \\<in> carrier A.\n     f a = \\<zero>\\<^bsub>R\\<^esub>};\n        f h = \\<zero>\\<^bsub>R\\<^esub>;\n        x = a \\<plusminus>\\<^bsub>A\\<^esub> h; h \\<in> carrier A; aGroup A;\n        aGroup R; f \\<in> aHom A R\\<rbrakk>\n       \\<Longrightarrow> f a =\n                         f a \\<plusminus>\\<^bsub>R\\<^esub>\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (frule aHom_mem[of \"A\" \"R\" \"f\" \"a\"], assumption+,\n        simp add:aGroup.ag_r_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) set_r_ar_cos:\"ideal R I \\<Longrightarrow>\n                 set_rcs (b_ag R) I = set_ar_cos R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> set_rcs (b_ag R) I = set_ar_cos R I", "apply (simp add:set_ar_cos_def set_rcs_def ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    {C. \\<exists>a\\<in>carrier (b_ag R).\n           C = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a} =\n    {X. \\<exists>a\\<in>carrier R. X = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a}", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> {C. \\<exists>a\\<in>carrier (b_ag R).\n                             C = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a} =\n                      {X. \\<exists>a\\<in>carrier R.\n                             X = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a}", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma set_r_ar_cos_ker:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                     set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) = set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) =\n                      set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) =\n                      set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)", "apply (simp add:Ring.carrier_qring[THEN sym],\n        simp add:Ring.carrier_qring1[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ind_hom_rhom:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                                    (f\\<degree>\\<^bsub>A,R\\<^esub>) \\<in> rHom (qring A (ker\\<^bsub>A,R\\<^esub> f)) R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R", "apply (simp add:rHom_def [of \"qring A (ker\\<^bsub>A,R\\<^esub> f)\" \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             R \\<and>\n                      (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> carrier\n                             (A /\\<^sub>r\n                              (ker\\<^bsub>A,R\\<^esub> f)) \\<rightarrow>\n                            carrier R \\<and>\n                      f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> carrier\n                             (A /\\<^sub>r\n                              (ker\\<^bsub>A,R\\<^esub> f)) \\<rightarrow>\n                            carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> set_rcs (b_ag A)\n                             (ker\\<^bsub>A,R\\<^esub> f) \\<rightarrow>\n                            carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:rind_hom_def extensional_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<lambda>X\\<in>set_ar_cos A\n (ker\\<^bsub>A,R\\<^esub> f).\n                          f (SOME x. x \\<in> X))\n                      \\<in> set_rcs (b_ag A)\n                             (ker\\<^bsub>A,R\\<^esub> f) \\<rightarrow>\n                            carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule Pi_I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>X\\<in>set_ar_cos A\n    (ker\\<^bsub>A,R\\<^esub> f).\n                             f (SOME x. x \\<in> X))\n                          x\n                         \\<in> carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule Ring.ring_is_ag [of \"A\"], frule Ring.ring_is_ag [of \"R\"],\n        frule aGroup.b_ag_group [of \"R\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<lambda>X\\<in>set_ar_cos A\n    (ker\\<^bsub>A,R\\<^esub> f).\n                             f (SOME x. x \\<in> X))\n                          x\n                         \\<in> carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (x \\<in> set_ar_cos A\n                                   (ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                          f (SOME xa. xa \\<in> x)\n                          \\<in> carrier (b_ag R)) \\<and>\n                         (x \\<notin> set_ar_cos A\n(ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                          undefined \\<in> carrier (b_ag R))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:set_ar_cos_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> ((\\<exists>a\\<in>carrier A.\n                              x =\n                              a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                          f (SOME xa. xa \\<in> x)\n                          \\<in> carrier (b_ag R)) \\<and>\n                         ((\\<forall>a\\<in>carrier A.\n                              x \\<noteq>\n                              a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                          undefined \\<in> carrier (b_ag R))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>a\\<in>carrier A.\n                             x =\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         f (SOME xa. xa \\<in> x) \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule impI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R);\n        \\<exists>a\\<in>carrier A.\n           x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME xa. xa \\<in> x) \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        aGroup A; aGroup R; Group (b_ag R); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME x.\n                               x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n                         \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule ker_ideal [of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        aGroup A; aGroup R; Group (b_ag R); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> f (SOME x.\n                               x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n                         \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule_tac a = a in Ring.a_in_ar_coset [of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"],\n        assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        aGroup A; aGroup R; Group (b_ag R); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f (SOME x.\n                               x \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n                         \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule someI2_ex, blast)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a xa.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        aGroup A; aGroup R; Group (b_ag R); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        xa \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> f xa \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule_tac I = \"ker\\<^bsub>A,R\\<^esub> f\" and a = a and x = xa in\n                   Ring.ar_coset_subsetD[of \"A\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a xa.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        aGroup A; aGroup R; Group (b_ag R); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        a \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        xa \\<in> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        xa \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f xa \\<in> carrier (b_ag R)\n 2. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier, simp add:rHom_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f); aGroup A;\n        aGroup R; Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>a\\<in>carrier A.\n                             x \\<noteq>\n                             a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<longrightarrow>\n                         undefined \\<in> carrier (b_ag R)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:set_r_ar_cos_ker, simp add:set_ar_cos_def, rule impI, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r\n                                (ker\\<^bsub>A,R\\<^esub> f))) \\<and>\n                      (\\<forall>a\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>b\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               b) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              a \\<plusminus>\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) b)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             a \\<plusminus>\\<^bsub>R\\<^esub>\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             a \\<plusminus>\\<^bsub>R\\<^esub>\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:set_r_ar_cos_ker)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             a \\<plusminus>\\<^bsub>R\\<^esub>\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:rind_hom_def extensional_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         \\<forall>b\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                              b) =\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             a \\<plusminus>\\<^bsub>R\\<^esub>\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f));\n        b \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<plusminus>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                           b) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          a \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f);\n        b \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (c_top (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) a b) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          a \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:set_r_ar_cos_ker)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        a \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        b \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (c_top (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) a b) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          a \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:set_ar_cos_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        \\<exists>aa\\<in>carrier A.\n           a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        \\<exists>a\\<in>carrier A.\n           b = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (c_top (b_ag A) (ker\\<^bsub>A,R\\<^esub> f) a b) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          a \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aa \\<in> carrier A;\n        a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ab \\<in> carrier A;\n        b = ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (c_top (b_ag A) (ker\\<^bsub>A,R\\<^esub> f)\n                            (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n                            (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aa \\<in> carrier A;\n        a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ab \\<in> carrier A;\n        b = ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (c_top (b_ag A) (ker\\<^bsub>A,R\\<^esub> f)\n                            (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n                            (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:Ring.ar_c_top)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aa \\<in> carrier A;\n        a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ab \\<in> carrier A;\n        b = ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          ((aa \\<plusminus>\\<^bsub>A\\<^esub>\n                            ab) \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule Ring.ring_is_ag[of \"A\"],\n        frule Ring.ring_is_ag[of \"R\"],\n        frule_tac x = aa and y = ab in aGroup.ag_pOp_closed[of \"A\"],\n        assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aa \\<in> carrier A;\n        a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ab \\<in> carrier A;\n        b = ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); aGroup A; aGroup R;\n        aa \\<plusminus>\\<^bsub>A\\<^esub> ab \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          ((aa \\<plusminus>\\<^bsub>A\\<^esub>\n                            ab) \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<plusminus>\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:rind_hom_well_def[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b aa ab.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aa \\<in> carrier A;\n        a = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ab \\<in> carrier A;\n        b = ab \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); aGroup A; aGroup R;\n        aa \\<plusminus>\\<^bsub>A\\<^esub> ab \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (aa \\<plusminus>\\<^bsub>A\\<^esub> ab) =\n                         f aa \\<plusminus>\\<^bsub>R\\<^esub> f ab\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:rHom_def, frule conjunct1, simp add:aHom_add)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier\n (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                          \\<forall>y\\<in>carrier\n    (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                               y) =\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                              x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                             (f\\<degree>\\<^bsub>A,R\\<^esub>) y) \\<and>\n                      (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         \\<forall>y\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                              y) =\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                             x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) y\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        x \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f));\n        y \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (x \\<cdot>\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>\n                           y) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) y\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+,\n        simp add:Ring.carrier_qring1, simp add:set_ar_cos_def,\n        (erule bexE)+, simp add:qring_def Ring.rcostOp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y a aa.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        aa \\<in> carrier A;\n        y = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                           aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule Ring.ring_is_ag[of \"A\"],\n         frule_tac x = a and y = aa in Ring.ring_tOp_closed[of \"A\"],\n         assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y a aa.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f;\n        aa \\<in> carrier A;\n        y = aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f; aGroup A;\n        a \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> aa \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                           aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (aa \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:rind_hom_well_def[THEN sym], simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       1\\<^sub>r\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (1\\<^sub>r\\<^bsub>A\\<^esub> \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                      1\\<^sub>r\\<^bsub>R\\<^esub>", "apply (frule Ring.ring_one[of \"A\"],\n        simp add:rind_hom_well_def[THEN sym],\n        simp add:rHom_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ind_hom_injec:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                              injec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             R \\<and>\n                      ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}", "apply (frule ind_hom_rhom [of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             R \\<and>\n                      ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}", "apply (frule rHom_aHom[of \"f\\<degree>\\<^bsub>A,R\\<^esub>\" \"A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\" \"R\"], simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}", "apply (simp add:ker_def[of _ _ \"f\\<degree>\\<^bsub>A,R\\<^esub>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier\n                                (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>R\\<^esub>} =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}", "apply ((subst qring_def)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_rcs (b_ag A) (ker\\<^bsub>A,R\\<^esub> f).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>R\\<^esub>} =\n                      {ker\\<^bsub>A,R\\<^esub> f}", "apply (simp add:set_r_ar_cos_ker)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>R\\<^esub>} =\n                      {ker\\<^bsub>A,R\\<^esub> f}", "apply (frule Ring.ring_is_ag[of \"A\"],\n       frule Ring.ring_is_ag[of \"R\"],\n       frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>R\\<^esub>} =\n                      {ker\\<^bsub>A,R\\<^esub> f}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>R\\<^esub>}\n                      \\<subseteq> {ker\\<^bsub>A,R\\<^esub> f}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<in> {a \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f).\n                 (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                 \\<zero>\\<^bsub>R\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {ker\\<^bsub>A,R\\<^esub> f}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        (f\\<degree>\\<^bsub>A,R\\<^esub>) x =\n        \\<zero>\\<^bsub>R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x = ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (simp add:set_ar_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        \\<zero>\\<^bsub>R\\<^esub>;\n        a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f =\n                         ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (simp add:rind_hom_well_def[THEN sym, of \"A\" \"R\" \"f\"],\n        thin_tac \"x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        f a = \\<zero>\\<^bsub>R\\<^esub>; a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f =\n                         ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (rule_tac a = a in Ring.Qring_fix1[of \"A\" _ \"ker\\<^bsub>A,R\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        f a = \\<zero>\\<^bsub>R\\<^esub>; a \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<in> ker\\<^bsub>A,R\\<^esub> f\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n     aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n    \\<Longrightarrow> {ker\\<^bsub>A,R\\<^esub> f}\n                      \\<subseteq> {a \\<in> set_ar_cos A\n      (ker\\<^bsub>A,R\\<^esub> f).\n                                   (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                                   \\<zero>\\<^bsub>R\\<^esub>}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f\n                         \\<in> set_ar_cos A\n                                (ker\\<^bsub>A,R\\<^esub> f) \\<and>\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ker\\<^bsub>A,R\\<^esub> f) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (simp add:Ring.I_in_set_ar_cos[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ker\\<^bsub>A,R\\<^esub> f) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (frule Ring.ideal_zero[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"], assumption+,\n        frule Ring.ring_zero[of \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ker\\<^bsub>A,R\\<^esub> f) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (frule Ring.ar_coset_same4[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\" \"\\<zero>\\<^bsub>A\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A;\n        \\<zero>\\<^bsub>A\\<^esub> \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f =\n        ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ker\\<^bsub>A,R\\<^esub> f) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (frule rind_hom_well_def[THEN sym, of \"A\" \"R\" \"f\" \"\\<zero>\\<^bsub>A\\<^esub>\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A;\n        \\<zero>\\<^bsub>A\\<^esub> \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f =\n        ker\\<^bsub>A,R\\<^esub> f;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (\\<zero>\\<^bsub>A\\<^esub> \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        f \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (ker\\<^bsub>A,R\\<^esub> f) =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        aGroup A; aGroup R; ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x = ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> ker\\<^bsub>A,R\\<^esub> f;\n        \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A;\n        \\<zero>\\<^bsub>A\\<^esub> \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f =\n        ker\\<^bsub>A,R\\<^esub> f;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>) (ker\\<^bsub>A,R\\<^esub> f) =\n        f \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> f \\<zero>\\<^bsub>A\\<^esub> =\n                         \\<zero>\\<^bsub>R\\<^esub>", "apply (rule rHom_0_0, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma rhom_to_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                                   f \\<in> rHom A (rimg A R f)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> rHom A (rimg A R f)", "apply (frule Ring.ring_is_ag[of \"A\"], frule Ring.ring_is_ag[of \"R\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> rHom A (rimg A R f)", "apply (subst rHom_def, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom A (rimg A R f) \\<and>\n                      (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> aHom A (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (subst aHom_def, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier A \\<rightarrow>\n                              carrier (rimg A R f) \\<and>\n                      f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             f a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> f b)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> carrier A \\<rightarrow> carrier (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             f a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> f b)\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (simp add:rimg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A) \\<and>\n                      (\\<forall>a\\<in>carrier A.\n                          \\<forall>b\\<in>carrier A.\n                             f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                             f a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> f b)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f \\<in> extensional (carrier A)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                            f a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> f b\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (simp add:rHom_def aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier A.\n                         \\<forall>b\\<in>carrier A.\n                            f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                            f a \\<plusminus>\\<^bsub>rimg A R f\\<^esub> f b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply ((rule ballI)+, simp add:rimg_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f (a \\<plusminus>\\<^bsub>A\\<^esub> b) =\n                         f a \\<plusminus>\\<^bsub>R\\<^esub> f b\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (rule aHom_add, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> f \\<in> aHom A R\n 2. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier A\n 3. \\<And>a b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R;\n        a \\<in> carrier A; b \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier A\n 4. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (simp add:rHom_aHom, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                             f y) \\<and>\n                      f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         \\<forall>y\\<in>carrier A.\n                            f (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                            f x \\<cdot>\\<^sub>r\\<^bsub>rimg A R f\\<^esub>\n                            f y\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply ((rule ballI)+, simp add:rimg_def, simp add:rHom_tOp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; aGroup A; aGroup R\\<rbrakk>\n    \\<Longrightarrow> f 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>rimg A R f\\<^esub>", "apply (simp add:rimg_def, simp add:rHom_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ker_to_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R \\<rbrakk> \\<Longrightarrow>\n                         ker\\<^bsub>A,R\\<^esub> f = ker\\<^bsub>A,(rimg A R f)\\<^esub> f\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f =\n                      ker\\<^bsub>A,rimg A R f\\<^esub> f", "apply (frule rhom_to_rimg [of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> rHom A (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A,R\\<^esub> f =\n                      ker\\<^bsub>A,rimg A R f\\<^esub> f", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> rHom A (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier A. f a = \\<zero>\\<^bsub>R\\<^esub>} =\n                      {a \\<in> carrier A.\n                       f a = \\<zero>\\<^bsub>rimg A R f\\<^esub>}", "apply (simp add:rimg_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma indhom_eq:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow> f\\<degree>\\<^bsub>A,(rimg A R f)\\<^esub> = f\\<degree>\\<^bsub>A,R\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n                      f\\<degree>\\<^bsub>A,R\\<^esub>", "apply (frule rimg_ring[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n                      f\\<degree>\\<^bsub>A,R\\<^esub>", "apply (frule rhom_to_rimg[of \"A\" \"R\" \"f\"], assumption+,\n       frule ind_hom_rhom[of \"A\" \"rimg A R f\"], assumption+,\n       frule ind_hom_rhom[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n                      f\\<degree>\\<^bsub>A,R\\<^esub>", "(** extensional **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n                      f\\<degree>\\<^bsub>A,R\\<^esub>", "apply (rule funcset_eq[of \"f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> \" \"carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\" \"f\\<degree>\\<^bsub>A,R\\<^esub>\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (simp add:ker_to_rimg[THEN sym],\n        simp add:rHom_def[of _ \"rimg A R f\"] aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> extensional\n                             (carrier\n                               (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (simp add:rHom_def[of _ \"R\"] aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (simp add:ker_to_rimg[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier\n(A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                         (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        x \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+,\n        simp add:Ring.carrier_qring1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        x \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f);\n        ideal A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>) x =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>) x", "apply (simp add:set_ar_cos_def, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>)\n                          (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                          (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f)", "apply (simp add:rind_hom_well_def[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x a.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f); a \\<in> carrier A;\n        x = a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n       \\<Longrightarrow> (f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>)\n                          (a \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n                         f a", "apply (frule rind_hom_well_def[THEN sym, of \"A\" \"rimg A R f\" \"f\"],\n         assumption+, simp add:ker_to_rimg[THEN sym])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma indhom_bijec2_rimg:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk> \\<Longrightarrow>\n                    bijec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),(rimg A R f)\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule rimg_ring [of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule rhom_to_rimg[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule ind_hom_rhom[of \"A\" \"rimg A R f\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule ker_to_rimg[THEN sym, of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule indhom_eq[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,rimg A R f\\<^esub> f))\n            (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) \\<and>\n                      surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                         f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             (rimg A R f) \\<and>\n                      ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                       f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                       f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 3. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                       f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule ind_hom_injec [of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> = f\\<degree>\\<^bsub>A,R\\<^esub>;\n     injec\\<^bsub>A /\\<^sub>r\n                  (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                       f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:injec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> = f\\<degree>\\<^bsub>A,R\\<^esub>;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R \\<and>\n     ker\\<^bsub>A /\\<^sub>r\n                (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n     {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> ker\\<^bsub>A /\\<^sub>r\n                                 (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                       f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:ker_def [of _ _ \"f\\<degree>\\<^bsub>A,R\\<^esub>\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> = f\\<degree>\\<^bsub>A,R\\<^esub>;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R \\<and>\n     {a \\<in> carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n      (f\\<degree>\\<^bsub>A,R\\<^esub>) a = \\<zero>\\<^bsub>R\\<^esub>} =\n     {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\\<rbrakk>\n    \\<Longrightarrow> {a \\<in> carrier\n                                (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                       (f\\<degree>\\<^bsub>A,R\\<^esub>) a =\n                       \\<zero>\\<^bsub>rimg A R f\\<^esub>} =\n                      {\\<zero>\\<^bsub>A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)\\<^esub>}\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:rimg_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),rimg A R\n                          f\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             (rimg A R f) \\<and>\n                      surj_to (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n                       (carrier (rimg A R f))", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surj_to (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n                       (carrier (rimg A R f))", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> surj_to (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n                       (carrier (rimg A R f))", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> carrier\n                             (A /\\<^sub>r\n                              (ker\\<^bsub>A,R\\<^esub> f)) \\<rightarrow>\n                            carrier (rimg A R f)\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier (rimg A R f).\n                         \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:rHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n     f \\<in> rHom A (rimg A R f);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n     ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n     f\\<degree>\\<^bsub>A,R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier (rimg A R f).\n                         \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        b \\<in> carrier (rimg A R f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:rimg_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        \\<exists>x\\<in>carrier A. b = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        x \\<in> carrier A; b = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = f x", "apply (frule_tac a1 = x in rind_hom_well_def[THEN sym, of \"A\" \"R\" \"f\"],\n                   assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        x \\<in> carrier A; b = f x;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = f x", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+,\n        simp add:Ring.carrier_qring1,\n        frule_tac a = x in Ring.mem_set_ar_cos[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; Ring (rimg A R f);\n        f \\<in> rHom A (rimg A R f);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) (rimg A R f);\n        ker\\<^bsub>A,rimg A R f\\<^esub> f = ker\\<^bsub>A,R\\<^esub> f;\n        f\\<degree>\\<^bsub>A,rimg A R f\\<^esub> =\n        f\\<degree>\\<^bsub>A,R\\<^esub>;\n        x \\<in> carrier A; b = f x;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        f x;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>set_ar_cos A\n   (ker\\<^bsub>A,R\\<^esub> f).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = f x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma surjec_ind_bijec:\"\\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; surjec\\<^bsub>A,R\\<^esub> f\\<rbrakk> \\<Longrightarrow>\n     bijec\\<^bsub>(qring A (ker\\<^bsub>A,R\\<^esub> f)),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     surjec\\<^bsub>A,R\\<^esub> f\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (frule ind_hom_rhom[of \"A\" \"R\" \"f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R; surjec\\<^bsub>A,R\\<^esub> f;\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> aHom A R \\<and> surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:bijec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> aHom A R \\<and> surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> injec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>) \\<and>\n                      surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:ind_hom_injec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> aHom A R \\<and> surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A /\\<^sub>r\n                                    (ker\\<^bsub>A,R\\<^esub> f),R\\<^esub> (f\\<degree>\\<^bsub>A,R\\<^esub>)", "apply (simp add:surjec_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     f \\<in> aHom A R \\<and> surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> aHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f))\n                             R \\<and>\n                      surj_to (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n                       (carrier R)", "apply (simp add:rHom_aHom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> surj_to (f\\<degree>\\<^bsub>A,R\\<^esub>)\n                       (carrier (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)))\n                       (carrier R)", "apply (rule surj_to_test)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> f\\<degree>\\<^bsub>A,R\\<^esub>\n                      \\<in> carrier\n                             (A /\\<^sub>r\n                              (ker\\<^bsub>A,R\\<^esub> f)) \\<rightarrow>\n                            carrier R\n 2. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier R.\n                         \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:rHom_def aHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n     surj_to f (carrier A) (carrier R);\n     f\\<degree>\\<^bsub>A,R\\<^esub>\n     \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>b\\<in>carrier R.\n                         \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        surj_to f (carrier A) (carrier R);\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:surj_to_def, frule sym,\n                        thin_tac \"f ` carrier A = carrier R\", simp,\n                        thin_tac \"carrier R = f ` carrier A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        b \\<in> f ` carrier A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (simp add:image_def, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        x \\<in> carrier A; b = f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (frule_tac a1 = x in rind_hom_well_def[THEN sym, of \"A\" \"R\" \"f\"],\n                   assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        x \\<in> carrier A; b = f x;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        f x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier\n   (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = b", "apply (frule ker_ideal[of \"A\" \"R\" \"f\"], assumption+,\n        simp add:Ring.carrier_qring1,\n        frule_tac a = x in Ring.mem_set_ar_cos[of \"A\" \"ker\\<^bsub>A,R\\<^esub> f\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b x.\n       \\<lbrakk>Ring A; Ring R; f \\<in> rHom A R;\n        f\\<degree>\\<^bsub>A,R\\<^esub>\n        \\<in> rHom (A /\\<^sub>r (ker\\<^bsub>A,R\\<^esub> f)) R;\n        x \\<in> carrier A; b = f x;\n        (f\\<degree>\\<^bsub>A,R\\<^esub>)\n         (x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f) =\n        f x;\n        ideal A (ker\\<^bsub>A,R\\<^esub> f);\n        x \\<uplus>\\<^bsub>A\\<^esub> ker\\<^bsub>A,R\\<^esub> f\n        \\<in> set_ar_cos A (ker\\<^bsub>A,R\\<^esub> f)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>set_ar_cos A\n   (ker\\<^bsub>A,R\\<^esub> f).\n                            (f\\<degree>\\<^bsub>A,R\\<^esub>) a = f x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ridmap_ind_bijec:\"Ring A \\<Longrightarrow>\n     bijec\\<^bsub>(qring A (ker\\<^bsub>A,A\\<^esub> (ridmap A))),A\\<^esub> ((ridmap A)\\<degree>\\<^bsub>A,A\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    bijec\\<^bsub>A /\\<^sub>r\n                 (ker\\<^bsub>A,A\\<^esub> ridmap\n    A),A\\<^esub> (ridmap A\\<degree>\\<^bsub>A,A\\<^esub>)", "apply (frule ridmap_surjec[of \"A\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   (ker\\<^bsub>A,A\\<^esub> ridmap\n                      A),A\\<^esub> (ridmap A\\<degree>\\<^bsub>A,A\\<^esub>)", "apply (rule surjec_ind_bijec [of \"A\" \"A\" \"ridmap A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> ridmap A \\<in> rHom A A\n 2. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply (simp add:rHom_def, simp add:surjec_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A;\n     ridmap A \\<in> aHom A A \\<and>\n     surj_to (ridmap A) (carrier A) (carrier A)\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier A.\n                          \\<forall>y\\<in>carrier A.\n                             ridmap A\n                              (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                             ridmap A x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                             ridmap A y) \\<and>\n                      ridmap A 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring A;\n     ridmap A \\<in> aHom A A \\<and>\n     surj_to (ridmap A) (carrier A) (carrier A)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier A.\n                         \\<forall>y\\<in>carrier A.\n                            ridmap A\n                             (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                            ridmap A x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                            ridmap A y\n 2. \\<lbrakk>Ring A;\n     ridmap A \\<in> aHom A A \\<and>\n     surj_to (ridmap A) (carrier A) (carrier A)\\<rbrakk>\n    \\<Longrightarrow> ridmap A 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 3. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply (rule ballI)+"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring A;\n        ridmap A \\<in> aHom A A \\<and>\n        surj_to (ridmap A) (carrier A) (carrier A);\n        x \\<in> carrier A; y \\<in> carrier A\\<rbrakk>\n       \\<Longrightarrow> ridmap A (x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub> y) =\n                         ridmap A x \\<cdot>\\<^sub>r\\<^bsub>A\\<^esub>\n                         ridmap A y\n 2. \\<lbrakk>Ring A;\n     ridmap A \\<in> aHom A A \\<and>\n     surj_to (ridmap A) (carrier A) (carrier A)\\<rbrakk>\n    \\<Longrightarrow> ridmap A 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 3. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply (frule_tac x = x and y = y in Ring.ring_tOp_closed[of \"A\"],\n          assumption+, simp add:ridmap_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring A;\n     ridmap A \\<in> aHom A A \\<and>\n     surj_to (ridmap A) (carrier A) (carrier A)\\<rbrakk>\n    \\<Longrightarrow> ridmap A 1\\<^sub>r\\<^bsub>A\\<^esub> =\n                      1\\<^sub>r\\<^bsub>A\\<^esub>\n 2. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply (simp add:ridmap_def Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A; surjec\\<^bsub>A,A\\<^esub> ridmap A\\<rbrakk>\n    \\<Longrightarrow> surjec\\<^bsub>A,A\\<^esub> ridmap A", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ker_of_idmap:\"Ring A \\<Longrightarrow> ker\\<^bsub>A,A\\<^esub> (ridmap A) = {\\<zero>\\<^bsub>A\\<^esub>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    ker\\<^bsub>A,A\\<^esub> ridmap A = {\\<zero>\\<^bsub>A\\<^esub>}", "apply (simp add:ker_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    {a \\<in> carrier A. ridmap A a = \\<zero>\\<^bsub>A\\<^esub>} =\n    {\\<zero>\\<^bsub>A\\<^esub>}", "apply (simp add:ridmap_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    {a. (a \\<in> carrier A \\<longrightarrow>\n         a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n        a \\<in> carrier A} =\n    {\\<zero>\\<^bsub>A\\<^esub>}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Ring A \\<Longrightarrow>\n    {a. (a \\<in> carrier A \\<longrightarrow>\n         a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n        a \\<in> carrier A}\n    \\<subseteq> {\\<zero>\\<^bsub>A\\<^esub>}\n 2. Ring A \\<Longrightarrow>\n    {\\<zero>\\<^bsub>A\\<^esub>}\n    \\<subseteq> {a. (a \\<in> carrier A \\<longrightarrow>\n                     a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                    a \\<in> carrier A}", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring A;\n        x \\<in> {a. (a \\<in> carrier A \\<longrightarrow>\n                     a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                    a \\<in> carrier A}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {\\<zero>\\<^bsub>A\\<^esub>}\n 2. Ring A \\<Longrightarrow>\n    {\\<zero>\\<^bsub>A\\<^esub>}\n    \\<subseteq> {a. (a \\<in> carrier A \\<longrightarrow>\n                     a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                    a \\<in> carrier A}", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    {\\<zero>\\<^bsub>A\\<^esub>}\n    \\<subseteq> {a. (a \\<in> carrier A \\<longrightarrow>\n                     a = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                    a \\<in> carrier A}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; x \\<in> {\\<zero>\\<^bsub>A\\<^esub>}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {a. (a \\<in> carrier A \\<longrightarrow>\na = \\<zero>\\<^bsub>A\\<^esub>) \\<and>\n                                     a \\<in> carrier A}", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring A; x = \\<zero>\\<^bsub>A\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\\<^bsub>A\\<^esub> \\<in> carrier A", "apply (simp add:Ring.ring_zero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma ring_natural_isom:\"Ring A \\<Longrightarrow>\n         bijec\\<^bsub>(qring A {\\<zero>\\<^bsub>A\\<^esub>}),A\\<^esub> ((ridmap A)\\<degree>\\<^bsub>A,A\\<^esub>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring A \\<Longrightarrow>\n    bijec\\<^bsub>A /\\<^sub>r\n                 {\\<zero>\\<^bsub>A\\<^esub>},A\\<^esub> (ridmap\n                  A\\<degree>\\<^bsub>A,A\\<^esub>)", "apply (frule ridmap_ind_bijec)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring A;\n     bijec\\<^bsub>A /\\<^sub>r\n                  (ker\\<^bsub>A,A\\<^esub> ridmap\n     A),A\\<^esub> (ridmap A\\<degree>\\<^bsub>A,A\\<^esub>)\\<rbrakk>\n    \\<Longrightarrow> bijec\\<^bsub>A /\\<^sub>r\n                                   {\\<zero>\\<^bsub>A\\<^esub>},A\\<^esub> (ridmap\n                                    A\\<degree>\\<^bsub>A,A\\<^esub>)", "apply (simp add: ker_of_idmap)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(** A /\\<^sub>r {0\\<^sub>A}\\<^sub> \\<cong> A **)"], ["", "definition\n  pj :: \"[('a, 'm) Ring_scheme, 'a set] \\<Rightarrow> ('a => 'a set)\" where\n  \"pj R I = (\\<lambda>x. Pj (b_ag R) I x)\""], ["", "(* pj is projection homomorphism *)"], ["", "lemma pj_Hom:\"\\<lbrakk>Ring R; ideal R I\\<rbrakk> \\<Longrightarrow> (pj R I) \\<in> rHom R (qring R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> rHom R (R /\\<^sub>r I)", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I) \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I\n                      \\<in> carrier R \\<rightarrow>\n                            carrier (R /\\<^sub>r I) \\<and>\n                      pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I\n                      \\<in> carrier R \\<rightarrow> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule Pi_I)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_def Pj_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> x\n                         \\<in> set_rcs (b_ag R) I\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:set_rcs_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (b_ag R).\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> x =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R) \\<and>\n                      (\\<forall>a\\<in>carrier R.\n                          \\<forall>b\\<in>carrier R.\n                             pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                             pj R I\n                              a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<in> extensional (carrier R)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>b\\<in>carrier R.\n                            pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                            pj R I\n                             a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            pj R I b\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_def Pj_def extensional_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carrier (b_ag R) \\<longrightarrow>\n                         x \\<notin> carrier R \\<longrightarrow>\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> x = undefined\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>b\\<in>carrier R.\n                            pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                            pj R I\n                             a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            pj R I b\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         x \\<in> carrier (b_ag R) \\<longrightarrow>\n                         x \\<notin> carrier R \\<longrightarrow>\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> x = undefined\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>b\\<in>carrier R.\n                            pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                            pj R I\n                             a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            pj R I b\n 3. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R.\n                         \\<forall>b\\<in>carrier R.\n                            pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                            pj R I\n                             a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            pj R I b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         pj R I a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         pj R I a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule_tac x = a and y = b in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R; b \\<in> carrier R;\n        aGroup R; a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         pj R I a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> pj R I (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         pj R I a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_def Pj_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         a \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         I \\<bullet>\\<^bsub>b_ag R\\<^esub> b\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule aGroup.b_ag_group)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<plusminus>\\<^bsub>R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (a \\<plusminus>\\<^bsub>R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.agop_gop [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (a \\<cdot>\\<^bsub>b_ag R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (subst Group.c_top_welldef[of \"b_ag R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> b_ag R \\<triangleright> I\n 2. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 3. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 4. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 5. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule Ring.ideal_asubg[of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R); R +> I\\<rbrakk>\n       \\<Longrightarrow> b_ag R \\<triangleright> I\n 2. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 3. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 4. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 5. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.asubg_nsubg)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier (b_ag R)\n 2. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> b \\<in> carrier (b_ag R)\n 3. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 4. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a b.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier (b_ag R);\n        b \\<in> carrier (b_ag R); aGroup R;\n        a \\<cdot>\\<^bsub>b_ag R\\<^esub> b \\<in> carrier (b_ag R);\n        Group (b_ag R)\\<rbrakk>\n       \\<Longrightarrow> c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b) =\n                         c_top (b_ag R) I\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> a)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> b)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                             pj R I\n                              x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                             pj R I y) \\<and>\n                      pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                            pj R I\n                             x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            pj R I y\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         pj R I\n                          x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I y\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add: qring_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R;\n        y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (pj R I x) (pj R I y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule_tac x = x and y = y in Ring.ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (pj R I x) (pj R I y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (pj R I x) (pj R I y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R);\n        y \\<in> carrier (b_ag R);\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier (b_ag R);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (pj R I x) (pj R I y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_def Pj_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R);\n        y \\<in> carrier (b_ag R);\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier (b_ag R);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (I \\<bullet>\\<^bsub>b_ag R\\<^esub> x)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (I \\<bullet>\\<^bsub>b_ag R\\<^esub> x)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule_tac a1 = x and b1 = y in Ring.rcostOp [THEN sym, of \"R\" \"I\"],\n                                                             assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> carrier R; aGroup R;\n        x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<uplus>\\<^bsub>R\\<^esub> I =\n        rcostOp R I (x \\<uplus>\\<^bsub>R\\<^esub> I)\n         (y \\<uplus>\\<^bsub>R\\<^esub> I)\\<rbrakk>\n       \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                         (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n                         rcostOp R I (I \\<bullet>\\<^bsub>b_ag R\\<^esub> x)\n                          (I \\<bullet>\\<^bsub>b_ag R\\<^esub> y)\n 2. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; 1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier R;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier (b_ag R); aGroup R\\<rbrakk>\n    \\<Longrightarrow> pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:pj_def Pj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I;\n     1\\<^sub>r\\<^bsub>R\\<^esub> \\<in> carrier (b_ag R); aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub>\n                      1\\<^sub>r\\<^bsub>R\\<^esub> =\n                      1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_mem:\"\\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow> pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; aGroup R\\<rbrakk>\n    \\<Longrightarrow> pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:aGroup.ag_carrier_carrier [THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R); aGroup R\\<rbrakk>\n    \\<Longrightarrow> pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:pj_def Pj_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier (b_ag R); aGroup R\\<rbrakk>\n    \\<Longrightarrow> I \\<bullet>\\<^bsub>b_ag R\\<^esub> x =\n                      x \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:ar_coset_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_zero:\"\\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n                         (pj R I x = \\<zero>\\<^bsub>(R /\\<^sub>r I)\\<^esub>) = (x \\<in> I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (pj R I x = \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>) =\n                      (x \\<in> I)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R;\n     pj R I x = \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> I\n 2. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> pj R I x = \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_mem Ring.qring_zero,\n       simp add:Ring.qring_zero_1[of \"R\" \"x\" \"I\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; x \\<in> carrier R; x \\<in> I\\<rbrakk>\n    \\<Longrightarrow> pj R I x = \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add:pj_mem Ring.qring_zero,\n       rule Ring.Qring_fix1, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_surj_to:\"\\<lbrakk>Ring R; ideal R J; X \\<in> carrier (R /\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                   \\<exists>r\\<in> carrier R. pj R J r = X\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R J; X \\<in> carrier (R /\\<^sub>r J)\\<rbrakk>\n    \\<Longrightarrow> \\<exists>r\\<in>carrier R. pj R J r = X", "apply (simp add:qring_def set_rcs_def,\n       fold ar_coset_def, simp add:b_ag_def, erule bexE,\n       frule_tac x = a in pj_mem[of R J], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>Ring R; ideal R J; a \\<in> carrier R;\n        X = a \\<uplus>\\<^bsub>R\\<^esub> J;\n        pj R J a = a \\<uplus>\\<^bsub>R\\<^esub> J\\<rbrakk>\n       \\<Longrightarrow> \\<exists>r\\<in>carrier R.\n                            pj R J r = a \\<uplus>\\<^bsub>R\\<^esub> J", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma invim_of_ideal:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J \\<rbrakk> \\<Longrightarrow>\n  ideal R (rInvim R (qring R I) (pj R I) J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> ideal R (rInvim R (R /\\<^sub>r I) (pj R I) J)", "apply (rule Ring.ideal_condition, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I) J\n                      \\<subseteq> carrier R\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I) J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 4. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I) J \\<noteq> {}\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (subgoal_tac \"\\<zero>\\<^bsub>R\\<^esub> \\<in> rInvim R (qring R I) (pj R I) J\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n     \\<zero>\\<^bsub>R\\<^esub>\n     \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I) J \\<noteq> {}\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub>\n                      \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 4. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:nonempty)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub>\n                      \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<zero>\\<^bsub>R\\<^esub> \\<in> carrier R \\<and>\n                      pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add: Ring.ring_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; aGroup R\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule pj_Hom [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; aGroup R;\n     pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule Ring.qring_ring [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; aGroup R;\n     pj R I \\<in> rHom R (R /\\<^sub>r I); Ring (R /\\<^sub>r I)\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule rHom_0_0 [of \"R\" \"R /\\<^sub>r I\" \"pj R I\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; aGroup R;\n     pj R I \\<in> rHom R (R /\\<^sub>r I); Ring (R /\\<^sub>r I);\n     pj R I \\<zero>\\<^bsub>R\\<^esub> =\n     \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> pj R I \\<zero>\\<^bsub>R\\<^esub> \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:Ring.ideal_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                         \\<forall>y\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            x \\<plusminus>\\<^bsub>R\\<^esub>\n                            -\\<^sub>a\\<^bsub>R\\<^esub> y\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J;\n        y \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R \\<and> pj R I x \\<in> J;\n        y \\<in> carrier R \\<and> pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R \\<and>\n                         pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R \\<and>\n                         pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R\\<^esub>\n                         -\\<^sub>a\\<^bsub>R\\<^esub> y\n                         \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 3. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule pj_Hom [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; pj R I \\<in> rHom R (R /\\<^sub>r I);\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule_tac x = y in aGroup.ag_mOp_closed [of \"R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; pj R I \\<in> rHom R (R /\\<^sub>r I); aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J;\n        pj R I \\<in> aHom R (R /\\<^sub>r I) \\<and>\n        (\\<forall>x\\<in>carrier R.\n            \\<forall>y\\<in>carrier R.\n               pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n               pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n               pj R I y) \\<and>\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          (x \\<plusminus>\\<^bsub>R\\<^esub>\n                           -\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (subst aHom_add [of \"R\" \"R /\\<^sub>r I\" \"pj R I\"], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> aGroup (R /\\<^sub>r I)\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I)\n 3. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 4. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\n 5. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 6. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:Ring.qring_ring Ring.ring_is_ag)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I)\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R\n 4. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 5. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule Ring.qring_ring [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> y)\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule Ring.ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> y) \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (subst aHom_inv_inv[of \"R\" \"R /\\<^sub>r I\" \"pj R I\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> aGroup (R /\\<^sub>r I)\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I)\n 3. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier R\n 4. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I y\n                         \\<in> J\n 5. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:Ring.ring_is_ag)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I \\<in> aHom R (R /\\<^sub>r I)\n 2. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier R\n 3. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I y\n                         \\<in> J\n 4. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> carrier R; pj R I x \\<in> J; y \\<in> carrier R;\n        pj R I y \\<in> J; aGroup R;\n        -\\<^sub>a\\<^bsub>R\\<^esub> y \\<in> carrier R;\n        pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I y\n                         \\<in> J\n 2. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (frule_tac x = \"pj R I y\" in Ring.ideal_inv1_closed [of \"R /\\<^sub>r I\" \"J\"],\n                                              assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>rInvim R (R /\\<^sub>r I) (pj R I) J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                            \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R;\n        x \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                         \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R;\n        x \\<in> carrier R \\<and> pj R I x \\<in> J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                         \\<in> carrier R \\<and>\n                         pj R I (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n                         \\<in> J", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x\n                         \\<in> carrier R \\<and>\n                         pj R I (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n                         \\<in> J", "apply (simp add:Ring.ring_tOp_closed)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J\\<rbrakk>\n       \\<Longrightarrow> pj R I (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n                         \\<in> J", "apply (frule pj_Hom [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I (r \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> x)\n                         \\<in> J", "apply (subst rHom_tOp [of \"R\" \"R /\\<^sub>r I\" _ _ \"pj R I\"], assumption+)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> Ring (R /\\<^sub>r I)\n 2. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> r \\<in> carrier R\n 3. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 4. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I \\<in> rHom R (R /\\<^sub>r I)\n 5. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I x\n                         \\<in> J", "apply (frule Ring.qring_ring[of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I\n                          r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         pj R I x\n                         \\<in> J", "apply (rule Ring.ideal_ring_multiple [of \"R /\\<^sub>r I\" \"J\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> Ring (R /\\<^sub>r I)\n 2. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> ideal (R /\\<^sub>r I) J\n 3. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> J\n 4. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I r \\<in> carrier (R /\\<^sub>r I)", "apply (simp add:Ring.qring_ring)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> ideal (R /\\<^sub>r I) J\n 2. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> J\n 3. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I r \\<in> carrier (R /\\<^sub>r I)", "apply assumption+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        r \\<in> carrier R; x \\<in> carrier R; pj R I x \\<in> J;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> pj R I r \\<in> carrier (R /\\<^sub>r I)", "apply (simp add:rHom_mem)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_invim_cont_I:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J\\<rbrakk> \\<Longrightarrow>\n                         I \\<subseteq> (rInvim R (qring R I) (pj R I) J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J;\n        x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R \\<and> pj R I x \\<in> J", "apply (frule Ring.ideal_subset [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R \\<and> pj R I x \\<in> J", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> J", "apply (frule  pj_mem [of \"R\" \"I\"  _], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R; pj R I x = x \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> J", "apply (simp add:Ring.ar_coset_same4)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R; pj R I x = I\\<rbrakk>\n       \\<Longrightarrow> I \\<in> J", "apply (frule  Ring.qring_ring[of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R; pj R I x = I; Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> I \\<in> J", "apply (frule Ring.ideal_zero [of \"qring R I\" \"J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R; pj R I x = I; Ring (R /\\<^sub>r I);\n        \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<in> J\\<rbrakk>\n       \\<Longrightarrow> I \\<in> J", "apply (frule Ring.qring_zero[of \"R\" \"I\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J; x \\<in> I;\n        x \\<in> carrier R; pj R I x = I; Ring (R /\\<^sub>r I);\n        \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> \\<in> J;\n        \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub> = I\\<rbrakk>\n       \\<Longrightarrow> I \\<in> J", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_invim_mono1:\"\\<lbrakk>Ring R; ideal R I; ideal (qring R I) J1;\n      ideal (qring R I) J2; J1 \\<subseteq> J2 \\<rbrakk> \\<Longrightarrow>\n      (rInvim R (qring R I) (pj R I) J1) \\<subseteq> (rInvim R (qring R I) (pj R I) J2)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J1;\n     ideal (R /\\<^sub>r I) J2; J1 \\<subseteq> J2\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I) J1\n                      \\<subseteq> rInvim R (R /\\<^sub>r I) (pj R I) J2", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J1;\n        ideal (R /\\<^sub>r I) J2; J1 \\<subseteq> J2;\n        x \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J1\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rInvim R (R /\\<^sub>r I) (pj R I) J2", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal (R /\\<^sub>r I) J1;\n        ideal (R /\\<^sub>r I) J2; J1 \\<subseteq> J2;\n        x \\<in> carrier R \\<and> pj R I x \\<in> J1\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> J2", "apply (simp add:subsetD)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma pj_img_ideal:\"\\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk> \\<Longrightarrow>\n                                  ideal (qring R I) ((pj R I)`J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> ideal (R /\\<^sub>r I) (pj R I ` J)", "apply (rule Ring.ideal_condition [of \"qring R I\" \"(pj R I) `J\"])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> Ring (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<subseteq> carrier (R /\\<^sub>r I)\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 5. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:Ring.qring_ring)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<subseteq> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (rule subsetI, simp add:image_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        \\<exists>xa\\<in>J. x = pj R I xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (erule bexE)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; xa \\<in> J;\n        x = pj R I xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac h = xa in Ring.ideal_subset [of \"R\" \"J\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; xa \\<in> J;\n        x = pj R I xa; xa \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule pj_Hom [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; xa \\<in> J;\n        x = pj R I xa; xa \\<in> carrier R;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 4. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:rHom_mem)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule Ring.ideal_zero [of \"R\" \"J\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> J\\<rbrakk>\n    \\<Longrightarrow> pj R I ` J \\<noteq> {}\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:image_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n     \\<zero>\\<^bsub>R\\<^esub> \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. \\<exists>xa\\<in>J. x = pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 3. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>pj R I ` J.\n                         \\<forall>y\\<in>pj R I ` J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                            \\<in> pj R I ` J\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        x \\<in> pj R I ` J; y \\<in> pj R I ` J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                         -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y\n                         \\<in> pj R I ` J\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:image_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        \\<exists>xa\\<in>J. x = pj R I xa;\n        \\<exists>x\\<in>J. y = pj R I x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa xb.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; xa \\<in> J;\n        x = pj R I xa; xb \\<in> J; y = pj R I xb\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule pj_Hom [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa xb.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; xa \\<in> J;\n        x = pj R I xa; xb \\<in> J; y = pj R I xb;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (rename_tac x y s t)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t;\n        pj R I \\<in> rHom R (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac h = s in Ring.ideal_subset [of \"R\" \"J\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t;\n        pj R I \\<in> rHom R (R /\\<^sub>r I); s \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac h = t in Ring.ideal_subset [of \"R\" \"J\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t;\n        pj R I \\<in> rHom R (R /\\<^sub>r I); s \\<in> carrier R;\n        t \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            x \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> y =\n                            pj R I xa\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:rHom_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t;\n        pj R I \\<in> aHom R (R /\\<^sub>r I) \\<and>\n        (\\<forall>x\\<in>carrier R.\n            \\<forall>y\\<in>carrier R.\n               pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n               pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n               pj R I y) \\<and>\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        s \\<in> carrier R; t \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule Ring.ring_is_ag)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule Ring.qring_ring [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule Ring.ring_is_ag [of \"R /\\<^sub>r I\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac x = t in aGroup.ag_mOp_closed [of \"R\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac a1 = s and b1 = \"-\\<^sub>a\\<^bsub>R\\<^esub> t\" in aHom_add [of \"R\" \"R /\\<^sub>r I\"\n  \"pj R I\", THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> carrier R;\n        pj R I s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n        pj R I (-\\<^sub>a\\<^bsub>R\\<^esub> t) =\n        pj R I\n         (s \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n                            -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I\n                              t =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (simp add:aHom_inv_inv)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> carrier R;\n        pj R I s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n        -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I t =\n        pj R I\n         (s \\<plusminus>\\<^bsub>R\\<^esub>\n          -\\<^sub>a\\<^bsub>R\\<^esub> t)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             (s \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> t) =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac x = t in Ring.ideal_inv1_closed [of \"R\" \"J\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> carrier R;\n        pj R I s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n        -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I t =\n        pj R I\n         (s \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> t);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> J\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             (s \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> t) =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (frule_tac x = s and y = \"-\\<^sub>a\\<^bsub>R\\<^esub> t\" in Ring.ideal_pOp_closed [of \"R\" \"J\"],\n                                             assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s t.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J; s \\<in> J;\n        x = pj R I s; t \\<in> J; y = pj R I t; s \\<in> carrier R;\n        t \\<in> carrier R; pj R I \\<in> aHom R (R /\\<^sub>r I);\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              pj R I (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y) =\n              pj R I x \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>\n              pj R I y;\n        pj R I 1\\<^sub>r\\<^bsub>R\\<^esub> =\n        1\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub>;\n        aGroup R; Ring (R /\\<^sub>r I); aGroup (R /\\<^sub>r I);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> carrier R;\n        pj R I s \\<plusminus>\\<^bsub>R /\\<^sub>r I\\<^esub>\n        -\\<^sub>a\\<^bsub>R /\\<^sub>r I\\<^esub> pj R I t =\n        pj R I\n         (s \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> t);\n        -\\<^sub>a\\<^bsub>R\\<^esub> t \\<in> J;\n        s \\<plusminus>\\<^bsub>R\\<^esub> -\\<^sub>a\\<^bsub>R\\<^esub> t\n        \\<in> J\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I\n                             (s \\<plusminus>\\<^bsub>R\\<^esub>\n                              -\\<^sub>a\\<^bsub>R\\<^esub> t) =\n                            pj R I x\n 2. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier (R /\\<^sub>r I).\n                         \\<forall>x\\<in>pj R I ` J.\n                            r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                            \\<in> pj R I ` J", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        r \\<in> carrier (R /\\<^sub>r I); x \\<in> pj R I ` J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r I\\<^esub> x\n                         \\<in> pj R I ` J", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        r \\<in> set_rcs (b_ag R) I; x \\<in> pj R I ` J\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I r x \\<in> pj R I ` J", "apply (simp add:Ring.set_r_ar_cos)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        r \\<in> set_ar_cos R I; x \\<in> pj R I ` J\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I r x \\<in> pj R I ` J", "apply (simp add:set_ar_cos_def, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        x \\<in> pj R I ` J; a \\<in> carrier R;\n        r = a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I r x \\<in> pj R I ` J", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        x \\<in> pj R I ` J; a \\<in> carrier R;\n        r = a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) x\n                         \\<in> pj R I ` J", "apply (simp add:image_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        \\<exists>xa\\<in>J. x = pj R I xa; a \\<in> carrier R;\n        r = a \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) x =\n                            pj R I xa", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = pj R I xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) x =\n                            pj R I xa", "apply (frule_tac x = xa in pj_mem [of \"R\" \"I\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = pj R I xa\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> carrier R\n 2. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = pj R I xa; pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) x =\n                            pj R I xa", "apply (simp add:Ring.ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = pj R I xa; pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>xa\\<in>J.\n                            rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I) x =\n                            pj R I xa", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            rcostOp R I (a \\<uplus>\\<^bsub>R\\<^esub> I)\n                             (xa \\<uplus>\\<^bsub>R\\<^esub> I) =\n                            pj R I x", "apply (subst Ring.rcostOp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>r x a xa xb.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> carrier R\n 2. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            xa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            pj R I x", "apply (simp add:Ring.ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            xa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            pj R I x", "apply (frule_tac x = xa and r = a in Ring.ideal_ring_multiple [of \"R\" \"J\"],\n                                                  assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> J\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            xa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            pj R I x", "apply (frule_tac h = \"a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa\" in Ring.ideal_subset [of \"R\" \"J\"],\n                                                                 assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> J;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            xa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            pj R I x", "apply (frule_tac x1 = \"a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa\" in pj_mem [THEN sym, of \"R\" \"I\"],\n                                                                 assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> J;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<uplus>\\<^bsub>R\\<^esub> I =\n        pj R I (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                            xa \\<uplus>\\<^bsub>R\\<^esub> I =\n                            pj R I x", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x a xa.\n       \\<lbrakk>Ring R; ideal R I; ideal R J; I \\<subseteq> J;\n        a \\<in> carrier R; r = a \\<uplus>\\<^bsub>R\\<^esub> I; xa \\<in> J;\n        x = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        pj R I xa = xa \\<uplus>\\<^bsub>R\\<^esub> I;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> J;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<in> carrier R;\n        a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa \\<uplus>\\<^bsub>R\\<^esub> I =\n        pj R I (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>J.\n                            pj R I (a \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> xa) =\n                            pj R I x", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma npQring:\"\\<lbrakk>Ring R; ideal R I; a \\<in> carrier R\\<rbrakk> \\<Longrightarrow>\n      npow (qring R I) (a \\<uplus>\\<^bsub>R\\<^esub> I) n = (npow R a n) \\<uplus>\\<^bsub>R\\<^esub> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                        I n\\<^esup> =\n                      a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                        I 0\\<^esup> =\n                      a^\\<^bsup>R 0\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\n 2. \\<And>n.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r I n\\<^esup> =\n        a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                           I Suc n\\<^esup> =\n                         a^\\<^bsup>R Suc\nn\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r I n\\<^esup> =\n        a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                           I Suc n\\<^esup> =\n                         a^\\<^bsup>R Suc\nn\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>\\<lparr>carrier =\n                    set_rcs (b_ag R) I,\n             pop = c_top (b_ag R) I, mop = c_iop (b_ag R) I, zero = I,\n             tp = rcostOp R I,\n             un = 1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I\\<rparr> n\\<^esup> =\n        a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> rcostOp R I\n                          (a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I)\n                          (a \\<uplus>\\<^bsub>R\\<^esub> I) =\n                         a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub>\n                         a \\<uplus>\\<^bsub>R\\<^esub> I", "apply (rule Ring.rcostOp, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>\\<lparr>carrier =\n                    set_rcs (b_ag R) I,\n             pop = c_top (b_ag R) I, mop = c_iop (b_ag R) I, zero = I,\n             tp = rcostOp R I,\n             un = 1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I\\<rparr> n\\<^esup> =\n        a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>Ring R; ideal R I; a \\<in> carrier R;\n        (a \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>\\<lparr>carrier =\n                    set_rcs (b_ag R) I,\n             pop = c_top (b_ag R) I, mop = c_iop (b_ag R) I, zero = I,\n             tp = rcostOp R I,\n             un = 1\\<^sub>r\\<^bsub>R\\<^esub> \\<uplus>\\<^bsub>R\\<^esub> I\\<rparr> n\\<^esup> =\n        a^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I\\<rbrakk>\n       \\<Longrightarrow> a \\<in> carrier R", "apply (rule Ring.npClose, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "section \"Primary ideals, Prime ideals\""], ["", "definition\n  maximal_set :: \"['a set set, 'a set] \\<Rightarrow> bool\" where\n  \"maximal_set S mx \\<longleftrightarrow> mx \\<in> S \\<and> (\\<forall>s\\<in>S. mx \\<subseteq> s \\<longrightarrow> s = mx)\""], ["", "definition\n  nilpotent :: \"[_, 'a] \\<Rightarrow> bool\" where\n  \"nilpotent R a \\<longleftrightarrow> (\\<exists>(n::nat). a^\\<^bsup>R n\\<^esup> = \\<zero>\\<^bsub>R\\<^esub>)\""], ["", "definition\n zero_divisor :: \"[_, 'a] \\<Rightarrow> bool\" where\n  \"zero_divisor R a \\<longleftrightarrow> (\\<exists>x\\<in> carrier R. x \\<noteq> \\<zero>\\<^bsub>R\\<^esub> \\<and> x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> a = \\<zero>\\<^bsub>R\\<^esub>)\""], ["", "definition\n  primary_ideal :: \"[_, 'a set] \\<Rightarrow> bool\" where\n  \"primary_ideal R q \\<longleftrightarrow> ideal R q \\<and> (1\\<^sub>r\\<^bsub>R\\<^esub>) \\<notin> q \\<and>\n    (\\<forall>x\\<in> carrier R. \\<forall>y\\<in> carrier R.\n      x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> q  \\<longrightarrow> (\\<exists>n. (npow R x n) \\<in> q \\<or> y \\<in> q))\""], ["", "definition\n  prime_ideal :: \"[_, 'a set] \\<Rightarrow> bool\" where\n  \"prime_ideal R p \\<longleftrightarrow> ideal R p \\<and> (1\\<^sub>r\\<^bsub>R\\<^esub>) \\<notin> p \\<and> (\\<forall>x\\<in> carrier R. \\<forall>y\\<in> carrier R.\n    (x \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> y \\<in> p \\<longrightarrow> x \\<in> p \\<or> y \\<in> p))\""], ["", "definition\n  maximal_ideal :: \"[_, 'a set] \\<Rightarrow> bool\" where\n  \"maximal_ideal R mx \\<longleftrightarrow> ideal R mx \\<and> 1\\<^sub>r\\<^bsub>R\\<^esub> \\<notin> mx \\<and>\n        {J. (ideal R J \\<and> mx \\<subseteq> J)} = {mx, carrier R}\""], ["", "lemma (in Ring) maximal_ideal_ideal:\"\\<lbrakk>maximal_ideal R mx\\<rbrakk> \\<Longrightarrow> ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_ideal R mx \\<Longrightarrow> ideal R mx", "by (simp add:maximal_ideal_def)"], ["", "lemma (in Ring) maximal_ideal_proper:\"maximal_ideal R mx \\<Longrightarrow> 1\\<^sub>r \\<notin> mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_ideal R mx \\<Longrightarrow> 1\\<^sub>r \\<notin> mx", "by (simp add:maximal_ideal_def)"], ["", "lemma (in Ring) prime_ideal_ideal:\"prime_ideal R I \\<Longrightarrow> ideal R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R I \\<Longrightarrow> ideal R I", "by (simp add:prime_ideal_def)"], ["", "lemma (in Ring) prime_ideal_proper:\"prime_ideal R I \\<Longrightarrow> I \\<noteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R I \\<Longrightarrow> I \\<noteq> carrier R", "apply (simp add:prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; 1\\<^sub>r \\<notin> I;\n     \\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> I \\<longrightarrow>\n           x \\<in> I \\<or> y \\<in> I\\<rbrakk>\n    \\<Longrightarrow> I \\<noteq> carrier R", "apply (simp add:proper_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prime_ideal_proper1:\"prime_ideal R p \\<Longrightarrow> 1\\<^sub>r \\<notin> p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R p \\<Longrightarrow> 1\\<^sub>r \\<notin> p", "by (simp add:prime_ideal_def)"], ["", "lemma (in Ring) primary_ideal_ideal:\"primary_ideal R q \\<Longrightarrow> ideal R q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primary_ideal R q \\<Longrightarrow> ideal R q", "by (simp add:primary_ideal_def)"], ["", "lemma (in Ring)  primary_ideal_proper1:\"primary_ideal R q \\<Longrightarrow> 1\\<^sub>r \\<notin> q\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primary_ideal R q \\<Longrightarrow> 1\\<^sub>r \\<notin> q", "by (simp add:primary_ideal_def)"], ["", "lemma (in Ring) prime_elems_mult_not:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n                y \\<in> carrier R; x \\<notin> P; y \\<notin> P \\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<notin> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R; y \\<in> carrier R;\n     x \\<notin> P; y \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<notin> P", "apply (simp add:prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<notin> P;\n     y \\<notin> P; ideal R P; 1\\<^sub>r \\<notin> P;\n     \\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<notin> P", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<notin> P;\n     y \\<notin> P; ideal R P; 1\\<^sub>r \\<notin> P;\n     \\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow>\n           x \\<in> P \\<or> y \\<in> P;\n     x \\<cdot>\\<^sub>r y \\<in> P\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier R. \\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\",\n        frule_tac x = y in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\", simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prime_is_primary:\"prime_ideal R p \\<Longrightarrow> primary_ideal R p\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R p \\<Longrightarrow> primary_ideal R p", "apply (unfold primary_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R p \\<Longrightarrow>\n    ideal R p \\<and>\n    1\\<^sub>r \\<notin> p \\<and>\n    (\\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow>\n           (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p \\<or> y \\<in> p))", "apply (rule conjI, simp add:prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R p \\<Longrightarrow>\n    1\\<^sub>r \\<notin> p \\<and>\n    (\\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow>\n           (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p \\<or> y \\<in> p))", "apply (rule conjI, simp add:prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R p \\<Longrightarrow>\n    \\<forall>x\\<in>carrier R.\n       \\<forall>y\\<in>carrier R.\n          x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow>\n          (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p \\<or> y \\<in> p)", "apply ((rule ballI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>prime_ideal R p; x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            x^\\<^bsup>R n\\<^esup> \\<in> p \\<or> y \\<in> p", "apply (simp add:prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow>\n              x \\<in> p \\<or> y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply (frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier R. \\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow> x \\<in> p \\<or> y \\<in> p\",\n        frule_tac x = y in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> p \\<longrightarrow> x \\<in> p \\<or> y \\<in> p\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        x \\<in> p \\<or> y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        x \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p\n 2. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply (frule_tac t = x in np_1[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        x \\<in> p; x = x^\\<^bsup>R Suc 0\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p\n 2. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply (frule_tac a = x and A = p and b = \"x^\\<^bsup>R (Suc 0)\\<^esup>\" in eq_elem_in,\n                                               assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        x \\<in> p; x = x^\\<^bsup>R Suc 0\\<^esup>;\n        x^\\<^bsup>R Suc 0\\<^esup> \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p\n 2. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> p; ideal R p; 1\\<^sub>r \\<notin> p;\n        y \\<in> p\\<rbrakk>\n       \\<Longrightarrow> (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> p) \\<or>\n                         y \\<in> p", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) maximal_prime_Tr0:\"\\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx\\<rbrakk>\n              \\<Longrightarrow>  mx \\<minusplus> (Rxa R x) = carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (frule principal_ideal [of \"x\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x)\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (frule maximal_ideal_ideal[of \"mx\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (frule sum_ideals [of \"mx\" \"Rxa R x\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x)\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (frule sum_ideals_la1 [of \"mx\" \"Rxa R x\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r \\<notin> mx \\<and>\n             {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     x \\<in> carrier R; x \\<notin> mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n     ideal R mx; ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R", "apply (subgoal_tac \"mx \\<minusplus> (Rxa R x) \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n     \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx \\<or>\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (frule sum_ideals_la2 [of \"mx\" \"Rxa R x\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx \\<or>\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (frule a_in_principal [of \"x\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx \\<or>\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (frule subsetD [of \"Rxa R x\" \"mx \\<minusplus> (Rxa R x)\" \"x\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R};\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx \\<or>\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (thin_tac \"{J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx \\<or>\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (erule disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = mx\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 3. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     R \\<diamondsuit>\\<^sub>p x\n     \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> R \\<diamondsuit>\\<^sub>p x;\n     x \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R\n 2. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (thin_tac \"{J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<notin> mx;\n     ideal R (R \\<diamondsuit>\\<^sub>p x); ideal R mx;\n     ideal R (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x);\n     mx \\<subseteq> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n     1\\<^sub>r \\<notin> mx\\<rbrakk>\n    \\<Longrightarrow> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\n                      \\<in> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) maximal_prime:\"maximal_ideal R mx \\<Longrightarrow> prime_ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_ideal R mx \\<Longrightarrow> prime_ideal R mx", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; aGroup R\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R mx", "apply (simp add:prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; aGroup R\\<rbrakk>\n    \\<Longrightarrow> ideal R mx \\<and>\n                      1\\<^sub>r \\<notin> mx \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                             x \\<in> mx \\<or> y \\<in> mx)", "apply (simp add:maximal_ideal_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; aGroup R\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> mx \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                             x \\<in> mx \\<or> y \\<in> mx)", "apply (simp add:maximal_ideal_proper)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; aGroup R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                            x \\<in> mx \\<or> y \\<in> mx", "apply ((rule ballI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> x \\<in> mx \\<or> y \\<in> mx", "apply (rule contrapos_pp, simp+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = x in maximal_prime_Tr0[of \"mx\"], assumption+,\n       frule_tac x = y in maximal_prime_Tr0[of \"mx\"], assumption+,\n       frule maximal_ideal_ideal[of mx],\n       frule ideal_subset1[of mx],\n       frule_tac a = x in principal_ideal,\n       frule_tac a = y in principal_ideal,\n       frule_tac I = \"R \\<diamondsuit>\\<^sub>p x\" in ideal_subset1,\n       frule_tac I = \"R \\<diamondsuit>\\<^sub>p y\" in ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx;\n        mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x = carrier R;\n        mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y = carrier R; ideal R mx;\n        mx \\<subseteq> carrier R; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:aGroup.set_sum)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx;\n        {xa.\n         \\<exists>h\\<in>mx.\n            \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p x.\n               xa = h \\<plusminus> k} =\n        carrier R;\n        {x. \\<exists>h\\<in>mx.\n               \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y.\n                  x = h \\<plusminus> k} =\n        carrier R;\n        ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx;\n        {xa.\n         \\<exists>h\\<in>mx.\n            \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p x.\n               xa = h \\<plusminus> k} =\n        carrier R;\n        {x. \\<exists>h\\<in>mx.\n               \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y.\n                  x = h \\<plusminus> k} =\n        carrier R;\n        ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule sym,\n        thin_tac \"{xa. \\<exists>h\\<in>mx. \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p x. xa = h \\<plusminus> k} = carrier R\",\n        frule sym,\n        thin_tac \"{x. \\<exists>h\\<in>mx. \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. x = h \\<plusminus> k} = carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        carrier R =\n        {xa.\n         \\<exists>h\\<in>mx.\n            \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p x.\n               xa = h \\<plusminus> k};\n        carrier R =\n        {x. \\<exists>h\\<in>mx.\n               \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y.\n                  x = h \\<plusminus> k}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = \"1\\<^sub>r\" and B = \"{xa. \\<exists>i\\<in>mx. \\<exists>j\\<in>(Rxa R x). xa = i \\<plusminus> j}\" in\n                         eq_set_inc[of _ \"carrier R\"], assumption,\n        frule_tac a = \"1\\<^sub>r\" and B = \"{xa. \\<exists>i\\<in>mx. \\<exists>j\\<in>(Rxa R y). xa = i \\<plusminus> j}\" in\n                         eq_set_inc[of _ \"carrier R\"], assumption,\n        thin_tac \"carrier R = {xa. \\<exists>i\\<in>mx. \\<exists>j\\<in>(Rxa R x). xa = i \\<plusminus> j}\",\n        thin_tac \"carrier R = {x. \\<exists>i\\<in>mx. \\<exists>j\\<in>(Rxa R y). x = i \\<plusminus> j}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r\n        \\<in> {xa.\n               \\<exists>i\\<in>mx.\n                  \\<exists>j\\<in>R \\<diamondsuit>\\<^sub>p x.\n                     xa = i \\<plusminus> j};\n        1\\<^sub>r\n        \\<in> {xa.\n               \\<exists>i\\<in>mx.\n                  \\<exists>j\\<in>R \\<diamondsuit>\\<^sub>p y.\n                     xa = i \\<plusminus> j}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule CollectD, (erule bexE)+,\n        frule sym, thin_tac \"1\\<^sub>r = i \\<plusminus> j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r\n        \\<in> {xa.\n               \\<exists>i\\<in>mx.\n                  \\<exists>j\\<in>R \\<diamondsuit>\\<^sub>p y.\n                     xa = i \\<plusminus> j};\n        i \\<in> mx; j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> False", "apply (drule CollectD, (erule bexE)+, rotate_tac -1,\n        frule sym, thin_tac \"1\\<^sub>r = ia \\<plusminus> ja\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac h = i in ideal_subset[of mx], assumption,\n        frule_tac h = ia in ideal_subset[of mx], assumption,\n        frule_tac h = j in ideal_subset, assumption+,\n        frule_tac h = ja in ideal_subset, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = i and y = j in aGroup.ag_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<plusminus> j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"i \\<plusminus> j\" and y = ia and z = ja in ring_distrib1,\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<plusminus> j \\<in> carrier R;\n        (i \\<plusminus> j) \\<cdot>\\<^sub>r (ia \\<plusminus> ja) =\n        (i \\<plusminus> j) \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<plusminus> j) \\<cdot>\\<^sub>r ja\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = ia and y = i and z = j in ring_distrib2, assumption+,\n        frule_tac x = ja and y = i and z = j in ring_distrib2, assumption+,\n        simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; i \\<plusminus> j = 1\\<^sub>r;\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja = 1\\<^sub>r; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r 1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        1\\<^sub>r \\<cdot>\\<^sub>r ia =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia;\n        1\\<^sub>r \\<cdot>\\<^sub>r ja =\n        i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja\\<rbrakk>\n       \\<Longrightarrow> False", "apply (thin_tac \"1\\<^sub>r \\<cdot>\\<^sub>r ia = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia\",\n        thin_tac \"1\\<^sub>r \\<cdot>\\<^sub>r ja = i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja\",\n        simp add:ring_l_one[of \"1\\<^sub>r\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = ia and r = i in ideal_ring_multiple[of mx], assumption+,\n        frule_tac x = i and r = j in ideal_ring_multiple1[of mx], assumption+,\n        frule_tac x = i and r = ja in ideal_ring_multiple1[of mx], assumption+,\n        frule_tac r = j and x = ia in ideal_ring_multiple[of mx], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"j \\<cdot>\\<^sub>r ja \\<in> mx\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx; j \\<cdot>\\<^sub>r ia \\<in> mx;\n        j \\<cdot>\\<^sub>r ja \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (frule_tac x = \"i \\<cdot>\\<^sub>r ia\" and y = \"j \\<cdot>\\<^sub>r ia\" in ideal_pOp_closed[of mx],\n                   assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx; j \\<cdot>\\<^sub>r ia \\<in> mx;\n        j \\<cdot>\\<^sub>r ja \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (\n        frule_tac x = \"i \\<cdot>\\<^sub>r ja\" and y = \"j \\<cdot>\\<^sub>r ja\" in ideal_pOp_closed[of mx],\n           assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx; j \\<cdot>\\<^sub>r ia \\<in> mx;\n        j \\<cdot>\\<^sub>r ja \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (frule_tac x = \"i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia\" and y = \"i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja\" in\n          ideal_pOp_closed[of mx], assumption+,\n        thin_tac \"i \\<plusminus> j = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\",\n        thin_tac \"ia \\<plusminus> ja = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; ia \\<in> mx;\n        ja \\<in> R \\<diamondsuit>\\<^sub>p y; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx; j \\<cdot>\\<^sub>r ia \\<in> mx;\n        j \\<cdot>\\<^sub>r ja \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (frule sym, thin_tac \"1\\<^sub>r = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\",\n       simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; ia \\<in> mx;\n        ja \\<in> R \\<diamondsuit>\\<^sub>p y; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        i \\<cdot>\\<^sub>r j \\<in> mx; i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx; j \\<cdot>\\<^sub>r ja \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja \\<in> mx;\n        1\\<^sub>r \\<in> mx;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja) =\n        1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y);\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x;\n        i \\<plusminus> j =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        ia \\<in> mx; ja \\<in> R \\<diamondsuit>\\<^sub>p y;\n        ia \\<plusminus> ja =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<in> carrier R; ia \\<in> carrier R; j \\<in> carrier R;\n        ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\n        \\<in> carrier R;\n        1\\<^sub>r =\n        i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus>\n        (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja);\n        i \\<cdot>\\<^sub>r ia \\<in> mx; i \\<cdot>\\<^sub>r j \\<in> mx;\n        i \\<cdot>\\<^sub>r ja \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (thin_tac \"i \\<plusminus> j = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\",\n       thin_tac \"ia \\<plusminus> ja = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\",\n       thin_tac \"i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja) \\<in> carrier R\",\n       thin_tac \"1\\<^sub>r = i \\<cdot>\\<^sub>r ia \\<plusminus> j \\<cdot>\\<^sub>r ia \\<plusminus> (i \\<cdot>\\<^sub>r ja \\<plusminus> j \\<cdot>\\<^sub>r ja)\",\n       thin_tac \"i \\<cdot>\\<^sub>r j \\<in> mx\", thin_tac \"i \\<cdot>\\<^sub>r ja \\<in> mx\",\n       thin_tac \"R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R\", thin_tac \"R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R\",\n       thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p y)\", thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p x)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        j \\<in> R \\<diamondsuit>\\<^sub>p x; ia \\<in> mx;\n        ja \\<in> R \\<diamondsuit>\\<^sub>p y; i \\<in> carrier R;\n        ia \\<in> carrier R; j \\<in> carrier R; ja \\<in> carrier R;\n        i \\<cdot>\\<^sub>r ia \\<in> mx;\n        j \\<cdot>\\<^sub>r ia \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> j \\<cdot>\\<^sub>r ja \\<in> mx", "apply (simp add:Rxa_def, (erule bexE)+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r ia \\<in> mx; r \\<in> carrier R;\n        j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r\n                         (ra \\<cdot>\\<^sub>r y)\n                         \\<in> mx", "apply (simp add:ring_tOp_assoc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r ia) \\<in> mx;\n        r \\<in> carrier R; j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (x \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r y))\n                         \\<in> mx", "apply (simp add:ring_tOp_assoc[THEN sym])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r ia \\<in> mx; r \\<in> carrier R;\n        j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (x \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r y)\n                         \\<in> mx", "apply (frule_tac x = x and y = ra in ring_tOp_commute, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r ia \\<in> mx; r \\<in> carrier R;\n        j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y;\n        x \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r x\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (ra \\<cdot>\\<^sub>r x \\<cdot>\\<^sub>r y)\n                         \\<in> mx", "apply (simp add:ring_tOp_assoc,\n        frule_tac x = x and y = y in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r ia) \\<in> mx;\n        r \\<in> carrier R; j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y;\n        x \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r x;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r\n                         (ra \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y))\n                         \\<in> mx", "apply (frule_tac x1 = r and y1 = ra and z1 = \"x \\<cdot>\\<^sub>r y\" in\n        ring_tOp_assoc[THEN sym], assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y i j ia ja r ra.\n       \\<lbrakk>maximal_ideal R mx; aGroup R; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx; x \\<notin> mx;\n        y \\<notin> mx; ideal R mx; mx \\<subseteq> carrier R; i \\<in> mx;\n        ia \\<in> mx; i \\<in> carrier R; ia \\<in> carrier R;\n        r \\<cdot>\\<^sub>r x \\<in> carrier R;\n        ra \\<cdot>\\<^sub>r y \\<in> carrier R; i \\<cdot>\\<^sub>r ia \\<in> mx;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r ia) \\<in> mx;\n        r \\<in> carrier R; j = r \\<cdot>\\<^sub>r x; ra \\<in> carrier R;\n        ja = ra \\<cdot>\\<^sub>r y;\n        x \\<cdot>\\<^sub>r ra = ra \\<cdot>\\<^sub>r x;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (ra \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y)) =\n        r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r ra \\<cdot>\\<^sub>r\n                         (x \\<cdot>\\<^sub>r y)\n                         \\<in> mx", "apply (frule_tac x = r and y = ra in ring_tOp_closed, assumption+,\n        rule ideal_ring_multiple[of mx], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) chains_un:\"\\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}; c \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> ideal R (\\<Union>c)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> ideal R (\\<Union> c)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> c \\<subseteq> carrier R\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> c \\<noteq> {}\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 4. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (rule Union_least[of \"c\" \"carrier R\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; X \\<in> c\\<rbrakk>\n       \\<Longrightarrow> X \\<subseteq> carrier R\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> c \\<noteq> {}\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 4. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (simp add:chains_def,\n       erule conjE,\n       frule_tac c = X in subsetD[of \"c\" \"{I. ideal R I \\<and> I \\<subset> carrier R}\"],\n       assumption+, simp add:psubset_imp_subset)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Union> c \\<noteq> {}\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (simp add:chains_def,\n       erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>c \\<noteq> {};\n     c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n     chain\\<^sub>\\<subseteq> c\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x\\<in>c. x \\<noteq> {}\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule nonempty_ex[of \"c\"], erule exE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>c \\<noteq> {};\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        chain\\<^sub>\\<subseteq> c; x \\<in> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>c. x \\<noteq> {}\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule_tac c = x in subsetD[of \"c\" \"{I. ideal R I \\<and> I \\<subset> carrier R}\"],\n        assumption+, simp, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>c \\<noteq> {};\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        chain\\<^sub>\\<subseteq> c; x \\<in> c; ideal R x;\n        x \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x\\<in>c. x \\<noteq> {}\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 3. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule_tac I = x in ideal_zero, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Union> c.\n                         \\<forall>y\\<in>\\<Union> c.\n                            x \\<plusminus> y \\<in> \\<Union> c\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; x \\<in> \\<Union> c; y \\<in> \\<Union> c\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> \\<Union> c\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; \\<exists>X\\<in>c. x \\<in> X;\n        \\<exists>X\\<in>c. y \\<in> X\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (erule bexE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (simp add: chains_def chain_subset_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<subseteq> {I. ideal R I \\<and>\n                                  I \\<subset> carrier R} \\<and>\n                (\\<forall>A\\<in>c.\n                    \\<forall>B\\<in>c.\n                       A \\<subseteq> B \\<or> B \\<subseteq> A);\n        c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule conjunct1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<subseteq> {I. ideal R I \\<and>\n                                  I \\<subset> carrier R} \\<and>\n                (\\<forall>A\\<in>c.\n                    \\<forall>B\\<in>c.\n                       A \\<subseteq> B \\<or> B \\<subseteq> A);\n        c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule conjunct2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<subseteq> {I. ideal R I \\<and>\n                                  I \\<subset> carrier R} \\<and>\n                (\\<forall>A\\<in>c.\n                    \\<forall>B\\<in>c.\n                       A \\<subseteq> B \\<or> B \\<subseteq> A);\n        c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        \\<forall>A\\<in>c.\n           \\<forall>B\\<in>c. A \\<subseteq> B \\<or> B \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (thin_tac \"c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R} \\<and> (\\<forall>x\\<in>c. \\<forall>y\\<in>c. x \\<subseteq> y \\<or> y \\<subseteq> x)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        \\<forall>A\\<in>c.\n           \\<forall>B\\<in>c. A \\<subseteq> B \\<or> B \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule_tac x = X in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>c. \\<forall>y\\<in>c. x \\<subseteq> y \\<or> y \\<subseteq> x\",\n        frule_tac x = Xa in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>c. X \\<subseteq> y \\<or> y \\<subseteq> X\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        X \\<subseteq> Xa \\<or> Xa \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule_tac c = Xa in subsetD[of \"c\" \"{I. ideal R I \\<and> I \\<subset> carrier R}\"],\n          assumption+,\n        frule_tac c = X in subsetD[of \"c\" \"{I. ideal R I \\<and> I \\<subset> carrier R}\"],\n          assumption+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        X \\<subseteq> Xa \\<or> Xa \\<subseteq> X;\n        ideal R Xa \\<and> Xa \\<subset> carrier R;\n        ideal R X \\<and> X \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        X \\<subseteq> Xa \\<or> Xa \\<subseteq> X; ideal R Xa;\n        Xa \\<subset> carrier R; ideal R X; X \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (erule disjE,\n        frule_tac c = x and A = X and B = Xa in subsetD, assumption+,\n        frule_tac x = x and y = y and I = Xa in ideal_pOp_closed, assumption+,\n        blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X Xa.\n       \\<lbrakk>c \\<noteq> {}; X \\<in> c; x \\<in> X; Xa \\<in> c; y \\<in> Xa;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R Xa; Xa \\<subset> carrier R; ideal R X;\n        X \\<subset> carrier R; Xa \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (frule_tac c = y and A = Xa and B = X in subsetD, assumption+,\n        frule_tac x = x and y = y and I = X in ideal_pOp_closed, assumption+,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n     c \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Union> c.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; r \\<in> carrier R; x \\<in> \\<Union> c\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> \\<Union> c", "apply (simp, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x X.\n       \\<lbrakk>c \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        c \\<noteq> {}; r \\<in> carrier R; X \\<in> c; x \\<in> X\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. r \\<cdot>\\<^sub>r x \\<in> X", "apply (simp add:chains_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x X.\n       \\<lbrakk>c \\<noteq> {}; r \\<in> carrier R; X \\<in> c; x \\<in> X;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        chain\\<^sub>\\<subseteq> c\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. r \\<cdot>\\<^sub>r x \\<in> X", "apply (frule_tac c = X in subsetD[of \"c\" \"{I. ideal R I \\<and> I \\<subset> carrier R}\"],\n        assumption+, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x X.\n       \\<lbrakk>c \\<noteq> {}; r \\<in> carrier R; X \\<in> c; x \\<in> X;\n        c \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        chain\\<^sub>\\<subseteq> c; ideal R X; X \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>c. r \\<cdot>\\<^sub>r x \\<in> X", "apply (frule_tac I = X and x = x and r = r in ideal_ring_multiple,\n        assumption+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) zeroring_no_maximal:\"zeroring R \\<Longrightarrow> \\<not> (\\<exists>I. maximal_ideal R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. zeroring R \\<Longrightarrow> \\<nexists>I. maximal_ideal R I", "apply (rule contrapos_pp, simp+, erule exE,\n       frule_tac mx = x in maximal_ideal_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>zeroring R; maximal_ideal R x; ideal R x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac I = x in ideal_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>zeroring R; maximal_ideal R x; ideal R x;\n        \\<zero> \\<in> x\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:zeroring_def, erule conjE,\n       cut_tac ring_one, simp, thin_tac \"carrier R = {\\<zero>}\",\n        frule sym, thin_tac \"1\\<^sub>r = \\<zero>\", simp, thin_tac \"\\<zero> = 1\\<^sub>r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>maximal_ideal R x; ideal R x; 1\\<^sub>r \\<in> x;\n        Ring R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) id_maximal_Exist:\"\\<not>(zeroring R) \\<Longrightarrow> \\<exists>I. maximal_ideal R I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> zeroring R \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (cut_tac A=\"{ I. ideal R I \\<and> I \\<subset> carrier R }\" in Zorn_Lemma2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<not> zeroring R \\<Longrightarrow>\n    \\<forall>C\\<in>chains {I. ideal R I \\<and> I \\<subset> carrier R}.\n       \\<exists>U\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n          \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (case_tac \"C={}\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        {} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U. ideal R U \\<and> U \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (cut_tac zero_ideal)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        {} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}; C = {};\n        ideal R {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U. ideal R U \\<and> U \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (simp add:zeroring_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>Ring R \\<longrightarrow> carrier R \\<noteq> {\\<zero>};\n        {} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}; C = {};\n        ideal R {\\<zero>}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U. ideal R U \\<and> U \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (cut_tac Ring, simp,\n           frule not_sym, thin_tac \"carrier R \\<noteq> {\\<zero>}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>{} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C = {}; ideal R {\\<zero>}; Ring R;\n        {\\<zero>} \\<noteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U. ideal R U \\<and> U \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (cut_tac ring_zero,\n         frule singleton_sub[of \"\\<zero>\" \"carrier R\"],\n         thin_tac \"\\<zero> \\<in> carrier R\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>{} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C = {}; ideal R {\\<zero>}; Ring R; {\\<zero>} \\<noteq> carrier R;\n        {\\<zero>} \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U. ideal R U \\<and> U \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (subst psubset_eq)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>{} \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C = {}; ideal R {\\<zero>}; Ring R; {\\<zero>} \\<noteq> carrier R;\n        {\\<zero>} \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U.\n                            ideal R U \\<and>\n                            U \\<subseteq> carrier R \\<and>\n                            U \\<noteq> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (subgoal_tac \"\\<Union>C \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {};\n        \\<Union> C\n        \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> I \\<subset> carrier R}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C\n                         \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (subgoal_tac \"\\<forall>x\\<in>C. x \\<subseteq> (\\<Union>C)\", blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {};\n        \\<Union> C\n        \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C\n                         \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (rule ballI, rule Union_upper, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C\n                         \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (simp add:chains_un)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C \\<subset> carrier R\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (cut_tac A = C in Union_least[of _ \"carrier R\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C X.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}; X \\<in> C\\<rbrakk>\n       \\<Longrightarrow> X \\<subseteq> carrier R\n 2. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        C \\<noteq> {}; \\<Union> C \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C \\<subset> carrier R\n 3. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (simp add:chains_def, erule conjE,\n        frule_tac c = X and A = C in\n          subsetD[of _ \"{I. ideal R I \\<and> I \\<subset> carrier R}\"], assumption+,\n          simp add:ideal_subset1, simp add:psubset_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains\n                 {I. ideal R I \\<and>\n                     I \\<subseteq> carrier R \\<and> I \\<noteq> carrier R};\n        C \\<noteq> {}; \\<Union> C \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C \\<noteq> carrier R\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (rule contrapos_pp, simp+,\n         cut_tac ring_one, frule sym, thin_tac \"\\<Union>C = carrier R\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains\n                 {I. ideal R I \\<and>\n                     I \\<subseteq> carrier R \\<and> I \\<noteq> carrier R};\n        C \\<noteq> {}; 1\\<^sub>r \\<in> carrier R;\n        carrier R = \\<Union> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (frule_tac B = \"\\<Union>C\" in eq_set_inc[of \"1\\<^sub>r\" \"carrier R\"], assumption,\n         thin_tac \"carrier R = \\<Union>C\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains\n                 {I. ideal R I \\<and>\n                     I \\<subseteq> carrier R \\<and> I \\<noteq> carrier R};\n        C \\<noteq> {}; 1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<in> \\<Union> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (simp, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C X.\n       \\<lbrakk>\\<not> zeroring R;\n        C \\<in> chains\n                 {I. ideal R I \\<and>\n                     I \\<subseteq> carrier R \\<and> I \\<noteq> carrier R};\n        C \\<noteq> {}; 1\\<^sub>r \\<in> carrier R; X \\<in> C;\n        1\\<^sub>r \\<in> X\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (simp add:chains_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C X.\n       \\<lbrakk>\\<not> zeroring R; C \\<noteq> {}; 1\\<^sub>r \\<in> carrier R;\n        X \\<in> C; 1\\<^sub>r \\<in> X;\n        C \\<subseteq> {I. ideal R I \\<and>\n                          I \\<subseteq> carrier R \\<and>\n                          I \\<noteq> carrier R};\n        chain\\<^sub>\\<subseteq> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (frule_tac c = X and A = C in\n         subsetD[of _ \"{I. ideal R I \\<and> I \\<subseteq> carrier R \\<and> I \\<noteq> carrier R}\"],\n         assumption+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C X.\n       \\<lbrakk>\\<not> zeroring R; C \\<noteq> {}; 1\\<^sub>r \\<in> carrier R;\n        X \\<in> C; 1\\<^sub>r \\<in> X;\n        C \\<subseteq> {I. ideal R I \\<and>\n                          I \\<subseteq> carrier R \\<and>\n                          I \\<noteq> carrier R};\n        chain\\<^sub>\\<subseteq> C; ideal R X; X \\<subseteq> carrier R;\n        X \\<noteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (frule_tac I = X in ideal_inc_one, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R;\n     \\<exists>M\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> I \\<subset> carrier R}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (erule bexE, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>I. maximal_ideal R I", "apply (subgoal_tac \"maximal_ideal R M\", blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> maximal_ideal R M", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<notin> M \\<and>\n                         {J. ideal R J \\<and> M \\<subseteq> J} =\n                         {M, carrier R}", "apply (rule conjI, rule contrapos_pp, simp+,\n       frule_tac  I = M in ideal_inc_one, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {J. ideal R J \\<and> M \\<subseteq> J} =\n                         {M, carrier R}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {J. ideal R J \\<and> M \\<subseteq> J}\n                         \\<subseteq> {M, carrier R}\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R;\n        ideal R x \\<and> M \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x = M \\<or> x = carrier R\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R; ideal R x;\n        M \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x = M \\<or> x = carrier R\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (frule_tac x = x in spec,\n        thin_tac \"\\<forall>x. ideal R x \\<and> x \\<subset> carrier R \\<longrightarrow> M \\<subseteq> x \\<longrightarrow> x = M\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R; ideal R M; M \\<subset> carrier R;\n        ideal R x; M \\<subseteq> x;\n        x \\<subset> carrier R \\<longrightarrow> x = M\\<rbrakk>\n       \\<Longrightarrow> x = M \\<or> x = carrier R\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (frule_tac I = x in ideal_subset1, simp add:psubset_eq)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R; ideal R M;\n        M \\<subseteq> carrier R \\<and> M \\<noteq> carrier R; ideal R x;\n        M \\<subseteq> x; x \\<noteq> carrier R \\<longrightarrow> x = M;\n        x \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> x = M \\<or> x = carrier R\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (case_tac \"x = carrier R\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R; ideal R M;\n        M \\<subseteq> carrier R \\<and> M \\<noteq> carrier R; ideal R x;\n        M \\<subseteq> x; x \\<noteq> carrier R \\<longrightarrow> x = M;\n        x \\<subseteq> carrier R; x \\<noteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> x = M \\<or> x = carrier R\n 2. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R\\<rbrakk>\n       \\<Longrightarrow> {M, carrier R}\n                         \\<subseteq> {J. ideal R J \\<and> M \\<subseteq> J}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R; x = M \\<or> x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> M \\<subseteq> x", "apply (erule disjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R; x = M\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> M \\<subseteq> x\n 2. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R; x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> M \\<subseteq> x", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>X.\n           ideal R X \\<and> X \\<subset> carrier R \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M;\n        ideal R M; M \\<subset> carrier R; x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> M \\<subseteq> x", "apply (simp add:whole_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ideal_Int :: \"[_, 'a set set] \\<Rightarrow> 'a set\" where\n  \"ideal_Int R S == \\<Inter> S\""], ["", "lemma (in Ring) ideal_Int_ideal:\"\\<lbrakk>S \\<subseteq> {I. ideal R I}; S\\<noteq>{}\\<rbrakk> \\<Longrightarrow>\n                                                 ideal R (\\<Inter> S)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> ideal R (\\<Inter> S)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> carrier R\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 4. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (frule nonempty_ex[of \"S\"], erule exE)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        x \\<in> S\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> S \\<subseteq> carrier R\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 4. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (frule_tac c = x in subsetD[of \"S\" \"{I. ideal R I}\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}; x \\<in> S;\n        x \\<in> {I. ideal R I}\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> S \\<subseteq> carrier R\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 4. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (simp, frule_tac I = x in ideal_subset1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}; x \\<in> S;\n        ideal R x; x \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> S \\<subseteq> carrier R\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 4. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (frule_tac B = x and A = S in Inter_lower)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}; x \\<in> S;\n        ideal R x; x \\<subseteq> carrier R;\n        \\<Inter> S \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> \\<Inter> S \\<subseteq> carrier R\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 4. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (rule_tac A = \"\\<Inter>S\" and B = x and C = \"carrier R\" in subset_trans,\n         assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<noteq> {}\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 3. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (cut_tac ideal_zero_forall, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>\\<Inter> S.\n                         \\<forall>y\\<in>\\<Inter> S.\n                            x \\<plusminus> y \\<in> \\<Inter> S\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (simp, rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        x \\<in> \\<Inter> S\\<rbrakk>\n       \\<Longrightarrow> \\<forall>y\\<in>\\<Inter> S.\n                            \\<forall>X\\<in>S. x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        x \\<in> \\<Inter> S; y \\<in> \\<Inter> S; X \\<in> S\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        \\<forall>X\\<in>S. x \\<in> X; \\<forall>X\\<in>S. y \\<in> X;\n        X \\<in> S\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (frule_tac x = X in bspec, assumption,\n        thin_tac \"\\<forall>X\\<in>S. x \\<in> X\",\n        frule_tac x = X in bspec, assumption,\n        thin_tac \"\\<forall>X\\<in>S. y \\<in> X\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y X.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}; X \\<in> S;\n        x \\<in> X; y \\<in> X\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> X\n 2. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (frule_tac c = X in subsetD[of \"S\" \"{I. ideal R I}\"], assumption+,\n       simp, rule_tac x = x and y = y in ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>\\<Inter> S.\n                            r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        r \\<in> carrier R; x \\<in> \\<Inter> S\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> \\<Inter> S", "apply (simp, rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x X.\n       \\<lbrakk>S \\<subseteq> {I. ideal R I}; S \\<noteq> {};\n        r \\<in> carrier R; \\<forall>X\\<in>S. x \\<in> X; X \\<in> S\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> X", "apply (frule_tac x = X in bspec, assumption,\n        thin_tac \"\\<forall>X\\<in>S. x \\<in> X\",\n        frule_tac c = X in subsetD[of \"S\" \"{I. ideal R I}\"], assumption+,\n        simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) sum_prideals_Int:\"\\<lbrakk>\\<forall>l \\<le> n. f l \\<in> carrier R;\n                S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk> \\<Longrightarrow>\n                                  (sum_pr_ideals R f n) = \\<Inter> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n = \\<Inter> S", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> \\<Inter> S\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply (subgoal_tac \"\\<forall>X\\<in>S. sum_pr_ideals R f n \\<subseteq> X\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I};\n     \\<forall>X\\<in>S. sum_pr_ideals R f n \\<subseteq> X\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> \\<Inter> S\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>X\\<in>S. sum_pr_ideals R f n \\<subseteq> X\n 3. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>X\\<in>S. sum_pr_ideals R f n \\<subseteq> X\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n        S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I};\n        X \\<in> S\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> X\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply (simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n        S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I};\n        ideal R X; f ` {i. i \\<le> n} \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> sum_pr_ideals R f n \\<subseteq> X\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply (rule_tac I = X and n = n and f = f in sum_of_prideals4, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n", "apply (subgoal_tac \"(sum_pr_ideals R f n) \\<in> S\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I};\n     sum_pr_ideals R f n \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<Inter> S \\<subseteq> sum_pr_ideals R f n\n 2. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n \\<in> S", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> sum_pr_ideals R f n \\<in> S", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> ideal R (sum_pr_ideals R f n) \\<and>\n                      f ` {i. i \\<le> n} \\<subseteq> sum_pr_ideals R f n", "apply (simp add: sum_of_prideals2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>l\\<le>n. f l \\<in> carrier R;\n     S = {I. ideal R I \\<and> f ` {i. i \\<le> n} \\<subseteq> I}\\<rbrakk>\n    \\<Longrightarrow> ideal R (sum_pr_ideals R f n)", "apply (simp add: sum_of_prideals)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "text\\<open>This proves that \\<open>(sum_pr_ideals R f n)\\<close> is the smallest ideal containing\n \\<open>f ` (Nset n)\\<close>\\<close>"], ["", "primrec ideal_n_prod::\"[('a, 'm) Ring_scheme, nat,  nat \\<Rightarrow> 'a set] \\<Rightarrow> 'a set\"\nwhere\n  ideal_n_prod0: \"ideal_n_prod R 0 J = J 0\"\n| ideal_n_prodSn: \"ideal_n_prod R (Suc n) J =\n                          (ideal_n_prod R n J) \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> (J (Suc n))\""], ["", "abbreviation\n  IDNPROD  (\"(3i\\<Pi>\\<^bsub>_,_\\<^esub> _)\" [98,98,99]98) where\n  \"i\\<Pi>\\<^bsub>R,n\\<^esub> J == ideal_n_prod R n J\""], ["", "primrec\n  ideal_pow :: \"['a set, ('a, 'more) Ring_scheme, nat] \\<Rightarrow> 'a set\"\n               (\"(3_/ \\<^bsup>\\<diamondsuit>_ _\\<^esup>)\" [120,120,121]120)\nwhere\n  ip0:  \"I \\<^bsup>\\<diamondsuit>R 0\\<^esup> = carrier R\"\n| ipSuc:  \"I \\<^bsup>\\<diamondsuit>R (Suc n)\\<^esup> = I \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\""], ["", "lemma (in Ring) prod_mem_prod_ideals:\"\\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J\\<rbrakk> \\<Longrightarrow>\n                            i \\<cdot>\\<^sub>r j \\<in> (I \\<diamondsuit>\\<^sub>r J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J\\<rbrakk>\n    \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         ideal R x \\<and>\n                         {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> x \\<longrightarrow>\n                         i \\<cdot>\\<^sub>r j \\<in> x", "apply (rule allI, rule impI, erule conjE, rename_tac X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X.\n       \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> X", "apply (rule_tac A = \"{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = Ring.tp R i j}\" and B = X and c = \"i \\<cdot>\\<^sub>r j\" in  subsetD, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X.\n       \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j\n                         \\<in> {x. \\<exists>i\\<in>I.\n\\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>X.\n       \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> \\<exists>ia\\<in>I.\n                            \\<exists>ja\\<in>J.\n                               i \\<cdot>\\<^sub>r j = ia \\<cdot>\\<^sub>r ja", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_ideal:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow>\n                                        ideal R (I \\<diamondsuit>\\<^sub>r J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> ideal R (I \\<diamondsuit>\\<^sub>r J)", "apply (rule ideal_condition1)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>I.\n                                  \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}\n                      \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (cut_tac whole_ideal)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (frule_tac x = \"carrier R\" in spec,\n        thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> xa \\<longrightarrow>\n                                                                   x \\<in> xa\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J; ideal R (carrier R);\n        ideal R (carrier R) \\<and>\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> carrier R \\<longrightarrow>\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (subgoal_tac \"{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> carrier R\", simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J; ideal R (carrier R);\n        ideal R (carrier R) \\<and>\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> carrier R \\<longrightarrow>\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (thin_tac \"ideal R (carrier R) \\<and>\n            {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> carrier R \\<longrightarrow> x \\<in> carrier R\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J; ideal R (carrier R)\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule subsetI, simp, (erule bexE)+, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>xa i j.\n       \\<lbrakk>ideal R I; ideal R J; ideal R (carrier R); i \\<in> I;\n        j \\<in> J; xa = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (frule_tac h = i in ideal_subset[of \"I\"], assumption+,\n        frule_tac h = j in ideal_subset[of \"J\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>xa i j.\n       \\<lbrakk>ideal R I; ideal R J; ideal R (carrier R); i \\<in> I;\n        j \\<in> J; xa = i \\<cdot>\\<^sub>r j; i \\<in> carrier R;\n        j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> carrier R\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 4. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule_tac x = i and y = j in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<noteq> {}\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (frule ideal_zero[of \"I\"],\n        frule ideal_zero[of \"J\"],\n        subgoal_tac \"\\<zero> \\<in> I \\<diamondsuit>\\<^sub>r\\<^bsub> R\\<^esub> J\", blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J; \\<zero> \\<in> I; \\<zero> \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<in> I \\<diamondsuit>\\<^sub>r J\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J; \\<zero> \\<in> I; \\<zero> \\<in> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x.\n                         ideal R x \\<and>\n                         {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> x \\<longrightarrow>\n                         \\<zero> \\<in> x\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J; \\<zero> \\<in> I; \\<zero> \\<in> J;\n        ideal R x;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<in> x\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 3. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule ideal_zero, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                         \\<forall>y\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            x \\<plusminus> y\n                            \\<in> I \\<diamondsuit>\\<^sub>r J\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R I; ideal R J; x \\<in> I \\<diamondsuit>\\<^sub>r J;\n        y \\<in> I \\<diamondsuit>\\<^sub>r J\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> I \\<diamondsuit>\\<^sub>r J\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        \\<forall>x.\n           ideal R x \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> x \\<longrightarrow>\n           y \\<in> x\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            ideal R xa \\<and>\n                            {x. \\<exists>i\\<in>I.\n                                   \\<exists>j\\<in>J.\nx = i \\<cdot>\\<^sub>r j}\n                            \\<subseteq> xa \\<longrightarrow>\n                            x \\<plusminus> y \\<in> xa\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y xa.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        \\<forall>x.\n           ideal R x \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> x \\<longrightarrow>\n           y \\<in> x;\n        ideal R xa \\<and>\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> xa\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (frule_tac x = xa in spec,\n        thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> xa\n                                            \\<longrightarrow> x \\<in> xa\",\n        frule_tac x = xa in spec,\n        thin_tac \"\\<forall>x. ideal R x \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> x \\<longrightarrow> y \\<in> x\",\n        erule conjE, simp,\n        rule_tac x = x and y = y in ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>r\\<in>carrier R.\n                         \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J.\n                            r \\<cdot>\\<^sub>r x\n                            \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R I; ideal R J; r \\<in> carrier R;\n        x \\<in> I \\<diamondsuit>\\<^sub>r J\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x\n                         \\<in> I \\<diamondsuit>\\<^sub>r J", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>ideal R I; ideal R J; r \\<in> carrier R;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            ideal R xa \\<and>\n                            {x. \\<exists>i\\<in>I.\n                                   \\<exists>j\\<in>J.\nx = i \\<cdot>\\<^sub>r j}\n                            \\<subseteq> xa \\<longrightarrow>\n                            r \\<cdot>\\<^sub>r x \\<in> xa", "apply (rule allI, rule impI, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa.\n       \\<lbrakk>ideal R I; ideal R J; r \\<in> carrier R;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        ideal R xa;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> xa\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> xa", "apply (frule_tac x = xa in spec,\n               thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                            \\<subseteq> xa \\<longrightarrow> x \\<in> xa\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x xa.\n       \\<lbrakk>ideal R I; ideal R J; r \\<in> carrier R; ideal R xa;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> xa;\n        x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> xa", "apply (simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_commute:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow>\n                                              I \\<diamondsuit>\\<^sub>r J = J \\<diamondsuit>\\<^sub>r I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J =\n                      J \\<diamondsuit>\\<^sub>r I", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>I.\n                                  \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L} =\n                      \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>J.\n                                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}", "apply (subgoal_tac \"{K. ideal R K \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n       \\<subseteq> K}  = {K. ideal R K \\<and> {x. \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j} \\<subseteq> K}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J;\n     {K. ideal R K \\<and>\n         {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n         \\<subseteq> K} =\n     {K. ideal R K \\<and>\n         {x. \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n         \\<subseteq> K}\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>I.\n                                  \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L} =\n                      \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>J.\n                                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>I.\n                                 \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K} =\n                      {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>I.\n                                 \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K} =\n                      {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>I.\n                                 \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}", "apply (rule subsetI, rename_tac X, simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X.\n       \\<lbrakk>ideal R I; ideal R J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>J.\n                                \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> X\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X x.\n       \\<lbrakk>ideal R I; ideal R J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> x \\<in> X\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}", "apply ((erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>X x i j.\n       \\<lbrakk>ideal R I; ideal R J; ideal R X;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        i \\<in> J; j \\<in> I; x = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> x \\<in> X\n 2. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}", "apply (subgoal_tac \"x \\<in> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\",\n        rule_tac c = x and A = \"{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\" and B = X in\n        subsetD, assumption+,\n        frule_tac h = i in ideal_subset[of \"J\"], assumption,\n        frule_tac h = j in ideal_subset[of \"I\"], assumption,\n        frule_tac x = i and y = j in ring_tOp_commute, assumption+, simp,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> {K. ideal R K \\<and>\n                          {x. \\<exists>i\\<in>J.\n                                 \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                          \\<subseteq> K}\n                      \\<subseteq> {K. ideal R K \\<and>\n{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n\\<subseteq> K}", "apply (rule subsetI, simp, erule conjE,\n        rule subsetI, simp,\n        (erule bexE)+,\n        subgoal_tac \"xa \\<in> {x. \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\",\n        rule_tac c = xa and A = \"{x. \\<exists>i\\<in>J. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\" and B = x in\n                 subsetD, assumption+,\n        frule_tac h = i in ideal_subset[of \"I\"], assumption,\n        frule_tac h = j in ideal_subset[of \"J\"], assumption,\n        frule_tac x = i and y = j in ring_tOp_commute, assumption+, simp,\n        blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_subTr:\"\\<lbrakk>ideal R I; ideal R J; ideal R C;\n                        \\<forall>i\\<in>I. \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk> \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> C\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; ideal R C;\n     \\<forall>i\\<in>I.\n        \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> C", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; ideal R C;\n     \\<forall>i\\<in>I.\n        \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>I.\n                                  \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}\n                      \\<subseteq> C", "apply (rule_tac B = C and\n        A = \"{L. ideal R L \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j} \\<subseteq> L}\" in\n        Inter_lower)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; ideal R C;\n     \\<forall>i\\<in>I.\n        \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk>\n    \\<Longrightarrow> C \\<in> {L. ideal R L \\<and>\n                                  {x. \\<exists>i\\<in>I.\n   \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                                  \\<subseteq> L}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; ideal R C;\n     \\<forall>i\\<in>I.\n        \\<forall>j\\<in>J. i \\<cdot>\\<^sub>r j \\<in> C\\<rbrakk>\n    \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                             \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                      \\<subseteq> C", "apply (rule subsetI, simp, (erule bexE)+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) n_prod_idealTr:\n     \"(\\<forall>k \\<le> n. ideal R (J k)) \\<longrightarrow> ideal R (ideal_n_prod R n J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n    ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>k\\<le>0. ideal R (J k)) \\<longrightarrow>\n    ideal R (i\\<Pi>\\<^bsub>R,0\\<^esub> J)\n 2. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<forall>k\\<le>0. ideal R (J k) \\<Longrightarrow>\n    ideal R (i\\<Pi>\\<^bsub>R,0\\<^esub> J)\n 2. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<longrightarrow>\n       ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n                ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n       \\<Longrightarrow> ideal R (i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J)", "apply (simp only:ideal_n_prodSn)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n                ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n       \\<Longrightarrow> ideal R\n                          (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                           J (Suc n))", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n       \\<Longrightarrow> ideal R\n                          (i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                           J (Suc n))", "apply (rule ideal_prod_ideal, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J);\n        \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n       \\<Longrightarrow> ideal R (J (Suc n))", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) n_prod_ideal:\"\\<lbrakk>\\<forall>k \\<le> n. ideal R (J k)\\<rbrakk>\n                               \\<Longrightarrow>  ideal R (ideal_n_prod R n J)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>k\\<le>n. ideal R (J k) \\<Longrightarrow>\n    ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)", "apply (simp add:n_prod_idealTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_la1:\"\\<lbrakk>ideal R I; ideal R J\\<rbrakk> \\<Longrightarrow> (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> I", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> \\<Inter>\n                       {L. ideal R L \\<and>\n                           {x. \\<exists>i\\<in>I.\n                                  \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                           \\<subseteq> L}\n                      \\<subseteq> I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        x \\<in> \\<Inter>\n                 {L. ideal R L \\<and>\n                     {x. \\<exists>i\\<in>I.\n                            \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                     \\<subseteq> L}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I", "apply (simp add:CollectI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I", "apply (subgoal_tac \"{x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x =  i \\<cdot>\\<^sub>r j} \\<subseteq> I\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I\n 2. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> I", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> I", "apply (thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>I. \\<exists>j\\<in>J. x =  i \\<cdot>\\<^sub>r j} \\<subseteq> xa\n                                                              \\<longrightarrow> x \\<in> xa\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>I.\n                                \\<exists>j\\<in>J. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> I", "apply (rule subsetI, simp add:CollectI,\n        (erule bexE)+, frule_tac h = j in ideal_subset[of \"J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa i j.\n       \\<lbrakk>ideal R I; ideal R J; i \\<in> I; j \\<in> J;\n        xa = i \\<cdot>\\<^sub>r j; j \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> I", "apply (simp add:ideal_ring_multiple1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_el1:\"\\<lbrakk>ideal R I; ideal R J; a \\<in> (I \\<diamondsuit>\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                           a \\<in> I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J;\n     a \\<in> I \\<diamondsuit>\\<^sub>r J\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (frule ideal_prod_la1 [of \"I\" \"J\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; a \\<in> I \\<diamondsuit>\\<^sub>r J;\n     I \\<diamondsuit>\\<^sub>r J \\<subseteq> I\\<rbrakk>\n    \\<Longrightarrow> a \\<in> I", "apply (rule subsetD, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_la2:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow> (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> J", "apply (subst ideal_prod_commute, assumption+,\n        rule ideal_prod_la1[of \"J\" \"I\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_sub_Int:\"\\<lbrakk>ideal R I; ideal R J \\<rbrakk> \\<Longrightarrow>\n                     (I \\<diamondsuit>\\<^sub>r J) \\<subseteq> I \\<inter> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J\\<rbrakk>\n    \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r J \\<subseteq> I \\<inter> J", "by (simp add:ideal_prod_la1 ideal_prod_la2)"], ["", "lemma (in Ring) ideal_prod_el2:\"\\<lbrakk>ideal R I; ideal R J; a \\<in> (I \\<diamondsuit>\\<^sub>r J)\\<rbrakk> \\<Longrightarrow>\n                                 a \\<in> J\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J;\n     a \\<in> I \\<diamondsuit>\\<^sub>r J\\<rbrakk>\n    \\<Longrightarrow> a \\<in> J", "by (frule ideal_prod_la2 [of \"I\" \"J\"], assumption+,\n       rule subsetD, assumption+)"], ["", "text\\<open>\\<open>i\\<Pi>\\<^bsub>R,n\\<^esub> J\\<close> is the product of ideals\\<close>"], ["", "lemma (in Ring) ele_n_prodTr0:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). ideal R (J k);\n             a \\<in> i\\<Pi>\\<^bsub>R,(Suc n)\\<^esub> J \\<rbrakk> \\<Longrightarrow> a \\<in> (i\\<Pi>\\<^bsub>R,n\\<^esub> J) \\<and> a \\<in> (J (Suc n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\\<rbrakk>\n    \\<Longrightarrow> a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n                      a \\<in> J (Suc n)", "apply (simp add:Nset_Suc[of n])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n             J (Suc n)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n                      a \\<in> J (Suc n)", "apply (cut_tac n_prod_ideal[of n J])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n);\n     ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n                      a \\<in> J (Suc n)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n             J (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>n. ideal R (J k)", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n);\n     ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n);\n     ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> J (Suc n)\n 3. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n             J (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>n. ideal R (J k)", "apply (rule ideal_prod_el1 [of \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" \"J (Suc n)\"], assumption, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n);\n     ideal R (i\\<Pi>\\<^bsub>R,n\\<^esub> J)\\<rbrakk>\n    \\<Longrightarrow> a \\<in> J (Suc n)\n 2. \\<lbrakk>\\<forall>k\\<le>Suc n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n             J (Suc n)\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>n. ideal R (J k)", "apply (rule ideal_prod_el2[of \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" \"J (Suc n)\"], assumption+, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ele_n_prodTr1:\n      \"(\\<forall>k \\<le> n. ideal R (J k)) \\<and> a \\<in> ideal_n_prod R n J \\<longrightarrow>\n                                             (\\<forall>k \\<le> n. a \\<in> (J k))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n    a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n    (\\<forall>k\\<le>n. a \\<in> J k)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>k\\<le>0. ideal R (J k)) \\<and>\n    a \\<in> i\\<Pi>\\<^bsub>R,0\\<^esub> J \\<longrightarrow>\n    (\\<forall>k\\<le>0. a \\<in> J k)\n 2. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>n. a \\<in> J k) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>Suc n. a \\<in> J k)", "(** n = 0 **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>k\\<le>0. ideal R (J k)) \\<and>\n    a \\<in> i\\<Pi>\\<^bsub>R,0\\<^esub> J \\<longrightarrow>\n    (\\<forall>k\\<le>0. a \\<in> J k)\n 2. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>n. a \\<in> J k) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>Suc n. a \\<in> J k)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>n. a \\<in> J k) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>Suc n. a \\<in> J k)", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>n. a \\<in> J k) \\<Longrightarrow>\n       (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n       a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J \\<longrightarrow>\n       (\\<forall>k\\<le>Suc n. a \\<in> J k)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>(\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n                a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\\<rbrakk>\n       \\<Longrightarrow> \\<forall>k\\<le>Suc n. a \\<in> J k", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>(\\<forall>k\\<le>n. ideal R (J k)) \\<and>\n                a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J;\n        k \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        (\\<forall>k\\<le>Suc n. ideal R (J k)) \\<and>\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        k \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        k \\<le> Suc n; \\<forall>k\\<le>Suc n. ideal R (J k);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (frule_tac n = n in ele_n_prodTr0[of _ J a])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        k \\<le> Suc n; \\<forall>k\\<le>Suc n. ideal R (J k);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n 2. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        k \\<le> Suc n; \\<forall>k\\<le>Suc n. ideal R (J k);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n        a \\<in> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        k \\<le> Suc n; \\<forall>k\\<le>Suc n. ideal R (J k);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<and>\n        a \\<in> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (erule conjE,\n        thin_tac \"\\<forall>k\\<le>Suc n. ideal R (J k)\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<longrightarrow>\n                (\\<forall>k\\<le>n. a \\<in> J k);\n        k \\<le> Suc n;\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J; a \\<in> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>\\<forall>k\\<le>n. a \\<in> J k; k \\<le> Suc n;\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J; a \\<in> J (Suc n)\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (case_tac \"k = Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>\\<forall>k\\<le>n. a \\<in> J k; k \\<le> Suc n;\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J; a \\<in> J (Suc n);\n        k \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (frule_tac m = k and n = \"Suc n\" in noteq_le_less, assumption+,\n        thin_tac \"k \\<le> Suc n\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n k.\n       \\<lbrakk>\\<forall>k\\<le>n. a \\<in> J k;\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r\n                J (Suc n);\n        a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J; a \\<in> J (Suc n);\n        k \\<noteq> Suc n; k < Suc n\\<rbrakk>\n       \\<Longrightarrow> a \\<in> J k", "apply (frule_tac x = k and n = \"Suc n\" in less_le_diff, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ele_n_prod:\"\\<lbrakk>\\<forall>k \\<le> n. ideal R (J k);\n                       a \\<in> ideal_n_prod R n J \\<rbrakk> \\<Longrightarrow>  \\<forall>k \\<le> n. a \\<in> (J k)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>n. ideal R (J k);\n     a \\<in> i\\<Pi>\\<^bsub>R,n\\<^esub> J\\<rbrakk>\n    \\<Longrightarrow> \\<forall>k\\<le>n. a \\<in> J k", "by (simp add: ele_n_prodTr1 [of \"n\" \"J\" \"a\"])"], ["", "lemma (in Ring) idealprod_whole_l:\"ideal R I \\<Longrightarrow> (carrier R) \\<diamondsuit>\\<^sub>r\\<^bsub>R\\<^esub> I = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> carrier R \\<diamondsuit>\\<^sub>r I = I", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    carrier R \\<diamondsuit>\\<^sub>r I \\<subseteq> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I;\n        x \\<in> carrier R \\<diamondsuit>\\<^sub>r I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>carrier R.\n                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (subgoal_tac \"{x. \\<exists>i\\<in>carrier R. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j} \\<subseteq> I\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>carrier R.\n                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> I\n 2. \\<And>x.\n       \\<lbrakk>ideal R I;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>carrier R.\n                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>carrier R.\n                                \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> I\n 3. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I;\n        \\<forall>xa.\n           ideal R xa \\<and>\n           {x. \\<exists>i\\<in>carrier R.\n                  \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n           \\<subseteq> xa \\<longrightarrow>\n           x \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> {x. \\<exists>i\\<in>carrier R.\n                                \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n                         \\<subseteq> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (thin_tac \"\\<forall>xa. ideal R xa \\<and> {x. \\<exists>i\\<in>carrier R. \\<exists>j\\<in>I.\n                       x = i \\<cdot>\\<^sub>r j} \\<subseteq> xa \\<longrightarrow> x \\<in> xa\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       ideal R I \\<Longrightarrow>\n       {x. \\<exists>i\\<in>carrier R.\n              \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n       \\<subseteq> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I;\n        xa \\<in> {x. \\<exists>i\\<in>carrier R.\n                        \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa.\n       \\<lbrakk>ideal R I;\n        \\<exists>i\\<in>carrier R.\n           \\<exists>j\\<in>I. xa = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply ((erule bexE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa i j.\n       \\<lbrakk>ideal R I; i \\<in> carrier R; j \\<in> I;\n        xa = i \\<cdot>\\<^sub>r j\\<rbrakk>\n       \\<Longrightarrow> i \\<cdot>\\<^sub>r j \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (thin_tac \"xa = i \\<cdot>\\<^sub>r j\", simp add:ideal_ring_multiple)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    I \\<subseteq> carrier R \\<diamondsuit>\\<^sub>r I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R \\<diamondsuit>\\<^sub>r I", "apply (simp add:ideal_prod_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            ideal R xa \\<and>\n                            {x. \\<exists>i\\<in>carrier R.\n                                   \\<exists>j\\<in>I.\nx = i \\<cdot>\\<^sub>r j}\n                            \\<subseteq> xa \\<longrightarrow>\n                            x \\<in> xa", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; x \\<in> I;\n        ideal R xa \\<and>\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; x \\<in> I; ideal R xa;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa", "apply (rename_tac xa X)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> X", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> X", "apply (frule_tac h = xa in ideal_subset[of \"I\"], assumption,\n        frule_tac x = xa in ring_l_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> X", "apply (subgoal_tac \"1\\<^sub>r \\<cdot>\\<^sub>r xa \\<in> {x. \\<exists>i\\<in>carrier R. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa\n        \\<in> {x. \\<exists>i\\<in>carrier R.\n                     \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> X\n 2. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r xa\n                         \\<in> {x. \\<exists>i\\<in>carrier R.\n\\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}", "apply (rule_tac c = xa and A = \"{x. \\<exists>i\\<in>carrier R. \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\" and\n         B = X in subsetD, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa\n        \\<in> {x. \\<exists>i\\<in>carrier R.\n                     \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> {x. \\<exists>i\\<in>carrier R.\n   \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n 2. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r xa\n                         \\<in> {x. \\<exists>i\\<in>carrier R.\n\\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<cdot>\\<^sub>r xa\n                         \\<in> {x. \\<exists>i\\<in>carrier R.\n\\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa X.\n       \\<lbrakk>ideal R I; xa \\<in> I; ideal R X;\n        {x. \\<exists>i\\<in>carrier R.\n               \\<exists>j\\<in>I. x = i \\<cdot>\\<^sub>r j}\n        \\<subseteq> X;\n        1\\<^sub>r \\<in> carrier R; xa \\<in> carrier R;\n        1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<in>carrier R.\n                            \\<exists>j\\<in>I. xa = i \\<cdot>\\<^sub>r j", "apply (frule sym, thin_tac \"1\\<^sub>r \\<cdot>\\<^sub>r xa = xa\", blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) idealprod_whole_r:\"ideal R I \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r (carrier R) = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r carrier R = I", "by (cut_tac whole_ideal,\n       simp add:ideal_prod_commute[of \"I\" \"carrier R\"],\n       simp add:idealprod_whole_l)"], ["", "lemma (in Ring) idealpow_1_self:\"ideal R I \\<Longrightarrow> I \\<^bsup>\\<diamondsuit>R (Suc 0)\\<^esup> = I\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<^bsup>\\<diamondsuit>R Suc 0\\<^esup> = I", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<diamondsuit>\\<^sub>r carrier R = I", "apply (simp add:idealprod_whole_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_pow_ideal:\"ideal R I \\<Longrightarrow> ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    ideal R (I \\<^bsup>\\<diamondsuit>R 0\\<^esup>)\n 2. \\<And>n.\n       \\<lbrakk>ideal R I;\n        ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> ideal R (I \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply (simp add:whole_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I;\n        ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> ideal R (I \\<^bsup>\\<diamondsuit>R Suc n\\<^esup>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R I;\n        ideal R (I \\<^bsup>\\<diamondsuit>R n\\<^esup>)\\<rbrakk>\n       \\<Longrightarrow> ideal R\n                          (I \\<diamondsuit>\\<^sub>r\n                           I \\<^bsup>\\<diamondsuit>R n\\<^esup>)", "apply (simp add:ideal_prod_ideal)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_prod_prime:\"\\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n                          I \\<diamondsuit>\\<^sub>r J \\<subseteq> P \\<rbrakk> \\<Longrightarrow> I \\<subseteq> P \\<or> J \\<subseteq> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n     I \\<diamondsuit>\\<^sub>r J \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> I \\<subseteq> P \\<or> J \\<subseteq> P", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n     I \\<diamondsuit>\\<^sub>r J \\<subseteq> P;\n     \\<not> I \\<subseteq> P \\<and> \\<not> J \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> False", "apply (erule conjE, simp add:subset_eq, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n        \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J. x \\<in> P; x \\<in> I;\n        x \\<notin> P; xa \\<in> J; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac i = x and j = xa in prod_mem_prod_ideals[of \"I\" \"J\"],\n          assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; ideal R J; prime_ideal R P;\n        \\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r J. x \\<in> P; x \\<in> I;\n        x \\<notin> P; xa \\<in> J; xa \\<notin> P;\n        x \\<cdot>\\<^sub>r xa \\<in> I \\<diamondsuit>\\<^sub>r J\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"x \\<cdot>\\<^sub>r xa\" in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>I \\<diamondsuit>\\<^sub>r\\<^bsub> R\\<^esub> J. x \\<in> P\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; ideal R J; prime_ideal R P; x \\<in> I;\n        x \\<notin> P; xa \\<in> J; xa \\<notin> P;\n        x \\<cdot>\\<^sub>r xa \\<in> I \\<diamondsuit>\\<^sub>r J;\n        x \\<cdot>\\<^sub>r xa \\<in> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add: prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R I; ideal R J; x \\<in> I; x \\<notin> P; xa \\<in> J;\n        xa \\<notin> P;\n        x \\<cdot>\\<^sub>r xa \\<in> I \\<diamondsuit>\\<^sub>r J;\n        x \\<cdot>\\<^sub>r xa \\<in> P; ideal R P; 1\\<^sub>r \\<notin> P;\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac h = x in ideal_subset, assumption,\n        frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier R. \\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\",\n        frule_tac h = xa in ideal_subset, assumption,\n        frule_tac x = xa in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\",\n        simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_n_prod_primeTr:\"prime_ideal R P \\<Longrightarrow>\n       (\\<forall>k \\<le> n. ideal R (J k)) \\<longrightarrow> (ideal_n_prod R n J \\<subseteq> P) \\<longrightarrow>\n                                               (\\<exists>i \\<le> n. (J i) \\<subseteq> P)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R P \\<Longrightarrow>\n    (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n    (\\<exists>i\\<le>n. J i \\<subseteq> P)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. prime_ideal R P \\<Longrightarrow>\n    (\\<forall>k\\<le>0. ideal R (J k)) \\<longrightarrow>\n    i\\<Pi>\\<^bsub>R,0\\<^esub> J \\<subseteq> P \\<longrightarrow>\n    (\\<exists>i\\<le>0. J i \\<subseteq> P)\n 2. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n.\n                             ideal R (J k)) \\<longrightarrow>\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n                         \\<subseteq> P \\<longrightarrow>\n                         (\\<exists>i\\<le>Suc n. J i \\<subseteq> P)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>k\\<le>Suc n.\n                             ideal R (J k)) \\<longrightarrow>\n                         i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n                         \\<subseteq> P \\<longrightarrow>\n                         (\\<exists>i\\<le>Suc n. J i \\<subseteq> P)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>k\\<le>n. ideal R (J k)) \\<longrightarrow>\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P);\n        \\<forall>k\\<le>Suc n. ideal R (J k)\\<rbrakk>\n       \\<Longrightarrow> i\\<Pi>\\<^bsub>R,Suc n\\<^esub> J\n                         \\<subseteq> P \\<longrightarrow>\n                         (\\<exists>i\\<le>Suc n. J i \\<subseteq> P)", "apply (rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P);\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. J i \\<subseteq> P", "apply (cut_tac I = \"i\\<Pi>\\<^bsub>R,n\\<^esub> J\" and J = \"J (Suc n)\" in\n                      ideal_prod_prime[of _ _ \"P\"],\n        rule_tac n = n and J = J in n_prod_ideal,\n         rule allI, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P);\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<or>\n        J (Suc n) \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. J i \\<subseteq> P", "apply (erule disjE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P; \\<exists>i\\<le>n. J i \\<subseteq> P;\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. J i \\<subseteq> P\n 2. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P);\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> P;\n        J (Suc n) \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. J i \\<subseteq> P", "apply (cut_tac n = n in Nsetn_sub_mem1,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P \\<longrightarrow>\n        (\\<exists>i\\<le>n. J i \\<subseteq> P);\n        \\<forall>k\\<le>Suc n. ideal R (J k);\n        i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<diamondsuit>\\<^sub>r J (Suc n)\n        \\<subseteq> P;\n        J (Suc n) \\<subseteq> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>i\\<le>Suc n. J i \\<subseteq> P", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_n_prod_prime:\"\\<lbrakk>prime_ideal R P;\n            \\<forall>k \\<le> n. ideal R (J k); ideal_n_prod R n J \\<subseteq> P\\<rbrakk> \\<Longrightarrow>\n                                            \\<exists>i \\<le> n. (J i) \\<subseteq> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; \\<forall>k\\<le>n. ideal R (J k);\n     i\\<Pi>\\<^bsub>R,n\\<^esub> J \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>i\\<le>n. J i \\<subseteq> P", "apply (simp add:ideal_n_prod_primeTr)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  ppa::\"[_, nat \\<Rightarrow> 'a set, 'a set, nat] \\<Rightarrow> (nat \\<Rightarrow> 'a)\" where\n  \"ppa R P A i l = (SOME x. x \\<in> A \\<and> x \\<in> (P (skip i l)) \\<and> x \\<notin> P i)\""], ["", "(** Note (ppa R P A) is used to prove prime_ideal_cont1,\n         some element x of A such that x \\<in> P j for (i \\<noteq> j) and x \\<notin> P i **)"], ["", "lemma (in Ring) prod_primeTr:\"\\<lbrakk>prime_ideal R P; ideal R A; \\<not> A \\<subseteq> P;\n                ideal R B; \\<not> B \\<subseteq> P \\<rbrakk> \\<Longrightarrow> \\<exists>x. x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; ideal R A; \\<not> A \\<subseteq> P; ideal R B;\n     \\<not> B \\<subseteq> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P", "apply (simp add:subset_eq)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; ideal R A; \\<exists>x\\<in>A. x \\<notin> P;\n     ideal R B; \\<exists>x\\<in>B. x \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x.\n                         x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P", "apply (erule bexE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P", "apply (subgoal_tac \"x \\<cdot>\\<^sub>r xa \\<in> A \\<and> x \\<cdot>\\<^sub>r xa \\<in> B \\<and> x \\<cdot>\\<^sub>r xa \\<notin> P\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P;\n        x \\<cdot>\\<^sub>r xa \\<in> A \\<and>\n        x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n        x \\<cdot>\\<^sub>r xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> \\<exists>x.\n                            x \\<in> A \\<and> x \\<in> B \\<and> x \\<notin> P\n 2. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> A \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<notin> P", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> A \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> A\n 2. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (rule ideal_ring_multiple1, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> carrier R\n 2. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> B \\<and>\n                         x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<in> B\n 2. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (rule ideal_ring_multiple, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x \\<cdot>\\<^sub>r xa \\<notin> P", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>prime_ideal R P; ideal R A; ideal R B; x \\<in> A;\n        x \\<notin> P; xa \\<in> B; xa \\<notin> P;\n        x \\<cdot>\\<^sub>r xa \\<in> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:prime_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> A; x \\<notin> P; xa \\<in> B;\n        xa \\<notin> P; x \\<cdot>\\<^sub>r xa \\<in> P; ideal R P;\n        1\\<^sub>r \\<notin> P;\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow>\n              x \\<in> P \\<or> y \\<in> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac h = x in ideal_subset[of \"A\"], assumption+,\n        frule_tac h = xa in ideal_subset[of \"B\"], assumption+,\n        frule_tac x = x in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier R. \\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\",\n        frule_tac x = xa in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> P \\<longrightarrow> x \\<in> P \\<or> y \\<in> P\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>ideal R A; ideal R B; x \\<in> A; x \\<notin> P; xa \\<in> B;\n        xa \\<notin> P; x \\<cdot>\\<^sub>r xa \\<in> P; ideal R P;\n        1\\<^sub>r \\<notin> P; x \\<in> carrier R; xa \\<in> carrier R;\n        x \\<cdot>\\<^sub>r xa \\<in> P \\<longrightarrow>\n        x \\<in> P \\<or> xa \\<in> P\\<rbrakk>\n       \\<Longrightarrow> False", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prod_primeTr1:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). prime_ideal R (P k);\n       ideal R A; \\<forall>l \\<le> (Suc n). \\<not> (A \\<subseteq> P l);\n       \\<forall>k \\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l); i \\<le> (Suc n)\\<rbrakk> \\<Longrightarrow>\n       \\<forall>l \\<le> n. ppa R P A i l \\<in> A \\<and>\n                  ppa R P A i l \\<in> (P (skip i l)) \\<and> ppa R P A i l \\<notin> (P i)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n     \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n     \\<forall>k\\<le>Suc n.\n        \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n     i \\<le> Suc n\\<rbrakk>\n    \\<Longrightarrow> \\<forall>l\\<le>n.\n                         ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n; l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (cut_tac i = i and l = l in skip_il_neq_i)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (rotate_tac 2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n        \\<forall>k\\<le>Suc n.\n           \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (frule_tac x = i in spec,\n             thin_tac \"\\<forall>l \\<le> (Suc n). \\<not> A \\<subseteq> P l\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>\\<forall>k\\<le>Suc n.\n                   \\<forall>l\\<le>Suc n.\n                      k = l \\<or> \\<not> P k \\<subseteq> P l;\n        i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (cut_tac l = l in skip_mem[of _ \"n\" \"i\"], simp,\n             frule_tac x = \"skip i l\" in spec,\n             thin_tac \"\\<forall>k \\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> P k \\<subseteq> P l\",\n             simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<forall>la\\<le>Suc n.\n           skip i l = la \\<or> \\<not> P (skip i l) \\<subseteq> P la\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (rotate_tac -1,\n            frule_tac x = i in spec,\n            thin_tac \"\\<forall>la \\<le> (Suc n). skip i l = la \\<or> \\<not> P (skip i l) \\<subseteq> P la\",\n            simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (cut_tac P = \"P i\" and A = A and B = \"P (skip i l)\" in prod_primeTr,\n       simp, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> ideal R (P (skip i l))\n 2. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i\\<rbrakk>\n       \\<Longrightarrow> \\<not> P (skip i l) \\<subseteq> P i\n 3. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i;\n        \\<exists>x.\n           x \\<in> A \\<and>\n           x \\<in> P (skip i l) \\<and> x \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (frule_tac x = \"skip i l\" in spec,\n        thin_tac \"\\<forall>k\\<le>Suc n. prime_ideal R (P k)\", simp,\n        rule prime_ideal_ideal, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i;\n        \\<exists>x.\n           x \\<in> A \\<and>\n           x \\<in> P (skip i l) \\<and> x \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> ppa R P A i l \\<in> A \\<and>\n                         ppa R P A i l \\<in> P (skip i l) \\<and>\n                         ppa R P A i l \\<notin> P i", "apply (simp add:ppa_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>l.\n       \\<lbrakk>i \\<le> Suc n; l \\<le> n; skip i l \\<noteq> i;\n        \\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n        \\<not> A \\<subseteq> P i; skip i l \\<le> Suc n;\n        \\<not> P (skip i l) \\<subseteq> P i;\n        \\<exists>x.\n           x \\<in> A \\<and>\n           x \\<in> P (skip i l) \\<and> x \\<notin> P i\\<rbrakk>\n       \\<Longrightarrow> (SOME x.\n                             x \\<in> A \\<and>\n                             x \\<in> P (skip i l) \\<and> x \\<notin> P i)\n                         \\<in> A \\<and>\n                         (SOME x.\n                             x \\<in> A \\<and>\n                             x \\<in> P (skip i l) \\<and> x \\<notin> P i)\n                         \\<in> P (skip i l) \\<and>\n                         (SOME x.\n                             x \\<in> A \\<and>\n                             x \\<in> P (skip i l) \\<and> x \\<notin> P i)\n                         \\<notin> P i", "apply (rule someI2_ex, assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ppa_mem:\"\\<lbrakk>\\<forall>k \\<le> (Suc n). prime_ideal R (P k); ideal R A;\n      \\<forall>l \\<le> (Suc n). \\<not> (A \\<subseteq> P l);\n      \\<forall>k \\<le> (Suc n). \\<forall>l \\<le> (Suc n). k = l \\<or> \\<not> (P k) \\<subseteq> (P l);\n      i  \\<le> (Suc n); l \\<le> n\\<rbrakk> \\<Longrightarrow> ppa R P A i l \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n     \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n     \\<forall>k\\<le>Suc n.\n        \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n     i \\<le> Suc n; l \\<le> n\\<rbrakk>\n    \\<Longrightarrow> ppa R P A i l \\<in> carrier R", "apply (frule_tac prod_primeTr1[of n P A], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n     \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n     \\<forall>k\\<le>Suc n.\n        \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n     i \\<le> Suc n; l \\<le> n;\n     \\<forall>l\\<le>n.\n        ppa R P A i l \\<in> A \\<and>\n        ppa R P A i l \\<in> P (skip i l) \\<and>\n        ppa R P A i l \\<notin> P i\\<rbrakk>\n    \\<Longrightarrow> ppa R P A i l \\<in> carrier R", "apply (rotate_tac -1, frule_tac x = l in spec,\n        thin_tac \"\\<forall>l\\<le>n. ppa R P A i l \\<in> A \\<and>\n           ppa R P A i l \\<in> P (skip i l) \\<and> ppa R P A i l \\<notin> P i\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>k\\<le>Suc n. prime_ideal R (P k); ideal R A;\n     \\<forall>l\\<le>Suc n. \\<not> A \\<subseteq> P l;\n     \\<forall>k\\<le>Suc n.\n        \\<forall>l\\<le>Suc n. k = l \\<or> \\<not> P k \\<subseteq> P l;\n     i \\<le> Suc n; l \\<le> n;\n     ppa R P A i l \\<in> A \\<and>\n     ppa R P A i l \\<in> P (skip i l) \\<and>\n     ppa R P A i l \\<notin> P i\\<rbrakk>\n    \\<Longrightarrow> ppa R P A i l \\<in> carrier R", "apply (simp add:ideal_subset)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsum_memrTr:\"(\\<forall>i \\<le> n. f i \\<in> carrier R) \\<longrightarrow>\n                             (\\<forall>l \\<le> n. nsum R f l \\<in> carrier R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow>\n    (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>0. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> carrier R) \\<longrightarrow>\n                         (\\<forall>l\\<le>Suc n.\n                             \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "(** n = 0 **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>0. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\n 2. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> carrier R) \\<longrightarrow>\n                         (\\<forall>l\\<le>Suc n.\n                             \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "apply (rule impI, rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>l.\n       \\<lbrakk>aGroup R; \\<forall>i\\<le>0. f i \\<in> carrier R;\n        l \\<le> 0\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f l \\<in> carrier R\n 2. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> carrier R) \\<longrightarrow>\n                         (\\<forall>l\\<le>Suc n.\n                             \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> carrier R) \\<longrightarrow>\n                         (\\<forall>l\\<le>Suc n.\n                             \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R)\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> carrier R) \\<longrightarrow>\n                         (\\<forall>l\\<le>Suc n.\n                             \\<Sigma>\\<^sub>e R f l \\<in> carrier R)", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<le>Suc n.\n                            \\<Sigma>\\<^sub>e R f l \\<in> carrier R", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f l \\<in> carrier R", "apply (rule aGroup.nsum_mem, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>aGroup R;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n        (\\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<forall>j\\<le>l. f j \\<in> carrier R", "apply (rule allI, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsum_memr:\"\\<forall>i \\<le> n. f i \\<in> carrier R \\<Longrightarrow>\n                          \\<forall>l \\<le> n. nsum R f l \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<forall>i\\<le>n. f i \\<in> carrier R \\<Longrightarrow>\n    \\<forall>l\\<le>n. \\<Sigma>\\<^sub>e R f l \\<in> carrier R", "by (simp add:nsum_memrTr)"], ["", "lemma (in Ring) nsum_ideal_incTr:\"ideal R A \\<Longrightarrow>\n               (\\<forall>i \\<le> n. f i \\<in> A) \\<longrightarrow>  nsum R f n \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f n \\<in> A", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> A", "apply (rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>0. f i \\<in> A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f 0 \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> A", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n.\n                             f i \\<in> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<in> A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; \\<Sigma>\\<^sub>e R f n \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> A", "apply (rule ideal_pOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A; \\<Sigma>\\<^sub>e R f n \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> A", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsum_ideal_inc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> A\\<rbrakk> \\<Longrightarrow>\n                    nsum R f n \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. f i \\<in> A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> A", "by (simp add:nsum_ideal_incTr)"], ["", "lemma (in Ring) nsum_ideal_excTr:\"ideal R A \\<Longrightarrow>\n      (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and> (\\<exists>j \\<le> n. (\\<forall>l \\<in> {i. i \\<le> n} -{j}. f l \\<in> A)\n       \\<and> (f j \\<notin> A)) \\<longrightarrow> nsum R f n \\<notin> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n    (\\<exists>j\\<le>n.\n        (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f n \\<notin> A", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<exists>j\\<le>0.\n        (\\<forall>l\\<in>{i. i \\<le> 0} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f 0 \\<notin> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>j\\<le>Suc n.\n                             (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}.\n                                 f l \\<in> A) \\<and>\n                             f j \\<notin> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "(** n = 0 **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<exists>j\\<le>0.\n        (\\<forall>l\\<in>{i. i \\<le> 0} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A) \\<longrightarrow>\n    \\<Sigma>\\<^sub>e R f 0 \\<notin> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>j\\<le>Suc n.\n                             (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}.\n                                 f l \\<in> A) \\<and>\n                             f j \\<notin> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>j\\<le>Suc n.\n                             (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}.\n                                 f l \\<in> A) \\<and>\n                             f j \\<notin> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>j\\<le>Suc n.\n                             (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}.\n                                 f l \\<in> A) \\<and>\n                             f j \\<notin> A) \\<longrightarrow>\n                         \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>Suc n.\n            (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A)\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        \\<exists>j\\<le>Suc n.\n           (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n           f j \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (case_tac \"j = Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n. f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {Suc n}. f l \\<in> A) \\<and>\n        f (Suc n) \\<notin> A;\n        j = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (\n       thin_tac \"(\\<exists>j\\<le>n. f j \\<notin> A) \\<longrightarrow> \\<Sigma>\\<^sub>e R f n \\<notin> A\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {Suc n}. f l \\<in> A) \\<and>\n        f (Suc n) \\<notin> A;\n        j = Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j = Suc n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {Suc n}. f l \\<in> A;\n        f (Suc n) \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (cut_tac n = n and f = f in nsum_ideal_inc[of A], assumption,\n        rule allI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j = Suc n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {Suc n}. f l \\<in> A;\n        f (Suc n) \\<notin> A; \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j = Suc n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {Suc n}. f l \\<in> A;\n        f (Suc n) \\<notin> A; \\<Sigma>\\<^sub>e R f n \\<in> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (frule_tac a = \"\\<Sigma>\\<^sub>e R f n\" and b = \"f (Suc n)\" in\n                   ideal_ele_sumTr1[of A],\n        simp add:ideal_subset, simp, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> Suc n \\<and>\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f Suc n \\<notin> A", "apply (erule conjE,\n       frule_tac m = j and n = \"Suc n\" in noteq_le_less, assumption,\n       frule_tac x = j and n = \"Suc n\" in less_le_diff,\n       thin_tac \"j \\<le> Suc n\", thin_tac \"j < Suc n\", simp,\n       cut_tac n = n in Nsetn_sub_mem1, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        (\\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A;\n        j \\<le> n\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A", "apply (erule conjE,\n       frule_tac x = \"Suc n\" in bspec, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A; f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<notin> A", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = \"\\<Sigma>\\<^sub>e R f n\" and b = \"f (Suc n)\" in\n                   ideal_ele_sumTr2[of A])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<in> carrier R\n 2. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R\n 3. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n)\n                         \\<in> A\n 4. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> A\n 5. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A;\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_is_ag,\n        rule_tac n = n in aGroup.nsum_mem[of R _ f], assumption+,\n        rule allI, simp, simp, assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A;\n        (\\<exists>j\\<le>n.\n            (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n            f j \\<notin> A) \\<longrightarrow>\n        \\<Sigma>\\<^sub>e R f n \\<notin> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; j \\<le> n;\n        \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A;\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"\\<exists>j\\<le>n. (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and> f j \\<notin> A\",\n        simp,\n        thin_tac \"(\\<exists>j\\<le>n. (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and> f j \\<notin> A)\n                     \\<longrightarrow> \\<Sigma>\\<^sub>e R f n \\<notin> A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A;\n        \\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A;\n        \\<Sigma>\\<^sub>e R f n \\<in> A\\<rbrakk>\n       \\<Longrightarrow> \\<exists>j\\<le>n.\n                            (\\<forall>l\\<in>{i. i \\<le> n} - {j}.\n                                f l \\<in> A) \\<and>\n                            f j \\<notin> A", "apply (subgoal_tac \"\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A\", blast,\n        thin_tac \"\\<Sigma>\\<^sub>e R f n \\<plusminus> f (Suc n) \\<in> A\",\n        thin_tac \"\\<Sigma>\\<^sub>e R f n \\<in> A\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A\\<rbrakk>\n       \\<Longrightarrow> \\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n j l.\n       \\<lbrakk>ideal R A; \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        j \\<le> n; \\<forall>l\\<in>{i. i \\<le> Suc n} - {j}. f l \\<in> A;\n        f j \\<notin> A; l \\<in> {i. i \\<le> n} - {j}\\<rbrakk>\n       \\<Longrightarrow> f l \\<in> A", "apply (frule_tac x = l in bspec, simp, assumption)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nsum_ideal_exc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> carrier R;\n      \\<exists>j \\<le> n. (\\<forall>l\\<in>{i. i \\<le> n} -{j}. f l \\<in> A) \\<and> (f j \\<notin> A) \\<rbrakk> \\<Longrightarrow> nsum R f n \\<notin> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. f i \\<in> carrier R;\n     \\<exists>j\\<le>n.\n        (\\<forall>l\\<in>{i. i \\<le> n} - {j}. f l \\<in> A) \\<and>\n        f j \\<notin> A\\<rbrakk>\n    \\<Longrightarrow> \\<Sigma>\\<^sub>e R f n \\<notin> A", "by (simp add:nsum_ideal_excTr)"], ["", "lemma (in Ring) nprod_memTr:\"(\\<forall>i \\<le> n. f i \\<in> carrier R) \\<longrightarrow>\n                             (\\<forall>l. l \\<le> n \\<longrightarrow>  nprod R f l \\<in> carrier R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>n. e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R)", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<longrightarrow>\n    (\\<forall>l\\<le>0. e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R)\n 2. \\<And>n.\n       (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n       (\\<forall>l\\<le>n.\n           e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R) \\<Longrightarrow>\n       (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<longrightarrow>\n       (\\<forall>l\\<le>Suc n. e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R)", "apply (rule impI, rule allI, rule impI, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n       (\\<forall>l\\<le>n.\n           e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R) \\<Longrightarrow>\n       (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<longrightarrow>\n       (\\<forall>l\\<le>Suc n. e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R)", "apply (rule impI, rule allI, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "apply (case_tac \"l \\<le> n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R\n 2. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        \\<not> l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "apply (cut_tac n = n in Nset_Suc, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        \\<not> l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "apply (cut_tac m = l and n = \"Suc n\" in Nat.le_antisym, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        \\<not> l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> Suc n \\<le> l\n 2. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        \\<not> l \\<le> n; l = Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "apply (simp add: not_less)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>(\\<forall>i\\<le>n. f i \\<in> carrier R) \\<longrightarrow>\n                (\\<forall>l\\<le>n.\n                    e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R);\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<le> Suc n;\n        \\<not> l \\<le> n; l = Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n.\n                   e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l = Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> carrier R", "apply (rule ring_tOp_closed, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>\\<forall>l\\<le>n.\n                   e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l = Suc n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R", "apply (cut_tac n = n in Nset_Suc, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nprod_mem:\"\\<lbrakk>\\<forall>i \\<le> n. f i \\<in> carrier R; l \\<le> n\\<rbrakk> \\<Longrightarrow>\n                              nprod R f l \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>i\\<le>n. f i \\<in> carrier R; l \\<le> n\\<rbrakk>\n    \\<Longrightarrow> e\\<Pi>\\<^bsub>R,l\\<^esub> f \\<in> carrier R", "by (simp add:nprod_memTr)"], ["", "lemma (in Ring) ideal_nprod_incTr:\"ideal R A \\<Longrightarrow>\n                (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and>\n                             (\\<exists>l \\<le> n. f l \\<in> A) \\<longrightarrow> nprod R f n \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n    (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<exists>l\\<le>0. f l \\<in> A) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,0\\<^esub> f \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>l\\<le>Suc n.\n                             f l \\<in> A) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "(** n = 0 **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R A \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<exists>l\\<le>0. f l \\<in> A) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,0\\<^esub> f \\<in> A\n 2. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>l\\<le>Suc n.\n                             f l \\<in> A) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>l\\<le>Suc n.\n                             f l \\<in> A) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<exists>l\\<le>Suc n.\n                             f l \\<in> A) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>Suc n. f l \\<in> A)\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        \\<exists>l\\<le>Suc n. f l \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<in> A", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        \\<exists>l\\<le>Suc n. f l \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        l \\<le> Suc n \\<and> f l \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (case_tac \"l = Suc n\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f (Suc n) \\<in> A;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A\n 2. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        l \\<le> Suc n \\<and> f l \\<in> A; l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (rule_tac x = \"f (Suc n)\" and r = \"nprod R f n\" in\n                 ideal_ring_multiple[of \"A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f (Suc n) \\<in> A;\n        l = Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> carrier R\n 2. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        l \\<le> Suc n \\<and> f l \\<in> A; l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (rule_tac n = \"Suc n\" and f = f and l = n in nprod_mem,\n                 assumption+, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        l \\<le> Suc n \\<and> f l \\<in> A; l \\<noteq> Suc n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; l \\<noteq> Suc n;\n        l \\<le> Suc n; f l \\<in> A\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (frule_tac m = l and n = \"Suc n\" in noteq_le_less, assumption,\n       frule_tac x = l and n = \"Suc n\" in less_le_diff,\n       thin_tac \"l \\<le> Suc n\", thin_tac \"l < Suc n\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f l \\<in> A;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<in> A", "apply (rule_tac x = \"nprod R f n\" and r = \"f (Suc n)\" in\n                      ideal_ring_multiple1[of \"A\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f l \\<in> A;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A\n 2. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f l \\<in> A;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n l.\n       \\<lbrakk>ideal R A;\n        (\\<exists>l\\<le>n. f l \\<in> A) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R; f l \\<in> A;\n        l \\<le> n\\<rbrakk>\n       \\<Longrightarrow> f (Suc n) \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_nprod_inc:\"\\<lbrakk>ideal R A; \\<forall>i \\<le> n. f i \\<in> carrier R;\n                \\<exists>l \\<le> n. f l \\<in> A\\<rbrakk> \\<Longrightarrow> nprod R f n \\<in> A\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R A; \\<forall>i\\<le>n. f i \\<in> carrier R;\n     \\<exists>l\\<le>n. f l \\<in> A\\<rbrakk>\n    \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<in> A", "by (simp add:ideal_nprod_incTr)"], ["", "lemma (in Ring) nprod_excTr:\"prime_ideal R P \\<Longrightarrow>\n          (\\<forall>i \\<le> n. f i \\<in> carrier R) \\<and> (\\<forall>l \\<le> n. f l \\<notin> P) \\<longrightarrow>\n                                                     nprod R f n \\<notin> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. prime_ideal R P \\<Longrightarrow>\n    (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n    (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. prime_ideal R P \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<forall>l\\<le>0. f l \\<notin> P) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,0\\<^esub> f \\<notin> P\n 2. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             f l \\<notin> P) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "(** n = 0 **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. prime_ideal R P \\<Longrightarrow>\n    (\\<forall>i\\<le>0. f i \\<in> carrier R) \\<and>\n    (\\<forall>l\\<le>0. f l \\<notin> P) \\<longrightarrow>\n    e\\<Pi>\\<^bsub>R,0\\<^esub> f \\<notin> P\n 2. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             f l \\<notin> P) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             f l \\<notin> P) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "(* n = 0 done *)\n(** n **)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n                         (\\<forall>l\\<le>Suc n.\n                             f l \\<notin> P) \\<longrightarrow>\n                         e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "apply (rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P;\n        (\\<forall>i\\<le>Suc n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>Suc n. f l \\<notin> P)\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P;\n        (\\<forall>i\\<le>n. f i \\<in> carrier R) \\<and>\n        (\\<forall>l\\<le>n. f l \\<notin> P) \\<longrightarrow>\n        e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        \\<forall>l\\<le>Suc n. f l \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,Suc n\\<^esub> f \\<notin> P", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P; e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P;\n        \\<forall>i\\<le>Suc n. f i \\<in> carrier R;\n        \\<forall>l\\<le>Suc n. f l \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<cdot>\\<^sub>r\n                         f (Suc n)\n                         \\<notin> P", "apply (rule_tac y = \"f (Suc n)\" and x = \"nprod R f n\" in\n          prime_elems_mult_not[of \"P\"], assumption,\n         rule_tac n = n in  nprod_mem, rule allI, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) prime_nprod_exc:\"\\<lbrakk>prime_ideal R P; \\<forall>i \\<le> n. f i \\<in> carrier R;\n                \\<forall>l \\<le> n. f l \\<notin> P\\<rbrakk> \\<Longrightarrow> nprod R f n \\<notin> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; \\<forall>i\\<le>n. f i \\<in> carrier R;\n     \\<forall>l\\<le>n. f l \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> e\\<Pi>\\<^bsub>R,n\\<^esub> f \\<notin> P", "by (simp add:nprod_excTr)"], ["", "definition\n  nilrad :: \"_ \\<Rightarrow> 'a set\" where\n  \"nilrad R = {x. x \\<in> carrier R \\<and> nilpotent R x}\""], ["", "lemma (in Ring) id_nilrad_ideal:\"ideal R (nilrad R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R (nilrad R)", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow> ideal R (nilrad R)", "apply (rule ideal_condition1[of \"nilrad R\"])"], ["proof (prove)\ngoal (4 subgoals):\n 1. aGroup R \\<Longrightarrow> nilrad R \\<subseteq> carrier R\n 2. aGroup R \\<Longrightarrow> nilrad R \\<noteq> {}\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 4. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (rule subsetI)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>aGroup R; x \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 2. aGroup R \\<Longrightarrow> nilrad R \\<noteq> {}\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 4. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:nilrad_def CollectI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. aGroup R \\<Longrightarrow> nilrad R \\<noteq> {}\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:nilrad_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. aGroup R \\<Longrightarrow>\n    \\<exists>x. x \\<in> carrier R \\<and> nilpotent R x\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (cut_tac ring_zero)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> nilpotent R x\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (subgoal_tac \"nilpotent R \\<zero>\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>aGroup R; \\<zero> \\<in> carrier R; nilpotent R \\<zero>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>x. x \\<in> carrier R \\<and> nilpotent R x\n 2. \\<lbrakk>aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> nilpotent R \\<zero>\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 4. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply blast"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> nilpotent R \\<zero>\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:nilpotent_def)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>aGroup R; \\<zero> \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> \\<exists>n. \\<zero>^\\<^bsup>R n\\<^esup> = \\<zero>\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 3. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (frule np_1[of \"\\<zero>\"], blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. aGroup R \\<Longrightarrow>\n    \\<forall>x\\<in>nilrad R.\n       \\<forall>y\\<in>nilrad R. x \\<plusminus> y \\<in> nilrad R\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (rule ballI)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup R; x \\<in> nilrad R; y \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> nilrad R\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:nilrad_def nilpotent_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y.\n       \\<lbrakk>aGroup R; x \\<in> carrier R;\n        \\<exists>n. x^\\<^bsup>R n\\<^esup> = \\<zero>; y \\<in> carrier R;\n        \\<exists>n. y^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> carrier R \\<and>\n                         (\\<exists>n.\n                             (x \\<plusminus> y)^\\<^bsup>R n\\<^esup> =\n                             \\<zero>)\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (erule exE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n na.\n       \\<lbrakk>aGroup R; x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>;\n        y^\\<^bsup>R na\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x \\<plusminus> y \\<in> carrier R \\<and>\n                         (\\<exists>n.\n                             (x \\<plusminus> y)^\\<^bsup>R n\\<^esup> =\n                             \\<zero>)\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:aGroup.ag_pOp_closed[of \"R\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y n na.\n       \\<lbrakk>aGroup R; x \\<in> carrier R; y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>;\n        y^\\<^bsup>R na\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            (x \\<plusminus> y)^\\<^bsup>R n\\<^esup> = \\<zero>\n 2. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (frule_tac x = x and y = y and m = n and n = na in npAdd,\n        assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. aGroup R \\<Longrightarrow>\n    \\<forall>r\\<in>carrier R.\n       \\<forall>x\\<in>nilrad R. r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (rule ballI)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x.\n       \\<lbrakk>aGroup R; r \\<in> carrier R; x \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> nilrad R", "apply (simp add:nilrad_def nilpotent_def, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x n.\n       \\<lbrakk>aGroup R; r \\<in> carrier R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> r \\<cdot>\\<^sub>r x \\<in> carrier R \\<and>\n                         (\\<exists>n.\n                             (r \\<cdot>\\<^sub>r x)^\\<^bsup>R n\\<^esup> =\n                             \\<zero>)", "apply (simp add:ring_tOp_closed,\n        frule_tac x = r and y = x and n = n in npMul, assumption+,\n           simp,\n        frule_tac x = r and n = n in npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r x n.\n       \\<lbrakk>aGroup R; r \\<in> carrier R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>;\n        (r \\<cdot>\\<^sub>r x)^\\<^bsup>R n\\<^esup> =\n        r^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r \\<zero>;\n        r^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            (r \\<cdot>\\<^sub>r x)^\\<^bsup>R n\\<^esup> =\n                            \\<zero>", "apply (simp add:ring_times_x_0, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  rad_ideal :: \"[_, 'a set ] \\<Rightarrow> 'a set\" where\n  \"rad_ideal R I = {a. a \\<in> carrier R \\<and> nilpotent (qring R I) ((pj R I) a)}\""], ["", "lemma (in Ring) id_rad_invim:\"ideal R I \\<Longrightarrow>\n       rad_ideal R I = (rInvim R (qring R I) (pj R I ) (nilrad (qring R I)))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    rad_ideal R I =\n    rInvim R (R /\\<^sub>r I) (pj R I) (nilrad (R /\\<^sub>r I))", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rad_ideal R I =\n                      rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rad_ideal R I\n                      \\<subseteq> rInvim R (R /\\<^sub>r I) (pj R I)\n                                   (nilrad (R /\\<^sub>r I))\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> rad_ideal R I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rInvim R (R /\\<^sub>r I) (pj R I)\n                                  (nilrad (R /\\<^sub>r I))\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (simp add:rad_ideal_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R;\n        x \\<in> carrier R \\<and>\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rInvim R (R /\\<^sub>r I) (pj R I)\n                                  (nilrad (R /\\<^sub>r I))\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (erule conjE)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rInvim R (R /\\<^sub>r I) (pj R I)\n                                  (nilrad (R /\\<^sub>r I))\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (simp add:rInvim_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> nilrad (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (simp add:nilrad_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> pj R I x \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (subst pj_mem, rule Ring_axioms)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> ideal R I\n 2. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R\n 3. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> I\n                         \\<in> carrier (R /\\<^sub>r I)\n 4. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply assumption+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> I\n                         \\<in> carrier (R /\\<^sub>r I)\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (simp add:qring_def ar_coset_def set_rcs_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent\n         \\<lparr>carrier =\n                   {C. \\<exists>a\\<in>carrier (b_ag R).\n                          C = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a},\n            pop = c_top (b_ag R) I, mop = c_iop (b_ag R) I, zero = I,\n            tp = rcostOp R I,\n            un = I \\<bullet>\\<^bsub>b_ag R\\<^esub> 1\\<^sub>r\\<rparr>\n         (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier (b_ag R).\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> x =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (simp add:aGroup.ag_carrier_carrier)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R; x \\<in> carrier R;\n        nilpotent\n         \\<lparr>carrier =\n                   {C. \\<exists>a\\<in>carrier R.\n                          C = I \\<bullet>\\<^bsub>b_ag R\\<^esub> a},\n            pop = c_top (b_ag R) I, mop = c_iop (b_ag R) I, zero = I,\n            tp = rcostOp R I,\n            un = I \\<bullet>\\<^bsub>b_ag R\\<^esub> 1\\<^sub>r\\<rparr>\n         (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>a\\<in>carrier R.\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> x =\n                            I \\<bullet>\\<^bsub>b_ag R\\<^esub> a\n 2. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>ideal R I; aGroup R\\<rbrakk>\n    \\<Longrightarrow> rInvim R (R /\\<^sub>r I) (pj R I)\n                       (nilrad (R /\\<^sub>r I))\n                      \\<subseteq> rad_ideal R I", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R;\n        x \\<in> rInvim R (R /\\<^sub>r I) (pj R I)\n                 (nilrad (R /\\<^sub>r I))\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rad_ideal R I", "apply (simp add:rInvim_def nilrad_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; aGroup R;\n        x \\<in> carrier R \\<and>\n        pj R I x \\<in> carrier (R /\\<^sub>r I) \\<and>\n        nilpotent (R /\\<^sub>r I) (pj R I x)\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rad_ideal R I", "apply (simp add: rad_ideal_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) id_rad_ideal:\"ideal R I \\<Longrightarrow> ideal R (rad_ideal R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> ideal R (rad_ideal R I)", "(* thm invim_of_ideal *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> ideal R (rad_ideal R I)", "apply (subst id_rad_invim [of \"I\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    ideal R (rInvim R (R /\\<^sub>r I) (pj R I) (nilrad (R /\\<^sub>r I)))", "apply (rule invim_of_ideal, rule Ring_axioms, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    ideal (R /\\<^sub>r I) (nilrad (R /\\<^sub>r I))", "apply (rule Ring.id_nilrad_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> Ring (R /\\<^sub>r I)", "apply (simp add:qring_ring)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) id_rad_cont_I:\"ideal R I \\<Longrightarrow> I \\<subseteq> (rad_ideal R I)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow> I \\<subseteq> rad_ideal R I", "apply (simp add:rad_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    I \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (rule subsetI, simp,\n       simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> nilpotent (R /\\<^sub>r I) (pj R I x)", "apply (simp add:nilpotent_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            pj R I x^\\<^bsup>R /\\<^sub>r I n\\<^esup> =\n                            \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (subst pj_mem, rule Ring_axioms, assumption+,\n       simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            (x \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                              I n\\<^esup> =\n                            \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "(* thm npQring *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            (x \\<uplus>\\<^bsub>R\\<^esub> I)^\\<^bsup>R /\\<^sub>r\n                              I n\\<^esup> =\n                            \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (frule_tac h = x in ideal_subset[of \"I\"], assumption,\n        frule_tac a = x in npQring[OF Ring, of \"I\" _ \"Suc 0\"], assumption,\n        simp only:np_1, simp only:Qring_fix1,\n        subst qring_zero[of \"I\"], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I; x \\<in> I; x \\<in> carrier R;\n        I^\\<^bsup>R /\\<^sub>r I Suc 0\\<^esup> = I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. I^\\<^bsup>R /\\<^sub>r I n\\<^esup> = I", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) id_rad_set:\"ideal R I \\<Longrightarrow>\n       rad_ideal R I = {x. x \\<in> carrier R \\<and> (\\<exists>n. npow R x n \\<in> I)}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    rad_ideal R I =\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}", "apply (simp add:rad_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)} =\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. ideal R I \\<Longrightarrow>\n    {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}\n    \\<subseteq> {x \\<in> carrier R.\n                 \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>ideal R I;\n        x \\<in> {a \\<in> carrier R.\n                 nilpotent (R /\\<^sub>r I) (pj R I a)}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {x \\<in> carrier R.\n                                  \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (simp add:nilpotent_def, erule conjE, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        pj R I x^\\<^bsup>R /\\<^sub>r I n\\<^esup> =\n        \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (simp add: pj_mem[OF Ring], simp add:npQring[OF Ring])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I =\n        \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply ( simp add:qring_zero)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (frule_tac x = x and n = n in npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I = I;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I\n 2. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (frule_tac a = \"x^\\<^bsup>R n\\<^esup>\" in ar_coset_same3[of \"I\"], assumption+,\n        blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. ideal R I \\<Longrightarrow>\n    {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> I}\n    \\<subseteq> {a \\<in> carrier R. nilpotent (R /\\<^sub>r I) (pj R I a)}", "apply (rule subsetI, simp, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> I\\<rbrakk>\n       \\<Longrightarrow> nilpotent (R /\\<^sub>r I) (pj R I x)", "apply (simp add:nilpotent_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            pj R I x^\\<^bsup>R /\\<^sub>r I n\\<^esup> =\n                            \\<zero>\\<^bsub>R /\\<^sub>r I\\<^esub>", "apply (simp add: pj_mem[OF Ring], simp add:npQring[OF Ring],\n                                            simp add:qring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I", "apply (frule_tac a = \"x^\\<^bsup>R n\\<^esup>\" in ar_coset_same4[of \"I\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x n.\n       \\<lbrakk>ideal R I; x \\<in> carrier R; x^\\<^bsup>R n\\<^esup> \\<in> I;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I = I\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n.\n                            x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> I =\n                            I", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) rad_primary_prime:\"primary_ideal R q \\<Longrightarrow>\n                                    prime_ideal R (rad_ideal R q)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. primary_ideal R q \\<Longrightarrow> prime_ideal R (rad_ideal R q)", "apply (simp add:prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. primary_ideal R q \\<Longrightarrow>\n    ideal R (rad_ideal R q) \\<and>\n    1\\<^sub>r \\<notin> rad_ideal R q \\<and>\n    (\\<forall>x\\<in>carrier R.\n        \\<forall>y\\<in>carrier R.\n           x \\<cdot>\\<^sub>r y \\<in> rad_ideal R q \\<longrightarrow>\n           x \\<in> rad_ideal R q \\<or> y \\<in> rad_ideal R q)", "apply (frule primary_ideal_ideal[of \"q\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> ideal R (rad_ideal R q) \\<and>\n                      1\\<^sub>r \\<notin> rad_ideal R q \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> rad_ideal R q \\<longrightarrow>\n                             x \\<in> rad_ideal R q \\<or>\n                             y \\<in> rad_ideal R q)", "apply (simp add:id_rad_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> rad_ideal R q \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y\n                             \\<in> rad_ideal R q \\<longrightarrow>\n                             x \\<in> rad_ideal R q \\<or>\n                             y \\<in> rad_ideal R q)", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> rad_ideal R q\n 2. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> rad_ideal R q \\<longrightarrow>\n                            x \\<in> rad_ideal R q \\<or>\n                            y \\<in> rad_ideal R q", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>primary_ideal R q; ideal R q;\n     1\\<^sub>r \\<in> rad_ideal R q\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> rad_ideal R q \\<longrightarrow>\n                            x \\<in> rad_ideal R q \\<or>\n                            y \\<in> rad_ideal R q", "apply (simp add:id_rad_set, erule conjE, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>primary_ideal R q; ideal R q; 1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r^\\<^bsup>R n\\<^esup> \\<in> q\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> rad_ideal R q \\<longrightarrow>\n                            x \\<in> rad_ideal R q \\<or>\n                            y \\<in> rad_ideal R q", "apply (simp add:npOne)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>primary_ideal R q; ideal R q; 1\\<^sub>r \\<in> carrier R;\n     1\\<^sub>r \\<in> q\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> rad_ideal R q \\<longrightarrow>\n                            x \\<in> rad_ideal R q \\<or>\n                            y \\<in> rad_ideal R q", "apply (simp add:primary_ideal_proper1[of \"q\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>primary_ideal R q; ideal R q\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y\n                            \\<in> rad_ideal R q \\<longrightarrow>\n                            x \\<in> rad_ideal R q \\<or>\n                            y \\<in> rad_ideal R q", "apply ((rule ballI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>primary_ideal R q; ideal R q; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> rad_ideal R q\\<rbrakk>\n       \\<Longrightarrow> x \\<in> rad_ideal R q \\<or> y \\<in> rad_ideal R q", "apply (rule contrapos_pp, simp+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>primary_ideal R q; ideal R q; x \\<in> carrier R;\n        y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> rad_ideal R q;\n        x \\<notin> rad_ideal R q; y \\<notin> rad_ideal R q\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:id_rad_set, erule conjE, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n.\n       \\<lbrakk>primary_ideal R q; ideal R q; x \\<in> carrier R;\n        y \\<in> carrier R; \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> q;\n        \\<forall>n. y^\\<^bsup>R n\\<^esup> \\<notin> q;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        (x \\<cdot>\\<^sub>r y)^\\<^bsup>R n\\<^esup> \\<in> q\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:npMul)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n.\n       \\<lbrakk>primary_ideal R q; ideal R q; x \\<in> carrier R;\n        y \\<in> carrier R; \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> q;\n        \\<forall>n. y^\\<^bsup>R n\\<^esup> \\<notin> q;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R n\\<^esup>\n        \\<in> q\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:primary_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n.\n       \\<lbrakk>ideal R q; x \\<in> carrier R; y \\<in> carrier R;\n        \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> q;\n        \\<forall>n. y^\\<^bsup>R n\\<^esup> \\<notin> q;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R n\\<^esup> \\<in> q;\n        1\\<^sub>r \\<notin> q;\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              x \\<cdot>\\<^sub>r y \\<in> q \\<longrightarrow>\n              (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> q) \\<or>\n              y \\<in> q\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = x and n = n in npClose,\n        frule_tac x = y and n = n in npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n.\n       \\<lbrakk>ideal R q; x \\<in> carrier R; y \\<in> carrier R;\n        \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> q;\n        \\<forall>n. y^\\<^bsup>R n\\<^esup> \\<notin> q;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R n\\<^esup> \\<in> q;\n        1\\<^sub>r \\<notin> q;\n        \\<forall>x\\<in>carrier R.\n           \\<forall>y\\<in>carrier R.\n              x \\<cdot>\\<^sub>r y \\<in> q \\<longrightarrow>\n              (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> q) \\<or> y \\<in> q;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        y^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"x^\\<^bsup>R n\\<^esup>\" in bspec, assumption,\n        thin_tac \"\\<forall>x\\<in>carrier R. \\<forall>y\\<in>carrier R. x \\<cdot>\\<^sub>r y \\<in> q \\<longrightarrow>\n                                    (\\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> q) \\<or> y \\<in> q\",\n        frule_tac x = \"y^\\<^bsup>R n\\<^esup>\" in bspec, assumption,\n        thin_tac \"\\<forall>y\\<in>carrier R. x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r y \\<in> q \\<longrightarrow>\n                             (\\<exists>na. x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> \\<in> q) \\<or> y \\<in> q\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y n.\n       \\<lbrakk>ideal R q; x \\<in> carrier R; y \\<in> carrier R;\n        \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> q;\n        \\<forall>n. y^\\<^bsup>R n\\<^esup> \\<notin> q;\n        x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r y^\\<^bsup>R n\\<^esup> \\<in> q;\n        1\\<^sub>r \\<notin> q; x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        y^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        \\<exists>na.\n           x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> \\<in> q\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:npMulExp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npow_notin_prime:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n                                \\<Longrightarrow> \\<forall>n. npow R x n \\<notin> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> P", "apply (rule allI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<notin> P", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R 0\\<^esup> \\<notin> P\n 2. \\<And>n na.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc na\\<^esup> \\<notin> P", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> P\n 2. \\<And>n na.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc na\\<^esup> \\<notin> P", "apply (simp add:prime_ideal_proper1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc na\\<^esup> \\<notin> P", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<notin> P\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<notin> P", "apply (frule_tac x = x and n = na in npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>na.\n       \\<lbrakk>prime_ideal R P; x \\<in> carrier R; x \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<notin> P;\n        x^\\<^bsup>R na\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R na\\<^esup> \\<cdot>\\<^sub>r x \\<notin> P", "apply (simp add:prime_elems_mult_not)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) npow_in_prime:\"\\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n                               \\<exists>n. npow R x n \\<in> P \\<rbrakk> \\<Longrightarrow> x \\<in> P\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n     \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> P\\<rbrakk>\n    \\<Longrightarrow> x \\<in> P", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n     \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> P; x \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule npow_notin_prime, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>prime_ideal R P; x \\<in> carrier R;\n     \\<exists>n. x^\\<^bsup>R n\\<^esup> \\<in> P; x \\<notin> P;\n     \\<forall>n. x^\\<^bsup>R n\\<^esup> \\<notin> P\\<rbrakk>\n    \\<Longrightarrow> False", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  mul_closed_set::\"[_, 'a set ] \\<Rightarrow> bool\" where\n  \"mul_closed_set R S \\<longleftrightarrow> S \\<subseteq> carrier R \\<and> (\\<forall>s\\<in>S. \\<forall>t\\<in>S. s \\<cdot>\\<^sub>r\\<^bsub>R\\<^esub> t \\<in> S)\""], ["", "locale Idomain = Ring +\n       assumes idom:\n       \"\\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; a \\<cdot>\\<^sub>r b = \\<zero>\\<rbrakk> \\<Longrightarrow> a = \\<zero> \\<or> b = \\<zero>\""], ["", "(* integral domain *)"], ["", "locale Corps =\n       fixes K (structure)\n       assumes f_is_ring: \"Ring K\"\n       and f_inv: \"\\<forall>x\\<in>carrier K - {\\<zero>}. \\<exists>x' \\<in> carrier K. x' \\<cdot>\\<^sub>r x = 1\\<^sub>r\""], ["", "(** integral domain **)"], ["", "lemma (in Ring) mul_closed_set_sub:\"mul_closed_set R S \\<Longrightarrow> S \\<subseteq> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. mul_closed_set R S \\<Longrightarrow> S \\<subseteq> carrier R", "by (simp add:mul_closed_set_def)"], ["", "lemma (in Ring) mul_closed_set_tOp_closed:\"\\<lbrakk>mul_closed_set R S; s \\<in> S;\n                            t \\<in> S\\<rbrakk> \\<Longrightarrow> s \\<cdot>\\<^sub>r t \\<in> S\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; s \\<in> S; t \\<in> S\\<rbrakk>\n    \\<Longrightarrow> s \\<cdot>\\<^sub>r t \\<in> S", "by (simp add:mul_closed_set_def)"], ["", "lemma (in Corps) f_inv_unique:\"\\<lbrakk> x \\<in> carrier K - {\\<zero>}; x' \\<in> carrier K;\n      x'' \\<in> carrier K; x' \\<cdot>\\<^sub>r  x = 1\\<^sub>r; x'' \\<cdot>\\<^sub>r x = 1\\<^sub>r \\<rbrakk> \\<Longrightarrow> x' = x''\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K - {\\<zero>}; x' \\<in> carrier K;\n     x'' \\<in> carrier K; x' \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x'' \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> x' = x''", "apply (cut_tac  f_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K - {\\<zero>}; x' \\<in> carrier K;\n     x'' \\<in> carrier K; x' \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x'' \\<cdot>\\<^sub>r x = 1\\<^sub>r; Ring K\\<rbrakk>\n    \\<Longrightarrow> x' = x''", "apply (cut_tac x = x' and y = x and z = x'' in Ring.ring_tOp_assoc[of K],\n        assumption+, simp, assumption, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n     x' \\<in> carrier K; x'' \\<in> carrier K;\n     x' \\<cdot>\\<^sub>r x = 1\\<^sub>r; x'' \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     Ring K;\n     1\\<^sub>r \\<cdot>\\<^sub>r x'' =\n     x' \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r x'')\\<rbrakk>\n    \\<Longrightarrow> x' = x''", "apply (simp add:Ring.ring_l_one[of K],\n        simp add:Ring.ring_tOp_commute[of K x x''] Ring.ring_r_one[of K])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  invf :: \"[_, 'a] \\<Rightarrow> 'a\" where\n  \"invf K x = (THE y. y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r\\<^bsub>K\\<^esub> x = 1\\<^sub>r\\<^bsub>K\\<^esub>)\""], ["", "lemma (in Corps) invf_inv:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n                (invf K x) \\<in> carrier K \\<and> (invf K x) \\<cdot>\\<^sub>r x = 1\\<^sub>r \""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n    invf K x \\<in> carrier K \\<and> invf K x \\<cdot>\\<^sub>r x = 1\\<^sub>r", "apply (simp add:invf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K \\<and> x \\<noteq> \\<zero> \\<Longrightarrow>\n    (THE y. y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r)\n    \\<in> carrier K \\<and>\n    (THE y.\n        y \\<in> carrier K \\<and>\n        y \\<cdot>\\<^sub>r x = 1\\<^sub>r) \\<cdot>\\<^sub>r\n    x =\n    1\\<^sub>r", "apply (rule theI')"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K \\<and> x \\<noteq> \\<zero> \\<Longrightarrow>\n    \\<exists>!xa. xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r", "apply (rule ex_ex1I)"], ["proof (prove)\ngoal (2 subgoals):\n 1. x \\<in> carrier K \\<and> x \\<noteq> \\<zero> \\<Longrightarrow>\n    \\<exists>xa. xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r\n 2. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> xa = y", "apply (cut_tac f_inv, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> xa = y", "apply (rule_tac x' = xa and x'' = y in f_inv_unique[of x])"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}\n 2. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> carrier K\n 3. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> y \\<in> carrier K\n 4. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r\n 5. \\<And>xa y.\n       \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n        xa \\<in> carrier K \\<and> xa \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n        y \\<in> carrier K \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> y \\<cdot>\\<^sub>r x = 1\\<^sub>r", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  npowf :: \"_  \\<Rightarrow> 'a \\<Rightarrow> int  \\<Rightarrow> 'a\" where\n  \"npowf K x n =\n    (if 0 \\<le> n then npow K x (nat n) else npow K (invf K x) (nat (- n)))\""], ["", "abbreviation\n  NPOWF ::  \"['a, _, int] \\<Rightarrow>  'a\"  (\"(3_\\<^bsub>_\\<^esub>\\<^bsup>_\\<^esup>)\" [77,77,78]77) where\n  \"a\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> == npowf K a n\""], ["", "abbreviation\n  IOP :: \"['a, _] \\<Rightarrow> 'a\" (\"(_\\<^bsup>\\<hyphen> _\\<^esup>)\" [87,88]87) where\n  \"a\\<^bsup>\\<hyphen>K\\<^esup> == invf K a\""], ["", "lemma (in Idomain) idom_is_ring: \"Ring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring R", ".."], ["", "lemma (in Idomain) idom_tOp_nonzeros:\"\\<lbrakk>x \\<in> carrier R;\n       y \\<in> carrier R; x \\<noteq> \\<zero>;  y \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (cut_tac idom[of x y])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y = \\<zero>;\n     x = \\<zero> \\<or> y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R\n 3. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> y \\<in> carrier R\n 4. \\<lbrakk>x \\<in> carrier R; y \\<in> carrier R; x \\<noteq> \\<zero>;\n     y \\<noteq> \\<zero>; x \\<cdot>\\<^sub>r y = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = \\<zero>", "apply (erule disjE, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) idom_potent_nonzero:\n       \"\\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>  \\<Longrightarrow> npow R x n \\<noteq> \\<zero> \""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>", "apply (induct_tac n)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>R 0\\<^esup> \\<noteq> \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "(* case 0 *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<noteq> \\<zero>\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n     1\\<^sub>r = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply (frule ring_l_one[of \"x\", THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>; 1\\<^sub>r = \\<zero>;\n     x = 1\\<^sub>r \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>; 1\\<^sub>r = \\<zero>;\n     x = \\<zero> \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply (simp add:ring_times_0_x)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "(* case (Suc n) *)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>R Suc n\\<^esup> \\<noteq> \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac n = n in npClose[of x],\n        cut_tac a = \"x^\\<^bsup>R n\\<^esup>\" and b = x in idom, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier R; x \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r x = \\<zero>;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero> \\<or> x = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (erule disjE, simp+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) idom_potent_unit:\"\\<lbrakk>a \\<in> carrier R; 0 < n\\<rbrakk>\n                 \\<Longrightarrow> (Unit R a) = (Unit R (npow R a n))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 0 < n\\<rbrakk>\n    \\<Longrightarrow> Unit R a = Unit R (a^\\<^bsup>R n\\<^esup>)", "apply (rule iffI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>a \\<in> carrier R; 0 < n; Unit R a\\<rbrakk>\n    \\<Longrightarrow> Unit R (a^\\<^bsup>R n\\<^esup>)\n 2. \\<lbrakk>a \\<in> carrier R; 0 < n;\n     Unit R (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (simp add:Unit_def, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>a \\<in> carrier R; 0 < n; b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> a^\\<^bsup>R n\\<^esup> \\<in> carrier R \\<and>\n                         (\\<exists>b\\<in>carrier R.\n                             a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r b =\n                             1\\<^sub>r)\n 2. \\<lbrakk>a \\<in> carrier R; 0 < n;\n     Unit R (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (simp add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>a \\<in> carrier R; 0 < n; b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>b\\<in>carrier R.\n                            a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r b =\n                            1\\<^sub>r\n 2. \\<lbrakk>a \\<in> carrier R; 0 < n;\n     Unit R (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (frule_tac x1 = a and y1 = b and n1 = n in npMul[THEN sym], assumption,\n        simp add:npOne)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>b.\n       \\<lbrakk>a \\<in> carrier R; 0 < n; b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r b = 1\\<^sub>r;\n        a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r b^\\<^bsup>R n\\<^esup> =\n        1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>b\\<in>carrier R.\n                            a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r b =\n                            1\\<^sub>r\n 2. \\<lbrakk>a \\<in> carrier R; 0 < n;\n     Unit R (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (frule_tac x = b and n = n in npClose, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 0 < n;\n     Unit R (a^\\<^bsup>R n\\<^esup>)\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (case_tac \"n = Suc 0\", simp only: np_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; 0 < n; Unit R (a^\\<^bsup>R n\\<^esup>);\n     n \\<noteq> Suc 0\\<rbrakk>\n    \\<Longrightarrow> Unit R a", "apply (simp add:Unit_def, erule conjE, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>a \\<in> carrier R; 0 < n; n \\<noteq> Suc 0;\n        a^\\<^bsup>R n\\<^esup> \\<in> carrier R; b \\<in> carrier R;\n        a^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r b = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> \\<exists>b\\<in>carrier R.\n                            a \\<cdot>\\<^sub>r b = 1\\<^sub>r", "apply (cut_tac x = a and n = \"n - Suc 0\" in npow_suc[of R], simp del:npow_suc,\n      thin_tac \"a^\\<^bsup>R n\\<^esup> = a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a\",\n      frule_tac x = a and n = \"n - Suc 0\" in npClose,\n      frule_tac x = \"a^\\<^bsup>R (n - Suc 0)\\<^esup>\" and y = a in ring_tOp_commute, assumption+,\n      simp add:ring_tOp_assoc,\n      frule_tac x = \"a^\\<^bsup>R (n - Suc 0)\\<^esup>\" and y = b in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b.\n       \\<lbrakk>a \\<in> carrier R; 0 < n; n \\<noteq> Suc 0;\n        a \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R;\n        b \\<in> carrier R;\n        a \\<cdot>\\<^sub>r\n        (a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r b) =\n        1\\<^sub>r;\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<in> carrier R;\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r a =\n        a \\<cdot>\\<^sub>r a^\\<^bsup>R (n - Suc 0)\\<^esup>;\n        a^\\<^bsup>R (n - Suc 0)\\<^esup> \\<cdot>\\<^sub>r b\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>b\\<in>carrier R.\n                            a \\<cdot>\\<^sub>r b = 1\\<^sub>r", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) idom_mult_cancel_r:\"\\<lbrakk>a \\<in> carrier R;\n       b \\<in> carrier R; c \\<in> carrier R; c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c\\<rbrakk> \\<Longrightarrow> a = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (cut_tac ring_is_ag)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c;\n     aGroup R\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (frule ring_tOp_closed[of \"a\" \"c\"], assumption+,\n        frule ring_tOp_closed[of \"b\" \"c\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c;\n     aGroup R; a \\<cdot>\\<^sub>r c \\<in> carrier R;\n     b \\<cdot>\\<^sub>r c \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (simp add:aGroup.ag_eq_diffzero[of \"R\" \"a \\<cdot>\\<^sub>r c\" \"b \\<cdot>\\<^sub>r c\"],\n        simp add:ring_inv1_1,\n        frule aGroup.ag_mOp_closed[of \"R\" \"b\"], assumption,\n        simp add:ring_distrib2[THEN sym, of \"c\" \"a\" \"-\\<^sub>a b\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>;\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r c = \\<zero>; aGroup R;\n     a \\<cdot>\\<^sub>r c \\<in> carrier R;\n     b \\<cdot>\\<^sub>r c \\<in> carrier R;\n     -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (frule aGroup.ag_pOp_closed[of \"R\" \"a\" \"-\\<^sub>a b\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>;\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r c = \\<zero>; aGroup R;\n     a \\<cdot>\\<^sub>r c \\<in> carrier R;\n     b \\<cdot>\\<^sub>r c \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<plusminus> -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (subst aGroup.ag_eq_diffzero[of R a b], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>;\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r c = \\<zero>; aGroup R;\n     a \\<cdot>\\<^sub>r c \\<in> carrier R;\n     b \\<cdot>\\<^sub>r c \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<plusminus> -\\<^sub>a b \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> a \\<plusminus> -\\<^sub>a b = \\<zero>", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>;\n     (a \\<plusminus> -\\<^sub>a b) \\<cdot>\\<^sub>r c = \\<zero>; aGroup R;\n     a \\<cdot>\\<^sub>r c \\<in> carrier R;\n     b \\<cdot>\\<^sub>r c \\<in> carrier R; -\\<^sub>a b \\<in> carrier R;\n     a \\<plusminus> -\\<^sub>a b \\<in> carrier R;\n     a \\<plusminus> -\\<^sub>a b \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule idom_tOp_nonzeros[of \"a \\<plusminus> -\\<^sub>a b\" c], assumption+, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Idomain) idom_mult_cancel_l:\"\\<lbrakk>a \\<in> carrier R;\n      b \\<in> carrier R; c \\<in> carrier R; c \\<noteq> \\<zero>; c \\<cdot>\\<^sub>r a = c \\<cdot>\\<^sub>r b\\<rbrakk> \\<Longrightarrow> a = b\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>; c \\<cdot>\\<^sub>r a = c \\<cdot>\\<^sub>r b\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (simp add:ring_tOp_commute)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; b \\<in> carrier R; c \\<in> carrier R;\n     c \\<noteq> \\<zero>; a \\<cdot>\\<^sub>r c = b \\<cdot>\\<^sub>r c\\<rbrakk>\n    \\<Longrightarrow> a = b", "apply (simp add:idom_mult_cancel_r)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) invf_closed1:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n                               invf K x \\<in> (carrier K) - {\\<zero>}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n    x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}", "apply (frule  invf_inv[of x], erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K - {\\<zero>};\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K - {\\<zero>}", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n     \\<zero> \\<in> carrier K; \\<zero> \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (cut_tac f_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> \\<zero>;\n     \\<zero> \\<in> carrier K; \\<zero> \\<cdot>\\<^sub>r x = 1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup> = \\<zero>; Ring K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (\n        simp add:Ring.ring_times_0_x[of K])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K \\<and> x \\<noteq> 1\\<^sub>r;\n     1\\<^sub>r \\<in> carrier K; \\<zero> = 1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r; Ring K\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule sym, thin_tac \"\\<zero> = 1\\<^sub>r\", simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<zero> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> = \\<zero>; Ring K; 1\\<^sub>r = \\<zero>;\n     x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule Ring.ring_l_one[of K x], assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<zero> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> = \\<zero>; Ring K; 1\\<^sub>r = \\<zero>;\n     x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r \\<cdot>\\<^sub>r x = x\\<rbrakk>\n    \\<Longrightarrow> False", "apply (rotate_tac -1, frule sym, thin_tac \"1\\<^sub>r \\<cdot>\\<^sub>r x = x\",\n        simp add:Ring.ring_times_0_x)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) linvf:\"x \\<in> carrier K - {\\<zero>} \\<Longrightarrow> (invf K x) \\<cdot>\\<^sub>r x = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> carrier K - {\\<zero>} \\<Longrightarrow>\n    x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x = 1\\<^sub>r", "by (simp add:invf_inv)"], ["", "lemma (in Corps) field_is_ring:\"Ring K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring K", "by (simp add:f_is_ring)"], ["", "lemma (in Corps) invf_one:\"1\\<^sub>r \\<noteq> \\<zero>  \\<Longrightarrow> invf K (1\\<^sub>r) = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. 1\\<^sub>r \\<noteq> \\<zero> \\<Longrightarrow>\n    1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r", "apply (frule_tac Ring.ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r", "apply (cut_tac invf_closed1 [of \"1\\<^sub>r\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r\n 2. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K - {\\<zero>}", "apply (cut_tac linvf[of \"1\\<^sub>r\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n     1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r 1\\<^sub>r =\n     1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup> = 1\\<^sub>r\n 2. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K - {\\<zero>}\n 3. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K - {\\<zero>}", "apply (simp add:Ring.ring_r_one[of \"K\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K; 1\\<^sub>r \\<in> carrier K;\n     1\\<^sub>r\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K - {\\<zero>}\n 2. \\<lbrakk>1\\<^sub>r \\<noteq> \\<zero>; Ring K;\n     1\\<^sub>r \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<in> carrier K - {\\<zero>}", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_tOp_assoc:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; z \\<in> carrier K\\<rbrakk>\n                                \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =  x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; y \\<in> carrier K;\n     z \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =\n                      x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; z \\<in> carrier K;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y \\<cdot>\\<^sub>r z =\n                      x \\<cdot>\\<^sub>r (y \\<cdot>\\<^sub>r z)", "apply (simp add:Ring.ring_tOp_assoc)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_tOp_commute:\"\\<lbrakk>x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n                                \\<Longrightarrow> x \\<cdot>\\<^sub>r y  =  y \\<cdot>\\<^sub>r x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; y \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r x", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; y \\<in> carrier K; Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<cdot>\\<^sub>r y = y \\<cdot>\\<^sub>r x", "apply (simp add:Ring.ring_tOp_commute)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_inv_inv:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup> = x\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x", "apply (cut_tac invf_closed1[of \"x\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac invf_inv[of \"x\\<^bsup>\\<hyphen>K\\<^esup>\"], erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>};\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup> =\n     1\\<^sub>r\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K - {\\<zero>}\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule field_tOp_assoc[THEN sym, of \"x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>\" \"x\\<^bsup>\\<hyphen> K\\<^esup>\" \"x\"],\n        simp, assumption, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K \\<and>\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup> =\n     1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     (x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x) =\n     1\\<^sub>r \\<cdot>\\<^sub>r x\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K - {\\<zero>}\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac field_is_ring,\n        simp add:Ring.ring_l_one Ring.ring_r_one, erule conjE,\n        cut_tac invf_inv[of x], erule conjE, simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup> =\n     1\\<^sub>r;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     (x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x) =\n     x;\n     Ring K; x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\n                      \\<in> carrier K - {\\<zero>}\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp+"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_is_idom:\"Idomain K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. Idomain K", "apply (rule Idomain.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. Ring K\n 2. Idomain_axioms K", "apply (simp add:field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Idomain_axioms K", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. Ring K \\<Longrightarrow> Idomain_axioms K", "apply (rule Idomain_axioms.intro)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Ring K; a \\<in> carrier K; b \\<in> carrier K;\n        a \\<cdot>\\<^sub>r b = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> a = \\<zero> \\<or> b = \\<zero>", "apply (rule contrapos_pp, simp+, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Ring K; a \\<in> carrier K; b \\<in> carrier K;\n        a \\<cdot>\\<^sub>r b = \\<zero>; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac x = a in invf_closed1, simp, simp, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Ring K; a \\<in> carrier K; b \\<in> carrier K;\n        a \\<cdot>\\<^sub>r b = \\<zero>; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac x = \"a\\<^bsup>\\<hyphen> K\\<^esup>\" and y = a and z = b in field_tOp_assoc,\n         assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a b.\n       \\<lbrakk>Ring K; a \\<in> carrier K; b \\<in> carrier K;\n        a \\<cdot>\\<^sub>r b = \\<zero>; a \\<noteq> \\<zero>;\n        b \\<noteq> \\<zero>; a\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r a \\<cdot>\\<^sub>r b =\n        a\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n        (a \\<cdot>\\<^sub>r b)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:linvf Ring.ring_times_x_0 Ring.ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_potent_nonzero:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                       x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>", "apply (cut_tac field_is_idom)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Idomain K\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K n\\<^esup> \\<noteq> \\<zero>", "apply (cut_tac field_is_ring,\n       simp add:Idomain.idom_potent_nonzero)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_potent_nonzero1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup>  \\<noteq> \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> \\<noteq> \\<zero>", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       x^\\<^bsup>K nat n\\<^esup> \\<noteq> \\<zero>) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup> \\<noteq>\n                       \\<zero>)", "apply (case_tac \"0 \\<le> n\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       x^\\<^bsup>K nat n\\<^esup> \\<noteq> \\<zero>) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup> \\<noteq>\n                       \\<zero>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       x^\\<^bsup>K nat n\\<^esup> \\<noteq> \\<zero>) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup> \\<noteq>\n                       \\<zero>)", "apply (simp add:field_potent_nonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       x^\\<^bsup>K nat n\\<^esup> \\<noteq> \\<zero>) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup> \\<noteq>\n                       \\<zero>)", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- n)\\<^esup> \\<noteq>\n                      \\<zero>", "apply (cut_tac invf_closed1[of \"x\"], simp+, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; \\<not> 0 \\<le> n;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- n)\\<^esup> \\<noteq>\n                      \\<zero>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:field_potent_nonzero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_nilp_zero:\"\\<lbrakk>x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> = \\<zero>\\<rbrakk> \\<Longrightarrow> x = \\<zero>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x^\\<^bsup>K n\\<^esup> = \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x = \\<zero>", "by (rule contrapos_pp, simp+, simp add:field_potent_nonzero)"], ["", "lemma (in Corps) npowf_mem:\"\\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                    npowf K a n \\<in> carrier K\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a\\<^bsub>K\\<^esub>\\<^bsup>n\\<^esup> \\<in> carrier K", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       a^\\<^bsup>K nat n\\<^esup> \\<in> carrier K) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       a\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup>\n                       \\<in> carrier K)", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>; Ring K\\<rbrakk>\n    \\<Longrightarrow> (0 \\<le> n \\<longrightarrow>\n                       a^\\<^bsup>K nat n\\<^esup> \\<in> carrier K) \\<and>\n                      (\\<not> 0 \\<le> n \\<longrightarrow>\n                       a\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                         (- n)\\<^esup>\n                       \\<in> carrier K)", "apply (case_tac \"0 \\<le> n\", simp,\n       simp add:Ring.npClose, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>; Ring K;\n     \\<not> 0 \\<le> n\\<rbrakk>\n    \\<Longrightarrow> a\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- n)\\<^esup>\n                      \\<in> carrier K", "apply (cut_tac invf_closed1[of \"a\"], simp, erule conjE,\n       simp add:Ring.npClose, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) field_npowf_exp_zero:\"\\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                    npowf K a 0 = 1\\<^sub>r\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier K; a \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> a\\<^bsub>K\\<^esub>\\<^bsup>0\\<^esup> = 1\\<^sub>r", "by (cut_tac field_is_ring, simp add:npowf_def)"], ["", "lemma (in Corps) npow_exp_minusTr1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i\\<rbrakk>  \\<Longrightarrow>\n       0 \\<le> i - (int j) \\<longrightarrow>  x\\<^bsub>K\\<^esub>\\<^bsup>(i - (int j))\\<^esup> = x^\\<^bsup>K (nat i)\\<^esup> \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)^\\<^bsup>K j\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> i - int j \\<longrightarrow>\n                      x\\<^bsub>K\\<^esub>\\<^bsup>(i - int j)\\<^esup> =\n                      x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K j\\<^esup>", "apply (cut_tac field_is_ring,\n       cut_tac invf_closed1[of \"x\"], simp,\n       simp add:npowf_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; Ring K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> int j \\<le> i \\<longrightarrow>\n                      x^\\<^bsup>K nat (i - int j)\\<^esup> =\n                      x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (induct_tac \"j\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; Ring K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> =\n                      x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r 1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        int n \\<le> i \\<longrightarrow>\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> int (Suc n) \\<le> i \\<longrightarrow>\n                         x^\\<^bsup>K nat (i - int (Suc n))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K Suc\n                           n\\<^esup>\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule Ring.npClose[of \"K\" \"x\" \"nat i\"], assumption+,\n        simp add:Ring.ring_r_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        int n \\<le> i \\<longrightarrow>\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> int (Suc n) \\<le> i \\<longrightarrow>\n                         x^\\<^bsup>K nat (i - int (Suc n))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K Suc\n                           n\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (rule impI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        1 + int n \\<le> i\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i - (1 + int n))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subst zdiff)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        1 + int n \\<le> i\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + - (1 + int n))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:add.commute[of \"1\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac z = i and w = \"int n + 1\" in zdiff,\n       simp only:minus_add_distrib,\n       thin_tac \"i - (int n + 1) = i + (- int n + - 1)\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac z = \"i + - int n\" in nat_diff_distrib[of \"1\"],\n         simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i;\n        nat (i + - int n - 1) = nat (i + - int n) - nat 1\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp only:zdiff[of _ \"1\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i;\n        nat (i - int n - 1) = nat (i - int n) - Suc 0\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (cut_tac field_is_idom)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (frule_tac n = \"nat i\" in Ring.npClose[of \"K\" \"x\"], assumption+,\n       frule_tac n = \"nat i\" in Ring.npClose[of \"K\" \"x\\<^bsup>\\<hyphen> K\\<^esup>\"], assumption+,\n       frule_tac n = n in Ring.npClose[of \"K\" \"x\\<^bsup>\\<hyphen> K\\<^esup>\"], assumption+ )"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup> =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (rule_tac a = \"x^\\<^bsup>K (nat (i + (- int n - 1)))\\<^esup>\" and\n       b = \"x^\\<^bsup>K (nat i)\\<^esup> \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r x\\<^bsup>\\<hyphen> K\\<^esup>)\" and c = x in\n       Idomain.idom_mult_cancel_r[of \"K\"], assumption+)"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat (i + (- int n - 1))\\<^esup>\n                         \\<in> carrier K\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>)\n                         \\<in> carrier K\n 3. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K\n 4. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> \\<zero>\n 5. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                         x\n 6. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:Ring.npClose, rule Ring.ring_tOp_closed, assumption+,\n        rule Ring.ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                         x\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subgoal_tac \"0 < nat (i - int n)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<in> carrier K;\n        0 < nat (i - int n)\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                          x\\<^bsup>\\<hyphen> K\\<^esup>) \\<cdot>\\<^sub>r\n                         x\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subst Ring.npMulElmR, assumption+, simp,\n        simp add:field_tOp_assoc[THEN sym, of \"x^\\<^bsup>K (nat i)\\<^esup>\" _ \"x\\<^bsup>\\<hyphen> K\\<^esup>\"])"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n                         x\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subst field_tOp_assoc[of _ _ x])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n                         \\<in> carrier K\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K\n 3. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier K\n 4. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x)\n 5. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 6. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (rule Ring.ring_tOp_closed[of K], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                         (x\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r x)\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add: linvf)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup> \\<cdot>\\<^sub>r\n                         1\\<^sub>r\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (subst Ring.ring_r_one[of K], assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n                         \\<in> carrier K\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n 3. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> 0 < nat (i - int n)\n 4. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply auto"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n                         \\<in> carrier K\n 2. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>", "apply (metis Ring.npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (i - int n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i; nat (i - int n - 1) = nat (i - int n) - Suc 0;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + (- int n - 1))\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>", "apply (simp only: uminus_add_conv_diff [symmetric] add.assoc [symmetric])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K nat (- int n + i)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        int n + 1 \\<le> i;\n        nat (- 1 + - int n + i) = nat (- int n + i) - Suc 0; Idomain K;\n        x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K nat\n(i + - 1 + - int n)\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>", "apply (simp add: algebra_simps nat_diff_distrib Suc_diff_Suc)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n        x^\\<^bsup>K (nat i - n)\\<^esup> =\n        x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>;\n        1 + int n \\<le> i; nat i - nat (1 + int n) = nat i - Suc n;\n        Idomain K; x^\\<^bsup>K nat i\\<^esup> \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat i\\<^esup>\n        \\<in> carrier K;\n        x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>\n        \\<in> carrier K\\<rbrakk>\n       \\<Longrightarrow> x^\\<^bsup>K (nat i - Suc n)\\<^esup> \\<cdot>\\<^sub>r\n                         x =\n                         x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                         x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K n\\<^esup>", "apply (smt Ring.npMulElmR Suc_nat_eq_nat_zadd1 nat_diff_distrib' nat_int of_nat_0_le_iff)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npow_exp_minusTr2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n                 0 \\<le> i - j\\<rbrakk>  \\<Longrightarrow>  x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> = x^\\<^bsup>K (nat i)\\<^esup> \\<cdot>\\<^sub>r (x\\<^bsup>\\<hyphen>K\\<^esup>)^\\<^bsup>K (nat j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n     0 \\<le> i - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> =\n                      x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat j\\<^esup>", "apply (frule npow_exp_minusTr1[of \"x\" \"i\" \"nat j\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n     0 \\<le> i - j;\n     0 \\<le> i - int (nat j) \\<longrightarrow>\n     x\\<^bsub>K\\<^esub>\\<^bsup>(i - int (nat j))\\<^esup> =\n     x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> =\n                      x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat j\\<^esup>", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_inv:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> j \\<noteq> 0 \\<longrightarrow>\n                      x^\\<^bsup>K nat j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n             j\\<^esup>", "apply (rule impI, simp add:zle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; \\<not> j < 0;\n     j \\<noteq> 0\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n             j\\<^esup>", "apply (simp add:field_inv_inv)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_inv1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; \\<not> 0 \\<le> j\\<rbrakk> \\<Longrightarrow>\n                                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_inverse:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> = (x\\<^bsup>\\<hyphen>K\\<^esup>)\\<^bsub>K\\<^esub>\\<^bsup>(-j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (case_tac \"0 \\<le> j\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:npowf_inv, simp add:npowf_inv1)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_expTr1:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n                 0 \\<le> i - j\\<rbrakk> \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>(- j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i; 0 \\<le> j;\n     0 \\<le> i - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i - j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:npow_exp_minusTr2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j;\n     j \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat j\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_expTr2:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j\\<rbrakk> \\<Longrightarrow>\n                          x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (case_tac \"0 \\<le> i\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (case_tac \"0 \\<le> j\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:npowf_def, simp add:nat_add_distrib,\n         rule Ring.npMulDistr[THEN sym], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (subst zminus_minus[THEN sym, of \"i\" \"j\"],\n        subst npow_exp_minusTr2[of \"x\" \"i\" \"-j\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> - j\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> i - - j\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     0 \\<le> i; \\<not> 0 \\<le> j\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 4. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:zle, simp add:zless_imp_zle, simp add:npowf_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:add.commute[of \"i\" \"j\"],\n        subst zminus_minus[THEN sym, of \"j\" \"i\"],\n        subst npow_exp_minusTr2[of \"x\" \"j\" \"-i\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> j\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> - i\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> j - - i\n 4. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat j\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- i)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:zle, simp add:zless_imp_zle, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat j\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- i)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (frule npowf_mem[of \"x\" \"i\"], assumption+,\n         frule npowf_mem[of \"x\" \"j\"], assumption+,\n         simp add:field_tOp_commute[of \"x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup>\" \"x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> j + i; Ring K;\n     \\<not> 0 \\<le> i; x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<in> carrier K;\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> x^\\<^bsup>K nat j\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsup>\\<hyphen> K\\<^esup>^\\<^bsup>K nat\n                        (- i)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup>", "apply (simp add:npowf_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_exp_add:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                          x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (case_tac \"0 \\<le> i + j\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> i + j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> i + j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:npowf_expTr2)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> i + j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(i + j)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:npowf_inv1[of \"x\" \"i + j\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     \\<not> 0 \\<le> i + j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:zle)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (subgoal_tac \"0 < -i + -j\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0;\n     0 < - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0\\<rbrakk>\n    \\<Longrightarrow> 0 < - i + - j", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0\\<rbrakk>\n    \\<Longrightarrow> 0 < - i + - j\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0;\n     0 < - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; i + j < 0;\n     0 < - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (thin_tac \"i + j < 0\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 < - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (frule zless_imp_zle[of \"0\" \"-i + -j\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 < - i + - j;\n     0 \\<le> - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (thin_tac \"0 < -i + -j\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     0 \\<le> - i + - j\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (cut_tac invf_closed1[of \"x\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; 0 \\<le> - i + - j;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K - {\\<zero>}\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     0 \\<le> - i + - j\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp, erule conjE,\n       frule npowf_expTr2[of \"x\\<^bsup>\\<hyphen>K\\<^esup>\" \"-i\" \"-j\"], assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; j \\<le> - i;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> 0 \\<le> - i + - j\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; j \\<le> - i;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i +\n                     - j)\\<^esup> =\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- i\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 3. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     0 \\<le> - i + - j\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:zdiff[THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; j \\<le> - i;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<in> carrier K;\n     x\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq> \\<zero>;\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i +\n                     - j)\\<^esup> =\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- i\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsup>\\<hyphen> K\\<^esup>\\<^bsub>K\\<^esub>\\<^bsup>(- i -\nj)\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>i\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     0 \\<le> - i + - j\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier K - {\\<zero>}", "apply (simp add:npowf_inverse, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_exp_1_add:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow>\n                                        x\\<^bsub>K\\<^esub>\\<^bsup>(1 + j)\\<^esup> = x \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>(1 + j)\\<^esup> =\n                      x \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:npowf_exp_add[of \"x\" \"1\" \"j\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>1\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>1\\<^esup> \\<cdot>\\<^sub>r\n                      x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> =\n                      x \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>", "apply (simp add:npowf_def, simp add:Ring.ring_l_one)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Corps) npowf_minus:\"\\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk> \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup> = x\\<^bsub>K\\<^esub>\\<^bsup>(- j)\\<^esup>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (frule npowf_exp_add[of \"x\" \"j\" \"-j\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     x\\<^bsub>K\\<^esub>\\<^bsup>(j + - j)\\<^esup> =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (simp add:field_npowf_exp_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (cut_tac field_is_ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>;\n     Ring K\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (frule npowf_mem[of \"x\" \"j\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>;\n     Ring K; x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (frule field_potent_nonzero1[of \"x\" \"j\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>;\n     Ring K; x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<in> carrier K;\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>", "apply (cut_tac invf_closed1[of \"x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\"], simp, erule conjE,\n       frule Ring.ring_r_one[of \"K\" \"(x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen>K\\<^esup>\"], assumption, simp,\n      thin_tac \"1\\<^sub>r = x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\",\n      frule npowf_mem[of \"x\" \"-j\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>; Ring K;\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<in> carrier K;\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<noteq> \\<zero>;\n     (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>\n     \\<in> carrier K;\n     (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<noteq>\n     \\<zero>;\n     (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> \\<cdot>\\<^sub>r\n     (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>) =\n     (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup>;\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup> \\<in> carrier K\\<rbrakk>\n    \\<Longrightarrow> (x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>)\\<^bsup>\\<hyphen> K\\<^esup> =\n                      x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>\n 2. \\<lbrakk>x \\<in> carrier K; x \\<noteq> \\<zero>;\n     1\\<^sub>r =\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<cdot>\\<^sub>r\n     x\\<^bsub>K\\<^esub>\\<^bsup>- j\\<^esup>;\n     Ring K; x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<in> carrier K;\n     x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup> \\<noteq> \\<zero>\\<rbrakk>\n    \\<Longrightarrow> x\\<^bsub>K\\<^esub>\\<^bsup>j\\<^esup>\n                      \\<in> carrier K - {\\<zero>}", "apply (simp add:field_tOp_assoc[THEN sym], simp add:linvf,\n       simp add:Ring.ring_l_one, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) residue_fieldTr:\"\\<lbrakk>maximal_ideal R mx; x \\<in> carrier(qring R mx);\n x \\<noteq> \\<zero>\\<^bsub>(qring R mx)\\<^esub>\\<rbrakk> \\<Longrightarrow>\\<exists>y\\<in>carrier (qring R mx). y \\<cdot>\\<^sub>r\\<^bsub>(qring R mx)\\<^esub> x = 1\\<^sub>r\\<^bsub>(qring R mx)\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier (R /\\<^sub>r mx);\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y\\<in>carrier (R /\\<^sub>r mx).\n                         y \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (frule maximal_ideal_ideal[of \"mx\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx; x \\<in> carrier (R /\\<^sub>r mx);\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>; ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y\\<in>carrier (R /\\<^sub>r mx).\n                         y \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (simp add:qring_carrier)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx;\n     \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> mx = x;\n     x \\<noteq> \\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>; ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         (\\<exists>a\\<in>carrier R.\n                             a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                         y \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (simp add:qring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx;\n     \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> mx = x;\n     x \\<noteq> mx; ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         (\\<exists>a\\<in>carrier R.\n                             a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                         y \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n                         1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (simp add:qring_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_ideal R mx;\n     \\<exists>a\\<in>carrier R. a \\<uplus>\\<^bsub>R\\<^esub> mx = x;\n     x \\<noteq> mx; ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>y.\n                         (\\<exists>a\\<in>carrier R.\n                             a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                         rcostOp R mx y x =\n                         1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>maximal_ideal R mx; x \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; a \\<uplus>\\<^bsub>R\\<^esub> mx = x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y x =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule sym, thin_tac \"a \\<uplus>\\<^bsub>R\\<^esub> mx = x\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = a in ar_coset_same4_1[of \"mx\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac x = a in maximal_prime_Tr0[of \"mx\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a = carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a = carrier R;\n        1\\<^sub>r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (rotate_tac -2, frule sym, thin_tac \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a = carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>1\\<^sub>r \\<in> carrier R; maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        carrier R = mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac B = \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\" in eq_set_inc[of \"1\\<^sub>r\" \"carrier R\"],\n                  assumption+,\n        thin_tac \"carrier R = mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>1\\<^sub>r \\<in> carrier R; maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        1\\<^sub>r \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule ideal_subset1[of mx])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>1\\<^sub>r \\<in> carrier R; maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        1\\<^sub>r \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n        mx \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = a in principal_ideal,\n        frule_tac I = \"R \\<diamondsuit>\\<^sub>p a\" in ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a.\n       \\<lbrakk>1\\<^sub>r \\<in> carrier R; maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx;\n        1\\<^sub>r \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n        mx \\<subseteq> carrier R; ideal R (R \\<diamondsuit>\\<^sub>p a);\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (cut_tac ring_is_ag,\n        simp add:aGroup.set_sum, (erule bexE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k.\n       \\<lbrakk>1\\<^sub>r \\<in> carrier R; maximal_ideal R mx;\n        a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx; ideal R mx;\n        a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R;\n        ideal R (R \\<diamondsuit>\\<^sub>p a);\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p a;\n        1\\<^sub>r = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (thin_tac \"ideal R (R \\<diamondsuit>\\<^sub>p a)\", thin_tac \"R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R\",\n        simp add:Rxa_def, (erule bexE)+, simp, thin_tac \"k = r \\<cdot>\\<^sub>r a\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a;\n        r \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = r and b = a in rcostOp[of \"mx\"], assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac x = r and y = a in ring_tOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = \"r \\<cdot>\\<^sub>r a\" and x = h and b = \"1\\<^sub>r\" in\n        aGroup.ag_eq_sol2[of \"R\"], assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<in> carrier R\n 2. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 3. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> r \\<cdot>\\<^sub>r a = 1\\<^sub>r\n 4. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        h = 1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (simp add:ideal_subset)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> carrier R\n 2. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> h \\<plusminus> r \\<cdot>\\<^sub>r a = 1\\<^sub>r\n 3. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        h = 1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (simp add:ring_one, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        h = 1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = h and b = \"1\\<^sub>r \\<plusminus> -\\<^sub>a (r \\<cdot>\\<^sub>r a)\" and A = mx in\n              eq_elem_in, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        h = 1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a = \"r \\<cdot>\\<^sub>r a\" and b = \"1\\<^sub>r\" in ar_coset_same1[of \"mx\"],\n        rule ring_tOp_closed, assumption+, rule ring_one, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        ideal R mx; a \\<in> carrier R; x = a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        a \\<notin> mx; mx \\<subseteq> carrier R; aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        h = 1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a r \\<cdot>\\<^sub>r a \\<in> mx;\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (frule_tac a1 = \"r \\<cdot>\\<^sub>r a\" and h1 = h in aGroup.arcos_fixed[THEN sym,\n         of R mx],  unfold ideal_def, erule conjE, assumption+,\n         thin_tac \"R +> mx \\<and> (\\<forall>r\\<in>carrier R. \\<forall>x\\<in>mx. r \\<cdot>\\<^sub>r x \\<in> mx)\",\n         thin_tac \"x = a \\<uplus>\\<^bsub>R\\<^esub> mx\",\n         thin_tac \"1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a\",\n         thin_tac \"h = 1\\<^sub>r \\<plusminus> -\\<^sub>a (r \\<cdot>\\<^sub>r a)\", thin_tac \"1\\<^sub>r \\<plusminus> -\\<^sub>a (r \\<cdot>\\<^sub>r a) \\<in> mx\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>a h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        maximal_ideal R mx; a \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        a \\<in> carrier R; a \\<notin> mx; mx \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx;\n        (h \\<plusminus> r \\<cdot>\\<^sub>r a) \\<uplus>\\<^bsub>R\\<^esub> mx =\n        r \\<cdot>\\<^sub>r a \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (a \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             a) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply (rename_tac b h k r)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b h k r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r b \\<in> carrier R;\n        maximal_ideal R mx; b \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        b \\<in> carrier R; b \\<notin> mx; mx \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (b \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        r \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> mx =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx;\n        (h \\<plusminus> r \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> mx =\n        r \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (b \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            (h \\<plusminus>\n                             r \\<cdot>\\<^sub>r\n                             b) \\<uplus>\\<^bsub>R\\<^esub> mx", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>b h r.\n       \\<lbrakk>h \\<plusminus> r \\<cdot>\\<^sub>r b \\<in> carrier R;\n        maximal_ideal R mx; b \\<uplus>\\<^bsub>R\\<^esub> mx \\<noteq> mx;\n        b \\<in> carrier R; b \\<notin> mx; mx \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R;\n        rcostOp R mx (r \\<uplus>\\<^bsub>R\\<^esub> mx)\n         (b \\<uplus>\\<^bsub>R\\<^esub> mx) =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx;\n        r \\<cdot>\\<^sub>r b \\<in> carrier R;\n        r \\<cdot>\\<^sub>r b \\<uplus>\\<^bsub>R\\<^esub> mx =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx;\n        (h \\<plusminus> r \\<cdot>\\<^sub>r b) \\<uplus>\\<^bsub>R\\<^esub> mx =\n        1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>y.\n                            (\\<exists>a\\<in>carrier R.\n                                a \\<uplus>\\<^bsub>R\\<^esub> mx = y) \\<and>\n                            rcostOp R mx y\n                             (b \\<uplus>\\<^bsub>R\\<^esub> mx) =\n                            1\\<^sub>r \\<uplus>\\<^bsub>R\\<^esub> mx", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nconstdefs (structure R)\n field_cd::\"_ \\<Rightarrow> bool\"\n \"field_cd R  == \\<forall>x\\<in>(carrier R - {\\<zero>}). \\<exists>y\\<in>carrier R.\n                                                y \\<cdot>\\<^sub>r x = 1\\<^sub>r\" *)\n(* field condition  *) (*\nconstdefs (structure R)\n rIf :: \"_ \\<Rightarrow> 'a  \\<Rightarrow> 'a \" *) (** rIf is ring_invf **) (*\n \"rIf R == \\<lambda>x. (SOME y. y \\<in> carrier R \\<and> y \\<cdot>\\<^sub>r x = 1\\<^sub>r)\"\n*) (*\nconstdefs (structure R)\n  Rf::\"_ \\<Rightarrow> 'a field\"\n  \"Rf R == \\<lparr>carrier = carrier R, pop = pop R, mop = mop R, zero = zero R,\n               tp = tp R, un = un R, invf = rIf R\\<rparr>\" *)\n\n(*\nconstdefs (structure R)\n Rf ::  \"_ \\<Rightarrow> \\<lparr> carrier :: 'a set,\n  pOp :: ['a, 'a] \\<Rightarrow> 'a, mOp ::'a \\<Rightarrow> 'a, zero :: 'a, tOp :: ['a, 'a] \\<Rightarrow> 'a,\n  one ::'a, iOp ::'a \\<Rightarrow> 'a\\<rparr>\"\n\n  \"Rf R  == \\<lparr> carrier = carrier R, pOp = pOp R, mOp = mOp R, zero = zero R,\n  tOp = tOp R, one = one R, iOp = ring_iOp R\\<rparr>\" *)\n(*\nlemma (in Ring) rIf_mem:\"\\<lbrakk>field_cd R; x \\<in> carrier R - {\\<zero>}\\<rbrakk> \\<Longrightarrow>\n                     rIf R x \\<in> carrier R \\<and> rIf R x \\<noteq> \\<zero>\"\napply (simp add:rIf_def)\napply (rule someI2_ex)\napply (simp add:field_cd_def, blast)\napply (simp add:field_cd_def)\n apply (thin_tac \"\\<forall>x\\<in>carrier R - {\\<zero>}. \\<exists>y\\<in>carrier R. y \\<cdot>\\<^sub>r x = 1\\<^sub>r\")\n apply (erule conjE)+\n apply (rule contrapos_pp, simp+)\n apply (frule sym, thin_tac \"\\<zero> \\<cdot>\\<^sub>r x = 1\\<^sub>r\", simp add:ring_times_0_x)\n  apply (frule ring_l_one[of \"x\"])\n apply (simp add:ring_times_0_x)\ndone\n\nlemma (in Ring) rIf:\"\\<lbrakk>field_cd R; x \\<in> carrier R - {\\<zero>}\\<rbrakk> \\<Longrightarrow>\n                                           (rIf R x) \\<cdot>\\<^sub>r x = 1\\<^sub>r\"\napply (simp add:rIf_def)\napply (rule someI2_ex)\napply (simp add:field_cd_def, blast)\napply simp\ndone\n\nlemma (in Ring) field_cd_integral:\"field_cd R \\<Longrightarrow> Idomain R\"\napply (rule Idomain.intro)\n apply assumption\n apply (rule Idomain_axioms.intro)\n\napply (rule contrapos_pp, simp+, erule conjE)\napply (cut_tac x = a in rIf_mem, assumption, simp, erule conjE)\napply (frule_tac x = \"rIf R a\" and y = a and z = b in ring_tOp_assoc,\n                 assumption+, simp add:rIf)\napply (simp add:ring_l_one ring_times_x_0)\ndone\n\nlemma (in Ring) Rf_field:\"field_cd R \\<Longrightarrow> field (Rf R)\"\napply (rule field.intro)\n apply (simp add:Rf_def)\n apply (rule Ring.intro)\n apply (simp add:pop_closed)\n apply ( cut_tac ring_is_ag, simp add:aGroup.ag_pOp_assoc)\n apply (simp add:Rf_def,\n         cut_tac ring_is_ag, simp add:aGroup.ag_pOp_commute)\n apply (simp add:mop_closed)\n apply (simp add:\n\n\napply (rule conjI)\n prefer 2\n apply (rule conjI)\n apply (rule univar_func_test, rule ballI)\n apply (simp, erule conjE, simp add:Rf_def)\n apply (rule rIf_mem, assumption+, simp)\napply (rule allI, rule impI)\n apply (simp add:Rf_def)\n apply (frule_tac x = x in rIf, simp, assumption)\n\n apply (subst Rf_def, simp add:Ring_def)\n apply (cut_tac ring_is_ag)\n apply (rule conjI, simp add:aGroup_def)\n apply (rule conjI, (rule allI, rule impI)+, simp add:aGroup.ag_pOp_assoc)\n apply (rule conjI, (rule allI, rule impI)+, simp add:aGroup.ag_pOp_commute)\n apply (rule conjI, rule univar_func_test, rule ballI,\n                                              simp add:aGroup.ag_mOp_closed)\n apply (rule conjI, rule allI, rule impI, simp add:aGroup.ag_l_inv1)\n apply (simp add:aGroup.ag_inc_zero)\n apply (rule conjI, rule allI, rule impI, simp add:aGroup.ag_l_zero)\n\n apply (rule conjI, rule bivar_func_test, (rule ballI)+,\n                                          simp add:ring_tOp_closed)\n apply (rule conjI, (rule allI, rule impI)+, simp add:ring_tOp_assoc)\n apply (rule conjI, (rule allI, rule impI)+, simp add:ring_tOp_commute)\n apply (simp add:ring_one)\n apply (rule conjI, (rule allI, rule impI)+, simp add:ring_distrib1)\n apply (rule allI, rule impI, simp add:ring_l_one)\ndone\n *)"], ["", "lemma (in Ring) residue_field_cd:\"maximal_ideal R mx \\<Longrightarrow>\n                                           Corps (qring R mx)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_ideal R mx \\<Longrightarrow> Corps (R /\\<^sub>r mx)", "apply (rule Corps.intro)"], ["proof (prove)\ngoal (2 subgoals):\n 1. maximal_ideal R mx \\<Longrightarrow> Ring (R /\\<^sub>r mx)\n 2. maximal_ideal R mx \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (R /\\<^sub>r mx) -\n                   {\\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>}.\n       \\<exists>x'\\<in>carrier (R /\\<^sub>r mx).\n          x' \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n          1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (rule Ring.qring_ring, rule Ring_axioms)"], ["proof (prove)\ngoal (2 subgoals):\n 1. maximal_ideal R mx \\<Longrightarrow> ideal R mx\n 2. maximal_ideal R mx \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (R /\\<^sub>r mx) -\n                   {\\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>}.\n       \\<exists>x'\\<in>carrier (R /\\<^sub>r mx).\n          x' \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n          1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (simp add:maximal_ideal_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_ideal R mx \\<Longrightarrow>\n    \\<forall>x\\<in>carrier (R /\\<^sub>r mx) -\n                   {\\<zero>\\<^bsub>R /\\<^sub>r mx\\<^esub>}.\n       \\<exists>x'\\<in>carrier (R /\\<^sub>r mx).\n          x' \\<cdot>\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub> x =\n          1\\<^sub>r\\<^bsub>R /\\<^sub>r mx\\<^esub>", "apply (simp add:residue_fieldTr[of \"mx\"])"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "(*\nlemma (in Ring) qRf_field:\"maximal_ideal R mx \\<Longrightarrow> field (Rf (qring R mx))\"\napply (frule maximal_ideal_ideal[of \"mx\"])\napply (frule qring_ring [of \"mx\"])\n apply (frule residue_field_cd[of \"mx\"])\n apply (rule Ring.Rf_field, assumption+)\ndone\n\nlemma (in Ring) qRf_pj_rHom:\"maximal_ideal R mx \\<Longrightarrow>\n                          (pj R mx) \\<in> rHom R (Rf (qring R mx))\"\napply (frule maximal_ideal_ideal[of \"mx\"])\napply (frule pj_Hom[OF Ring, of \"mx\"])\napply (simp add:rHom_def aHom_def Rf_def)\ndone *)"], ["", "lemma (in Ring) maximal_set_idealTr:\n       \"maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx \\<Longrightarrow> ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx \\<Longrightarrow>\n    ideal R mx", "by (simp add:maximal_set_def)"], ["", "lemma (in Ring) maximal_setTr:\"\\<lbrakk>maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n                                         ideal R J; mx \\<subset> J \\<rbrakk> \\<Longrightarrow> S \\<inter> J \\<noteq> {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n     ideal R J; mx \\<subset> J\\<rbrakk>\n    \\<Longrightarrow> S \\<inter> J \\<noteq> {}", "by (rule contrapos_pp, simp+, simp add:psubset_eq, erule conjE,\n       simp add:maximal_set_def, blast)"], ["", "lemma (in Ring) mulDisj:\"\\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n    T = {I. ideal R I \\<and> S \\<inter> I = {}}; maximal_set T mx \\<rbrakk> \\<Longrightarrow> prime_ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}}; maximal_set T mx\\<rbrakk>\n    \\<Longrightarrow> prime_ideal R mx", "apply (simp add:prime_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx\\<rbrakk>\n    \\<Longrightarrow> ideal R mx \\<and>\n                      1\\<^sub>r \\<notin> mx \\<and>\n                      (\\<forall>x\\<in>carrier R.\n                          \\<forall>y\\<in>carrier R.\n                             x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                             x \\<in> mx \\<or> y \\<in> mx)", "apply (rule conjI, simp add:maximal_set_def,\n       rule conjI, simp add:maximal_set_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     ideal R mx \\<and>\n     S \\<inter> mx = {} \\<and>\n     (\\<forall>s.\n         ideal R s \\<and> S \\<inter> s = {} \\<longrightarrow>\n         mx \\<subseteq> s \\<longrightarrow> s = mx)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> mx\n 2. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                            x \\<in> mx \\<or> y \\<in> mx", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     ideal R mx \\<and>\n     S \\<inter> mx = {} \\<and>\n     (\\<forall>s.\n         ideal R s \\<and> S \\<inter> s = {} \\<longrightarrow>\n         mx \\<subseteq> s \\<longrightarrow> s = mx);\n     1\\<^sub>r \\<in> mx\\<rbrakk>\n    \\<Longrightarrow> False\n 2. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                            x \\<in> mx \\<or> y \\<in> mx", "apply ((erule conjE)+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>x\\<in>carrier R.\n                         \\<forall>y\\<in>carrier R.\n                            x \\<cdot>\\<^sub>r y \\<in> mx \\<longrightarrow>\n                            x \\<in> mx \\<or> y \\<in> mx", "apply ((rule ballI)+, rule impI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R;\n        x \\<cdot>\\<^sub>r y \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> x \\<in> mx \\<or> y \\<in> mx", "apply (rule contrapos_pp, simp+, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac a = x in id_ideal_psub_sum[of \"mx\"],\n               simp add:maximal_set_def, assumption+,\n       cut_tac a = y in id_ideal_psub_sum[of \"mx\"],\n               simp add:maximal_set_def, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx;\n        mx \\<subset> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n        mx \\<subset> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac J = \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\" in maximal_setTr[of \"S\" \"mx\"],\n       rule sum_ideals, simp add:maximal_set_def,\n       simp add:principal_ideal, assumption,\n       thin_tac \"mx \\<subset> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx;\n        mx \\<subset> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y;\n        S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x) \\<noteq>\n        {}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac J = \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y\" in maximal_setTr[of \"S\" \"mx\"],\n       rule sum_ideals, simp add:maximal_set_def,\n       simp add:principal_ideal, assumption,\n       thin_tac \"mx \\<subset> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx;\n        S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x) \\<noteq> {};\n        S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y) \\<noteq>\n        {}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac A = \"S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x)\" in nonempty_ex,\n       frule_tac A = \"S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y)\" in nonempty_ex,\n       (erule exE)+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y xa xb.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx;\n        S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x) \\<noteq> {};\n        S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y) \\<noteq> {};\n        xa \\<in> S; xa \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x;\n        xb \\<in> S;\n        xb \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y\\<rbrakk>\n       \\<Longrightarrow> False", "apply (rename_tac x y s1 s2,\n       thin_tac \"S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x) \\<noteq> {}\",\n       thin_tac \"S \\<inter> (mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y) \\<noteq> {}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y s1 s2.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; s1 \\<in> S;\n        s1 \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x; s2 \\<in> S;\n        s2 \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule maximal_set_idealTr,\n       frule_tac a = x in principal_ideal,\n       frule_tac a = y in principal_ideal,\n       frule ideal_subset1[of mx],\n       frule_tac I = \"R \\<diamondsuit>\\<^sub>p x\" in ideal_subset1,\n       frule_tac I = \"R \\<diamondsuit>\\<^sub>p y\" in ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y s1 s2.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; s1 \\<in> S;\n        s1 \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p x; s2 \\<in> S;\n        s2 \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p y; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_is_ag,\n       simp add:aGroup.set_sum[of R mx],\n       erule bexE, erule bexE, simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac s = s1 and t = s2 in mul_closed_set_tOp_closed, simp,\n       assumption, simp,\n       frule_tac c = h in subsetD[of mx \"carrier R\"], assumption+,\n       frule_tac c = k and A = \"R \\<diamondsuit>\\<^sub>p x\" in subsetD[of _ \"carrier R\"],\n       assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (\n       cut_tac mul_closed_set_sub,\n       frule_tac c = s2 in subsetD[of S \"carrier R\"], assumption+,\n       simp add:ring_distrib2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r s2 \\<plusminus> k \\<cdot>\\<^sub>r s2 \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        s2 \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply ((erule bexE)+, simp,\n       frule_tac c = ha in subsetD[of mx \"carrier R\"], assumption+,\n       frule_tac c = ka and A = \"R \\<diamondsuit>\\<^sub>p y\" in subsetD[of _ \"carrier R\"],\n       assumption+,\n       simp add:ring_distrib1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (frule_tac x = h and r = ha in ideal_ring_multiple1[of mx], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (frule_tac x = h and r = ka in ideal_ring_multiple1[of mx], assumption+,\n       frule_tac x = ha and r = k in ideal_ring_multiple[of mx], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (frule_tac a = x and b = y and x = k and y = ka in\n                  mul_two_principal_idealsTr, assumption+,\n       erule bexE,\n       frule_tac x = \"x \\<cdot>\\<^sub>r y\" and r = r in ideal_ring_multiple[of mx],\n       assumption+,\n       rotate_tac -2, frule sym, thin_tac \"k \\<cdot>\\<^sub>r ka = r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y)\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) =\n        k \\<cdot>\\<^sub>r ka\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (frule_tac x = \"h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka\" and y = \"k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka\" in\n        ideal_pOp_closed[of mx])"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) =\n        k \\<cdot>\\<^sub>r ka\\<rbrakk>\n       \\<Longrightarrow> h \\<cdot>\\<^sub>r ha \\<plusminus>\n                         h \\<cdot>\\<^sub>r ka\n                         \\<in> mx\n 2. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) =\n        k \\<cdot>\\<^sub>r ka\\<rbrakk>\n       \\<Longrightarrow> k \\<cdot>\\<^sub>r ha \\<plusminus>\n                         k \\<cdot>\\<^sub>r ka\n                         \\<in> mx\n 3. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) = k \\<cdot>\\<^sub>r ka;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 4. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (rule ideal_pOp_closed, assumption+)+"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) = k \\<cdot>\\<^sub>r ka;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply (simp add:maximal_set_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x y s1 s2 h k ha ka r.\n       \\<lbrakk>k \\<cdot>\\<^sub>r ka \\<in> mx; mul_closed_set R S;\n        1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        S \\<inter> mx = {} \\<and>\n        (\\<forall>s.\n            ideal R s \\<and> S \\<inter> s = {} \\<longrightarrow>\n            mx \\<subseteq> s \\<longrightarrow> s = mx);\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S;\n        ha \\<plusminus> ka \\<in> S; ideal R mx;\n        ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> S;\n        h \\<in> carrier R; k \\<in> carrier R; S \\<subseteq> carrier R;\n        ha \\<plusminus> ka \\<in> carrier R; ha \\<in> mx;\n        ka \\<in> R \\<diamondsuit>\\<^sub>p y; s2 = ha \\<plusminus> ka;\n        ha \\<in> carrier R; ka \\<in> carrier R;\n        h \\<cdot>\\<^sub>r ha \\<in> mx; h \\<cdot>\\<^sub>r ka \\<in> mx;\n        k \\<cdot>\\<^sub>r ha \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r (x \\<cdot>\\<^sub>r y) = k \\<cdot>\\<^sub>r ka;\n        h \\<cdot>\\<^sub>r ha \\<plusminus> h \\<cdot>\\<^sub>r ka \\<plusminus>\n        (k \\<cdot>\\<^sub>r ha \\<plusminus> k \\<cdot>\\<^sub>r ka)\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply blast"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x y s1 s2 h k.\n       \\<lbrakk>mul_closed_set R S; 1\\<^sub>r \\<in> S; \\<zero> \\<notin> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        x \\<in> carrier R; y \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<notin> mx; y \\<notin> mx; h \\<plusminus> k \\<in> S; s2 \\<in> S;\n        \\<exists>h\\<in>mx.\n           \\<exists>k\\<in>R \\<diamondsuit>\\<^sub>p y. s2 = h \\<plusminus> k;\n        ideal R mx; ideal R (R \\<diamondsuit>\\<^sub>p x);\n        ideal R (R \\<diamondsuit>\\<^sub>p y); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p x \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p y \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p x;\n        s1 = h \\<plusminus> k;\n        (h \\<plusminus> k) \\<cdot>\\<^sub>r s2 \\<in> S; h \\<in> carrier R;\n        k \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R S", "apply assumption"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ex_mulDisj_maximal:\"\\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n       T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk> \\<Longrightarrow>  \\<exists>mx. maximal_set T mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (cut_tac A=\"{ I. ideal R I \\<and> S \\<inter> I = {}}\" in Zorn_Lemma2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>C\\<in>chains\n{I. ideal R I \\<and> S \\<inter> I = {}}.\n                         \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     \\<exists>M\\<in>{I. ideal R I \\<and> S \\<inter> I = {}}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> S \\<inter> I = {}}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "prefer 2"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}};\n     \\<exists>M\\<in>{I. ideal R I \\<and> S \\<inter> I = {}}.\n        \\<forall>X\\<in>{I. ideal R I \\<and> S \\<inter> I = {}}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx\n 2. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>C\\<in>chains\n{I. ideal R I \\<and> S \\<inter> I = {}}.\n                         \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U", "apply (simp add:maximal_set_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n     T = {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>C\\<in>chains\n{I. ideal R I \\<and> S \\<inter> I = {}}.\n                         \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U", "apply (rule ballI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U", "apply (case_tac \"C = {}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U", "apply (cut_tac zero_ideal, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U", "apply (subgoal_tac \"C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (frule chains_un, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (subgoal_tac \"S \\<inter> (\\<Union> C) = {}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{I.\n   ideal R I \\<and> S \\<inter> I = {}}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> S \\<inter> \\<Union> C = {}\n 3. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (subgoal_tac \"\\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\",  blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> S \\<inter> \\<Union> C = {}\n 3. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (rule ballI, rule subsetI, simp add:CollectI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C x xa.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C = {}; x \\<in> C;\n        xa \\<in> x\\<rbrakk>\n       \\<Longrightarrow> \\<exists>X\\<in>C. xa \\<in> X\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> S \\<inter> \\<Union> C = {}\n 3. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> S \\<inter> \\<Union> C = {}\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (frule_tac A = S and B = \"\\<Union> C\" in nonempty_int)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {};\n        \\<exists>x. x \\<in> S \\<inter> \\<Union> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {};\n        x \\<in> S \\<inter> \\<Union> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (simp, erule conjE, erule bexE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C x X.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {}; x \\<in> S;\n        X \\<in> C; x \\<in> X\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (simp add:chains_def, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C x X.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}}; C \\<noteq> {};\n        C \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {}; x \\<in> S;\n        X \\<in> C; x \\<in> X;\n        C \\<subseteq> {I. ideal R I \\<and> S \\<inter> I = {}};\n        chain\\<^sub>\\<subseteq> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (frule_tac c = X and A = C and B = \"{I. ideal R I \\<and> S \\<inter> I = {}}\" in\n        subsetD, assumption+,\n        thin_tac \"C \\<subseteq> {I. ideal R I \\<and> I \\<subset> carrier R}\",\n        thin_tac \"C \\<subseteq> {I. ideal R I \\<and> S \\<inter> I = {}}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C x X.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}}; C \\<noteq> {};\n        ideal R (\\<Union> C); S \\<inter> \\<Union> C \\<noteq> {}; x \\<in> S;\n        X \\<in> C; x \\<in> X; chain\\<^sub>\\<subseteq> C;\n        X \\<in> {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (simp, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<in> chains {I. ideal R I \\<and> S \\<inter> I = {}};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}", "apply (simp add:chains_def chain_subset_def, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}}; C \\<noteq> {};\n        C \\<subseteq> {I. ideal R I \\<and> S \\<inter> I = {}};\n        \\<forall>A\\<in>C.\n           \\<forall>B\\<in>C. A \\<subseteq> B \\<or> B \\<subseteq> A\\<rbrakk>\n       \\<Longrightarrow> C \\<subseteq> {I.\n  ideal R I \\<and> I \\<subset> carrier R}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        T = {I. ideal R I \\<and> S \\<inter> I = {}}; C \\<noteq> {};\n        C \\<subseteq> {I. ideal R I \\<and> S \\<inter> I = {}};\n        \\<forall>A\\<in>C.\n           \\<forall>B\\<in>C. A \\<subseteq> B \\<or> B \\<subseteq> A;\n        x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}", "apply (frule_tac c = x and A = C and B = \"{I. ideal R I \\<and> S \\<inter> I = {}}\" in\n                  subsetD, assumption+,\n        thin_tac \"C \\<subseteq> {I. ideal R I \\<and> S \\<inter> I = {}}\",\n        thin_tac \"T = {I. ideal R I \\<and> S \\<inter> I = {}}\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        C \\<noteq> {};\n        \\<forall>A\\<in>C.\n           \\<forall>B\\<in>C. A \\<subseteq> B \\<or> B \\<subseteq> A;\n        x \\<in> C; x \\<in> {I. ideal R I \\<and> S \\<inter> I = {}}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {I. ideal R I \\<and> I \\<subset> carrier R}", "apply (simp, thin_tac \"\\<forall>x\\<in>C. \\<forall>y\\<in>C. x \\<subseteq> y \\<or> y \\<subseteq> x\", erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        C \\<noteq> {}; x \\<in> C; ideal R x; S \\<inter> x = {}\\<rbrakk>\n       \\<Longrightarrow> x \\<subset> carrier R", "apply (simp add:psubset_eq ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        C \\<noteq> {}; x \\<in> C; ideal R x; S \\<inter> x = {}\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> carrier R", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        C \\<noteq> {}; carrier R \\<in> C; ideal R (carrier R);\n        S \\<inter> carrier R = {}; x = carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (rotate_tac -1, frule sym, thin_tac \"x = carrier R\",\n        thin_tac \"carrier R = x\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>C x.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        C \\<noteq> {}; carrier R \\<in> C; ideal R (carrier R);\n        S \\<inter> carrier R = {}\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_one, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ex_mulDisj_prime:\"\\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S\\<rbrakk> \\<Longrightarrow>\n                            \\<exists>mx. prime_ideal R mx \\<and> S \\<inter> mx = {}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S;\n     1\\<^sub>r \\<in> S\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx.\n                         prime_ideal R mx \\<and> S \\<inter> mx = {}", "apply (frule ex_mulDisj_maximal[of \"S\" \"{I. ideal R I \\<and> S \\<inter> I = {}}\"],\n               assumption+, simp, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>mx.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx.\n                            prime_ideal R mx \\<and> S \\<inter> mx = {}", "apply (frule_tac mx = mx in mulDisj [of \"S\" \"{I. ideal R I \\<and> S \\<inter> I = {}}\"],\n                  assumption+, simp, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>mx.\n       \\<lbrakk>mul_closed_set R S; \\<zero> \\<notin> S; 1\\<^sub>r \\<in> S;\n        maximal_set {I. ideal R I \\<and> S \\<inter> I = {}} mx;\n        prime_ideal R mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx.\n                            prime_ideal R mx \\<and> S \\<inter> mx = {}", "apply (simp add:maximal_set_def, (erule conjE)+, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nilradTr1:\"\\<not> zeroring R \\<Longrightarrow> nilrad R = \\<Inter> {p. prime_ideal R p}\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> zeroring R \\<Longrightarrow>\n    nilrad R = \\<Inter> {p. prime_ideal R p}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<not> zeroring R \\<Longrightarrow>\n    nilrad R \\<subseteq> \\<Inter> {p. prime_ideal R p}\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "(* nilrad R \\<subseteq> \\<Inter>Collect (prime_ideal R) *)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<not> zeroring R \\<Longrightarrow>\n    nilrad R \\<subseteq> \\<Inter> {p. prime_ideal R p}\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (rule subsetI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> \\<Inter> {p. prime_ideal R p}\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (simp add:nilrad_def CollectI nilpotent_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R;\n        x \\<in> carrier R \\<and>\n        (\\<exists>n. x^\\<^bsup>R n\\<^esup> = \\<zero>)\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            prime_ideal R xa \\<longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (erule conjE, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<forall>xa.\n                            prime_ideal R xa \\<longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (rule allI, rule impI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>; prime_ideal R xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (frule_tac prime_ideal_ideal)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> = \\<zero>; prime_ideal R xa;\n        ideal R xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (frule sym, thin_tac \"x^\\<^bsup>R n\\<^esup> = \\<zero>\", frule ideal_zero, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R; prime_ideal R xa;\n        ideal R xa; \\<zero> = x^\\<^bsup>R n\\<^esup>;\n        x^\\<^bsup>R n\\<^esup> \\<in> xa\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (case_tac \"n = 0\", simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R; prime_ideal R xa;\n        ideal R xa; \\<zero> = 1\\<^sub>r; 1\\<^sub>r \\<in> xa; n = 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R; prime_ideal R xa;\n        ideal R xa; \\<zero> = x^\\<^bsup>R n\\<^esup>;\n        x^\\<^bsup>R n\\<^esup> \\<in> xa; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 3. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (frule Zero_ring1[THEN not_sym], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x n xa.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R; prime_ideal R xa;\n        ideal R xa; \\<zero> = x^\\<^bsup>R n\\<^esup>;\n        x^\\<^bsup>R n\\<^esup> \\<in> xa; n \\<noteq> 0\\<rbrakk>\n       \\<Longrightarrow> x \\<in> xa\n 2. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (rule_tac P = xa and x = x in npow_in_prime,assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<not> zeroring R \\<Longrightarrow>\n    \\<Inter> {p. prime_ideal R p} \\<subseteq> nilrad R", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R;\n        x \\<in> \\<Inter> {p. prime_ideal R p}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> nilrad R", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule id_maximal_Exist, erule exE,\n        frule maximal_prime)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = I in forall_spec, assumption,\n        frule_tac I = I in prime_ideal_ideal,\n        frule_tac h = x and I = I in ideal_subset, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (subgoal_tac \"\\<zero> \\<notin> {s. \\<exists>n. s = npow R x n} \\<and>\n                                  1\\<^sub>r \\<in> {s. \\<exists>n. s = npow R x n}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (subgoal_tac \"mul_closed_set R {s. \\<exists>n. s = npow R x n}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        mul_closed_set R {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        mul_closed_set R {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (frule_tac S = \"{s. \\<exists>n. s = npow R x n}\" in ex_mulDisj_prime,\n       assumption+, erule exE, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I mx.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        mul_closed_set R {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        prime_ideal R mx;\n        {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<inter> mx = {}\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (subgoal_tac \"x \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\", blast)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I mx.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        mul_closed_set R {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        prime_ideal R mx;\n        {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<inter> mx = {}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply simp"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I mx.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; ideal R I;\n        x \\<in> carrier R;\n        mul_closed_set R {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>};\n        \\<forall>n. \\<zero> \\<noteq> x^\\<^bsup>R n\\<^esup>;\n        \\<exists>n. 1\\<^sub>r = x^\\<^bsup>R n\\<^esup>; prime_ideal R mx;\n        {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<inter> mx = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x = x^\\<^bsup>R n\\<^esup>\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (cut_tac t = x in np_1[THEN sym], assumption, blast)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R;\n        \\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and>\n        1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (thin_tac \"\\<zero> \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>} \\<and> 1\\<^sub>r \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\",\n       thin_tac \"\\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> mul_closed_set R\n                          {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (subst mul_closed_set_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n                         \\<subseteq> carrier R \\<and>\n                         (\\<forall>s\\<in>{s.\n    \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                             \\<forall>t\n\\<in>{s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                                s \\<cdot>\\<^sub>r t\n                                \\<in> {s.\n \\<exists>n. s = x^\\<^bsup>R n\\<^esup>})\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (rule conjI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n                         \\<subseteq> carrier R\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s\\<in>{s.\n   \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                            \\<forall>t\\<in>{s.\n      \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                               s \\<cdot>\\<^sub>r t\n                               \\<in> {s.\n\\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (rule subsetI, simp, erule exE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x I xa n.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R;\n        xa = x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> xa \\<in> carrier R\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s\\<in>{s.\n   \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                            \\<forall>t\\<in>{s.\n      \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                               s \\<cdot>\\<^sub>r t\n                               \\<in> {s.\n\\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 3. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (simp add:npClose)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>s\\<in>{s.\n   \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                            \\<forall>t\\<in>{s.\n      \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}.\n                               s \\<cdot>\\<^sub>r t\n                               \\<in> {s.\n\\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply ((rule ballI)+, simp, (erule exE)+, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I s t n na.\n       \\<lbrakk>\\<not> zeroring R; x \\<notin> nilrad R; maximal_ideal R I;\n        prime_ideal R I; x \\<in> I; ideal R I; x \\<in> carrier R;\n        s = x^\\<^bsup>R n\\<^esup>; t = x^\\<^bsup>R na\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>nb.\n                            x^\\<^bsup>R n\\<^esup> \\<cdot>\\<^sub>r\n                            x^\\<^bsup>R na\\<^esup> =\n                            x^\\<^bsup>R nb\\<^esup>\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (simp add:npMulDistr, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n.\n   s = x^\\<^bsup>R n\\<^esup>} \\<and>\n                         1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (rule conjI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<zero>\n                         \\<notin> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; ideal R I;\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<forall>n. \\<zero> \\<noteq> x^\\<^bsup>R n\\<^esup>\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (rule contrapos_pp, simp+, erule exE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I n.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; ideal R I;\n        x \\<in> carrier R; \\<zero> = x^\\<^bsup>R n\\<^esup>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (frule sym, thin_tac \"\\<zero> = x^\\<^bsup>R n\\<^esup>\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x I n.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; ideal R I;\n        x \\<in> carrier R; x^\\<^bsup>R n\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply (simp add:nilrad_def nilpotent_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; x \\<in> I;\n        ideal R I; x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r\n                         \\<in> {s. \\<exists>n. s = x^\\<^bsup>R n\\<^esup>}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x I.\n       \\<lbrakk>\\<not> zeroring R;\n        \\<forall>xa. prime_ideal R xa \\<longrightarrow> x \\<in> xa;\n        x \\<notin> nilrad R; maximal_ideal R I; prime_ideal R I; ideal R I;\n        x \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. 1\\<^sub>r = x^\\<^bsup>R n\\<^esup>", "apply (cut_tac x1 = x in npow_0[THEN sym, of \"R\"], blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nonilp_residue_nilrad:\"\\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        nilpotent (qring R (nilrad R)) (x \\<uplus>\\<^bsub>R\\<^esub> (nilrad R))\\<rbrakk> \\<Longrightarrow>\n                   x \\<uplus>\\<^bsub>R\\<^esub> (nilrad R) = \\<zero>\\<^bsub>(qring R (nilrad R))\\<^esub>\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n     nilpotent (R /\\<^sub>r nilrad R)\n      (x \\<uplus>\\<^bsub>R\\<^esub> nilrad R)\\<rbrakk>\n    \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R =\n                      \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>", "apply (simp add:nilpotent_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n     \\<exists>n.\n        (x \\<uplus>\\<^bsub>R\\<^esub> nilrad\nR)^\\<^bsup>R /\\<^sub>r nilrad R n\\<^esup> =\n        \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>\\<rbrakk>\n    \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R =\n                      \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>", "apply (erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        (x \\<uplus>\\<^bsub>R\\<^esub> nilrad\nR)^\\<^bsup>R /\\<^sub>r nilrad R n\\<^esup> =\n        \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R =\n                         \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>", "apply (cut_tac id_nilrad_ideal)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        (x \\<uplus>\\<^bsub>R\\<^esub> nilrad\nR)^\\<^bsup>R /\\<^sub>r nilrad R n\\<^esup> =\n        \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>;\n        ideal R (nilrad R)\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R =\n                         \\<zero>\\<^bsub>R /\\<^sub>r nilrad R\\<^esub>", "apply (simp add:qring_zero)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        (x \\<uplus>\\<^bsub>R\\<^esub> nilrad\nR)^\\<^bsup>R /\\<^sub>r nilrad R n\\<^esup> =\n        nilrad R;\n        ideal R (nilrad R)\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R", "apply (cut_tac \"Ring\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        (x \\<uplus>\\<^bsub>R\\<^esub> nilrad\nR)^\\<^bsup>R /\\<^sub>r nilrad R n\\<^esup> =\n        nilrad R;\n        ideal R (nilrad R); Ring R\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R", "apply (simp add:npQring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R;\n        ideal R (nilrad R); Ring R\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R", "apply (frule_tac x = x and n = n in npClose)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R;\n        ideal R (nilrad R); Ring R;\n        x^\\<^bsup>R n\\<^esup> \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R", "apply (frule_tac I = \"nilrad R\" and a = \"x^\\<^bsup>R n\\<^esup>\" in ar_coset_same3,\n             assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R;\n        ideal R (nilrad R); Ring R; x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> x \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R", "apply (rule_tac I = \"nilrad R\" and a = x in ar_coset_same4, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R;\n        ideal R (nilrad R); Ring R; x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup> \\<in> nilrad R\\<rbrakk>\n       \\<Longrightarrow> x \\<in> nilrad R", "apply (thin_tac \"x^\\<^bsup>R n\\<^esup> \\<uplus>\\<^bsub>R\\<^esub> nilrad R = nilrad R\",\n        simp add:nilrad_def nilpotent_def, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>n na.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> carrier R;\n        ideal R\n         {x \\<in> carrier R. \\<exists>n. x^\\<^bsup>R n\\<^esup> = \\<zero>};\n        Ring R; x^\\<^bsup>R n\\<^esup> \\<in> carrier R;\n        x^\\<^bsup>R n\\<^esup>^\\<^bsup>R na\\<^esup> = \\<zero>\\<rbrakk>\n       \\<Longrightarrow> \\<exists>n. x^\\<^bsup>R n\\<^esup> = \\<zero>", "apply (simp add:npMulExp, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ex_contid_maximal:\"\\<lbrakk> S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I; I \\<inter> S = {};\nT = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}\\<rbrakk> \\<Longrightarrow> \\<exists>mx. maximal_set T mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T =\n     {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (cut_tac A=\"{J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}\" in Zorn_Lemma2)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T =\n     {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}\\<rbrakk>\n    \\<Longrightarrow> \\<forall>C\\<in>chains\n{J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                         \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (case_tac \"C = {}\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "(** case C = {} **)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C = {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "(** case C = {} done **)\n     (** existence of sup in C **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (subgoal_tac \"\\<Union>C\\<in>{J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J} \\<and>\n                                         (\\<forall>x\\<in>C. x \\<subseteq>  \\<Union>C)\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        \\<Union> C\n        \\<in> {J. ideal R J \\<and>\n                  S \\<inter> J = {} \\<and> I \\<subseteq> J} \\<and>\n        (\\<forall>x\\<in>C. x \\<subseteq> \\<Union> C)\\<rbrakk>\n       \\<Longrightarrow> \\<exists>U\\<in>{J.\n   ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n                            \\<forall>X\\<in>C. X \\<subseteq> U\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C\n                         \\<in> {J. ideal R J \\<and>\n                                   S \\<inter> J = {} \\<and>\n                                   I \\<subseteq> J} \\<and>\n                         (\\<forall>x\\<in>C. x \\<subseteq> \\<Union> C)\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply blast"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<Union> C\n                         \\<in> {J. ideal R J \\<and>\n                                   S \\<inter> J = {} \\<and>\n                                   I \\<subseteq> J} \\<and>\n                         (\\<forall>x\\<in>C. x \\<subseteq> \\<Union> C)\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule conjI,\n       simp add:CollectI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> ideal R (\\<Union> C) \\<and>\n                         (\\<forall>x\\<in>C. 1\\<^sub>r \\<notin> x) \\<and>\n                         I \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (subgoal_tac \"C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> ideal R (\\<Union> C) \\<and>\n                         (\\<forall>x\\<in>C. 1\\<^sub>r \\<notin> x) \\<and>\n                         I \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 4. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule conjI,\n       simp add:chains_un)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> (\\<forall>x\\<in>C. 1\\<^sub>r \\<notin> x) \\<and>\n                         I \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 4. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule conjI)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. 1\\<^sub>r \\<notin> x\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 4. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 5. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule contrapos_pp, simp+, erule bexE)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R};\n        x \\<in> C; 1\\<^sub>r \\<in> x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 4. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 5. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (thin_tac \" C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\")"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}; x \\<in> C; 1\\<^sub>r \\<in> x\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 4. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 5. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (simp add:chains_def, erule conjE)"], ["proof (prove)\ngoal (5 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}; x \\<in> C; 1\\<^sub>r \\<in> x;\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C\\<rbrakk>\n       \\<Longrightarrow> False\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 4. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 5. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (frule_tac c = x and A = C and B = \"{J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J}\"\n         in subsetD, assumption+, simp,\n        thin_tac \"C \\<in> chains {I. ideal R I \\<and> I \\<subset> carrier R}\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 4. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (frule_tac A = C in nonempty_ex, erule exE, simp add:chains_def,\n        erule conjE,\n        frule_tac c = x and A = C and B = \"{J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J}\" in\n                  subsetD, assumption+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}; x \\<in> C;\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C; ideal R x; 1\\<^sub>r \\<notin> x;\n        I \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> I \\<subseteq> \\<Union> C\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 3. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 4. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule_tac A = I and B = x and C = \"\\<Union>C\" in subset_trans, assumption,\n        rule_tac B = x and A = C in Union_upper, assumption+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> C \\<in> chains\n                                  {I. ideal R I \\<and>\nI \\<subset> carrier R}\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (simp add:chains_def, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C\\<rbrakk>\n       \\<Longrightarrow> C \\<subseteq> {I.\n  ideal R I \\<and> I \\<subset> carrier R}\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> x \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (frule_tac c = x and A = C and B = \"{J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J}\"\n        in subsetD, assumption+, simp, (erule conjE)+)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C; x \\<in> C; ideal R x;\n        1\\<^sub>r \\<notin> x; I \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x \\<subset> carrier R\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (subst psubset_eq, simp add:ideal_subset1)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        C \\<noteq> {};\n        C \\<subseteq> {J. ideal R J \\<and>\n                          1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        chain\\<^sub>\\<subseteq> C; x \\<in> C; ideal R x;\n        1\\<^sub>r \\<notin> x; I \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x \\<noteq> carrier R\n 2. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule contrapos_pp, simp+, simp add:ring_one)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}\\<rbrakk>\n       \\<Longrightarrow> \\<forall>x\\<in>C. x \\<subseteq> \\<Union> C\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule ballI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>C x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<in> chains\n                 {J. ideal R J \\<and>\n                     S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        C \\<noteq> {}; x \\<in> C\\<rbrakk>\n       \\<Longrightarrow> x \\<subseteq> \\<Union> C\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (rule Union_upper, assumption)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     \\<exists>M\\<in>{J. ideal R J \\<and>\n                        S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n        I \\<inter> S = {};\n        T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        M \\<in> {J. ideal R J \\<and>\n                    S \\<inter> J = {} \\<and> I \\<subseteq> J};\n        \\<forall>X\\<in>{J. ideal R J \\<and>\n                           S \\<inter> J = {} \\<and> I \\<subseteq> J}.\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx. maximal_set T mx", "apply (simp add:maximal_set_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>M.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R M \\<and> 1\\<^sub>r \\<notin> M \\<and> I \\<subseteq> M;\n        \\<forall>X.\n           ideal R X \\<and>\n           1\\<^sub>r \\<notin> X \\<and> I \\<subseteq> X \\<longrightarrow>\n           M \\<subseteq> X \\<longrightarrow> X = M\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx.\n                            ideal R mx \\<and>\n                            1\\<^sub>r \\<notin> mx \\<and>\n                            I \\<subseteq> mx \\<and>\n                            (\\<forall>s.\n                                ideal R s \\<and>\n                                1\\<^sub>r \\<notin> s \\<and>\n                                I \\<subseteq> s \\<longrightarrow>\n                                mx \\<subseteq> s \\<longrightarrow> s = mx)", "apply blast"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) contid_maximal:\"\\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I; I \\<inter> S = {};\n             T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J}; maximal_set T mx\\<rbrakk> \\<Longrightarrow>\n                                                maximal_ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<notin> S; ideal R I;\n     I \\<inter> S = {};\n     T = {J. ideal R J \\<and> S \\<inter> J = {} \\<and> I \\<subseteq> J};\n     maximal_set T mx\\<rbrakk>\n    \\<Longrightarrow> maximal_ideal R mx", "apply (simp add:maximal_set_def maximal_ideal_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx \\<and>\n     1\\<^sub>r \\<notin> mx \\<and>\n     I \\<subseteq> mx \\<and>\n     (\\<forall>s.\n         ideal R s \\<and>\n         1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n         mx \\<subseteq> s \\<longrightarrow> s = mx)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J} =\n                      {mx, carrier R}", "apply (erule conjE)+"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J} =\n                      {mx, carrier R}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J}\n                      \\<subseteq> {mx, carrier R}\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "(** {J. ideal R J \\<and> mx \\<subseteq> J} \\<subseteq> {mx, carrier R} **)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J}\n                      \\<subseteq> {mx, carrier R}\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (rule subsetI, simp add:CollectI, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n        \\<forall>s.\n           ideal R s \\<and>\n           1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n           mx \\<subseteq> s \\<longrightarrow> s = mx;\n        ideal R x; mx \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (case_tac \"x = mx\", simp, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n        \\<forall>s.\n           ideal R s \\<and>\n           1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n           mx \\<subseteq> s \\<longrightarrow> s = mx;\n        ideal R x; mx \\<subseteq> x; x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = carrier R\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (subgoal_tac \"1\\<^sub>r \\<in> x\")"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n        \\<forall>s.\n           ideal R s \\<and>\n           1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n           mx \\<subseteq> s \\<longrightarrow> s = mx;\n        ideal R x; mx \\<subseteq> x; x \\<noteq> mx;\n        1\\<^sub>r \\<in> x\\<rbrakk>\n       \\<Longrightarrow> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n        \\<forall>s.\n           ideal R s \\<and>\n           1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n           mx \\<subseteq> s \\<longrightarrow> s = mx;\n        ideal R x; mx \\<subseteq> x; x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> x\n 3. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (rule_tac  I = x in ideal_inc_one, assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n        1\\<^sub>r \\<notin> I;\n        T =\n        {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n        ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n        \\<forall>s.\n           ideal R s \\<and>\n           1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n           mx \\<subseteq> s \\<longrightarrow> s = mx;\n        ideal R x; mx \\<subseteq> x; x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<in> x\n 2. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     \\<forall>s.\n        ideal R s \\<and>\n        1\\<^sub>r \\<notin> s \\<and> I \\<subseteq> s \\<longrightarrow>\n        mx \\<subseteq> s \\<longrightarrow> s = mx\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R) \\<and> mx \\<subseteq> carrier R", "apply (drule spec[of _ mx])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>S = {1\\<^sub>r}; \\<zero> \\<noteq> 1\\<^sub>r; ideal R I;\n     1\\<^sub>r \\<notin> I;\n     T = {J. ideal R J \\<and> 1\\<^sub>r \\<notin> J \\<and> I \\<subseteq> J};\n     ideal R mx; 1\\<^sub>r \\<notin> mx; I \\<subseteq> mx;\n     ideal R mx \\<and>\n     1\\<^sub>r \\<notin> mx \\<and> I \\<subseteq> mx \\<longrightarrow>\n     mx \\<subseteq> mx \\<longrightarrow> mx = mx\\<rbrakk>\n    \\<Longrightarrow> ideal R (carrier R) \\<and> mx \\<subseteq> carrier R", "apply (simp add:whole_ideal,\n        rule subsetI, rule ideal_subset[of \"mx\"], assumption+)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) ideal_contained_maxid:\"\\<lbrakk>\\<not>(zeroring R); ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk> \\<Longrightarrow>\n                    \\<exists>mx. maximal_ideal R mx \\<and> I \\<subseteq> mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx.\n                         maximal_ideal R mx \\<and> I \\<subseteq> mx", "apply (cut_tac ex_contid_maximal[of \"{1\\<^sub>r}\" \"I\"\n                      \"{J. ideal R J \\<and> {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\"])"], ["proof (prove)\ngoal (6 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n     \\<exists>mx.\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx.\n                         maximal_ideal R mx \\<and> I \\<subseteq> mx\n 2. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> {1\\<^sub>r} = {1\\<^sub>r}\n 3. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<notin> {1\\<^sub>r}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> ideal R I\n 5. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> {1\\<^sub>r} = {}\n 6. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and>\n                          {1\\<^sub>r} \\<inter> J = {} \\<and>\n                          I \\<subseteq> J} =\n                      {J. ideal R J \\<and>\n                          {1\\<^sub>r} \\<inter> J = {} \\<and>\n                          I \\<subseteq> J}", "apply (erule exE,\n       cut_tac mx = mx in contid_maximal[of \"{1\\<^sub>r}\" \"I\"\n                         \"{J. ideal R J \\<and> {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\"])"], ["proof (prove)\ngoal (12 subgoals):\n 1. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> {1\\<^sub>r} = {1\\<^sub>r}\n 2. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<notin> {1\\<^sub>r}\n 3. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> ideal R I\n 4. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> I \\<inter> {1\\<^sub>r} = {}\n 5. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> {J. ideal R J \\<and>\n                             {1\\<^sub>r} \\<inter> J = {} \\<and>\n                             I \\<subseteq> J} =\n                         {J. ideal R J \\<and>\n                             {1\\<^sub>r} \\<inter> J = {} \\<and>\n                             I \\<subseteq> J}\n 6. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> maximal_set\n                          {J. ideal R J \\<and>\n                              {1\\<^sub>r} \\<inter> J = {} \\<and>\n                              I \\<subseteq> J}\n                          mx\n 7. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx;\n        maximal_ideal R mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx.\n                            maximal_ideal R mx \\<and> I \\<subseteq> mx\n 8. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> {1\\<^sub>r} = {1\\<^sub>r}\n 9. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<notin> {1\\<^sub>r}\n 10. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n     \\<Longrightarrow> ideal R I\nA total of 12 subgoals...", "apply simp"], ["proof (prove)\ngoal (11 subgoals):\n 1. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> \\<zero> \\<notin> {1\\<^sub>r}\n 2. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> ideal R I\n 3. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> I \\<inter> {1\\<^sub>r} = {}\n 4. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> {J. ideal R J \\<and>\n                             {1\\<^sub>r} \\<inter> J = {} \\<and>\n                             I \\<subseteq> J} =\n                         {J. ideal R J \\<and>\n                             {1\\<^sub>r} \\<inter> J = {} \\<and>\n                             I \\<subseteq> J}\n 5. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx\\<rbrakk>\n       \\<Longrightarrow> maximal_set\n                          {J. ideal R J \\<and>\n                              {1\\<^sub>r} \\<inter> J = {} \\<and>\n                              I \\<subseteq> J}\n                          mx\n 6. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I;\n        maximal_set\n         {J. ideal R J \\<and>\n             {1\\<^sub>r} \\<inter> J = {} \\<and> I \\<subseteq> J}\n         mx;\n        maximal_ideal R mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx.\n                            maximal_ideal R mx \\<and> I \\<subseteq> mx\n 7. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> {1\\<^sub>r} = {1\\<^sub>r}\n 8. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> \\<zero> \\<notin> {1\\<^sub>r}\n 9. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> ideal R I\n 10. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n     \\<Longrightarrow> I \\<inter> {1\\<^sub>r} = {}\nA total of 11 subgoals...", "apply (frule Zero_ring1, simp,\n        assumption, simp, simp, simp,\n        simp add:maximal_set_def, (erule conjE)+, blast,\n        simp, frule Zero_ring1, simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> ideal R I\n 2. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> I \\<inter> {1\\<^sub>r} = {}\n 3. \\<lbrakk>\\<not> zeroring R; ideal R I; 1\\<^sub>r \\<notin> I\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and>\n                          {1\\<^sub>r} \\<inter> J = {} \\<and>\n                          I \\<subseteq> J} =\n                      {J. ideal R J \\<and>\n                          {1\\<^sub>r} \\<inter> J = {} \\<and>\n                          I \\<subseteq> J}", "apply (assumption, simp, simp)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nonunit_principal_id:\"\\<lbrakk>a \\<in> carrier R; \\<not> (Unit R a)\\<rbrakk> \\<Longrightarrow>\n                                             (R \\<diamondsuit>\\<^sub>p a) \\<noteq> (carrier R)\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> R \\<diamondsuit>\\<^sub>p a \\<noteq> carrier R", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a;\n     R \\<diamondsuit>\\<^sub>p a = carrier R\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule sym, thin_tac \"R \\<diamondsuit>\\<^sub>p a = carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a;\n     carrier R = R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply (cut_tac ring_one)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a;\n     carrier R = R \\<diamondsuit>\\<^sub>p a;\n     1\\<^sub>r \\<in> carrier R\\<rbrakk>\n    \\<Longrightarrow> False", "apply (frule eq_set_inc[of \"1\\<^sub>r\" \"carrier R\" \"R \\<diamondsuit>\\<^sub>p a\"], assumption,\n        thin_tac \"carrier R = R \\<diamondsuit>\\<^sub>p a\", thin_tac \"1\\<^sub>r \\<in> carrier R\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a;\n     1\\<^sub>r \\<in> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n    \\<Longrightarrow> False", "apply (simp add:Rxa_def, erule bexE, simp add:ring_tOp_commute[of _ \"a\"],\n       frule sym, thin_tac \"1\\<^sub>r = a \\<cdot>\\<^sub>r r\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>r.\n       \\<lbrakk>a \\<in> carrier R; \\<not> Unit R a; r \\<in> carrier R;\n        a \\<cdot>\\<^sub>r r = 1\\<^sub>r\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:Unit_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) nonunit_contained_maxid:\"\\<lbrakk>\\<not>(zeroring R); a \\<in> carrier R;\n                \\<not> Unit R a \\<rbrakk>  \\<Longrightarrow>  \\<exists>mx. maximal_ideal R mx \\<and> a \\<in>  mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_ideal R mx \\<and> a \\<in> mx", "apply (frule principal_ideal[of \"a\"],\n       frule ideal_contained_maxid[of \"R \\<diamondsuit>\\<^sub>p a\"], assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a;\n     ideal R (R \\<diamondsuit>\\<^sub>p a)\\<rbrakk>\n    \\<Longrightarrow> 1\\<^sub>r \\<notin> R \\<diamondsuit>\\<^sub>p a\n 2. \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     \\<exists>mx.\n        maximal_ideal R mx \\<and>\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_ideal R mx \\<and> a \\<in> mx", "apply (rule contrapos_pp, simp+,\n        frule ideal_inc_one[of \"R \\<diamondsuit>\\<^sub>p a\"], assumption,\n        simp add:nonunit_principal_id)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a;\n     ideal R (R \\<diamondsuit>\\<^sub>p a);\n     \\<exists>mx.\n        maximal_ideal R mx \\<and>\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> mx\\<rbrakk>\n    \\<Longrightarrow> \\<exists>mx. maximal_ideal R mx \\<and> a \\<in> mx", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a;\n        ideal R (R \\<diamondsuit>\\<^sub>p a); maximal_ideal R mx;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> mx\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx. maximal_ideal R mx \\<and> a \\<in> mx", "apply (frule a_in_principal[of \"a\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>mx.\n       \\<lbrakk>\\<not> zeroring R; a \\<in> carrier R; \\<not> Unit R a;\n        ideal R (R \\<diamondsuit>\\<^sub>p a); maximal_ideal R mx;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> mx;\n        a \\<in> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> \\<exists>mx. maximal_ideal R mx \\<and> a \\<in> mx", "apply (frule_tac B = mx in subsetD[of \"R \\<diamondsuit>\\<^sub>p a\" _ \"a\"], assumption, blast)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  local_ring :: \"_ \\<Rightarrow> bool\" where\n  \"local_ring R == Ring R \\<and> \\<not> zeroring R \\<and> card {mx. maximal_ideal R mx} = 1\""], ["", "lemma (in Ring) local_ring_diff:\"\\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n  \\<forall>a\\<in> (carrier R - mx). Unit R a \\<rbrakk> \\<Longrightarrow> local_ring R \\<and> maximal_ideal R mx\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> local_ring R \\<and> maximal_ideal R mx", "apply (subgoal_tac \"{mx} = {m. maximal_ideal R m}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a;\n     {mx} = {m. maximal_ideal R m}\\<rbrakk>\n    \\<Longrightarrow> local_ring R \\<and> maximal_ideal R mx\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {mx} = {m. maximal_ideal R m}", "apply (cut_tac singletonI[of \"mx\"], simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a; {mx} = {m. maximal_ideal R m};\n     maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {mx} = {m. maximal_ideal R m}", "apply (frule sym, thin_tac \"{mx} = {m. maximal_ideal R m}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R mx;\n     {m. maximal_ideal R m} = {mx}\\<rbrakk>\n    \\<Longrightarrow> local_ring R\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {mx} = {m. maximal_ideal R m}", "apply (simp add:local_ring_def, simp add:Ring)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {mx} = {m. maximal_ideal R m}", "apply (rule equalityI)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {mx} \\<subseteq> {m. maximal_ideal R m}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; x = mx\\<rbrakk>\n       \\<Longrightarrow> maximal_ideal R mx\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; x = mx\\<rbrakk>\n       \\<Longrightarrow> 1\\<^sub>r \\<notin> mx \\<and>\n                         {J. ideal R J \\<and> mx \\<subseteq> J} =\n                         {mx, carrier R}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (simp add:ideal_inc_one1[of \"mx\", THEN sym])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; x = mx\\<rbrakk>\n       \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J} =\n                         {mx, carrier R}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (thin_tac \"x = mx\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J} =\n                      {mx, carrier R}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (rule equalityI)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {J. ideal R J \\<and> mx \\<subseteq> J}\n                      \\<subseteq> {mx, carrier R}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (rule subsetI, simp, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (case_tac \"x \\<noteq> mx\")"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (frule_tac A = x and B = mx in sets_not_eq, assumption)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; x \\<noteq> mx;\n        \\<exists>a\\<in>x. a \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (erule bexE)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; x \\<noteq> mx; a \\<in> x; a \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (frule_tac h = a and I = x in ideal_subset, assumption+)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; x \\<noteq> mx; a \\<in> x; a \\<notin> mx;\n        a \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (frule_tac x = a in bspec, simp)"], ["proof (prove)\ngoal (4 subgoals):\n 1. \\<And>x a.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; x \\<noteq> mx; a \\<in> x; a \\<notin> mx;\n        a \\<in> carrier R; Unit R a\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 4. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (frule_tac I = x and a = a in ideal_inc_unit1, assumption+,\n        simp)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; ideal R x;\n        mx \\<subseteq> x; \\<not> x \\<noteq> mx\\<rbrakk>\n       \\<Longrightarrow> x = mx \\<or> x = carrier R\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n     Ball (carrier R - mx) (Unit R)\\<rbrakk>\n    \\<Longrightarrow> {mx, carrier R}\n                      \\<subseteq> {J. ideal R J \\<and> mx \\<subseteq> J}\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (rule subsetI, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x;\n        x = mx \\<or> x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> mx \\<subseteq> x\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (erule disjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; x = mx\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> mx \\<subseteq> x\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> mx \\<subseteq> x\n 3. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply simp"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; 1\\<^sub>r \\<notin> mx;\n        \\<forall>x\\<in>carrier R - mx. Unit R x; x = carrier R\\<rbrakk>\n       \\<Longrightarrow> ideal R x \\<and> mx \\<subseteq> x\n 2. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (simp add:whole_ideal ideal_subset1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n     \\<forall>a\\<in>carrier R - mx. Unit R a\\<rbrakk>\n    \\<Longrightarrow> {m. maximal_ideal R m} \\<subseteq> {mx}", "apply (rule subsetI)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a;\n        x \\<in> {m. maximal_ideal R m}\\<rbrakk>\n       \\<Longrightarrow> x \\<in> {mx}", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x\\<rbrakk>\n       \\<Longrightarrow> x = mx", "apply (subgoal_tac \"x \\<subseteq> mx\",\n        thin_tac \"\\<forall>a\\<in>carrier R - mx. Unit R a\",\n        simp add:maximal_ideal_def, (erule conjE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        x \\<subseteq> mx; ideal R x; 1\\<^sub>r \\<notin> x;\n        {J. ideal R J \\<and> x \\<subseteq> J} = {x, carrier R}\\<rbrakk>\n       \\<Longrightarrow> x = mx\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x\\<rbrakk>\n       \\<Longrightarrow> x \\<subseteq> mx", "apply (subgoal_tac \"mx \\<in> {J. ideal R J \\<and> x \\<subseteq> J}\", simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        x \\<subseteq> mx; ideal R x; 1\\<^sub>r \\<notin> x;\n        {J. ideal R J \\<and> x \\<subseteq> J} = {x, carrier R}\\<rbrakk>\n       \\<Longrightarrow> mx \\<in> {J. ideal R J \\<and> x \\<subseteq> J}\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x\\<rbrakk>\n       \\<Longrightarrow> x \\<subseteq> mx", "apply (thin_tac \"{J. ideal R J \\<and> x \\<subseteq> J} = {x, carrier R}\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        x \\<subseteq> mx; ideal R x; 1\\<^sub>r \\<notin> x\\<rbrakk>\n       \\<Longrightarrow> mx \\<in> {J. ideal R J \\<and> x \\<subseteq> J}\n 2. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x\\<rbrakk>\n       \\<Longrightarrow> x \\<subseteq> mx", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x\\<rbrakk>\n       \\<Longrightarrow> x \\<subseteq> mx", "apply (rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x;\n        \\<not> x \\<subseteq> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:subset_eq, erule bexE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x;\n        xa \\<in> x; xa \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac mx = x in maximal_ideal_ideal,\n        frule_tac x = xa in bspec,\n        thin_tac \"\\<forall>a\\<in>carrier R - mx. Unit R a\", simp,\n        simp add:ideal_subset)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>x xa.\n       \\<lbrakk>\\<not> zeroring R; ideal R mx; mx \\<noteq> carrier R;\n        \\<forall>a\\<in>carrier R - mx. Unit R a; maximal_ideal R x;\n        xa \\<in> x; xa \\<notin> mx; ideal R x; Unit R xa\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac I = x and a = xa in ideal_inc_unit, assumption+,\n                  simp add:maximal_ideal_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) localring_unit:\"\\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n                \\<forall>x. x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r) \\<rbrakk> \\<Longrightarrow> local_ring R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow>\n        Unit R (x \\<plusminus> 1\\<^sub>r)\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule maximal_ideal_ideal[of \"mx\"])"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule local_ring_diff[of \"mx\"], assumption)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx\\<rbrakk>\n    \\<Longrightarrow> mx \\<noteq> carrier R\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R - mx. Unit R a\n 3. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (simp add:maximal_ideal_def, erule conjE)"], ["proof (prove)\ngoal (3 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; 1\\<^sub>r \\<notin> mx;\n     {J. ideal R J \\<and> mx \\<subseteq> J} = {mx, carrier R}\\<rbrakk>\n    \\<Longrightarrow> mx \\<noteq> carrier R\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R - mx. Unit R a\n 3. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (simp add:ideal_inc_one1[THEN sym, of \"mx\"])"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx\\<rbrakk>\n    \\<Longrightarrow> \\<forall>a\\<in>carrier R - mx. Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (rule ballI, simp, erule conjE)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule_tac x = a in maximal_prime_Tr0[of \"mx\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a = carrier R\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule sym, thin_tac \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a = carrier R\",\n        cut_tac ring_one,\n        frule_tac a = \"1\\<^sub>r\" and A = \"carrier R\" and B = \"mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\" in\n                  eq_set_inc, assumption+,\n        thin_tac \"carrier R = mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule_tac a = a in principal_ideal,\n       frule ideal_subset1[of mx],\n       frule_tac I = \"R \\<diamondsuit>\\<^sub>p a\" in ideal_subset1)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<in> mx \\<minusplus> R \\<diamondsuit>\\<^sub>p a;\n        ideal R (R \\<diamondsuit>\\<^sub>p a); mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (cut_tac ring_is_ag,\n        simp add:aGroup.set_sum, (erule bexE)+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        1\\<^sub>r \\<in> carrier R; ideal R (R \\<diamondsuit>\\<^sub>p a);\n        mx \\<subseteq> carrier R;\n        R \\<diamondsuit>\\<^sub>p a \\<subseteq> carrier R; aGroup R;\n        h \\<in> mx; k \\<in> R \\<diamondsuit>\\<^sub>p a;\n        1\\<^sub>r = h \\<plusminus> k\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (simp add:Rxa_def, erule bexE, simp)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow>\n           Unit R (x \\<plusminus> (h \\<plusminus> r \\<cdot>\\<^sub>r a));\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n        mx \\<subseteq> carrier R;\n        {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a}\n        \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx;\n        1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a; r \\<in> carrier R;\n        k = r \\<cdot>\\<^sub>r a\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule sym, thin_tac \"1\\<^sub>r = h \\<plusminus> r \\<cdot>\\<^sub>r a\",\n        frule_tac x = r and y = a in ring_tOp_closed, assumption+,\n        frule_tac h = h in ideal_subset[of \"mx\"], assumption+)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow>\n           Unit R (x \\<plusminus> (h \\<plusminus> r \\<cdot>\\<^sub>r a));\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n        mx \\<subseteq> carrier R;\n        {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a}\n        \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R; k = r \\<cdot>\\<^sub>r a;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a = 1\\<^sub>r;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R; h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule_tac I = mx and x = h in ideal_inv1_closed, assumption)"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n        \\<forall>x.\n           x \\<in> mx \\<longrightarrow>\n           Unit R (x \\<plusminus> (h \\<plusminus> r \\<cdot>\\<^sub>r a));\n        ideal R mx; a \\<in> carrier R; a \\<notin> mx;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n        mx \\<subseteq> carrier R;\n        {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a}\n        \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R; k = r \\<cdot>\\<^sub>r a;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a = 1\\<^sub>r;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R; h \\<in> carrier R;\n        -\\<^sub>a h \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule_tac a = \"-\\<^sub>a h\" in forall_spec, assumption,\n        thin_tac \"\\<forall>x. x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> (h \\<plusminus> r \\<cdot>\\<^sub>r a))\",\n        thin_tac \"h \\<plusminus> r \\<cdot>\\<^sub>r a = 1\\<^sub>r\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx; ideal R mx;\n        a \\<in> carrier R; a \\<notin> mx;\n        h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R;\n        ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n        mx \\<subseteq> carrier R;\n        {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a}\n        \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R; k = r \\<cdot>\\<^sub>r a;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R; h \\<in> carrier R;\n        -\\<^sub>a h \\<in> mx;\n        Unit R\n         (-\\<^sub>a h \\<plusminus>\n          (h \\<plusminus> r \\<cdot>\\<^sub>r a))\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (frule_tac h = \"-\\<^sub>a h\" in ideal_subset[of \"mx\"], assumption,\n        frule_tac x1 = \"-\\<^sub>a h\" and y1 = h and z1 = \"r \\<cdot>\\<^sub>r a\" in\n        aGroup.ag_pOp_assoc[THEN sym], assumption+,\n        simp add:aGroup.ag_l_inv1 aGroup.ag_l_zero,\n        thin_tac \"k = r \\<cdot>\\<^sub>r a\", thin_tac \"h \\<plusminus> r \\<cdot>\\<^sub>r a \\<in> carrier R\",\n        thin_tac \"h \\<in> carrier R\", thin_tac \"-\\<^sub>a h \\<in> mx\",\n        thin_tac \"-\\<^sub>a h \\<plusminus> (h \\<plusminus> r \\<cdot>\\<^sub>r a) = r \\<cdot>\\<^sub>r a\")"], ["proof (prove)\ngoal (2 subgoals):\n 1. \\<And>a h k r.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx; ideal R mx;\n        a \\<in> carrier R; a \\<notin> mx;\n        ideal R {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a};\n        mx \\<subseteq> carrier R;\n        {x. \\<exists>r\\<in>carrier R. x = r \\<cdot>\\<^sub>r a}\n        \\<subseteq> carrier R;\n        aGroup R; h \\<in> mx; r \\<in> carrier R;\n        r \\<cdot>\\<^sub>r a \\<in> carrier R; Unit R (r \\<cdot>\\<^sub>r a);\n        -\\<^sub>a h \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> Unit R a\n 2. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply (simp add:ring_tOp_commute, simp add:Unit_def, erule bexE,\n        simp add:ring_tOp_assoc,\n        frule_tac x = r and y = b in ring_tOp_closed, assumption+, blast)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; maximal_ideal R mx;\n     \\<forall>x.\n        x \\<in> mx \\<longrightarrow> Unit R (x \\<plusminus> 1\\<^sub>r);\n     ideal R mx; local_ring R \\<and> maximal_ideal R mx\\<rbrakk>\n    \\<Longrightarrow> local_ring R", "apply simp"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "definition\n  J_rad ::\"_ \\<Rightarrow> 'a set\" where\n  \"J_rad R = (if (zeroring R) then (carrier R) else\n                 \\<Inter> {mx. maximal_ideal R mx})\""], ["", "(** if zeroring R then \\<Inter> {mx. maximal_ideal R mx} is UNIV, hence\n      we restrict UNIV to carrier R **)"], ["", "lemma (in Ring) zeroring_J_rad_empty:\"zeroring R \\<Longrightarrow> J_rad R = carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. zeroring R \\<Longrightarrow> J_rad R = carrier R", "by (simp add:J_rad_def)"], ["", "lemma (in Ring) J_rad_mem:\"x \\<in> J_rad R \\<Longrightarrow> x \\<in> carrier R\""], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> J_rad R \\<Longrightarrow> x \\<in> carrier R", "apply (simp add:J_rad_def)"], ["proof (prove)\ngoal (1 subgoal):\n 1. x \\<in> (if zeroring R then carrier R\n             else \\<Inter> {mx. maximal_ideal R mx}) \\<Longrightarrow>\n    x \\<in> carrier R", "apply (case_tac \"zeroring R\", simp)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>x \\<in> (if zeroring R then carrier R\n                      else \\<Inter> {mx. maximal_ideal R mx});\n     \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R", "apply simp"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<forall>xa. maximal_ideal R xa \\<longrightarrow> x \\<in> xa;\n     \\<not> zeroring R\\<rbrakk>\n    \\<Longrightarrow> x \\<in> carrier R", "apply (frule id_maximal_Exist, erule exE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>I.\n       \\<lbrakk>\\<forall>xa.\n                   maximal_ideal R xa \\<longrightarrow> x \\<in> xa;\n        \\<not> zeroring R; maximal_ideal R I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R", "apply (frule_tac a = I in forall_spec, assumption,\n        thin_tac \"\\<forall>xa. maximal_ideal R xa \\<longrightarrow> x \\<in> xa\")"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>I.\n       \\<lbrakk>\\<not> zeroring R; maximal_ideal R I; x \\<in> I\\<rbrakk>\n       \\<Longrightarrow> x \\<in> carrier R", "apply (frule maximal_ideal_ideal,\n        simp add:ideal_subset)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "lemma (in Ring) J_rad_unit:\"\\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R\\<rbrakk> \\<Longrightarrow>\n            \\<forall>y. (y\\<in> carrier R \\<longrightarrow> Unit R (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y))\""], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R\\<rbrakk>\n    \\<Longrightarrow> \\<forall>y.\n                         y \\<in> carrier R \\<longrightarrow>\n                         Unit R\n                          (1\\<^sub>r \\<plusminus>\n                           (-\\<^sub>a x) \\<cdot>\\<^sub>r y)", "apply (cut_tac ring_is_ag,\n       rule allI, rule impI,\n       rule contrapos_pp, simp+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R; aGroup R;\n        y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus>\n                 (-\\<^sub>a x) \\<cdot>\\<^sub>r y)\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule J_rad_mem[of \"x\"],\n       frule_tac x = x and y = y in ring_tOp_closed, assumption,\n       frule_tac x = \"x \\<cdot>\\<^sub>r y\" in aGroup.ag_mOp_closed, assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R; aGroup R;\n        y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (cut_tac ring_one,\n      frule_tac x = \"1\\<^sub>r\" and y = \"-\\<^sub>a (x \\<cdot>\\<^sub>r y)\" in aGroup.ag_pOp_closed,\n      assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R; aGroup R;\n        y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac a = \"1\\<^sub>r \\<plusminus> -\\<^sub>a (x \\<cdot>\\<^sub>r y)\" in nonunit_contained_maxid,\n        assumption+, simp add:ring_inv1_1)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R; aGroup R;\n        y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R;\n        \\<exists>mx.\n           maximal_ideal R mx \\<and>\n           1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n           \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (erule exE, erule conjE)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y mx.\n       \\<lbrakk>\\<not> zeroring R; x \\<in> J_rad R; aGroup R;\n        y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R;\n        maximal_ideal R mx;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:J_rad_def,\n        frule_tac a = mx in forall_spec, assumption,\n        thin_tac \"\\<forall>xa. maximal_ideal R xa \\<longrightarrow> x \\<in> xa\",\n        frule_tac mx = mx in maximal_ideal_ideal,\n        frule_tac I = mx and x = x and r = y in ideal_ring_multiple1,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y mx.\n       \\<lbrakk>\\<not> zeroring R; aGroup R; y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R;\n        maximal_ideal R mx;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<in> mx; ideal R mx; x \\<cdot>\\<^sub>r y \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac I = mx and x = \"x \\<cdot>\\<^sub>r y\" in ideal_inv1_closed,\n           assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y mx.\n       \\<lbrakk>\\<not> zeroring R; aGroup R; y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R;\n        maximal_ideal R mx;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<in> mx; ideal R mx; x \\<cdot>\\<^sub>r y \\<in> mx;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (frule_tac I = mx and a = \"1\\<^sub>r\" and b = \"-\\<^sub>a (x \\<cdot>\\<^sub>r y)\" in ideal_ele_sumTr2,\n        assumption+)"], ["proof (prove)\ngoal (1 subgoal):\n 1. \\<And>y mx.\n       \\<lbrakk>\\<not> zeroring R; aGroup R; y \\<in> carrier R;\n        \\<not> Unit R\n                (1\\<^sub>r \\<plusminus> (-\\<^sub>a x) \\<cdot>\\<^sub>r y);\n        x \\<in> carrier R; x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> carrier R;\n        1\\<^sub>r \\<in> carrier R;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y\n        \\<in> carrier R;\n        maximal_ideal R mx;\n        1\\<^sub>r \\<plusminus> -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> mx;\n        x \\<in> mx; ideal R mx; x \\<cdot>\\<^sub>r y \\<in> mx;\n        -\\<^sub>a x \\<cdot>\\<^sub>r y \\<in> mx; 1\\<^sub>r \\<in> mx\\<rbrakk>\n       \\<Longrightarrow> False", "apply (simp add:maximal_ideal_def)"], ["proof (prove)\ngoal:\nNo subgoals!", "done"], ["", "end"]]}